∞
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\AssemblyInfo.cs
[

 
assembly

 	
:

	 

CLSCompliant


 
(

 
true

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str E
)E F
]F G
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str $
)$ %
]% &
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str '
)' (
]( )
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyVersion 
( 
$str "
)" #
]# $
[:: 
assembly:: 	
:::	 

AssemblyDelaySign:: 
(:: 
false:: "
)::" #
]::# $
[;; 
assembly;; 	
:;;	 

AssemblyKeyFile;; 
(;; 
$str;; 
);; 
];; 
[<< 
assembly<< 	
:<<	 

AssemblyKeyName<< 
(<< 
$str<< 
)<< 
]<< ‡ 
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\ConnectionString.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
ConnectionString %
{ 
private 	
const
 
string 
connectionString '
=( )
$str* A
;A B
private		 	
const		
 
string		 
writeString		 "
=		# $
$str		% A
;		A B
public 
static	 
string #
GetReadConnectionString .
(. /
)/ 0
{ 
if 
( &
UseConnectionStringSection !
(! "
)" #
)# $
{ 
return 
>
2GetReadConnectionStringFromConnectionStringSection =
(= >
)> ?
;? @
} 
return 	 
ConfigurationManager
 
. 
AppSettings *
[* +
connectionString+ ;
]; <
;< =
} 
public 
static	 
string $
GetWriteConnectionString /
(/ 0
)0 1
{ 
if 
( &
UseConnectionStringSection !
(! "
)" #
)# $
{ 
return 
?
3GetWriteConnectionStringFromConnectionStringSection >
(> ?
)? @
;@ A
} 
if!! 
(!!  
ConfigurationManager!! 
.!! 
AppSettings!! '
[!!' (
writeString!!( 3
]!!3 4
!=!!5 7
null!!8 <
)!!< =
{"" 
return## 
 
ConfigurationManager## 
.##  
AppSettings##  +
[##+ ,
writeString##, 7
]##7 8
;##8 9
}$$ 
return&& 	 
ConfigurationManager&&
 
.&& 
AppSettings&& *
[&&* +
connectionString&&+ ;
]&&; <
;&&< =
}'' 
private** 	
static**
 
string** ?
3GetWriteConnectionStringFromConnectionStringSection** K
(**K L
)**L M
{++ 
if,, 
(,,  
ConfigurationManager,, 
.,, 
ConnectionStrings,, -
[,,- .
writeString,,. 9
],,9 :
!=,,; =
null,,> B
),,B C
{-- 
return.. 
 
ConfigurationManager.. 
...  
ConnectionStrings..  1
[..1 2
writeString..2 =
]..= >
...> ?
ConnectionString..? O
;..O P
}// 
return11 	 
ConfigurationManager11
 
.11 
ConnectionStrings11 0
[110 1
connectionString111 A
]11A B
.11B C
ConnectionString11C S
;11S T
}22 
private55 	
static55
 
string55 >
2GetReadConnectionStringFromConnectionStringSection55 J
(55J K
)55K L
{66 
return77 	 
ConfigurationManager77
 
.77 
ConnectionStrings77 0
[770 1
connectionString771 A
]77A B
.77B C
ConnectionString77C S
;77S T
}88 
private;; 	
static;;
 
bool;; &
UseConnectionStringSection;; 0
(;;0 1
);;1 2
{<< 
var== #
connectionStringSection== 
===   
ConfigurationManager==! 5
.==5 6
AppSettings==6 A
[==A B
$str==B ^
]==^ _
;==_ `
if?? 
(?? #
connectionStringSection?? 
!=?? !
null??" &
&&??' )#
connectionStringSection??* A
==??B D
$str??E K
)??K L
{@@ 
returnAA 

trueAA 
;AA 
}BB 
returnDD 	
falseDD
 
;DD 
}EE 
}FF 
}GG ⁄<
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\CSVSplitter.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
class 
CSV_splitter 
: 
IEnumerable (
<( )
SqlDataRecord) 6
>6 7
,7 8
IEnumerator9 D
<D E
SqlDataRecordE R
>R S
{ 
string 
input	 
; 
char 
delim 
; 
System 
. 	
Data	 
. 
	SqlDbType 
type 
; 
int 
start_ix 
; 
int 
end_ix 
; 
SqlDataRecord 
outrec 
; 
public 
CSV_splitter	 
( 
string 
str  
,  !
char" &
	delimiter' 0
,0 1
System2 8
.8 9
Data9 =
.= >
	SqlDbType> G
	sqlDbTypeH Q
)Q R
{ 
this 
. 
input 
= 
str 
; 
this 
. 
delim 
= 
	delimiter 
; 
this 
. 
type 
= 
	sqlDbType 
; 
this 
. 
outrec 
= 
new 
SqlDataRecord "
(" #
new 

SqlMetaData 
( 
$str 
, 
this #
.# $
type$ (
)( )
)) *
;* +
this"" 
."" 
Reset"" 
("" 
)"" 
;"" 
}## 
public%% 
CSV_splitter%%	 
(%% 
string%% 
str%%  
)%%  !
=>%%" $
new%%% (
CSV_splitter%%) 5
(%%5 6
str%%6 9
,%%9 :
$char%%; >
,%%> ?
System%%@ F
.%%F G
Data%%G K
.%%K L
	SqlDbType%%L U
.%%U V
BigInt%%V \
)%%\ ]
;%%] ^
System** 
.** 	
Collections**	 
.** 
IEnumerator**  
System**! '
.**' (
Collections**( 3
.**3 4
IEnumerable**4 ?
.**? @
GetEnumerator**@ M
(**M N
)**N O
{++ 
return,, 	
this,,
 
;,, 
}-- 
public// 
System//	 
.// 
Collections// 
.// 
Generic// #
.//# $
IEnumerator//$ /
</// 0
SqlDataRecord//0 =
>//= >
GetEnumerator00 
(00 
)00 
{11 
return22 	
this22
 
;22 
}33 
public88 
void88	 
Reset88 
(88 
)88 
{99 
this:: 
.:: 
start_ix:: 
=:: 
-:: 
$num:: 
;:: 
this;; 
.;; 
end_ix;; 
=;; 
-;; 
$num;; 
;;; 
}<< 
publicAA 
boolAA	 
MoveNextAA 
(AA 
)AA 
{BB 
thisCC 
.CC 
start_ixCC 
=CC 
thisCC 
.CC 
end_ixCC 
+CC  
$numCC! "
;CC" #
whileHH 
(HH	 

thisHH
 
.HH 
start_ixHH 
<HH 
thisHH 
.HH 
inputHH $
.HH$ %
LengthHH% +
&&HH, .
thisII 
.II 
inputII 
[II 
thisII 
.II 
start_ixII 
]II  
==II! #
thisII$ (
.II( )
delimII) .
)II. /
{JJ 
thisKK 
.KK 	
start_ixKK	 
++KK 
;KK 
}LL 
ifPP 
(PP 
thisPP 
.PP 
start_ixPP 
>=PP 
thisPP 
.PP 
inputPP "
.PP" #
LengthPP# )
)PP) *
{QQ 
returnRR 

falseRR 
;RR 
}SS 
thisWW 
.WW 
end_ixWW 
=WW 
thisWW 
.WW 
inputWW 
.WW 
IndexOfWW #
(WW# $
thisWW$ (
.WW( )
delimWW) .
,WW. /
thisWW0 4
.WW4 5
start_ixWW5 =
)WW= >
;WW> ?
ifXX 
(XX 
thisXX 
.XX 
end_ixXX 
==XX 
-XX 
$numXX 
)XX 
{YY 
thisZZ 
.ZZ 	
end_ixZZ	 
=ZZ 
thisZZ 
.ZZ 
inputZZ 
.ZZ 
LengthZZ #
;ZZ# $
}[[ 
return^^ 	
true^^
 
;^^ 
}__ 
publicdd 
SqlDataRecorddd	 
Currentdd 
{ee 
getff 
{gg 
stringhh 

strhh 
=hh 
thishh 
.hh 
inputhh 
.hh 
	Substringhh %
(hh% &
thishh& *
.hh* +
start_ixhh+ 3
,hh3 4
thisii 
.ii 
end_ixii 
-ii 
thisii  
.ii  !
start_ixii! )
)ii) *
;ii* +
switchjj 

(jj 
thisjj 
.jj 
typejj 
)jj 
{kk 
casell 	
Systemll
 
.ll 
Datall 
.ll 
	SqlDbTypell 
.ll  
BigIntll  &
:ll& '
thismm 

.mm
 
outrecmm 
.mm 
SetInt64mm 
(mm 
$nummm 
,mm 
Convertmm %
.mm% &
ToInt64mm& -
(mm- .
strmm. 1
)mm1 2
)mm2 3
;mm3 4
breaknn 
;nn 
caseoo 	
Systemoo
 
.oo 
Dataoo 
.oo 
	SqlDbTypeoo 
.oo  
UniqueIdentifieroo  0
:oo0 1
thispp 

.pp
 
outrecpp 
.pp 

SetSqlGuidpp 
(pp 
$numpp 
,pp 
Guidpp  $
.pp$ %
Parsepp% *
(pp* +
strpp+ .
)pp. /
)pp/ 0
;pp0 1
breakqq 
;qq 
}rr 
returntt 

thistt 
.tt 
outrectt 
;tt 
}uu 
}vv 
Objectyy 
Systemyy	 
.yy 
Collectionsyy 
.yy 
IEnumeratoryy '
.yy' (
Currentyy( /
{zz 
get{{ 
{|| 
return}} 

this}} 
.}} 
Current}} 
;}} 
}~~ 
} 
public
ÇÇ 
void
ÇÇ	 
Dispose
ÇÇ 
(
ÇÇ 
)
ÇÇ 
{
ÉÉ 
this
ÑÑ 
.
ÑÑ 
outrec
ÑÑ 
=
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÖÖ 
public
àà 
override
àà	 
string
àà 
ToString
àà !
(
àà! "
)
àà" #
{
ââ 
return
ää 	
$str
ää
 
+
ää 
input
ää "
;
ää" #
}
ãã 
}
åå 
}çç Õ^
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCategoryItem.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBCategoryItem &
{ 
public@@ 
static@@ 
int@@ 
Create@@  
(@@  !
GuidAA 
guidAA 
,AA 
GuidBB 
siteGuidBB 
,BB 
GuidCC 
featureGuidCC 
,CC 
GuidDD 

moduleGuidDD 
,DD 
GuidEE 
itemGuidEE 
,EE 
GuidFF 
categoryGuidFF 
,FF 
GuidGG 
	extraGuidGG 
)GG 
{HH 	
SqlParameterHelperII 
sphII "
=II# $
newII% (
SqlParameterHelperII) ;
(II; <
ConnectionStringII< L
.IIL M$
GetWriteConnectionStringIIM e
(IIe f
)IIf g
,IIg h
$str	IIi Å
,
IIÅ Ç
$num
IIÉ Ñ
)
IIÑ Ö
;
IIÖ Ü
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
UniqueIdentifierJJ6 F
,JJF G
ParameterDirectionJJH Z
.JJZ [
InputJJ[ `
,JJ` a
guidJJb f
)JJf g
;JJg h
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
UniqueIdentifierKK: J
,KKJ K
ParameterDirectionKKL ^
.KK^ _
InputKK_ d
,KKd e
siteGuidKKf n
)KKn o
;KKo p
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
UniqueIdentifierLL= M
,LLM N
ParameterDirectionLLO a
.LLa b
InputLLb g
,LLg h
featureGuidLLi t
)LLt u
;LLu v
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 0
,MM0 1
	SqlDbTypeMM2 ;
.MM; <
UniqueIdentifierMM< L
,MML M
ParameterDirectionMMN `
.MM` a
InputMMa f
,MMf g

moduleGuidMMh r
)MMr s
;MMs t
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# .
,NN. /
	SqlDbTypeNN0 9
.NN9 :
UniqueIdentifierNN: J
,NNJ K
ParameterDirectionNNL ^
.NN^ _
InputNN_ d
,NNd e
itemGuidNNf n
)NNn o
;NNo p
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
UniqueIdentifierOO> N
,OON O
ParameterDirectionOOP b
.OOb c
InputOOc h
,OOh i
categoryGuidOOj v
)OOv w
;OOw x
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
UniqueIdentifierPP; K
,PPK L
ParameterDirectionPPM _
.PP_ `
InputPP` e
,PPe f
	extraGuidPPg p
)PPp q
;PPq r
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}TT 	
public^^ 
static^^ 
bool^^ 
Delete^^ !
(^^! "
Guid^^" &
guid^^' +
)^^+ ,
{__ 	
SqlParameterHelper`` 
sph`` "
=``# $
new``% (
SqlParameterHelper``) ;
(``; <
ConnectionString``< L
.``L M$
GetWriteConnectionString``M e
(``e f
)``f g
,``g h
$str	``i Å
,
``Å Ç
$num
``É Ñ
)
``Ñ Ö
;
``Ö Ü
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
UniqueIdentifieraa6 F
,aaF G
ParameterDirectionaaH Z
.aaZ [
Inputaa[ `
,aa` a
guidaab f
)aaf g
;aag h
intbb 
rowsAffectedbb 
=bb 
sphbb "
.bb" #
ExecuteNonQuerybb# 2
(bb2 3
)bb3 4
;bb4 5
returncc 
(cc 
rowsAffectedcc  
>cc! "
$numcc# $
)cc$ %
;cc% &
}ee 	
publicgg 
staticgg 
boolgg 
DeleteByItemgg '
(gg' (
Guidgg( ,
itemGuidgg- 5
)gg5 6
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M$
GetWriteConnectionStringiiM e
(iie f
)iif g
,iig h
$str	iii á
,
iiá à
$num
iiâ ä
)
iiä ã
;
iiã å
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
itemGuidjjf n
)jjn o
;jjo p
intkk 
rowsAffectedkk 
=kk 
sphkk "
.kk" #
ExecuteNonQuerykk# 2
(kk2 3
)kk3 4
;kk4 5
returnll 
(ll 
rowsAffectedll  
>ll! "
$numll# $
)ll$ %
;ll% &
}mm 	
publicoo 
staticoo 
booloo 
DeleteByExtraGuidoo ,
(oo, -
Guidoo- 1
	extraGuidoo2 ;
)oo; <
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M$
GetWriteConnectionStringqqM e
(qqe f
)qqf g
,qqg h
$str	qqi å
,
qqå ç
$num
qqé è
)
qqè ê
;
qqê ë
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# /
,rr/ 0
	SqlDbTyperr1 :
.rr: ;
UniqueIdentifierrr; K
,rrK L
ParameterDirectionrrM _
.rr_ `
Inputrr` e
,rre f
	extraGuidrrg p
)rrp q
;rrq r
intss 
rowsAffectedss 
=ss 
sphss "
.ss" #
ExecuteNonQueryss# 2
(ss2 3
)ss3 4
;ss4 5
returntt 
(tt 
rowsAffectedtt  
>tt! "
$numtt# $
)tt$ %
;tt% &
}uu 	
publicww 
staticww 
boolww 
DeleteByCategoryww +
(ww+ ,
Guidww, 0
categoryGuidww1 =
)ww= >
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$str	yyi ã
,
yyã å
$num
yyç é
)
yyé è
;
yyè ê
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 2
,zz2 3
	SqlDbTypezz4 =
.zz= >
UniqueIdentifierzz> N
,zzN O
ParameterDirectionzzP b
.zzb c
Inputzzc h
,zzh i
categoryGuidzzj v
)zzv w
;zzw x
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}}} 	
public 
static 
bool 
DeleteByModule )
() *
Guid* .

moduleGuid/ 9
)9 :
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M&
GetWriteConnectionString
ÅÅM e
(
ÅÅe f
)
ÅÅf g
,
ÅÅg h
$strÅÅi â
,ÅÅâ ä
$numÅÅã å
)ÅÅå ç
;ÅÅç é
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 0
,
ÇÇ0 1
	SqlDbType
ÇÇ2 ;
.
ÇÇ; <
UniqueIdentifier
ÇÇ< L
,
ÇÇL M 
ParameterDirection
ÇÇN `
.
ÇÇ` a
Input
ÇÇa f
,
ÇÇf g

moduleGuid
ÇÇh r
)
ÇÇr s
;
ÇÇs t
int
ÉÉ 
rowsAffected
ÉÉ 
=
ÉÉ 
sph
ÉÉ "
.
ÉÉ" #
ExecuteNonQuery
ÉÉ# 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
$num
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
}
ÖÖ 	
public
áá 
static
áá 
bool
áá 
DeleteByFeature
áá *
(
áá* +
Guid
áá+ /
featureGuid
áá0 ;
)
áá; <
{
àà 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M&
GetWriteConnectionString
ââM e
(
ââe f
)
ââf g
,
ââg h
$strââi ä
,ââä ã
$numââå ç
)ââç é
;ââé è
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 1
,
ää1 2
	SqlDbType
ää3 <
.
ää< =
UniqueIdentifier
ää= M
,
ääM N 
ParameterDirection
ääO a
.
ääa b
Input
ääb g
,
ääg h
featureGuid
ääi t
)
äät u
;
ääu v
int
ãã 
rowsAffected
ãã 
=
ãã 
sph
ãã "
.
ãã" #
ExecuteNonQuery
ãã# 2
(
ãã2 3
)
ãã3 4
;
ãã4 5
return
åå 
(
åå 
rowsAffected
åå  
>
åå! "
$num
åå# $
)
åå$ %
;
åå% &
}
çç 	
public
èè 
static
èè 
bool
èè 
DeleteBySite
èè '
(
èè' (
Guid
èè( ,
siteGuid
èè- 5
)
èè5 6
{
êê 	 
SqlParameterHelper
ëë 
sph
ëë "
=
ëë# $
new
ëë% ( 
SqlParameterHelper
ëë) ;
(
ëë; <
ConnectionString
ëë< L
.
ëëL M&
GetWriteConnectionString
ëëM e
(
ëëe f
)
ëëf g
,
ëëg h
$strëëi á
,ëëá à
$numëëâ ä
)ëëä ã
;ëëã å
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# .
,
íí. /
	SqlDbType
íí0 9
.
íí9 :
UniqueIdentifier
íí: J
,
ííJ K 
ParameterDirection
ííL ^
.
íí^ _
Input
íí_ d
,
ííd e
siteGuid
ííf n
)
íín o
;
íío p
int
ìì 
rowsAffected
ìì 
=
ìì 
sph
ìì "
.
ìì" #
ExecuteNonQuery
ìì# 2
(
ìì2 3
)
ìì3 4
;
ìì4 5
return
îî 
(
îî 
rowsAffected
îî  
>
îî! "
$num
îî# $
)
îî$ %
;
îî% &
}
ïï 	
}
òò 
}ôô €≤
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPaymentLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPaymentLog $
{ 
public44 
static44 
int44 
Create44  
(44  !
Guid55 
rowGuid55 
,55 
DateTime66 

createdUtc66 
,66  
Guid77 
siteGuid77 
,77 
Guid88 
userGuid88 
,88 
Guid99 
	storeGuid99 
,99 
Guid:: 
cartGuid:: 
,:: 
string;; 
provider;; 
,;; 
string<< 
rawResponse<< 
,<< 
string== 
responseCode== 
,==  
string>> 
responseReasonCode>> %
,>>% &
string?? 
reason?? 
,?? 
string@@ 
avsCode@@ 
,@@ 
stringAA 
ccvCodeAA 
,AA 
stringBB 
cavCodeBB 
,BB 
stringCC 
transactionIdCC  
,CC  !
stringDD 
transactionTypeDD "
,DD" #
stringEE 
methodEE 
,EE 
stringFF 
authCodeFF 
,FF 
decimalGG 
amountGG 
,GG 
decimalHH 
taxHH 
,HH 
decimalII 
dutyII 
,II 
decimalJJ 
freightJJ 
)JJ 
{KK 	
SqlParameterHelperLL 
sphLL "
=LL# $
newLL% (
SqlParameterHelperLL) ;
(LL; <
ConnectionStringLL< L
.LLL M$
GetWriteConnectionStringLLM e
(LLe f
)LLf g
,LLg h
$strLLi 
,	LL Ä
$num
LLÅ É
)
LLÉ Ñ
;
LLÑ Ö
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# -
,MM- .
	SqlDbTypeMM/ 8
.MM8 9
UniqueIdentifierMM9 I
,MMI J
ParameterDirectionMMK ]
.MM] ^
InputMM^ c
,MMc d
rowGuidMMe l
)MMl m
;MMm n
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 0
,NN0 1
	SqlDbTypeNN2 ;
.NN; <
DateTimeNN< D
,NND E
ParameterDirectionNNF X
.NNX Y
InputNNY ^
,NN^ _

createdUtcNN` j
)NNj k
;NNk l
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
userGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# /
,QQ/ 0
	SqlDbTypeQQ1 :
.QQ: ;
UniqueIdentifierQQ; K
,QQK L
ParameterDirectionQQM _
.QQ_ `
InputQQ` e
,QQe f
	storeGuidQQg p
)QQp q
;QQq r
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
UniqueIdentifierRR: J
,RRJ K
ParameterDirectionRRL ^
.RR^ _
InputRR_ d
,RRd e
cartGuidRRf n
)RRn o
;RRo p
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
providerSSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
rawResponseTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NCharUU> C
,UUC D
$numUUE F
,UUF G
ParameterDirectionUUH Z
.UUZ [
InputUU[ `
,UU` a
responseCodeUUb n
)UUn o
;UUo p
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 8
,VV8 9
	SqlDbTypeVV: C
.VVC D
NVarCharVVD L
,VVL M
$numVVN P
,VVP Q
ParameterDirectionVVR d
.VVd e
InputVVe j
,VVj k
responseReasonCodeVVl ~
)VV~ 
;	VV Ä
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# ,
,WW, -
	SqlDbTypeWW. 7
.WW7 8
NVarCharWW8 @
,WW@ A
-WWB C
$numWWC D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _
reasonWW` f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
NVarCharXX9 A
,XXA B
$numXXC E
,XXE F
ParameterDirectionXXG Y
.XXY Z
InputXXZ _
,XX_ `
avsCodeXXa h
)XXh i
;XXi j
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# -
,YY- .
	SqlDbTypeYY/ 8
.YY8 9
NCharYY9 >
,YY> ?
$numYY@ A
,YYA B
ParameterDirectionYYC U
.YYU V
InputYYV [
,YY[ \
ccvCodeYY] d
)YYd e
;YYe f
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# -
,ZZ- .
	SqlDbTypeZZ/ 8
.ZZ8 9
NCharZZ9 >
,ZZ> ?
$numZZ@ A
,ZZA B
ParameterDirectionZZC U
.ZZU V
InputZZV [
,ZZ[ \
cavCodeZZ] d
)ZZd e
;ZZe f
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 3
,[[3 4
	SqlDbType[[5 >
.[[> ?
NVarChar[[? G
,[[G H
$num[[I K
,[[K L
ParameterDirection[[M _
.[[_ `
Input[[` e
,[[e f
transactionId[[g t
)[[t u
;[[u v
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 5
,\\5 6
	SqlDbType\\7 @
.\\@ A
NVarChar\\A I
,\\I J
$num\\K M
,\\M N
ParameterDirection\\O a
.\\a b
Input\\b g
,\\g h
transactionType\\i x
)\\x y
;\\y z
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ,
,]], -
	SqlDbType]]. 7
.]]7 8
NVarChar]]8 @
,]]@ A
$num]]B D
,]]D E
ParameterDirection]]F X
.]]X Y
Input]]Y ^
,]]^ _
method]]` f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
NVarChar^^: B
,^^B C
$num^^D F
,^^F G
ParameterDirection^^H Z
.^^Z [
Input^^[ `
,^^` a
authCode^^b j
)^^j k
;^^k l
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Decimal__8 ?
,__? @
ParameterDirection__A S
.__S T
Input__T Y
,__Y Z
amount__[ a
)__a b
;__b c
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# )
,``) *
	SqlDbType``+ 4
.``4 5
Decimal``5 <
,``< =
ParameterDirection``> P
.``P Q
Input``Q V
,``V W
tax``X [
)``[ \
;``\ ]
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
Decimalaa6 =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
dutyaaY ]
)aa] ^
;aa^ _
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
Decimalbb9 @
,bb@ A
ParameterDirectionbbB T
.bbT U
InputbbU Z
,bbZ [
freightbb\ c
)bbc d
;bbd e
intcc 
rowsAffectedcc 
=cc 
sphcc "
.cc" #
ExecuteNonQuerycc# 2
(cc2 3
)cc3 4
;cc4 5
returndd 
rowsAffecteddd 
;dd  
}ff 	
public
ÄÄ 
static
ÄÄ 
bool
ÄÄ 
Update
ÄÄ !
(
ÄÄ! "
Guid
ÅÅ 
rowGuid
ÅÅ 
,
ÅÅ 
Guid
ÇÇ 
siteGuid
ÇÇ 
,
ÇÇ 
Guid
ÉÉ 
userGuid
ÉÉ 
,
ÉÉ 
Guid
ÑÑ 
	storeGuid
ÑÑ 
,
ÑÑ 
Guid
ÖÖ 
cartGuid
ÖÖ 
,
ÖÖ 
string
ÜÜ 
rawResponse
ÜÜ 
,
ÜÜ 
string
áá 
responseCode
áá 
,
áá  
string
àà  
responseReasonCode
àà %
,
àà% &
string
ââ 
reason
ââ 
,
ââ 
string
ää 
avsCode
ää 
,
ää 
string
ãã 
ccvCode
ãã 
,
ãã 
string
åå 
cavCode
åå 
,
åå 
string
çç 
transactionId
çç  
,
çç  !
string
éé 
transactionType
éé "
,
éé" #
string
èè 
method
èè 
,
èè 
string
êê 
authCode
êê 
,
êê 
decimal
ëë 
amount
ëë 
,
ëë 
decimal
íí 
tax
íí 
,
íí 
decimal
ìì 
duty
ìì 
,
ìì 
decimal
îî 
freight
îî 
)
îî 
{
ïï 	 
SqlParameterHelper
ññ 
sph
ññ "
=
ññ# $
new
ññ% ( 
SqlParameterHelper
ññ) ;
(
ññ; <
ConnectionString
ññ< L
.
ññL M&
GetWriteConnectionString
ññM e
(
ññe f
)
ññf g
,
ññg h
$str
ññi 
,ññ Ä
$numññÅ É
)ññÉ Ñ
;ññÑ Ö
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# -
,
óó- .
	SqlDbType
óó/ 8
.
óó8 9
UniqueIdentifier
óó9 I
,
óóI J 
ParameterDirection
óóK ]
.
óó] ^
Input
óó^ c
,
óóc d
rowGuid
óóe l
)
óól m
;
óóm n
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# .
,
òò. /
	SqlDbType
òò0 9
.
òò9 :
UniqueIdentifier
òò: J
,
òòJ K 
ParameterDirection
òòL ^
.
òò^ _
Input
òò_ d
,
òòd e
siteGuid
òòf n
)
òòn o
;
òòo p
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# .
,
ôô. /
	SqlDbType
ôô0 9
.
ôô9 :
UniqueIdentifier
ôô: J
,
ôôJ K 
ParameterDirection
ôôL ^
.
ôô^ _
Input
ôô_ d
,
ôôd e
userGuid
ôôf n
)
ôôn o
;
ôôo p
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# /
,
öö/ 0
	SqlDbType
öö1 :
.
öö: ;
UniqueIdentifier
öö; K
,
ööK L 
ParameterDirection
ööM _
.
öö_ `
Input
öö` e
,
ööe f
	storeGuid
öög p
)
ööp q
;
ööq r
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# .
,
õõ. /
	SqlDbType
õõ0 9
.
õõ9 :
UniqueIdentifier
õõ: J
,
õõJ K 
ParameterDirection
õõL ^
.
õõ^ _
Input
õõ_ d
,
õõd e
cartGuid
õõf n
)
õõn o
;
õõo p
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 1
,
úú1 2
	SqlDbType
úú3 <
.
úú< =
NVarChar
úú= E
,
úúE F
-
úúG H
$num
úúH I
,
úúI J 
ParameterDirection
úúK ]
.
úú] ^
Input
úú^ c
,
úúc d
rawResponse
úúe p
)
úúp q
;
úúq r
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# 2
,
ùù2 3
	SqlDbType
ùù4 =
.
ùù= >
NChar
ùù> C
,
ùùC D
$num
ùùE F
,
ùùF G 
ParameterDirection
ùùH Z
.
ùùZ [
Input
ùù[ `
,
ùù` a
responseCode
ùùb n
)
ùùn o
;
ùùo p
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 8
,
ûû8 9
	SqlDbType
ûû: C
.
ûûC D
NVarChar
ûûD L
,
ûûL M
$num
ûûN P
,
ûûP Q 
ParameterDirection
ûûR d
.
ûûd e
Input
ûûe j
,
ûûj k 
responseReasonCode
ûûl ~
)
ûû~ 
;ûû Ä
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# ,
,
üü, -
	SqlDbType
üü. 7
.
üü7 8
NVarChar
üü8 @
,
üü@ A
-
üüB C
$num
üüC D
,
üüD E 
ParameterDirection
üüF X
.
üüX Y
Input
üüY ^
,
üü^ _
reason
üü` f
)
üüf g
;
üüg h
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# -
,
††- .
	SqlDbType
††/ 8
.
††8 9
NVarChar
††9 A
,
††A B
$num
††C E
,
††E F 
ParameterDirection
††G Y
.
††Y Z
Input
††Z _
,
††_ `
avsCode
††a h
)
††h i
;
††i j
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# -
,
°°- .
	SqlDbType
°°/ 8
.
°°8 9
NChar
°°9 >
,
°°> ?
$num
°°@ A
,
°°A B 
ParameterDirection
°°C U
.
°°U V
Input
°°V [
,
°°[ \
ccvCode
°°] d
)
°°d e
;
°°e f
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# -
,
¢¢- .
	SqlDbType
¢¢/ 8
.
¢¢8 9
NChar
¢¢9 >
,
¢¢> ?
$num
¢¢@ A
,
¢¢A B 
ParameterDirection
¢¢C U
.
¢¢U V
Input
¢¢V [
,
¢¢[ \
cavCode
¢¢] d
)
¢¢d e
;
¢¢e f
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 3
,
££3 4
	SqlDbType
££5 >
.
££> ?
NVarChar
££? G
,
££G H
$num
££I K
,
££K L 
ParameterDirection
££M _
.
££_ `
Input
££` e
,
££e f
transactionId
££g t
)
££t u
;
££u v
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 5
,
§§5 6
	SqlDbType
§§7 @
.
§§@ A
NVarChar
§§A I
,
§§I J
$num
§§K M
,
§§M N 
ParameterDirection
§§O a
.
§§a b
Input
§§b g
,
§§g h
transactionType
§§i x
)
§§x y
;
§§y z
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# ,
,
••, -
	SqlDbType
••. 7
.
••7 8
NVarChar
••8 @
,
••@ A
$num
••B D
,
••D E 
ParameterDirection
••F X
.
••X Y
Input
••Y ^
,
••^ _
method
••` f
)
••f g
;
••g h
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
NVarChar
¶¶: B
,
¶¶B C
$num
¶¶D F
,
¶¶F G 
ParameterDirection
¶¶H Z
.
¶¶Z [
Input
¶¶[ `
,
¶¶` a
authCode
¶¶b j
)
¶¶j k
;
¶¶k l
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# ,
,
ßß, -
	SqlDbType
ßß. 7
.
ßß7 8
Decimal
ßß8 ?
,
ßß? @ 
ParameterDirection
ßßA S
.
ßßS T
Input
ßßT Y
,
ßßY Z
amount
ßß[ a
)
ßßa b
;
ßßb c
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# )
,
®®) *
	SqlDbType
®®+ 4
.
®®4 5
Decimal
®®5 <
,
®®< = 
ParameterDirection
®®> P
.
®®P Q
Input
®®Q V
,
®®V W
tax
®®X [
)
®®[ \
;
®®\ ]
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# *
,
©©* +
	SqlDbType
©©, 5
.
©©5 6
Decimal
©©6 =
,
©©= > 
ParameterDirection
©©? Q
.
©©Q R
Input
©©R W
,
©©W X
duty
©©Y ]
)
©©] ^
;
©©^ _
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# -
,
™™- .
	SqlDbType
™™/ 8
.
™™8 9
Decimal
™™9 @
,
™™@ A 
ParameterDirection
™™B T
.
™™T U
Input
™™U Z
,
™™Z [
freight
™™\ c
)
™™c d
;
™™d e
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ "
.
´´" #
ExecuteNonQuery
´´# 2
(
´´2 3
)
´´3 4
;
´´4 5
return
¨¨ 
(
¨¨ 
rowsAffected
¨¨  
>
¨¨! "
$num
¨¨# $
)
¨¨$ %
;
¨¨% &
}
ÆÆ 	
public
µµ 
static
µµ 
bool
µµ 
Delete
µµ !
(
µµ! "
Guid
µµ" &
rowGuid
µµ' .
)
µµ. /
{
∂∂ 	 
SqlParameterHelper
∑∑ 
sph
∑∑ "
=
∑∑# $
new
∑∑% ( 
SqlParameterHelper
∑∑) ;
(
∑∑; <
ConnectionString
∑∑< L
.
∑∑L M&
GetWriteConnectionString
∑∑M e
(
∑∑e f
)
∑∑f g
,
∑∑g h
$str
∑∑i 
,∑∑ Ä
$num∑∑Å Ç
)∑∑Ç É
;∑∑É Ñ
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# -
,
∏∏- .
	SqlDbType
∏∏/ 8
.
∏∏8 9
UniqueIdentifier
∏∏9 I
,
∏∏I J 
ParameterDirection
∏∏K ]
.
∏∏] ^
Input
∏∏^ c
,
∏∏c d
rowGuid
∏∏e l
)
∏∏l m
;
∏∏m n
int
ππ 
rowsAffected
ππ 
=
ππ 
sph
ππ "
.
ππ" #
ExecuteNonQuery
ππ# 2
(
ππ2 3
)
ππ3 4
;
ππ4 5
return
∫∫ 
(
∫∫ 
rowsAffected
∫∫  
>
∫∫! "
$num
∫∫# $
)
∫∫$ %
;
∫∫% &
}
ºº 	
public
¬¬ 
static
¬¬ 
IDataReader
¬¬ !
GetOne
¬¬" (
(
¬¬( )
Guid
¬¬) -
rowGuid
¬¬. 5
)
¬¬5 6
{
√√ 	 
SqlParameterHelper
ƒƒ 
sph
ƒƒ "
=
ƒƒ# $
new
ƒƒ% ( 
SqlParameterHelper
ƒƒ) ;
(
ƒƒ; <
ConnectionString
ƒƒ< L
.
ƒƒL M%
GetReadConnectionString
ƒƒM d
(
ƒƒd e
)
ƒƒe f
,
ƒƒf g
$strƒƒh Å
,ƒƒÅ Ç
$numƒƒÉ Ñ
)ƒƒÑ Ö
;ƒƒÖ Ü
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ "
(
≈≈" #
$str
≈≈# -
,
≈≈- .
	SqlDbType
≈≈/ 8
.
≈≈8 9
UniqueIdentifier
≈≈9 I
,
≈≈I J 
ParameterDirection
≈≈K ]
.
≈≈] ^
Input
≈≈^ c
,
≈≈c d
rowGuid
≈≈e l
)
≈≈l m
;
≈≈m n
return
∆∆ 
sph
∆∆ 
.
∆∆ 
ExecuteReader
∆∆ $
(
∆∆$ %
)
∆∆% &
;
∆∆& '
}
»» 	
public
ŒŒ 
static
ŒŒ 
IDataReader
ŒŒ !
	GetByCart
ŒŒ" +
(
ŒŒ+ ,
Guid
ŒŒ, 0
cartGuid
ŒŒ1 9
)
ŒŒ9 :
{
œœ 	 
SqlParameterHelper
–– 
sph
–– "
=
––# $
new
––% ( 
SqlParameterHelper
––) ;
(
––; <
ConnectionString
––< L
.
––L M%
GetReadConnectionString
––M d
(
––d e
)
––e f
,
––f g
$str––h Ñ
,––Ñ Ö
$num––Ü á
)––á à
;––à â
sph
—— 
.
——  
DefineSqlParameter
—— "
(
——" #
$str
——# .
,
——. /
	SqlDbType
——0 9
.
——9 :
UniqueIdentifier
——: J
,
——J K 
ParameterDirection
——L ^
.
——^ _
Input
——_ d
,
——d e
cartGuid
——f n
)
——n o
;
——o p
return
““ 
sph
““ 
.
““ 
ExecuteReader
““ $
(
““$ %
)
““% &
;
““& '
}
‘‘ 	
}
÷÷ 
}◊◊ ıu
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSystemLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSystemLog #
{ 
public%% 
static%% 
int%% 
Create%%  
(%%  !
DateTime&& 
logDate&& 
,&& 
string'' 
	ipAddress'' 
,'' 
string(( 
culture(( 
,(( 
string)) 
url)) 
,)) 
string** 
shortUrl** 
,** 
string++ 
thread++ 
,++ 
string,, 
logLevel,, 
,,, 
string-- 
logger-- 
,-- 
string.. 
message.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str00i ~
,00~ 
$num
00Ä Å
)
00Å Ç
;
00Ç É
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# -
,11- .
	SqlDbType11/ 8
.118 9
DateTime119 A
,11A B
ParameterDirection11C U
.11U V
Input11V [
,11[ \
logDate11] d
)11d e
;11e f
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# /
,22/ 0
	SqlDbType221 :
.22: ;
NVarChar22; C
,22C D
$num22E G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
	ipAddress22c l
)22l m
;22m n
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# -
,33- .
	SqlDbType33/ 8
.338 9
NVarChar339 A
,33A B
$num33C E
,33E F
ParameterDirection33G Y
.33Y Z
Input33Z _
,33_ `
culture33a h
)33h i
;33i j
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# )
,44) *
	SqlDbType44+ 4
.444 5
NVarChar445 =
,44= >
-44? @
$num44@ A
,44A B
ParameterDirection44C U
.44U V
Input44V [
,44[ \
url44] `
)44` a
;44a b
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
NVarChar55: B
,55B C
$num55D G
,55G H
ParameterDirection55I [
.55[ \
Input55\ a
,55a b
shortUrl55c k
)55k l
;55l m
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# ,
,66, -
	SqlDbType66. 7
.667 8
NVarChar668 @
,66@ A
$num66B E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
thread66a g
)66g h
;66h i
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
NVarChar77: B
,77B C
$num77D F
,77F G
ParameterDirection77H Z
.77Z [
Input77[ `
,77` a
logLevel77b j
)77j k
;77k l
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# ,
,88, -
	SqlDbType88. 7
.887 8
NVarChar888 @
,88@ A
$num88B E
,88E F
ParameterDirection88G Y
.88Y Z
Input88Z _
,88_ `
logger88a g
)88g h
;88h i
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# -
,99- .
	SqlDbType99/ 8
.998 9
NVarChar999 A
,99A B
-99C D
$num99D E
,99E F
ParameterDirection99G Y
.99Y Z
Input99Z _
,99_ `
message99a h
)99h i
;99i j
int:: 
newID:: 
=:: 
Convert:: 
.::  
ToInt32::  '
(::' (
sph::( +
.::+ ,
ExecuteScalar::, 9
(::9 :
)::: ;
)::; <
;::< =
return;; 
newID;; 
;;; 
}<< 	
publicAA 
staticAA 
voidAA 
	DeleteAllAA $
(AA$ %
)AA% &
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$str	CCi Å
,
CCÅ Ç
$num
CCÉ Ñ
)
CCÑ Ö
;
CCÖ Ü
sphEE 
.EE 
ExecuteNonQueryEE 
(EE  
)EE  !
;EE! "
}HH 	
publicOO 
staticOO 
boolOO 
DeleteOO !
(OO! "
intOO" %
idOO& (
)OO( )
{PP 	
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h
$strQQi ~
,QQ~ 
$num
QQÄ Å
)
QQÅ Ç
;
QQÇ É
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# (
,RR( )
	SqlDbTypeRR* 3
.RR3 4
IntRR4 7
,RR7 8
ParameterDirectionRR9 K
.RRK L
InputRRL Q
,RRQ R
idRRS U
)RRU V
;RRV W
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
(TT 
rowsAffectedTT  
>TT! "
$numTT# $
)TT$ %
;TT% &
}VV 	
public]] 
static]] 
bool]] 
DeleteOlderThan]] *
(]]* +
DateTime]]+ 3

cutoffDate]]4 >
)]]> ?
{^^ 	
SqlParameterHelper__ 
sph__ "
=__# $
new__% (
SqlParameterHelper__) ;
(__; <
ConnectionString__< L
.__L M$
GetWriteConnectionString__M e
(__e f
)__f g
,__g h
$str	__i á
,
__á à
$num
__â ä
)
__ä ã
;
__ã å
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
DateTime``< D
,``D E
ParameterDirection``F X
.``X Y
Input``Y ^
,``^ _

cutoffDate``` j
)``j k
;``k l
intaa 
rowsAffectedaa 
=aa 
sphaa "
.aa" #
ExecuteNonQueryaa# 2
(aa2 3
)aa3 4
;aa4 5
returnbb 
(bb 
rowsAffectedbb  
>bb! "
$numbb# $
)bb$ %
;bb% &
}dd 	
publickk 
statickk 
boolkk 
DeleteByLevelkk (
(kk( )
stringkk) /
logLevelkk0 8
)kk8 9
{ll 	
SqlParameterHelpermm 
sphmm "
=mm# $
newmm% (
SqlParameterHelpermm) ;
(mm; <
ConnectionStringmm< L
.mmL M$
GetWriteConnectionStringmmM e
(mme f
)mmf g
,mmg h
$str	mmi Ö
,
mmÖ Ü
$num
mmá à
)
mmà â
;
mmâ ä
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# .
,nn. /
	SqlDbTypenn0 9
.nn9 :
NVarCharnn: B
,nnB C
$numnnD F
,nnF G
ParameterDirectionnnH Z
.nnZ [
Inputnn[ `
,nn` a
logLevelnnb j
)nnj k
;nnk l
intoo 
rowsAffectedoo 
=oo 
sphoo "
.oo" #
ExecuteNonQueryoo# 2
(oo2 3
)oo3 4
;oo4 5
returnpp 
(pp 
rowsAffectedpp  
>pp! "
$numpp# $
)pp$ %
;pp% &
}rr 	
publicww 
staticww 
intww 
GetCountww "
(ww" #
)ww# $
{xx 	
returnzz 
Convertzz 
.zz 
ToInt32zz "
(zz" #
	SqlHelperzz# ,
.zz, -
ExecuteScalarzz- :
(zz: ;
ConnectionString{{  
.{{  !#
GetReadConnectionString{{! 8
({{8 9
){{9 :
,{{: ;
CommandType|| 
.|| 
StoredProcedure|| +
,||+ ,
$str}} '
,}}' (
null~~ 
)~~ 
)~~ 
;~~ 
}
ÄÄ 	
public
àà 
static
àà 
IDataReader
àà !
GetPageAscending
àà" 2
(
àà2 3
int
ââ 

pageNumber
ââ 
,
ââ 
int
ää 
pageSize
ää 
,
ää 
out
ãã 
int
ãã 

totalPages
ãã 
)
ãã 
{
åå 	

totalPages
çç 
=
çç 
$num
çç 
;
çç 
int
éé 
	totalRows
éé 
=
éé 
GetCount
éé $
(
éé$ %
)
éé% &
;
éé& '
if
êê 
(
êê 
pageSize
êê 
>
êê 
$num
êê 
)
êê 

totalPages
êê (
=
êê) *
	totalRows
êê+ 4
/
êê5 6
pageSize
êê7 ?
;
êê? @
if
íí 
(
íí 
	totalRows
íí 
<=
íí 
pageSize
íí %
)
íí% &
{
ìì 

totalPages
îî 
=
îî 
$num
îî 
;
îî 
}
ïï 
else
ññ 
{
óó 
int
òò 
	remainder
òò 
;
òò 
Math
ôô 
.
ôô 
DivRem
ôô 
(
ôô 
	totalRows
ôô %
,
ôô% &
pageSize
ôô' /
,
ôô/ 0
out
ôô1 4
	remainder
ôô5 >
)
ôô> ?
;
ôô? @
if
öö 
(
öö 
	remainder
öö 
>
öö 
$num
öö  !
)
öö! "
{
õõ 

totalPages
úú 
+=
úú !
$num
úú" #
;
úú# $
}
ùù 
}
ûû  
SqlParameterHelper
†† 
sph
†† "
=
††# $
new
††% ( 
SqlParameterHelper
††) ;
(
††; <
ConnectionString
††< L
.
††L M%
GetReadConnectionString
††M d
(
††d e
)
††e f
,
††f g
$str††h ä
,††ä ã
$num††å ç
)††ç é
;††é è
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 0
,
°°0 1
	SqlDbType
°°2 ;
.
°°; <
Int
°°< ?
,
°°? @ 
ParameterDirection
°°A S
.
°°S T
Input
°°T Y
,
°°Y Z

pageNumber
°°[ e
)
°°e f
;
°°f g
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
Int
¢¢: =
,
¢¢= > 
ParameterDirection
¢¢? Q
.
¢¢Q R
Input
¢¢R W
,
¢¢W X
pageSize
¢¢Y a
)
¢¢a b
;
¢¢b c
return
££ 
sph
££ 
.
££ 
ExecuteReader
££ $
(
££$ %
)
££% &
;
££& '
}
•• 	
public
≠≠ 
static
≠≠ 
IDataReader
≠≠ !
GetPageDescending
≠≠" 3
(
≠≠3 4
int
ÆÆ 

pageNumber
ÆÆ 
,
ÆÆ 
int
ØØ 
pageSize
ØØ 
,
ØØ 
out
∞∞ 
int
∞∞ 

totalPages
∞∞ 
)
∞∞ 
{
±± 	

totalPages
≤≤ 
=
≤≤ 
$num
≤≤ 
;
≤≤ 
int
≥≥ 
	totalRows
≥≥ 
=
≥≥ 
GetCount
≥≥ $
(
≥≥$ %
)
≥≥% &
;
≥≥& '
if
µµ 
(
µµ 
pageSize
µµ 
>
µµ 
$num
µµ 
)
µµ 

totalPages
µµ (
=
µµ) *
	totalRows
µµ+ 4
/
µµ5 6
pageSize
µµ7 ?
;
µµ? @
if
∑∑ 
(
∑∑ 
	totalRows
∑∑ 
<=
∑∑ 
pageSize
∑∑ %
)
∑∑% &
{
∏∏ 

totalPages
ππ 
=
ππ 
$num
ππ 
;
ππ 
}
∫∫ 
else
ªª 
{
ºº 
int
ΩΩ 
	remainder
ΩΩ 
;
ΩΩ 
Math
ææ 
.
ææ 
DivRem
ææ 
(
ææ 
	totalRows
ææ %
,
ææ% &
pageSize
ææ' /
,
ææ/ 0
out
ææ1 4
	remainder
ææ5 >
)
ææ> ?
;
ææ? @
if
øø 
(
øø 
	remainder
øø 
>
øø 
$num
øø  !
)
øø! "
{
¿¿ 

totalPages
¡¡ 
+=
¡¡ !
$num
¡¡" #
;
¡¡# $
}
¬¬ 
}
√√  
SqlParameterHelper
≈≈ 
sph
≈≈ "
=
≈≈# $
new
≈≈% ( 
SqlParameterHelper
≈≈) ;
(
≈≈; <
ConnectionString
≈≈< L
.
≈≈L M%
GetReadConnectionString
≈≈M d
(
≈≈d e
)
≈≈e f
,
≈≈f g
$str≈≈h ã
,≈≈ã å
$num≈≈ç é
)≈≈é è
;≈≈è ê
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ "
(
∆∆" #
$str
∆∆# 0
,
∆∆0 1
	SqlDbType
∆∆2 ;
.
∆∆; <
Int
∆∆< ?
,
∆∆? @ 
ParameterDirection
∆∆A S
.
∆∆S T
Input
∆∆T Y
,
∆∆Y Z

pageNumber
∆∆[ e
)
∆∆e f
;
∆∆f g
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# .
,
««. /
	SqlDbType
««0 9
.
««9 :
Int
««: =
,
««= > 
ParameterDirection
««? Q
.
««Q R
Input
««R W
,
««W X
pageSize
««Y a
)
««a b
;
««b c
return
»» 
sph
»» 
.
»» 
ExecuteReader
»» $
(
»»$ %
)
»»% &
;
»»& '
}
   	
}
ÕÕ 
}ŒŒ ˙Æ
eD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTag.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBTag 
{ 
public 
static	 
bool 
Create 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid 
featureGuid 
, 
Guid 

moduleGuid 
, 
string 	
tagText
 
, 
DateTime 

createdUtc 
, 
Guid 
	createdBy 
, 
Guid 
vocabularyGuid 
) 
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` o
,o p
$numq r
)r s
;s t
sph 
. 
DefineSqlParameter 
( 
$str !
,! "
	SqlDbType# ,
., -
UniqueIdentifier- =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
guidY ]
)] ^
;^ _
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
siteGuid] e
)e f
;f g
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
featureGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
UniqueIdentifier3 C
,C D
ParameterDirectionE W
.W X
InputX ]
,] ^

moduleGuid_ i
)i j
;j k
sph 
. 
DefineSqlParameter 
( 
$str  
,  !
	SqlDbType" +
.+ ,
NVarChar, 4
,4 5
$num6 9
,9 :
ParameterDirection; M
.M N
InputN S
,S T
tagTextU \
)\ ]
;] ^
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
DateTime3 ;
,; <
ParameterDirection= O
.O P
InputP U
,U V

createdUtcW a
)a b
;b c
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
UniqueIdentifier2 B
,B C
ParameterDirectionD V
.V W
InputW \
,\ ]
	createdBy^ g
)g h
;h i
sph 
. 
DefineSqlParameter 
( 
$str +
,+ ,
	SqlDbType- 6
.6 7
UniqueIdentifier7 G
,G H
ParameterDirectionI [
.[ \
Input\ a
,a b
vocabularyGuidc q
)q r
;r s
return!! 	
sph!!
 
.!! 
ExecuteNonQuery!! 
(!! 
)!! 
>!!  !
$num!!" #
;!!# $
}"" 
public$$ 
static$$	 
bool$$ 
Update$$ 
($$ 
Guid%% 
guid%% 
,%% 
string&& 	
tagText&&
 
,&& 
DateTime'' 
modifiedUtc'' 
,'' 
Guid(( 

modifiedBy(( 
,(( 
Guid)) 
vocabularyGuid)) 
)** 
{++ 
SqlParameterHelper,, 
sph,, 
=,, 
new,, 
SqlParameterHelper,,  2
(,,2 3
ConnectionString,,3 C
.,,C D$
GetWriteConnectionString,,D \
(,,\ ]
),,] ^
,,,^ _
$str,,` o
,,,o p
$num,,q r
),,r s
;,,s t
sph.. 
... 
DefineSqlParameter.. 
(.. 
$str.. !
,..! "
	SqlDbType..# ,
..., -
UniqueIdentifier..- =
,..= >
ParameterDirection..? Q
...Q R
Input..R W
,..W X
guid..Y ]
)..] ^
;..^ _
sph// 
.// 
DefineSqlParameter// 
(// 
$str//  
,//  !
	SqlDbType//" +
.//+ ,
NVarChar//, 4
,//4 5
$num//6 9
,//9 :
ParameterDirection//; M
.//M N
Input//N S
,//S T
tagText//U \
)//\ ]
;//] ^
sph00 
.00 
DefineSqlParameter00 
(00 
$str00 (
,00( )
	SqlDbType00* 3
.003 4
DateTime004 <
,00< =
ParameterDirection00> P
.00P Q
Input00Q V
,00V W
modifiedUtc00X c
)00c d
;00d e
sph11 
.11 
DefineSqlParameter11 
(11 
$str11 '
,11' (
	SqlDbType11) 2
.112 3
UniqueIdentifier113 C
,11C D
ParameterDirection11E W
.11W X
Input11X ]
,11] ^

modifiedBy11_ i
)11i j
;11j k
sph22 
.22 
DefineSqlParameter22 
(22 
$str22 +
,22+ ,
	SqlDbType22- 6
.226 7
UniqueIdentifier227 G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
vocabularyGuid22c q
)22q r
;22r s
return44 	
sph44
 
.44 
ExecuteNonQuery44 
(44 
)44 
>44  !
$num44" #
;44# $
}55 
public88 
static88	 
bool88 
UpdateItemCount88 $
(88$ %
Guid88% )
guid88* .
)88. /
{99 
SqlParameterHelper:: 
sph:: 
=:: 
new:: 
SqlParameterHelper::  2
(::2 3
ConnectionString::3 C
.::C D$
GetWriteConnectionString::D \
(::\ ]
)::] ^
,::^ _
$str::` x
,::x y
$num::z {
)::{ |
;::| }
sph<< 
.<< 
DefineSqlParameter<< 
(<< 
$str<< !
,<<! "
	SqlDbType<<# ,
.<<, -
UniqueIdentifier<<- =
,<<= >
ParameterDirection<<? Q
.<<Q R
Input<<R W
,<<W X
guid<<Y ]
)<<] ^
;<<^ _
return>> 	
sph>>
 
.>> 
ExecuteNonQuery>> 
(>> 
)>> 
>>>  !
$num>>" #
;>># $
}?? 
publicFF 
staticFF	 
boolFF 
DeleteBySiteFF !
(FF! "
GuidFF" &
siteGuidFF' /
)FF/ 0
{GG 
SqlParameterHelperHH 
sphHH 
=HH 
newHH 
SqlParameterHelperHH  2
(HH2 3
ConnectionStringHH3 C
.HHC D$
GetWriteConnectionStringHHD \
(HH\ ]
)HH] ^
,HH^ _
$strHH` u
,HHu v
$numHHw x
)HHx y
;HHy z
sphJJ 
.JJ 
DefineSqlParameterJJ 
(JJ 
$strJJ %
,JJ% &
	SqlDbTypeJJ' 0
.JJ0 1
UniqueIdentifierJJ1 A
,JJA B
ParameterDirectionJJC U
.JJU V
InputJJV [
,JJ[ \
siteGuidJJ] e
)JJe f
;JJf g
returnLL 	
sphLL
 
.LL 
ExecuteNonQueryLL 
(LL 
)LL 
>LL  !
$numLL" #
;LL# $
}MM 
publicPP 
staticPP	 
boolPP 
DeletePP 
(PP 
GuidPP  
guidPP! %
)PP% &
{QQ 
SqlParameterHelperRR 
sphRR 
=RR 
newRR 
SqlParameterHelperRR  2
(RR2 3
ConnectionStringRR3 C
.RRC D$
GetWriteConnectionStringRRD \
(RR\ ]
)RR] ^
,RR^ _
$strRR` o
,RRo p
$numRRq r
)RRr s
;RRs t
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT !
,TT! "
	SqlDbTypeTT# ,
.TT, -
UniqueIdentifierTT- =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
guidTTY ]
)TT] ^
;TT^ _
returnVV 	
sphVV
 
.VV 
ExecuteNonQueryVV 
(VV 
)VV 
>VV  !
$numVV" #
;VV# $
}WW 
publicZZ 
staticZZ	 
boolZZ 
DeleteByModuleZZ #
(ZZ# $
GuidZZ$ (

moduleGuidZZ) 3
)ZZ3 4
{[[ 
SqlParameterHelper\\ 
sph\\ 
=\\ 
new\\ 
SqlParameterHelper\\  2
(\\2 3
ConnectionString\\3 C
.\\C D$
GetWriteConnectionString\\D \
(\\\ ]
)\\] ^
,\\^ _
$str\\` w
,\\w x
$num\\y z
)\\z {
;\\{ |
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ '
,^^' (
	SqlDbType^^) 2
.^^2 3
UniqueIdentifier^^3 C
,^^C D
ParameterDirection^^E W
.^^W X
Input^^X ]
,^^] ^

moduleGuid^^_ i
)^^i j
;^^j k
return`` 	
sph``
 
.`` 
ExecuteNonQuery`` 
(`` 
)`` 
>``  !
$num``" #
;``# $
}aa 
publicdd 
staticdd	 
booldd 
DeleteByFeaturedd $
(dd$ %
Guiddd% )
featureGuiddd* 5
)dd5 6
{ee 
SqlParameterHelperff 
sphff 
=ff 
newff 
SqlParameterHelperff  2
(ff2 3
ConnectionStringff3 C
.ffC D$
GetWriteConnectionStringffD \
(ff\ ]
)ff] ^
,ff^ _
$strff` x
,ffx y
$numffz {
)ff{ |
;ff| }
sphhh 
.hh 
DefineSqlParameterhh 
(hh 
$strhh (
,hh( )
	SqlDbTypehh* 3
.hh3 4
UniqueIdentifierhh4 D
,hhD E
ParameterDirectionhhF X
.hhX Y
InputhhY ^
,hh^ _
featureGuidhh` k
)hhk l
;hhl m
returnjj 	
sphjj
 
.jj 
ExecuteNonQueryjj 
(jj 
)jj 
>jj  !
$numjj" #
;jj# $
}kk 
publicrr 
staticrr	 
IDataReaderrr 
	GetOneTagrr %
(rr% &
Guidrr& *
guidrr+ /
)rr/ 0
{ss 
SqlParameterHelpertt 
sphtt 
=tt 
newtt 
SqlParameterHelpertt  2
(tt2 3
ConnectionStringtt3 C
.ttC D#
GetReadConnectionStringttD [
(tt[ \
)tt\ ]
,tt] ^
$strtt_ q
,ttq r
$numtts t
)ttt u
;ttu v
sphvv 
.vv 
DefineSqlParametervv 
(vv 
$strvv !
,vv! "
	SqlDbTypevv# ,
.vv, -
UniqueIdentifiervv- =
,vv= >
ParameterDirectionvv? Q
.vvQ R
InputvvR W
,vvW X
guidvvY ]
)vv] ^
;vv^ _
returnxx 	
sphxx
 
.xx 
ExecuteReaderxx 
(xx 
)xx 
;xx 
}yy 
public|| 
static||	 
int|| 
GetCount|| 
(|| 
Guid|| !
guid||" &
,||& '
string||( .
type||/ 3
=||3 4
$str||4 :
)||: ;
{}} 
SqlParameterHelper~~ 
sph~~ 
=~~ 
null~~  
;~~  !
switch 	
(
 
type 
) 
{
ÄÄ 
case
ÅÅ 
$str
ÅÅ	 
:
ÅÅ 
sph
ÇÇ 
=
ÇÇ	 

new
ÇÇ  
SqlParameterHelper
ÇÇ !
(
ÇÇ! "
ConnectionString
ÇÇ" 2
.
ÇÇ2 3%
GetReadConnectionString
ÇÇ3 J
(
ÇÇJ K
)
ÇÇK L
,
ÇÇL M
$str
ÇÇN g
,
ÇÇg h
$num
ÇÇi j
)
ÇÇj k
;
ÇÇk l
sph
ÉÉ 
.
ÉÉ 	 
DefineSqlParameter
ÉÉ	 
(
ÉÉ 
$str
ÉÉ #
,
ÉÉ# $
	SqlDbType
ÉÉ% .
.
ÉÉ. /
UniqueIdentifier
ÉÉ/ ?
,
ÉÉ? @ 
ParameterDirection
ÉÉA S
.
ÉÉS T
Input
ÉÉT Y
,
ÉÉY Z
guid
ÉÉ[ _
)
ÉÉ_ `
;
ÉÉ` a
break
ÑÑ 

;
ÑÑ
 
case
ÖÖ 
$str
ÖÖ	 
:
ÖÖ 
default
ÜÜ 
:
ÜÜ 
sph
áá 
=
áá	 

new
áá  
SqlParameterHelper
áá !
(
áá! "
ConnectionString
áá" 2
.
áá2 3%
GetReadConnectionString
áá3 J
(
ááJ K
)
ááK L
,
ááL M
$str
ááN e
,
ááe f
$num
áág h
)
ááh i
;
áái j
sph
àà 
.
àà 	 
DefineSqlParameter
àà	 
(
àà 
$str
àà #
,
àà# $
	SqlDbType
àà% .
.
àà. /
UniqueIdentifier
àà/ ?
,
àà? @ 
ParameterDirection
ààA S
.
ààS T
Input
ààT Y
,
ààY Z
guid
àà[ _
)
àà_ `
;
àà` a
break
ââ 

;
ââ
 
case
ää 
$str
ää	 
:
ää 
sph
ãã 
=
ãã	 

new
ãã  
SqlParameterHelper
ãã !
(
ãã! "
ConnectionString
ãã" 2
.
ãã2 3%
GetReadConnectionString
ãã3 J
(
ããJ K
)
ããK L
,
ããL M
$str
ããN h
,
ããh i
$num
ããj k
)
ããk l
;
ããl m
sph
åå 
.
åå 	 
DefineSqlParameter
åå	 
(
åå 
$str
åå #
,
åå# $
	SqlDbType
åå% .
.
åå. /
UniqueIdentifier
åå/ ?
,
åå? @ 
ParameterDirection
ååA S
.
ååS T
Input
ååT Y
,
ååY Z
guid
åå[ _
)
åå_ `
;
åå` a
break
çç 

;
çç
 
}
éé 
return
èè 	
Convert
èè
 
.
èè 
ToInt32
èè 
(
èè 
sph
èè 
.
èè 
ExecuteScalar
èè +
(
èè+ ,
)
èè, -
)
èè- .
;
èè. /
}
êê 
public
ìì 
static
ìì	 
IDataReader
ìì 
	GetBySite
ìì %
(
ìì% &
Guid
ìì& *
siteGuid
ìì+ 3
)
ìì3 4
{
îî  
SqlParameterHelper
ïï 
sph
ïï 
=
ïï 
new
ïï  
SqlParameterHelper
ïï  2
(
ïï2 3
ConnectionString
ïï3 C
.
ïïC D%
GetReadConnectionString
ïïD [
(
ïï[ \
)
ïï\ ]
,
ïï] ^
$str
ïï_ x
,
ïïx y
$num
ïïz {
)
ïï{ |
;
ïï| }
sph
óó 
.
óó  
DefineSqlParameter
óó 
(
óó 
$str
óó !
,
óó! "
	SqlDbType
óó# ,
.
óó, -
UniqueIdentifier
óó- =
,
óó= > 
ParameterDirection
óó? Q
.
óóQ R
Input
óóR W
,
óóW X
siteGuid
óóY a
)
óóa b
;
óób c
return
ôô 	
sph
ôô
 
.
ôô 
ExecuteReader
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 
public
ùù 
static
ùù	 
IDataReader
ùù 
	GetBySite
ùù %
(
ùù% &
int
ùù& )
siteId
ùù* 0
)
ùù0 1
{
ûû  
SqlParameterHelper
üü 
sph
üü 
=
üü 
new
üü  
SqlParameterHelper
üü  2
(
üü2 3
ConnectionString
üü3 C
.
üüC D%
GetReadConnectionString
üüD [
(
üü[ \
)
üü\ ]
,
üü] ^
$str
üü_ t
,
üüt u
$num
üüv w
)
üüw x
;
üüx y
sph
°° 
.
°°  
DefineSqlParameter
°° 
(
°° 
$str
°° 
,
°°  
	SqlDbType
°°! *
.
°°* +
Int
°°+ .
,
°°. / 
ParameterDirection
°°0 B
.
°°B C
Input
°°C H
,
°°H I
siteId
°°J P
)
°°P Q
;
°°Q R
return
££ 	
sph
££
 
.
££ 
ExecuteReader
££ 
(
££ 
)
££ 
;
££ 
}
§§ 
public
ßß 
static
ßß	 
IDataReader
ßß 
GetByModule
ßß '
(
ßß' (
Guid
ßß( ,
siteGuid
ßß- 5
,
ßß5 6
Guid
ßß7 ;

moduleGuid
ßß< F
)
ßßF G
{
®®  
SqlParameterHelper
©© 
sph
©© 
=
©© 
new
©©  
SqlParameterHelper
©©  2
(
©©2 3
ConnectionString
©©3 C
.
©©C D%
GetReadConnectionString
©©D [
(
©©[ \
)
©©\ ]
,
©©] ^
$str
©©_ v
,
©©v w
$num
©©x y
)
©©y z
;
©©z {
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ !
,
´´! "
	SqlDbType
´´# ,
.
´´, -
UniqueIdentifier
´´- =
,
´´= > 
ParameterDirection
´´? Q
.
´´Q R
Input
´´R W
,
´´W X

moduleGuid
´´Y c
)
´´c d
;
´´d e
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ 
(
¨¨ 
$str
¨¨ %
,
¨¨% &
	SqlDbType
¨¨' 0
.
¨¨0 1
UniqueIdentifier
¨¨1 A
,
¨¨A B 
ParameterDirection
¨¨C U
.
¨¨U V
Input
¨¨V [
,
¨¨[ \
siteGuid
¨¨] e
)
¨¨e f
;
¨¨f g
return
ÆÆ 	
sph
ÆÆ
 
.
ÆÆ 
ExecuteReader
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ØØ 
public
≤≤ 
static
≤≤	 
IDataReader
≤≤ 
GetByFeature
≤≤ (
(
≤≤( )
Guid
≤≤) -
siteGuid
≤≤. 6
,
≤≤6 7
Guid
≤≤8 <
featureGuid
≤≤= H
)
≤≤H I
{
≥≥  
SqlParameterHelper
¥¥ 
sph
¥¥ 
=
¥¥ 
new
¥¥  
SqlParameterHelper
¥¥  2
(
¥¥2 3
ConnectionString
¥¥3 C
.
¥¥C D%
GetReadConnectionString
¥¥D [
(
¥¥[ \
)
¥¥\ ]
,
¥¥] ^
$str
¥¥_ w
,
¥¥w x
$num
¥¥y z
)
¥¥z {
;
¥¥{ |
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ 
(
∂∂ 
$str
∂∂ !
,
∂∂! "
	SqlDbType
∂∂# ,
.
∂∂, -
UniqueIdentifier
∂∂- =
,
∂∂= > 
ParameterDirection
∂∂? Q
.
∂∂Q R
Input
∂∂R W
,
∂∂W X
featureGuid
∂∂Y d
)
∂∂d e
;
∂∂e f
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ 
(
∑∑ 
$str
∑∑ %
,
∑∑% &
	SqlDbType
∑∑' 0
.
∑∑0 1
UniqueIdentifier
∑∑1 A
,
∑∑A B 
ParameterDirection
∑∑C U
.
∑∑U V
Input
∑∑V [
,
∑∑[ \
siteGuid
∑∑] e
)
∑∑e f
;
∑∑f g
return
ππ 	
sph
ππ
 
.
ππ 
ExecuteReader
ππ 
(
ππ 
)
ππ 
;
ππ 
}
∫∫ 
public
ΩΩ 
static
ΩΩ	 
IDataReader
ΩΩ 
GetByVocabulary
ΩΩ +
(
ΩΩ+ ,
Guid
ΩΩ, 0
siteGuid
ΩΩ1 9
,
ΩΩ9 :
Guid
ΩΩ; ?
vocabularyGuid
ΩΩ@ N
)
ΩΩN O
{
ææ  
SqlParameterHelper
øø 
sph
øø 
=
øø 
new
øø  
SqlParameterHelper
øø  2
(
øø2 3
ConnectionString
øø3 C
.
øøC D%
GetReadConnectionString
øøD [
(
øø[ \
)
øø\ ]
,
øø] ^
$str
øø_ z
,
øøz {
$num
øø| }
)
øø} ~
;
øø~ 
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ 
(
¡¡ 
$str
¡¡ !
,
¡¡! "
	SqlDbType
¡¡# ,
.
¡¡, -
UniqueIdentifier
¡¡- =
,
¡¡= > 
ParameterDirection
¡¡? Q
.
¡¡Q R
Input
¡¡R W
,
¡¡W X
vocabularyGuid
¡¡Y g
)
¡¡g h
;
¡¡h i
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ %
,
¬¬% &
	SqlDbType
¬¬' 0
.
¬¬0 1
UniqueIdentifier
¬¬1 A
,
¬¬A B 
ParameterDirection
¬¬C U
.
¬¬U V
Input
¬¬V [
,
¬¬[ \
siteGuid
¬¬] e
)
¬¬e f
;
¬¬f g
return
ƒƒ 	
sph
ƒƒ
 
.
ƒƒ 
ExecuteReader
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 
}
»» 
}…… åv
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTagItem.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
	DBTagItem 
{ 
public 
static	 
bool 
Create 
( 
Guid 
tagItemGuid 
, 
Guid 
siteGuid 
, 
Guid 
featureGuid 
, 
Guid 

moduleGuid 
, 
Guid 
relatedItemGuid 
, 
Guid 
tagGuid 
, 
Guid 
	extraGuid 
, 
Guid 
taggedBy 
) 
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` s
,s t
$numu v
)v w
;w x
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
tagItemGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
siteGuid] e
)e f
;f g
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
featureGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
UniqueIdentifier3 C
,C D
ParameterDirectionE W
.W X
InputX ]
,] ^

moduleGuid_ i
)i j
;j k
sph 
. 
DefineSqlParameter 
( 
$str ,
,, -
	SqlDbType. 7
.7 8
UniqueIdentifier8 H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c
relatedItemGuidd s
)s t
;t u
sph 
. 
DefineSqlParameter 
( 
$str $
,$ %
	SqlDbType& /
./ 0
UniqueIdentifier0 @
,@ A
ParameterDirectionB T
.T U
InputU Z
,Z [
tagGuid\ c
)c d
;d e
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
UniqueIdentifier2 B
,B C
ParameterDirectionD V
.V W
InputW \
,\ ]
	extraGuid^ g
)g h
;h i
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
taggedBy] e
)e f
;f g
return!! 	
sph!!
 
.!! 
ExecuteNonQuery!! 
(!! 
)!! 
>!!  !
$num!!" #
;!!# $
}"" 
public)) 
static))	 
bool)) 
DeleteBySite)) !
())! "
Guid))" &
siteGuid))' /
)))/ 0
{** 
SqlParameterHelper++ 
sph++ 
=++ 
new++ 
SqlParameterHelper++  2
(++2 3
ConnectionString++3 C
.++C D$
GetWriteConnectionString++D \
(++\ ]
)++] ^
,++^ _
$str++` y
,++y z
$num++{ |
)++| }
;++} ~
sph-- 
.-- 
DefineSqlParameter-- 
(-- 
$str-- %
,--% &
	SqlDbType--' 0
.--0 1
UniqueIdentifier--1 A
,--A B
ParameterDirection--C U
.--U V
Input--V [
,--[ \
siteGuid--] e
)--e f
;--f g
return// 	
sph//
 
.// 
ExecuteNonQuery// 
(// 
)// 
>//  !
$num//" #
;//# $
}00 
public33 
static33	 
bool33 
Delete33 
(33 
Guid33  
tagItemGuid33! ,
)33, -
{44 
SqlParameterHelper55 
sph55 
=55 
new55 
SqlParameterHelper55  2
(552 3
ConnectionString553 C
.55C D$
GetWriteConnectionString55D \
(55\ ]
)55] ^
,55^ _
$str55` s
,55s t
$num55u v
)55v w
;55w x
sph77 
.77 
DefineSqlParameter77 
(77 
$str77 (
,77( )
	SqlDbType77* 3
.773 4
UniqueIdentifier774 D
,77D E
ParameterDirection77F X
.77X Y
Input77Y ^
,77^ _
tagItemGuid77` k
)77k l
;77l m
return99 	
sph99
 
.99 
ExecuteNonQuery99 
(99 
)99 
>99  !
$num99" #
;99# $
}:: 
public== 
static==	 
bool== 
DeleteByTag==  
(==  !
Guid==! %
tagGuid==& -
)==- .
{>> 
SqlParameterHelper?? 
sph?? 
=?? 
new?? 
SqlParameterHelper??  2
(??2 3
ConnectionString??3 C
.??C D$
GetWriteConnectionString??D \
(??\ ]
)??] ^
,??^ _
$str??` x
,??x y
$num??z {
)??{ |
;??| }
sphAA 
.AA 
DefineSqlParameterAA 
(AA 
$strAA $
,AA$ %
	SqlDbTypeAA& /
.AA/ 0
UniqueIdentifierAA0 @
,AA@ A
ParameterDirectionAAB T
.AAT U
InputAAU Z
,AAZ [
tagGuidAA\ c
)AAc d
;AAd e
returnCC 	
sphCC
 
.CC 
ExecuteNonQueryCC 
(CC 
)CC 
>CC  !
$numCC" #
;CC# $
}DD 
publicGG 
staticGG	 
boolGG 
DeleteByModuleGG #
(GG# $
GuidGG$ (

moduleGuidGG) 3
)GG3 4
{HH 
SqlParameterHelperII 
sphII 
=II 
newII 
SqlParameterHelperII  2
(II2 3
ConnectionStringII3 C
.IIC D$
GetWriteConnectionStringIID \
(II\ ]
)II] ^
,II^ _
$strII` {
,II{ |
$numII} ~
)II~ 
;	II Ä
sphKK 
.KK 
DefineSqlParameterKK 
(KK 
$strKK '
,KK' (
	SqlDbTypeKK) 2
.KK2 3
UniqueIdentifierKK3 C
,KKC D
ParameterDirectionKKE W
.KKW X
InputKKX ]
,KK] ^

moduleGuidKK_ i
)KKi j
;KKj k
returnMM 	
sphMM
 
.MM 
ExecuteNonQueryMM 
(MM 
)MM 
>MM  !
$numMM" #
;MM# $
}NN 
publicQQ 
staticQQ	 
boolQQ 
DeleteByFeatureQQ $
(QQ$ %
GuidQQ% )
featureGuidQQ* 5
)QQ5 6
{RR 
SqlParameterHelperSS 
sphSS 
=SS 
newSS 
SqlParameterHelperSS  2
(SS2 3
ConnectionStringSS3 C
.SSC D$
GetWriteConnectionStringSSD \
(SS\ ]
)SS] ^
,SS^ _
$strSS` |
,SS| }
$numSS~ 
)	SS Ä
;
SSÄ Å
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU (
,UU( )
	SqlDbTypeUU* 3
.UU3 4
UniqueIdentifierUU4 D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _
featureGuidUU` k
)UUk l
;UUl m
returnWW 	
sphWW
 
.WW 
ExecuteNonQueryWW 
(WW 
)WW 
>WW  !
$numWW" #
;WW# $
}XX 
public[[ 
static[[	 
bool[[ 
DeleteByRelatedItem[[ (
([[( )
Guid[[) -
relatedItemGuid[[. =
)[[= >
{\\ 
SqlParameterHelper]] 
sph]] 
=]] 
new]] 
SqlParameterHelper]]  2
(]]2 3
ConnectionString]]3 C
.]]C D$
GetWriteConnectionString]]D \
(]]\ ]
)]]] ^
,]]^ _
$str	]]` Ä
,
]]Ä Å
$num
]]Ç É
)
]]É Ñ
;
]]Ñ Ö
sph__ 
.__ 
DefineSqlParameter__ 
(__ 
$str__ ,
,__, -
	SqlDbType__. 7
.__7 8
UniqueIdentifier__8 H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
relatedItemGuid__d s
)__s t
;__t u
returnaa 	
sphaa
 
.aa 
ExecuteNonQueryaa 
(aa 
)aa 
>aa  !
$numaa" #
;aa# $
}bb 
publicee 
staticee	 
boolee 
DeleteByExtraGuidee &
(ee& '
Guidee' +
	extraGuidee, 5
)ee5 6
{ff 
SqlParameterHelpergg 
sphgg 
=gg 
newgg 
SqlParameterHelpergg  2
(gg2 3
ConnectionStringgg3 C
.ggC D$
GetWriteConnectionStringggD \
(gg\ ]
)gg] ^
,gg^ _
$strgg` ~
,gg~ 
$num
ggÄ Å
)
ggÅ Ç
;
ggÇ É
sphii 
.ii 
DefineSqlParameterii 
(ii 
$strii &
,ii& '
	SqlDbTypeii( 1
.ii1 2
UniqueIdentifierii2 B
,iiB C
ParameterDirectioniiD V
.iiV W
InputiiW \
,ii\ ]
	extraGuidii^ g
)iig h
;iih i
returnkk 	
sphkk
 
.kk 
ExecuteNonQuerykk 
(kk 
)kk 
>kk  !
$numkk" #
;kk# $
}ll 
publicss 
staticss	 
IDataReaderss 
GetByTagItemss (
(ss( )
Guidss) -
tagItemGuidss. 9
)ss9 :
{tt 
SqlParameterHelperuu 
sphuu 
=uu 
newuu 
SqlParameterHelperuu  2
(uu2 3
ConnectionStringuu3 C
.uuC D$
GetWriteConnectionStringuuD \
(uu\ ]
)uu] ^
,uu^ _
$struu` y
,uuy z
$numuu{ |
)uu| }
;uu} ~
sphww 
.ww 
DefineSqlParameterww 
(ww 
$strww (
,ww( )
	SqlDbTypeww* 3
.ww3 4
UniqueIdentifierww4 D
,wwD E
ParameterDirectionwwF X
.wwX Y
InputwwY ^
,ww^ _
tagItemGuidww` k
)wwk l
;wwl m
returnyy 	
sphyy
 
.yy 
ExecuteReaderyy 
(yy 
)yy 
;yy 
}zz 
public}} 
static}}	 
IDataReader}} 
GetByRelatedItem}} ,
(}}, -
Guid}}- 1
siteGuid}}2 :
,}}: ;
Guid}}< @
relatedItemGuid}}A P
)}}P Q
{~~ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` }
,} ~
$num	 Ä
)
Ä Å
;
Å Ç
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ 
(
ÅÅ 
$str
ÅÅ ,
,
ÅÅ, -
	SqlDbType
ÅÅ. 7
.
ÅÅ7 8
UniqueIdentifier
ÅÅ8 H
,
ÅÅH I 
ParameterDirection
ÅÅJ \
.
ÅÅ\ ]
Input
ÅÅ] b
,
ÅÅb c
relatedItemGuid
ÅÅd s
)
ÅÅs t
;
ÅÅt u
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ 
(
ÇÇ 
$str
ÇÇ %
,
ÇÇ% &
	SqlDbType
ÇÇ' 0
.
ÇÇ0 1
UniqueIdentifier
ÇÇ1 A
,
ÇÇA B 
ParameterDirection
ÇÇC U
.
ÇÇU V
Input
ÇÇV [
,
ÇÇ[ \
siteGuid
ÇÇ] e
)
ÇÇe f
;
ÇÇf g
return
ÑÑ 	
sph
ÑÑ
 
.
ÑÑ 
ExecuteReader
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÖÖ 
public
àà 
static
àà	 
IDataReader
àà 

GetByExtra
àà &
(
àà& '
Guid
àà' +
siteGuid
àà, 4
,
àà4 5
Guid
àà6 :
	extraGuid
àà; D
)
ààD E
{
ââ  
SqlParameterHelper
ää 
sph
ää 
=
ää 
new
ää  
SqlParameterHelper
ää  2
(
ää2 3
ConnectionString
ää3 C
.
ääC D&
GetWriteConnectionString
ääD \
(
ää\ ]
)
ää] ^
,
ää^ _
$str
ää` w
,
ääw x
$num
ääy z
)
ääz {
;
ää{ |
sph
åå 
.
åå  
DefineSqlParameter
åå 
(
åå 
$str
åå &
,
åå& '
	SqlDbType
åå( 1
.
åå1 2
UniqueIdentifier
åå2 B
,
ååB C 
ParameterDirection
ååD V
.
ååV W
Input
ååW \
,
åå\ ]
	extraGuid
åå^ g
)
ååg h
;
ååh i
sph
çç 
.
çç  
DefineSqlParameter
çç 
(
çç 
$str
çç %
,
çç% &
	SqlDbType
çç' 0
.
çç0 1
UniqueIdentifier
çç1 A
,
ççA B 
ParameterDirection
ççC U
.
ççU V
Input
ççV [
,
çç[ \
siteGuid
çç] e
)
ççe f
;
ççf g
return
èè 	
sph
èè
 
.
èè 
ExecuteReader
èè 
(
èè 
)
èè 
;
èè 
}
êê 
}
ìì 
}îî ß
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTagVocabulary.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
class 
DBTagVocabulary 
{ 
} 
} ©Q
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserClaims.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBUserClaims $
{ 
public 
static 
int 
Create  
(  !
string 
userId 
, 
string 
	claimType 
, 
string 

claimValue 
) 
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri 
,	 Ä
$num
Å Ç
)
Ç É
;
É Ñ
sph 
. 
DefineSqlParameter "
(" #
$str# ,
,, -
	SqlDbType. 7
.7 8
NVarChar8 @
,@ A
$numB E
,E F
ParameterDirectionG Y
.Y Z
InputZ _
,_ `
userIda g
)g h
;h i
sph 
. 
DefineSqlParameter "
(" #
$str# /
,/ 0
	SqlDbType1 :
.: ;
NVarChar; C
,C D
-E F
$numF G
,G H
ParameterDirectionI [
.[ \
Input\ a
,a b
	claimTypec l
)l m
;m n
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
NVarChar< D
,D E
-F G
$numG H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c

claimValued n
)n o
;o p
int   
newID   
=   
Convert   
.    
ToInt32    '
(  ' (
sph  ( +
.  + ,
ExecuteScalar  , 9
(  9 :
)  : ;
)  ; <
;  < =
return!! 
newID!! 
;!! 
}"" 	
public'' 
static'' 
bool'' 
Delete'' !
(''! "
int''" %
id''& (
)''( )
{(( 	
SqlParameterHelper)) 
sph)) "
=))# $
new))% (
SqlParameterHelper))) ;
()); <
ConnectionString))< L
.))L M$
GetWriteConnectionString))M e
())e f
)))f g
,))g h
$str))i 
,	)) Ä
$num
))Å Ç
)
))Ç É
;
))É Ñ
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# (
,**( )
	SqlDbType*** 3
.**3 4
Int**4 7
,**7 8
ParameterDirection**9 K
.**K L
Input**L Q
,**Q R
id**S U
)**U V
;**V W
int++ 
rowsAffected++ 
=++ 
sph++ "
.++" #
ExecuteNonQuery++# 2
(++2 3
)++3 4
;++4 5
return,, 
(,, 
rowsAffected,,  
>,,! "
$num,,# $
),,$ %
;,,% &
}.. 	
public00 
static00 
bool00 
DeleteByUser00 '
(00' (
string00( .
userId00/ 5
)005 6
{11 	
SqlParameterHelper22 
sph22 "
=22# $
new22% (
SqlParameterHelper22) ;
(22; <
ConnectionString22< L
.22L M$
GetWriteConnectionString22M e
(22e f
)22f g
,22g h
$str	22i Ö
,
22Ö Ü
$num
22á à
)
22à â
;
22â ä
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# ,
,33, -
	SqlDbType33. 7
.337 8
NVarChar338 @
,33@ A
$num33B E
,33E F
ParameterDirection33G Y
.33Y Z
Input33Z _
,33_ `
userId33a g
)33g h
;33h i
int44 
rowsAffected44 
=44 
sph44 "
.44" #
ExecuteNonQuery44# 2
(442 3
)443 4
;444 5
return55 
(55 
rowsAffected55  
>55! "
$num55# $
)55$ %
;55% &
}77 	
public99 
static99 
bool99 
DeleteByUser99 '
(99' (
string99( .
userId99/ 5
,995 6
string997 =
	claimType99> G
)99G H
{:: 	
SqlParameterHelper;; 
sph;; "
=;;# $
new;;% (
SqlParameterHelper;;) ;
(;;; <
ConnectionString;;< L
.;;L M$
GetWriteConnectionString;;M e
(;;e f
);;f g
,;;g h
$str	;;i ã
,
;;ã å
$num
;;ç é
)
;;é è
;
;;è ê
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# ,
,<<, -
	SqlDbType<<. 7
.<<7 8
NVarChar<<8 @
,<<@ A
$num<<B E
,<<E F
ParameterDirection<<G Y
.<<Y Z
Input<<Z _
,<<_ `
userId<<a g
)<<g h
;<<h i
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# /
,==/ 0
	SqlDbType==1 :
.==: ;
NVarChar==; C
,==C D
-==E F
$num==F G
,==G H
ParameterDirection==I [
.==[ \
Input==\ a
,==a b
	claimType==c l
)==l m
;==m n
int>> 
rowsAffected>> 
=>> 
sph>> "
.>>" #
ExecuteNonQuery>># 2
(>>2 3
)>>3 4
;>>4 5
return?? 
(?? 
rowsAffected??  
>??! "
$num??# $
)??$ %
;??% &
}AA 	
publicCC 
staticCC 
boolCC 
DeleteByUserCC '
(CC' (
stringCC( .
userIdCC/ 5
,CC5 6
stringCC7 =
	claimTypeCC> G
,CCG H
stringCCI O

claimValueCCP Z
)CCZ [
{DD 	
SqlParameterHelperEE 
sphEE "
=EE# $
newEE% (
SqlParameterHelperEE) ;
(EE; <
ConnectionStringEE< L
.EEL M$
GetWriteConnectionStringEEM e
(EEe f
)EEf g
,EEg h
$str	EEi ä
,
EEä ã
$num
EEå ç
)
EEç é
;
EEé è
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# ,
,FF, -
	SqlDbTypeFF. 7
.FF7 8
NVarCharFF8 @
,FF@ A
$numFFB E
,FFE F
ParameterDirectionFFG Y
.FFY Z
InputFFZ _
,FF_ `
userIdFFa g
)FFg h
;FFh i
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# /
,GG/ 0
	SqlDbTypeGG1 :
.GG: ;
NVarCharGG; C
,GGC D
-GGE F
$numGGF G
,GGG H
ParameterDirectionGGI [
.GG[ \
InputGG\ a
,GGa b
	claimTypeGGc l
)GGl m
;GGm n
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
NVarCharHH< D
,HHD E
-HHF G
$numHHG H
,HHH I
ParameterDirectionHHJ \
.HH\ ]
InputHH] b
,HHb c

claimValueHHd n
)HHn o
;HHo p
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicNN 
staticNN 
boolNN 
DeleteBySiteNN '
(NN' (
GuidNN( ,
siteGuidNN- 5
)NN5 6
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$str	PPi Ö
,
PPÖ Ü
$num
PPá à
)
PPà â
;
PPâ ä
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
UniqueIdentifierQQ: J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
siteGuidQQf n
)QQn o
;QQo p
intRR 
rowsAffectedRR 
=RR 
sphRR "
.RR" #
ExecuteNonQueryRR# 2
(RR2 3
)RR3 4
;RR4 5
returnSS 
(SS 
rowsAffectedSS  
>SS! "
$numSS# $
)SS$ %
;SS% &
}UU 	
publicXX 
staticXX 
IDataReaderXX !
	GetByUserXX" +
(XX+ ,
stringXX, 2
userIdXX3 9
)XX9 :
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh Ñ
,
ZZÑ Ö
$num
ZZÜ á
)
ZZá à
;
ZZà â
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# ,
,[[, -
	SqlDbType[[. 7
.[[7 8
NVarChar[[8 @
,[[@ A
$num[[B E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
userId[[a g
)[[g h
;[[h i
return\\ 
sph\\ 
.\\ 
ExecuteReader\\ $
(\\$ %
)\\% &
;\\& '
}^^ 	
}bb 
}dd ÍF
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserLogins.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBUserLogins !
{ 
public 
static 
bool 
Create !
(! "
string" (
loginProvider) 6
,6 7
string8 >
providerKey? J
,J K
stringL R
userIdS Y
)Y Z
{ 
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri 
,	 Ä
$num
Å Ç
)
Ç É
;
É Ñ
sph 
. 
DefineSqlParameter "
(" #
$str# 3
,3 4
	SqlDbType5 >
.> ?
NVarChar? G
,G H
$numI L
,L M
ParameterDirectionN `
.` a
Inputa f
,f g
loginProviderh u
)u v
;v w
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
NVarChar4 <
,< =
$num> A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
providerKey] h
)h i
;i j
sph   
.   
DefineSqlParameter   
(   
$str   #
,  # $
	SqlDbType  % .
.  . /
NVarChar  / 7
,  7 8
$num  9 <
,  < =
ParameterDirection  > P
.  P Q
Input  Q V
,  V W
userId  X ^
)  ^ _
;  _ `
int$$ 
rowsAffected$$ 
=$$ 
sph$$ "
.$$" #
ExecuteNonQuery$$# 2
($$2 3
)$$3 4
;$$4 5
return%% 
(%% 
rowsAffected%%  
>%%! "
$num%%# $
)%%$ %
;%%% &
}&& 
public00 
static00	 
bool00 
Delete00 
(00 
string00 "
loginProvider00# 0
,000 1
string002 8
providerKey009 D
,00D E
string00F L
userId00M S
)00S T
{11 
SqlParameterHelper22 
sph22 
=22 
new22 
SqlParameterHelper22  2
(222 3
ConnectionString223 C
.22C D$
GetWriteConnectionString22D \
(22\ ]
)22] ^
,22^ _
$str22` v
,22v w
$num22x y
)22y z
;22z {
sph33 
.33 
DefineSqlParameter33 
(33 
$str33 *
,33* +
	SqlDbType33, 5
.335 6
NVarChar336 >
,33> ?
$num33@ C
,33C D
ParameterDirection33E W
.33W X
Input33X ]
,33] ^
loginProvider33_ l
)33l m
;33m n
sph44 
.44 
DefineSqlParameter44 
(44 
$str44 (
,44( )
	SqlDbType44* 3
.443 4
NVarChar444 <
,44< =
$num44> A
,44A B
ParameterDirection44C U
.44U V
Input44V [
,44[ \
providerKey44] h
)44h i
;44i j
sph55 
.55 
DefineSqlParameter55 
(55 
$str55 #
,55# $
	SqlDbType55% .
.55. /
NVarChar55/ 7
,557 8
$num559 <
,55< =
ParameterDirection55> P
.55P Q
Input55Q V
,55V W
userId55X ^
)55^ _
;55_ `
int66 
rowsAffected66 
=66 
sph66 
.66 
ExecuteNonQuery66 )
(66) *
)66* +
;66+ ,
return77 	
(77
 
rowsAffected77 
>77 
$num77 
)77 
;77 
}99 
public;; 
static;; 
bool;; 
DeleteByUser;; '
(;;' (
string;;( .
userId;;/ 5
);;5 6
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str	==i Ö
,
==Ö Ü
$num
==á à
)
==à â
;
==â ä
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># ,
,>>, -
	SqlDbType>>. 7
.>>7 8
NVarChar>>8 @
,>>@ A
$num>>B E
,>>E F
ParameterDirection>>G Y
.>>Y Z
Input>>Z _
,>>_ `
userId>>a g
)>>g h
;>>h i
int?? 
rowsAffected?? 
=?? 
sph?? "
.??" #
ExecuteNonQuery??# 2
(??2 3
)??3 4
;??4 5
return@@ 
(@@ 
rowsAffected@@  
>@@! "
$num@@# $
)@@$ %
;@@% &
}BB 	
publicDD 
staticDD 
boolDD 
DeleteBySiteDD '
(DD' (
GuidDD( ,
siteGuidDD- 5
)DD5 6
{EE 	
SqlParameterHelperFF 
sphFF "
=FF# $
newFF% (
SqlParameterHelperFF) ;
(FF; <
ConnectionStringFF< L
.FFL M$
GetWriteConnectionStringFFM e
(FFe f
)FFf g
,FFg h
$str	FFi Ö
,
FFÖ Ü
$num
FFá à
)
FFà â
;
FFâ ä
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# .
,GG. /
	SqlDbTypeGG0 9
.GG9 :
UniqueIdentifierGG: J
,GGJ K
ParameterDirectionGGL ^
.GG^ _
InputGG_ d
,GGd e
siteGuidGGf n
)GGn o
;GGo p
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
(II 
rowsAffectedII  
>II! "
$numII# $
)II$ %
;II% &
}KK 	
publicMM 
staticMM 
IDataReaderMM !
FindMM" &
(MM& '
stringMM' -
loginProviderMM. ;
,MM; <
stringMM= C
providerKeyMMD O
)MMO P
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$strOOh |
,OO| }
$numOO~ 
)	OO Ä
;
OOÄ Å
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 3
,PP3 4
	SqlDbTypePP5 >
.PP> ?
NVarCharPP? G
,PPG H
$numPPI L
,PPL M
ParameterDirectionPPN `
.PP` a
InputPPa f
,PPf g
loginProviderPPh u
)PPu v
;PPv w
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
providerKeyQQf q
)QQq r
;QQr s
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}TT 	
publicWW 
staticWW	 
IDataReaderWW 
	GetByUserWW %
(WW% &
stringWW& ,
userIdWW. 4
)WW4 5
{XX 
SqlParameterHelperYY 
sphYY "
=YY# $
newYY% (
SqlParameterHelperYY) ;
(YY; <
ConnectionStringYY< L
.YYL M#
GetReadConnectionStringYYM d
(YYd e
)YYe f
,YYf g
$str	YYh Ñ
,
YYÑ Ö
$num
YYÜ á
)
YYá à
;
YYà â
sphZZ 
.ZZ 
DefineSqlParameterZZ 
(ZZ 
$strZZ #
,ZZ# $
	SqlDbTypeZZ% .
.ZZ. /
NVarCharZZ/ 7
,ZZ7 8
$numZZ9 <
,ZZ< =
ParameterDirectionZZ> P
.ZZP Q
InputZZQ V
,ZZV W
userIdZZX ^
)ZZ^ _
;ZZ_ `
return[[ 	
sph[[
 
.[[ 
ExecuteReader[[ 
([[ 
)[[ 
;[[ 
}]] 
}aa 
}cc ·$
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SqlParameterCache.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

sealed 
class 
SqlParameterCache )
{ 
private 
SqlParameterCache !
(! "
)" #
{$ %
}& '
private"" 
static"" 
	Hashtable""  

paramCache""! +
="", -
	Hashtable"". 7
.""7 8
Synchronized""8 D
(""D E
new""E H
	Hashtable""I R
(""R S
)""S T
)""T U
;""U V
public'' 
static'' 
SqlParameter'' "
[''" #
]''# $
CloneParameters''% 4
(''4 5
SqlParameter''5 A
[''A B
]''B C
originalParameters''D V
)''V W
{(( 	
SqlParameter)) 
[)) 
])) 
clonedParameters)) +
=)), -
new)). 1
SqlParameter))2 >
[))> ?
originalParameters))? Q
.))Q R
Length))R X
]))X Y
;))Y Z
for++ 
(++ 
int++ 
i++ 
=++ 
$num++ 
,++ 
j++ 
=++ 
originalParameters++  2
.++2 3
Length++3 9
;++9 :
i++; <
<++= >
j++? @
;++@ A
i++B C
++++C E
)++E F
{,, 
clonedParameters--  
[--  !
i--! "
]--" #
=--$ %
(--& '
SqlParameter--' 3
)--3 4
(--4 5
(--5 6

ICloneable--6 @
)--@ A
originalParameters--A S
[--S T
i--T U
]--U V
)--V W
.--W X
Clone--X ]
(--] ^
)--^ _
;--_ `
}.. 
return00 
clonedParameters00 #
;00# $
}11 	
public>> 
static>> 
void>> "
AddParameterSetToCache>> 1
(>>1 2
string>>2 8
connectionString>>9 I
,>>I J
string>>K Q
storedProcedure>>R a
,>>a b
SqlParameter>>c o
[>>o p
]>>p q

parameters>>r |
)>>| }
{?? 	
string@@ 
key@@ 
=@@ 
CreateHashKey@@ &
(@@& '
connectionString@@' 7
,@@7 8
storedProcedure@@9 H
)@@H I
;@@I J

paramCacheAA 
[AA 
keyAA 
]AA 
=AA 

parametersAA (
;AA( )
}BB 	
publicGG 
staticGG 
SqlParameterGG "
[GG" #
]GG# $!
GetCachedParameterSetGG% :
(GG: ;
stringGG; A
connectionStringGGB R
,GGR S
stringGGT Z
storedProcedureGG[ j
)GGj k
{HH 	
stringII 
keyII 
=II 
CreateHashKeyII &
(II& '
connectionStringII' 7
,II7 8
storedProcedureII9 H
)IIH I
;III J
SqlParameterJJ 
[JJ 
]JJ 
cachedParametersJJ +
=JJ, -
(JJ. /
SqlParameterJJ/ ;
[JJ; <
]JJ< =
)JJ= >
(JJ> ?

paramCacheJJ? I
[JJI J
keyJJJ M
]JJM N
)JJN O
;JJO P
returnKK 
CloneParametersKK "
(KK" #
cachedParametersKK# 3
)KK3 4
;KK4 5
}LL 	
publicQQ 
staticQQ 
boolQQ  
IsParameterSetCachedQQ /
(QQ/ 0
stringQQ0 6
connectionStringQQ7 G
,QQG H
stringQQI O
storedProcedureQQP _
)QQ_ `
{RR 	
stringSS 
hashKeySS 
=SS 
CreateHashKeySS *
(SS* +
connectionStringSS+ ;
,SS; <
storedProcedureSS= L
)SSL M
;SSM N
returnTT 

paramCacheTT 
[TT 
hashKeyTT %
]TT% &
!=TT' )
nullTT* .
;TT. /
}UU 	
privateWW 
staticWW 
stringWW 
CreateHashKeyWW +
(WW+ ,
stringWW, 2
connectionStringWW3 C
,WWC D
stringWWE K
storedProcedureWWL [
)WW[ \
{XX 	
returnYY 
connectionStringYY #
+YY$ %
$strYY& )
+YY* +
storedProcedureYY, ;
;YY; <
}ZZ 	
}[[ 
}\\ ‡œ
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBAuthorizeNetLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBAuthorizeNetLog )
{ 
public>> 
static>> 
int>> 
Create>>  
(>>  !
Guid?? 
rowGuid?? 
,?? 
DateTime@@ 

createdUtc@@ 
,@@  
GuidAA 
siteGuidAA 
,AA 
GuidBB 
userGuidBB 
,BB 
GuidCC 
	storeGuidCC 
,CC 
GuidDD 
cartGuidDD 
,DD 
stringEE 
rawResponseEE 
,EE 
stringFF 
responseCodeFF 
,FF  
stringGG 
responseReasonCodeGG %
,GG% &
stringHH 
reasonHH 
,HH 
stringII 
avsCodeII 
,II 
stringJJ 
ccvCodeJJ 
,JJ 
stringKK 
cavCodeKK 
,KK 
stringLL 
transactionIdLL  
,LL  !
stringMM 
transactionTypeMM "
,MM" #
stringNN 
methodNN 
,NN 
stringOO 
authCodeOO 
,OO 
decimalPP 
amountPP 
,PP 
decimalQQ 
taxQQ 
,QQ 
decimalRR 
dutyRR 
,RR 
decimalSS 
freightSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$str	UUi Ñ
,
UUÑ Ö
$num
UUÜ à
)
UUà â
;
UUâ ä
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# -
,VV- .
	SqlDbTypeVV/ 8
.VV8 9
UniqueIdentifierVV9 I
,VVI J
ParameterDirectionVVK ]
.VV] ^
InputVV^ c
,VVc d
rowGuidVVe l
)VVl m
;VVm n
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 0
,WW0 1
	SqlDbTypeWW2 ;
.WW; <
DateTimeWW< D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _

createdUtcWW` j
)WWj k
;WWk l
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
siteGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
UniqueIdentifierYY: J
,YYJ K
ParameterDirectionYYL ^
.YY^ _
InputYY_ d
,YYd e
userGuidYYf n
)YYn o
;YYo p
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# /
,ZZ/ 0
	SqlDbTypeZZ1 :
.ZZ: ;
UniqueIdentifierZZ; K
,ZZK L
ParameterDirectionZZM _
.ZZ_ `
InputZZ` e
,ZZe f
	storeGuidZZg p
)ZZp q
;ZZq r
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# .
,[[. /
	SqlDbType[[0 9
.[[9 :
UniqueIdentifier[[: J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
cartGuid[[f n
)[[n o
;[[o p
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 1
,\\1 2
	SqlDbType\\3 <
.\\< =
NVarChar\\= E
,\\E F
-\\G H
$num\\H I
,\\I J
ParameterDirection\\K ]
.\\] ^
Input\\^ c
,\\c d
rawResponse\\e p
)\\p q
;\\q r
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 2
,]]2 3
	SqlDbType]]4 =
.]]= >
NChar]]> C
,]]C D
$num]]E F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
responseCode]]b n
)]]n o
;]]o p
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 8
,^^8 9
	SqlDbType^^: C
.^^C D
NVarChar^^D L
,^^L M
$num^^N P
,^^P Q
ParameterDirection^^R d
.^^d e
Input^^e j
,^^j k
responseReasonCode^^l ~
)^^~ 
;	^^ Ä
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
NVarChar__8 @
,__@ A
-__B C
$num__C D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _
reason__` f
)__f g
;__g h
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# -
,``- .
	SqlDbType``/ 8
.``8 9
NVarChar``9 A
,``A B
$num``C E
,``E F
ParameterDirection``G Y
.``Y Z
Input``Z _
,``_ `
avsCode``a h
)``h i
;``i j
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# -
,aa- .
	SqlDbTypeaa/ 8
.aa8 9
NCharaa9 >
,aa> ?
$numaa@ A
,aaA B
ParameterDirectionaaC U
.aaU V
InputaaV [
,aa[ \
ccvCodeaa] d
)aad e
;aae f
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
NCharbb9 >
,bb> ?
$numbb@ A
,bbA B
ParameterDirectionbbC U
.bbU V
InputbbV [
,bb[ \
cavCodebb] d
)bbd e
;bbe f
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 3
,cc3 4
	SqlDbTypecc5 >
.cc> ?
NVarCharcc? G
,ccG H
$numccI K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
transactionIdccg t
)cct u
;ccu v
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 5
,dd5 6
	SqlDbTypedd7 @
.dd@ A
NVarCharddA I
,ddI J
$numddK M
,ddM N
ParameterDirectionddO a
.dda b
Inputddb g
,ddg h
transactionTypeddi x
)ddx y
;ddy z
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
NVarCharee8 @
,ee@ A
$numeeB D
,eeD E
ParameterDirectioneeF X
.eeX Y
InputeeY ^
,ee^ _
methodee` f
)eef g
;eeg h
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# .
,ff. /
	SqlDbTypeff0 9
.ff9 :
NVarCharff: B
,ffB C
$numffD F
,ffF G
ParameterDirectionffH Z
.ffZ [
Inputff[ `
,ff` a
authCodeffb j
)ffj k
;ffk l
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# ,
,gg, -
	SqlDbTypegg. 7
.gg7 8
Decimalgg8 ?
,gg? @
ParameterDirectionggA S
.ggS T
InputggT Y
,ggY Z
amountgg[ a
)gga b
;ggb c
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# )
,hh) *
	SqlDbTypehh+ 4
.hh4 5
Decimalhh5 <
,hh< =
ParameterDirectionhh> P
.hhP Q
InputhhQ V
,hhV W
taxhhX [
)hh[ \
;hh\ ]
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# *
,ii* +
	SqlDbTypeii, 5
.ii5 6
Decimalii6 =
,ii= >
ParameterDirectionii? Q
.iiQ R
InputiiR W
,iiW X
dutyiiY ]
)ii] ^
;ii^ _
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# -
,jj- .
	SqlDbTypejj/ 8
.jj8 9
Decimaljj9 @
,jj@ A
ParameterDirectionjjB T
.jjT U
InputjjU Z
,jjZ [
freightjj\ c
)jjc d
;jjd e
intkk 
rowsAffectedkk 
=kk 
sphkk "
.kk" #
ExecuteNonQuerykk# 2
(kk2 3
)kk3 4
;kk4 5
returnll 
rowsAffectedll 
;ll  
}nn 	
public
ââ 
static
ââ 
bool
ââ 
Update
ââ !
(
ââ! "
Guid
ää 
rowGuid
ää 
,
ää 
Guid
ãã 
siteGuid
ãã 
,
ãã 
Guid
åå 
userGuid
åå 
,
åå 
Guid
çç 
	storeGuid
çç 
,
çç 
Guid
éé 
cartGuid
éé 
,
éé 
string
èè 
rawResponse
èè 
,
èè 
string
êê 
responseCode
êê 
,
êê  
string
ëë  
responseReasonCode
ëë %
,
ëë% &
string
íí 
reason
íí 
,
íí 
string
ìì 
avsCode
ìì 
,
ìì 
string
îî 
ccvCode
îî 
,
îî 
string
ïï 
cavCode
ïï 
,
ïï 
string
ññ 
transactionId
ññ  
,
ññ  !
string
óó 
transactionType
óó "
,
óó" #
string
òò 
method
òò 
,
òò 
string
ôô 
authCode
ôô 
,
ôô 
decimal
öö 
amount
öö 
,
öö 
decimal
õõ 
tax
õõ 
,
õõ 
decimal
úú 
duty
úú 
,
úú 
decimal
ùù 
freight
ùù 
)
ùù 
{
ûû 	 
SqlParameterHelper
üü 
sph
üü "
=
üü# $
new
üü% ( 
SqlParameterHelper
üü) ;
(
üü; <
ConnectionString
üü< L
.
üüL M&
GetWriteConnectionString
üüM e
(
üüe f
)
üüf g
,
üüg h
$strüüi Ñ
,üüÑ Ö
$numüüÜ à
)üüà â
;üüâ ä
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# -
,
††- .
	SqlDbType
††/ 8
.
††8 9
UniqueIdentifier
††9 I
,
††I J 
ParameterDirection
††K ]
.
††] ^
Input
††^ c
,
††c d
rowGuid
††e l
)
††l m
;
††m n
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# .
,
°°. /
	SqlDbType
°°0 9
.
°°9 :
UniqueIdentifier
°°: J
,
°°J K 
ParameterDirection
°°L ^
.
°°^ _
Input
°°_ d
,
°°d e
siteGuid
°°f n
)
°°n o
;
°°o p
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
UniqueIdentifier
¢¢: J
,
¢¢J K 
ParameterDirection
¢¢L ^
.
¢¢^ _
Input
¢¢_ d
,
¢¢d e
userGuid
¢¢f n
)
¢¢n o
;
¢¢o p
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# /
,
££/ 0
	SqlDbType
££1 :
.
££: ;
UniqueIdentifier
££; K
,
££K L 
ParameterDirection
££M _
.
££_ `
Input
££` e
,
££e f
	storeGuid
££g p
)
££p q
;
££q r
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# .
,
§§. /
	SqlDbType
§§0 9
.
§§9 :
UniqueIdentifier
§§: J
,
§§J K 
ParameterDirection
§§L ^
.
§§^ _
Input
§§_ d
,
§§d e
cartGuid
§§f n
)
§§n o
;
§§o p
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# 1
,
••1 2
	SqlDbType
••3 <
.
••< =
NVarChar
••= E
,
••E F
-
••G H
$num
••H I
,
••I J 
ParameterDirection
••K ]
.
••] ^
Input
••^ c
,
••c d
rawResponse
••e p
)
••p q
;
••q r
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# 2
,
¶¶2 3
	SqlDbType
¶¶4 =
.
¶¶= >
NChar
¶¶> C
,
¶¶C D
$num
¶¶E F
,
¶¶F G 
ParameterDirection
¶¶H Z
.
¶¶Z [
Input
¶¶[ `
,
¶¶` a
responseCode
¶¶b n
)
¶¶n o
;
¶¶o p
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 8
,
ßß8 9
	SqlDbType
ßß: C
.
ßßC D
NVarChar
ßßD L
,
ßßL M
$num
ßßN P
,
ßßP Q 
ParameterDirection
ßßR d
.
ßßd e
Input
ßße j
,
ßßj k 
responseReasonCode
ßßl ~
)
ßß~ 
;ßß Ä
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# ,
,
®®, -
	SqlDbType
®®. 7
.
®®7 8
NVarChar
®®8 @
,
®®@ A
-
®®B C
$num
®®C D
,
®®D E 
ParameterDirection
®®F X
.
®®X Y
Input
®®Y ^
,
®®^ _
reason
®®` f
)
®®f g
;
®®g h
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# -
,
©©- .
	SqlDbType
©©/ 8
.
©©8 9
NVarChar
©©9 A
,
©©A B
$num
©©C E
,
©©E F 
ParameterDirection
©©G Y
.
©©Y Z
Input
©©Z _
,
©©_ `
avsCode
©©a h
)
©©h i
;
©©i j
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# -
,
™™- .
	SqlDbType
™™/ 8
.
™™8 9
NChar
™™9 >
,
™™> ?
$num
™™@ A
,
™™A B 
ParameterDirection
™™C U
.
™™U V
Input
™™V [
,
™™[ \
ccvCode
™™] d
)
™™d e
;
™™e f
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# -
,
´´- .
	SqlDbType
´´/ 8
.
´´8 9
NChar
´´9 >
,
´´> ?
$num
´´@ A
,
´´A B 
ParameterDirection
´´C U
.
´´U V
Input
´´V [
,
´´[ \
cavCode
´´] d
)
´´d e
;
´´e f
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 3
,
¨¨3 4
	SqlDbType
¨¨5 >
.
¨¨> ?
NVarChar
¨¨? G
,
¨¨G H
$num
¨¨I K
,
¨¨K L 
ParameterDirection
¨¨M _
.
¨¨_ `
Input
¨¨` e
,
¨¨e f
transactionId
¨¨g t
)
¨¨t u
;
¨¨u v
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# 5
,
≠≠5 6
	SqlDbType
≠≠7 @
.
≠≠@ A
NVarChar
≠≠A I
,
≠≠I J
$num
≠≠K M
,
≠≠M N 
ParameterDirection
≠≠O a
.
≠≠a b
Input
≠≠b g
,
≠≠g h
transactionType
≠≠i x
)
≠≠x y
;
≠≠y z
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# ,
,
ÆÆ, -
	SqlDbType
ÆÆ. 7
.
ÆÆ7 8
NVarChar
ÆÆ8 @
,
ÆÆ@ A
$num
ÆÆB D
,
ÆÆD E 
ParameterDirection
ÆÆF X
.
ÆÆX Y
Input
ÆÆY ^
,
ÆÆ^ _
method
ÆÆ` f
)
ÆÆf g
;
ÆÆg h
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
NVarChar
ØØ: B
,
ØØB C
$num
ØØD F
,
ØØF G 
ParameterDirection
ØØH Z
.
ØØZ [
Input
ØØ[ `
,
ØØ` a
authCode
ØØb j
)
ØØj k
;
ØØk l
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# ,
,
∞∞, -
	SqlDbType
∞∞. 7
.
∞∞7 8
Decimal
∞∞8 ?
,
∞∞? @ 
ParameterDirection
∞∞A S
.
∞∞S T
Input
∞∞T Y
,
∞∞Y Z
amount
∞∞[ a
)
∞∞a b
;
∞∞b c
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# )
,
±±) *
	SqlDbType
±±+ 4
.
±±4 5
Decimal
±±5 <
,
±±< = 
ParameterDirection
±±> P
.
±±P Q
Input
±±Q V
,
±±V W
tax
±±X [
)
±±[ \
;
±±\ ]
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# *
,
≤≤* +
	SqlDbType
≤≤, 5
.
≤≤5 6
Decimal
≤≤6 =
,
≤≤= > 
ParameterDirection
≤≤? Q
.
≤≤Q R
Input
≤≤R W
,
≤≤W X
duty
≤≤Y ]
)
≤≤] ^
;
≤≤^ _
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# -
,
≥≥- .
	SqlDbType
≥≥/ 8
.
≥≥8 9
Decimal
≥≥9 @
,
≥≥@ A 
ParameterDirection
≥≥B T
.
≥≥T U
Input
≥≥U Z
,
≥≥Z [
freight
≥≥\ c
)
≥≥c d
;
≥≥d e
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
sph
¥¥ "
.
¥¥" #
ExecuteNonQuery
¥¥# 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
$num
µµ# $
)
µµ$ %
;
µµ% &
}
∑∑ 	
public
ææ 
static
ææ 
bool
ææ 
Delete
ææ !
(
ææ! "
Guid
ææ" &
rowGuid
ææ' .
)
ææ. /
{
øø 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M&
GetWriteConnectionString
¿¿M e
(
¿¿e f
)
¿¿f g
,
¿¿g h
$str¿¿i Ñ
,¿¿Ñ Ö
$num¿¿Ü á
)¿¿á à
;¿¿à â
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# -
,
¡¡- .
	SqlDbType
¡¡/ 8
.
¡¡8 9
UniqueIdentifier
¡¡9 I
,
¡¡I J 
ParameterDirection
¡¡K ]
.
¡¡] ^
Input
¡¡^ c
,
¡¡c d
rowGuid
¡¡e l
)
¡¡l m
;
¡¡m n
int
¬¬ 
rowsAffected
¬¬ 
=
¬¬ 
sph
¬¬ "
.
¬¬" #
ExecuteNonQuery
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
return
√√ 
(
√√ 
rowsAffected
√√  
>
√√! "
$num
√√# $
)
√√$ %
;
√√% &
}
≈≈ 	
public
ÀÀ 
static
ÀÀ 
IDataReader
ÀÀ !
GetOne
ÀÀ" (
(
ÀÀ( )
Guid
ÀÀ) -
rowGuid
ÀÀ. 5
)
ÀÀ5 6
{
ÃÃ 	 
SqlParameterHelper
ÕÕ 
sph
ÕÕ "
=
ÕÕ# $
new
ÕÕ% ( 
SqlParameterHelper
ÕÕ) ;
(
ÕÕ; <
ConnectionString
ÕÕ< L
.
ÕÕL M%
GetReadConnectionString
ÕÕM d
(
ÕÕd e
)
ÕÕe f
,
ÕÕf g
$strÕÕh Ü
,ÕÕÜ á
$numÕÕà â
)ÕÕâ ä
;ÕÕä ã
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# -
,
ŒŒ- .
	SqlDbType
ŒŒ/ 8
.
ŒŒ8 9
UniqueIdentifier
ŒŒ9 I
,
ŒŒI J 
ParameterDirection
ŒŒK ]
.
ŒŒ] ^
Input
ŒŒ^ c
,
ŒŒc d
rowGuid
ŒŒe l
)
ŒŒl m
;
ŒŒm n
return
œœ 
sph
œœ 
.
œœ 
ExecuteReader
œœ $
(
œœ$ %
)
œœ% &
;
œœ& '
}
—— 	
public
◊◊ 
static
◊◊ 
IDataReader
◊◊ !
	GetByCart
◊◊" +
(
◊◊+ ,
Guid
◊◊, 0
cartGuid
◊◊1 9
)
◊◊9 :
{
ÿÿ 	 
SqlParameterHelper
ŸŸ 
sph
ŸŸ "
=
ŸŸ# $
new
ŸŸ% ( 
SqlParameterHelper
ŸŸ) ;
(
ŸŸ; <
ConnectionString
ŸŸ< L
.
ŸŸL M%
GetReadConnectionString
ŸŸM d
(
ŸŸd e
)
ŸŸe f
,
ŸŸf g
$strŸŸh â
,ŸŸâ ä
$numŸŸã å
)ŸŸå ç
;ŸŸç é
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# .
,
⁄⁄. /
	SqlDbType
⁄⁄0 9
.
⁄⁄9 :
UniqueIdentifier
⁄⁄: J
,
⁄⁄J K 
ParameterDirection
⁄⁄L ^
.
⁄⁄^ _
Input
⁄⁄_ d
,
⁄⁄d e
cartGuid
⁄⁄f n
)
⁄⁄n o
;
⁄⁄o p
return
€€ 
sph
€€ 
.
€€ 
ExecuteReader
€€ $
(
€€$ %
)
€€% &
;
€€& '
}
›› 	
public
„„ 
static
„„ 
int
„„ 
GetCount
„„ "
(
„„" #
)
„„# $
{
‰‰ 	
return
ÊÊ 
Convert
ÊÊ 
.
ÊÊ 
ToInt32
ÊÊ "
(
ÊÊ" #
	SqlHelper
ÊÊ# ,
.
ÊÊ, -
ExecuteScalar
ÊÊ- :
(
ÊÊ: ;
ConnectionString
ÁÁ  
.
ÁÁ  !%
GetReadConnectionString
ÁÁ! 8
(
ÁÁ8 9
)
ÁÁ9 :
,
ÁÁ: ;
CommandType
ËË 
.
ËË 
StoredProcedure
ËË +
,
ËË+ ,
$str
ÈÈ -
,
ÈÈ- .
null
ÍÍ 
)
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÏÏ 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !
GetAll
ÒÒ" (
(
ÒÒ( )
)
ÒÒ) *
{
ÚÚ 	
return
ÙÙ 
	SqlHelper
ÙÙ 
.
ÙÙ 
ExecuteReader
ÙÙ *
(
ÙÙ* +
ConnectionString
ıı  
.
ıı  !%
GetReadConnectionString
ıı! 8
(
ıı8 9
)
ıı9 :
,
ıı: ;
CommandType
ˆˆ 
.
ˆˆ 
StoredProcedure
ˆˆ +
,
ˆˆ+ ,
$str
˜˜ .
,
˜˜. /
null
¯¯ 
)
¯¯ 
;
¯¯ 
}
˙˙ 	
public
ÇÇ 
static
ÇÇ 
IDataReader
ÇÇ !
GetPage
ÇÇ" )
(
ÇÇ) *
int
ÉÉ 

pageNumber
ÉÉ 
,
ÉÉ 
int
ÑÑ 
pageSize
ÑÑ 
,
ÑÑ 
out
ÖÖ 
int
ÖÖ 

totalPages
ÖÖ 
)
ÖÖ 
{
ÜÜ 	

totalPages
áá 
=
áá 
$num
áá 
;
áá 
int
àà 
	totalRows
àà 
=
ââ 
GetCount
ââ 
(
ââ 
)
ââ 
;
ââ 
if
ãã 
(
ãã 
pageSize
ãã 
>
ãã 
$num
ãã 
)
ãã 

totalPages
ãã (
=
ãã) *
	totalRows
ãã+ 4
/
ãã5 6
pageSize
ãã7 ?
;
ãã? @
if
çç 
(
çç 
	totalRows
çç 
<=
çç 
pageSize
çç %
)
çç% &
{
éé 

totalPages
èè 
=
èè 
$num
èè 
;
èè 
}
êê 
else
ëë 
{
íí 
int
ìì 
	remainder
ìì 
;
ìì 
Math
îî 
.
îî 
DivRem
îî 
(
îî 
	totalRows
îî %
,
îî% &
pageSize
îî' /
,
îî/ 0
out
îî1 4
	remainder
îî5 >
)
îî> ?
;
îî? @
if
ïï 
(
ïï 
	remainder
ïï 
>
ïï 
$num
ïï  !
)
ïï! "
{
ññ 

totalPages
óó 
+=
óó !
$num
óó" #
;
óó# $
}
òò 
}
ôô  
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M%
GetReadConnectionString
õõM d
(
õõd e
)
õõe f
,
õõf g
$strõõh á
,õõá à
$numõõâ ä
)õõä ã
;õõã å
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 0
,
úú0 1
	SqlDbType
úú2 ;
.
úú; <
Int
úú< ?
,
úú? @ 
ParameterDirection
úúA S
.
úúS T
Input
úúT Y
,
úúY Z

pageNumber
úú[ e
)
úúe f
;
úúf g
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
Int
ùù: =
,
ùù= > 
ParameterDirection
ùù? Q
.
ùùQ R
Input
ùùR W
,
ùùW X
pageSize
ùùY a
)
ùùa b
;
ùùb c
return
ûû 
sph
ûû 
.
ûû 
ExecuteReader
ûû $
(
ûû$ %
)
ûû% &
;
ûû& '
}
†† 	
}
¢¢ 
}§§ îg
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbBannedIP.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBBannedIP "
{ 
public.. 
static.. 
int.. 
Add.. 
(.. 
string// 
bannedIP// 
,// 
DateTime00 
	bannedUtc00 
,00 
string11 
bannedReason11 
)11  
{22 	
SqlParameterHelper33 
sph33 "
=33# $
new33% (
SqlParameterHelper33) ;
(33; <
ConnectionString33< L
.33L M$
GetWriteConnectionString33M e
(33e f
)33f g
,33g h
$str	33i Ü
,
33Ü á
$num
33à â
)
33â ä
;
33ä ã
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
NVarChar44: B
,44B C
$num44D F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
bannedIP44b j
)44j k
;44k l
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# /
,55/ 0
	SqlDbType551 :
.55: ;
DateTime55; C
,55C D
ParameterDirection55E W
.55W X
Input55X ]
,55] ^
	bannedUtc55_ h
)55h i
;55i j
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 2
,662 3
	SqlDbType664 =
.66= >
NVarChar66> F
,66F G
$num66H K
,66K L
ParameterDirection66M _
.66_ `
Input66` e
,66e f
bannedReason66g s
)66s t
;66t u
int77 
newID77 
=77 
Convert77 
.77  
ToInt3277  '
(77' (
sph77( +
.77+ ,
ExecuteScalar77, 9
(779 :
)77: ;
)77; <
;77< =
return88 
newID88 
;88 
}99 	
publicDD 
staticDD 
boolDD 
UpdateDD !
(DD! "
intEE 
rowIdEE 
,EE 
stringFF 
bannedIPFF 
,FF 
DateTimeGG 
	bannedUtcGG 
,GG 
stringHH 
bannedReasonHH 
)HH  
{II 	
SqlParameterHelperJJ 
sphJJ "
=JJ# $
newJJ% (
SqlParameterHelperJJ) ;
(JJ; <
ConnectionStringJJ< L
.JJL M$
GetWriteConnectionStringJJM e
(JJe f
)JJf g
,JJg h
$str	JJi Ü
,
JJÜ á
$num
JJà â
)
JJâ ä
;
JJä ã
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
IntKK7 :
,KK: ;
ParameterDirectionKK< N
.KKN O
InputKKO T
,KKT U
rowIdKKV [
)KK[ \
;KK\ ]
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# .
,LL. /
	SqlDbTypeLL0 9
.LL9 :
NVarCharLL: B
,LLB C
$numLLD F
,LLF G
ParameterDirectionLLH Z
.LLZ [
InputLL[ `
,LL` a
bannedIPLLb j
)LLj k
;LLk l
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# /
,MM/ 0
	SqlDbTypeMM1 :
.MM: ;
DateTimeMM; C
,MMC D
ParameterDirectionMME W
.MMW X
InputMMX ]
,MM] ^
	bannedUtcMM_ h
)MMh i
;MMi j
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 2
,NN2 3
	SqlDbTypeNN4 =
.NN= >
NVarCharNN> F
,NNF G
$numNNH K
,NNK L
ParameterDirectionNNM _
.NN_ `
InputNN` e
,NNe f
bannedReasonNNg s
)NNs t
;NNt u
intOO 
rowsAffectedOO 
=OO 
sphOO "
.OO" #
ExecuteNonQueryOO# 2
(OO2 3
)OO3 4
;OO4 5
returnPP 
(PP 
rowsAffectedPP  
>PP! "
$numPP# $
)PP$ %
;PP% &
}QQ 	
publicXX 
staticXX 
boolXX 
DeleteXX !
(XX! "
intYY 
rowIdYY 
)YY 
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i Ü
,
[[Ü á
$num
[[à â
)
[[â ä
;
[[ä ã
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
Int\\7 :
,\\: ;
ParameterDirection\\< N
.\\N O
Input\\O T
,\\T U
rowId\\V [
)\\[ \
;\\\ ]
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
$num^^# $
)^^$ %
;^^% &
}`` 	
publicff 
staticff 
IDataReaderff !
GetOneff" (
(ff( )
intgg 
rowIdgg 
)gg 
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M#
GetReadConnectionStringiiM d
(iid e
)iie f
,iif g
$str	iih à
,
iià â
$num
iiä ã
)
iiã å
;
iiå ç
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# +
,jj+ ,
	SqlDbTypejj- 6
.jj6 7
Intjj7 :
,jj: ;
ParameterDirectionjj< N
.jjN O
InputjjO T
,jjT U
rowIdjjV [
)jj[ \
;jj\ ]
returnkk 
sphkk 
.kk 
ExecuteReaderkk $
(kk$ %
)kk% &
;kk& '
}ll 	
publicrr 
staticrr 
IDataReaderrr !
GeByIpAddressrr" /
(rr/ 0
stringrr0 6
	ipAddressrr7 @
)rr@ A
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M#
GetReadConnectionStringttM d
(ttd e
)tte f
,ttf g
$str	tth â
,
ttâ ä
$num
ttã å
)
ttå ç
;
ttç é
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
NVarCharuu: B
,uuB C
$numuuD F
,uuF G
ParameterDirectionuuH Z
.uuZ [
Inputuu[ `
,uu` a
	ipAddressuub k
)uuk l
;uul m
returnvv 
sphvv 
.vv 
ExecuteReadervv $
(vv$ %
)vv% &
;vv& '
}ww 	
public~~ 
static~~ 
bool~~ 
IsBanned~~ #
(~~# $
string~~$ *
	ipAddress~~+ 4
)~~4 5
{ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh Ö
,ÄÄÖ Ü
$numÄÄá à
)ÄÄà â
;ÄÄâ ä
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# .
,
ÅÅ. /
	SqlDbType
ÅÅ0 9
.
ÅÅ9 :
NVarChar
ÅÅ: B
,
ÅÅB C
$num
ÅÅD F
,
ÅÅF G 
ParameterDirection
ÅÅH Z
.
ÅÅZ [
Input
ÅÅ[ `
,
ÅÅ` a
	ipAddress
ÅÅb k
)
ÅÅk l
;
ÅÅl m
int
ÇÇ 
	foundRows
ÇÇ 
=
ÇÇ 
Convert
ÇÇ #
.
ÇÇ# $
ToInt32
ÇÇ$ +
(
ÇÇ+ ,
sph
ÇÇ, /
.
ÇÇ/ 0
ExecuteScalar
ÇÇ0 =
(
ÇÇ= >
)
ÇÇ> ?
)
ÇÇ? @
;
ÇÇ@ A
return
ÉÉ 
(
ÉÉ 
	foundRows
ÉÉ 
>
ÉÉ 
$num
ÉÉ  !
)
ÉÉ! "
;
ÉÉ" #
}
ÖÖ 	
public
ää 
static
ää 
int
ää 
GetCount
ää "
(
ää" #
)
ää# $
{
ãã 	
return
çç 
Convert
çç 
.
çç 
ToInt32
çç "
(
çç" #
	SqlHelper
çç# ,
.
çç, -
ExecuteScalar
çç- :
(
çç: ;
ConnectionString
éé  
.
éé  !%
GetReadConnectionString
éé! 8
(
éé8 9
)
éé9 :
,
éé: ;
CommandType
èè 
.
èè 
StoredProcedure
èè +
,
èè+ ,
$str
êê /
,
êê/ 0
null
ëë 
)
ëë 
)
ëë 
;
ëë 
}
ìì 	
public
òò 
static
òò 
IDataReader
òò !
GetAll
òò" (
(
òò( )
)
òò) *
{
ôô 	
return
õõ 
	SqlHelper
õõ 
.
õõ 
ExecuteReader
õõ *
(
õõ* +
ConnectionString
úú  
.
úú  !%
GetReadConnectionString
úú! 8
(
úú8 9
)
úú9 :
,
úú: ;
CommandType
ùù 
.
ùù 
StoredProcedure
ùù +
,
ùù+ ,
$str
ûû 0
,
ûû0 1
null
üü 
)
üü 
;
üü 
}
°° 	
public
©© 
static
©© 
IDataReader
©© !
GetPage
©©" )
(
©©) *
int
™™ 

pageNumber
™™ 
,
™™ 
int
´´ 
pageSize
´´ 
,
´´ 
out
¨¨ 
int
¨¨ 

totalPages
¨¨ 
)
¨¨ 
{
≠≠ 	

totalPages
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
int
ØØ 
	totalRows
ØØ 
=
∞∞ 
GetCount
∞∞ 
(
∞∞ 
)
∞∞ 
;
∞∞ 
if
≤≤ 
(
≤≤ 
pageSize
≤≤ 
>
≤≤ 
$num
≤≤ 
)
≤≤ 

totalPages
≤≤ (
=
≤≤) *
	totalRows
≤≤+ 4
/
≤≤5 6
pageSize
≤≤7 ?
;
≤≤? @
if
¥¥ 
(
¥¥ 
	totalRows
¥¥ 
<=
¥¥ 
pageSize
¥¥ %
)
¥¥% &
{
µµ 

totalPages
∂∂ 
=
∂∂ 
$num
∂∂ 
;
∂∂ 
}
∑∑ 
else
∏∏ 
{
ππ 
int
∫∫ 
	remainder
∫∫ 
;
∫∫ 
Math
ªª 
.
ªª 
DivRem
ªª 
(
ªª 
	totalRows
ªª %
,
ªª% &
pageSize
ªª' /
,
ªª/ 0
out
ªª1 4
	remainder
ªª5 >
)
ªª> ?
;
ªª? @
if
ºº 
(
ºº 
	remainder
ºº 
>
ºº 
$num
ºº  !
)
ºº! "
{
ΩΩ 

totalPages
ææ 
+=
ææ !
$num
ææ" #
;
ææ# $
}
øø 
}
¿¿  
SqlParameterHelper
¬¬ 
sph
¬¬ "
=
¬¬# $
new
¬¬% ( 
SqlParameterHelper
¬¬) ;
(
¬¬; <
ConnectionString
¬¬< L
.
¬¬L M%
GetReadConnectionString
¬¬M d
(
¬¬d e
)
¬¬e f
,
¬¬f g
$str¬¬h â
,¬¬â ä
$num¬¬ã å
)¬¬å ç
;¬¬ç é
sph
√√ 
.
√√  
DefineSqlParameter
√√ "
(
√√" #
$str
√√# 0
,
√√0 1
	SqlDbType
√√2 ;
.
√√; <
Int
√√< ?
,
√√? @ 
ParameterDirection
√√A S
.
√√S T
Input
√√T Y
,
√√Y Z

pageNumber
√√[ e
)
√√e f
;
√√f g
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ "
(
ƒƒ" #
$str
ƒƒ# .
,
ƒƒ. /
	SqlDbType
ƒƒ0 9
.
ƒƒ9 :
Int
ƒƒ: =
,
ƒƒ= > 
ParameterDirection
ƒƒ? Q
.
ƒƒQ R
Input
ƒƒR W
,
ƒƒW X
pageSize
ƒƒY a
)
ƒƒa b
;
ƒƒb c
return
≈≈ 
sph
≈≈ 
.
≈≈ 
ExecuteReader
≈≈ $
(
≈≈$ %
)
≈≈% &
;
≈≈& '
}
«« 	
}
œœ 
}–– ÔÜ
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCategory.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBCategory "
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 

parentGuidDD 
,DD 
GuidEE 
siteGuidEE 
,EE 
GuidFF 
featureGuidFF 
,FF 
GuidGG 

moduleGuidGG 
,GG 
stringHH 
categoryHH 
,HH 
stringII 
descriptionII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
GuidKK 
	createdByKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$strMMi }
,MM} ~
$num	MM Ä
)
MMÄ Å
;
MMÅ Ç
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
UniqueIdentifierOO< L
,OOL M
ParameterDirectionOON `
.OO` a
InputOOa f
,OOf g

parentGuidOOh r
)OOr s
;OOs t
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
featureGuidQQi t
)QQt u
;QQu v
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
UniqueIdentifierRR< L
,RRL M
ParameterDirectionRRN `
.RR` a
InputRRa f
,RRf g

moduleGuidRRh r
)RRr s
;RRs t
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
categorySSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
descriptionTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# /
,VV/ 0
	SqlDbTypeVV1 :
.VV: ;
UniqueIdentifierVV; K
,VVK L
ParameterDirectionVVM _
.VV_ `
InputVV` e
,VVe f
	createdByVVg p
)VVp q
;VVq r
intXX 
rowsAffectedXX 
=XX 
sphXX "
.XX" #
ExecuteNonQueryXX# 2
(XX2 3
)XX3 4
;XX4 5
returnYY 
rowsAffectedYY 
;YY  
}[[ 	
publichh 
statichh 
boolhh 
Updatehh !
(hh! "
Guidii 
guidii 
,ii 
Guidjj 

parentGuidjj 
,jj 
stringkk 
categorykk 
,kk 
stringll 
descriptionll 
,ll 
DateTimemm 
modifiedUtcmm  
,mm  !
Guidnn 

modifiedBynn 
)nn 
{oo 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M$
GetWriteConnectionStringppM e
(ppe f
)ppf g
,ppg h
$strppi }
,pp} ~
$num	pp Ä
)
ppÄ Å
;
ppÅ Ç
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# *
,qq* +
	SqlDbTypeqq, 5
.qq5 6
UniqueIdentifierqq6 F
,qqF G
ParameterDirectionqqH Z
.qqZ [
Inputqq[ `
,qq` a
guidqqb f
)qqf g
;qqg h
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 0
,rr0 1
	SqlDbTyperr2 ;
.rr; <
UniqueIdentifierrr< L
,rrL M
ParameterDirectionrrN `
.rr` a
Inputrra f
,rrf g

parentGuidrrh r
)rrr s
;rrs t
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# .
,ss. /
	SqlDbTypess0 9
.ss9 :
NVarCharss: B
,ssB C
$numssD G
,ssG H
ParameterDirectionssI [
.ss[ \
Inputss\ a
,ssa b
categoryssc k
)ssk l
;ssl m
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 1
,tt1 2
	SqlDbTypett3 <
.tt< =
NVarChartt= E
,ttE F
-ttG H
$numttH I
,ttI J
ParameterDirectionttK ]
.tt] ^
Inputtt^ c
,ttc d
descriptiontte p
)ttp q
;ttq r
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# 1
,uu1 2
	SqlDbTypeuu3 <
.uu< =
DateTimeuu= E
,uuE F
ParameterDirectionuuG Y
.uuY Z
InputuuZ _
,uu_ `
modifiedUtcuua l
)uul m
;uum n
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 0
,vv0 1
	SqlDbTypevv2 ;
.vv; <
UniqueIdentifiervv< L
,vvL M
ParameterDirectionvvN `
.vv` a
Inputvva f
,vvf g

modifiedByvvh r
)vvr s
;vvs t
intww 
rowsAffectedww 
=ww 
sphww "
.ww" #
ExecuteNonQueryww# 2
(ww2 3
)ww3 4
;ww4 5
returnxx 
(xx 
rowsAffectedxx  
>xx! "
$numxx# $
)xx$ %
;xx% &
}zz 	
public|| 
static|| 
bool|| 
UpdateItemCount|| *
(||* +
Guid||+ /
guid||0 4
)||4 5
{}} 	
SqlParameterHelper~~ 
sph~~ "
=~~# $
new~~% (
SqlParameterHelper~~) ;
(~~; <
ConnectionString~~< L
.~~L M$
GetWriteConnectionString~~M e
(~~e f
)~~f g
,~~g h
$str	~~i Ü
,
~~Ü á
$num
~~à â
)
~~â ä
;
~~ä ã
sph 
. 
DefineSqlParameter "
(" #
$str# *
,* +
	SqlDbType, 5
.5 6
UniqueIdentifier6 F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
guidb f
)f g
;g h
int
ÄÄ 
rowsAffected
ÄÄ 
=
ÄÄ 
sph
ÄÄ "
.
ÄÄ" #
ExecuteNonQuery
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
return
ÅÅ 
(
ÅÅ 
rowsAffected
ÅÅ  
>
ÅÅ! "
$num
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÉÉ 	
public
ää 
static
ää 
bool
ää 
Delete
ää !
(
ää! "
Guid
ää" &
guid
ää' +
)
ää+ ,
{
ãã 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M&
GetWriteConnectionString
ååM e
(
ååe f
)
ååf g
,
ååg h
$str
ååi }
,
åå} ~
$numåå Ä
)ååÄ Å
;ååÅ Ç
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# *
,
çç* +
	SqlDbType
çç, 5
.
çç5 6
UniqueIdentifier
çç6 F
,
ççF G 
ParameterDirection
ççH Z
.
ççZ [
Input
çç[ `
,
çç` a
guid
ççb f
)
ççf g
;
ççg h
int
éé 
rowsAffected
éé 
=
éé 
sph
éé "
.
éé" #
ExecuteNonQuery
éé# 2
(
éé2 3
)
éé3 4
;
éé4 5
return
èè 
(
èè 
rowsAffected
èè  
>
èè! "
$num
èè# $
)
èè$ %
;
èè% &
}
ëë 	
public
òò 
static
òò 
bool
òò 
DeletByModule
òò (
(
òò( )
Guid
òò) -

moduleGuid
òò. 8
)
òò8 9
{
ôô 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M&
GetWriteConnectionString
ööM e
(
ööe f
)
ööf g
,
öög h
$strööi Ö
,ööÖ Ü
$numööá à
)ööà â
;ööâ ä
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 0
,
õõ0 1
	SqlDbType
õõ2 ;
.
õõ; <
UniqueIdentifier
õõ< L
,
õõL M 
ParameterDirection
õõN `
.
õõ` a
Input
õõa f
,
õõf g

moduleGuid
õõh r
)
õõr s
;
õõs t
int
úú 
rowsAffected
úú 
=
úú 
sph
úú "
.
úú" #
ExecuteNonQuery
úú# 2
(
úú2 3
)
úú3 4
;
úú4 5
return
ùù 
(
ùù 
rowsAffected
ùù  
>
ùù! "
$num
ùù# $
)
ùù$ %
;
ùù% &
}
ûû 	
public
•• 
static
•• 
bool
•• 
DeletByFeature
•• )
(
••) *
Guid
••* .
featureGuid
••/ :
)
••: ;
{
¶¶ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M&
GetWriteConnectionString
ßßM e
(
ßße f
)
ßßf g
,
ßßg h
$strßßi Ü
,ßßÜ á
$numßßà â
)ßßâ ä
;ßßä ã
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 1
,
®®1 2
	SqlDbType
®®3 <
.
®®< =
UniqueIdentifier
®®= M
,
®®M N 
ParameterDirection
®®O a
.
®®a b
Input
®®b g
,
®®g h
featureGuid
®®i t
)
®®t u
;
®®u v
int
©© 
rowsAffected
©© 
=
©© 
sph
©© "
.
©©" #
ExecuteNonQuery
©©# 2
(
©©2 3
)
©©3 4
;
©©4 5
return
™™ 
(
™™ 
rowsAffected
™™  
>
™™! "
$num
™™# $
)
™™$ %
;
™™% &
}
´´ 	
public
≤≤ 
static
≤≤ 
bool
≤≤ 
DeletBySite
≤≤ &
(
≤≤& '
Guid
≤≤' +
siteGuid
≤≤, 4
)
≤≤4 5
{
≥≥ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M&
GetWriteConnectionString
¥¥M e
(
¥¥e f
)
¥¥f g
,
¥¥g h
$str¥¥i É
,¥¥É Ñ
$num¥¥Ö Ü
)¥¥Ü á
;¥¥á à
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
int
∂∂ 
rowsAffected
∂∂ 
=
∂∂ 
sph
∂∂ "
.
∂∂" #
ExecuteNonQuery
∂∂# 2
(
∂∂2 3
)
∂∂3 4
;
∂∂4 5
return
∑∑ 
(
∑∑ 
rowsAffected
∑∑  
>
∑∑! "
$num
∑∑# $
)
∑∑$ %
;
∑∑% &
}
∏∏ 	
public
ææ 
static
ææ 
IDataReader
ææ !
GetOne
ææ" (
(
ææ( )
Guid
ææ) -
guid
ææ. 2
)
ææ2 3
{
øø 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M%
GetReadConnectionString
¿¿M d
(
¿¿d e
)
¿¿e f
,
¿¿f g
$str
¿¿h 
,¿¿ Ä
$num¿¿Å Ç
)¿¿Ç É
;¿¿É Ñ
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# *
,
¡¡* +
	SqlDbType
¡¡, 5
.
¡¡5 6
UniqueIdentifier
¡¡6 F
,
¡¡F G 
ParameterDirection
¡¡H Z
.
¡¡Z [
Input
¡¡[ `
,
¡¡` a
guid
¡¡b f
)
¡¡f g
;
¡¡g h
return
¬¬ 
sph
¬¬ 
.
¬¬ 
ExecuteReader
¬¬ $
(
¬¬$ %
)
¬¬% &
;
¬¬& '
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
IDataReader
∆∆ !
GetByModule
∆∆" -
(
∆∆- .
Guid
∆∆. 2

moduleGuid
∆∆3 =
)
∆∆= >
{
«« 	 
SqlParameterHelper
»» 
sph
»» "
=
»»# $
new
»»% ( 
SqlParameterHelper
»») ;
(
»»; <
ConnectionString
»»< L
.
»»L M%
GetReadConnectionString
»»M d
(
»»d e
)
»»e f
,
»»f g
$str»»h Ñ
,»»Ñ Ö
$num»»Ü á
)»»á à
;»»à â
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# 0
,
……0 1
	SqlDbType
……2 ;
.
……; <
UniqueIdentifier
……< L
,
……L M 
ParameterDirection
……N `
.
……` a
Input
……a f
,
……f g

moduleGuid
……h r
)
……r s
;
……s t
return
   
sph
   
.
   
ExecuteReader
   $
(
  $ %
)
  % &
;
  & '
}
ÃÃ 	
public
—— 
static
—— 
int
—— 
GetCountByModule
—— *
(
——* +
Guid
——+ /

moduleGuid
——0 :
)
——: ;
{
““ 	 
SqlParameterHelper
”” 
sph
”” "
=
””# $
new
””% ( 
SqlParameterHelper
””) ;
(
””; <
ConnectionString
””< L
.
””L M%
GetReadConnectionString
””M d
(
””d e
)
””e f
,
””f g
$str””h Ü
,””Ü á
$num””à â
)””â ä
;””ä ã
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# 0
,
‘‘0 1
	SqlDbType
‘‘2 ;
.
‘‘; <
UniqueIdentifier
‘‘< L
,
‘‘L M 
ParameterDirection
‘‘N `
.
‘‘` a
Input
‘‘a f
,
‘‘f g

moduleGuid
‘‘h r
)
‘‘r s
;
‘‘s t
return
’’ 
Convert
’’ 
.
’’ 
ToInt32
’’ "
(
’’" #
sph
’’# &
.
’’& '
ExecuteScalar
’’' 4
(
’’4 5
)
’’5 6
)
’’6 7
;
’’7 8
}
◊◊ 	
}
ŸŸ 
}⁄⁄ ﬁÚ
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBComment.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBComments "
{ 
public00 
static00 
int00 
Create00  
(00  !
Guid11 
guid11 
,11 
Guid22 

parentGuid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
featureGuid44 
,44 
Guid55 

moduleGuid55 
,55 
Guid66 
contentGuid66 
,66 
Guid77 
userGuid77 
,77 
string88 
title88 
,88 
string99 
userComment99 
,99 
string:: 
userName:: 
,:: 
string;; 
	userEmail;; 
,;; 
string<< 
userUrl<< 
,<< 
string== 
userIp== 
,== 
DateTime>> 

createdUtc>> 
,>>  
byte?? 
moderationStatus?? !
,??! "
Guid@@ 
moderatedBy@@ 
,@@ 
stringAA 
moderationReasonAA #
)AA# $
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$strCCi }
,CC} ~
$num	CC Å
)
CCÅ Ç
;
CCÇ É
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# *
,DD* +
	SqlDbTypeDD, 5
.DD5 6
UniqueIdentifierDD6 F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
guidDDb f
)DDf g
;DDg h
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
UniqueIdentifierEE: J
,EEJ K
ParameterDirectionEEL ^
.EE^ _
InputEE_ d
,EEd e
siteGuidEEf n
)EEn o
;EEo p
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 0
,FF0 1
	SqlDbTypeFF2 ;
.FF; <
UniqueIdentifierFF< L
,FFL M
ParameterDirectionFFN `
.FF` a
InputFFa f
,FFf g

parentGuidFFh r
)FFr s
;FFs t
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 1
,GG1 2
	SqlDbTypeGG3 <
.GG< =
UniqueIdentifierGG= M
,GGM N
ParameterDirectionGGO a
.GGa b
InputGGb g
,GGg h
featureGuidGGi t
)GGt u
;GGu v
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
UniqueIdentifierHH< L
,HHL M
ParameterDirectionHHN `
.HH` a
InputHHa f
,HHf g

moduleGuidHHh r
)HHr s
;HHs t
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# 1
,II1 2
	SqlDbTypeII3 <
.II< =
UniqueIdentifierII= M
,IIM N
ParameterDirectionIIO a
.IIa b
InputIIb g
,IIg h
contentGuidIIi t
)IIt u
;IIu v
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
UniqueIdentifierJJ: J
,JJJ K
ParameterDirectionJJL ^
.JJ^ _
InputJJ_ d
,JJd e
userGuidJJf n
)JJn o
;JJo p
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
$numKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
titleKK` e
)KKe f
;KKf g
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
-LLG H
$numLLH I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
userCommentLLe p
)LLp q
;LLq r
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
NVarCharMM: B
,MMB C
$numMMD F
,MMF G
ParameterDirectionMMH Z
.MMZ [
InputMM[ `
,MM` a
userNameMMb j
)MMj k
;MMk l
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# /
,NN/ 0
	SqlDbTypeNN1 :
.NN: ;
NVarCharNN; C
,NNC D
$numNNE H
,NNH I
ParameterDirectionNNJ \
.NN\ ]
InputNN] b
,NNb c
	userEmailNNd m
)NNm n
;NNn o
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# -
,OO- .
	SqlDbTypeOO/ 8
.OO8 9
NVarCharOO9 A
,OOA B
$numOOC F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
userUrlOOb i
)OOi j
;OOj k
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
NVarCharPP8 @
,PP@ A
$numPPB D
,PPD E
ParameterDirectionPPF X
.PPX Y
InputPPY ^
,PP^ _
userIpPP` f
)PPf g
;PPg h
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 0
,QQ0 1
	SqlDbTypeQQ2 ;
.QQ; <
DateTimeQQ< D
,QQD E
ParameterDirectionQQF X
.QQX Y
InputQQY ^
,QQ^ _

createdUtcQQ` j
)QQj k
;QQk l
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 6
,RR6 7
	SqlDbTypeRR8 A
.RRA B
TinyIntRRB I
,RRI J
ParameterDirectionRRK ]
.RR] ^
InputRR^ c
,RRc d
moderationStatusRRe u
)RRu v
;RRv w
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 1
,SS1 2
	SqlDbTypeSS3 <
.SS< =
UniqueIdentifierSS= M
,SSM N
ParameterDirectionSSO a
.SSa b
InputSSb g
,SSg h
moderatedBySSi t
)SSt u
;SSu v
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 6
,TT6 7
	SqlDbTypeTT8 A
.TTA B
NVarCharTTB J
,TTJ K
$numTTL O
,TTO P
ParameterDirectionTTQ c
.TTc d
InputTTd i
,TTi j
moderationReasonTTk {
)TT{ |
;TT| }
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
rowsAffectedVV 
;VV  
}XX 	
publickk 
statickk 
boolkk 
Updatekk !
(kk! "
Guidll 
guidll 
,ll 
Guidmm 
userGuidmm 
,mm 
stringnn 
titlenn 
,nn 
stringoo 
userCommentoo 
,oo 
stringpp 
userNamepp 
,pp 
stringqq 
	userEmailqq 
,qq 
stringrr 
userUrlrr 
,rr 
stringss 
userIpss 
,ss 
DateTimett 

lastModUtctt 
,tt  
byteuu 
moderationStatusuu !
,uu! "
Guidvv 
moderatedByvv 
,vv 
stringww 
moderationReasonww #
)ww# $
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$stryyi }
,yy} ~
$num	yy Å
)
yyÅ Ç
;
yyÇ É
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
UniqueIdentifierzz6 F
,zzF G
ParameterDirectionzzH Z
.zzZ [
Inputzz[ `
,zz` a
guidzzb f
)zzf g
;zzg h
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# .
,{{. /
	SqlDbType{{0 9
.{{9 :
UniqueIdentifier{{: J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
userGuid{{f n
){{n o
;{{o p
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# +
,||+ ,
	SqlDbType||- 6
.||6 7
NVarChar||7 ?
,||? @
$num||A D
,||D E
ParameterDirection||F X
.||X Y
Input||Y ^
,||^ _
title||` e
)||e f
;||f g
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 1
,}}1 2
	SqlDbType}}3 <
.}}< =
NVarChar}}= E
,}}E F
-}}G H
$num}}H I
,}}I J
ParameterDirection}}K ]
.}}] ^
Input}}^ c
,}}c d
userComment}}e p
)}}p q
;}}q r
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# .
,~~. /
	SqlDbType~~0 9
.~~9 :
NVarChar~~: B
,~~B C
$num~~D F
,~~F G
ParameterDirection~~H Z
.~~Z [
Input~~[ `
,~~` a
userName~~b j
)~~j k
;~~k l
sph 
. 
DefineSqlParameter "
(" #
$str# /
,/ 0
	SqlDbType1 :
.: ;
NVarChar; C
,C D
$numE H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c
	userEmaild m
)m n
;n o
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# -
,
ÄÄ- .
	SqlDbType
ÄÄ/ 8
.
ÄÄ8 9
NVarChar
ÄÄ9 A
,
ÄÄA B
$num
ÄÄC F
,
ÄÄF G 
ParameterDirection
ÄÄH Z
.
ÄÄZ [
Input
ÄÄ[ `
,
ÄÄ` a
userUrl
ÄÄb i
)
ÄÄi j
;
ÄÄj k
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# ,
,
ÅÅ, -
	SqlDbType
ÅÅ. 7
.
ÅÅ7 8
NVarChar
ÅÅ8 @
,
ÅÅ@ A
$num
ÅÅB D
,
ÅÅD E 
ParameterDirection
ÅÅF X
.
ÅÅX Y
Input
ÅÅY ^
,
ÅÅ^ _
userIp
ÅÅ` f
)
ÅÅf g
;
ÅÅg h
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 0
,
ÇÇ0 1
	SqlDbType
ÇÇ2 ;
.
ÇÇ; <
DateTime
ÇÇ< D
,
ÇÇD E 
ParameterDirection
ÇÇF X
.
ÇÇX Y
Input
ÇÇY ^
,
ÇÇ^ _

lastModUtc
ÇÇ` j
)
ÇÇj k
;
ÇÇk l
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 6
,
ÉÉ6 7
	SqlDbType
ÉÉ8 A
.
ÉÉA B
TinyInt
ÉÉB I
,
ÉÉI J 
ParameterDirection
ÉÉK ]
.
ÉÉ] ^
Input
ÉÉ^ c
,
ÉÉc d
moderationStatus
ÉÉe u
)
ÉÉu v
;
ÉÉv w
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 1
,
ÑÑ1 2
	SqlDbType
ÑÑ3 <
.
ÑÑ< =
UniqueIdentifier
ÑÑ= M
,
ÑÑM N 
ParameterDirection
ÑÑO a
.
ÑÑa b
Input
ÑÑb g
,
ÑÑg h
moderatedBy
ÑÑi t
)
ÑÑt u
;
ÑÑu v
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 6
,
ÖÖ6 7
	SqlDbType
ÖÖ8 A
.
ÖÖA B
NVarChar
ÖÖB J
,
ÖÖJ K
$num
ÖÖL O
,
ÖÖO P 
ParameterDirection
ÖÖQ c
.
ÖÖc d
Input
ÖÖd i
,
ÖÖi j
moderationReason
ÖÖk {
)
ÖÖ{ |
;
ÖÖ| }
int
ÜÜ 
rowsAffected
ÜÜ 
=
ÜÜ 
sph
ÜÜ "
.
ÜÜ" #
ExecuteNonQuery
ÜÜ# 2
(
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5
return
áá 
(
áá 
rowsAffected
áá  
>
áá! "
$num
áá# $
)
áá$ %
;
áá% &
}
ââ 	
public
êê 
static
êê 
bool
êê 
Delete
êê !
(
êê! "
Guid
êê" &
guid
êê' +
)
êê+ ,
{
ëë 	 
SqlParameterHelper
íí 
sph
íí "
=
íí# $
new
íí% ( 
SqlParameterHelper
íí) ;
(
íí; <
ConnectionString
íí< L
.
ííL M&
GetWriteConnectionString
ííM e
(
ííe f
)
ííf g
,
ííg h
$str
ííi }
,
íí} ~
$numíí Ä
)ííÄ Å
;ííÅ Ç
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# *
,
ìì* +
	SqlDbType
ìì, 5
.
ìì5 6
UniqueIdentifier
ìì6 F
,
ììF G 
ParameterDirection
ììH Z
.
ììZ [
Input
ìì[ `
,
ìì` a
guid
ììb f
)
ììf g
;
ììg h
int
îî 
rowsAffected
îî 
=
îî 
sph
îî "
.
îî" #
ExecuteNonQuery
îî# 2
(
îî2 3
)
îî3 4
;
îî4 5
return
ïï 
(
ïï 
rowsAffected
ïï  
>
ïï! "
$num
ïï# $
)
ïï$ %
;
ïï% &
}
óó 	
public
ûû 
static
ûû 
bool
ûû 
DeleteByContent
ûû *
(
ûû* +
Guid
ûû+ /
contentGuid
ûû0 ;
)
ûû; <
{
üü 	 
SqlParameterHelper
†† 
sph
†† "
=
††# $
new
††% ( 
SqlParameterHelper
††) ;
(
††; <
ConnectionString
††< L
.
††L M&
GetWriteConnectionString
††M e
(
††e f
)
††f g
,
††g h
$str††i Ü
,††Ü á
$num††à â
)††â ä
;††ä ã
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 1
,
°°1 2
	SqlDbType
°°3 <
.
°°< =
UniqueIdentifier
°°= M
,
°°M N 
ParameterDirection
°°O a
.
°°a b
Input
°°b g
,
°°g h
contentGuid
°°i t
)
°°t u
;
°°u v
int
¢¢ 
rowsAffected
¢¢ 
=
¢¢ 
sph
¢¢ "
.
¢¢" #
ExecuteNonQuery
¢¢# 2
(
¢¢2 3
)
¢¢3 4
;
¢¢4 5
return
££ 
(
££ 
rowsAffected
££  
>
££! "
$num
££# $
)
££$ %
;
££% &
}
•• 	
public
¨¨ 
static
¨¨ 
bool
¨¨ 
DeleteBySite
¨¨ '
(
¨¨' (
Guid
¨¨( ,
siteGuid
¨¨- 5
)
¨¨5 6
{
≠≠ 	 
SqlParameterHelper
ÆÆ 
sph
ÆÆ "
=
ÆÆ# $
new
ÆÆ% ( 
SqlParameterHelper
ÆÆ) ;
(
ÆÆ; <
ConnectionString
ÆÆ< L
.
ÆÆL M&
GetWriteConnectionString
ÆÆM e
(
ÆÆe f
)
ÆÆf g
,
ÆÆg h
$strÆÆi É
,ÆÆÉ Ñ
$numÆÆÖ Ü
)ÆÆÜ á
;ÆÆá à
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
UniqueIdentifier
ØØ: J
,
ØØJ K 
ParameterDirection
ØØL ^
.
ØØ^ _
Input
ØØ_ d
,
ØØd e
siteGuid
ØØf n
)
ØØn o
;
ØØo p
int
∞∞ 
rowsAffected
∞∞ 
=
∞∞ 
sph
∞∞ "
.
∞∞" #
ExecuteNonQuery
∞∞# 2
(
∞∞2 3
)
∞∞3 4
;
∞∞4 5
return
±± 
(
±± 
rowsAffected
±±  
>
±±! "
$num
±±# $
)
±±$ %
;
±±% &
}
≥≥ 	
public
∫∫ 
static
∫∫ 
bool
∫∫ 
DeleteByFeature
∫∫ *
(
∫∫* +
Guid
∫∫+ /
featureGuid
∫∫0 ;
)
∫∫; <
{
ªª 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M&
GetWriteConnectionString
ººM e
(
ººe f
)
ººf g
,
ººg h
$strººi Ü
,ººÜ á
$numººà â
)ººâ ä
;ººä ã
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# 1
,
ΩΩ1 2
	SqlDbType
ΩΩ3 <
.
ΩΩ< =
UniqueIdentifier
ΩΩ= M
,
ΩΩM N 
ParameterDirection
ΩΩO a
.
ΩΩa b
Input
ΩΩb g
,
ΩΩg h
featureGuid
ΩΩi t
)
ΩΩt u
;
ΩΩu v
int
ææ 
rowsAffected
ææ 
=
ææ 
sph
ææ "
.
ææ" #
ExecuteNonQuery
ææ# 2
(
ææ2 3
)
ææ3 4
;
ææ4 5
return
øø 
(
øø 
rowsAffected
øø  
>
øø! "
$num
øø# $
)
øø$ %
;
øø% &
}
¡¡ 	
public
»» 
static
»» 
bool
»» 
DeleteByModule
»» )
(
»») *
Guid
»»* .

moduleGuid
»»/ 9
)
»»9 :
{
…… 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M&
GetWriteConnectionString
  M e
(
  e f
)
  f g
,
  g h
$str  i Ö
,  Ö Ü
$num  á à
)  à â
;  â ä
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 0
,
ÀÀ0 1
	SqlDbType
ÀÀ2 ;
.
ÀÀ; <
UniqueIdentifier
ÀÀ< L
,
ÀÀL M 
ParameterDirection
ÀÀN `
.
ÀÀ` a
Input
ÀÀa f
,
ÀÀf g

moduleGuid
ÀÀh r
)
ÀÀr s
;
ÀÀs t
int
ÃÃ 
rowsAffected
ÃÃ 
=
ÃÃ 
sph
ÃÃ "
.
ÃÃ" #
ExecuteNonQuery
ÃÃ# 2
(
ÃÃ2 3
)
ÃÃ3 4
;
ÃÃ4 5
return
ÕÕ 
(
ÕÕ 
rowsAffected
ÕÕ  
>
ÕÕ! "
$num
ÕÕ# $
)
ÕÕ$ %
;
ÕÕ% &
}
œœ 	
public
÷÷ 
static
÷÷ 
bool
÷÷ 
DeleteByParent
÷÷ )
(
÷÷) *
Guid
÷÷* .

parentGuid
÷÷/ 9
)
÷÷9 :
{
◊◊ 	 
SqlParameterHelper
ÿÿ 
sph
ÿÿ "
=
ÿÿ# $
new
ÿÿ% ( 
SqlParameterHelper
ÿÿ) ;
(
ÿÿ; <
ConnectionString
ÿÿ< L
.
ÿÿL M&
GetWriteConnectionString
ÿÿM e
(
ÿÿe f
)
ÿÿf g
,
ÿÿg h
$strÿÿi Ö
,ÿÿÖ Ü
$numÿÿá à
)ÿÿà â
;ÿÿâ ä
sph
ŸŸ 
.
ŸŸ  
DefineSqlParameter
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# 0
,
ŸŸ0 1
	SqlDbType
ŸŸ2 ;
.
ŸŸ; <
UniqueIdentifier
ŸŸ< L
,
ŸŸL M 
ParameterDirection
ŸŸN `
.
ŸŸ` a
Input
ŸŸa f
,
ŸŸf g

parentGuid
ŸŸh r
)
ŸŸr s
;
ŸŸs t
int
⁄⁄ 
rowsAffected
⁄⁄ 
=
⁄⁄ 
sph
⁄⁄ "
.
⁄⁄" #
ExecuteNonQuery
⁄⁄# 2
(
⁄⁄2 3
)
⁄⁄3 4
;
⁄⁄4 5
return
€€ 
(
€€ 
rowsAffected
€€  
>
€€! "
$num
€€# $
)
€€$ %
;
€€% &
}
›› 	
public
„„ 
static
„„ 
IDataReader
„„ !
GetOne
„„" (
(
„„( )
Guid
„„) -
guid
„„. 2
)
„„2 3
{
‰‰ 	 
SqlParameterHelper
ÂÂ 
sph
ÂÂ "
=
ÂÂ# $
new
ÂÂ% ( 
SqlParameterHelper
ÂÂ) ;
(
ÂÂ; <
ConnectionString
ÂÂ< L
.
ÂÂL M%
GetReadConnectionString
ÂÂM d
(
ÂÂd e
)
ÂÂe f
,
ÂÂf g
$str
ÂÂh 
,ÂÂ Ä
$numÂÂÅ Ç
)ÂÂÇ É
;ÂÂÉ Ñ
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# *
,
ÊÊ* +
	SqlDbType
ÊÊ, 5
.
ÊÊ5 6
UniqueIdentifier
ÊÊ6 F
,
ÊÊF G 
ParameterDirection
ÊÊH Z
.
ÊÊZ [
Input
ÊÊ[ `
,
ÊÊ` a
guid
ÊÊb f
)
ÊÊf g
;
ÊÊg h
return
ÁÁ 
sph
ÁÁ 
.
ÁÁ 
ExecuteReader
ÁÁ $
(
ÁÁ$ %
)
ÁÁ% &
;
ÁÁ& '
}
ÈÈ 	
public
ÔÔ 
static
ÔÔ 
IDataReader
ÔÔ !
GetByContentAsc
ÔÔ" 1
(
ÔÔ1 2
Guid
ÔÔ2 6
contentGuid
ÔÔ7 B
)
ÔÔB C
{
 	 
SqlParameterHelper
ÒÒ 
sph
ÒÒ "
=
ÒÒ# $
new
ÒÒ% ( 
SqlParameterHelper
ÒÒ) ;
(
ÒÒ; <
ConnectionString
ÒÒ< L
.
ÒÒL M%
GetReadConnectionString
ÒÒM d
(
ÒÒd e
)
ÒÒe f
,
ÒÒf g
$strÒÒh à
,ÒÒà â
$numÒÒä ã
)ÒÒã å
;ÒÒå ç
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 1
,
ÚÚ1 2
	SqlDbType
ÚÚ3 <
.
ÚÚ< =
UniqueIdentifier
ÚÚ= M
,
ÚÚM N 
ParameterDirection
ÚÚO a
.
ÚÚa b
Input
ÚÚb g
,
ÚÚg h
contentGuid
ÚÚi t
)
ÚÚt u
;
ÚÚu v
return
ÛÛ 
sph
ÛÛ 
.
ÛÛ 
ExecuteReader
ÛÛ $
(
ÛÛ$ %
)
ÛÛ% &
;
ÛÛ& '
}
ıı 	
public
˚˚ 
static
˚˚ 
IDataReader
˚˚ !
GetByContentDesc
˚˚" 2
(
˚˚2 3
Guid
˚˚3 7
contentGuid
˚˚8 C
)
˚˚C D
{
¸¸ 	 
SqlParameterHelper
˝˝ 
sph
˝˝ "
=
˝˝# $
new
˝˝% ( 
SqlParameterHelper
˝˝) ;
(
˝˝; <
ConnectionString
˝˝< L
.
˝˝L M%
GetReadConnectionString
˝˝M d
(
˝˝d e
)
˝˝e f
,
˝˝f g
$str˝˝h â
,˝˝â ä
$num˝˝ã å
)˝˝å ç
;˝˝ç é
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# 1
,
˛˛1 2
	SqlDbType
˛˛3 <
.
˛˛< =
UniqueIdentifier
˛˛= M
,
˛˛M N 
ParameterDirection
˛˛O a
.
˛˛a b
Input
˛˛b g
,
˛˛g h
contentGuid
˛˛i t
)
˛˛t u
;
˛˛u v
return
ˇˇ 
sph
ˇˇ 
.
ˇˇ 
ExecuteReader
ˇˇ $
(
ˇˇ$ %
)
ˇˇ% &
;
ˇˇ& '
}
ÅÅ 	
public
áá 
static
áá 
IDataReader
áá !
GetByParentAsc
áá" 0
(
áá0 1
Guid
áá1 5

parentGuid
áá6 @
)
áá@ A
{
àà 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M%
GetReadConnectionString
ââM d
(
ââd e
)
ââe f
,
ââf g
$strââh á
,ââá à
$numâââ ä
)ââä ã
;ââã å
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 0
,
ää0 1
	SqlDbType
ää2 ;
.
ää; <
UniqueIdentifier
ää< L
,
ääL M 
ParameterDirection
ääN `
.
ää` a
Input
ääa f
,
ääf g

parentGuid
ääh r
)
äär s
;
ääs t
return
ãã 
sph
ãã 
.
ãã 
ExecuteReader
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
çç 	
public
ìì 
static
ìì 
IDataReader
ìì !
GetByParentDesc
ìì" 1
(
ìì1 2
Guid
ìì2 6

parentGuid
ìì7 A
)
ììA B
{
îî 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M%
GetReadConnectionString
ïïM d
(
ïïd e
)
ïïe f
,
ïïf g
$strïïh à
,ïïà â
$numïïä ã
)ïïã å
;ïïå ç
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 0
,
ññ0 1
	SqlDbType
ññ2 ;
.
ññ; <
UniqueIdentifier
ññ< L
,
ññL M 
ParameterDirection
ññN `
.
ññ` a
Input
ñña f
,
ññf g

parentGuid
ññh r
)
ññr s
;
ññs t
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
ôô 	
public
ûû 
static
ûû 
int
ûû 
GetCount
ûû "
(
ûû" #
Guid
ûû# '
contentGuid
ûû( 3
,
ûû3 4
int
ûû5 8
moderationStatus
ûû9 I
)
ûûI J
{
üü 	 
SqlParameterHelper
†† 
sph
†† "
=
††# $
new
††% ( 
SqlParameterHelper
††) ;
(
††; <
ConnectionString
††< L
.
††L M%
GetReadConnectionString
††M d
(
††d e
)
††e f
,
††f g
$str††h Ñ
,††Ñ Ö
$num††Ü á
)††á à
;††à â
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 1
,
°°1 2
	SqlDbType
°°3 <
.
°°< =
UniqueIdentifier
°°= M
,
°°M N 
ParameterDirection
°°O a
.
°°a b
Input
°°b g
,
°°g h
contentGuid
°°i t
)
°°t u
;
°°u v
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 6
,
¢¢6 7
	SqlDbType
¢¢8 A
.
¢¢A B
TinyInt
¢¢B I
,
¢¢I J 
ParameterDirection
¢¢K ]
.
¢¢] ^
Input
¢¢^ c
,
¢¢c d
moderationStatus
¢¢e u
)
¢¢u v
;
¢¢v w
return
§§ 
Convert
§§ 
.
§§ 
ToInt32
§§ "
(
§§" #
sph
§§# &
.
§§& '
ExecuteScalar
§§' 4
(
§§4 5
)
§§5 6
)
§§6 7
;
§§7 8
}
¶¶ 	
public
®® 
static
®® 
int
®® 
GetCountByModule
®® *
(
®®* +
Guid
®®+ /

moduleGuid
®®0 :
,
®®: ;
int
®®< ?
moderationStatus
®®@ P
)
®®P Q
{
©© 	 
SqlParameterHelper
™™ 
sph
™™ "
=
™™# $
new
™™% ( 
SqlParameterHelper
™™) ;
(
™™; <
ConnectionString
™™< L
.
™™L M%
GetReadConnectionString
™™M d
(
™™d e
)
™™e f
,
™™f g
$str™™h É
,™™É Ñ
$num™™Ö Ü
)™™Ü á
;™™á à
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 0
,
´´0 1
	SqlDbType
´´2 ;
.
´´; <
UniqueIdentifier
´´< L
,
´´L M 
ParameterDirection
´´N `
.
´´` a
Input
´´a f
,
´´f g

moduleGuid
´´h r
)
´´r s
;
´´s t
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 6
,
¨¨6 7
	SqlDbType
¨¨8 A
.
¨¨A B
TinyInt
¨¨B I
,
¨¨I J 
ParameterDirection
¨¨K ]
.
¨¨] ^
Input
¨¨^ c
,
¨¨c d
moderationStatus
¨¨e u
)
¨¨u v
;
¨¨v w
return
ÆÆ 
Convert
ÆÆ 
.
ÆÆ 
ToInt32
ÆÆ "
(
ÆÆ" #
sph
ÆÆ# &
.
ÆÆ& '
ExecuteScalar
ÆÆ' 4
(
ÆÆ4 5
)
ÆÆ5 6
)
ÆÆ6 7
;
ÆÆ7 8
}
∞∞ 	
public
≤≤ 
static
≤≤ 
int
≤≤ 
GetCountBySite
≤≤ (
(
≤≤( )
Guid
≤≤) -
siteGuid
≤≤. 6
)
≤≤6 7
{
≥≥ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M%
GetReadConnectionString
¥¥M d
(
¥¥d e
)
¥¥e f
,
¥¥f g
$str¥¥h Å
,¥¥Å Ç
$num¥¥É Ñ
)¥¥Ñ Ö
;¥¥Ö Ü
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
return
∏∏ 
Convert
∏∏ 
.
∏∏ 
ToInt32
∏∏ "
(
∏∏" #
sph
∏∏# &
.
∏∏& '
ExecuteScalar
∏∏' 4
(
∏∏4 5
)
∏∏5 6
)
∏∏6 7
;
∏∏7 8
}
∫∫ 	
}
¿¿ 
}¬¬ €ó
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCommerceReport.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBCommerceReport (
{ 
public;; 
static;; 
int;; 
Create;;  
(;;  !
Guid<< 
rowGuid<< 
,<< 
Guid== 
siteGuid== 
,== 
Guid>> 
userGuid>> 
,>> 
Guid?? 
featureGuid?? 
,?? 
Guid@@ 

moduleGuid@@ 
,@@ 
stringAA 
moduleTitleAA 
,AA 
GuidBB 
	orderGuidBB 
,BB 
GuidCC 
itemGuidCC 
,CC 
stringDD 
itemNameDD 
,DD 
intEE 
quantityEE 
,EE 
decimalFF 
priceFF 
,FF 
decimalGG 
subTotalGG 
,GG 
DateTimeHH 
orderDateUtcHH !
,HH! "
stringII 
paymentMethodII  
,II  !
stringJJ 
	iPAddressJJ 
,JJ 
stringKK 
adminOrderLinkKK !
,KK! "
stringLL 
userOrderLinkLL  
,LL  !
DateTimeMM 
rowCreatedUtcMM "
,MM" #
boolNN 
includeInAggregateNN #
)NN# $
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$str	PPi É
,
PPÉ Ñ
$num
PPÖ á
)
PPá à
;
PPà â
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
UniqueIdentifierQQ9 I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
rowGuidQQe l
)QQl m
;QQm n
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
UniqueIdentifierRR: J
,RRJ K
ParameterDirectionRRL ^
.RR^ _
InputRR_ d
,RRd e
siteGuidRRf n
)RRn o
;RRo p
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
userGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
UniqueIdentifierTT= M
,TTM N
ParameterDirectionTTO a
.TTa b
InputTTb g
,TTg h
featureGuidTTi t
)TTt u
;TTu v
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
UniqueIdentifierUU< L
,UUL M
ParameterDirectionUUN `
.UU` a
InputUUa f
,UUf g

moduleGuidUUh r
)UUr s
;UUs t
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 1
,VV1 2
	SqlDbTypeVV3 <
.VV< =
NVarCharVV= E
,VVE F
$numVVG J
,VVJ K
ParameterDirectionVVL ^
.VV^ _
InputVV_ d
,VVd e
moduleTitleVVf q
)VVq r
;VVr s
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
UniqueIdentifierWW; K
,WWK L
ParameterDirectionWWM _
.WW_ `
InputWW` e
,WWe f
	orderGuidWWg p
)WWp q
;WWq r
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
itemGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
NVarCharYY: B
,YYB C
$numYYD G
,YYG H
ParameterDirectionYYI [
.YY[ \
InputYY\ a
,YYa b
itemNameYYc k
)YYk l
;YYl m
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# .
,ZZ. /
	SqlDbTypeZZ0 9
.ZZ9 :
IntZZ: =
,ZZ= >
ParameterDirectionZZ? Q
.ZZQ R
InputZZR W
,ZZW X
quantityZZY a
)ZZa b
;ZZb c
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# +
,[[+ ,
	SqlDbType[[- 6
.[[6 7
Decimal[[7 >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
price[[Z _
)[[_ `
;[[` a
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
Decimal\\: A
,\\A B
ParameterDirection\\C U
.\\U V
Input\\V [
,\\[ \
subTotal\\] e
)\\e f
;\\f g
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 2
,]]2 3
	SqlDbType]]4 =
.]]= >
DateTime]]> F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
orderDateUtc]]b n
)]]n o
;]]o p
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 3
,^^3 4
	SqlDbType^^5 >
.^^> ?
NVarChar^^? G
,^^G H
$num^^I K
,^^K L
ParameterDirection^^M _
.^^_ `
Input^^` e
,^^e f
paymentMethod^^g t
)^^t u
;^^u v
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# /
,__/ 0
	SqlDbType__1 :
.__: ;
NVarChar__; C
,__C D
$num__E H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
	iPAddress__d m
)__m n
;__n o
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 4
,``4 5
	SqlDbType``6 ?
.``? @
NVarChar``@ H
,``H I
$num``J M
,``M N
ParameterDirection``O a
.``a b
Input``b g
,``g h
adminOrderLink``i w
)``w x
;``x y
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 3
,aa3 4
	SqlDbTypeaa5 >
.aa> ?
NVarCharaa? G
,aaG H
$numaaI L
,aaL M
ParameterDirectionaaN `
.aa` a
Inputaaa f
,aaf g
userOrderLinkaah u
)aau v
;aav w
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 3
,bb3 4
	SqlDbTypebb5 >
.bb> ?
DateTimebb? G
,bbG H
ParameterDirectionbbI [
.bb[ \
Inputbb\ a
,bba b
rowCreatedUtcbbc p
)bbp q
;bbq r
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 8
,cc8 9
	SqlDbTypecc: C
.ccC D
BitccD G
,ccG H
ParameterDirectionccI [
.cc[ \
Inputcc\ a
,cca b
includeInAggregateccc u
)ccu v
;ccv w
intdd 
rowsAffecteddd 
=dd 
sphdd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
returnee 
rowsAffectedee 
;ee  
}gg 	
publicnn 
staticnn 
boolnn 
Deletenn !
(nn! "
Guidnn" &
rowGuidnn' .
)nn. /
{oo 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M$
GetWriteConnectionStringppM e
(ppe f
)ppf g
,ppg h
$str	ppi É
,
ppÉ Ñ
$num
ppÖ Ü
)
ppÜ á
;
ppá à
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# -
,qq- .
	SqlDbTypeqq/ 8
.qq8 9
UniqueIdentifierqq9 I
,qqI J
ParameterDirectionqqK ]
.qq] ^
Inputqq^ c
,qqc d
rowGuidqqe l
)qql m
;qqm n
intrr 
rowsAffectedrr 
=rr 
sphrr "
.rr" #
ExecuteNonQueryrr# 2
(rr2 3
)rr3 4
;rr4 5
returnss 
(ss 
rowsAffectedss  
>ss! "
$numss# $
)ss$ %
;ss% &
}uu 	
public|| 
static|| 
bool|| 
DeleteBySite|| '
(||' (
Guid||( ,
siteGuid||- 5
)||5 6
{}} 	
SqlParameterHelper~~ 
sph~~ "
=~~# $
new~~% (
SqlParameterHelper~~) ;
(~~; <
ConnectionString~~< L
.~~L M$
GetWriteConnectionString~~M e
(~~e f
)~~f g
,~~g h
$str	~~i â
,
~~â ä
$num
~~ã å
)
~~å ç
;
~~ç é
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
siteGuidf n
)n o
;o p
int
ÄÄ 
rowsAffected
ÄÄ 
=
ÄÄ 
sph
ÄÄ "
.
ÄÄ" #
ExecuteNonQuery
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
return
ÅÅ 
(
ÅÅ 
rowsAffected
ÅÅ  
>
ÅÅ! "
$num
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÉÉ 	
public
ää 
static
ää 
bool
ää 
DeleteByUser
ää '
(
ää' (
Guid
ää( ,
userGuid
ää- 5
)
ää5 6
{
ãã 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M&
GetWriteConnectionString
ååM e
(
ååe f
)
ååf g
,
ååg h
$strååi â
,ååâ ä
$numååã å
)ååå ç
;ååç é
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# .
,
çç. /
	SqlDbType
çç0 9
.
çç9 :
UniqueIdentifier
çç: J
,
ççJ K 
ParameterDirection
ççL ^
.
çç^ _
Input
çç_ d
,
ççd e
userGuid
ççf n
)
ççn o
;
çço p
int
éé 
rowsAffected
éé 
=
éé 
sph
éé "
.
éé" #
ExecuteNonQuery
éé# 2
(
éé2 3
)
éé3 4
;
éé4 5
return
èè 
(
èè 
rowsAffected
èè  
>
èè! "
$num
èè# $
)
èè$ %
;
èè% &
}
ëë 	
public
òò 
static
òò 
bool
òò 
DeleteByFeature
òò *
(
òò* +
Guid
òò+ /
featureGuid
òò0 ;
)
òò; <
{
ôô 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M&
GetWriteConnectionString
ööM e
(
ööe f
)
ööf g
,
öög h
$strööi å
,ööå ç
$numööé è
)ööè ê
;ööê ë
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 1
,
õõ1 2
	SqlDbType
õõ3 <
.
õõ< =
UniqueIdentifier
õõ= M
,
õõM N 
ParameterDirection
õõO a
.
õõa b
Input
õõb g
,
õõg h
featureGuid
õõi t
)
õõt u
;
õõu v
int
úú 
rowsAffected
úú 
=
úú 
sph
úú "
.
úú" #
ExecuteNonQuery
úú# 2
(
úú2 3
)
úú3 4
;
úú4 5
return
ùù 
(
ùù 
rowsAffected
ùù  
>
ùù! "
$num
ùù# $
)
ùù$ %
;
ùù% &
}
üü 	
public
¶¶ 
static
¶¶ 
bool
¶¶ 
DeleteByModule
¶¶ )
(
¶¶) *
Guid
¶¶* .

moduleGuid
¶¶/ 9
)
¶¶9 :
{
ßß 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M&
GetWriteConnectionString
®®M e
(
®®e f
)
®®f g
,
®®g h
$str®®i ã
,®®ã å
$num®®ç é
)®®é è
;®®è ê
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# 0
,
©©0 1
	SqlDbType
©©2 ;
.
©©; <
UniqueIdentifier
©©< L
,
©©L M 
ParameterDirection
©©N `
.
©©` a
Input
©©a f
,
©©f g

moduleGuid
©©h r
)
©©r s
;
©©s t
int
™™ 
rowsAffected
™™ 
=
™™ 
sph
™™ "
.
™™" #
ExecuteNonQuery
™™# 2
(
™™2 3
)
™™3 4
;
™™4 5
return
´´ 
(
´´ 
rowsAffected
´´  
>
´´! "
$num
´´# $
)
´´$ %
;
´´% &
}
≠≠ 	
public
¥¥ 
static
¥¥ 
bool
¥¥ 
DeleteByOrder
¥¥ (
(
¥¥( )
Guid
¥¥) -
	orderGuid
¥¥. 7
)
¥¥7 8
{
µµ 	 
SqlParameterHelper
∂∂ 
sph
∂∂ "
=
∂∂# $
new
∂∂% ( 
SqlParameterHelper
∂∂) ;
(
∂∂; <
ConnectionString
∂∂< L
.
∂∂L M&
GetWriteConnectionString
∂∂M e
(
∂∂e f
)
∂∂f g
,
∂∂g h
$str∂∂i é
,∂∂é è
$num∂∂ê ë
)∂∂ë í
;∂∂í ì
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# /
,
∑∑/ 0
	SqlDbType
∑∑1 :
.
∑∑: ;
UniqueIdentifier
∑∑; K
,
∑∑K L 
ParameterDirection
∑∑M _
.
∑∑_ `
Input
∑∑` e
,
∑∑e f
	orderGuid
∑∑g p
)
∑∑p q
;
∑∑q r
int
∏∏ 
rowsAffected
∏∏ 
=
∏∏ 
sph
∏∏ "
.
∏∏" #
ExecuteNonQuery
∏∏# 2
(
∏∏2 3
)
∏∏3 4
;
∏∏4 5
return
ππ 
(
ππ 
rowsAffected
ππ  
>
ππ! "
$num
ππ# $
)
ππ$ %
;
ππ% &
}
ªª 	
public
ΩΩ 
static
ΩΩ 
IDataReader
ΩΩ !$
GetSalesByYearByModule
ΩΩ" 8
(
ΩΩ8 9
Guid
ΩΩ9 =

moduleGuid
ΩΩ> H
)
ΩΩH I
{
ææ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M%
GetReadConnectionString
øøM d
(
øød e
)
øøe f
,
øøf g
$strøøh í
,øøí ì
$numøøî ï
)øøï ñ
;øøñ ó
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 0
,
¿¿0 1
	SqlDbType
¿¿2 ;
.
¿¿; <
UniqueIdentifier
¿¿< L
,
¿¿L M 
ParameterDirection
¿¿N `
.
¿¿` a
Input
¿¿a f
,
¿¿f g

moduleGuid
¿¿h r
)
¿¿r s
;
¿¿s t
return
¡¡ 
sph
¡¡ 
.
¡¡ 
ExecuteReader
¡¡ $
(
¡¡$ %
)
¡¡% &
;
¡¡& '
}
¬¬ 	
public
ƒƒ 
static
ƒƒ 
IDataReader
ƒƒ !'
GetSalesByYearMonthBySite
ƒƒ" ;
(
ƒƒ; <
Guid
ƒƒ< @
siteGuid
ƒƒA I
)
ƒƒI J
{
≈≈ 	 
SqlParameterHelper
∆∆ 
sph
∆∆ "
=
∆∆# $
new
∆∆% ( 
SqlParameterHelper
∆∆) ;
(
∆∆; <
ConnectionString
∆∆< L
.
∆∆L M%
GetReadConnectionString
∆∆M d
(
∆∆d e
)
∆∆e f
,
∆∆f g
$str∆∆h ï
,∆∆ï ñ
$num∆∆ó ò
)∆∆ò ô
;∆∆ô ö
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# .
,
««. /
	SqlDbType
««0 9
.
««9 :
UniqueIdentifier
««: J
,
««J K 
ParameterDirection
««L ^
.
««^ _
Input
««_ d
,
««d e
siteGuid
««f n
)
««n o
;
««o p
return
»» 
sph
»» 
.
»» 
ExecuteReader
»» $
(
»»$ %
)
»»% &
;
»»& '
}
…… 	
public
ÀÀ 
static
ÀÀ 
IDataReader
ÀÀ !)
GetSalesByYearMonthByModule
ÀÀ" =
(
ÀÀ= >
Guid
ÀÀ> B

moduleGuid
ÀÀC M
)
ÀÀM N
{
ÃÃ 	 
SqlParameterHelper
ÕÕ 
sph
ÕÕ "
=
ÕÕ# $
new
ÕÕ% ( 
SqlParameterHelper
ÕÕ) ;
(
ÕÕ; <
ConnectionString
ÕÕ< L
.
ÕÕL M%
GetReadConnectionString
ÕÕM d
(
ÕÕd e
)
ÕÕe f
,
ÕÕf g
$strÕÕh ó
,ÕÕó ò
$numÕÕô ö
)ÕÕö õ
;ÕÕõ ú
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# 0
,
ŒŒ0 1
	SqlDbType
ŒŒ2 ;
.
ŒŒ; <
UniqueIdentifier
ŒŒ< L
,
ŒŒL M 
ParameterDirection
ŒŒN `
.
ŒŒ` a
Input
ŒŒa f
,
ŒŒf g

moduleGuid
ŒŒh r
)
ŒŒr s
;
ŒŒs t
return
œœ 
sph
œœ 
.
œœ 
ExecuteReader
œœ $
(
œœ$ %
)
œœ% &
;
œœ& '
}
–– 	
public
““ 
static
““ 
IDataReader
““ !'
GetSalesByYearMonthByItem
““" ;
(
““; <
Guid
““< @
itemGuid
““A I
)
““I J
{
”” 	 
SqlParameterHelper
‘‘ 
sph
‘‘ "
=
‘‘# $
new
‘‘% ( 
SqlParameterHelper
‘‘) ;
(
‘‘; <
ConnectionString
‘‘< L
.
‘‘L M%
GetReadConnectionString
‘‘M d
(
‘‘d e
)
‘‘e f
,
‘‘f g
$str‘‘h ï
,‘‘ï ñ
$num‘‘ó ò
)‘‘ò ô
;‘‘ô ö
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# .
,
’’. /
	SqlDbType
’’0 9
.
’’9 :
UniqueIdentifier
’’: J
,
’’J K 
ParameterDirection
’’L ^
.
’’^ _
Input
’’_ d
,
’’d e
itemGuid
’’f n
)
’’n o
;
’’o p
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
◊◊ 	
public
ŸŸ 
static
ŸŸ 
IDataReader
ŸŸ !'
GetSalesByYearMonthByUser
ŸŸ" ;
(
ŸŸ; <
Guid
ŸŸ< @
userGuid
ŸŸA I
)
ŸŸI J
{
⁄⁄ 	 
SqlParameterHelper
€€ 
sph
€€ "
=
€€# $
new
€€% ( 
SqlParameterHelper
€€) ;
(
€€; <
ConnectionString
€€< L
.
€€L M%
GetReadConnectionString
€€M d
(
€€d e
)
€€e f
,
€€f g
$str€€h ï
,€€ï ñ
$num€€ó ò
)€€ò ô
;€€ô ö
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# .
,
‹‹. /
	SqlDbType
‹‹0 9
.
‹‹9 :
UniqueIdentifier
‹‹: J
,
‹‹J K 
ParameterDirection
‹‹L ^
.
‹‹^ _
Input
‹‹_ d
,
‹‹d e
userGuid
‹‹f n
)
‹‹n o
;
‹‹o p
return
›› 
sph
›› 
.
›› 
ExecuteReader
›› $
(
››$ %
)
››% &
;
››& '
}
ﬁﬁ 	
public
‡‡ 
static
‡‡ 
IDataReader
‡‡ !%
GetSalesGroupedByModule
‡‡" 9
(
‡‡9 :
Guid
‡‡: >
siteGuid
‡‡? G
)
‡‡G H
{
·· 	 
SqlParameterHelper
‚‚ 
sph
‚‚ "
=
‚‚# $
new
‚‚% ( 
SqlParameterHelper
‚‚) ;
(
‚‚; <
ConnectionString
‚‚< L
.
‚‚L M%
GetReadConnectionString
‚‚M d
(
‚‚d e
)
‚‚e f
,
‚‚f g
$str‚‚h ì
,‚‚ì î
$num‚‚ï ñ
)‚‚ñ ó
;‚‚ó ò
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# .
,
„„. /
	SqlDbType
„„0 9
.
„„9 :
UniqueIdentifier
„„: J
,
„„J K 
ParameterDirection
„„L ^
.
„„^ _
Input
„„_ d
,
„„d e
siteGuid
„„f n
)
„„n o
;
„„o p
return
‰‰ 
sph
‰‰ 
.
‰‰ 
ExecuteReader
‰‰ $
(
‰‰$ %
)
‰‰% &
;
‰‰& '
}
ÂÂ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !#
GetSalesGroupedByUser
ÁÁ" 7
(
ÁÁ7 8
Guid
ÁÁ8 <
siteGuid
ÁÁ= E
)
ÁÁE F
{
ËË 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh ë
,ÈÈë í
$numÈÈì î
)ÈÈî ï
;ÈÈï ñ
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# .
,
ÍÍ. /
	SqlDbType
ÍÍ0 9
.
ÍÍ9 :
UniqueIdentifier
ÍÍ: J
,
ÍÍJ K 
ParameterDirection
ÍÍL ^
.
ÍÍ^ _
Input
ÍÍ_ d
,
ÍÍd e
siteGuid
ÍÍf n
)
ÍÍn o
;
ÍÍo p
return
ÎÎ 
sph
ÎÎ 
.
ÎÎ 
ExecuteReader
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
}
ÏÏ 	
public
ÓÓ 
static
ÓÓ 
IDataReader
ÓÓ !
GetItemSummary
ÓÓ" 0
(
ÓÓ0 1
Guid
ÓÓ1 5
itemGuid
ÓÓ6 >
)
ÓÓ> ?
{
ÔÔ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh ä
,ä ã
$numå ç
)ç é
;é è
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
UniqueIdentifier
ÒÒ: J
,
ÒÒJ K 
ParameterDirection
ÒÒL ^
.
ÒÒ^ _
Input
ÒÒ_ d
,
ÒÒd e
itemGuid
ÒÒf n
)
ÒÒn o
;
ÒÒo p
return
ÚÚ 
sph
ÚÚ 
.
ÚÚ 
ExecuteReader
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 	
public
ˆˆ 
static
ˆˆ 
IDataReader
ˆˆ !"
GetItemRevenueBySite
ˆˆ" 6
(
ˆˆ6 7
Guid
ˆˆ7 ;
siteGuid
ˆˆ< D
)
ˆˆD E
{
˜˜ 	 
SqlParameterHelper
¯¯ 
sph
¯¯ "
=
¯¯# $
new
¯¯% ( 
SqlParameterHelper
¯¯) ;
(
¯¯; <
ConnectionString
¯¯< L
.
¯¯L M%
GetReadConnectionString
¯¯M d
(
¯¯d e
)
¯¯e f
,
¯¯f g
$str¯¯h ê
,¯¯ê ë
$num¯¯í ì
)¯¯ì î
;¯¯î ï
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# .
,
˘˘. /
	SqlDbType
˘˘0 9
.
˘˘9 :
UniqueIdentifier
˘˘: J
,
˘˘J K 
ParameterDirection
˘˘L ^
.
˘˘^ _
Input
˘˘_ d
,
˘˘d e
siteGuid
˘˘f n
)
˘˘n o
;
˘˘o p
return
˚˚ 
sph
˚˚ 
.
˚˚ 
ExecuteReader
˚˚ $
(
˚˚$ %
)
˚˚% &
;
˚˚& '
}
¸¸ 	
public
˛˛ 
static
˛˛ 
IDataReader
˛˛ !$
GetItemRevenueByModule
˛˛" 8
(
˛˛8 9
Guid
˛˛9 =

moduleGuid
˛˛> H
)
˛˛H I
{
ˇˇ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh í
,ÄÄí ì
$numÄÄî ï
)ÄÄï ñ
;ÄÄñ ó
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 0
,
ÅÅ0 1
	SqlDbType
ÅÅ2 ;
.
ÅÅ; <
UniqueIdentifier
ÅÅ< L
,
ÅÅL M 
ParameterDirection
ÅÅN `
.
ÅÅ` a
Input
ÅÅa f
,
ÅÅf g

moduleGuid
ÅÅh r
)
ÅÅr s
;
ÅÅs t
return
ÉÉ 
sph
ÉÉ 
.
ÉÉ 
ExecuteReader
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
IDataReader
ÜÜ !"
GetItemRevenueByUser
ÜÜ" 6
(
ÜÜ6 7
Guid
ÜÜ7 ;
userGuid
ÜÜ< D
)
ÜÜD E
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh ê
,ààê ë
$numààí ì
)ààì î
;ààî ï
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# .
,
ââ. /
	SqlDbType
ââ0 9
.
ââ9 :
UniqueIdentifier
ââ: J
,
ââJ K 
ParameterDirection
ââL ^
.
ââ^ _
Input
ââ_ d
,
ââd e
userGuid
ââf n
)
âân o
;
ââo p
return
ãã 
sph
ãã 
.
ãã 
ExecuteReader
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
åå 	
public
éé 
static
éé 
decimal
éé %
GetAllTimeRevenueBySite
éé 5
(
éé5 6
Guid
éé6 :
siteGuid
éé; C
)
ééC D
{
èè 	 
SqlParameterHelper
êê 
sph
êê "
=
êê# $
new
êê% ( 
SqlParameterHelper
êê) ;
(
êê; <
ConnectionString
êê< L
.
êêL M%
GetReadConnectionString
êêM d
(
êêd e
)
êêe f
,
êêf g
$strêêh ì
,êêì î
$numêêï ñ
)êêñ ó
;êêó ò
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# .
,
ëë. /
	SqlDbType
ëë0 9
.
ëë9 :
UniqueIdentifier
ëë: J
,
ëëJ K 
ParameterDirection
ëëL ^
.
ëë^ _
Input
ëë_ d
,
ëëd e
siteGuid
ëëf n
)
ëën o
;
ëëo p
decimal
ìì 
result
ìì 
=
ìì 
$num
ìì 
;
ìì 
try
ïï 
{
ññ 
result
óó 
=
óó 
Convert
óó  
.
óó  !
	ToDecimal
óó! *
(
óó* +
sph
óó+ .
.
óó. /
ExecuteScalar
óó/ <
(
óó< =
)
óó= >
,
óó> ?
CultureInfo
óó? J
.
óóJ K
InvariantCulture
óóK [
)
óó[ \
;
óó\ ]
}
òò 
catch
ôô 
(
ôô "
InvalidCastException
ôô '
)
ôô' (
{
ôô) *
}
ôô+ ,
return
õõ 
result
õõ 
;
õõ 
}
úú 	
public
ûû 
static
ûû 
decimal
ûû '
GetAllTimeRevenueByModule
ûû 7
(
ûû7 8
Guid
ûû8 <

moduleGuid
ûû= G
)
ûûG H
{
üü 	 
SqlParameterHelper
†† 
sph
†† "
=
††# $
new
††% ( 
SqlParameterHelper
††) ;
(
††; <
ConnectionString
††< L
.
††L M%
GetReadConnectionString
††M d
(
††d e
)
††e f
,
††f g
$str††h ï
,††ï ñ
$num††ó ò
)††ò ô
;††ô ö
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 0
,
°°0 1
	SqlDbType
°°2 ;
.
°°; <
UniqueIdentifier
°°< L
,
°°L M 
ParameterDirection
°°N `
.
°°` a
Input
°°a f
,
°°f g

moduleGuid
°°h r
)
°°r s
;
°°s t
decimal
££ 
result
££ 
=
££ 
$num
££ 
;
££ 
try
•• 
{
¶¶ 
result
ßß 
=
ßß 
Convert
ßß  
.
ßß  !
	ToDecimal
ßß! *
(
ßß* +
sph
ßß+ .
.
ßß. /
ExecuteScalar
ßß/ <
(
ßß< =
)
ßß= >
,
ßß> ?
CultureInfo
ßß@ K
.
ßßK L
InvariantCulture
ßßL \
)
ßß\ ]
;
ßß] ^
}
®® 
catch
©© 
(
©© "
InvalidCastException
©© '
)
©©' (
{
©©) *
}
©©+ ,
return
´´ 
result
´´ 
;
´´ 
}
¨¨ 	
public
±± 
static
±± 
int
±±  
GetItemCountByUser
±± ,
(
±±, -
Guid
±±- 1
siteGuid
±±2 :
,
±±: ;
Guid
±±< @
userGuid
±±A I
)
±±I J
{
≤≤ 	 
SqlParameterHelper
≥≥ 
sph
≥≥ "
=
≥≥# $
new
≥≥% ( 
SqlParameterHelper
≥≥) ;
(
≥≥; <
ConnectionString
≥≥< L
.
≥≥L M%
GetReadConnectionString
≥≥M d
(
≥≥d e
)
≥≥e f
,
≥≥f g
$str≥≥h é
,≥≥é è
$num≥≥ê ë
)≥≥ë í
;≥≥í ì
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
UniqueIdentifier
¥¥: J
,
¥¥J K 
ParameterDirection
¥¥L ^
.
¥¥^ _
Input
¥¥_ d
,
¥¥d e
siteGuid
¥¥f n
)
¥¥n o
;
¥¥o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
userGuid
µµf n
)
µµn o
;
µµo p
return
∑∑ 
Convert
∑∑ 
.
∑∑ 
ToInt32
∑∑ "
(
∑∑" #
sph
∑∑# &
.
∑∑& '
ExecuteScalar
∑∑' 4
(
∑∑4 5
)
∑∑5 6
)
∑∑6 7
;
∑∑7 8
}
ππ 	
public
¡¡ 
static
¡¡ 
IDataReader
¡¡ !
GetUserItemsPage
¡¡" 2
(
¡¡2 3
Guid
¬¬ 
siteGuid
¬¬ 
,
¬¬ 
Guid
√√ 
userGuid
√√ 
,
√√ 
int
ƒƒ 

pageNumber
ƒƒ 
,
ƒƒ 
int
≈≈ 
pageSize
≈≈ 
,
≈≈ 
out
∆∆ 
int
∆∆ 

totalPages
∆∆ 
)
∆∆ 
{
«« 	

totalPages
»» 
=
»» 
$num
»» 
;
»» 
int
…… 
	totalRows
…… 
=
    
GetItemCountByUser
   $
(
  $ %
siteGuid
  % -
,
  - .
userGuid
  / 7
)
  7 8
;
  8 9
if
ÃÃ 
(
ÃÃ 
pageSize
ÃÃ 
>
ÃÃ 
$num
ÃÃ 
)
ÃÃ 

totalPages
ÃÃ (
=
ÃÃ) *
	totalRows
ÃÃ+ 4
/
ÃÃ5 6
pageSize
ÃÃ7 ?
;
ÃÃ? @
if
ŒŒ 
(
ŒŒ 
	totalRows
ŒŒ 
<=
ŒŒ 
pageSize
ŒŒ %
)
ŒŒ% &
{
œœ 

totalPages
–– 
=
–– 
$num
–– 
;
–– 
}
—— 
else
““ 
{
”” 
int
‘‘ 
	remainder
‘‘ 
;
‘‘ 
Math
’’ 
.
’’ 
DivRem
’’ 
(
’’ 
	totalRows
’’ %
,
’’% &
pageSize
’’' /
,
’’/ 0
out
’’1 4
	remainder
’’5 >
)
’’> ?
;
’’? @
if
÷÷ 
(
÷÷ 
	remainder
÷÷ 
>
÷÷ 
$num
÷÷  !
)
÷÷! "
{
◊◊ 

totalPages
ÿÿ 
+=
ÿÿ !
$num
ÿÿ" #
;
ÿÿ# $
}
ŸŸ 
}
⁄⁄  
SqlParameterHelper
‹‹ 
sph
‹‹ "
=
‹‹# $
new
‹‹% ( 
SqlParameterHelper
‹‹) ;
(
‹‹; <
ConnectionString
‹‹< L
.
‹‹L M%
GetReadConnectionString
‹‹M d
(
‹‹d e
)
‹‹e f
,
‹‹f g
$str‹‹h è
,‹‹è ê
$num‹‹ë í
)‹‹í ì
;‹‹ì î
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# .
,
››. /
	SqlDbType
››0 9
.
››9 :
UniqueIdentifier
››: J
,
››J K 
ParameterDirection
››L ^
.
››^ _
Input
››_ d
,
››d e
siteGuid
››f n
)
››n o
;
››o p
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# .
,
ﬁﬁ. /
	SqlDbType
ﬁﬁ0 9
.
ﬁﬁ9 :
UniqueIdentifier
ﬁﬁ: J
,
ﬁﬁJ K 
ParameterDirection
ﬁﬁL ^
.
ﬁﬁ^ _
Input
ﬁﬁ_ d
,
ﬁﬁd e
userGuid
ﬁﬁf n
)
ﬁﬁn o
;
ﬁﬁo p
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# 0
,
ﬂﬂ0 1
	SqlDbType
ﬂﬂ2 ;
.
ﬂﬂ; <
Int
ﬂﬂ< ?
,
ﬂﬂ? @ 
ParameterDirection
ﬂﬂA S
.
ﬂﬂS T
Input
ﬂﬂT Y
,
ﬂﬂY Z

pageNumber
ﬂﬂ[ e
)
ﬂﬂe f
;
ﬂﬂf g
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# .
,
‡‡. /
	SqlDbType
‡‡0 9
.
‡‡9 :
Int
‡‡: =
,
‡‡= > 
ParameterDirection
‡‡? Q
.
‡‡Q R
Input
‡‡R W
,
‡‡W X
pageSize
‡‡Y a
)
‡‡a b
;
‡‡b c
return
·· 
sph
·· 
.
·· 
ExecuteReader
·· $
(
··$ %
)
··% &
;
··& '
}
„„ 	
public
ÍÍ 
static
ÍÍ 
int
ÍÍ *
GetDistinctItemCountByModule
ÍÍ 6
(
ÍÍ6 7
Guid
ÍÍ7 ;

moduleGuid
ÍÍ< F
)
ÍÍF G
{
ÎÎ 	 
SqlParameterHelper
ÏÏ 
sph
ÏÏ "
=
ÏÏ# $
new
ÏÏ% ( 
SqlParameterHelper
ÏÏ) ;
(
ÏÏ; <
ConnectionString
ÏÏ< L
.
ÏÏL M%
GetReadConnectionString
ÏÏM d
(
ÏÏd e
)
ÏÏe f
,
ÏÏf g
$strÏÏh Ñ
,ÏÏÑ Ö
$numÏÏÜ á
)ÏÏá à
;ÏÏà â
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# 0
,
ÌÌ0 1
	SqlDbType
ÌÌ2 ;
.
ÌÌ; <
UniqueIdentifier
ÌÌ< L
,
ÌÌL M 
ParameterDirection
ÌÌN `
.
ÌÌ` a
Input
ÌÌa f
,
ÌÌf g

moduleGuid
ÌÌh r
)
ÌÌr s
;
ÌÌs t
return
ÔÔ 
Convert
ÔÔ 
.
ÔÔ 
ToInt32
ÔÔ "
(
ÔÔ" #
sph
ÔÔ# &
.
ÔÔ& '
ExecuteScalar
ÔÔ' 4
(
ÔÔ4 5
)
ÔÔ5 6
)
ÔÔ6 7
;
ÔÔ7 8
}
ÒÒ 	
public
˘˘ 
static
˘˘ 
IDataReader
˘˘ !"
GetItemsPageByModule
˘˘" 6
(
˘˘6 7
Guid
˙˙ 

moduleGuid
˙˙ 
,
˙˙ 
int
˚˚ 

pageNumber
˚˚ 
,
˚˚ 
int
¸¸ 
pageSize
¸¸ 
,
¸¸ 
out
˝˝ 
int
˝˝ 

totalPages
˝˝ 
)
˝˝ 
{
˛˛ 	

totalPages
ˇˇ 
=
ˇˇ 
$num
ˇˇ 
;
ˇˇ 
int
ÄÄ 
	totalRows
ÄÄ 
=
ÅÅ *
GetDistinctItemCountByModule
ÅÅ .
(
ÅÅ. /

moduleGuid
ÅÅ/ 9
)
ÅÅ9 :
;
ÅÅ: ;
if
ÉÉ 
(
ÉÉ 
pageSize
ÉÉ 
>
ÉÉ 
$num
ÉÉ 
)
ÉÉ 

totalPages
ÉÉ (
=
ÉÉ) *
	totalRows
ÉÉ+ 4
/
ÉÉ5 6
pageSize
ÉÉ7 ?
;
ÉÉ? @
if
ÖÖ 
(
ÖÖ 
	totalRows
ÖÖ 
<=
ÖÖ 
pageSize
ÖÖ %
)
ÖÖ% &
{
ÜÜ 

totalPages
áá 
=
áá 
$num
áá 
;
áá 
}
àà 
else
ââ 
{
ää 
int
ãã 
	remainder
ãã 
;
ãã 
Math
åå 
.
åå 
DivRem
åå 
(
åå 
	totalRows
åå %
,
åå% &
pageSize
åå' /
,
åå/ 0
out
åå1 4
	remainder
åå5 >
)
åå> ?
;
åå? @
if
çç 
(
çç 
	remainder
çç 
>
çç 
$num
çç  !
)
çç! "
{
éé 

totalPages
èè 
+=
èè !
$num
èè" #
;
èè# $
}
êê 
}
ëë  
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M%
GetReadConnectionString
ììM d
(
ììd e
)
ììe f
,
ììf g
$strììh Ü
,ììÜ á
$numììà â
)ììâ ä
;ììä ã
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 0
,
îî0 1
	SqlDbType
îî2 ;
.
îî; <
UniqueIdentifier
îî< L
,
îîL M 
ParameterDirection
îîN `
.
îî` a
Input
îîa f
,
îîf g

moduleGuid
îîh r
)
îîr s
;
îîs t
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 0
,
ïï0 1
	SqlDbType
ïï2 ;
.
ïï; <
Int
ïï< ?
,
ïï? @ 
ParameterDirection
ïïA S
.
ïïS T
Input
ïïT Y
,
ïïY Z

pageNumber
ïï[ e
)
ïïe f
;
ïïf g
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
Int
ññ: =
,
ññ= > 
ParameterDirection
ññ? Q
.
ññQ R
Input
ññR W
,
ññW X
pageSize
ññY a
)
ñña b
;
ññb c
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
ôô 	
public
üü 
static
üü 
int
üü &
GetDistinctUserItemCount
üü 2
(
üü2 3
Guid
üü3 7
siteGuid
üü8 @
)
üü@ A
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h í
,°°í ì
$num°°î ï
)°°ï ñ
;°°ñ ó
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
UniqueIdentifier
¢¢: J
,
¢¢J K 
ParameterDirection
¢¢L ^
.
¢¢^ _
Input
¢¢_ d
,
¢¢d e
siteGuid
¢¢f n
)
¢¢n o
;
¢¢o p
return
§§ 
Convert
§§ 
.
§§ 
ToInt32
§§ "
(
§§" #
sph
§§# &
.
§§& '
ExecuteScalar
§§' 4
(
§§4 5
)
§§5 6
)
§§6 7
;
§§7 8
}
¶¶ 	
public
ÆÆ 
static
ÆÆ 
IDataReader
ÆÆ !#
GetUserItemPageBySite
ÆÆ" 7
(
ÆÆ7 8
Guid
ØØ 
siteGuid
ØØ 
,
ØØ 
int
∞∞ 

pageNumber
∞∞ 
,
∞∞ 
int
±± 
pageSize
±± 
,
±± 
out
≤≤ 
int
≤≤ 

totalPages
≤≤ 
)
≤≤ 
{
≥≥ 	

totalPages
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥ 
int
µµ 
	totalRows
µµ 
=
∂∂ &
GetDistinctUserItemCount
∂∂ *
(
∂∂* +
siteGuid
∂∂+ 3
)
∂∂3 4
;
∂∂4 5
if
∏∏ 
(
∏∏ 
pageSize
∏∏ 
>
∏∏ 
$num
∏∏ 
)
∏∏ 

totalPages
∏∏ (
=
∏∏) *
	totalRows
∏∏+ 4
/
∏∏5 6
pageSize
∏∏7 ?
;
∏∏? @
if
∫∫ 
(
∫∫ 
	totalRows
∫∫ 
<=
∫∫ 
pageSize
∫∫ %
)
∫∫% &
{
ªª 

totalPages
ºº 
=
ºº 
$num
ºº 
;
ºº 
}
ΩΩ 
else
ææ 
{
øø 
int
¿¿ 
	remainder
¿¿ 
;
¿¿ 
Math
¡¡ 
.
¡¡ 
DivRem
¡¡ 
(
¡¡ 
	totalRows
¡¡ %
,
¡¡% &
pageSize
¡¡' /
,
¡¡/ 0
out
¡¡1 4
	remainder
¡¡5 >
)
¡¡> ?
;
¡¡? @
if
¬¬ 
(
¬¬ 
	remainder
¬¬ 
>
¬¬ 
$num
¬¬  !
)
¬¬! "
{
√√ 

totalPages
ƒƒ 
+=
ƒƒ !
$num
ƒƒ" #
;
ƒƒ# $
}
≈≈ 
}
∆∆  
SqlParameterHelper
»» 
sph
»» "
=
»»# $
new
»»% ( 
SqlParameterHelper
»») ;
(
»»; <
ConnectionString
»»< L
.
»»L M%
GetReadConnectionString
»»M d
(
»»d e
)
»»e f
,
»»f g
$str»»h é
,»»é è
$num»»ê ë
)»»ë í
;»»í ì
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# .
,
……. /
	SqlDbType
……0 9
.
……9 :
UniqueIdentifier
……: J
,
……J K 
ParameterDirection
……L ^
.
……^ _
Input
……_ d
,
……d e
siteGuid
……f n
)
……n o
;
……o p
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 0
,
  0 1
	SqlDbType
  2 ;
.
  ; <
Int
  < ?
,
  ? @ 
ParameterDirection
  A S
.
  S T
Input
  T Y
,
  Y Z

pageNumber
  [ e
)
  e f
;
  f g
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# .
,
ÀÀ. /
	SqlDbType
ÀÀ0 9
.
ÀÀ9 :
Int
ÀÀ: =
,
ÀÀ= > 
ParameterDirection
ÀÀ? Q
.
ÀÀQ R
Input
ÀÀR W
,
ÀÀW X
pageSize
ÀÀY a
)
ÀÀa b
;
ÀÀb c
return
ÃÃ 
sph
ÃÃ 
.
ÃÃ 
ExecuteReader
ÃÃ $
(
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ŒŒ 	
public
ÓÓ 
static
ÓÓ 
int
ÓÓ 
CreateOrder
ÓÓ %
(
ÓÓ% &
Guid
ÔÔ 
rowGuid
ÔÔ 
,
ÔÔ 
Guid
 
siteGuid
 
,
 
Guid
ÒÒ 
featureGuid
ÒÒ 
,
ÒÒ 
Guid
ÚÚ 

moduleGuid
ÚÚ 
,
ÚÚ 
Guid
ÛÛ 
userGuid
ÛÛ 
,
ÛÛ 
Guid
ÙÙ 
	orderGuid
ÙÙ 
,
ÙÙ 
string
ıı 
billingFirstName
ıı #
,
ıı# $
string
ˆˆ 
billingLastName
ˆˆ "
,
ˆˆ" #
string
˜˜ 
billingCompany
˜˜ !
,
˜˜! "
string
¯¯ 
billingAddress1
¯¯ "
,
¯¯" #
string
˘˘ 
billingAddress2
˘˘ "
,
˘˘" #
string
˙˙ 
billingSuburb
˙˙  
,
˙˙  !
string
˚˚ 
billingCity
˚˚ 
,
˚˚ 
string
¸¸ 
billingPostalCode
¸¸ $
,
¸¸$ %
string
˝˝ 
billingState
˝˝ 
,
˝˝  
string
˛˛ 
billingCountry
˛˛ !
,
˛˛! "
string
ˇˇ 
paymentMethod
ˇˇ  
,
ˇˇ  !
decimal
ÄÄ 
subTotal
ÄÄ 
,
ÄÄ 
decimal
ÅÅ 
taxTotal
ÅÅ 
,
ÅÅ 
decimal
ÇÇ 
shippingTotal
ÇÇ !
,
ÇÇ! "
decimal
ÉÉ 

orderTotal
ÉÉ 
,
ÉÉ 
DateTime
ÑÑ 
orderDateUtc
ÑÑ !
,
ÑÑ! "
string
ÖÖ 
adminOrderLink
ÖÖ !
,
ÖÖ! "
string
ÜÜ 
userOrderLink
ÜÜ  
,
ÜÜ  !
DateTime
áá 
rowCreatedUtc
áá "
,
áá" #
bool
àà  
includeInAggregate
àà #
)
àà# $
{
ââ 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M&
GetWriteConnectionString
ääM e
(
ääe f
)
ääf g
,
ääg h
$strääi â
,ääâ ä
$numääã ç
)ääç é
;ääé è
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# -
,
ãã- .
	SqlDbType
ãã/ 8
.
ãã8 9
UniqueIdentifier
ãã9 I
,
ããI J 
ParameterDirection
ããK ]
.
ãã] ^
Input
ãã^ c
,
ããc d
rowGuid
ããe l
)
ããl m
;
ããm n
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# .
,
åå. /
	SqlDbType
åå0 9
.
åå9 :
UniqueIdentifier
åå: J
,
ååJ K 
ParameterDirection
ååL ^
.
åå^ _
Input
åå_ d
,
ååd e
siteGuid
ååf n
)
åån o
;
ååo p
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 1
,
çç1 2
	SqlDbType
çç3 <
.
çç< =
UniqueIdentifier
çç= M
,
ççM N 
ParameterDirection
ççO a
.
çça b
Input
ççb g
,
ççg h
featureGuid
ççi t
)
ççt u
;
ççu v
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 0
,
éé0 1
	SqlDbType
éé2 ;
.
éé; <
UniqueIdentifier
éé< L
,
ééL M 
ParameterDirection
ééN `
.
éé` a
Input
ééa f
,
ééf g

moduleGuid
ééh r
)
éér s
;
éés t
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# .
,
èè. /
	SqlDbType
èè0 9
.
èè9 :
UniqueIdentifier
èè: J
,
èèJ K 
ParameterDirection
èèL ^
.
èè^ _
Input
èè_ d
,
èèd e
userGuid
èèf n
)
èèn o
;
èèo p
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# /
,
êê/ 0
	SqlDbType
êê1 :
.
êê: ;
UniqueIdentifier
êê; K
,
êêK L 
ParameterDirection
êêM _
.
êê_ `
Input
êê` e
,
êêe f
	orderGuid
êêg p
)
êêp q
;
êêq r
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 6
,
ëë6 7
	SqlDbType
ëë8 A
.
ëëA B
NVarChar
ëëB J
,
ëëJ K
$num
ëëL O
,
ëëO P 
ParameterDirection
ëëQ c
.
ëëc d
Input
ëëd i
,
ëëi j
billingFirstName
ëëk {
)
ëë{ |
;
ëë| }
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# 5
,
íí5 6
	SqlDbType
íí7 @
.
íí@ A
NVarChar
ííA I
,
ííI J
$num
ííK M
,
ííM N 
ParameterDirection
ííO a
.
íía b
Input
ííb g
,
ííg h
billingLastName
ííi x
)
ííx y
;
ííy z
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# 4
,
ìì4 5
	SqlDbType
ìì6 ?
.
ìì? @
NVarChar
ìì@ H
,
ììH I
$num
ììJ M
,
ììM N 
ParameterDirection
ììO a
.
ììa b
Input
ììb g
,
ììg h
billingCompany
ììi w
)
ììw x
;
ììx y
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 5
,
îî5 6
	SqlDbType
îî7 @
.
îî@ A
NVarChar
îîA I
,
îîI J
$num
îîK N
,
îîN O 
ParameterDirection
îîP b
.
îîb c
Input
îîc h
,
îîh i
billingAddress1
îîj y
)
îîy z
;
îîz {
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 5
,
ïï5 6
	SqlDbType
ïï7 @
.
ïï@ A
NVarChar
ïïA I
,
ïïI J
$num
ïïK N
,
ïïN O 
ParameterDirection
ïïP b
.
ïïb c
Input
ïïc h
,
ïïh i
billingAddress2
ïïj y
)
ïïy z
;
ïïz {
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 3
,
ññ3 4
	SqlDbType
ññ5 >
.
ññ> ?
NVarChar
ññ? G
,
ññG H
$num
ññI L
,
ññL M 
ParameterDirection
ññN `
.
ññ` a
Input
ñña f
,
ññf g
billingSuburb
ññh u
)
ññu v
;
ññv w
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# 1
,
óó1 2
	SqlDbType
óó3 <
.
óó< =
NVarChar
óó= E
,
óóE F
$num
óóG J
,
óóJ K 
ParameterDirection
óóL ^
.
óó^ _
Input
óó_ d
,
óód e
billingCity
óóf q
)
óóq r
;
óór s
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 7
,
òò7 8
	SqlDbType
òò9 B
.
òòB C
NVarChar
òòC K
,
òòK L
$num
òòM O
,
òòO P 
ParameterDirection
òòQ c
.
òòc d
Input
òòd i
,
òòi j
billingPostalCode
òòk |
)
òò| }
;
òò} ~
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# 2
,
ôô2 3
	SqlDbType
ôô4 =
.
ôô= >
NVarChar
ôô> F
,
ôôF G
$num
ôôH K
,
ôôK L 
ParameterDirection
ôôM _
.
ôô_ `
Input
ôô` e
,
ôôe f
billingState
ôôg s
)
ôôs t
;
ôôt u
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 4
,
öö4 5
	SqlDbType
öö6 ?
.
öö? @
NVarChar
öö@ H
,
ööH I
$num
ööJ M
,
ööM N 
ParameterDirection
ööO a
.
ööa b
Input
ööb g
,
öög h
billingCountry
ööi w
)
ööw x
;
ööx y
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 3
,
õõ3 4
	SqlDbType
õõ5 >
.
õõ> ?
NVarChar
õõ? G
,
õõG H
$num
õõI K
,
õõK L 
ParameterDirection
õõM _
.
õõ_ `
Input
õõ` e
,
õõe f
paymentMethod
õõg t
)
õõt u
;
õõu v
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# .
,
úú. /
	SqlDbType
úú0 9
.
úú9 :
Decimal
úú: A
,
úúA B 
ParameterDirection
úúC U
.
úúU V
Input
úúV [
,
úú[ \
subTotal
úú] e
)
úúe f
;
úúf g
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
Decimal
ùù: A
,
ùùA B 
ParameterDirection
ùùC U
.
ùùU V
Input
ùùV [
,
ùù[ \
taxTotal
ùù] e
)
ùùe f
;
ùùf g
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 3
,
ûû3 4
	SqlDbType
ûû5 >
.
ûû> ?
Decimal
ûû? F
,
ûûF G 
ParameterDirection
ûûH Z
.
ûûZ [
Input
ûû[ `
,
ûû` a
shippingTotal
ûûb o
)
ûûo p
;
ûûp q
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 0
,
üü0 1
	SqlDbType
üü2 ;
.
üü; <
Decimal
üü< C
,
üüC D 
ParameterDirection
üüE W
.
üüW X
Input
üüX ]
,
üü] ^

orderTotal
üü_ i
)
üüi j
;
üüj k
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# 2
,
††2 3
	SqlDbType
††4 =
.
††= >
DateTime
††> F
,
††F G 
ParameterDirection
††H Z
.
††Z [
Input
††[ `
,
††` a
orderDateUtc
††b n
)
††n o
;
††o p
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 4
,
°°4 5
	SqlDbType
°°6 ?
.
°°? @
NVarChar
°°@ H
,
°°H I
$num
°°J M
,
°°M N 
ParameterDirection
°°O a
.
°°a b
Input
°°b g
,
°°g h
adminOrderLink
°°i w
)
°°w x
;
°°x y
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 3
,
¢¢3 4
	SqlDbType
¢¢5 >
.
¢¢> ?
NVarChar
¢¢? G
,
¢¢G H
$num
¢¢I L
,
¢¢L M 
ParameterDirection
¢¢N `
.
¢¢` a
Input
¢¢a f
,
¢¢f g
userOrderLink
¢¢h u
)
¢¢u v
;
¢¢v w
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 3
,
££3 4
	SqlDbType
££5 >
.
££> ?
DateTime
££? G
,
££G H 
ParameterDirection
££I [
.
££[ \
Input
££\ a
,
££a b
rowCreatedUtc
££c p
)
££p q
;
££q r
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 8
,
§§8 9
	SqlDbType
§§: C
.
§§C D
Bit
§§D G
,
§§G H 
ParameterDirection
§§I [
.
§§[ \
Input
§§\ a
,
§§a b 
includeInAggregate
§§c u
)
§§u v
;
§§v w
int
•• 
rowsAffected
•• 
=
•• 
sph
•• "
.
••" #
ExecuteNonQuery
••# 2
(
••2 3
)
••3 4
;
••4 5
return
¶¶ 
rowsAffected
¶¶ 
;
¶¶  
}
®® 	
public
ØØ 
static
ØØ 
bool
ØØ 
DeleteOrder
ØØ &
(
ØØ& '
Guid
ØØ' +
rowGuid
ØØ, 3
)
ØØ3 4
{
∞∞ 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M&
GetWriteConnectionString
±±M e
(
±±e f
)
±±f g
,
±±g h
$str±±i â
,±±â ä
$num±±ã å
)±±å ç
;±±ç é
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# -
,
≤≤- .
	SqlDbType
≤≤/ 8
.
≤≤8 9
UniqueIdentifier
≤≤9 I
,
≤≤I J 
ParameterDirection
≤≤K ]
.
≤≤] ^
Input
≤≤^ c
,
≤≤c d
rowGuid
≤≤e l
)
≤≤l m
;
≤≤m n
int
≥≥ 
rowsAffected
≥≥ 
=
≥≥ 
sph
≥≥ "
.
≥≥" #
ExecuteNonQuery
≥≥# 2
(
≥≥2 3
)
≥≥3 4
;
≥≥4 5
return
¥¥ 
(
¥¥ 
rowsAffected
¥¥  
>
¥¥! "
$num
¥¥# $
)
¥¥$ %
;
¥¥% &
}
∂∂ 	
public
ΩΩ 
static
ΩΩ 
bool
ΩΩ  
DeleteOrdersBySite
ΩΩ -
(
ΩΩ- .
Guid
ΩΩ. 2
siteGuid
ΩΩ3 ;
)
ΩΩ; <
{
ææ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M&
GetWriteConnectionString
øøM e
(
øøe f
)
øøf g
,
øøg h
$strøøi è
,øøè ê
$numøøë í
)øøí ì
;øøì î
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# .
,
¿¿. /
	SqlDbType
¿¿0 9
.
¿¿9 :
UniqueIdentifier
¿¿: J
,
¿¿J K 
ParameterDirection
¿¿L ^
.
¿¿^ _
Input
¿¿_ d
,
¿¿d e
siteGuid
¿¿f n
)
¿¿n o
;
¿¿o p
int
¡¡ 
rowsAffected
¡¡ 
=
¡¡ 
sph
¡¡ "
.
¡¡" #
ExecuteNonQuery
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
$num
¬¬# $
)
¬¬$ %
;
¬¬% &
}
ƒƒ 	
public
ÃÃ 
static
ÃÃ 
bool
ÃÃ "
DeleteOrdersByModule
ÃÃ /
(
ÃÃ/ 0
Guid
ÃÃ0 4

moduleGuid
ÃÃ5 ?
)
ÃÃ? @
{
ÕÕ 	 
SqlParameterHelper
ŒŒ 
sph
ŒŒ "
=
ŒŒ# $
new
ŒŒ% ( 
SqlParameterHelper
ŒŒ) ;
(
ŒŒ; <
ConnectionString
ŒŒ< L
.
ŒŒL M&
GetWriteConnectionString
ŒŒM e
(
ŒŒe f
)
ŒŒf g
,
ŒŒg h
$strŒŒi ë
,ŒŒë í
$numŒŒì î
)ŒŒî ï
;ŒŒï ñ
sph
œœ 
.
œœ  
DefineSqlParameter
œœ "
(
œœ" #
$str
œœ# 0
,
œœ0 1
	SqlDbType
œœ2 ;
.
œœ; <
UniqueIdentifier
œœ< L
,
œœL M 
ParameterDirection
œœN `
.
œœ` a
Input
œœa f
,
œœf g

moduleGuid
œœh r
)
œœr s
;
œœs t
int
–– 
rowsAffected
–– 
=
–– 
sph
–– "
.
––" #
ExecuteNonQuery
––# 2
(
––2 3
)
––3 4
;
––4 5
return
—— 
(
—— 
rowsAffected
——  
>
——! "
$num
——# $
)
——$ %
;
——% &
}
”” 	
public
⁄⁄ 
static
⁄⁄ 
bool
⁄⁄ !
DeleteOrdersByOrder
⁄⁄ .
(
⁄⁄. /
Guid
⁄⁄/ 3
	orderGuid
⁄⁄4 =
)
⁄⁄= >
{
€€ 	 
SqlParameterHelper
‹‹ 
sph
‹‹ "
=
‹‹# $
new
‹‹% ( 
SqlParameterHelper
‹‹) ;
(
‹‹; <
ConnectionString
‹‹< L
.
‹‹L M&
GetWriteConnectionString
‹‹M e
(
‹‹e f
)
‹‹f g
,
‹‹g h
$str‹‹i ê
,‹‹ê ë
$num‹‹í ì
)‹‹ì î
;‹‹î ï
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# /
,
››/ 0
	SqlDbType
››1 :
.
››: ;
UniqueIdentifier
››; K
,
››K L 
ParameterDirection
››M _
.
››_ `
Input
››` e
,
››e f
	orderGuid
››g p
)
››p q
;
››q r
int
ﬁﬁ 
rowsAffected
ﬁﬁ 
=
ﬁﬁ 
sph
ﬁﬁ "
.
ﬁﬁ" #
ExecuteNonQuery
ﬁﬁ# 2
(
ﬁﬁ2 3
)
ﬁﬁ3 4
;
ﬁﬁ4 5
return
ﬂﬂ 
(
ﬂﬂ 
rowsAffected
ﬂﬂ  
>
ﬂﬂ! "
$num
ﬂﬂ# $
)
ﬂﬂ$ %
;
ﬂﬂ% &
}
·· 	
public
ËË 
static
ËË 
bool
ËË #
DeleteOrdersByFeature
ËË 0
(
ËË0 1
Guid
ËË1 5
featureGuid
ËË6 A
)
ËËA B
{
ÈÈ 	 
SqlParameterHelper
ÍÍ 
sph
ÍÍ "
=
ÍÍ# $
new
ÍÍ% ( 
SqlParameterHelper
ÍÍ) ;
(
ÍÍ; <
ConnectionString
ÍÍ< L
.
ÍÍL M&
GetWriteConnectionString
ÍÍM e
(
ÍÍe f
)
ÍÍf g
,
ÍÍg h
$strÍÍi í
,ÍÍí ì
$numÍÍî ï
)ÍÍï ñ
;ÍÍñ ó
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 1
,
ÎÎ1 2
	SqlDbType
ÎÎ3 <
.
ÎÎ< =
UniqueIdentifier
ÎÎ= M
,
ÎÎM N 
ParameterDirection
ÎÎO a
.
ÎÎa b
Input
ÎÎb g
,
ÎÎg h
featureGuid
ÎÎi t
)
ÎÎt u
;
ÎÎu v
int
ÏÏ 
rowsAffected
ÏÏ 
=
ÏÏ 
sph
ÏÏ "
.
ÏÏ" #
ExecuteNonQuery
ÏÏ# 2
(
ÏÏ2 3
)
ÏÏ3 4
;
ÏÏ4 5
return
ÌÌ 
(
ÌÌ 
rowsAffected
ÌÌ  
>
ÌÌ! "
$num
ÌÌ# $
)
ÌÌ$ %
;
ÌÌ% &
}
ÔÔ 	
public
ˆˆ 
static
ˆˆ 
bool
ˆˆ  
DeleteOrdersByUser
ˆˆ -
(
ˆˆ- .
Guid
ˆˆ. 2
userGuid
ˆˆ3 ;
)
ˆˆ; <
{
˜˜ 	 
SqlParameterHelper
¯¯ 
sph
¯¯ "
=
¯¯# $
new
¯¯% ( 
SqlParameterHelper
¯¯) ;
(
¯¯; <
ConnectionString
¯¯< L
.
¯¯L M&
GetWriteConnectionString
¯¯M e
(
¯¯e f
)
¯¯f g
,
¯¯g h
$str¯¯i è
,¯¯è ê
$num¯¯ë í
)¯¯í ì
;¯¯ì î
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# .
,
˘˘. /
	SqlDbType
˘˘0 9
.
˘˘9 :
UniqueIdentifier
˘˘: J
,
˘˘J K 
ParameterDirection
˘˘L ^
.
˘˘^ _
Input
˘˘_ d
,
˘˘d e
userGuid
˘˘f n
)
˘˘n o
;
˘˘o p
int
˙˙ 
rowsAffected
˙˙ 
=
˙˙ 
sph
˙˙ "
.
˙˙" #
ExecuteNonQuery
˙˙# 2
(
˙˙2 3
)
˙˙3 4
;
˙˙4 5
return
˚˚ 
(
˚˚ 
rowsAffected
˚˚  
>
˚˚! "
$num
˚˚# $
)
˚˚$ %
;
˚˚% &
}
˝˝ 	
public
ˇˇ 
static
ˇˇ 
bool
ˇˇ 
	MoveOrder
ˇˇ $
(
ˇˇ$ %
Guid
ÄÄ 
	orderGuid
ÄÄ 
,
ÄÄ 
Guid
ÅÅ 
newUserGuid
ÅÅ 
)
ÅÅ 
{
ÇÇ 	 
SqlParameterHelper
ÉÉ 
sph
ÉÉ "
=
ÉÉ# $
new
ÉÉ% ( 
SqlParameterHelper
ÉÉ) ;
(
ÉÉ; <
ConnectionString
ÉÉ< L
.
ÉÉL M&
GetWriteConnectionString
ÉÉM e
(
ÉÉe f
)
ÉÉf g
,
ÉÉg h
$strÉÉi Ü
,ÉÉÜ á
$numÉÉà â
)ÉÉâ ä
;ÉÉä ã
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# /
,
ÑÑ/ 0
	SqlDbType
ÑÑ1 :
.
ÑÑ: ;
UniqueIdentifier
ÑÑ; K
,
ÑÑK L 
ParameterDirection
ÑÑM _
.
ÑÑ_ `
Input
ÑÑ` e
,
ÑÑe f
	orderGuid
ÑÑg p
)
ÑÑp q
;
ÑÑq r
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# .
,
ÖÖ. /
	SqlDbType
ÖÖ0 9
.
ÖÖ9 :
UniqueIdentifier
ÖÖ: J
,
ÖÖJ K 
ParameterDirection
ÖÖL ^
.
ÖÖ^ _
Input
ÖÖ_ d
,
ÖÖd e
newUserGuid
ÖÖf q
)
ÖÖq r
;
ÖÖr s
int
ÜÜ 
rowsAffected
ÜÜ 
=
ÜÜ 
sph
ÜÜ "
.
ÜÜ" #
ExecuteNonQuery
ÜÜ# 2
(
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5
sph
àà 
=
àà 
new
àà  
SqlParameterHelper
àà (
(
àà( )
ConnectionString
àà) 9
.
àà9 :&
GetWriteConnectionString
àà: R
(
ààR S
)
ààS T
,
ààT U
$str
ààV y
,
àày z
$num
àà{ |
)
àà| }
;
àà} ~
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# /
,
ââ/ 0
	SqlDbType
ââ1 :
.
ââ: ;
UniqueIdentifier
ââ; K
,
ââK L 
ParameterDirection
ââM _
.
ââ_ `
Input
ââ` e
,
ââe f
	orderGuid
ââg p
)
ââp q
;
ââq r
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
UniqueIdentifier
ää: J
,
ääJ K 
ParameterDirection
ääL ^
.
ää^ _
Input
ää_ d
,
ääd e
newUserGuid
ääf q
)
ääq r
;
äär s
sph
ãã 
.
ãã 
ExecuteNonQuery
ãã 
(
ãã  
)
ãã  !
;
ãã! "
return
çç 
(
çç 
rowsAffected
çç  
>
çç! "
$num
çç# $
)
çç$ %
;
çç% &
}
èè 	
}
ëë 
}íí ˛j
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentHistory.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentHistory (
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 
siteGuidDD 
,DD 
GuidEE 
userGuidEE 
,EE 
GuidFF 
contentGuidFF 
,FF 
stringGG 
titleGG 
,GG 
stringHH 
contentTextHH 
,HH 
stringII 

customDataII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
DateTimeKK 

historyUtcKK 
)KK  
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi É
,
MMÉ Ñ
$num
MMÖ Ü
)
MMÜ á
;
MMá à
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
userGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
contentGuidQQi t
)QQt u
;QQu v
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# +
,RR+ ,
	SqlDbTypeRR- 6
.RR6 7
NVarCharRR7 ?
,RR? @
$numRRA D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _
titleRR` e
)RRe f
;RRf g
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 1
,SS1 2
	SqlDbTypeSS3 <
.SS< =
NVarCharSS= E
,SSE F
-SSG H
$numSSH I
,SSI J
ParameterDirectionSSK ]
.SS] ^
InputSS^ c
,SSc d
contentTextSSe p
)SSp q
;SSq r
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 0
,TT0 1
	SqlDbTypeTT2 ;
.TT; <
NVarCharTT< D
,TTD E
-TTF G
$numTTG H
,TTH I
ParameterDirectionTTJ \
.TT\ ]
InputTT] b
,TTb c

customDataTTd n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

historyUtcVV` j
)VVj k
;VVk l
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
rowsAffectedXX 
;XX  
}ZZ 	
publicdd 
staticdd 
booldd 
Deletedd !
(dd! "
Guiddd" &
guiddd' +
)dd+ ,
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M$
GetWriteConnectionStringffM e
(ffe f
)fff g
,ffg h
$str	ffi É
,
ffÉ Ñ
$num
ffÖ Ü
)
ffÜ á
;
ffá à
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# *
,gg* +
	SqlDbTypegg, 5
.gg5 6
UniqueIdentifiergg6 F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
guidggb f
)ggf g
;ggg h
inthh 
rowsAffectedhh 
=hh 
sphhh "
.hh" #
ExecuteNonQueryhh# 2
(hh2 3
)hh3 4
;hh4 5
returnii 
(ii 
rowsAffectedii  
>ii! "
$numii# $
)ii$ %
;ii% &
}kk 	
publicrr 
staticrr 
boolrr 
DeleteBySiterr '
(rr' (
Guidrr( ,
siteGuidrr- 5
)rr5 6
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M$
GetWriteConnectionStringttM e
(tte f
)ttf g
,ttg h
$str	tti â
,
ttâ ä
$num
ttã å
)
ttå ç
;
ttç é
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
UniqueIdentifieruu: J
,uuJ K
ParameterDirectionuuL ^
.uu^ _
Inputuu_ d
,uud e
siteGuiduuf n
)uun o
;uuo p
intvv 
rowsAffectedvv 
=vv 
sphvv "
.vv" #
ExecuteNonQueryvv# 2
(vv2 3
)vv3 4
;vv4 5
returnww 
(ww 
rowsAffectedww  
>ww! "
$numww# $
)ww$ %
;ww% &
}yy 	
public
ÄÄ 
static
ÄÄ 
bool
ÄÄ 
DeleteByContent
ÄÄ *
(
ÄÄ* +
Guid
ÄÄ+ /
contentGuid
ÄÄ0 ;
)
ÄÄ; <
{
ÅÅ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M&
GetWriteConnectionString
ÇÇM e
(
ÇÇe f
)
ÇÇf g
,
ÇÇg h
$strÇÇi å
,ÇÇå ç
$numÇÇé è
)ÇÇè ê
;ÇÇê ë
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 1
,
ÉÉ1 2
	SqlDbType
ÉÉ3 <
.
ÉÉ< =
UniqueIdentifier
ÉÉ= M
,
ÉÉM N 
ParameterDirection
ÉÉO a
.
ÉÉa b
Input
ÉÉb g
,
ÉÉg h
contentGuid
ÉÉi t
)
ÉÉt u
;
ÉÉu v
int
ÑÑ 
rowsAffected
ÑÑ 
=
ÑÑ 
sph
ÑÑ "
.
ÑÑ" #
ExecuteNonQuery
ÑÑ# 2
(
ÑÑ2 3
)
ÑÑ3 4
;
ÑÑ4 5
return
ÖÖ 
(
ÖÖ 
rowsAffected
ÖÖ  
>
ÖÖ! "
$num
ÖÖ# $
)
ÖÖ$ %
;
ÖÖ% &
}
áá 	
public
çç 
static
çç 
IDataReader
çç !
GetOne
çç" (
(
çç( )
Guid
çç) -
guid
çç. 2
)
çç2 3
{
éé 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh Ö
,èèÖ Ü
$numèèá à
)èèà â
;èèâ ä
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# *
,
êê* +
	SqlDbType
êê, 5
.
êê5 6
UniqueIdentifier
êê6 F
,
êêF G 
ParameterDirection
êêH Z
.
êêZ [
Input
êê[ `
,
êê` a
guid
êêb f
)
êêf g
;
êêg h
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
ìì 	
public
§§ 
static
§§ 
int
§§ 
GetCount
§§ "
(
§§" #
Guid
§§# '
contentGuid
§§( 3
)
§§3 4
{
•• 	 
SqlParameterHelper
¶¶ 
sph
¶¶ "
=
¶¶# $
new
¶¶% ( 
SqlParameterHelper
¶¶) ;
(
¶¶; <
ConnectionString
¶¶< L
.
¶¶L M%
GetReadConnectionString
¶¶M d
(
¶¶d e
)
¶¶e f
,
¶¶f g
$str¶¶h Ñ
,¶¶Ñ Ö
$num¶¶Ü á
)¶¶á à
;¶¶à â
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 1
,
ßß1 2
	SqlDbType
ßß3 <
.
ßß< =
UniqueIdentifier
ßß= M
,
ßßM N 
ParameterDirection
ßßO a
.
ßßa b
Input
ßßb g
,
ßßg h
contentGuid
ßßi t
)
ßßt u
;
ßßu v
return
©© 
Convert
©© 
.
©© 
ToInt32
©© "
(
©©" #
sph
©©# &
.
©©& '
ExecuteScalar
©©' 4
(
©©4 5
)
©©5 6
)
©©6 7
;
©©7 8
}
´´ 	
public
µµ 
static
µµ 
IDataReader
µµ !
GetPage
µµ" )
(
µµ) *
Guid
∂∂ 
contentGuid
∂∂ 
,
∂∂ 
int
∑∑ 

pageNumber
∑∑ 
,
∑∑ 
int
∏∏ 
pageSize
∏∏ 
,
∏∏ 
out
ππ 
int
ππ 

totalPages
ππ 
)
ππ 
{
∫∫ 	

totalPages
ªª 
=
ªª 
$num
ªª 
;
ªª 
int
ºº 
	totalRows
ºº 
=
ºº 
GetCount
ºº $
(
ºº$ %
contentGuid
ºº% 0
)
ºº0 1
;
ºº1 2
if
ææ 
(
ææ 
pageSize
ææ 
>
ææ 
$num
ææ 
)
ææ 

totalPages
ææ (
=
ææ) *
	totalRows
ææ+ 4
/
ææ5 6
pageSize
ææ7 ?
;
ææ? @
if
¿¿ 
(
¿¿ 
	totalRows
¿¿ 
<=
¿¿ 
pageSize
¿¿ %
)
¿¿% &
{
¡¡ 

totalPages
¬¬ 
=
¬¬ 
$num
¬¬ 
;
¬¬ 
}
√√ 
else
ƒƒ 
{
≈≈ 
int
∆∆ 
	remainder
∆∆ 
;
∆∆ 
Math
«« 
.
«« 
DivRem
«« 
(
«« 
	totalRows
«« %
,
««% &
pageSize
««' /
,
««/ 0
out
««1 4
	remainder
««5 >
)
««> ?
;
««? @
if
»» 
(
»» 
	remainder
»» 
>
»» 
$num
»»  !
)
»»! "
{
…… 

totalPages
   
+=
   !
$num
  " #
;
  # $
}
ÀÀ 
}
ÃÃ  
SqlParameterHelper
ŒŒ 
sph
ŒŒ "
=
ŒŒ# $
new
ŒŒ% ( 
SqlParameterHelper
ŒŒ) ;
(
ŒŒ; <
ConnectionString
ŒŒ< L
.
ŒŒL M%
GetReadConnectionString
ŒŒM d
(
ŒŒd e
)
ŒŒe f
,
ŒŒf g
$strŒŒh Ü
,ŒŒÜ á
$numŒŒà â
)ŒŒâ ä
;ŒŒä ã
sph
œœ 
.
œœ  
DefineSqlParameter
œœ "
(
œœ" #
$str
œœ# 1
,
œœ1 2
	SqlDbType
œœ3 <
.
œœ< =
UniqueIdentifier
œœ= M
,
œœM N 
ParameterDirection
œœO a
.
œœa b
Input
œœb g
,
œœg h
contentGuid
œœi t
)
œœt u
;
œœu v
sph
–– 
.
––  
DefineSqlParameter
–– "
(
––" #
$str
––# 0
,
––0 1
	SqlDbType
––2 ;
.
––; <
Int
––< ?
,
––? @ 
ParameterDirection
––A S
.
––S T
Input
––T Y
,
––Y Z

pageNumber
––[ e
)
––e f
;
––f g
sph
—— 
.
——  
DefineSqlParameter
—— "
(
——" #
$str
——# .
,
——. /
	SqlDbType
——0 9
.
——9 :
Int
——: =
,
——= > 
ParameterDirection
——? Q
.
——Q R
Input
——R W
,
——W X
pageSize
——Y a
)
——a b
;
——b c
return
““ 
sph
““ 
.
““ 
ExecuteReader
““ $
(
““$ %
)
““% &
;
““& '
}
‘‘ 	
}
÷÷ 
}ÿÿ ƒ°
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentMeta.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBContentMeta "
{ 
public 
static	 
int 
Create 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid 

moduleGuid 
, 
Guid 
contentGuid 
, 
string 	
name
 
, 
string 	
nameProperty
 
, 
string 	
scheme
 
, 
string   	
langCode  
 
,   
string!! 	
dir!!
 
,!! 
string"" 	
metaContent""
 
,"" 
string## 	
contentProperty##
 
,## 
int$$ 
sortRank$$ 
,$$ 
DateTime%% 

createdUtc%% 
,%% 
Guid&& 
	createdBy&& 
)&& 
{'' 
SqlParameterHelper(( 
sph(( 
=(( 
new(( 
SqlParameterHelper((  2
(((2 3
ConnectionString((3 C
.((C D$
GetWriteConnectionString((D \
(((\ ]
)((] ^
,((^ _
$str((` w
,((w x
$num((y {
)(({ |
;((| }
sph** 
.** 
DefineSqlParameter** 
(** 
$str** !
,**! "
	SqlDbType**# ,
.**, -
UniqueIdentifier**- =
,**= >
ParameterDirection**? Q
.**Q R
Input**R W
,**W X
guid**Y ]
)**] ^
;**^ _
sph++ 
.++ 
DefineSqlParameter++ 
(++ 
$str++ %
,++% &
	SqlDbType++' 0
.++0 1
UniqueIdentifier++1 A
,++A B
ParameterDirection++C U
.++U V
Input++V [
,++[ \
siteGuid++] e
)++e f
;++f g
sph,, 
.,, 
DefineSqlParameter,, 
(,, 
$str,, '
,,,' (
	SqlDbType,,) 2
.,,2 3
UniqueIdentifier,,3 C
,,,C D
ParameterDirection,,E W
.,,W X
Input,,X ]
,,,] ^

moduleGuid,,_ i
),,i j
;,,j k
sph-- 
.-- 
DefineSqlParameter-- 
(-- 
$str-- (
,--( )
	SqlDbType--* 3
.--3 4
UniqueIdentifier--4 D
,--D E
ParameterDirection--F X
.--X Y
Input--Y ^
,--^ _
contentGuid--` k
)--k l
;--l m
sph.. 
... 
DefineSqlParameter.. 
(.. 
$str.. !
,..! "
	SqlDbType..# ,
..., -
NVarChar..- 5
,..5 6
$num..7 :
,..: ;
ParameterDirection..< N
...N O
Input..O T
,..T U
name..V Z
)..Z [
;..[ \
sph// 
.// 
DefineSqlParameter// 
(// 
$str// )
,//) *
	SqlDbType//+ 4
.//4 5
NVarChar//5 =
,//= >
$num//? B
,//B C
ParameterDirection//D V
.//V W
Input//W \
,//\ ]
nameProperty//^ j
)//j k
;//k l
sph00 
.00 
DefineSqlParameter00 
(00 
$str00 #
,00# $
	SqlDbType00% .
.00. /
NVarChar00/ 7
,007 8
$num009 <
,00< =
ParameterDirection00> P
.00P Q
Input00Q V
,00V W
scheme00X ^
)00^ _
;00_ `
sph11 
.11 
DefineSqlParameter11 
(11 
$str11 %
,11% &
	SqlDbType11' 0
.110 1
NVarChar111 9
,119 :
$num11; =
,11= >
ParameterDirection11? Q
.11Q R
Input11R W
,11W X
langCode11Y a
)11a b
;11b c
sph22 
.22 
DefineSqlParameter22 
(22 
$str22  
,22  !
	SqlDbType22" +
.22+ ,
NVarChar22, 4
,224 5
$num226 7
,227 8
ParameterDirection229 K
.22K L
Input22L Q
,22Q R
dir22S V
)22V W
;22W X
sph33 
.33 
DefineSqlParameter33 
(33 
$str33 (
,33( )
	SqlDbType33* 3
.333 4
NVarChar334 <
,33< =
-33> ?
$num33? @
,33@ A
ParameterDirection33B T
.33T U
Input33U Z
,33Z [
metaContent33\ g
)33g h
;33h i
sph44 
.44 
DefineSqlParameter44 
(44 
$str44 ,
,44, -
	SqlDbType44. 7
.447 8
NVarChar448 @
,44@ A
$num44B E
,44E F
ParameterDirection44G Y
.44Y Z
Input44Z _
,44_ `
contentProperty44a p
)44p q
;44q r
sph55 
.55 
DefineSqlParameter55 
(55 
$str55 %
,55% &
	SqlDbType55' 0
.550 1
Int551 4
,554 5
ParameterDirection556 H
.55H I
Input55I N
,55N O
sortRank55P X
)55X Y
;55Y Z
sph66 
.66 
DefineSqlParameter66 
(66 
$str66 '
,66' (
	SqlDbType66) 2
.662 3
DateTime663 ;
,66; <
ParameterDirection66= O
.66O P
Input66P U
,66U V

createdUtc66W a
)66a b
;66b c
sph77 
.77 
DefineSqlParameter77 
(77 
$str77 &
,77& '
	SqlDbType77( 1
.771 2
UniqueIdentifier772 B
,77B C
ParameterDirection77D V
.77V W
Input77W \
,77\ ]
	createdBy77^ g
)77g h
;77h i
sph88 
.88 
DefineSqlParameter88 
(88 
$str88 '
,88' (
	SqlDbType88) 2
.882 3
DateTime883 ;
,88; <
ParameterDirection88= O
.88O P
Input88P U
,88U V

createdUtc88W a
)88a b
;88b c
sph99 
.99 
DefineSqlParameter99 
(99 
$str99 &
,99& '
	SqlDbType99( 1
.991 2
UniqueIdentifier992 B
,99B C
ParameterDirection99D V
.99V W
Input99W \
,99\ ]
	createdBy99^ g
)99g h
;99h i
int;; 
rowsAffected;; 
=;; 
sph;; 
.;; 
ExecuteNonQuery;; )
(;;) *
);;* +
;;;+ ,
return== 	
rowsAffected==
 
;== 
}>> 
publicEE 
staticEE	 
boolEE 
UpdateEE 
(EE 
GuidFF 
guidFF 
,FF 
stringGG 	
nameGG
 
,GG 
stringHH 	
namePropertyHH
 
,HH 
stringII 	
schemeII
 
,II 
stringJJ 	
langCodeJJ
 
,JJ 
stringKK 	
dirKK
 
,KK 
stringLL 	
metaContentLL
 
,LL 
stringMM 	
contentPropertyMM
 
,MM 
intNN 
sortRankNN 
,NN 
DateTimeOO 

lastModUtcOO 
,OO 
GuidPP 
	lastModByPP 
)PP 
{QQ 
SqlParameterHelperRR 
sphRR 
=RR 
newRR 
SqlParameterHelperRR  2
(RR2 3
ConnectionStringRR3 C
.RRC D$
GetWriteConnectionStringRRD \
(RR\ ]
)RR] ^
,RR^ _
$strRR` w
,RRw x
$numRRy {
)RR{ |
;RR| }
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT !
,TT! "
	SqlDbTypeTT# ,
.TT, -
UniqueIdentifierTT- =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
guidTTY ]
)TT] ^
;TT^ _
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU !
,UU! "
	SqlDbTypeUU# ,
.UU, -
NVarCharUU- 5
,UU5 6
$numUU7 :
,UU: ;
ParameterDirectionUU< N
.UUN O
InputUUO T
,UUT U
nameUUV Z
)UUZ [
;UU[ \
sphVV 
.VV 
DefineSqlParameterVV 
(VV 
$strVV )
,VV) *
	SqlDbTypeVV+ 4
.VV4 5
NVarCharVV5 =
,VV= >
$numVV? B
,VVB C
ParameterDirectionVVD V
.VVV W
InputVVW \
,VV\ ]
namePropertyVV^ j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW 
(WW 
$strWW #
,WW# $
	SqlDbTypeWW% .
.WW. /
NVarCharWW/ 7
,WW7 8
$numWW9 <
,WW< =
ParameterDirectionWW> P
.WWP Q
InputWWQ V
,WWV W
schemeWWX ^
)WW^ _
;WW_ `
sphXX 
.XX 
DefineSqlParameterXX 
(XX 
$strXX %
,XX% &
	SqlDbTypeXX' 0
.XX0 1
NVarCharXX1 9
,XX9 :
$numXX; =
,XX= >
ParameterDirectionXX? Q
.XXQ R
InputXXR W
,XXW X
langCodeXXY a
)XXa b
;XXb c
sphYY 
.YY 
DefineSqlParameterYY 
(YY 
$strYY  
,YY  !
	SqlDbTypeYY" +
.YY+ ,
NVarCharYY, 4
,YY4 5
$numYY6 7
,YY7 8
ParameterDirectionYY9 K
.YYK L
InputYYL Q
,YYQ R
dirYYS V
)YYV W
;YYW X
sphZZ 
.ZZ 
DefineSqlParameterZZ 
(ZZ 
$strZZ (
,ZZ( )
	SqlDbTypeZZ* 3
.ZZ3 4
NVarCharZZ4 <
,ZZ< =
-ZZ> ?
$numZZ? @
,ZZ@ A
ParameterDirectionZZB T
.ZZT U
InputZZU Z
,ZZZ [
metaContentZZ\ g
)ZZg h
;ZZh i
sph[[ 
.[[ 
DefineSqlParameter[[ 
([[ 
$str[[ ,
,[[, -
	SqlDbType[[. 7
.[[7 8
NVarChar[[8 @
,[[@ A
$num[[B E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
contentProperty[[a p
)[[p q
;[[q r
sph\\ 
.\\ 
DefineSqlParameter\\ 
(\\ 
$str\\ %
,\\% &
	SqlDbType\\' 0
.\\0 1
Int\\1 4
,\\4 5
ParameterDirection\\6 H
.\\H I
Input\\I N
,\\N O
sortRank\\P X
)\\X Y
;\\Y Z
sph]] 
.]] 
DefineSqlParameter]] 
(]] 
$str]] '
,]]' (
	SqlDbType]]) 2
.]]2 3
DateTime]]3 ;
,]]; <
ParameterDirection]]= O
.]]O P
Input]]P U
,]]U V

lastModUtc]]W a
)]]a b
;]]b c
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ &
,^^& '
	SqlDbType^^( 1
.^^1 2
UniqueIdentifier^^2 B
,^^B C
ParameterDirection^^D V
.^^V W
Input^^W \
,^^\ ]
	lastModBy^^^ g
)^^g h
;^^h i
int`` 
rowsAffected`` 
=`` 
sph`` 
.`` 
ExecuteNonQuery`` )
(``) *
)``* +
;``+ ,
returnbb 	
(bb
 
rowsAffectedbb 
>bb 
$numbb 
)bb 
;bb 
}cc 
publicjj 
staticjj	 
booljj 
Deletejj 
(jj 
Guidjj  
guidjj! %
)jj% &
{kk 
SqlParameterHelperll 
sphll 
=ll 
newll 
SqlParameterHelperll  2
(ll2 3
ConnectionStringll3 C
.llC D$
GetWriteConnectionStringllD \
(ll\ ]
)ll] ^
,ll^ _
$strll` w
,llw x
$numlly z
)llz {
;ll{ |
sphnn 
.nn 
DefineSqlParameternn 
(nn 
$strnn !
,nn! "
	SqlDbTypenn# ,
.nn, -
UniqueIdentifiernn- =
,nn= >
ParameterDirectionnn? Q
.nnQ R
InputnnR W
,nnW X
guidnnY ]
)nn] ^
;nn^ _
intpp 
rowsAffectedpp 
=pp 
sphpp 
.pp 
ExecuteNonQuerypp )
(pp) *
)pp* +
;pp+ ,
returnrr 	
(rr
 
rowsAffectedrr 
>rr 
$numrr 
)rr 
;rr 
}ss 
publiczz 
staticzz	 
boolzz 
DeleteBySitezz !
(zz! "
Guidzz" &
siteGuidzz' /
)zz/ 0
{{{ 
SqlParameterHelper|| 
sph|| 
=|| 
new|| 
SqlParameterHelper||  2
(||2 3
ConnectionString||3 C
.||C D$
GetWriteConnectionString||D \
(||\ ]
)||] ^
,||^ _
$str||` }
,||} ~
$num	|| Ä
)
||Ä Å
;
||Å Ç
sph~~ 
.~~ 
DefineSqlParameter~~ 
(~~ 
$str~~ %
,~~% &
	SqlDbType~~' 0
.~~0 1
UniqueIdentifier~~1 A
,~~A B
ParameterDirection~~C U
.~~U V
Input~~V [
,~~[ \
siteGuid~~] e
)~~e f
;~~f g
int
ÄÄ 
rowsAffected
ÄÄ 
=
ÄÄ 
sph
ÄÄ 
.
ÄÄ 
ExecuteNonQuery
ÄÄ )
(
ÄÄ) *
)
ÄÄ* +
;
ÄÄ+ ,
return
ÇÇ 	
(
ÇÇ
 
rowsAffected
ÇÇ 
>
ÇÇ 
$num
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÉÉ 
public
ää 
static
ää	 
bool
ää 
DeleteByModule
ää #
(
ää# $
Guid
ää$ (

moduleGuid
ää) 3
)
ää3 4
{
ãã  
SqlParameterHelper
åå 
sph
åå 
=
åå 
new
åå  
SqlParameterHelper
åå  2
(
åå2 3
ConnectionString
åå3 C
.
ååC D&
GetWriteConnectionString
ååD \
(
åå\ ]
)
åå] ^
,
åå^ _
$str
åå` 
,åå Ä
$numååÅ Ç
)ååÇ É
;ååÉ Ñ
sph
éé 
.
éé  
DefineSqlParameter
éé 
(
éé 
$str
éé '
,
éé' (
	SqlDbType
éé) 2
.
éé2 3
UniqueIdentifier
éé3 C
,
ééC D 
ParameterDirection
ééE W
.
ééW X
Input
ééX ]
,
éé] ^

moduleGuid
éé_ i
)
ééi j
;
ééj k
int
êê 
rowsAffected
êê 
=
êê 
sph
êê 
.
êê 
ExecuteNonQuery
êê )
(
êê) *
)
êê* +
;
êê+ ,
return
íí 	
(
íí
 
rowsAffected
íí 
>
íí 
$num
íí 
)
íí 
;
íí 
}
ìì 
public
öö 
static
öö	 
bool
öö 
DeleteByContent
öö $
(
öö$ %
Guid
öö% )
contentGuid
öö* 5
)
öö5 6
{
õõ  
SqlParameterHelper
úú 
sph
úú 
=
úú 
new
úú  
SqlParameterHelper
úú  2
(
úú2 3
ConnectionString
úú3 C
.
úúC D&
GetWriteConnectionString
úúD \
(
úú\ ]
)
úú] ^
,
úú^ _
$strúú` Ä
,úúÄ Å
$numúúÇ É
)úúÉ Ñ
;úúÑ Ö
sph
ûû 
.
ûû  
DefineSqlParameter
ûû 
(
ûû 
$str
ûû (
,
ûû( )
	SqlDbType
ûû* 3
.
ûû3 4
UniqueIdentifier
ûû4 D
,
ûûD E 
ParameterDirection
ûûF X
.
ûûX Y
Input
ûûY ^
,
ûû^ _
contentGuid
ûû` k
)
ûûk l
;
ûûl m
int
†† 
rowsAffected
†† 
=
†† 
sph
†† 
.
†† 
ExecuteNonQuery
†† )
(
††) *
)
††* +
;
††+ ,
return
¢¢ 	
(
¢¢
 
rowsAffected
¢¢ 
>
¢¢ 
$num
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
public
©© 
static
©©	 
IDataReader
©© 
GetOne
©© "
(
©©" #
Guid
©©# '
guid
©©( ,
)
©©, -
{
™™  
SqlParameterHelper
´´ 
sph
´´ 
=
´´ 
new
´´  
SqlParameterHelper
´´  2
(
´´2 3
ConnectionString
´´3 C
.
´´C D%
GetReadConnectionString
´´D [
(
´´[ \
)
´´\ ]
,
´´] ^
$str
´´_ y
,
´´y z
$num
´´{ |
)
´´| }
;
´´} ~
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ 
(
≠≠ 
$str
≠≠ !
,
≠≠! "
	SqlDbType
≠≠# ,
.
≠≠, -
UniqueIdentifier
≠≠- =
,
≠≠= > 
ParameterDirection
≠≠? Q
.
≠≠Q R
Input
≠≠R W
,
≠≠W X
guid
≠≠Y ]
)
≠≠] ^
;
≠≠^ _
return
ØØ 	
sph
ØØ
 
.
ØØ 
ExecuteReader
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
∞∞ 
public
∂∂ 
static
∂∂	 
IDataReader
∂∂ 
GetByContent
∂∂ (
(
∂∂( )
Guid
∂∂) -
contentGuid
∂∂. 9
)
∂∂9 :
{
∑∑  
SqlParameterHelper
∏∏ 
sph
∏∏ 
=
∏∏ 
new
∏∏  
SqlParameterHelper
∏∏  2
(
∏∏2 3
ConnectionString
∏∏3 C
.
∏∏C D%
GetReadConnectionString
∏∏D [
(
∏∏[ \
)
∏∏\ ]
,
∏∏] ^
$str
∏∏_ 
,∏∏ Ä
$num∏∏Å Ç
)∏∏Ç É
;∏∏É Ñ
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ 
(
∫∫ 
$str
∫∫ (
,
∫∫( )
	SqlDbType
∫∫* 3
.
∫∫3 4
UniqueIdentifier
∫∫4 D
,
∫∫D E 
ParameterDirection
∫∫F X
.
∫∫X Y
Input
∫∫Y ^
,
∫∫^ _
contentGuid
∫∫` k
)
∫∫k l
;
∫∫l m
return
ºº 	
sph
ºº
 
.
ºº 
ExecuteReader
ºº 
(
ºº 
)
ºº 
;
ºº 
}
ΩΩ 
public
ƒƒ 
static
ƒƒ	 
int
ƒƒ 
GetMaxSortRank
ƒƒ "
(
ƒƒ" #
Guid
ƒƒ# '
contentGuid
ƒƒ( 3
)
ƒƒ3 4
{
≈≈  
SqlParameterHelper
∆∆ 
sph
∆∆ 
=
∆∆ 
new
∆∆  
SqlParameterHelper
∆∆  2
(
∆∆2 3
ConnectionString
∆∆3 C
.
∆∆C D%
GetReadConnectionString
∆∆D [
(
∆∆[ \
)
∆∆\ ]
,
∆∆] ^
$str
∆∆_ 
,∆∆ Ä
$num∆∆Å Ç
)∆∆Ç É
;∆∆É Ñ
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»» (
,
»»( )
	SqlDbType
»»* 3
.
»»3 4
UniqueIdentifier
»»4 D
,
»»D E 
ParameterDirection
»»F X
.
»»X Y
Input
»»Y ^
,
»»^ _
contentGuid
»»` k
)
»»k l
;
»»l m
int
   
	pageOrder
   
=
   
Convert
   
.
   
ToInt32
   "
(
  " #
sph
  # &
.
  & '
ExecuteScalar
  ' 4
(
  4 5
)
  5 6
)
  6 7
;
  7 8
return
ÃÃ 	
	pageOrder
ÃÃ
 
;
ÃÃ 
}
ÕÕ 
}
ŒŒ 
}œœ ˇû
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentMetaLink.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentMetaLink )
{ 
publicGG 
staticGG 
intGG 
CreateGG  
(GG  !
GuidHH 
guidHH 
,HH 
GuidII 
siteGuidII 
,II 
GuidJJ 

moduleGuidJJ 
,JJ 
GuidKK 
contentGuidKK 
,KK 
stringLL 
relLL 
,LL 
stringMM 
hrefMM 
,MM 
stringNN 
hrefLangNN 
,NN 
stringOO 
revOO 
,OO 
stringPP 
typePP 
,PP 
stringQQ 
mediaQQ 
,QQ 
intRR 
sortRankRR 
,RR 
DateTimeSS 

createdUtcSS 
,SS  
GuidTT 
	createdByTT 
)TT 
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$str	VVi Ñ
,
VVÑ Ö
$num
VVÜ à
)
VVà â
;
VVâ ä
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# *
,WW* +
	SqlDbTypeWW, 5
.WW5 6
UniqueIdentifierWW6 F
,WWF G
ParameterDirectionWWH Z
.WWZ [
InputWW[ `
,WW` a
guidWWb f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
siteGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 0
,YY0 1
	SqlDbTypeYY2 ;
.YY; <
UniqueIdentifierYY< L
,YYL M
ParameterDirectionYYN `
.YY` a
InputYYa f
,YYf g

moduleGuidYYh r
)YYr s
;YYs t
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 1
,ZZ1 2
	SqlDbTypeZZ3 <
.ZZ< =
UniqueIdentifierZZ= M
,ZZM N
ParameterDirectionZZO a
.ZZa b
InputZZb g
,ZZg h
contentGuidZZi t
)ZZt u
;ZZu v
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# )
,[[) *
	SqlDbType[[+ 4
.[[4 5
NVarChar[[5 =
,[[= >
$num[[? B
,[[B C
ParameterDirection[[D V
.[[V W
Input[[W \
,[[\ ]
rel[[^ a
)[[a b
;[[b c
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# *
,\\* +
	SqlDbType\\, 5
.\\5 6
NVarChar\\6 >
,\\> ?
$num\\@ C
,\\C D
ParameterDirection\\E W
.\\W X
Input\\X ]
,\\] ^
href\\_ c
)\\c d
;\\d e
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# .
,]]. /
	SqlDbType]]0 9
.]]9 :
NVarChar]]: B
,]]B C
$num]]D F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
hrefLang]]b j
)]]j k
;]]k l
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# )
,^^) *
	SqlDbType^^+ 4
.^^4 5
NVarChar^^5 =
,^^= >
$num^^? A
,^^A B
ParameterDirection^^C U
.^^U V
Input^^V [
,^^[ \
rev^^] `
)^^` a
;^^a b
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# *
,__* +
	SqlDbType__, 5
.__5 6
NVarChar__6 >
,__> ?
$num__@ B
,__B C
ParameterDirection__D V
.__V W
Input__W \
,__\ ]
type__^ b
)__b c
;__c d
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# +
,``+ ,
	SqlDbType``- 6
.``6 7
NVarChar``7 ?
,``? @
$num``A C
,``C D
ParameterDirection``E W
.``W X
Input``X ]
,``] ^
media``_ d
)``d e
;``e f
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# .
,aa. /
	SqlDbTypeaa0 9
.aa9 :
Intaa: =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
sortRankaaY a
)aaa b
;aab c
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
DateTimebb< D
,bbD E
ParameterDirectionbbF X
.bbX Y
InputbbY ^
,bb^ _

createdUtcbb` j
)bbj k
;bbk l
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
UniqueIdentifiercc; K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
	createdByccg p
)ccp q
;ccq r
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
DateTimedd< D
,ddD E
ParameterDirectionddF X
.ddX Y
InputddY ^
,dd^ _

createdUtcdd` j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
UniqueIdentifieree; K
,eeK L
ParameterDirectioneeM _
.ee_ `
Inputee` e
,eee f
	createdByeeg p
)eep q
;eeq r
intff 
rowsAffectedff 
=ff 
sphff "
.ff" #
ExecuteNonQueryff# 2
(ff2 3
)ff3 4
;ff4 5
returngg 
rowsAffectedgg 
;gg  
}ii 	
publiczz 
staticzz 
boolzz 
Updatezz !
(zz! "
Guid{{ 
guid{{ 
,{{ 
string|| 
rel|| 
,|| 
string}} 
href}} 
,}} 
string~~ 
hrefLang~~ 
,~~ 
string 
rev 
, 
string
ÄÄ 
type
ÄÄ 
,
ÄÄ 
string
ÅÅ 
media
ÅÅ 
,
ÅÅ 
int
ÇÇ 
sortRank
ÇÇ 
,
ÇÇ 
DateTime
ÉÉ 

lastModUtc
ÉÉ 
,
ÉÉ  
Guid
ÑÑ 
	lastModBy
ÑÑ 
)
ÑÑ 
{
ÖÖ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M&
GetWriteConnectionString
ÜÜM e
(
ÜÜe f
)
ÜÜf g
,
ÜÜg h
$strÜÜi Ñ
,ÜÜÑ Ö
$numÜÜÜ à
)ÜÜà â
;ÜÜâ ä
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# *
,
áá* +
	SqlDbType
áá, 5
.
áá5 6
UniqueIdentifier
áá6 F
,
ááF G 
ParameterDirection
ááH Z
.
ááZ [
Input
áá[ `
,
áá` a
guid
ááb f
)
ááf g
;
áág h
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# )
,
àà) *
	SqlDbType
àà+ 4
.
àà4 5
NVarChar
àà5 =
,
àà= >
$num
àà? B
,
ààB C 
ParameterDirection
ààD V
.
ààV W
Input
ààW \
,
àà\ ]
rel
àà^ a
)
ààa b
;
ààb c
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# *
,
ââ* +
	SqlDbType
ââ, 5
.
ââ5 6
NVarChar
ââ6 >
,
ââ> ?
$num
ââ@ C
,
ââC D 
ParameterDirection
ââE W
.
ââW X
Input
ââX ]
,
ââ] ^
href
ââ_ c
)
ââc d
;
ââd e
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
NVarChar
ää: B
,
ääB C
$num
ääD F
,
ääF G 
ParameterDirection
ääH Z
.
ääZ [
Input
ää[ `
,
ää` a
hrefLang
ääb j
)
ääj k
;
ääk l
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# )
,
ãã) *
	SqlDbType
ãã+ 4
.
ãã4 5
NVarChar
ãã5 =
,
ãã= >
$num
ãã? A
,
ããA B 
ParameterDirection
ããC U
.
ããU V
Input
ããV [
,
ãã[ \
rev
ãã] `
)
ãã` a
;
ããa b
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# *
,
åå* +
	SqlDbType
åå, 5
.
åå5 6
NVarChar
åå6 >
,
åå> ?
$num
åå@ B
,
ååB C 
ParameterDirection
ååD V
.
ååV W
Input
ååW \
,
åå\ ]
type
åå^ b
)
ååb c
;
ååc d
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# +
,
çç+ ,
	SqlDbType
çç- 6
.
çç6 7
NVarChar
çç7 ?
,
çç? @
$num
ççA C
,
ççC D 
ParameterDirection
ççE W
.
ççW X
Input
ççX ]
,
çç] ^
media
çç_ d
)
ççd e
;
ççe f
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# .
,
éé. /
	SqlDbType
éé0 9
.
éé9 :
Int
éé: =
,
éé= > 
ParameterDirection
éé? Q
.
ééQ R
Input
ééR W
,
ééW X
sortRank
ééY a
)
ééa b
;
ééb c
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# 0
,
èè0 1
	SqlDbType
èè2 ;
.
èè; <
DateTime
èè< D
,
èèD E 
ParameterDirection
èèF X
.
èèX Y
Input
èèY ^
,
èè^ _

lastModUtc
èè` j
)
èèj k
;
èèk l
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# /
,
êê/ 0
	SqlDbType
êê1 :
.
êê: ;
UniqueIdentifier
êê; K
,
êêK L 
ParameterDirection
êêM _
.
êê_ `
Input
êê` e
,
êêe f
	lastModBy
êêg p
)
êêp q
;
êêq r
int
ëë 
rowsAffected
ëë 
=
ëë 
sph
ëë "
.
ëë" #
ExecuteNonQuery
ëë# 2
(
ëë2 3
)
ëë3 4
;
ëë4 5
return
íí 
(
íí 
rowsAffected
íí  
>
íí! "
$num
íí# $
)
íí$ %
;
íí% &
}
îî 	
public
õõ 
static
õõ 
bool
õõ 
Delete
õõ !
(
õõ! "
Guid
õõ" &
guid
õõ' +
)
õõ+ ,
{
úú 	 
SqlParameterHelper
ùù 
sph
ùù "
=
ùù# $
new
ùù% ( 
SqlParameterHelper
ùù) ;
(
ùù; <
ConnectionString
ùù< L
.
ùùL M&
GetWriteConnectionString
ùùM e
(
ùùe f
)
ùùf g
,
ùùg h
$strùùi Ñ
,ùùÑ Ö
$numùùÜ á
)ùùá à
;ùùà â
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# *
,
ûû* +
	SqlDbType
ûû, 5
.
ûû5 6
UniqueIdentifier
ûû6 F
,
ûûF G 
ParameterDirection
ûûH Z
.
ûûZ [
Input
ûû[ `
,
ûû` a
guid
ûûb f
)
ûûf g
;
ûûg h
int
üü 
rowsAffected
üü 
=
üü 
sph
üü "
.
üü" #
ExecuteNonQuery
üü# 2
(
üü2 3
)
üü3 4
;
üü4 5
return
†† 
(
†† 
rowsAffected
††  
>
††! "
$num
††# $
)
††$ %
;
††% &
}
¢¢ 	
public
©© 
static
©© 
bool
©© 
DeleteBySite
©© '
(
©©' (
Guid
©©( ,
siteGuid
©©- 5
)
©©5 6
{
™™ 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M&
GetWriteConnectionString
´´M e
(
´´e f
)
´´f g
,
´´g h
$str´´i ä
,´´ä ã
$num´´å ç
)´´ç é
;´´é è
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# .
,
¨¨. /
	SqlDbType
¨¨0 9
.
¨¨9 :
UniqueIdentifier
¨¨: J
,
¨¨J K 
ParameterDirection
¨¨L ^
.
¨¨^ _
Input
¨¨_ d
,
¨¨d e
siteGuid
¨¨f n
)
¨¨n o
;
¨¨o p
int
≠≠ 
rowsAffected
≠≠ 
=
≠≠ 
sph
≠≠ "
.
≠≠" #
ExecuteNonQuery
≠≠# 2
(
≠≠2 3
)
≠≠3 4
;
≠≠4 5
return
ÆÆ 
(
ÆÆ 
rowsAffected
ÆÆ  
>
ÆÆ! "
$num
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
}
∞∞ 	
public
∑∑ 
static
∑∑ 
bool
∑∑ 
DeleteByModule
∑∑ )
(
∑∑) *
Guid
∑∑* .

moduleGuid
∑∑/ 9
)
∑∑9 :
{
∏∏ 	 
SqlParameterHelper
ππ 
sph
ππ "
=
ππ# $
new
ππ% ( 
SqlParameterHelper
ππ) ;
(
ππ; <
ConnectionString
ππ< L
.
ππL M&
GetWriteConnectionString
ππM e
(
ππe f
)
ππf g
,
ππg h
$strππi å
,ππå ç
$numππé è
)ππè ê
;ππê ë
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# 0
,
∫∫0 1
	SqlDbType
∫∫2 ;
.
∫∫; <
UniqueIdentifier
∫∫< L
,
∫∫L M 
ParameterDirection
∫∫N `
.
∫∫` a
Input
∫∫a f
,
∫∫f g

moduleGuid
∫∫h r
)
∫∫r s
;
∫∫s t
int
ªª 
rowsAffected
ªª 
=
ªª 
sph
ªª "
.
ªª" #
ExecuteNonQuery
ªª# 2
(
ªª2 3
)
ªª3 4
;
ªª4 5
return
ºº 
(
ºº 
rowsAffected
ºº  
>
ºº! "
$num
ºº# $
)
ºº$ %
;
ºº% &
}
ææ 	
public
≈≈ 
static
≈≈ 
bool
≈≈ 
DeleteByContent
≈≈ *
(
≈≈* +
Guid
≈≈+ /
contentGuid
≈≈0 ;
)
≈≈; <
{
∆∆ 	 
SqlParameterHelper
«« 
sph
«« "
=
««# $
new
««% ( 
SqlParameterHelper
««) ;
(
««; <
ConnectionString
««< L
.
««L M&
GetWriteConnectionString
««M e
(
««e f
)
««f g
,
««g h
$str««i ç
,««ç é
$num««è ê
)««ê ë
;««ë í
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 1
,
»»1 2
	SqlDbType
»»3 <
.
»»< =
UniqueIdentifier
»»= M
,
»»M N 
ParameterDirection
»»O a
.
»»a b
Input
»»b g
,
»»g h
contentGuid
»»i t
)
»»t u
;
»»u v
int
…… 
rowsAffected
…… 
=
…… 
sph
…… "
.
……" #
ExecuteNonQuery
……# 2
(
……2 3
)
……3 4
;
……4 5
return
   
(
   
rowsAffected
    
>
  ! "
$num
  # $
)
  $ %
;
  % &
}
ÃÃ 	
public
““ 
static
““ 
IDataReader
““ !
GetOne
““" (
(
““( )
Guid
““) -
guid
““. 2
)
““2 3
{
”” 	 
SqlParameterHelper
‘‘ 
sph
‘‘ "
=
‘‘# $
new
‘‘% ( 
SqlParameterHelper
‘‘) ;
(
‘‘; <
ConnectionString
‘‘< L
.
‘‘L M%
GetReadConnectionString
‘‘M d
(
‘‘d e
)
‘‘e f
,
‘‘f g
$str‘‘h Ü
,‘‘Ü á
$num‘‘à â
)‘‘â ä
;‘‘ä ã
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# *
,
’’* +
	SqlDbType
’’, 5
.
’’5 6
UniqueIdentifier
’’6 F
,
’’F G 
ParameterDirection
’’H Z
.
’’Z [
Input
’’[ `
,
’’` a
guid
’’b f
)
’’f g
;
’’g h
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
ÿÿ 	
public
ﬁﬁ 
static
ﬁﬁ 
IDataReader
ﬁﬁ !
GetByContent
ﬁﬁ" .
(
ﬁﬁ. /
Guid
ﬁﬁ/ 3
contentGuid
ﬁﬁ4 ?
)
ﬁﬁ? @
{
ﬂﬂ 	 
SqlParameterHelper
‡‡ 
sph
‡‡ "
=
‡‡# $
new
‡‡% ( 
SqlParameterHelper
‡‡) ;
(
‡‡; <
ConnectionString
‡‡< L
.
‡‡L M%
GetReadConnectionString
‡‡M d
(
‡‡d e
)
‡‡e f
,
‡‡f g
$str‡‡h å
,‡‡å ç
$num‡‡é è
)‡‡è ê
;‡‡ê ë
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 1
,
··1 2
	SqlDbType
··3 <
.
··< =
UniqueIdentifier
··= M
,
··M N 
ParameterDirection
··O a
.
··a b
Input
··b g
,
··g h
contentGuid
··i t
)
··t u
;
··u v
return
‚‚ 
sph
‚‚ 
.
‚‚ 
ExecuteReader
‚‚ $
(
‚‚$ %
)
‚‚% &
;
‚‚& '
}
‰‰ 	
public
ÊÊ 
static
ÊÊ 
int
ÊÊ 
GetMaxSortRank
ÊÊ (
(
ÊÊ( )
Guid
ÊÊ) -
contentGuid
ÊÊ. 9
)
ÊÊ9 :
{
ÁÁ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh å
,ËËå ç
$numËËé è
)ËËè ê
;ËËê ë
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 1
,
ÈÈ1 2
	SqlDbType
ÈÈ3 <
.
ÈÈ< =
UniqueIdentifier
ÈÈ= M
,
ÈÈM N 
ParameterDirection
ÈÈO a
.
ÈÈa b
Input
ÈÈb g
,
ÈÈg h
contentGuid
ÈÈi t
)
ÈÈt u
;
ÈÈu v
return
ÍÍ 
Convert
ÍÍ 
.
ÍÍ 
ToInt32
ÍÍ "
(
ÍÍ" #
sph
ÍÍ# &
.
ÍÍ& '
ExecuteScalar
ÍÍ' 4
(
ÍÍ4 5
)
ÍÍ5 6
)
ÍÍ6 7
;
ÍÍ7 8
}
ÏÏ 	
}
ÚÚ 
}ÙÙ ñ¬
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentRating.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentRating '
{ 
public22 
static22 
int22 
Create22  
(22  !
Guid33 
rowGuid33 
,33 
Guid44 
siteGuid44 
,44 
Guid55 
contentGuid55 
,55 
Guid66 
userGuid66 
,66 
string77 
emailAddress77 
,77  
int88 
rating88 
,88 
string99 
comments99 
,99 
string:: 
	ipAddress:: 
,:: 
DateTime;; 

createdUtc;; 
);;  
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str	==i Ç
,
==Ç É
$num
==Ñ Ü
)
==Ü á
;
==á à
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># -
,>>- .
	SqlDbType>>/ 8
.>>8 9
UniqueIdentifier>>9 I
,>>I J
ParameterDirection>>K ]
.>>] ^
Input>>^ c
,>>c d
rowGuid>>e l
)>>l m
;>>m n
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# .
,??. /
	SqlDbType??0 9
.??9 :
UniqueIdentifier??: J
,??J K
ParameterDirection??L ^
.??^ _
Input??_ d
,??d e
siteGuid??f n
)??n o
;??o p
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 1
,@@1 2
	SqlDbType@@3 <
.@@< =
UniqueIdentifier@@= M
,@@M N
ParameterDirection@@O a
.@@a b
Input@@b g
,@@g h
contentGuid@@i t
)@@t u
;@@u v
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
UniqueIdentifierAA: J
,AAJ K
ParameterDirectionAAL ^
.AA^ _
InputAA_ d
,AAd e
userGuidAAf n
)AAn o
;AAo p
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 2
,BB2 3
	SqlDbTypeBB4 =
.BB= >
NVarCharBB> F
,BBF G
$numBBH K
,BBK L
ParameterDirectionBBM _
.BB_ `
InputBB` e
,BBe f
emailAddressBBg s
)BBs t
;BBt u
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# ,
,CC, -
	SqlDbTypeCC. 7
.CC7 8
IntCC8 ;
,CC; <
ParameterDirectionCC= O
.CCO P
InputCCP U
,CCU V
ratingCCW ]
)CC] ^
;CC^ _
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# .
,DD. /
	SqlDbTypeDD0 9
.DD9 :
NVarCharDD: B
,DDB C
-DDD E
$numDDE F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
commentsDDb j
)DDj k
;DDk l
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# /
,EE/ 0
	SqlDbTypeEE1 :
.EE: ;
NVarCharEE; C
,EEC D
$numEEE G
,EEG H
ParameterDirectionEEI [
.EE[ \
InputEE\ a
,EEa b
	ipAddressEEc l
)EEl m
;EEm n
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 0
,FF0 1
	SqlDbTypeFF2 ;
.FF; <
DateTimeFF< D
,FFD E
ParameterDirectionFFF X
.FFX Y
InputFFY ^
,FF^ _

createdUtcFF` j
)FFj k
;FFk l
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 0
,GG0 1
	SqlDbTypeGG2 ;
.GG; <
DateTimeGG< D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _

createdUtcGG` j
)GGj k
;GGk l
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
rowsAffectedII 
;II  
}KK 	
publicXX 
staticXX 
boolXX 
UpdateXX !
(XX! "
GuidYY 
rowGuidYY 
,YY 
stringZZ 
emailAddressZZ 
,ZZ  
int[[ 
rating[[ 
,[[ 
string\\ 
comments\\ 
,\\ 
string]] 
	ipAddress]] 
,]] 
DateTime^^ 

lastModUtc^^ 
)^^  
{__ 	
SqlParameterHelper`` 
sph`` "
=``# $
new``% (
SqlParameterHelper``) ;
(``; <
ConnectionString``< L
.``L M$
GetWriteConnectionString``M e
(``e f
)``f g
,``g h
$str	``i Ç
,
``Ç É
$num
``Ñ Ö
)
``Ö Ü
;
``Ü á
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# -
,aa- .
	SqlDbTypeaa/ 8
.aa8 9
UniqueIdentifieraa9 I
,aaI J
ParameterDirectionaaK ]
.aa] ^
Inputaa^ c
,aac d
rowGuidaae l
)aal m
;aam n
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
NVarCharbb> F
,bbF G
$numbbH K
,bbK L
ParameterDirectionbbM _
.bb_ `
Inputbb` e
,bbe f
emailAddressbbg s
)bbs t
;bbt u
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# ,
,cc, -
	SqlDbTypecc. 7
.cc7 8
Intcc8 ;
,cc; <
ParameterDirectioncc= O
.ccO P
InputccP U
,ccU V
ratingccW ]
)cc] ^
;cc^ _
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# .
,dd. /
	SqlDbTypedd0 9
.dd9 :
NVarChardd: B
,ddB C
-ddD E
$numddE F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
commentsddb j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
NVarCharee; C
,eeC D
$numeeE G
,eeG H
ParameterDirectioneeI [
.ee[ \
Inputee\ a
,eea b
	ipAddresseec l
)eel m
;eem n
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 0
,ff0 1
	SqlDbTypeff2 ;
.ff; <
DateTimeff< D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _

lastModUtcff` j
)ffj k
;ffk l
intgg 
rowsAffectedgg 
=gg 
sphgg "
.gg" #
ExecuteNonQuerygg# 2
(gg2 3
)gg3 4
;gg4 5
returnhh 
(hh 
rowsAffectedhh  
>hh! "
$numhh# $
)hh$ %
;hh% &
}jj 	
publicqq 
staticqq 
boolqq 
Deleteqq !
(qq! "
Guidqq" &
rowGuidqq' .
)qq. /
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$str	ssi Ç
,
ssÇ É
$num
ssÑ Ö
)
ssÖ Ü
;
ssÜ á
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# -
,tt- .
	SqlDbTypett/ 8
.tt8 9
UniqueIdentifiertt9 I
,ttI J
ParameterDirectionttK ]
.tt] ^
Inputtt^ c
,ttc d
rowGuidtte l
)ttl m
;ttm n
intuu 
rowsAffecteduu 
=uu 
sphuu "
.uu" #
ExecuteNonQueryuu# 2
(uu2 3
)uu3 4
;uu4 5
returnvv 
(vv 
rowsAffectedvv  
>vv! "
$numvv# $
)vv$ %
;vv% &
}xx 	
public 
static 
bool 
DeleteByContent *
(* +
Guid+ /
contentGuid0 ;
); <
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M&
GetWriteConnectionString
ÅÅM e
(
ÅÅe f
)
ÅÅf g
,
ÅÅg h
$strÅÅi ã
,ÅÅã å
$numÅÅç é
)ÅÅé è
;ÅÅè ê
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 1
,
ÇÇ1 2
	SqlDbType
ÇÇ3 <
.
ÇÇ< =
UniqueIdentifier
ÇÇ= M
,
ÇÇM N 
ParameterDirection
ÇÇO a
.
ÇÇa b
Input
ÇÇb g
,
ÇÇg h
contentGuid
ÇÇi t
)
ÇÇt u
;
ÇÇu v
int
ÉÉ 
rowsAffected
ÉÉ 
=
ÉÉ 
sph
ÉÉ "
.
ÉÉ" #
ExecuteNonQuery
ÉÉ# 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
$num
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
}
ÜÜ 	
public
çç 
static
çç 
bool
çç 
DeleteBySite
çç '
(
çç' (
Guid
çç( ,
siteGuid
çç- 5
)
çç5 6
{
éé 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M&
GetWriteConnectionString
èèM e
(
èèe f
)
èèf g
,
èèg h
$strèèi à
,èèà â
$numèèä ã
)èèã å
;èèå ç
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
UniqueIdentifier
êê: J
,
êêJ K 
ParameterDirection
êêL ^
.
êê^ _
Input
êê_ d
,
êêd e
siteGuid
êêf n
)
êên o
;
êêo p
int
ëë 
rowsAffected
ëë 
=
ëë 
sph
ëë "
.
ëë" #
ExecuteNonQuery
ëë# 2
(
ëë2 3
)
ëë3 4
;
ëë4 5
return
íí 
(
íí 
rowsAffected
íí  
>
íí! "
$num
íí# $
)
íí$ %
;
íí% &
}
îî 	
public
õõ 
static
õõ 
bool
õõ 
DeleteByUser
õõ '
(
õõ' (
Guid
õõ( ,
userGuid
õõ- 5
)
õõ5 6
{
úú 	 
SqlParameterHelper
ùù 
sph
ùù "
=
ùù# $
new
ùù% ( 
SqlParameterHelper
ùù) ;
(
ùù; <
ConnectionString
ùù< L
.
ùùL M&
GetWriteConnectionString
ùùM e
(
ùùe f
)
ùùf g
,
ùùg h
$strùùi à
,ùùà â
$numùùä ã
)ùùã å
;ùùå ç
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# .
,
ûû. /
	SqlDbType
ûû0 9
.
ûû9 :
UniqueIdentifier
ûû: J
,
ûûJ K 
ParameterDirection
ûûL ^
.
ûû^ _
Input
ûû_ d
,
ûûd e
userGuid
ûûf n
)
ûûn o
;
ûûo p
int
üü 
rowsAffected
üü 
=
üü 
sph
üü "
.
üü" #
ExecuteNonQuery
üü# 2
(
üü2 3
)
üü3 4
;
üü4 5
return
†† 
(
†† 
rowsAffected
††  
>
††! "
$num
††# $
)
††$ %
;
††% &
}
¢¢ 	
public
®® 
static
®® 
IDataReader
®® !
GetOne
®®" (
(
®®( )
Guid
®®) -
rowGuid
®®. 5
)
®®5 6
{
©© 	 
SqlParameterHelper
™™ 
sph
™™ "
=
™™# $
new
™™% ( 
SqlParameterHelper
™™) ;
(
™™; <
ConnectionString
™™< L
.
™™L M%
GetReadConnectionString
™™M d
(
™™d e
)
™™e f
,
™™f g
$str™™h Ñ
,™™Ñ Ö
$num™™Ü á
)™™á à
;™™à â
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# -
,
´´- .
	SqlDbType
´´/ 8
.
´´8 9
UniqueIdentifier
´´9 I
,
´´I J 
ParameterDirection
´´K ]
.
´´] ^
Input
´´^ c
,
´´c d
rowGuid
´´e l
)
´´l m
;
´´m n
return
¨¨ 
sph
¨¨ 
.
¨¨ 
ExecuteReader
¨¨ $
(
¨¨$ %
)
¨¨% &
;
¨¨& '
}
ÆÆ 	
public
µµ 
static
µµ 
IDataReader
µµ !$
GetOneByContentAndUser
µµ" 8
(
µµ8 9
Guid
µµ9 =
contentGuid
µµ> I
,
µµI J
Guid
µµK O
userGuid
µµP X
)
µµX Y
{
∂∂ 	 
SqlParameterHelper
∑∑ 
sph
∑∑ "
=
∑∑# $
new
∑∑% ( 
SqlParameterHelper
∑∑) ;
(
∑∑; <
ConnectionString
∑∑< L
.
∑∑L M%
GetReadConnectionString
∑∑M d
(
∑∑d e
)
∑∑e f
,
∑∑f g
$str∑∑h î
,∑∑î ï
$num∑∑ñ ó
)∑∑ó ò
;∑∑ò ô
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# 1
,
∏∏1 2
	SqlDbType
∏∏3 <
.
∏∏< =
UniqueIdentifier
∏∏= M
,
∏∏M N 
ParameterDirection
∏∏O a
.
∏∏a b
Input
∏∏b g
,
∏∏g h
contentGuid
∏∏i t
)
∏∏t u
;
∏∏u v
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# .
,
ππ. /
	SqlDbType
ππ0 9
.
ππ9 :
UniqueIdentifier
ππ: J
,
ππJ K 
ParameterDirection
ππL ^
.
ππ^ _
Input
ππ_ d
,
ππd e
userGuid
ππf n
)
ππn o
;
ππo p
return
∫∫ 
sph
∫∫ 
.
∫∫ 
ExecuteReader
∫∫ $
(
∫∫$ %
)
∫∫% &
;
∫∫& '
}
ºº 	
public
¬¬ 
static
¬¬ 
IDataReader
¬¬ !
GetStatsByContent
¬¬" 3
(
¬¬3 4
Guid
¬¬4 8
contentGuid
¬¬9 D
)
¬¬D E
{
√√ 	 
SqlParameterHelper
ƒƒ 
sph
ƒƒ "
=
ƒƒ# $
new
ƒƒ% ( 
SqlParameterHelper
ƒƒ) ;
(
ƒƒ; <
ConnectionString
ƒƒ< L
.
ƒƒL M%
GetReadConnectionString
ƒƒM d
(
ƒƒd e
)
ƒƒe f
,
ƒƒf g
$strƒƒh å
,ƒƒå ç
$numƒƒé è
)ƒƒè ê
;ƒƒê ë
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ "
(
≈≈" #
$str
≈≈# 1
,
≈≈1 2
	SqlDbType
≈≈3 <
.
≈≈< =
UniqueIdentifier
≈≈= M
,
≈≈M N 
ParameterDirection
≈≈O a
.
≈≈a b
Input
≈≈b g
,
≈≈g h
contentGuid
≈≈i t
)
≈≈t u
;
≈≈u v
return
∆∆ 
sph
∆∆ 
.
∆∆ 
ExecuteReader
∆∆ $
(
∆∆$ %
)
∆∆% &
;
∆∆& '
}
»» 	
public
œœ 
static
œœ 
int
œœ 
GetCountByContent
œœ +
(
œœ+ ,
Guid
œœ, 0
contentGuid
œœ1 <
)
œœ< =
{
–– 	 
SqlParameterHelper
—— 
sph
—— "
=
——# $
new
——% ( 
SqlParameterHelper
——) ;
(
——; <
ConnectionString
——< L
.
——L M%
GetReadConnectionString
——M d
(
——d e
)
——e f
,
——f g
$str——h å
,——å ç
$num——é è
)——è ê
;——ê ë
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# 1
,
““1 2
	SqlDbType
““3 <
.
““< =
UniqueIdentifier
““= M
,
““M N 
ParameterDirection
““O a
.
““a b
Input
““b g
,
““g h
contentGuid
““i t
)
““t u
;
““u v
return
”” 
Convert
”” 
.
”” 
ToInt32
”” "
(
””" #
sph
””# &
.
””& '
ExecuteScalar
””' 4
(
””4 5
)
””5 6
)
””6 7
;
””7 8
}
’’ 	
public
⁄⁄ 
static
⁄⁄ 
int
⁄⁄ &
GetCountByContentAndUser
⁄⁄ 2
(
⁄⁄2 3
Guid
⁄⁄3 7
contentGuid
⁄⁄8 C
,
⁄⁄C D
Guid
⁄⁄E I
userGuid
⁄⁄J R
)
⁄⁄R S
{
€€ 	 
SqlParameterHelper
‹‹ 
sph
‹‹ "
=
‹‹# $
new
‹‹% ( 
SqlParameterHelper
‹‹) ;
(
‹‹; <
ConnectionString
‹‹< L
.
‹‹L M%
GetReadConnectionString
‹‹M d
(
‹‹d e
)
‹‹e f
,
‹‹f g
$str‹‹h ì
,‹‹ì î
$num‹‹ï ñ
)‹‹ñ ó
;‹‹ó ò
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# 1
,
››1 2
	SqlDbType
››3 <
.
››< =
UniqueIdentifier
››= M
,
››M N 
ParameterDirection
››O a
.
››a b
Input
››b g
,
››g h
contentGuid
››i t
)
››t u
;
››u v
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# .
,
ﬁﬁ. /
	SqlDbType
ﬁﬁ0 9
.
ﬁﬁ9 :
UniqueIdentifier
ﬁﬁ: J
,
ﬁﬁJ K 
ParameterDirection
ﬁﬁL ^
.
ﬁﬁ^ _
Input
ﬁﬁ_ d
,
ﬁﬁd e
userGuid
ﬁﬁf n
)
ﬁﬁn o
;
ﬁﬁo p
return
ﬂﬂ 
Convert
ﬂﬂ 
.
ﬂﬂ 
ToInt32
ﬂﬂ "
(
ﬂﬂ" #
sph
ﬂﬂ# &
.
ﬂﬂ& '
ExecuteScalar
ﬂﬂ' 4
(
ﬂﬂ4 5
)
ﬂﬂ5 6
)
ﬂﬂ6 7
;
ﬂﬂ7 8
}
·· 	
public
ÊÊ 
static
ÊÊ 
int
ÊÊ $
GetCountOfRatingsSince
ÊÊ 0
(
ÊÊ0 1
Guid
ÊÊ1 5
contentGuid
ÊÊ6 A
,
ÊÊA B
string
ÊÊC I
	ipAddress
ÊÊJ S
,
ÊÊS T
DateTime
ÊÊU ]
beginUtc
ÊÊ^ f
)
ÊÊf g
{
ÁÁ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh ò
,ËËò ô
$numËËö õ
)ËËõ ú
;ËËú ù
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 1
,
ÈÈ1 2
	SqlDbType
ÈÈ3 <
.
ÈÈ< =
UniqueIdentifier
ÈÈ= M
,
ÈÈM N 
ParameterDirection
ÈÈO a
.
ÈÈa b
Input
ÈÈb g
,
ÈÈg h
contentGuid
ÈÈi t
)
ÈÈt u
;
ÈÈu v
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# /
,
ÍÍ/ 0
	SqlDbType
ÍÍ1 :
.
ÍÍ: ;
NVarChar
ÍÍ; C
,
ÍÍC D
$num
ÍÍE G
,
ÍÍG H 
ParameterDirection
ÍÍI [
.
ÍÍ[ \
Input
ÍÍ\ a
,
ÍÍa b
	ipAddress
ÍÍc l
)
ÍÍl m
;
ÍÍm n
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# .
,
ÎÎ. /
	SqlDbType
ÎÎ0 9
.
ÎÎ9 :
DateTime
ÎÎ: B
,
ÎÎB C 
ParameterDirection
ÎÎD V
.
ÎÎV W
Input
ÎÎW \
,
ÎÎ\ ]
beginUtc
ÎÎ^ f
)
ÎÎf g
;
ÎÎg h
return
ÏÏ 
Convert
ÏÏ 
.
ÏÏ 
ToInt32
ÏÏ "
(
ÏÏ" #
sph
ÏÏ# &
.
ÏÏ& '
ExecuteScalar
ÏÏ' 4
(
ÏÏ4 5
)
ÏÏ5 6
)
ÏÏ6 7
;
ÏÏ7 8
}
ÓÓ 	
public
˘˘ 
static
˘˘ 
IDataReader
˘˘ !
GetPage
˘˘" )
(
˘˘) *
Guid
˙˙ 
contentGuid
˙˙ 
,
˙˙ 
int
˚˚ 

pageNumber
˚˚ 
,
˚˚ 
int
¸¸ 
pageSize
¸¸ 
,
¸¸ 
out
˝˝ 
int
˝˝ 

totalPages
˝˝ 
)
˝˝ 
{
˛˛ 	

totalPages
ˇˇ 
=
ˇˇ 
$num
ˇˇ 
;
ˇˇ 
int
ÄÄ 
	totalRows
ÄÄ 
=
ÅÅ 
GetCountByContent
ÅÅ #
(
ÅÅ# $
contentGuid
ÅÅ$ /
)
ÅÅ/ 0
;
ÅÅ0 1
if
ÉÉ 
(
ÉÉ 
pageSize
ÉÉ 
>
ÉÉ 
$num
ÉÉ 
)
ÉÉ 

totalPages
ÉÉ (
=
ÉÉ) *
	totalRows
ÉÉ+ 4
/
ÉÉ5 6
pageSize
ÉÉ7 ?
;
ÉÉ? @
if
ÖÖ 
(
ÖÖ 
	totalRows
ÖÖ 
<=
ÖÖ 
pageSize
ÖÖ %
)
ÖÖ% &
{
ÜÜ 

totalPages
áá 
=
áá 
$num
áá 
;
áá 
}
àà 
else
ââ 
{
ää 
int
ãã 
	remainder
ãã 
;
ãã 
Math
åå 
.
åå 
DivRem
åå 
(
åå 
	totalRows
åå %
,
åå% &
pageSize
åå' /
,
åå/ 0
out
åå1 4
	remainder
åå5 >
)
åå> ?
;
åå? @
if
çç 
(
çç 
	remainder
çç 
>
çç 
$num
çç  !
)
çç! "
{
éé 

totalPages
èè 
+=
èè !
$num
èè" #
;
èè# $
}
êê 
}
ëë  
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M%
GetReadConnectionString
ììM d
(
ììd e
)
ììe f
,
ììf g
$strììh é
,ììé è
$numììê ë
)ììë í
;ììí ì
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 1
,
îî1 2
	SqlDbType
îî3 <
.
îî< =
UniqueIdentifier
îî= M
,
îîM N 
ParameterDirection
îîO a
.
îîa b
Input
îîb g
,
îîg h
contentGuid
îîi t
)
îît u
;
îîu v
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 0
,
ïï0 1
	SqlDbType
ïï2 ;
.
ïï; <
Int
ïï< ?
,
ïï? @ 
ParameterDirection
ïïA S
.
ïïS T
Input
ïïT Y
,
ïïY Z

pageNumber
ïï[ e
)
ïïe f
;
ïïf g
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
Int
ññ: =
,
ññ= > 
ParameterDirection
ññ? Q
.
ññQ R
Input
ññR W
,
ññW X
pageSize
ññY a
)
ñña b
;
ññb c
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
ôô 	
}
õõ 
}ùù ˛˙
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentStyle.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentStyle &
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 
siteGuidDD 
,DD 
stringEE 
nameEE 
,EE 
stringFF 
elementFF 
,FF 
stringGG 
cssClassGG 
,GG 
stringHH 
skinNameHH 
,HH 
boolII 
isActiveII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
GuidKK 
	createdByKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi Å
,
MMÅ Ç
$num
MMÉ Ö
)
MMÖ Ü
;
MMÜ á
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
namePP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
NVarCharQQ9 A
,QQA B
$numQQC E
,QQE F
ParameterDirectionQQG Y
.QQY Z
InputQQZ _
,QQ_ `
elementQQa h
)QQh i
;QQi j
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
NVarCharRR: B
,RRB C
$numRRD F
,RRF G
ParameterDirectionRRH Z
.RRZ [
InputRR[ `
,RR` a
cssClassRRb j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
skinNameSSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
BitTT: =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
isActiveTTY a
)TTa b
;TTb c
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

createdUtcVV` j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
UniqueIdentifierWW; K
,WWK L
ParameterDirectionWWM _
.WW_ `
InputWW` e
,WWe f
	createdByWWg p
)WWp q
;WWq r
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# /
,XX/ 0
	SqlDbTypeXX1 :
.XX: ;
UniqueIdentifierXX; K
,XXK L
ParameterDirectionXXM _
.XX_ `
InputXX` e
,XXe f
	createdByXXg p
)XXp q
;XXq r
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
rowsAffectedZZ 
;ZZ  
}\\ 	
publicll 
staticll 
boolll 
Updatell !
(ll! "
Guidmm 
guidmm 
,mm 
Guidnn 
siteGuidnn 
,nn 
stringoo 
nameoo 
,oo 
stringpp 
elementpp 
,pp 
stringqq 
cssClassqq 
,qq 
stringrr 
skinNamerr 
,rr 
boolss 
isActivess 
,ss 
DateTimett 

lastModUtctt 
,tt  
Guiduu 
	lastModByuu 
)uu 
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi Å
,
wwÅ Ç
$num
wwÉ Ñ
)
wwÑ Ö
;
wwÖ Ü
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
UniqueIdentifierxx6 F
,xxF G
ParameterDirectionxxH Z
.xxZ [
Inputxx[ `
,xx` a
guidxxb f
)xxf g
;xxg h
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# .
,yy. /
	SqlDbTypeyy0 9
.yy9 :
UniqueIdentifieryy: J
,yyJ K
ParameterDirectionyyL ^
.yy^ _
Inputyy_ d
,yyd e
siteGuidyyf n
)yyn o
;yyo p
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
NVarCharzz6 >
,zz> ?
$numzz@ C
,zzC D
ParameterDirectionzzE W
.zzW X
InputzzX ]
,zz] ^
namezz_ c
)zzc d
;zzd e
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# -
,{{- .
	SqlDbType{{/ 8
.{{8 9
NVarChar{{9 A
,{{A B
$num{{C E
,{{E F
ParameterDirection{{G Y
.{{Y Z
Input{{Z _
,{{_ `
element{{a h
){{h i
;{{i j
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# .
,||. /
	SqlDbType||0 9
.||9 :
NVarChar||: B
,||B C
$num||D F
,||F G
ParameterDirection||H Z
.||Z [
Input||[ `
,||` a
cssClass||b j
)||j k
;||k l
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# .
,}}. /
	SqlDbType}}0 9
.}}9 :
NVarChar}}: B
,}}B C
$num}}D G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
skinName}}c k
)}}k l
;}}l m
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# .
,~~. /
	SqlDbType~~0 9
.~~9 :
Bit~~: =
,~~= >
ParameterDirection~~? Q
.~~Q R
Input~~R W
,~~W X
isActive~~Y a
)~~a b
;~~b c
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
DateTime< D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _

lastModUtc` j
)j k
;k l
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# /
,
ÄÄ/ 0
	SqlDbType
ÄÄ1 :
.
ÄÄ: ;
UniqueIdentifier
ÄÄ; K
,
ÄÄK L 
ParameterDirection
ÄÄM _
.
ÄÄ_ `
Input
ÄÄ` e
,
ÄÄe f
	lastModBy
ÄÄg p
)
ÄÄp q
;
ÄÄq r
int
ÅÅ 
rowsAffected
ÅÅ 
=
ÅÅ 
sph
ÅÅ "
.
ÅÅ" #
ExecuteNonQuery
ÅÅ# 2
(
ÅÅ2 3
)
ÅÅ3 4
;
ÅÅ4 5
return
ÇÇ 
(
ÇÇ 
rowsAffected
ÇÇ  
>
ÇÇ! "
$num
ÇÇ# $
)
ÇÇ$ %
;
ÇÇ% &
}
ÑÑ 	
public
ãã 
static
ãã 
bool
ãã 
Delete
ãã !
(
ãã! "
Guid
ãã" &
guid
ãã' +
)
ãã+ ,
{
åå 	 
SqlParameterHelper
çç 
sph
çç "
=
çç# $
new
çç% ( 
SqlParameterHelper
çç) ;
(
çç; <
ConnectionString
çç< L
.
ççL M&
GetWriteConnectionString
ççM e
(
ççe f
)
ççf g
,
ççg h
$strççi Å
,ççÅ Ç
$numççÉ Ñ
)ççÑ Ö
;ççÖ Ü
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# *
,
éé* +
	SqlDbType
éé, 5
.
éé5 6
UniqueIdentifier
éé6 F
,
ééF G 
ParameterDirection
ééH Z
.
ééZ [
Input
éé[ `
,
éé` a
guid
ééb f
)
ééf g
;
éég h
int
èè 
rowsAffected
èè 
=
èè 
sph
èè "
.
èè" #
ExecuteNonQuery
èè# 2
(
èè2 3
)
èè3 4
;
èè4 5
return
êê 
(
êê 
rowsAffected
êê  
>
êê! "
$num
êê# $
)
êê$ %
;
êê% &
}
íí 	
public
ôô 
static
ôô 
bool
ôô 
DeleteBySite
ôô '
(
ôô' (
Guid
ôô( ,
siteGuid
ôô- 5
)
ôô5 6
{
öö 	 
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M&
GetWriteConnectionString
õõM e
(
õõe f
)
õõf g
,
õõg h
$strõõi á
,õõá à
$numõõâ ä
)õõä ã
;õõã å
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# .
,
úú. /
	SqlDbType
úú0 9
.
úú9 :
UniqueIdentifier
úú: J
,
úúJ K 
ParameterDirection
úúL ^
.
úú^ _
Input
úú_ d
,
úúd e
siteGuid
úúf n
)
úún o
;
úúo p
int
ùù 
rowsAffected
ùù 
=
ùù 
sph
ùù "
.
ùù" #
ExecuteNonQuery
ùù# 2
(
ùù2 3
)
ùù3 4
;
ùù4 5
return
ûû 
(
ûû 
rowsAffected
ûû  
>
ûû! "
$num
ûû# $
)
ûû$ %
;
ûû% &
}
†† 	
public
ßß 
static
ßß 
bool
ßß 
DeleteBySkin
ßß '
(
ßß' (
Guid
ßß( ,
siteGuid
ßß- 5
,
ßß5 6
string
ßß7 =
skinName
ßß> F
)
ßßF G
{
®® 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i á
,©©á à
$num©©â ä
)©©ä ã
;©©ã å
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# .
,
™™. /
	SqlDbType
™™0 9
.
™™9 :
UniqueIdentifier
™™: J
,
™™J K 
ParameterDirection
™™L ^
.
™™^ _
Input
™™_ d
,
™™d e
siteGuid
™™f n
)
™™n o
;
™™o p
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
NVarChar
´´: B
,
´´B C
$num
´´D G
,
´´G H 
ParameterDirection
´´I [
.
´´[ \
Input
´´\ a
,
´´a b
skinName
´´c k
)
´´k l
;
´´l m
int
¨¨ 
rowsAffected
¨¨ 
=
¨¨ 
sph
¨¨ "
.
¨¨" #
ExecuteNonQuery
¨¨# 2
(
¨¨2 3
)
¨¨3 4
;
¨¨4 5
return
≠≠ 
(
≠≠ 
rowsAffected
≠≠  
>
≠≠! "
$num
≠≠# $
)
≠≠$ %
;
≠≠% &
}
ØØ 	
public
∂∂ 
static
∂∂ 
bool
∂∂ !
SetActivationBySkin
∂∂ .
(
∂∂. /
Guid
∂∂/ 3
siteGuid
∂∂4 <
,
∂∂< =
string
∂∂> D
skinName
∂∂E M
,
∂∂M N
bool
∂∂O S
isActive
∂∂T \
)
∂∂\ ]
{
∑∑ 	 
SqlParameterHelper
∏∏ 
sph
∏∏ "
=
∏∏# $
new
∏∏% ( 
SqlParameterHelper
∏∏) ;
(
∏∏; <
ConnectionString
∏∏< L
.
∏∏L M&
GetWriteConnectionString
∏∏M e
(
∏∏e f
)
∏∏f g
,
∏∏g h
$str∏∏i à
,∏∏à â
$num∏∏ä ã
)∏∏ã å
;∏∏å ç
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# .
,
ππ. /
	SqlDbType
ππ0 9
.
ππ9 :
UniqueIdentifier
ππ: J
,
ππJ K 
ParameterDirection
ππL ^
.
ππ^ _
Input
ππ_ d
,
ππd e
siteGuid
ππf n
)
ππn o
;
ππo p
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# .
,
∫∫. /
	SqlDbType
∫∫0 9
.
∫∫9 :
NVarChar
∫∫: B
,
∫∫B C
$num
∫∫D G
,
∫∫G H 
ParameterDirection
∫∫I [
.
∫∫[ \
Input
∫∫\ a
,
∫∫a b
skinName
∫∫c k
)
∫∫k l
;
∫∫l m
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
Bit
ªª: =
,
ªª= > 
ParameterDirection
ªª? Q
.
ªªQ R
Input
ªªR W
,
ªªW X
isActive
ªªY a
)
ªªa b
;
ªªb c
int
ºº 
rowsAffected
ºº 
=
ºº 
sph
ºº "
.
ºº" #
ExecuteNonQuery
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
return
ΩΩ 
(
ΩΩ 
rowsAffected
ΩΩ  
>
ΩΩ! "
$num
ΩΩ# $
)
ΩΩ$ %
;
ΩΩ% &
}
øø 	
public
≈≈ 
static
≈≈ 
IDataReader
≈≈ !
GetOne
≈≈" (
(
≈≈( )
Guid
≈≈) -
guid
≈≈. 2
)
≈≈2 3
{
∆∆ 	 
SqlParameterHelper
«« 
sph
«« "
=
««# $
new
««% ( 
SqlParameterHelper
««) ;
(
««; <
ConnectionString
««< L
.
««L M%
GetReadConnectionString
««M d
(
««d e
)
««e f
,
««f g
$str««h É
,««É Ñ
$num««Ö Ü
)««Ü á
;««á à
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# *
,
»»* +
	SqlDbType
»», 5
.
»»5 6
UniqueIdentifier
»»6 F
,
»»F G 
ParameterDirection
»»H Z
.
»»Z [
Input
»»[ `
,
»»` a
guid
»»b f
)
»»f g
;
»»g h
return
…… 
sph
…… 
.
…… 
ExecuteReader
…… $
(
……$ %
)
……% &
;
……& '
}
ÀÀ 	
public
““ 
static
““ 
IDataReader
““ !
GetAll
““" (
(
““( )
Guid
““) -
siteGuid
““. 6
)
““6 7
{
”” 	 
SqlParameterHelper
‘‘ 
sph
‘‘ "
=
‘‘# $
new
‘‘% ( 
SqlParameterHelper
‘‘) ;
(
‘‘; <
ConnectionString
‘‘< L
.
‘‘L M%
GetReadConnectionString
‘‘M d
(
‘‘d e
)
‘‘e f
,
‘‘f g
$str‘‘h É
,‘‘É Ñ
$num‘‘Ö Ü
)‘‘Ü á
;‘‘á à
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# .
,
’’. /
	SqlDbType
’’0 9
.
’’9 :
UniqueIdentifier
’’: J
,
’’J K 
ParameterDirection
’’L ^
.
’’^ _
Input
’’_ d
,
’’d e
siteGuid
’’f n
)
’’n o
;
’’o p
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
ÿÿ 	
public
›› 
static
›› 
IDataReader
›› !
GetAll
››" (
(
››( )
Guid
››) -
siteGuid
››. 6
,
››6 7
string
››8 >
skinName
››? G
)
››G H
{
ﬁﬁ 	 
SqlParameterHelper
ﬂﬂ 
sph
ﬂﬂ "
=
ﬂﬂ# $
new
ﬂﬂ% ( 
SqlParameterHelper
ﬂﬂ) ;
(
ﬂﬂ; <
ConnectionString
ﬂﬂ< L
.
ﬂﬂL M%
GetReadConnectionString
ﬂﬂM d
(
ﬂﬂd e
)
ﬂﬂe f
,
ﬂﬂf g
$strﬂﬂh â
,ﬂﬂâ ä
$numﬂﬂã å
)ﬂﬂå ç
;ﬂﬂç é
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# .
,
‡‡. /
	SqlDbType
‡‡0 9
.
‡‡9 :
UniqueIdentifier
‡‡: J
,
‡‡J K 
ParameterDirection
‡‡L ^
.
‡‡^ _
Input
‡‡_ d
,
‡‡d e
siteGuid
‡‡f n
)
‡‡n o
;
‡‡o p
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# .
,
··. /
	SqlDbType
··0 9
.
··9 :
NVarChar
··: B
,
··B C
$num
··D G
,
··G H 
ParameterDirection
··I [
.
··[ \
Input
··\ a
,
··a b
skinName
··c k
)
··k l
;
··l m
return
‚‚ 
sph
‚‚ 
.
‚‚ 
ExecuteReader
‚‚ $
(
‚‚$ %
)
‚‚% &
;
‚‚& '
}
‰‰ 	
public
ÈÈ 
static
ÈÈ 
IDataReader
ÈÈ !
GetAllActive
ÈÈ" .
(
ÈÈ. /
Guid
ÈÈ/ 3
siteGuid
ÈÈ4 <
)
ÈÈ< =
{
ÍÍ 	 
SqlParameterHelper
ÎÎ 
sph
ÎÎ "
=
ÎÎ# $
new
ÎÎ% ( 
SqlParameterHelper
ÎÎ) ;
(
ÎÎ; <
ConnectionString
ÎÎ< L
.
ÎÎL M%
GetReadConnectionString
ÎÎM d
(
ÎÎd e
)
ÎÎe f
,
ÎÎf g
$strÎÎh â
,ÎÎâ ä
$numÎÎã å
)ÎÎå ç
;ÎÎç é
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# .
,
ÏÏ. /
	SqlDbType
ÏÏ0 9
.
ÏÏ9 :
UniqueIdentifier
ÏÏ: J
,
ÏÏJ K 
ParameterDirection
ÏÏL ^
.
ÏÏ^ _
Input
ÏÏ_ d
,
ÏÏd e
siteGuid
ÏÏf n
)
ÏÏn o
;
ÏÏo p
return
ÌÌ 
sph
ÌÌ 
.
ÌÌ 
ExecuteReader
ÌÌ $
(
ÌÌ$ %
)
ÌÌ% &
;
ÌÌ& '
}
ÔÔ 	
public
ÙÙ 
static
ÙÙ 
IDataReader
ÙÙ !
GetAllActive
ÙÙ" .
(
ÙÙ. /
Guid
ÙÙ/ 3
siteGuid
ÙÙ4 <
,
ÙÙ< =
string
ÙÙ> D
skinName
ÙÙE M
)
ÙÙM N
{
ıı 	 
SqlParameterHelper
ˆˆ 
sph
ˆˆ "
=
ˆˆ# $
new
ˆˆ% ( 
SqlParameterHelper
ˆˆ) ;
(
ˆˆ; <
ConnectionString
ˆˆ< L
.
ˆˆL M%
GetReadConnectionString
ˆˆM d
(
ˆˆd e
)
ˆˆe f
,
ˆˆf g
$strˆˆh è
,ˆˆè ê
$numˆˆë í
)ˆˆí ì
;ˆˆì î
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# .
,
˜˜. /
	SqlDbType
˜˜0 9
.
˜˜9 :
UniqueIdentifier
˜˜: J
,
˜˜J K 
ParameterDirection
˜˜L ^
.
˜˜^ _
Input
˜˜_ d
,
˜˜d e
siteGuid
˜˜f n
)
˜˜n o
;
˜˜o p
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
NVarChar
¯¯: B
,
¯¯B C
$num
¯¯D G
,
¯¯G H 
ParameterDirection
¯¯I [
.
¯¯[ \
Input
¯¯\ a
,
¯¯a b
skinName
¯¯c k
)
¯¯k l
;
¯¯l m
return
˘˘ 
sph
˘˘ 
.
˘˘ 
ExecuteReader
˘˘ $
(
˘˘$ %
)
˘˘% &
;
˘˘& '
}
˚˚ 	
public
ÄÄ 
static
ÄÄ 
int
ÄÄ 
GetCount
ÄÄ "
(
ÄÄ" #
Guid
ÄÄ# '
siteGuid
ÄÄ( 0
)
ÄÄ0 1
{
ÅÅ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M%
GetReadConnectionString
ÇÇM d
(
ÇÇd e
)
ÇÇe f
,
ÇÇf g
$strÇÇh Ç
,ÇÇÇ É
$numÇÇÑ Ö
)ÇÇÖ Ü
;ÇÇÜ á
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
UniqueIdentifier
ÉÉ: J
,
ÉÉJ K 
ParameterDirection
ÉÉL ^
.
ÉÉ^ _
Input
ÉÉ_ d
,
ÉÉd e
siteGuid
ÉÉf n
)
ÉÉn o
;
ÉÉo p
return
ÑÑ 
Convert
ÑÑ 
.
ÑÑ 
ToInt32
ÑÑ "
(
ÑÑ" #
sph
ÑÑ# &
.
ÑÑ& '
ExecuteScalar
ÑÑ' 4
(
ÑÑ4 5
)
ÑÑ5 6
)
ÑÑ6 7
;
ÑÑ7 8
}
ÜÜ 	
public
ãã 
static
ãã 
int
ãã 
GetCount
ãã "
(
ãã" #
Guid
ãã# '
siteGuid
ãã( 0
,
ãã0 1
string
ãã2 8
skinName
ãã9 A
)
ããA B
{
åå 	 
SqlParameterHelper
çç 
sph
çç "
=
çç# $
new
çç% ( 
SqlParameterHelper
çç) ;
(
çç; <
ConnectionString
çç< L
.
ççL M%
GetReadConnectionString
ççM d
(
ççd e
)
ççe f
,
ççf g
$strççh à
,ççà â
$numççä ã
)ççã å
;ççå ç
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# .
,
éé. /
	SqlDbType
éé0 9
.
éé9 :
UniqueIdentifier
éé: J
,
ééJ K 
ParameterDirection
ééL ^
.
éé^ _
Input
éé_ d
,
ééd e
siteGuid
ééf n
)
één o
;
ééo p
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# .
,
èè. /
	SqlDbType
èè0 9
.
èè9 :
NVarChar
èè: B
,
èèB C
$num
èèD G
,
èèG H 
ParameterDirection
èèI [
.
èè[ \
Input
èè\ a
,
èèa b
skinName
èèc k
)
èèk l
;
èèl m
return
êê 
Convert
êê 
.
êê 
ToInt32
êê "
(
êê" #
sph
êê# &
.
êê& '
ExecuteScalar
êê' 4
(
êê4 5
)
êê5 6
)
êê6 7
;
êê7 8
}
íí 	
public
öö 
static
öö 
IDataReader
öö !
GetPage
öö" )
(
öö) *
Guid
õõ 
siteGuid
õõ 
,
õõ 
int
úú 

pageNumber
úú 
,
úú 
int
ùù 
pageSize
ùù 
,
ùù 
out
ûû 
int
ûû 

totalPages
ûû 
)
ûû 
{
üü 	

totalPages
†† 
=
†† 
$num
†† 
;
†† 
int
°° 
	totalRows
°° 
=
°° 
GetCount
°° $
(
°°$ %
siteGuid
°°% -
)
°°- .
;
°°. /
if
££ 
(
££ 
pageSize
££ 
>
££ 
$num
££ 
)
££ 

totalPages
££ (
=
££) *
	totalRows
££+ 4
/
££5 6
pageSize
££7 ?
;
££? @
if
•• 
(
•• 
	totalRows
•• 
<=
•• 
pageSize
•• %
)
••% &
{
¶¶ 

totalPages
ßß 
=
ßß 
$num
ßß 
;
ßß 
}
®® 
else
©© 
{
™™ 
int
´´ 
	remainder
´´ 
;
´´ 
Math
¨¨ 
.
¨¨ 
DivRem
¨¨ 
(
¨¨ 
	totalRows
¨¨ %
,
¨¨% &
pageSize
¨¨' /
,
¨¨/ 0
out
¨¨1 4
	remainder
¨¨5 >
)
¨¨> ?
;
¨¨? @
if
≠≠ 
(
≠≠ 
	remainder
≠≠ 
>
≠≠ 
$num
≠≠  !
)
≠≠! "
{
ÆÆ 

totalPages
ØØ 
+=
ØØ !
$num
ØØ" #
;
ØØ# $
}
∞∞ 
}
±±  
SqlParameterHelper
≥≥ 
sph
≥≥ "
=
≥≥# $
new
≥≥% ( 
SqlParameterHelper
≥≥) ;
(
≥≥; <
ConnectionString
≥≥< L
.
≥≥L M%
GetReadConnectionString
≥≥M d
(
≥≥d e
)
≥≥e f
,
≥≥f g
$str≥≥h Ñ
,≥≥Ñ Ö
$num≥≥Ü á
)≥≥á à
;≥≥à â
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
UniqueIdentifier
¥¥: J
,
¥¥J K 
ParameterDirection
¥¥L ^
.
¥¥^ _
Input
¥¥_ d
,
¥¥d e
siteGuid
¥¥f n
)
¥¥n o
;
¥¥o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 0
,
µµ0 1
	SqlDbType
µµ2 ;
.
µµ; <
Int
µµ< ?
,
µµ? @ 
ParameterDirection
µµA S
.
µµS T
Input
µµT Y
,
µµY Z

pageNumber
µµ[ e
)
µµe f
;
µµf g
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# .
,
∂∂. /
	SqlDbType
∂∂0 9
.
∂∂9 :
Int
∂∂: =
,
∂∂= > 
ParameterDirection
∂∂? Q
.
∂∂Q R
Input
∂∂R W
,
∂∂W X
pageSize
∂∂Y a
)
∂∂a b
;
∂∂b c
return
∑∑ 
sph
∑∑ 
.
∑∑ 
ExecuteReader
∑∑ $
(
∑∑$ %
)
∑∑% &
;
∑∑& '
}
ππ 	
public
¡¡ 
static
¡¡ 
IDataReader
¡¡ !
GetPage
¡¡" )
(
¡¡) *
Guid
¬¬ 
siteGuid
¬¬ 
,
¬¬ 
string
√√ 
skinName
√√ 
,
√√ 
int
ƒƒ 

pageNumber
ƒƒ 
,
ƒƒ 
int
≈≈ 
pageSize
≈≈ 
,
≈≈ 
out
∆∆ 
int
∆∆ 

totalPages
∆∆ 
)
∆∆ 
{
«« 	

totalPages
»» 
=
»» 
$num
»» 
;
»» 
int
…… 
	totalRows
…… 
=
…… 
GetCount
…… $
(
……$ %
siteGuid
……% -
,
……- .
skinName
……/ 7
)
……7 8
;
……8 9
if
ÀÀ 
(
ÀÀ 
pageSize
ÀÀ 
>
ÀÀ 
$num
ÀÀ 
)
ÀÀ 

totalPages
ÀÀ (
=
ÀÀ) *
	totalRows
ÀÀ+ 4
/
ÀÀ5 6
pageSize
ÀÀ7 ?
;
ÀÀ? @
if
ÕÕ 
(
ÕÕ 
	totalRows
ÕÕ 
<=
ÕÕ 
pageSize
ÕÕ %
)
ÕÕ% &
{
ŒŒ 

totalPages
œœ 
=
œœ 
$num
œœ 
;
œœ 
}
–– 
else
—— 
{
““ 
int
”” 
	remainder
”” 
;
”” 
Math
‘‘ 
.
‘‘ 
DivRem
‘‘ 
(
‘‘ 
	totalRows
‘‘ %
,
‘‘% &
pageSize
‘‘' /
,
‘‘/ 0
out
‘‘1 4
	remainder
‘‘5 >
)
‘‘> ?
;
‘‘? @
if
’’ 
(
’’ 
	remainder
’’ 
>
’’ 
$num
’’  !
)
’’! "
{
÷÷ 

totalPages
◊◊ 
+=
◊◊ !
$num
◊◊" #
;
◊◊# $
}
ÿÿ 
}
ŸŸ  
SqlParameterHelper
€€ 
sph
€€ "
=
€€# $
new
€€% ( 
SqlParameterHelper
€€) ;
(
€€; <
ConnectionString
€€< L
.
€€L M%
GetReadConnectionString
€€M d
(
€€d e
)
€€e f
,
€€f g
$str€€h ä
,€€ä ã
$num€€å ç
)€€ç é
;€€é è
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# .
,
‹‹. /
	SqlDbType
‹‹0 9
.
‹‹9 :
UniqueIdentifier
‹‹: J
,
‹‹J K 
ParameterDirection
‹‹L ^
.
‹‹^ _
Input
‹‹_ d
,
‹‹d e
siteGuid
‹‹f n
)
‹‹n o
;
‹‹o p
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# .
,
››. /
	SqlDbType
››0 9
.
››9 :
NVarChar
››: B
,
››B C
$num
››D G
,
››G H 
ParameterDirection
››I [
.
››[ \
Input
››\ a
,
››a b
skinName
››c k
)
››k l
;
››l m
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# 0
,
ﬁﬁ0 1
	SqlDbType
ﬁﬁ2 ;
.
ﬁﬁ; <
Int
ﬁﬁ< ?
,
ﬁﬁ? @ 
ParameterDirection
ﬁﬁA S
.
ﬁﬁS T
Input
ﬁﬁT Y
,
ﬁﬁY Z

pageNumber
ﬁﬁ[ e
)
ﬁﬁe f
;
ﬁﬁf g
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# .
,
ﬂﬂ. /
	SqlDbType
ﬂﬂ0 9
.
ﬂﬂ9 :
Int
ﬂﬂ: =
,
ﬂﬂ= > 
ParameterDirection
ﬂﬂ? Q
.
ﬂﬂQ R
Input
ﬂﬂR W
,
ﬂﬂW X
pageSize
ﬂﬂY a
)
ﬂﬂa b
;
ﬂﬂb c
return
‡‡ 
sph
‡‡ 
.
‡‡ 
ExecuteReader
‡‡ $
(
‡‡$ %
)
‡‡% &
;
‡‡& '
}
‚‚ 	
}
‰‰ 
}ÊÊ ∂â
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentTemplate )
{ 
public== 
static== 
int== 
Create==  
(==  !
Guid>> 
guid>> 
,>> 
Guid?? 
siteGuid?? 
,?? 
string@@ 
title@@ 
,@@ 
stringAA 
imageFileNameAA  
,AA  !
stringBB 
descriptionBB 
,BB 
stringCC 
bodyCC 
,CC 
stringDD 
allowedRolesDD 
,DD  
GuidEE 
createdByUserEE 
,EE 
DateTimeFF 

createdUtcFF 
)FF  
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi Ñ
,
HHÑ Ö
$num
HHÜ à
)
HHà â
;
HHâ ä
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
UniqueIdentifierJJ: J
,JJJ K
ParameterDirectionJJL ^
.JJ^ _
InputJJ_ d
,JJd e
siteGuidJJf n
)JJn o
;JJo p
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
$numKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
titleKK` e
)KKe f
;KKf g
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 3
,LL3 4
	SqlDbTypeLL5 >
.LL> ?
NVarCharLL? G
,LLG H
$numLLI L
,LLL M
ParameterDirectionLLN `
.LL` a
InputLLa f
,LLf g
imageFileNameLLh u
)LLu v
;LLv w
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 1
,MM1 2
	SqlDbTypeMM3 <
.MM< =
NVarCharMM= E
,MME F
-MMG H
$numMMH I
,MMI J
ParameterDirectionMMK ]
.MM] ^
InputMM^ c
,MMc d
descriptionMMe p
)MMp q
;MMq r
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
NVarCharNN6 >
,NN> ?
-NN@ A
$numNNA B
,NNB C
ParameterDirectionNND V
.NNV W
InputNNW \
,NN\ ]
bodyNN^ b
)NNb c
;NNc d
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
NVarCharOO> F
,OOF G
-OOH I
$numOOI J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
allowedRolesOOf r
)OOr s
;OOs t
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 3
,PP3 4
	SqlDbTypePP5 >
.PP> ?
UniqueIdentifierPP? O
,PPO P
ParameterDirectionPPQ c
.PPc d
InputPPd i
,PPi j
createdByUserPPk x
)PPx y
;PPy z
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
createdByUserQQi v
)QQv w
;QQw x
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
DateTimeRR< D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _

createdUtcRR` j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 0
,SS0 1
	SqlDbTypeSS2 ;
.SS; <
DateTimeSS< D
,SSD E
ParameterDirectionSSF X
.SSX Y
InputSSY ^
,SS^ _

createdUtcSS` j
)SSj k
;SSk l
intTT 
rowsAffectedTT 
=TT 
sphTT "
.TT" #
ExecuteNonQueryTT# 2
(TT2 3
)TT3 4
;TT4 5
returnUU 
rowsAffectedUU 
;UU  
}WW 	
publicgg 
staticgg 
boolgg 
Updategg !
(gg! "
Guidhh 
guidhh 
,hh 
Guidii 
siteGuidii 
,ii 
stringjj 
titlejj 
,jj 
stringkk 
imageFileNamekk  
,kk  !
stringll 
descriptionll 
,ll 
stringmm 
bodymm 
,mm 
stringnn 
allowedRolesnn 
,nn  
Guidoo 
lastModUseroo 
,oo 
DateTimepp 

lastModUtcpp 
)pp  
{qq 	
SqlParameterHelperrr 
sphrr "
=rr# $
newrr% (
SqlParameterHelperrr) ;
(rr; <
ConnectionStringrr< L
.rrL M$
GetWriteConnectionStringrrM e
(rre f
)rrf g
,rrg h
$str	rri Ñ
,
rrÑ Ö
$num
rrÜ á
)
rrá à
;
rrà â
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# *
,ss* +
	SqlDbTypess, 5
.ss5 6
UniqueIdentifierss6 F
,ssF G
ParameterDirectionssH Z
.ssZ [
Inputss[ `
,ss` a
guidssb f
)ssf g
;ssg h
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# .
,tt. /
	SqlDbTypett0 9
.tt9 :
UniqueIdentifiertt: J
,ttJ K
ParameterDirectionttL ^
.tt^ _
Inputtt_ d
,ttd e
siteGuidttf n
)ttn o
;tto p
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# +
,uu+ ,
	SqlDbTypeuu- 6
.uu6 7
NVarCharuu7 ?
,uu? @
$numuuA D
,uuD E
ParameterDirectionuuF X
.uuX Y
InputuuY ^
,uu^ _
titleuu` e
)uue f
;uuf g
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 3
,vv3 4
	SqlDbTypevv5 >
.vv> ?
NVarCharvv? G
,vvG H
$numvvI L
,vvL M
ParameterDirectionvvN `
.vv` a
Inputvva f
,vvf g
imageFileNamevvh u
)vvu v
;vvv w
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 1
,ww1 2
	SqlDbTypeww3 <
.ww< =
NVarCharww= E
,wwE F
-wwG H
$numwwH I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d
descriptionwwe p
)wwp q
;wwq r
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
NVarCharxx6 >
,xx> ?
-xx@ A
$numxxA B
,xxB C
ParameterDirectionxxD V
.xxV W
InputxxW \
,xx\ ]
bodyxx^ b
)xxb c
;xxc d
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 2
,yy2 3
	SqlDbTypeyy4 =
.yy= >
NVarCharyy> F
,yyF G
-yyH I
$numyyI J
,yyJ K
ParameterDirectionyyL ^
.yy^ _
Inputyy_ d
,yyd e
allowedRolesyyf r
)yyr s
;yys t
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
UniqueIdentifierzz= M
,zzM N
ParameterDirectionzzO a
.zza b
Inputzzb g
,zzg h
lastModUserzzi t
)zzt u
;zzu v
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 0
,{{0 1
	SqlDbType{{2 ;
.{{; <
DateTime{{< D
,{{D E
ParameterDirection{{F X
.{{X Y
Input{{Y ^
,{{^ _

lastModUtc{{` j
){{j k
;{{k l
int|| 
rowsAffected|| 
=|| 
sph|| "
.||" #
ExecuteNonQuery||# 2
(||2 3
)||3 4
;||4 5
return}} 
(}} 
rowsAffected}}  
>}}! "
$num}}# $
)}}$ %
;}}% &
} 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ 
Delete
ÜÜ !
(
ÜÜ! "
Guid
ÜÜ" &
guid
ÜÜ' +
)
ÜÜ+ ,
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M&
GetWriteConnectionString
ààM e
(
ààe f
)
ààf g
,
ààg h
$stràài Ñ
,ààÑ Ö
$numààÜ á
)ààá à
;ààà â
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# *
,
ââ* +
	SqlDbType
ââ, 5
.
ââ5 6
UniqueIdentifier
ââ6 F
,
ââF G 
ParameterDirection
ââH Z
.
ââZ [
Input
ââ[ `
,
ââ` a
guid
ââb f
)
ââf g
;
ââg h
int
ää 
rowsAffected
ää 
=
ää 
sph
ää "
.
ää" #
ExecuteNonQuery
ää# 2
(
ää2 3
)
ää3 4
;
ää4 5
return
ãã 
(
ãã 
rowsAffected
ãã  
>
ãã! "
$num
ãã# $
)
ãã$ %
;
ãã% &
}
çç 	
public
ìì 
static
ìì 
IDataReader
ìì !
GetOne
ìì" (
(
ìì( )
Guid
ìì) -
guid
ìì. 2
)
ìì2 3
{
îî 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M%
GetReadConnectionString
ïïM d
(
ïïd e
)
ïïe f
,
ïïf g
$strïïh Ü
,ïïÜ á
$numïïà â
)ïïâ ä
;ïïä ã
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# *
,
ññ* +
	SqlDbType
ññ, 5
.
ññ5 6
UniqueIdentifier
ññ6 F
,
ññF G 
ParameterDirection
ññH Z
.
ññZ [
Input
ññ[ `
,
ññ` a
guid
ññb f
)
ññf g
;
ññg h
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
ôô 	
public
ûû 
static
ûû 
int
ûû 
GetCount
ûû "
(
ûû" #
Guid
ûû# '
siteGuid
ûû( 0
)
ûû0 1
{
üü 	 
SqlParameterHelper
†† 
sph
†† "
=
††# $
new
††% ( 
SqlParameterHelper
††) ;
(
††; <
ConnectionString
††< L
.
††L M%
GetReadConnectionString
††M d
(
††d e
)
††e f
,
††f g
$str††h Ö
,††Ö Ü
$num††á à
)††à â
;††â ä
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# .
,
°°. /
	SqlDbType
°°0 9
.
°°9 :
UniqueIdentifier
°°: J
,
°°J K 
ParameterDirection
°°L ^
.
°°^ _
Input
°°_ d
,
°°d e
siteGuid
°°f n
)
°°n o
;
°°o p
return
¢¢ 
Convert
¢¢ 
.
¢¢ 
ToInt32
¢¢ "
(
¢¢" #
sph
¢¢# &
.
¢¢& '
ExecuteScalar
¢¢' 4
(
¢¢4 5
)
¢¢5 6
)
¢¢6 7
;
¢¢7 8
}
•• 	
public
™™ 
static
™™ 
IDataReader
™™ !
GetAll
™™" (
(
™™( )
Guid
™™) -
siteGuid
™™. 6
)
™™6 7
{
´´ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M%
GetReadConnectionString
¨¨M d
(
¨¨d e
)
¨¨e f
,
¨¨f g
$str¨¨h Ü
,¨¨Ü á
$num¨¨à â
)¨¨â ä
;¨¨ä ã
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# .
,
≠≠. /
	SqlDbType
≠≠0 9
.
≠≠9 :
UniqueIdentifier
≠≠: J
,
≠≠J K 
ParameterDirection
≠≠L ^
.
≠≠^ _
Input
≠≠_ d
,
≠≠d e
siteGuid
≠≠f n
)
≠≠n o
;
≠≠o p
return
ÆÆ 
sph
ÆÆ 
.
ÆÆ 
ExecuteReader
ÆÆ $
(
ÆÆ$ %
)
ÆÆ% &
;
ÆÆ& '
}
∞∞ 	
public
∏∏ 
static
∏∏ 
IDataReader
∏∏ !
GetPage
∏∏" )
(
∏∏) *
Guid
ππ 
siteGuid
ππ 
,
ππ 
int
∫∫ 

pageNumber
∫∫ 
,
∫∫ 
int
ªª 
pageSize
ªª 
,
ªª 
out
ºº 
int
ºº 

totalPages
ºº 
)
ºº 
{
ΩΩ 	

totalPages
ææ 
=
ææ 
$num
ææ 
;
ææ 
int
øø 
	totalRows
øø 
=
øø 
GetCount
øø $
(
øø$ %
siteGuid
øø% -
)
øø- .
;
øø. /
if
¡¡ 
(
¡¡ 
pageSize
¡¡ 
>
¡¡ 
$num
¡¡ 
)
¡¡ 

totalPages
¡¡ (
=
¡¡) *
	totalRows
¡¡+ 4
/
¡¡5 6
pageSize
¡¡7 ?
;
¡¡? @
if
√√ 
(
√√ 
	totalRows
√√ 
<=
√√ 
pageSize
√√ %
)
√√% &
{
ƒƒ 

totalPages
≈≈ 
=
≈≈ 
$num
≈≈ 
;
≈≈ 
}
∆∆ 
else
«« 
{
»» 
int
…… 
	remainder
…… 
;
…… 
Math
   
.
   
DivRem
   
(
   
	totalRows
   %
,
  % &
pageSize
  ' /
,
  / 0
out
  1 4
	remainder
  5 >
)
  > ?
;
  ? @
if
ÀÀ 
(
ÀÀ 
	remainder
ÀÀ 
>
ÀÀ 
$num
ÀÀ  !
)
ÀÀ! "
{
ÃÃ 

totalPages
ÕÕ 
+=
ÕÕ !
$num
ÕÕ" #
;
ÕÕ# $
}
ŒŒ 
}
œœ  
SqlParameterHelper
—— 
sph
—— "
=
——# $
new
——% ( 
SqlParameterHelper
——) ;
(
——; <
ConnectionString
——< L
.
——L M%
GetReadConnectionString
——M d
(
——d e
)
——e f
,
——f g
$str——h á
,——á à
$num——â ä
)——ä ã
;——ã å
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# .
,
““. /
	SqlDbType
““0 9
.
““9 :
UniqueIdentifier
““: J
,
““J K 
ParameterDirection
““L ^
.
““^ _
Input
““_ d
,
““d e
siteGuid
““f n
)
““n o
;
““o p
sph
”” 
.
””  
DefineSqlParameter
”” "
(
””" #
$str
””# 0
,
””0 1
	SqlDbType
””2 ;
.
””; <
Int
””< ?
,
””? @ 
ParameterDirection
””A S
.
””S T
Input
””T Y
,
””Y Z

pageNumber
””[ e
)
””e f
;
””f g
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# .
,
‘‘. /
	SqlDbType
‘‘0 9
.
‘‘9 :
Int
‘‘: =
,
‘‘= > 
ParameterDirection
‘‘? Q
.
‘‘Q R
Input
‘‘R W
,
‘‘W X
pageSize
‘‘Y a
)
‘‘a b
;
‘‘b c
return
’’ 
sph
’’ 
.
’’ 
ExecuteReader
’’ $
(
’’$ %
)
’’% &
;
’’& '
}
◊◊ 	
}
ŸŸ 
}€€ °Ï
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentWorkflow.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentWorkflow )
{ 
public&& 
static&& 
int&& 
Create&&  
(&&  !
Guid'' 
guid'' 
,'' 
Guid(( 
siteGuid(( 
,(( 
Guid)) 

moduleGuid)) 
,)) 
Guid** 
userGuid** 
,** 
DateTime++ 
createdDateUtc++ #
,++# $
string,, 
contentText,, 
,,, 
string-- 

customData-- 
,-- 
int.. !
customReferenceNumber.. %
,..% &
Guid// 
customReferenceGuid// $
,//$ %
string00 
status00 
)00 
{11 	
SqlParameterHelper22 
sph22 "
=22# $
new22% (
SqlParameterHelper22) ;
(22; <
ConnectionString22< L
.22L M$
GetWriteConnectionString22M e
(22e f
)22f g
,22g h
$str	22i Ñ
,
22Ñ Ö
$num
22Ü à
)
22à â
;
22â ä
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# *
,33* +
	SqlDbType33, 5
.335 6
UniqueIdentifier336 F
,33F G
ParameterDirection33H Z
.33Z [
Input33[ `
,33` a
guid33b f
)33f g
;33g h
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
UniqueIdentifier44: J
,44J K
ParameterDirection44L ^
.44^ _
Input44_ d
,44d e
siteGuid44f n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 0
,550 1
	SqlDbType552 ;
.55; <
UniqueIdentifier55< L
,55L M
ParameterDirection55N `
.55` a
Input55a f
,55f g

moduleGuid55h r
)55r s
;55s t
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 4
,664 5
	SqlDbType666 ?
.66? @
DateTime66@ H
,66H I
ParameterDirection66J \
.66\ ]
Input66] b
,66b c
createdDateUtc66d r
)66r s
;66s t
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
UniqueIdentifier77: J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
userGuid77f n
)77n o
;77o p
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# ,
,88, -
	SqlDbType88. 7
.887 8
NVarChar888 @
,88@ A
$num88B D
,88D E
ParameterDirection88F X
.88X Y
Input88Y ^
,88^ _
status88` f
)88f g
;88g h
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# 1
,991 2
	SqlDbType993 <
.99< =
NVarChar99= E
,99E F
-99G H
$num99H I
,99I J
ParameterDirection99K ]
.99] ^
Input99^ c
,99c d
contentText99e p
)99p q
;99q r
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
NVarChar::< D
,::D E
-::F G
$num::G H
,::H I
ParameterDirection::J \
.::\ ]
Input::] b
,::b c

customData::d n
)::n o
;::o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# ;
,==; <
	SqlDbType=== F
.==F G
Int==G J
,==J K
ParameterDirection==L ^
.==^ _
Input==_ d
,==d e!
customReferenceNumber==f {
)=={ |
;==| }
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 9
,@@9 :
	SqlDbType@@; D
.@@D E
UniqueIdentifier@@E U
,@@U V
ParameterDirection@@W i
.@@i j
Input@@j o
,@@o p 
customReferenceGuid	@@q Ñ
)
@@Ñ Ö
;
@@Ö Ü
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
rowsAffectedCC 
;CC  
}DD 	
publicRR 
staticRR 
intRR 
UpdateRR  
(RR  !
GuidSS 
guidSS 
,SS 
GuidTT 
lastModUserGuidTT  
,TT  !
DateTimeUU 

lastModUtcUU 
,UU  
stringVV 
contentTextVV 
,VV 
stringWW 

customDataWW 
,WW 
intXX !
customReferenceNumberXX %
,XX% &
GuidYY 
customReferenceGuidYY $
,YY$ %
stringZZ 
statusZZ 
)ZZ 
{[[ 	
SqlParameterHelper\\ 
sph\\ "
=\\# $
new\\% (
SqlParameterHelper\\) ;
(\\; <
ConnectionString\\< L
.\\L M$
GetWriteConnectionString\\M e
(\\e f
)\\f g
,\\g h
$str	\\i Ñ
,
\\Ñ Ö
$num
\\Ü á
)
\\á à
;
\\à â
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
UniqueIdentifier]]6 F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
guid]]b f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 5
,^^5 6
	SqlDbType^^7 @
.^^@ A
UniqueIdentifier^^A Q
,^^Q R
ParameterDirection^^S e
.^^e f
Input^^f k
,^^k l
lastModUserGuid^^m |
)^^| }
;^^} ~
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 0
,__0 1
	SqlDbType__2 ;
.__; <
DateTime__< D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _

lastModUtc__` j
)__j k
;__k l
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# ,
,``, -
	SqlDbType``. 7
.``7 8
NVarChar``8 @
,``@ A
$num``B D
,``D E
ParameterDirection``F X
.``X Y
Input``Y ^
,``^ _
status``` f
)``f g
;``g h
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 1
,aa1 2
	SqlDbTypeaa3 <
.aa< =
NVarCharaa= E
,aaE F
-aaG H
$numaaH I
,aaI J
ParameterDirectionaaK ]
.aa] ^
Inputaa^ c
,aac d
contentTextaae p
)aap q
;aaq r
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
-bbF G
$numbbG H
,bbH I
ParameterDirectionbbJ \
.bb\ ]
Inputbb] b
,bbb c

customDatabbd n
)bbn o
;bbo p
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ;
,ee; <
	SqlDbTypeee= F
.eeF G
InteeG J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e!
customReferenceNumbereef {
)ee{ |
;ee| }
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 9
,hh9 :
	SqlDbTypehh; D
.hhD E
UniqueIdentifierhhE U
,hhU V
ParameterDirectionhhW i
.hhi j
Inputhhj o
,hho p 
customReferenceGuid	hhq Ñ
)
hhÑ Ö
;
hhÖ Ü
intjj 
rowsAffectedjj 
=jj 
sphjj "
.jj" #
ExecuteNonQueryjj# 2
(jj2 3
)jj3 4
;jj4 5
returnkk 
rowsAffectedkk 
;kk  
}ll 	
publicuu 
staticuu 
booluu 
DeleteByModuleuu )
(uu) *
Guiduu* .

moduleGuiduu/ 9
)uu9 :
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi å
,
wwå ç
$num
wwé è
)
wwè ê
;
wwê ë
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 0
,xx0 1
	SqlDbTypexx2 ;
.xx; <
UniqueIdentifierxx< L
,xxL M
ParameterDirectionxxN `
.xx` a
Inputxxa f
,xxf g

moduleGuidxxh r
)xxr s
;xxs t
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
ÉÉ 
static
ÉÉ 
bool
ÉÉ 
DeleteBySite
ÉÉ '
(
ÉÉ' (
Guid
ÉÉ( ,
siteGuid
ÉÉ- 5
)
ÉÉ5 6
{
ÑÑ 	 
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M&
GetWriteConnectionString
ÖÖM e
(
ÖÖe f
)
ÖÖf g
,
ÖÖg h
$strÖÖi ä
,ÖÖä ã
$numÖÖå ç
)ÖÖç é
;ÖÖé è
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
UniqueIdentifier
ÜÜ: J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
siteGuid
ÜÜf n
)
ÜÜn o
;
ÜÜo p
int
áá 
rowsAffected
áá 
=
áá 
sph
áá "
.
áá" #
ExecuteNonQuery
áá# 2
(
áá2 3
)
áá3 4
;
áá4 5
return
àà 
(
àà 
rowsAffected
àà  
>
àà! "
$num
àà# $
)
àà$ %
;
àà% &
}
ää 	
public
òò 
static
òò 
IDataReader
òò !
GetWorkInProgress
òò" 3
(
òò3 4
Guid
òò4 8

moduleGuid
òò9 C
)
òòC D
{
ôô 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M%
GetReadConnectionString
ööM d
(
ööd e
)
ööe f
,
ööf g
$strööh ë
,ööë í
$numööì î
)ööî ï
;ööï ñ
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 0
,
õõ0 1
	SqlDbType
õõ2 ;
.
õõ; <
UniqueIdentifier
õõ< L
,
õõL M 
ParameterDirection
õõN `
.
õõ` a
Input
õõa f
,
õõf g

moduleGuid
õõh r
)
õõr s
;
õõs t
return
úú 
sph
úú 
.
úú 
ExecuteReader
úú $
(
úú$ %
)
úú% &
;
úú& '
}
ùù 	
public
üü 
static
üü 
IDataReader
üü !
GetWorkInProgress
üü" 3
(
üü3 4
Guid
üü4 8

moduleGuid
üü9 C
,
üüC D
string
üüE K
status
üüL R
)
üüR S
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h ô
,°°ô ö
$num°°õ ú
)°°ú ù
;°°ù û
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 0
,
¢¢0 1
	SqlDbType
¢¢2 ;
.
¢¢; <
UniqueIdentifier
¢¢< L
,
¢¢L M 
ParameterDirection
¢¢N `
.
¢¢` a
Input
¢¢a f
,
¢¢f g

moduleGuid
¢¢h r
)
¢¢r s
;
¢¢s t
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# ,
,
££, -
	SqlDbType
££. 7
.
££7 8
NVarChar
££8 @
,
££@ A
$num
££B D
,
££D E 
ParameterDirection
££F X
.
££X Y
Input
££Y ^
,
££^ _
status
££` f
)
££f g
;
££g h
return
§§ 
sph
§§ 
.
§§ 
ExecuteReader
§§ $
(
§§$ %
)
§§% &
;
§§& '
}
•• 	
public
ßß 
static
ßß 
int
ßß *
GetWorkInProgressCountByPage
ßß 6
(
ßß6 7
Guid
ßß7 ;
pageGuid
ßß< D
)
ßßD E
{
®® 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M%
GetReadConnectionString
©©M d
(
©©d e
)
©©e f
,
©©f g
$str©©h ï
,©©ï ñ
$num©©ó ò
)©©ò ô
;©©ô ö
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# .
,
™™. /
	SqlDbType
™™0 9
.
™™9 :
UniqueIdentifier
™™: J
,
™™J K 
ParameterDirection
™™L ^
.
™™^ _
Input
™™_ d
,
™™d e
pageGuid
™™f n
)
™™n o
;
™™o p
return
´´ 
Convert
´´ 
.
´´ 
ToInt32
´´ "
(
´´" #
sph
´´# &
.
´´& '
ExecuteScalar
´´' 4
(
´´4 5
)
´´5 6
)
´´6 7
;
´´7 8
}
¨¨ 	
public
ÆÆ 
static
ÆÆ 
int
ÆÆ 
GetCount
ÆÆ "
(
ÆÆ" #
Guid
ÆÆ# '
siteGuid
ÆÆ( 0
,
ÆÆ0 1
string
ÆÆ2 8
status
ÆÆ9 ?
)
ÆÆ? @
{
ØØ 	 
SqlParameterHelper
∞∞ 
sph
∞∞ "
=
∞∞# $
new
∞∞% ( 
SqlParameterHelper
∞∞) ;
(
∞∞; <
ConnectionString
∞∞< L
.
∞∞L M%
GetReadConnectionString
∞∞M d
(
∞∞d e
)
∞∞e f
,
∞∞f g
$str∞∞h Ö
,∞∞Ö Ü
$num∞∞á à
)∞∞à â
;∞∞â ä
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
UniqueIdentifier
±±: J
,
±±J K 
ParameterDirection
±±L ^
.
±±^ _
Input
±±_ d
,
±±d e
siteGuid
±±f n
)
±±n o
;
±±o p
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# ,
,
≤≤, -
	SqlDbType
≤≤. 7
.
≤≤7 8
NVarChar
≤≤8 @
,
≤≤@ A 
ParameterDirection
≤≤B T
.
≤≤T U
Input
≤≤U Z
,
≤≤Z [
status
≤≤\ b
)
≤≤b c
;
≤≤c d
return
≥≥ 
Convert
≥≥ 
.
≥≥ 
ToInt32
≥≥ "
(
≥≥" #
sph
≥≥# &
.
≥≥& '
ExecuteScalar
≥≥' 4
(
≥≥4 5
)
≥≥5 6
)
≥≥6 7
;
≥≥7 8
}
¥¥ 	
public
∂∂ 
static
∂∂ 
Guid
∂∂ 
GetDraftSubmitter
∂∂ ,
(
∂∂, -
Guid
∂∂- 1!
contentWorkflowGuid
∂∂2 E
)
∂∂E F
{
∑∑ 	
Guid
∏∏ 
result
∏∏ 
=
∏∏ 
Guid
∏∏ 
.
∏∏ 
Empty
∏∏ $
;
∏∏$ % 
SqlParameterHelper
ππ 
sph
ππ "
=
ππ# $
new
ππ% ( 
SqlParameterHelper
ππ) ;
(
ππ; <
ConnectionString
ππ< L
.
ππL M%
GetReadConnectionString
ππM d
(
ππd e
)
ππe f
,
ππf g
$strππh ö
,ππö õ
$numππú ù
)ππù û
;ππû ü
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# 9
,
∫∫9 :
	SqlDbType
∫∫; D
.
∫∫D E
UniqueIdentifier
∫∫E U
,
∫∫U V 
ParameterDirection
∫∫W i
.
∫∫i j
Input
∫∫j o
,
∫∫o p"
contentWorkflowGuid∫∫q Ñ
)∫∫Ñ Ö
;∫∫Ö Ü
using
ªª 
(
ªª 
IDataReader
ªª 
reader
ªª %
=
ªª& '
sph
ªª( +
.
ªª+ ,
ExecuteReader
ªª, 9
(
ªª9 :
)
ªª: ;
)
ªª; <
{
ºº 
if
ΩΩ 
(
ΩΩ 
reader
ΩΩ 
.
ΩΩ 
Read
ΩΩ 
(
ΩΩ  
)
ΩΩ  !
)
ΩΩ! "
{
ææ 
result
øø 
=
øø 
new
øø  
Guid
øø! %
(
øø% &
reader
øø& ,
[
øø, -
$num
øø- .
]
øø. /
.
øø/ 0
ToString
øø0 8
(
øø8 9
)
øø9 :
)
øø: ;
;
øø; <
}
¿¿ 
}
¡¡ 
return
√√ 
result
√√ 
;
√√ 
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
IDataReader
∆∆ !
GetPage
∆∆" )
(
∆∆) *
Guid
«« 
siteGuid
«« 
,
«« 
string
»» 
status
»» 
,
»» 
int
…… 

pageNumber
…… 
,
…… 
int
   
pageSize
   
,
   
out
ÀÀ 
int
ÀÀ 

totalPages
ÀÀ 
)
ÀÀ 
{
ÃÃ 	

totalPages
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
;
ÕÕ 
int
ŒŒ 
	totalRows
ŒŒ 
=
ŒŒ 
GetCount
ŒŒ $
(
ŒŒ$ %
siteGuid
ŒŒ% -
,
ŒŒ- .
status
ŒŒ/ 5
)
ŒŒ5 6
;
ŒŒ6 7
if
–– 
(
–– 
pageSize
–– 
>
–– 
$num
–– 
)
–– 

totalPages
–– (
=
––) *
	totalRows
––+ 4
/
––5 6
pageSize
––7 ?
;
––? @
if
““ 
(
““ 
	totalRows
““ 
<=
““ 
pageSize
““ %
)
““% &
{
”” 

totalPages
‘‘ 
=
‘‘ 
$num
‘‘ 
;
‘‘ 
}
’’ 
else
÷÷ 
{
◊◊ 
int
ÿÿ 
	remainder
ÿÿ 
;
ÿÿ 
Math
ŸŸ 
.
ŸŸ 
DivRem
ŸŸ 
(
ŸŸ 
	totalRows
ŸŸ %
,
ŸŸ% &
pageSize
ŸŸ' /
,
ŸŸ/ 0
out
ŸŸ1 4
	remainder
ŸŸ5 >
)
ŸŸ> ?
;
ŸŸ? @
if
⁄⁄ 
(
⁄⁄ 
	remainder
⁄⁄ 
>
⁄⁄ 
$num
⁄⁄  !
)
⁄⁄! "
{
€€ 

totalPages
‹‹ 
+=
‹‹ !
$num
‹‹" #
;
‹‹# $
}
›› 
}
ﬁﬁ  
SqlParameterHelper
‡‡ 
sph
‡‡ "
=
‡‡# $
new
‡‡% ( 
SqlParameterHelper
‡‡) ;
(
‡‡; <
ConnectionString
‡‡< L
.
‡‡L M%
GetReadConnectionString
‡‡M d
(
‡‡d e
)
‡‡e f
,
‡‡f g
$str‡‡h á
,‡‡á à
$num‡‡â ä
)‡‡ä ã
;‡‡ã å
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# .
,
··. /
	SqlDbType
··0 9
.
··9 :
UniqueIdentifier
··: J
,
··J K 
ParameterDirection
··L ^
.
··^ _
Input
··_ d
,
··d e
siteGuid
··f n
)
··n o
;
··o p
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ "
(
‚‚" #
$str
‚‚# ,
,
‚‚, -
	SqlDbType
‚‚. 7
.
‚‚7 8
NVarChar
‚‚8 @
,
‚‚@ A 
ParameterDirection
‚‚B T
.
‚‚T U
Input
‚‚U Z
,
‚‚Z [
status
‚‚\ b
)
‚‚b c
;
‚‚c d
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# 0
,
„„0 1
	SqlDbType
„„2 ;
.
„„; <
Int
„„< ?
,
„„? @ 
ParameterDirection
„„A S
.
„„S T
Input
„„T Y
,
„„Y Z

pageNumber
„„[ e
)
„„e f
;
„„f g
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# .
,
‰‰. /
	SqlDbType
‰‰0 9
.
‰‰9 :
Int
‰‰: =
,
‰‰= > 
ParameterDirection
‰‰? Q
.
‰‰Q R
Input
‰‰R W
,
‰‰W X
pageSize
‰‰Y a
)
‰‰a b
;
‰‰b c
return
ÂÂ 
sph
ÂÂ 
.
ÂÂ 
ExecuteReader
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÊÊ 	
public
ËË 
static
ËË 
IDataReader
ËË ! 
GetPageInfoForPage
ËË" 4
(
ËË4 5
Guid
ÈÈ 
siteGuid
ÈÈ 
,
ÈÈ 
string
ÍÍ 
status
ÍÍ 
,
ÍÍ 
int
ÎÎ 

pageNumber
ÎÎ 
,
ÎÎ 
int
ÏÏ 
pageSize
ÏÏ 
)
ÏÏ 
{
ÌÌ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh í
,ÔÔí ì
$numÔÔî ï
)ÔÔï ñ
;ÔÔñ ó
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# ,
,
ÒÒ, -
	SqlDbType
ÒÒ. 7
.
ÒÒ7 8
NVarChar
ÒÒ8 @
,
ÒÒ@ A 
ParameterDirection
ÒÒB T
.
ÒÒT U
Input
ÒÒU Z
,
ÒÒZ [
status
ÒÒ\ b
)
ÒÒb c
;
ÒÒc d
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 0
,
ÚÚ0 1
	SqlDbType
ÚÚ2 ;
.
ÚÚ; <
Int
ÚÚ< ?
,
ÚÚ? @ 
ParameterDirection
ÚÚA S
.
ÚÚS T
Input
ÚÚT Y
,
ÚÚY Z

pageNumber
ÚÚ[ e
)
ÚÚe f
;
ÚÚf g
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# .
,
ÛÛ. /
	SqlDbType
ÛÛ0 9
.
ÛÛ9 :
Int
ÛÛ: =
,
ÛÛ= > 
ParameterDirection
ÛÛ? Q
.
ÛÛQ R
Input
ÛÛR W
,
ÛÛW X
pageSize
ÛÛY a
)
ÛÛa b
;
ÛÛb c
return
ÙÙ 
sph
ÙÙ 
.
ÙÙ 
ExecuteReader
ÙÙ $
(
ÙÙ$ %
)
ÙÙ% &
;
ÙÙ& '
}
ıı 	
public
¯¯ 
static
¯¯ 
int
¯¯  
CreateAuditHistory
¯¯ ,
(
¯¯, -
Guid
˘˘ 
guid
˘˘ 
,
˘˘ 
Guid
˙˙ 
workflowGuid
˙˙ 
,
˙˙ 
Guid
˚˚ 

moduleGuid
˚˚ 
,
˚˚ 
Guid
¸¸ 
userGuid
¸¸ 
,
¸¸ 
DateTime
˝˝ 
createdDateUtc
˝˝ #
,
˝˝# $
string
˛˛ 
status
˛˛ 
,
˛˛ 
string
ˇˇ 
notes
ˇˇ 
,
ˇˇ 
bool
ÄÄ 
active
ÄÄ 
)
ÄÄ 
{
ÅÅ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M&
GetWriteConnectionString
ÇÇM e
(
ÇÇe f
)
ÇÇf g
,
ÇÇg h
$strÇÇi ê
,ÇÇê ë
$numÇÇí ì
)ÇÇì î
;ÇÇî ï
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# *
,
ÉÉ* +
	SqlDbType
ÉÉ, 5
.
ÉÉ5 6
UniqueIdentifier
ÉÉ6 F
,
ÉÉF G 
ParameterDirection
ÉÉH Z
.
ÉÉZ [
Input
ÉÉ[ `
,
ÉÉ` a
guid
ÉÉb f
)
ÉÉf g
;
ÉÉg h
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 9
,
ÑÑ9 :
	SqlDbType
ÑÑ; D
.
ÑÑD E
UniqueIdentifier
ÑÑE U
,
ÑÑU V 
ParameterDirection
ÑÑW i
.
ÑÑi j
Input
ÑÑj o
,
ÑÑo p
workflowGuid
ÑÑq }
)
ÑÑ} ~
;
ÑÑ~ 
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 0
,
ÖÖ0 1
	SqlDbType
ÖÖ2 ;
.
ÖÖ; <
UniqueIdentifier
ÖÖ< L
,
ÖÖL M 
ParameterDirection
ÖÖN `
.
ÖÖ` a
Input
ÖÖa f
,
ÖÖf g

moduleGuid
ÖÖh r
)
ÖÖr s
;
ÖÖs t
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
UniqueIdentifier
ÜÜ: J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
userGuid
ÜÜf n
)
ÜÜn o
;
ÜÜo p
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 4
,
áá4 5
	SqlDbType
áá6 ?
.
áá? @
DateTime
áá@ H
,
ááH I 
ParameterDirection
ááJ \
.
áá\ ]
Input
áá] b
,
ááb c
createdDateUtc
áád r
)
áár s
;
áás t
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# ,
,
àà, -
	SqlDbType
àà. 7
.
àà7 8
NVarChar
àà8 @
,
àà@ A
$num
ààB D
,
ààD E 
ParameterDirection
ààF X
.
ààX Y
Input
ààY ^
,
àà^ _
status
àà` f
)
ààf g
;
ààg h
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# +
,
ââ+ ,
	SqlDbType
ââ- 6
.
ââ6 7
NVarChar
ââ7 ?
,
ââ? @
-
ââA B
$num
ââB C
,
ââC D 
ParameterDirection
ââE W
.
ââW X
Input
ââX ]
,
ââ] ^
notes
ââ_ d
)
ââd e
;
ââe f
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# ,
,
ää, -
	SqlDbType
ää. 7
.
ää7 8
Bit
ää8 ;
,
ää; < 
ParameterDirection
ää= O
.
ääO P
Input
ääP U
,
ääU V
active
ääW ]
)
ää] ^
;
ää^ _
int
çç 
rowsAffected
çç 
=
çç 
sph
çç "
.
çç" #
ExecuteNonQuery
çç# 2
(
çç2 3
)
çç3 4
;
çç4 5
return
éé 
rowsAffected
éé 
;
éé  
}
èè 	
public
ëë 
static
ëë 
bool
ëë 
DeactivateAudit
ëë *
(
ëë* +
Guid
ëë+ /

moduleGuid
ëë0 :
)
ëë: ;
{
íí 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M&
GetWriteConnectionString
ììM e
(
ììe f
)
ììf g
,
ììg h
$strììi î
,ììî ï
$numììñ ó
)ììó ò
;ììò ô
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 0
,
îî0 1
	SqlDbType
îî2 ;
.
îî; <
UniqueIdentifier
îî< L
,
îîL M 
ParameterDirection
îîN `
.
îî` a
Input
îîa f
,
îîf g

moduleGuid
îîh r
)
îîr s
;
îîs t
int
ññ 
rowsAffected
ññ 
=
ññ 
sph
ññ "
.
ññ" #
ExecuteNonQuery
ññ# 2
(
ññ2 3
)
ññ3 4
;
ññ4 5
return
óó 
(
óó 
rowsAffected
óó  
>
óó! "
$num
óó# $
)
óó$ %
;
óó% &
}
òò 	
}
õõ 
}ùù Îf
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCurrency.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBCurrency "
{ 
public:: 
static:: 
int:: 
Create::  
(::  !
Guid;; 
guid;; 
,;; 
string<< 
title<< 
,<< 
string== 
code== 
,== 
string>> 

symbolLeft>> 
,>> 
string?? 
symbolRight?? 
,?? 
string@@ 
decimalPointChar@@ #
,@@# $
stringAA 
thousandsPointCharAA %
,AA% &
stringBB 
decimalPlacesBB  
,BB  !
decimalCC 
valueCC 
,CC 
DateTimeDD 
lastModifiedDD !
,DD! "
DateTimeEE 
createdEE 
)EE 
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi }
,GG} ~
$num	GG Å
)
GGÅ Ç
;
GGÇ É
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
UniqueIdentifierHH6 F
,HHF G
ParameterDirectionHHH Z
.HHZ [
InputHH[ `
,HH` a
guidHHb f
)HHf g
;HHg h
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# +
,II+ ,
	SqlDbTypeII- 6
.II6 7
NVarCharII7 ?
,II? @
$numIIA C
,IIC D
ParameterDirectionIIE W
.IIW X
InputIIX ]
,II] ^
titleII_ d
)IId e
;IIe f
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
NCharJJ6 ;
,JJ; <
$numJJ= >
,JJ> ?
ParameterDirectionJJ@ R
.JJR S
InputJJS X
,JJX Y
codeJJZ ^
)JJ^ _
;JJ_ `
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 0
,KK0 1
	SqlDbTypeKK2 ;
.KK; <
NVarCharKK< D
,KKD E
$numKKF H
,KKH I
ParameterDirectionKKJ \
.KK\ ]
InputKK] b
,KKb c

symbolLeftKKd n
)KKn o
;KKo p
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
$numLLG I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
symbolRightLLe p
)LLp q
;LLq r
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 6
,MM6 7
	SqlDbTypeMM8 A
.MMA B
NCharMMB G
,MMG H
$numMMI J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
decimalPointCharMMf v
)MMv w
;MMw x
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 8
,NN8 9
	SqlDbTypeNN: C
.NNC D
NCharNND I
,NNI J
$numNNK L
,NNL M
ParameterDirectionNNN `
.NN` a
InputNNa f
,NNf g
thousandsPointCharNNh z
)NNz {
;NN{ |
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 3
,OO3 4
	SqlDbTypeOO5 >
.OO> ?
NCharOO? D
,OOD E
$numOOF G
,OOG H
ParameterDirectionOOI [
.OO[ \
InputOO\ a
,OOa b
decimalPlacesOOc p
)OOp q
;OOq r
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# +
,PP+ ,
	SqlDbTypePP- 6
.PP6 7
DecimalPP7 >
,PP> ?
ParameterDirectionPP@ R
.PPR S
InputPPS X
,PPX Y
valuePPZ _
)PP_ `
;PP` a
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 2
,QQ2 3
	SqlDbTypeQQ4 =
.QQ= >
DateTimeQQ> F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
lastModifiedQQb n
)QQn o
;QQo p
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# -
,RR- .
	SqlDbTypeRR/ 8
.RR8 9
DateTimeRR9 A
,RRA B
ParameterDirectionRRC U
.RRU V
InputRRV [
,RR[ \
createdRR] d
)RRd e
;RRe f
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
rowsAffectedTT 
;TT  
}VV 	
publicii 
staticii 
boolii 
Updateii !
(ii! "
Guidjj 
guidjj 
,jj 
stringkk 
titlekk 
,kk 
stringll 
codell 
,ll 
stringmm 

symbolLeftmm 
,mm 
stringnn 
symbolRightnn 
,nn 
stringoo 
decimalPointCharoo #
,oo# $
stringpp 
thousandsPointCharpp %
,pp% &
stringqq 
decimalPlacesqq  
,qq  !
decimalrr 
valuerr 
,rr 
DateTimess 
lastModifiedss !
)ss! "
{tt 	
SqlParameterHelperuu 
sphuu "
=uu# $
newuu% (
SqlParameterHelperuu) ;
(uu; <
ConnectionStringuu< L
.uuL M$
GetWriteConnectionStringuuM e
(uue f
)uuf g
,uug h
$struui }
,uu} ~
$num	uu Å
)
uuÅ Ç
;
uuÇ É
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# *
,vv* +
	SqlDbTypevv, 5
.vv5 6
UniqueIdentifiervv6 F
,vvF G
ParameterDirectionvvH Z
.vvZ [
Inputvv[ `
,vv` a
guidvvb f
)vvf g
;vvg h
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# +
,ww+ ,
	SqlDbTypeww- 6
.ww6 7
NVarCharww7 ?
,ww? @
$numwwA C
,wwC D
ParameterDirectionwwE W
.wwW X
InputwwX ]
,ww] ^
titleww_ d
)wwd e
;wwe f
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
NCharxx6 ;
,xx; <
$numxx= >
,xx> ?
ParameterDirectionxx@ R
.xxR S
InputxxS X
,xxX Y
codexxZ ^
)xx^ _
;xx_ `
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 0
,yy0 1
	SqlDbTypeyy2 ;
.yy; <
NVarCharyy< D
,yyD E
$numyyF H
,yyH I
ParameterDirectionyyJ \
.yy\ ]
Inputyy] b
,yyb c

symbolLeftyyd n
)yyn o
;yyo p
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
NVarCharzz= E
,zzE F
$numzzG I
,zzI J
ParameterDirectionzzK ]
.zz] ^
Inputzz^ c
,zzc d
symbolRightzze p
)zzp q
;zzq r
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 6
,{{6 7
	SqlDbType{{8 A
.{{A B
NChar{{B G
,{{G H
$num{{I J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
decimalPointChar{{f v
){{v w
;{{w x
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 8
,||8 9
	SqlDbType||: C
.||C D
NChar||D I
,||I J
$num||K L
,||L M
ParameterDirection||N `
.||` a
Input||a f
,||f g
thousandsPointChar||h z
)||z {
;||{ |
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
NChar}}? D
,}}D E
$num}}F G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
decimalPlaces}}c p
)}}p q
;}}q r
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# +
,~~+ ,
	SqlDbType~~- 6
.~~6 7
Decimal~~7 >
,~~> ?
ParameterDirection~~@ R
.~~R S
Input~~S X
,~~X Y
value~~Z _
)~~_ `
;~~` a
sph 
. 
DefineSqlParameter "
(" #
$str# 2
,2 3
	SqlDbType4 =
.= >
DateTime> F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
lastModifiedb n
)n o
;o p
int
ÄÄ 
rowsAffected
ÄÄ 
=
ÄÄ 
sph
ÄÄ "
.
ÄÄ" #
ExecuteNonQuery
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
return
ÅÅ 
(
ÅÅ 
rowsAffected
ÅÅ  
>
ÅÅ! "
$num
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÉÉ 	
public
ää 
static
ää 
bool
ää 
Delete
ää !
(
ää! "
Guid
ää" &
guid
ää' +
)
ää+ ,
{
ãã 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M&
GetWriteConnectionString
ååM e
(
ååe f
)
ååf g
,
ååg h
$str
ååi }
,
åå} ~
$numåå Ä
)ååÄ Å
;ååÅ Ç
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# *
,
çç* +
	SqlDbType
çç, 5
.
çç5 6
UniqueIdentifier
çç6 F
,
ççF G 
ParameterDirection
ççH Z
.
ççZ [
Input
çç[ `
,
çç` a
guid
ççb f
)
ççf g
;
ççg h
int
éé 
rowsAffected
éé 
=
éé 
sph
éé "
.
éé" #
ExecuteNonQuery
éé# 2
(
éé2 3
)
éé3 4
;
éé4 5
return
èè 
(
èè 
rowsAffected
èè  
>
èè! "
$num
èè# $
)
èè$ %
;
èè% &
}
ëë 	
public
óó 
static
óó 
IDataReader
óó !
GetOne
óó" (
(
óó( )
Guid
óó) -
guid
óó. 2
)
óó2 3
{
òò 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M%
GetReadConnectionString
ôôM d
(
ôôd e
)
ôôe f
,
ôôf g
$str
ôôh 
,ôô Ä
$numôôÅ Ç
)ôôÇ É
;ôôÉ Ñ
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# *
,
öö* +
	SqlDbType
öö, 5
.
öö5 6
UniqueIdentifier
öö6 F
,
ööF G 
ParameterDirection
ööH Z
.
ööZ [
Input
öö[ `
,
öö` a
guid
ööb f
)
ööf g
;
öög h
return
õõ 
sph
õõ 
.
õõ 
ExecuteReader
õõ $
(
õõ$ %
)
õõ% &
;
õõ& '
}
ùù 	
public
§§ 
static
§§ 
IDataReader
§§ !
GetAll
§§" (
(
§§( )
)
§§) *
{
•• 	
return
ßß 
	SqlHelper
ßß 
.
ßß 
ExecuteReader
ßß *
(
ßß* +
ConnectionString
®®  
.
®®  !%
GetReadConnectionString
®®! 8
(
®®8 9
)
®®9 :
,
®®: ;
CommandType
©© 
.
©© 
StoredProcedure
©© +
,
©©+ ,
$str
™™ '
,
™™' (
null
´´ 
)
´´ 
;
´´ 
}
≠≠ 	
}
±± 
}≤≤ ÔU
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailSendLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailSendLog &
{ 
publicHH 
staticHH 
voidHH 
CreateHH !
(HH! "
GuidII 
guidII 
,II 
GuidJJ 
siteGuidJJ 
,JJ 
GuidKK 

moduleGuidKK 
,KK 
GuidLL 
specialGuid1LL 
,LL 
GuidMM 
specialGuid2MM 
,MM 
stringNN 
	toAddressNN 
,NN 
stringOO 
	ccAddressOO 
,OO 
stringPP 

bccAddressPP 
,PP 
stringQQ 
subjectQQ 
,QQ 
stringRR 
textBodyRR 
,RR 
stringSS 
htmlBodySS 
,SS 
stringTT 
typeTT 
,TT 
DateTimeUU 
sentUtcUU 
,UU 
stringVV 
fromAddressVV 
,VV 
stringWW 
replyToWW 
,WW 
GuidXX 
userGuidXX 
)XX 
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M$
GetWriteConnectionStringZZM e
(ZZe f
)ZZf g
,ZZg h
$str	ZZi Å
,
ZZÅ Ç
$num
ZZÉ Ö
)
ZZÖ Ü
;
ZZÜ á
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# *
,[[* +
	SqlDbType[[, 5
.[[5 6
UniqueIdentifier[[6 F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
guid[[b f
)[[f g
;[[g h
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
UniqueIdentifier\\: J
,\\J K
ParameterDirection\\L ^
.\\^ _
Input\\_ d
,\\d e
siteGuid\\f n
)\\n o
;\\o p
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 0
,]]0 1
	SqlDbType]]2 ;
.]]; <
UniqueIdentifier]]< L
,]]L M
ParameterDirection]]N `
.]]` a
Input]]a f
,]]f g

moduleGuid]]h r
)]]r s
;]]s t
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 2
,^^2 3
	SqlDbType^^4 =
.^^= >
UniqueIdentifier^^> N
,^^N O
ParameterDirection^^P b
.^^b c
Input^^c h
,^^h i
specialGuid1^^j v
)^^v w
;^^w x
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 2
,__2 3
	SqlDbType__4 =
.__= >
UniqueIdentifier__> N
,__N O
ParameterDirection__P b
.__b c
Input__c h
,__h i
specialGuid2__j v
)__v w
;__w x
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# /
,``/ 0
	SqlDbType``1 :
.``: ;
NVarChar``; C
,``C D
$num``E H
,``H I
ParameterDirection``J \
.``\ ]
Input``] b
,``b c
	toAddress``d m
)``m n
;``n o
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# /
,aa/ 0
	SqlDbTypeaa1 :
.aa: ;
NVarCharaa; C
,aaC D
$numaaE H
,aaH I
ParameterDirectionaaJ \
.aa\ ]
Inputaa] b
,aab c
	ccAddressaad m
)aam n
;aan o
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
$numbbF I
,bbI J
ParameterDirectionbbK ]
.bb] ^
Inputbb^ c
,bbc d

bccAddressbbe o
)bbo p
;bbp q
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# -
,cc- .
	SqlDbTypecc/ 8
.cc8 9
NVarCharcc9 A
,ccA B
$numccC F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
subjectccb i
)cci j
;ccj k
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# .
,dd. /
	SqlDbTypedd0 9
.dd9 :
NVarChardd: B
,ddB C
-ddD E
$numddE F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
textBodyddb j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# .
,ee. /
	SqlDbTypeee0 9
.ee9 :
NVarCharee: B
,eeB C
-eeD E
$numeeE F
,eeF G
ParameterDirectioneeH Z
.eeZ [
Inputee[ `
,ee` a
htmlBodyeeb j
)eej k
;eek l
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# *
,ff* +
	SqlDbTypeff, 5
.ff5 6
NVarCharff6 >
,ff> ?
$numff@ B
,ffB C
ParameterDirectionffD V
.ffV W
InputffW \
,ff\ ]
typeff^ b
)ffb c
;ffc d
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# -
,gg- .
	SqlDbTypegg/ 8
.gg8 9
DateTimegg9 A
,ggA B
ParameterDirectionggC U
.ggU V
InputggV [
,gg[ \
sentUtcgg] d
)ggd e
;gge f
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 1
,hh1 2
	SqlDbTypehh3 <
.hh< =
NVarCharhh= E
,hhE F
$numhhG J
,hhJ K
ParameterDirectionhhL ^
.hh^ _
Inputhh_ d
,hhd e
fromAddresshhf q
)hhq r
;hhr s
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# -
,ii- .
	SqlDbTypeii/ 8
.ii8 9
NVarCharii9 A
,iiA B
$numiiC F
,iiF G
ParameterDirectioniiH Z
.iiZ [
Inputii[ `
,ii` a
replyToiib i
)iii j
;iij k
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
userGuidjjf n
)jjn o
;jjo p
sphkk 
.kk 
ExecuteNonQuerykk 
(kk  
)kk  !
;kk! "
}nn 	
publicuu 
staticuu 
booluu 
Deleteuu !
(uu! "
Guiduu" &
guiduu' +
)uu+ ,
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi Å
,
wwÅ Ç
$num
wwÉ Ñ
)
wwÑ Ö
;
wwÖ Ü
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
UniqueIdentifierxx6 F
,xxF G
ParameterDirectionxxH Z
.xxZ [
Inputxx[ `
,xx` a
guidxxb f
)xxf g
;xxg h
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
ÉÉ 
static
ÉÉ 
bool
ÉÉ 
DeleteBySite
ÉÉ '
(
ÉÉ' (
Guid
ÉÉ( ,
siteGuid
ÉÉ- 5
)
ÉÉ5 6
{
ÑÑ 	 
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M&
GetWriteConnectionString
ÖÖM e
(
ÖÖe f
)
ÖÖf g
,
ÖÖg h
$strÖÖi á
,ÖÖá à
$numÖÖâ ä
)ÖÖä ã
;ÖÖã å
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
UniqueIdentifier
ÜÜ: J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
siteGuid
ÜÜf n
)
ÜÜn o
;
ÜÜo p
int
áá 
rowsAffected
áá 
=
áá 
sph
áá "
.
áá" #
ExecuteNonQuery
áá# 2
(
áá2 3
)
áá3 4
;
áá4 5
return
àà 
(
àà 
rowsAffected
àà  
>
àà! "
$num
àà# $
)
àà$ %
;
àà% &
}
ää 	
public
ëë 
static
ëë 
bool
ëë 
DeleteByModule
ëë )
(
ëë) *
Guid
ëë* .

moduleGuid
ëë/ 9
)
ëë9 :
{
íí 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M&
GetWriteConnectionString
ììM e
(
ììe f
)
ììf g
,
ììg h
$strììi â
,ììâ ä
$numììã å
)ììå ç
;ììç é
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 0
,
îî0 1
	SqlDbType
îî2 ;
.
îî; <
UniqueIdentifier
îî< L
,
îîL M 
ParameterDirection
îîN `
.
îî` a
Input
îîa f
,
îîf g

moduleGuid
îîh r
)
îîr s
;
îîs t
int
ïï 
rowsAffected
ïï 
=
ïï 
sph
ïï "
.
ïï" #
ExecuteNonQuery
ïï# 2
(
ïï2 3
)
ïï3 4
;
ïï4 5
return
ññ 
(
ññ 
rowsAffected
ññ  
>
ññ! "
$num
ññ# $
)
ññ$ %
;
ññ% &
}
òò 	
}
ùù 
}ûû  N
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailSendQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailSendQueue (
{ 
publicII 
staticII 
intII 
CreateII  
(II  !
GuidJJ 
guidJJ 
,JJ 
GuidKK 
siteGuidKK 
,KK 
GuidLL 

moduleGuidLL 
,LL 
GuidMM 
userGuidMM 
,MM 
GuidNN 
specialGuid1NN 
,NN 
GuidOO 
specialGuid2OO 
,OO 
stringPP 
fromAddressPP 
,PP 
stringQQ 
replyToQQ 
,QQ 
stringRR 
	toAddressRR 
,RR 
stringSS 
	ccAddressSS 
,SS 
stringTT 

bccAddressTT 
,TT 
stringUU 
subjectUU 
,UU 
stringVV 
textBodyVV 
,VV 
stringWW 
htmlBodyWW 
,WW 
stringXX 
typeXX 
,XX 
DateTimeYY 

dateToSendYY 
,YY  
DateTimeZZ 

createdUtcZZ 
)ZZ  
{[[ 	
SqlParameterHelper\\ 
sph\\ "
=\\# $
new\\% (
SqlParameterHelper\\) ;
(\\; <
ConnectionString\\< L
.\\L M$
GetWriteConnectionString\\M e
(\\e f
)\\f g
,\\g h
$str	\\i É
,
\\É Ñ
$num
\\Ö á
)
\\á à
;
\\à â
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
UniqueIdentifier]]6 F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
guid]]b f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
UniqueIdentifier^^: J
,^^J K
ParameterDirection^^L ^
.^^^ _
Input^^_ d
,^^d e
siteGuid^^f n
)^^n o
;^^o p
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 0
,__0 1
	SqlDbType__2 ;
.__; <
UniqueIdentifier__< L
,__L M
ParameterDirection__N `
.__` a
Input__a f
,__f g

moduleGuid__h r
)__r s
;__s t
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# .
,``. /
	SqlDbType``0 9
.``9 :
UniqueIdentifier``: J
,``J K
ParameterDirection``L ^
.``^ _
Input``_ d
,``d e
userGuid``f n
)``n o
;``o p
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
UniqueIdentifieraa> N
,aaN O
ParameterDirectionaaP b
.aab c
Inputaac h
,aah i
specialGuid1aaj v
)aav w
;aaw x
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
UniqueIdentifierbb> N
,bbN O
ParameterDirectionbbP b
.bbb c
Inputbbc h
,bbh i
specialGuid2bbj v
)bbv w
;bbw x
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 1
,cc1 2
	SqlDbTypecc3 <
.cc< =
NVarCharcc= E
,ccE F
$numccG J
,ccJ K
ParameterDirectionccL ^
.cc^ _
Inputcc_ d
,ccd e
fromAddressccf q
)ccq r
;ccr s
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# -
,dd- .
	SqlDbTypedd/ 8
.dd8 9
NVarChardd9 A
,ddA B
$numddC F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
replyToddb i
)ddi j
;ddj k
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
NVarCharee; C
,eeC D
$numeeE H
,eeH I
ParameterDirectioneeJ \
.ee\ ]
Inputee] b
,eeb c
	toAddresseed m
)eem n
;een o
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# /
,ff/ 0
	SqlDbTypeff1 :
.ff: ;
NVarCharff; C
,ffC D
$numffE H
,ffH I
ParameterDirectionffJ \
.ff\ ]
Inputff] b
,ffb c
	ccAddressffd m
)ffm n
;ffn o
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 0
,gg0 1
	SqlDbTypegg2 ;
.gg; <
NVarChargg< D
,ggD E
$numggF I
,ggI J
ParameterDirectionggK ]
.gg] ^
Inputgg^ c
,ggc d

bccAddressgge o
)ggo p
;ggp q
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# -
,hh- .
	SqlDbTypehh/ 8
.hh8 9
NVarCharhh9 A
,hhA B
$numhhC F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
subjecthhb i
)hhi j
;hhj k
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# .
,ii. /
	SqlDbTypeii0 9
.ii9 :
NVarCharii: B
,iiB C
-iiD E
$numiiE F
,iiF G
ParameterDirectioniiH Z
.iiZ [
Inputii[ `
,ii` a
textBodyiib j
)iij k
;iik l
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
NVarCharjj: B
,jjB C
-jjD E
$numjjE F
,jjF G
ParameterDirectionjjH Z
.jjZ [
Inputjj[ `
,jj` a
htmlBodyjjb j
)jjj k
;jjk l
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# *
,kk* +
	SqlDbTypekk, 5
.kk5 6
NVarCharkk6 >
,kk> ?
$numkk@ B
,kkB C
ParameterDirectionkkD V
.kkV W
InputkkW \
,kk\ ]
typekk^ b
)kkb c
;kkc d
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
DateTimell< D
,llD E
ParameterDirectionllF X
.llX Y
InputllY ^
,ll^ _

dateToSendll` j
)llj k
;llk l
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 0
,mm0 1
	SqlDbTypemm2 ;
.mm; <
DateTimemm< D
,mmD E
ParameterDirectionmmF X
.mmX Y
InputmmY ^
,mm^ _

createdUtcmm` j
)mmj k
;mmk l
intnn 
rowsAffectednn 
=nn 
sphnn "
.nn" #
ExecuteNonQuerynn# 2
(nn2 3
)nn3 4
;nn4 5
returnoo 
rowsAffectedoo 
;oo  
}qq 	
publicxx 
staticxx 
boolxx 
Deletexx !
(xx! "
Guidxx" &
guidxx' +
)xx+ ,
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M$
GetWriteConnectionStringzzM e
(zze f
)zzf g
,zzg h
$str	zzi É
,
zzÉ Ñ
$num
zzÖ Ü
)
zzÜ á
;
zzá à
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# *
,{{* +
	SqlDbType{{, 5
.{{5 6
UniqueIdentifier{{6 F
,{{F G
ParameterDirection{{H Z
.{{Z [
Input{{[ `
,{{` a
guid{{b f
){{f g
;{{g h
int|| 
rowsAffected|| 
=|| 
sph|| "
.||" #
ExecuteNonQuery||# 2
(||2 3
)||3 4
;||4 5
return}} 
(}} 
rowsAffected}}  
>}}! "
$num}}# $
)}}$ %
;}}% &
} 	
public
ÖÖ 
static
ÖÖ 
IDataReader
ÖÖ !
GetEmailToSend
ÖÖ" 0
(
ÖÖ0 1
DateTime
ÖÖ1 9
currentTime
ÖÖ: E
)
ÖÖE F
{
ÜÜ 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M%
GetReadConnectionString
ááM d
(
áád e
)
ááe f
,
ááf g
$strááh å
,ááå ç
$numááé è
)ááè ê
;ááê ë
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 1
,
àà1 2
	SqlDbType
àà3 <
.
àà< =
DateTime
àà= E
,
ààE F 
ParameterDirection
ààG Y
.
ààY Z
Input
ààZ _
,
àà_ `
currentTime
ààa l
)
ààl m
;
ààm n
return
ââ 
sph
ââ 
.
ââ 
ExecuteReader
ââ $
(
ââ$ %
)
ââ% &
;
ââ& '
}
ãã 	
}
éé 
}èè ƒπ
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailTemplate '
{ 
public11 
static11 
int11 
Create11  
(11  !
Guid22 
guid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
featureGuid44 
,44 
Guid55 

moduleGuid55 
,55 
Guid66 
specialGuid166 
,66 
Guid77 
specialGuid277 
,77 
string88 
name88 
,88 
string99 
subject99 
,99 
string:: 
textBody:: 
,:: 
string;; 
htmlBody;; 
,;; 
bool<< 
hasHtml<< 
,<< 
bool== 

isEditable== 
,== 
DateTime>> 

createdUtc>> 
,>>  
Guid?? 
	lastModBy?? 
)?? 
{@@ 	
SqlParameterHelperAA 
sphAA "
=AA# $
newAA% (
SqlParameterHelperAA) ;
(AA; <
ConnectionStringAA< L
.AAL M$
GetWriteConnectionStringAAM e
(AAe f
)AAf g
,AAg h
$str	AAi Ç
,
AAÇ É
$num
AAÑ Ü
)
AAÜ á
;
AAá à
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# *
,BB* +
	SqlDbTypeBB, 5
.BB5 6
UniqueIdentifierBB6 F
,BBF G
ParameterDirectionBBH Z
.BBZ [
InputBB[ `
,BB` a
guidBBb f
)BBf g
;BBg h
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# .
,CC. /
	SqlDbTypeCC0 9
.CC9 :
UniqueIdentifierCC: J
,CCJ K
ParameterDirectionCCL ^
.CC^ _
InputCC_ d
,CCd e
siteGuidCCf n
)CCn o
;CCo p
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 1
,DD1 2
	SqlDbTypeDD3 <
.DD< =
UniqueIdentifierDD= M
,DDM N
ParameterDirectionDDO a
.DDa b
InputDDb g
,DDg h
featureGuidDDi t
)DDt u
;DDu v
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 0
,EE0 1
	SqlDbTypeEE2 ;
.EE; <
UniqueIdentifierEE< L
,EEL M
ParameterDirectionEEN `
.EE` a
InputEEa f
,EEf g

moduleGuidEEh r
)EEr s
;EEs t
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 2
,FF2 3
	SqlDbTypeFF4 =
.FF= >
UniqueIdentifierFF> N
,FFN O
ParameterDirectionFFP b
.FFb c
InputFFc h
,FFh i
specialGuid1FFj v
)FFv w
;FFw x
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 2
,GG2 3
	SqlDbTypeGG4 =
.GG= >
UniqueIdentifierGG> N
,GGN O
ParameterDirectionGGP b
.GGb c
InputGGc h
,GGh i
specialGuid2GGj v
)GGv w
;GGw x
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
NVarCharHH6 >
,HH> ?
$numHH@ C
,HHC D
ParameterDirectionHHE W
.HHW X
InputHHX ]
,HH] ^
nameHH_ c
)HHc d
;HHd e
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# -
,II- .
	SqlDbTypeII/ 8
.II8 9
NVarCharII9 A
,IIA B
$numIIC F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
subjectIIb i
)IIi j
;IIj k
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
NVarCharJJ: B
,JJB C
-JJD E
$numJJE F
,JJF G
ParameterDirectionJJH Z
.JJZ [
InputJJ[ `
,JJ` a
textBodyJJb j
)JJj k
;JJk l
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
NVarCharKK: B
,KKB C
-KKD E
$numKKE F
,KKF G
ParameterDirectionKKH Z
.KKZ [
InputKK[ `
,KK` a
htmlBodyKKb j
)KKj k
;KKk l
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# -
,LL- .
	SqlDbTypeLL/ 8
.LL8 9
BitLL9 <
,LL< =
ParameterDirectionLL> P
.LLP Q
InputLLQ V
,LLV W
hasHtmlLLX _
)LL_ `
;LL` a
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 0
,MM0 1
	SqlDbTypeMM2 ;
.MM; <
BitMM< ?
,MM? @
ParameterDirectionMMA S
.MMS T
InputMMT Y
,MMY Z

isEditableMM[ e
)MMe f
;MMf g
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 0
,NN0 1
	SqlDbTypeNN2 ;
.NN; <
DateTimeNN< D
,NND E
ParameterDirectionNNF X
.NNX Y
InputNNY ^
,NN^ _

createdUtcNN` j
)NNj k
;NNk l
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
DateTimeOO< D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _

createdUtcOO` j
)OOj k
;OOk l
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
UniqueIdentifierPP; K
,PPK L
ParameterDirectionPPM _
.PP_ `
InputPP` e
,PPe f
	lastModByPPg p
)PPp q
;PPq r
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}TT 	
publicdd 
staticdd 
booldd 
Updatedd !
(dd! "
Guidee 
guidee 
,ee 
stringff 
nameff 
,ff 
stringgg 
subjectgg 
,gg 
stringhh 
textBodyhh 
,hh 
stringii 
htmlBodyii 
,ii 
booljj 
hasHtmljj 
,jj 
boolkk 

isEditablekk 
,kk 
DateTimell 

lastModUtcll 
,ll  
Guidmm 
	lastModBymm 
)mm 
{nn 	
SqlParameterHelperoo 
sphoo "
=oo# $
newoo% (
SqlParameterHelperoo) ;
(oo; <
ConnectionStringoo< L
.ooL M$
GetWriteConnectionStringooM e
(ooe f
)oof g
,oog h
$str	ooi Ç
,
ooÇ É
$num
ooÑ Ö
)
ooÖ Ü
;
ooÜ á
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# *
,pp* +
	SqlDbTypepp, 5
.pp5 6
UniqueIdentifierpp6 F
,ppF G
ParameterDirectionppH Z
.ppZ [
Inputpp[ `
,pp` a
guidppb f
)ppf g
;ppg h
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# *
,qq* +
	SqlDbTypeqq, 5
.qq5 6
NVarCharqq6 >
,qq> ?
$numqq@ C
,qqC D
ParameterDirectionqqE W
.qqW X
InputqqX ]
,qq] ^
nameqq_ c
)qqc d
;qqd e
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# -
,rr- .
	SqlDbTyperr/ 8
.rr8 9
NVarCharrr9 A
,rrA B
$numrrC F
,rrF G
ParameterDirectionrrH Z
.rrZ [
Inputrr[ `
,rr` a
subjectrrb i
)rri j
;rrj k
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# .
,ss. /
	SqlDbTypess0 9
.ss9 :
NVarCharss: B
,ssB C
-ssD E
$numssE F
,ssF G
ParameterDirectionssH Z
.ssZ [
Inputss[ `
,ss` a
textBodyssb j
)ssj k
;ssk l
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# .
,tt. /
	SqlDbTypett0 9
.tt9 :
NVarChartt: B
,ttB C
-ttD E
$numttE F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
htmlBodyttb j
)ttj k
;ttk l
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# -
,uu- .
	SqlDbTypeuu/ 8
.uu8 9
Bituu9 <
,uu< =
ParameterDirectionuu> P
.uuP Q
InputuuQ V
,uuV W
hasHtmluuX _
)uu_ `
;uu` a
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 0
,vv0 1
	SqlDbTypevv2 ;
.vv; <
Bitvv< ?
,vv? @
ParameterDirectionvvA S
.vvS T
InputvvT Y
,vvY Z

isEditablevv[ e
)vve f
;vvf g
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
DateTimeww< D
,wwD E
ParameterDirectionwwF X
.wwX Y
InputwwY ^
,ww^ _

lastModUtcww` j
)wwj k
;wwk l
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# /
,xx/ 0
	SqlDbTypexx1 :
.xx: ;
UniqueIdentifierxx; K
,xxK L
ParameterDirectionxxM _
.xx_ `
Inputxx` e
,xxe f
	lastModByxxg p
)xxp q
;xxq r
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
ÉÉ 
static
ÉÉ 
bool
ÉÉ 
Delete
ÉÉ !
(
ÉÉ! "
Guid
ÉÉ" &
guid
ÉÉ' +
)
ÉÉ+ ,
{
ÑÑ 	 
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M&
GetWriteConnectionString
ÖÖM e
(
ÖÖe f
)
ÖÖf g
,
ÖÖg h
$strÖÖi Ç
,ÖÖÇ É
$numÖÖÑ Ö
)ÖÖÖ Ü
;ÖÖÜ á
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# *
,
ÜÜ* +
	SqlDbType
ÜÜ, 5
.
ÜÜ5 6
UniqueIdentifier
ÜÜ6 F
,
ÜÜF G 
ParameterDirection
ÜÜH Z
.
ÜÜZ [
Input
ÜÜ[ `
,
ÜÜ` a
guid
ÜÜb f
)
ÜÜf g
;
ÜÜg h
int
áá 
rowsAffected
áá 
=
áá 
sph
áá "
.
áá" #
ExecuteNonQuery
áá# 2
(
áá2 3
)
áá3 4
;
áá4 5
return
àà 
(
àà 
rowsAffected
àà  
>
àà! "
$num
àà# $
)
àà$ %
;
àà% &
}
ää 	
public
ëë 
static
ëë 
bool
ëë 
DeleteBySite
ëë '
(
ëë' (
Guid
ëë( ,
siteGuid
ëë- 5
)
ëë5 6
{
íí 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M&
GetWriteConnectionString
ììM e
(
ììe f
)
ììf g
,
ììg h
$strììi à
,ììà â
$numììä ã
)ììã å
;ììå ç
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# .
,
îî. /
	SqlDbType
îî0 9
.
îî9 :
UniqueIdentifier
îî: J
,
îîJ K 
ParameterDirection
îîL ^
.
îî^ _
Input
îî_ d
,
îîd e
siteGuid
îîf n
)
îîn o
;
îîo p
int
ïï 
rowsAffected
ïï 
=
ïï 
sph
ïï "
.
ïï" #
ExecuteNonQuery
ïï# 2
(
ïï2 3
)
ïï3 4
;
ïï4 5
return
ññ 
(
ññ 
rowsAffected
ññ  
>
ññ! "
$num
ññ# $
)
ññ$ %
;
ññ% &
}
òò 	
public
üü 
static
üü 
bool
üü 
DeleteByFeature
üü *
(
üü* +
Guid
üü+ /
featureGuid
üü0 ;
)
üü; <
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M&
GetWriteConnectionString
°°M e
(
°°e f
)
°°f g
,
°°g h
$str°°i ã
,°°ã å
$num°°ç é
)°°é è
;°°è ê
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 1
,
¢¢1 2
	SqlDbType
¢¢3 <
.
¢¢< =
UniqueIdentifier
¢¢= M
,
¢¢M N 
ParameterDirection
¢¢O a
.
¢¢a b
Input
¢¢b g
,
¢¢g h
featureGuid
¢¢i t
)
¢¢t u
;
¢¢u v
int
££ 
rowsAffected
££ 
=
££ 
sph
££ "
.
££" #
ExecuteNonQuery
££# 2
(
££2 3
)
££3 4
;
££4 5
return
§§ 
(
§§ 
rowsAffected
§§  
>
§§! "
$num
§§# $
)
§§$ %
;
§§% &
}
¶¶ 	
public
≠≠ 
static
≠≠ 
bool
≠≠ 
DeleteByModule
≠≠ )
(
≠≠) *
Guid
≠≠* .

moduleGuid
≠≠/ 9
)
≠≠9 :
{
ÆÆ 	 
SqlParameterHelper
ØØ 
sph
ØØ "
=
ØØ# $
new
ØØ% ( 
SqlParameterHelper
ØØ) ;
(
ØØ; <
ConnectionString
ØØ< L
.
ØØL M&
GetWriteConnectionString
ØØM e
(
ØØe f
)
ØØf g
,
ØØg h
$strØØi ä
,ØØä ã
$numØØå ç
)ØØç é
;ØØé è
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# 0
,
∞∞0 1
	SqlDbType
∞∞2 ;
.
∞∞; <
UniqueIdentifier
∞∞< L
,
∞∞L M 
ParameterDirection
∞∞N `
.
∞∞` a
Input
∞∞a f
,
∞∞f g

moduleGuid
∞∞h r
)
∞∞r s
;
∞∞s t
int
±± 
rowsAffected
±± 
=
±± 
sph
±± "
.
±±" #
ExecuteNonQuery
±±# 2
(
±±2 3
)
±±3 4
;
±±4 5
return
≤≤ 
(
≤≤ 
rowsAffected
≤≤  
>
≤≤! "
$num
≤≤# $
)
≤≤$ %
;
≤≤% &
}
¥¥ 	
public
ªª 
static
ªª 
bool
ªª 
DeleteBySpecial1
ªª +
(
ªª+ ,
Guid
ªª, 0
specialGuid1
ªª1 =
)
ªª= >
{
ºº 	
if
ΩΩ 
(
ΩΩ 
specialGuid1
ΩΩ 
==
ΩΩ 
Guid
ΩΩ  $
.
ΩΩ$ %
Empty
ΩΩ% *
)
ΩΩ* +
{
ΩΩ, -
return
ΩΩ. 4
false
ΩΩ5 :
;
ΩΩ: ;
}
ΩΩ< = 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M&
GetWriteConnectionString
øøM e
(
øøe f
)
øøf g
,
øøg h
$strøøi ê
,øøê ë
$numøøí ì
)øøì î
;øøî ï
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 2
,
¿¿2 3
	SqlDbType
¿¿4 =
.
¿¿= >
UniqueIdentifier
¿¿> N
,
¿¿N O 
ParameterDirection
¿¿P b
.
¿¿b c
Input
¿¿c h
,
¿¿h i
specialGuid1
¿¿j v
)
¿¿v w
;
¿¿w x
int
¡¡ 
rowsAffected
¡¡ 
=
¡¡ 
sph
¡¡ "
.
¡¡" #
ExecuteNonQuery
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
$num
¬¬# $
)
¬¬$ %
;
¬¬% &
}
ƒƒ 	
public
ÀÀ 
static
ÀÀ 
bool
ÀÀ 
DeleteBySpecial2
ÀÀ +
(
ÀÀ+ ,
Guid
ÀÀ, 0
specialGuid2
ÀÀ1 =
)
ÀÀ= >
{
ÃÃ 	
if
ÕÕ 
(
ÕÕ 
specialGuid2
ÕÕ 
==
ÕÕ 
Guid
ÕÕ  $
.
ÕÕ$ %
Empty
ÕÕ% *
)
ÕÕ* +
{
ÕÕ, -
return
ÕÕ. 4
false
ÕÕ5 :
;
ÕÕ: ;
}
ÕÕ< = 
SqlParameterHelper
œœ 
sph
œœ "
=
œœ# $
new
œœ% ( 
SqlParameterHelper
œœ) ;
(
œœ; <
ConnectionString
œœ< L
.
œœL M&
GetWriteConnectionString
œœM e
(
œœe f
)
œœf g
,
œœg h
$strœœi ê
,œœê ë
$numœœí ì
)œœì î
;œœî ï
sph
–– 
.
––  
DefineSqlParameter
–– "
(
––" #
$str
––# 2
,
––2 3
	SqlDbType
––4 =
.
––= >
UniqueIdentifier
––> N
,
––N O 
ParameterDirection
––P b
.
––b c
Input
––c h
,
––h i
specialGuid2
––j v
)
––v w
;
––w x
int
—— 
rowsAffected
—— 
=
—— 
sph
—— "
.
——" #
ExecuteNonQuery
——# 2
(
——2 3
)
——3 4
;
——4 5
return
““ 
(
““ 
rowsAffected
““  
>
““! "
$num
““# $
)
““$ %
;
““% &
}
‘‘ 	
public
⁄⁄ 
static
⁄⁄ 
IDataReader
⁄⁄ !
GetOne
⁄⁄" (
(
⁄⁄( )
Guid
⁄⁄) -
guid
⁄⁄. 2
)
⁄⁄2 3
{
€€ 	 
SqlParameterHelper
‹‹ 
sph
‹‹ "
=
‹‹# $
new
‹‹% ( 
SqlParameterHelper
‹‹) ;
(
‹‹; <
ConnectionString
‹‹< L
.
‹‹L M%
GetReadConnectionString
‹‹M d
(
‹‹d e
)
‹‹e f
,
‹‹f g
$str‹‹h Ñ
,‹‹Ñ Ö
$num‹‹Ü á
)‹‹á à
;‹‹à â
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# *
,
››* +
	SqlDbType
››, 5
.
››5 6
UniqueIdentifier
››6 F
,
››F G 
ParameterDirection
››H Z
.
››Z [
Input
››[ `
,
››` a
guid
››b f
)
››f g
;
››g h
return
ﬁﬁ 
sph
ﬁﬁ 
.
ﬁﬁ 
ExecuteReader
ﬁﬁ $
(
ﬁﬁ$ %
)
ﬁﬁ% &
;
ﬁﬁ& '
}
‡‡ 	
public
‚‚ 
static
‚‚ 
IDataReader
‚‚ !
Get
‚‚" %
(
‚‚% &
Guid
‚‚& *
siteGuid
‚‚+ 3
,
‚‚3 4
Guid
‚‚5 9
featureGuid
‚‚: E
,
‚‚E F
Guid
‚‚G K

moduleGuid
‚‚L V
,
‚‚V W
Guid
‚‚X \
specialGuid1
‚‚] i
,
‚‚i j
Guid
‚‚k o
specialGuid2
‚‚p |
)
‚‚| }
{
„„ 	 
SqlParameterHelper
‰‰ 
sph
‰‰ "
=
‰‰# $
new
‰‰% ( 
SqlParameterHelper
‰‰) ;
(
‰‰; <
ConnectionString
‰‰< L
.
‰‰L M%
GetReadConnectionString
‰‰M d
(
‰‰d e
)
‰‰e f
,
‰‰f g
$str‰‰h Å
,‰‰Å Ç
$num‰‰É Ñ
)‰‰Ñ Ö
;‰‰Ö Ü
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# .
,
ÂÂ. /
	SqlDbType
ÂÂ0 9
.
ÂÂ9 :
UniqueIdentifier
ÂÂ: J
,
ÂÂJ K 
ParameterDirection
ÂÂL ^
.
ÂÂ^ _
Input
ÂÂ_ d
,
ÂÂd e
siteGuid
ÂÂf n
)
ÂÂn o
;
ÂÂo p
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 1
,
ÊÊ1 2
	SqlDbType
ÊÊ3 <
.
ÊÊ< =
UniqueIdentifier
ÊÊ= M
,
ÊÊM N 
ParameterDirection
ÊÊO a
.
ÊÊa b
Input
ÊÊb g
,
ÊÊg h
featureGuid
ÊÊi t
)
ÊÊt u
;
ÊÊu v
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 0
,
ÁÁ0 1
	SqlDbType
ÁÁ2 ;
.
ÁÁ; <
UniqueIdentifier
ÁÁ< L
,
ÁÁL M 
ParameterDirection
ÁÁN `
.
ÁÁ` a
Input
ÁÁa f
,
ÁÁf g

moduleGuid
ÁÁh r
)
ÁÁr s
;
ÁÁs t
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# 2
,
ËË2 3
	SqlDbType
ËË4 =
.
ËË= >
UniqueIdentifier
ËË> N
,
ËËN O 
ParameterDirection
ËËP b
.
ËËb c
Input
ËËc h
,
ËËh i
specialGuid1
ËËj v
)
ËËv w
;
ËËw x
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 2
,
ÈÈ2 3
	SqlDbType
ÈÈ4 =
.
ÈÈ= >
UniqueIdentifier
ÈÈ> N
,
ÈÈN O 
ParameterDirection
ÈÈP b
.
ÈÈb c
Input
ÈÈc h
,
ÈÈh i
specialGuid2
ÈÈj v
)
ÈÈv w
;
ÈÈw x
return
ÎÎ 
sph
ÎÎ 
.
ÎÎ 
ExecuteReader
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
}
ÌÌ 	
public
ÛÛ 
static
ÛÛ 
IDataReader
ÛÛ !
GetByModule
ÛÛ" -
(
ÛÛ- .
Guid
ÛÛ. 2

moduleGuid
ÛÛ3 =
)
ÛÛ= >
{
ÙÙ 	 
SqlParameterHelper
ıı 
sph
ıı "
=
ıı# $
new
ıı% ( 
SqlParameterHelper
ıı) ;
(
ıı; <
ConnectionString
ıı< L
.
ııL M%
GetReadConnectionString
ııM d
(
ııd e
)
ııe f
,
ııf g
$strııh â
,ııâ ä
$numııã å
)ııå ç
;ııç é
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# 0
,
ˆˆ0 1
	SqlDbType
ˆˆ2 ;
.
ˆˆ; <
UniqueIdentifier
ˆˆ< L
,
ˆˆL M 
ParameterDirection
ˆˆN `
.
ˆˆ` a
Input
ˆˆa f
,
ˆˆf g

moduleGuid
ˆˆh r
)
ˆˆr s
;
ˆˆs t
return
˜˜ 
sph
˜˜ 
.
˜˜ 
ExecuteReader
˜˜ $
(
˜˜$ %
)
˜˜% &
;
˜˜& '
}
˘˘ 	
public
˚˚ 
static
˚˚ 
IDataReader
˚˚ !
GetByFeature
˚˚" .
(
˚˚. /
Guid
˚˚/ 3
siteGuid
˚˚4 <
,
˚˚< =
Guid
˚˚> B
featureGuid
˚˚C N
)
˚˚N O
{
¸¸ 	 
SqlParameterHelper
˝˝ 
sph
˝˝ "
=
˝˝# $
new
˝˝% ( 
SqlParameterHelper
˝˝) ;
(
˝˝; <
ConnectionString
˝˝< L
.
˝˝L M%
GetReadConnectionString
˝˝M d
(
˝˝d e
)
˝˝e f
,
˝˝f g
$str˝˝h ä
,˝˝ä ã
$num˝˝å ç
)˝˝ç é
;˝˝é è
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# .
,
˛˛. /
	SqlDbType
˛˛0 9
.
˛˛9 :
UniqueIdentifier
˛˛: J
,
˛˛J K 
ParameterDirection
˛˛L ^
.
˛˛^ _
Input
˛˛_ d
,
˛˛d e
siteGuid
˛˛f n
)
˛˛n o
;
˛˛o p
sph
ˇˇ 
.
ˇˇ  
DefineSqlParameter
ˇˇ "
(
ˇˇ" #
$str
ˇˇ# 1
,
ˇˇ1 2
	SqlDbType
ˇˇ3 <
.
ˇˇ< =
UniqueIdentifier
ˇˇ= M
,
ˇˇM N 
ParameterDirection
ˇˇO a
.
ˇˇa b
Input
ˇˇb g
,
ˇˇg h
featureGuid
ˇˇi t
)
ˇˇt u
;
ˇˇu v
return
ÄÄ 
sph
ÄÄ 
.
ÄÄ 
ExecuteReader
ÄÄ $
(
ÄÄ$ %
)
ÄÄ% &
;
ÄÄ& '
}
ÇÇ 	
public
àà 
static
àà 
IDataReader
àà !
GetByModule
àà" -
(
àà- .
Guid
àà. 2

moduleGuid
àà3 =
,
àà= >
Guid
àà? C
specialGuid1
ààD P
,
ààP Q
Guid
ààR V
specialGuid2
ààW c
)
ààc d
{
ââ 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M%
GetReadConnectionString
ääM d
(
ääd e
)
ääe f
,
ääf g
$strääh ê
,ääê ë
$numääí ì
)ääì î
;ääî ï
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 0
,
ãã0 1
	SqlDbType
ãã2 ;
.
ãã; <
UniqueIdentifier
ãã< L
,
ããL M 
ParameterDirection
ããN `
.
ãã` a
Input
ããa f
,
ããf g

moduleGuid
ããh r
)
ããr s
;
ããs t
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# 2
,
åå2 3
	SqlDbType
åå4 =
.
åå= >
UniqueIdentifier
åå> N
,
ååN O 
ParameterDirection
ååP b
.
ååb c
Input
ååc h
,
ååh i
specialGuid1
ååj v
)
ååv w
;
ååw x
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 2
,
çç2 3
	SqlDbType
çç4 =
.
çç= >
UniqueIdentifier
çç> N
,
ççN O 
ParameterDirection
ççP b
.
ççb c
Input
ççc h
,
ççh i
specialGuid2
ççj v
)
ççv w
;
ççw x
return
éé 
sph
éé 
.
éé 
ExecuteReader
éé $
(
éé$ %
)
éé% &
;
éé& '
}
êê 	
public
íí 
static
íí 
int
íí 
GetCount
íí "
(
íí" #
Guid
íí# '
siteGuid
íí( 0
,
íí0 1
Guid
íí2 6
featureGuid
íí7 B
,
ííB C
Guid
ííD H

moduleGuid
ííI S
,
ííS T
Guid
ííU Y
specialGuid1
ííZ f
,
ííf g
Guid
ííh l
specialGuid2
íím y
)
ííy z
{
ìì 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M%
GetReadConnectionString
ïïM d
(
ïïd e
)
ïïe f
,
ïïf g
$strïïh É
,ïïÉ Ñ
$numïïÖ Ü
)ïïÜ á
;ïïá à
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
UniqueIdentifier
ññ: J
,
ññJ K 
ParameterDirection
ññL ^
.
ññ^ _
Input
ññ_ d
,
ññd e
siteGuid
ññf n
)
ññn o
;
ñño p
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# 1
,
óó1 2
	SqlDbType
óó3 <
.
óó< =
UniqueIdentifier
óó= M
,
óóM N 
ParameterDirection
óóO a
.
óóa b
Input
óób g
,
óóg h
featureGuid
óói t
)
óót u
;
óóu v
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 0
,
òò0 1
	SqlDbType
òò2 ;
.
òò; <
UniqueIdentifier
òò< L
,
òòL M 
ParameterDirection
òòN `
.
òò` a
Input
òòa f
,
òòf g

moduleGuid
òòh r
)
òòr s
;
òòs t
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# 2
,
ôô2 3
	SqlDbType
ôô4 =
.
ôô= >
UniqueIdentifier
ôô> N
,
ôôN O 
ParameterDirection
ôôP b
.
ôôb c
Input
ôôc h
,
ôôh i
specialGuid1
ôôj v
)
ôôv w
;
ôôw x
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 2
,
öö2 3
	SqlDbType
öö4 =
.
öö= >
UniqueIdentifier
öö> N
,
ööN O 
ParameterDirection
ööP b
.
ööb c
Input
ööc h
,
ööh i
specialGuid2
ööj v
)
ööv w
;
ööw x
return
úú 
Convert
úú 
.
úú 
ToInt32
úú "
(
úú" #
sph
úú# &
.
úú& '
ExecuteScalar
úú' 4
(
úú4 5
)
úú5 6
)
úú6 7
;
úú7 8
}
üü 	
public
§§ 
static
§§ 
int
§§ %
GetCountByModuleAndName
§§ 1
(
§§1 2
Guid
§§2 6

moduleGuid
§§7 A
,
§§A B
string
§§C I
name
§§J N
)
§§N O
{
•• 	 
SqlParameterHelper
¶¶ 
sph
¶¶ "
=
¶¶# $
new
¶¶% ( 
SqlParameterHelper
¶¶) ;
(
¶¶; <
ConnectionString
¶¶< L
.
¶¶L M%
GetReadConnectionString
¶¶M d
(
¶¶d e
)
¶¶e f
,
¶¶f g
$str¶¶h í
,¶¶í ì
$num¶¶î ï
)¶¶ï ñ
;¶¶ñ ó
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 0
,
ßß0 1
	SqlDbType
ßß2 ;
.
ßß; <
UniqueIdentifier
ßß< L
,
ßßL M 
ParameterDirection
ßßN `
.
ßß` a
Input
ßßa f
,
ßßf g

moduleGuid
ßßh r
)
ßßr s
;
ßßs t
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# *
,
®®* +
	SqlDbType
®®, 5
.
®®5 6
NVarChar
®®6 >
,
®®> ?
$num
®®@ C
,
®®C D 
ParameterDirection
®®E W
.
®®W X
Input
®®X ]
,
®®] ^
name
®®_ c
)
®®c d
;
®®d e
return
™™ 
Convert
™™ 
.
™™ 
ToInt32
™™ "
(
™™" #
sph
™™# &
.
™™& '
ExecuteScalar
™™' 4
(
™™4 5
)
™™5 6
)
™™6 7
;
™™7 8
}
¨¨ 	
public
±± 
static
±± 
int
±± ,
GetCountByModuleSpecialAndName
±± 8
(
±±8 9
Guid
±±9 =

moduleGuid
±±> H
,
±±H I
Guid
±±J N
specialGuid1
±±O [
,
±±[ \
Guid
±±] a
specialGuid2
±±b n
,
±±n o
string
±±p v
name
±±w {
)
±±{ |
{
≤≤ 	 
SqlParameterHelper
≥≥ 
sph
≥≥ "
=
≥≥# $
new
≥≥% ( 
SqlParameterHelper
≥≥) ;
(
≥≥; <
ConnectionString
≥≥< L
.
≥≥L M%
GetReadConnectionString
≥≥M d
(
≥≥d e
)
≥≥e f
,
≥≥f g
$str≥≥h í
,≥≥í ì
$num≥≥î ï
)≥≥ï ñ
;≥≥ñ ó
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 0
,
¥¥0 1
	SqlDbType
¥¥2 ;
.
¥¥; <
UniqueIdentifier
¥¥< L
,
¥¥L M 
ParameterDirection
¥¥N `
.
¥¥` a
Input
¥¥a f
,
¥¥f g

moduleGuid
¥¥h r
)
¥¥r s
;
¥¥s t
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 2
,
µµ2 3
	SqlDbType
µµ4 =
.
µµ= >
UniqueIdentifier
µµ> N
,
µµN O 
ParameterDirection
µµP b
.
µµb c
Input
µµc h
,
µµh i
specialGuid1
µµj v
)
µµv w
;
µµw x
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# 2
,
∂∂2 3
	SqlDbType
∂∂4 =
.
∂∂= >
UniqueIdentifier
∂∂> N
,
∂∂N O 
ParameterDirection
∂∂P b
.
∂∂b c
Input
∂∂c h
,
∂∂h i
specialGuid2
∂∂j v
)
∂∂v w
;
∂∂w x
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# *
,
∑∑* +
	SqlDbType
∑∑, 5
.
∑∑5 6
NVarChar
∑∑6 >
,
∑∑> ?
$num
∑∑@ C
,
∑∑C D 
ParameterDirection
∑∑E W
.
∑∑W X
Input
∑∑X ]
,
∑∑] ^
name
∑∑_ c
)
∑∑c d
;
∑∑d e
return
ππ 
Convert
ππ 
.
ππ 
ToInt32
ππ "
(
ππ" #
sph
ππ# &
.
ππ& '
ExecuteScalar
ππ' 4
(
ππ4 5
)
ππ5 6
)
ππ6 7
;
ππ7 8
}
ªª 	
public
ΩΩ 
static
ΩΩ 
int
ΩΩ 
GetCountByFeature
ΩΩ +
(
ΩΩ+ ,
Guid
ΩΩ, 0
siteGuid
ΩΩ1 9
,
ΩΩ9 :
Guid
ΩΩ; ?
featureGuid
ΩΩ@ K
)
ΩΩK L
{
ææ 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M%
GetReadConnectionString
¿¿M d
(
¿¿d e
)
¿¿e f
,
¿¿f g
$str¿¿h å
,¿¿å ç
$num¿¿é è
)¿¿è ê
;¿¿ê ë
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# .
,
¡¡. /
	SqlDbType
¡¡0 9
.
¡¡9 :
UniqueIdentifier
¡¡: J
,
¡¡J K 
ParameterDirection
¡¡L ^
.
¡¡^ _
Input
¡¡_ d
,
¡¡d e
siteGuid
¡¡f n
)
¡¡n o
;
¡¡o p
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 1
,
¬¬1 2
	SqlDbType
¬¬3 <
.
¬¬< =
UniqueIdentifier
¬¬= M
,
¬¬M N 
ParameterDirection
¬¬O a
.
¬¬a b
Input
¬¬b g
,
¬¬g h
featureGuid
¬¬i t
)
¬¬t u
;
¬¬u v
return
ƒƒ 
Convert
ƒƒ 
.
ƒƒ 
ToInt32
ƒƒ "
(
ƒƒ" #
sph
ƒƒ# &
.
ƒƒ& '
ExecuteScalar
ƒƒ' 4
(
ƒƒ4 5
)
ƒƒ5 6
)
ƒƒ6 7
;
ƒƒ7 8
}
«« 	
public
…… 
static
…… 
IDataReader
…… !
GetPageByFeature
……" 2
(
……2 3
Guid
   
siteGuid
   
,
   
Guid
ÀÀ 
featureGuid
ÀÀ 
,
ÀÀ 
int
ÃÃ 

pageNumber
ÃÃ 
,
ÃÃ 
int
ÕÕ 
pageSize
ÕÕ 
,
ÕÕ 
out
ŒŒ 
int
ŒŒ 

totalPages
ŒŒ 
)
ŒŒ 
{
œœ 	

totalPages
–– 
=
–– 
$num
–– 
;
–– 
int
—— 
	totalRows
—— 
=
—— 
GetCountByFeature
—— -
(
——- .
siteGuid
——. 6
,
——6 7
featureGuid
——8 C
)
——C D
;
——D E
if
”” 
(
”” 
pageSize
”” 
>
”” 
$num
”” 
)
”” 

totalPages
”” (
=
””) *
	totalRows
””+ 4
/
””5 6
pageSize
””7 ?
;
””? @
if
’’ 
(
’’ 
	totalRows
’’ 
<=
’’ 
pageSize
’’ %
)
’’% &
{
÷÷ 

totalPages
◊◊ 
=
◊◊ 
$num
◊◊ 
;
◊◊ 
}
ÿÿ 
else
ŸŸ 
{
⁄⁄ 
int
€€ 
	remainder
€€ 
;
€€ 
Math
‹‹ 
.
‹‹ 
DivRem
‹‹ 
(
‹‹ 
	totalRows
‹‹ %
,
‹‹% &
pageSize
‹‹' /
,
‹‹/ 0
out
‹‹1 4
	remainder
‹‹5 >
)
‹‹> ?
;
‹‹? @
if
›› 
(
›› 
	remainder
›› 
>
›› 
$num
››  !
)
››! "
{
ﬁﬁ 

totalPages
ﬂﬂ 
+=
ﬂﬂ !
$num
ﬂﬂ" #
;
ﬂﬂ# $
}
‡‡ 
}
··  
SqlParameterHelper
„„ 
sph
„„ "
=
„„# $
new
„„% ( 
SqlParameterHelper
„„) ;
(
„„; <
ConnectionString
„„< L
.
„„L M%
GetReadConnectionString
„„M d
(
„„d e
)
„„e f
,
„„f g
$str„„h é
,„„é è
$num„„ê ë
)„„ë í
;„„í ì
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# .
,
‰‰. /
	SqlDbType
‰‰0 9
.
‰‰9 :
UniqueIdentifier
‰‰: J
,
‰‰J K 
ParameterDirection
‰‰L ^
.
‰‰^ _
Input
‰‰_ d
,
‰‰d e
siteGuid
‰‰f n
)
‰‰n o
;
‰‰o p
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# 1
,
ÂÂ1 2
	SqlDbType
ÂÂ3 <
.
ÂÂ< =
UniqueIdentifier
ÂÂ= M
,
ÂÂM N 
ParameterDirection
ÂÂO a
.
ÂÂa b
Input
ÂÂb g
,
ÂÂg h
featureGuid
ÂÂi t
)
ÂÂt u
;
ÂÂu v
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 0
,
ÊÊ0 1
	SqlDbType
ÊÊ2 ;
.
ÊÊ; <
Int
ÊÊ< ?
,
ÊÊ? @ 
ParameterDirection
ÊÊA S
.
ÊÊS T
Input
ÊÊT Y
,
ÊÊY Z

pageNumber
ÊÊ[ e
)
ÊÊe f
;
ÊÊf g
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# .
,
ÁÁ. /
	SqlDbType
ÁÁ0 9
.
ÁÁ9 :
Int
ÁÁ: =
,
ÁÁ= > 
ParameterDirection
ÁÁ? Q
.
ÁÁQ R
Input
ÁÁR W
,
ÁÁW X
pageSize
ÁÁY a
)
ÁÁa b
;
ÁÁb c
return
ËË 
sph
ËË 
.
ËË 
ExecuteReader
ËË $
(
ËË$ %
)
ËË% &
;
ËË& '
}
ÍÍ 	
}
 
}ÚÚ ∏ö
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBFileAttachment.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBFileAttachment (
{ 
public++ 
static++ 
int++ 
Create++  
(++  !
Guid,, 
rowGuid,, 
,,, 
Guid-- 
siteGuid-- 
,-- 
Guid.. 

moduleGuid.. 
,.. 
Guid// 
itemGuid// 
,// 
Guid00 
specialGuid100 
,00 
Guid11 
specialGuid211 
,11 
string22 
serverFileName22 !
,22! "
string33 
fileName33 
,33 
string44 
contentTitle44 
,44  
long55 
contentLength55 
,55 
string66 
contentType66 
,66 
DateTime77 

createdUtc77 
,77  
Guid88 
	createdBy88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str	::i É
,
::É Ñ
$num
::Ö á
)
::á à
;
::à â
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# -
,;;- .
	SqlDbType;;/ 8
.;;8 9
UniqueIdentifier;;9 I
,;;I J
ParameterDirection;;K ]
.;;] ^
Input;;^ c
,;;c d
rowGuid;;e l
);;l m
;;;m n
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# .
,<<. /
	SqlDbType<<0 9
.<<9 :
UniqueIdentifier<<: J
,<<J K
ParameterDirection<<L ^
.<<^ _
Input<<_ d
,<<d e
siteGuid<<f n
)<<n o
;<<o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 0
,==0 1
	SqlDbType==2 ;
.==; <
UniqueIdentifier==< L
,==L M
ParameterDirection==N `
.==` a
Input==a f
,==f g

moduleGuid==h r
)==r s
;==s t
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># .
,>>. /
	SqlDbType>>0 9
.>>9 :
UniqueIdentifier>>: J
,>>J K
ParameterDirection>>L ^
.>>^ _
Input>>_ d
,>>d e
itemGuid>>f n
)>>n o
;>>o p
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 2
,??2 3
	SqlDbType??4 =
.??= >
UniqueIdentifier??> N
,??N O
ParameterDirection??P b
.??b c
Input??c h
,??h i
specialGuid1??j v
)??v w
;??w x
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 2
,@@2 3
	SqlDbType@@4 =
.@@= >
UniqueIdentifier@@> N
,@@N O
ParameterDirection@@P b
.@@b c
Input@@c h
,@@h i
specialGuid2@@j v
)@@v w
;@@w x
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 4
,AA4 5
	SqlDbTypeAA6 ?
.AA? @
NVarCharAA@ H
,AAH I
$numAAJ M
,AAM N
ParameterDirectionAAO a
.AAa b
InputAAb g
,AAg h
serverFileNameAAi w
)AAw x
;AAx y
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# .
,BB. /
	SqlDbTypeBB0 9
.BB9 :
NVarCharBB: B
,BBB C
$numBBD G
,BBG H
ParameterDirectionBBI [
.BB[ \
InputBB\ a
,BBa b
fileNameBBc k
)BBk l
;BBl m
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 2
,CC2 3
	SqlDbTypeCC4 =
.CC= >
NVarCharCC> F
,CCF G
$numCCH K
,CCK L
ParameterDirectionCCM _
.CC_ `
InputCC` e
,CCe f
contentTitleCCg s
)CCs t
;CCt u
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 3
,DD3 4
	SqlDbTypeDD5 >
.DD> ?
BigIntDD? E
,DDE F
ParameterDirectionDDG Y
.DDY Z
InputDDZ _
,DD_ `
contentLengthDDa n
)DDn o
;DDo p
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 1
,EE1 2
	SqlDbTypeEE3 <
.EE< =
NVarCharEE= E
,EEE F
$numEEG I
,EEI J
ParameterDirectionEEK ]
.EE] ^
InputEE^ c
,EEc d
contentTypeEEe p
)EEp q
;EEq r
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 0
,GG0 1
	SqlDbTypeGG2 ;
.GG; <
DateTimeGG< D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _

createdUtcGG` j
)GGj k
;GGk l
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# /
,HH/ 0
	SqlDbTypeHH1 :
.HH: ;
UniqueIdentifierHH; K
,HHK L
ParameterDirectionHHM _
.HH_ `
InputHH` e
,HHe f
	createdByHHg p
)HHp q
;HHq r
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
rowsAffectedJJ 
;JJ  
}LL 	
public]] 
static]] 
bool]] 
Update]] !
(]]! "
Guid^^ 
rowGuid^^ 
,^^ 
string__ 
serverFileName__ !
,__! "
string`` 
fileName`` 
,`` 
stringaa 
contentTitleaa 
,aa  
longbb 
contentLengthbb 
,bb 
stringcc 
contentTypecc 
)cc 
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M$
GetWriteConnectionStringeeM e
(eee f
)eef g
,eeg h
$str	eei É
,
eeÉ Ñ
$num
eeÖ Ü
)
eeÜ á
;
eeá à
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# -
,ff- .
	SqlDbTypeff/ 8
.ff8 9
UniqueIdentifierff9 I
,ffI J
ParameterDirectionffK ]
.ff] ^
Inputff^ c
,ffc d
rowGuidffe l
)ffl m
;ffm n
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 4
,gg4 5
	SqlDbTypegg6 ?
.gg? @
NVarChargg@ H
,ggH I
$numggJ M
,ggM N
ParameterDirectionggO a
.gga b
Inputggb g
,ggg h
serverFileNameggi w
)ggw x
;ggx y
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# .
,hh. /
	SqlDbTypehh0 9
.hh9 :
NVarCharhh: B
,hhB C
$numhhD G
,hhG H
ParameterDirectionhhI [
.hh[ \
Inputhh\ a
,hha b
fileNamehhc k
)hhk l
;hhl m
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 2
,ii2 3
	SqlDbTypeii4 =
.ii= >
NVarCharii> F
,iiF G
$numiiH K
,iiK L
ParameterDirectioniiM _
.ii_ `
Inputii` e
,iie f
contentTitleiig s
)iis t
;iit u
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 3
,jj3 4
	SqlDbTypejj5 >
.jj> ?
BigIntjj? E
,jjE F
ParameterDirectionjjG Y
.jjY Z
InputjjZ _
,jj_ `
contentLengthjja n
)jjn o
;jjo p
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 1
,kk1 2
	SqlDbTypekk3 <
.kk< =
NVarCharkk= E
,kkE F
$numkkG I
,kkI J
ParameterDirectionkkK ]
.kk] ^
Inputkk^ c
,kkc d
contentTypekke p
)kkp q
;kkq r
intmm 
rowsAffectedmm 
=mm 
sphmm "
.mm" #
ExecuteNonQuerymm# 2
(mm2 3
)mm3 4
;mm4 5
returnnn 
(nn 
rowsAffectednn  
>nn! "
$numnn# $
)nn$ %
;nn% &
}pp 	
publicww 
staticww 
boolww 
Deleteww !
(ww! "
Guidww" &
rowGuidww' .
)ww. /
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$str	yyi É
,
yyÉ Ñ
$num
yyÖ Ü
)
yyÜ á
;
yyá à
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# -
,zz- .
	SqlDbTypezz/ 8
.zz8 9
UniqueIdentifierzz9 I
,zzI J
ParameterDirectionzzK ]
.zz] ^
Inputzz^ c
,zzc d
rowGuidzze l
)zzl m
;zzm n
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}~~ 	
public
ÖÖ 
static
ÖÖ 
bool
ÖÖ 
DeleteBySite
ÖÖ '
(
ÖÖ' (
Guid
ÖÖ( ,
siteGuid
ÖÖ- 5
)
ÖÖ5 6
{
ÜÜ 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M&
GetWriteConnectionString
ááM e
(
ááe f
)
ááf g
,
áág h
$stráái â
,ááâ ä
$numááã å
)ááå ç
;ááç é
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
int
ââ 
rowsAffected
ââ 
=
ââ 
sph
ââ "
.
ââ" #
ExecuteNonQuery
ââ# 2
(
ââ2 3
)
ââ3 4
;
ââ4 5
return
ää 
(
ää 
rowsAffected
ää  
>
ää! "
$num
ää# $
)
ää$ %
;
ää% &
}
åå 	
public
ìì 
static
ìì 
bool
ìì 
DeleteByModule
ìì )
(
ìì) *
Guid
ìì* .

moduleGuid
ìì/ 9
)
ìì9 :
{
îî 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M&
GetWriteConnectionString
ïïM e
(
ïïe f
)
ïïf g
,
ïïg h
$strïïi ã
,ïïã å
$numïïç é
)ïïé è
;ïïè ê
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 0
,
ññ0 1
	SqlDbType
ññ2 ;
.
ññ; <
UniqueIdentifier
ññ< L
,
ññL M 
ParameterDirection
ññN `
.
ññ` a
Input
ñña f
,
ññf g

moduleGuid
ññh r
)
ññr s
;
ññs t
int
óó 
rowsAffected
óó 
=
óó 
sph
óó "
.
óó" #
ExecuteNonQuery
óó# 2
(
óó2 3
)
óó3 4
;
óó4 5
return
òò 
(
òò 
rowsAffected
òò  
>
òò! "
$num
òò# $
)
òò$ %
;
òò% &
}
öö 	
public
°° 
static
°° 
bool
°° 
DeleteByItem
°° '
(
°°' (
Guid
°°( ,
itemGuid
°°- 5
)
°°5 6
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i â
,££â ä
$num££ã å
)££å ç
;££ç é
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# .
,
§§. /
	SqlDbType
§§0 9
.
§§9 :
UniqueIdentifier
§§: J
,
§§J K 
ParameterDirection
§§L ^
.
§§^ _
Input
§§_ d
,
§§d e
itemGuid
§§f n
)
§§n o
;
§§o p
int
•• 
rowsAffected
•• 
=
•• 
sph
•• "
.
••" #
ExecuteNonQuery
••# 2
(
••2 3
)
••3 4
;
••4 5
return
¶¶ 
(
¶¶ 
rowsAffected
¶¶  
>
¶¶! "
$num
¶¶# $
)
¶¶$ %
;
¶¶% &
}
®® 	
public
ÆÆ 
static
ÆÆ 
IDataReader
ÆÆ !
GetOne
ÆÆ" (
(
ÆÆ( )
Guid
ÆÆ) -
rowGuid
ÆÆ. 5
)
ÆÆ5 6
{
ØØ 	 
SqlParameterHelper
∞∞ 
sph
∞∞ "
=
∞∞# $
new
∞∞% ( 
SqlParameterHelper
∞∞) ;
(
∞∞; <
ConnectionString
∞∞< L
.
∞∞L M%
GetReadConnectionString
∞∞M d
(
∞∞d e
)
∞∞e f
,
∞∞f g
$str∞∞h Ö
,∞∞Ö Ü
$num∞∞á à
)∞∞à â
;∞∞â ä
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# -
,
±±- .
	SqlDbType
±±/ 8
.
±±8 9
UniqueIdentifier
±±9 I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d
rowGuid
±±e l
)
±±l m
;
±±m n
return
≤≤ 
sph
≤≤ 
.
≤≤ 
ExecuteReader
≤≤ $
(
≤≤$ %
)
≤≤% &
;
≤≤& '
}
¥¥ 	
public
∫∫ 
static
∫∫ 
IDataReader
∫∫ !
SelectByModule
∫∫" 0
(
∫∫0 1
Guid
∫∫1 5

moduleGuid
∫∫6 @
)
∫∫@ A
{
ªª 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M%
GetReadConnectionString
ººM d
(
ººd e
)
ººe f
,
ººf g
$strººh ä
,ººä ã
$numººå ç
)ººç é
;ººé è
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# 0
,
ΩΩ0 1
	SqlDbType
ΩΩ2 ;
.
ΩΩ; <
UniqueIdentifier
ΩΩ< L
,
ΩΩL M 
ParameterDirection
ΩΩN `
.
ΩΩ` a
Input
ΩΩa f
,
ΩΩf g

moduleGuid
ΩΩh r
)
ΩΩr s
;
ΩΩs t
return
ææ 
sph
ææ 
.
ææ 
ExecuteReader
ææ $
(
ææ$ %
)
ææ% &
;
ææ& '
}
¿¿ 	
public
∆∆ 
static
∆∆ 
IDataReader
∆∆ !
SelectByItem
∆∆" .
(
∆∆. /
Guid
∆∆/ 3
itemGuid
∆∆4 <
)
∆∆< =
{
«« 	 
SqlParameterHelper
»» 
sph
»» "
=
»»# $
new
»»% ( 
SqlParameterHelper
»») ;
(
»»; <
ConnectionString
»»< L
.
»»L M%
GetReadConnectionString
»»M d
(
»»d e
)
»»e f
,
»»f g
$str»»h à
,»»à â
$num»»ä ã
)»»ã å
;»»å ç
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# .
,
……. /
	SqlDbType
……0 9
.
……9 :
UniqueIdentifier
……: J
,
……J K 
ParameterDirection
……L ^
.
……^ _
Input
……_ d
,
……d e
itemGuid
……f n
)
……n o
;
……o p
return
   
sph
   
.
   
ExecuteReader
   $
(
  $ %
)
  % &
;
  & '
}
ÃÃ 	
public
““ 
static
““ 
IDataReader
““ !
SelectBySpecial1
““" 2
(
““2 3
Guid
““3 7
specialGuid1
““8 D
)
““D E
{
”” 	 
SqlParameterHelper
‘‘ 
sph
‘‘ "
=
‘‘# $
new
‘‘% ( 
SqlParameterHelper
‘‘) ;
(
‘‘; <
ConnectionString
‘‘< L
.
‘‘L M%
GetReadConnectionString
‘‘M d
(
‘‘d e
)
‘‘e f
,
‘‘f g
$str‘‘h å
,‘‘å ç
$num‘‘é è
)‘‘è ê
;‘‘ê ë
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# 2
,
’’2 3
	SqlDbType
’’4 =
.
’’= >
UniqueIdentifier
’’> N
,
’’N O 
ParameterDirection
’’P b
.
’’b c
Input
’’c h
,
’’h i
specialGuid1
’’j v
)
’’v w
;
’’w x
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
ÿÿ 	
public
ﬁﬁ 
static
ﬁﬁ 
IDataReader
ﬁﬁ !
SelectBySpecial2
ﬁﬁ" 2
(
ﬁﬁ2 3
Guid
ﬁﬁ3 7
specialGuid2
ﬁﬁ8 D
)
ﬁﬁD E
{
ﬂﬂ 	 
SqlParameterHelper
‡‡ 
sph
‡‡ "
=
‡‡# $
new
‡‡% ( 
SqlParameterHelper
‡‡) ;
(
‡‡; <
ConnectionString
‡‡< L
.
‡‡L M%
GetReadConnectionString
‡‡M d
(
‡‡d e
)
‡‡e f
,
‡‡f g
$str‡‡h å
,‡‡å ç
$num‡‡é è
)‡‡è ê
;‡‡ê ë
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 2
,
··2 3
	SqlDbType
··4 =
.
··= >
UniqueIdentifier
··> N
,
··N O 
ParameterDirection
··P b
.
··b c
Input
··c h
,
··h i
specialGuid2
··j v
)
··v w
;
··w x
return
‚‚ 
sph
‚‚ 
.
‚‚ 
ExecuteReader
‚‚ $
(
‚‚$ %
)
‚‚% &
;
‚‚& '
}
‰‰ 	
}
ËË 
}ÈÈ í 
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbFriendlyUrl.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBFriendlyUrl %
{ 
public11 
static11 
int11 
AddFriendlyUrl11 (
(11( )
Guid22 
itemGuid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
pageGuid44 
,44 
int55 
siteId55 
,55 
string66 
friendlyUrl66 
,66 
string77 
realUrl77 
,77 
bool88 
	isPattern88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str	::i Å
,
::Å Ç
$num
::É Ñ
)
::Ñ Ö
;
::Ö Ü
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# .
,;;. /
	SqlDbType;;0 9
.;;9 :
UniqueIdentifier;;: J
,;;J K
ParameterDirection;;L ^
.;;^ _
Input;;_ d
,;;d e
itemGuid;;f n
);;n o
;;;o p
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# .
,<<. /
	SqlDbType<<0 9
.<<9 :
UniqueIdentifier<<: J
,<<J K
ParameterDirection<<L ^
.<<^ _
Input<<_ d
,<<d e
siteGuid<<f n
)<<n o
;<<o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# .
,==. /
	SqlDbType==0 9
.==9 :
UniqueIdentifier==: J
,==J K
ParameterDirection==L ^
.==^ _
Input==_ d
,==d e
pageGuid==f n
)==n o
;==o p
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># ,
,>>, -
	SqlDbType>>. 7
.>>7 8
Int>>8 ;
,>>; <
ParameterDirection>>= O
.>>O P
Input>>P U
,>>U V
siteId>>W ]
)>>] ^
;>>^ _
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 1
,??1 2
	SqlDbType??3 <
.??< =
NVarChar??= E
,??E F
$num??G J
,??J K
ParameterDirection??L ^
.??^ _
Input??_ d
,??d e
friendlyUrl??f q
)??q r
;??r s
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# -
,@@- .
	SqlDbType@@/ 8
.@@8 9
NVarChar@@9 A
,@@A B
$num@@C F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
realUrl@@b i
)@@i j
;@@j k
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# /
,AA/ 0
	SqlDbTypeAA1 :
.AA: ;
BitAA; >
,AA> ?
ParameterDirectionAA@ R
.AAR S
InputAAS X
,AAX Y
	isPatternAAZ c
)AAc d
;AAd e
intBB 
newIDBB 
=BB 
ConvertBB 
.BB  
ToInt32BB  '
(BB' (
sphBB( +
.BB+ ,
ExecuteScalarBB, 9
(BB9 :
)BB: ;
)BB; <
;BB< =
returnCC 
newIDCC 
;CC 
}DD 	
publicFF 
staticFF 
boolFF 
UpdateFriendlyUrlFF ,
(FF, -
intGG 
urlIdGG 
,GG 
intHH 
siteIdHH 
,HH 
GuidII 
pageGuidII 
,II 
stringJJ 
friendlyUrlJJ 
,JJ 
stringKK 
realUrlKK 
,KK 
boolLL 
	isPatternLL 
)LL 
{MM 	
SqlParameterHelperNN 
sphNN "
=NN# $
newNN% (
SqlParameterHelperNN) ;
(NN; <
ConnectionStringNN< L
.NNL M$
GetWriteConnectionStringNNM e
(NNe f
)NNf g
,NNg h
$str	NNi Å
,
NNÅ Ç
$num
NNÉ Ñ
)
NNÑ Ö
;
NNÖ Ü
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# +
,OO+ ,
	SqlDbTypeOO- 6
.OO6 7
IntOO7 :
,OO: ;
ParameterDirectionOO< N
.OON O
InputOOO T
,OOT U
urlIdOOV [
)OO[ \
;OO\ ]
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
IntPP8 ;
,PP; <
ParameterDirectionPP= O
.PPO P
InputPPP U
,PPU V
siteIdPPW ]
)PP] ^
;PP^ _
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
friendlyUrlQQf q
)QQq r
;QQr s
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# -
,RR- .
	SqlDbTypeRR/ 8
.RR8 9
NVarCharRR9 A
,RRA B
$numRRC F
,RRF G
ParameterDirectionRRH Z
.RRZ [
InputRR[ `
,RR` a
realUrlRRb i
)RRi j
;RRj k
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# /
,SS/ 0
	SqlDbTypeSS1 :
.SS: ;
BitSS; >
,SS> ?
ParameterDirectionSS@ R
.SSR S
InputSSS X
,SSX Y
	isPatternSSZ c
)SSc d
;SSd e
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
pageGuidTTf n
)TTn o
;TTo p
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
(VV 
rowsAffectedVV  
>VV! "
-VV# $
$numVV$ %
)VV% &
;VV& '
}WW 	
publicYY 
staticYY 
boolYY 
DeleteFriendlyUrlYY ,
(YY, -
intYY- 0
urlIdYY1 6
)YY6 7
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i Å
,
[[Å Ç
$num
[[É Ñ
)
[[Ñ Ö
;
[[Ö Ü
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
Int\\7 :
,\\: ;
ParameterDirection\\< N
.\\N O
Input\\O T
,\\T U
urlId\\V [
)\\[ \
;\\\ ]
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
-^^# $
$num^^$ %
)^^% &
;^^& '
}__ 	
publicaa 
staticaa 
boolaa 
DeleteByPageIdaa )
(aa) *
intaa* -
pageIdaa. 4
)aa4 5
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M$
GetWriteConnectionStringccM e
(cce f
)ccf g
,ccg h
$str	cci â
,
ccâ ä
$num
ccã å
)
ccå ç
;
ccç é
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# ,
,dd, -
	SqlDbTypedd. 7
.dd7 8
Intdd8 ;
,dd; <
ParameterDirectiondd= O
.ddO P
InputddP U
,ddU V
pageIdddW ]
)dd] ^
;dd^ _
intee 
rowsAffectedee 
=ee 
sphee "
.ee" #
ExecuteNonQueryee# 2
(ee2 3
)ee3 4
;ee4 5
returnff 
(ff 
rowsAffectedff  
>ff! "
-ff# $
$numff$ %
)ff% &
;ff& '
}gg 	
publicii 
staticii 
boolii 
DeleteByPageGuidii +
(ii+ ,
Guidii, 0
pageGuidii1 9
)ii9 :
{jj 	
SqlParameterHelperkk 
sphkk "
=kk# $
newkk% (
SqlParameterHelperkk) ;
(kk; <
ConnectionStringkk< L
.kkL M$
GetWriteConnectionStringkkM e
(kke f
)kkf g
,kkg h
$str	kki ã
,
kkã å
$num
kkç é
)
kké è
;
kkè ê
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# .
,ll. /
	SqlDbTypell0 9
.ll9 :
UniqueIdentifierll: J
,llJ K
ParameterDirectionllL ^
.ll^ _
Inputll_ d
,lld e
pageGuidllf n
)lln o
;llo p
intmm 
rowsAffectedmm 
=mm 
sphmm "
.mm" #
ExecuteNonQuerymm# 2
(mm2 3
)mm3 4
;mm4 5
returnnn 
(nn 
rowsAffectednn  
>nn! "
-nn# $
$numnn$ %
)nn% &
;nn& '
}oo 	
publicqq 
staticqq 
IDataReaderqq !
GetFriendlyUrlqq" 0
(qq0 1
intqq1 4
urlIdqq5 :
)qq: ;
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M#
GetReadConnectionStringssM d
(ssd e
)sse f
,ssf g
$str	ssh É
,
ssÉ Ñ
$num
ssÖ Ü
)
ssÜ á
;
ssá à
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# +
,tt+ ,
	SqlDbTypett- 6
.tt6 7
Inttt7 :
,tt: ;
ParameterDirectiontt< N
.ttN O
InputttO T
,ttT U
urlIdttV [
)tt[ \
;tt\ ]
returnuu 
sphuu 
.uu 
ExecuteReaderuu $
(uu$ %
)uu% &
;uu& '
}vv 	
publicxx 
staticxx 
IDataReaderxx !
GetFriendlyUrlxx" 0
(xx0 1
intxx1 4
siteIdxx5 ;
,xx; <
Stringxx= C
friendlyUrlxxD O
)xxO P
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh â
,
zzâ ä
$num
zzã å
)
zzå ç
;
zzç é
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# ,
,{{, -
	SqlDbType{{. 7
.{{7 8
Int{{8 ;
,{{; <
ParameterDirection{{= O
.{{O P
Input{{P U
,{{U V
siteId{{W ]
){{] ^
;{{^ _
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 1
,||1 2
	SqlDbType||3 <
.||< =
NVarChar||= E
,||E F
$num||G J
,||J K
ParameterDirection||L ^
.||^ _
Input||_ d
,||d e
friendlyUrl||f q
)||q r
;||r s
return}} 
sph}} 
.}} 
ExecuteReader}} $
(}}$ %
)}}% &
;}}& '
}~~ 	
public
øø 
static
øø 
IDataReader
øø !
GetByUrl
øø" *
(
øø* +
string
øø+ 1
hostName
øø2 :
,
øø: ;
string
øø< B
friendlyUrl
øøC N
)
øøN O
{
¿¿ 	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h à
,¡¡à â
$num¡¡ä ã
)¡¡ã å
;¡¡å ç
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# .
,
¬¬. /
	SqlDbType
¬¬0 9
.
¬¬9 :
VarChar
¬¬: A
,
¬¬A B
$num
¬¬C F
,
¬¬F G 
ParameterDirection
¬¬H Z
.
¬¬Z [
Input
¬¬[ `
,
¬¬` a
hostName
¬¬b j
)
¬¬j k
;
¬¬k l
sph
√√ 
.
√√  
DefineSqlParameter
√√ "
(
√√" #
$str
√√# 1
,
√√1 2
	SqlDbType
√√3 <
.
√√< =
NVarChar
√√= E
,
√√E F
$num
√√G J
,
√√J K 
ParameterDirection
√√L ^
.
√√^ _
Input
√√_ d
,
√√d e
friendlyUrl
√√f q
)
√√q r
;
√√r s
return
ƒƒ 
sph
ƒƒ 
.
ƒƒ 
ExecuteReader
ƒƒ $
(
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
}
≈≈ 	
public
«« 
static
«« 
bool
«« 
Exists
«« !
(
««! "
int
»» 
siteId
»» 
,
»» 
string
…… 
friendlyUrl
…… 
)
…… 
{
   	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M%
GetReadConnectionString
ÀÀM d
(
ÀÀd e
)
ÀÀe f
,
ÀÀf g
$strÀÀh Ä
,ÀÀÄ Å
$numÀÀÇ É
)ÀÀÉ Ñ
;ÀÀÑ Ö
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# ,
,
ÃÃ, -
	SqlDbType
ÃÃ. 7
.
ÃÃ7 8
Int
ÃÃ8 ;
,
ÃÃ; < 
ParameterDirection
ÃÃ= O
.
ÃÃO P
Input
ÃÃP U
,
ÃÃU V
siteId
ÃÃW ]
)
ÃÃ] ^
;
ÃÃ^ _
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# 1
,
ÕÕ1 2
	SqlDbType
ÕÕ3 <
.
ÕÕ< =
NVarChar
ÕÕ= E
,
ÕÕE F
$num
ÕÕG J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
friendlyUrl
ÕÕf q
)
ÕÕq r
;
ÕÕr s
int
ŒŒ 
count
ŒŒ 
=
ŒŒ 
Convert
ŒŒ 
.
ŒŒ  
ToInt32
ŒŒ  '
(
ŒŒ' (
sph
ŒŒ( +
.
ŒŒ+ ,
ExecuteScalar
ŒŒ, 9
(
ŒŒ9 :
)
ŒŒ: ;
)
ŒŒ; <
;
ŒŒ< =
return
œœ 
(
œœ 
count
œœ 
>
œœ 
$num
œœ 
)
œœ 
;
œœ 
}
–– 	
public
’’ 
static
’’ 
int
’’ 
GetCount
’’ "
(
’’" #
int
’’# &
siteId
’’' -
)
’’- .
{
÷÷ 	 
SqlParameterHelper
◊◊ 
sph
◊◊ "
=
◊◊# $
new
◊◊% ( 
SqlParameterHelper
◊◊) ;
(
◊◊; <
ConnectionString
◊◊< L
.
◊◊L M%
GetReadConnectionString
◊◊M d
(
◊◊d e
)
◊◊e f
,
◊◊f g
$str◊◊h Ç
,◊◊Ç É
$num◊◊Ñ Ö
)◊◊Ö Ü
;◊◊Ü á
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# ,
,
ÿÿ, -
	SqlDbType
ÿÿ. 7
.
ÿÿ7 8
Int
ÿÿ8 ;
,
ÿÿ; < 
ParameterDirection
ÿÿ= O
.
ÿÿO P
Input
ÿÿP U
,
ÿÿU V
siteId
ÿÿW ]
)
ÿÿ] ^
;
ÿÿ^ _
return
ŸŸ 
Convert
ŸŸ 
.
ŸŸ 
ToInt32
ŸŸ "
(
ŸŸ" #
sph
ŸŸ# &
.
ŸŸ& '
ExecuteScalar
ŸŸ' 4
(
ŸŸ4 5
)
ŸŸ5 6
)
ŸŸ6 7
;
ŸŸ7 8
}
‹‹ 	
public
·· 
static
·· 
int
·· 
GetCount
·· "
(
··" #
int
··# &
siteId
··' -
,
··- .
string
··/ 5

searchTerm
··6 @
)
··@ A
{
‚‚ 	 
SqlParameterHelper
„„ 
sph
„„ "
=
„„# $
new
„„% ( 
SqlParameterHelper
„„) ;
(
„„; <
ConnectionString
„„< L
.
„„L M%
GetReadConnectionString
„„M d
(
„„d e
)
„„e f
,
„„f g
$str„„h à
,„„à â
$num„„ä ã
)„„ã å
;„„å ç
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# ,
,
‰‰, -
	SqlDbType
‰‰. 7
.
‰‰7 8
Int
‰‰8 ;
,
‰‰; < 
ParameterDirection
‰‰= O
.
‰‰O P
Input
‰‰P U
,
‰‰U V
siteId
‰‰W ]
)
‰‰] ^
;
‰‰^ _
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# 0
,
ÂÂ0 1
	SqlDbType
ÂÂ2 ;
.
ÂÂ; <
NVarChar
ÂÂ< D
,
ÂÂD E
$num
ÂÂF I
,
ÂÂI J 
ParameterDirection
ÂÂK ]
.
ÂÂ] ^
Input
ÂÂ^ c
,
ÂÂc d

searchTerm
ÂÂe o
)
ÂÂo p
;
ÂÂp q
return
ÊÊ 
Convert
ÊÊ 
.
ÊÊ 
ToInt32
ÊÊ "
(
ÊÊ" #
sph
ÊÊ# &
.
ÊÊ& '
ExecuteScalar
ÊÊ' 4
(
ÊÊ4 5
)
ÊÊ5 6
)
ÊÊ6 7
;
ÊÊ7 8
}
ÈÈ 	
public
ÚÚ 
static
ÚÚ 
IDataReader
ÚÚ !
GetPage
ÚÚ" )
(
ÚÚ) *
int
ÛÛ 
siteId
ÛÛ 
,
ÛÛ 
int
ÙÙ 

pageNumber
ÙÙ 
,
ÙÙ 
int
ıı 
pageSize
ıı 
,
ıı 
out
ˆˆ 
int
ˆˆ 

totalPages
ˆˆ 
)
ˆˆ 
{
˜˜ 	

totalPages
¯¯ 
=
¯¯ 
$num
¯¯ 
;
¯¯ 
int
˘˘ 
	totalRows
˘˘ 
=
˙˙ 
GetCount
˙˙ 
(
˙˙ 
siteId
˙˙ !
)
˙˙! "
;
˙˙" #
if
¸¸ 
(
¸¸ 
pageSize
¸¸ 
>
¸¸ 
$num
¸¸ 
)
¸¸ 

totalPages
¸¸ (
=
¸¸) *
	totalRows
¸¸+ 4
/
¸¸5 6
pageSize
¸¸7 ?
;
¸¸? @
if
˛˛ 
(
˛˛ 
	totalRows
˛˛ 
<=
˛˛ 
pageSize
˛˛ %
)
˛˛% &
{
ˇˇ 

totalPages
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
int
ÑÑ 
	remainder
ÑÑ 
;
ÑÑ 
Math
ÖÖ 
.
ÖÖ 
DivRem
ÖÖ 
(
ÖÖ 
	totalRows
ÖÖ %
,
ÖÖ% &
pageSize
ÖÖ' /
,
ÖÖ/ 0
out
ÖÖ1 4
	remainder
ÖÖ5 >
)
ÖÖ> ?
;
ÖÖ? @
if
ÜÜ 
(
ÜÜ 
	remainder
ÜÜ 
>
ÜÜ 
$num
ÜÜ  !
)
ÜÜ! "
{
áá 

totalPages
àà 
+=
àà !
$num
àà" #
;
àà# $
}
ââ 
}
ää  
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M%
GetReadConnectionString
ååM d
(
ååd e
)
ååe f
,
ååf g
$strååh Ñ
,ååÑ Ö
$numååÜ á
)ååá à
;ååà â
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# ,
,
çç, -
	SqlDbType
çç. 7
.
çç7 8
Int
çç8 ;
,
çç; < 
ParameterDirection
çç= O
.
ççO P
Input
ççP U
,
ççU V
siteId
ççW ]
)
çç] ^
;
çç^ _
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 0
,
éé0 1
	SqlDbType
éé2 ;
.
éé; <
Int
éé< ?
,
éé? @ 
ParameterDirection
ééA S
.
ééS T
Input
ééT Y
,
ééY Z

pageNumber
éé[ e
)
éée f
;
ééf g
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# .
,
èè. /
	SqlDbType
èè0 9
.
èè9 :
Int
èè: =
,
èè= > 
ParameterDirection
èè? Q
.
èèQ R
Input
èèR W
,
èèW X
pageSize
èèY a
)
èèa b
;
èèb c
return
êê 
sph
êê 
.
êê 
ExecuteReader
êê $
(
êê$ %
)
êê% &
;
êê& '
}
íí 	
public
õõ 
static
õõ 
IDataReader
õõ !
GetPage
õõ" )
(
õõ) *
int
úú 
siteId
úú 
,
úú 
string
ùù 

searchTerm
ùù 
,
ùù 
int
ûû 

pageNumber
ûû 
,
ûû 
int
üü 
pageSize
üü 
,
üü 
out
†† 
int
†† 

totalPages
†† 
)
†† 
{
°° 	

totalPages
¢¢ 
=
¢¢ 
$num
¢¢ 
;
¢¢ 
int
££ 
	totalRows
££ 
=
££ 
GetCount
££ $
(
££$ %
siteId
££% +
,
££+ ,

searchTerm
££- 7
)
££7 8
;
££8 9
if
•• 
(
•• 
pageSize
•• 
>
•• 
$num
•• 
)
•• 

totalPages
•• (
=
••) *
	totalRows
••+ 4
/
••5 6
pageSize
••7 ?
;
••? @
if
ßß 
(
ßß 
	totalRows
ßß 
<=
ßß 
pageSize
ßß %
)
ßß% &
{
®® 

totalPages
©© 
=
©© 
$num
©© 
;
©© 
}
™™ 
else
´´ 
{
¨¨ 
int
≠≠ 
	remainder
≠≠ 
;
≠≠ 
Math
ÆÆ 
.
ÆÆ 
DivRem
ÆÆ 
(
ÆÆ 
	totalRows
ÆÆ %
,
ÆÆ% &
pageSize
ÆÆ' /
,
ÆÆ/ 0
out
ÆÆ1 4
	remainder
ÆÆ5 >
)
ÆÆ> ?
;
ÆÆ? @
if
ØØ 
(
ØØ 
	remainder
ØØ 
>
ØØ 
$num
ØØ  !
)
ØØ! "
{
∞∞ 

totalPages
±± 
+=
±± !
$num
±±" #
;
±±# $
}
≤≤ 
}
≥≥  
SqlParameterHelper
µµ 
sph
µµ "
=
µµ# $
new
µµ% ( 
SqlParameterHelper
µµ) ;
(
µµ; <
ConnectionString
µµ< L
.
µµL M%
GetReadConnectionString
µµM d
(
µµd e
)
µµe f
,
µµf g
$strµµh ä
,µµä ã
$numµµå ç
)µµç é
;µµé è
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# ,
,
∂∂, -
	SqlDbType
∂∂. 7
.
∂∂7 8
Int
∂∂8 ;
,
∂∂; < 
ParameterDirection
∂∂= O
.
∂∂O P
Input
∂∂P U
,
∂∂U V
siteId
∂∂W ]
)
∂∂] ^
;
∂∂^ _
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# 0
,
∑∑0 1
	SqlDbType
∑∑2 ;
.
∑∑; <
NVarChar
∑∑< D
,
∑∑D E
$num
∑∑F I
,
∑∑I J 
ParameterDirection
∑∑K ]
.
∑∑] ^
Input
∑∑^ c
,
∑∑c d

searchTerm
∑∑e o
)
∑∑o p
;
∑∑p q
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# 0
,
∏∏0 1
	SqlDbType
∏∏2 ;
.
∏∏; <
Int
∏∏< ?
,
∏∏? @ 
ParameterDirection
∏∏A S
.
∏∏S T
Input
∏∏T Y
,
∏∏Y Z

pageNumber
∏∏[ e
)
∏∏e f
;
∏∏f g
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# .
,
ππ. /
	SqlDbType
ππ0 9
.
ππ9 :
Int
ππ: =
,
ππ= > 
ParameterDirection
ππ? Q
.
ππQ R
Input
ππR W
,
ππW X
pageSize
ππY a
)
ππa b
;
ππb c
return
∫∫ 
sph
∫∫ 
.
∫∫ 
ExecuteReader
∫∫ $
(
∫∫$ %
)
∫∫% &
;
∫∫& '
}
ºº 	
}
øø 
}¿¿ É`
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGeoCountry.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBGeoCountry $
{ 
public77 
static77 
int77 
Create77  
(77  !
Guid88 
guid88 
,88 
string99 
name99 
,99 
string:: 
iSOCode2:: 
,:: 
string;; 
iSOCode3;; 
);; 
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str==i 
,	== Ä
$num
==Å Ç
)
==Ç É
;
==É Ñ
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># *
,>>* +
	SqlDbType>>, 5
.>>5 6
UniqueIdentifier>>6 F
,>>F G
ParameterDirection>>H Z
.>>Z [
Input>>[ `
,>>` a
guid>>b f
)>>f g
;>>g h
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ C
,??C D
ParameterDirection??E W
.??W X
Input??X ]
,??] ^
name??_ c
)??c d
;??d e
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# .
,@@. /
	SqlDbType@@0 9
.@@9 :
NChar@@: ?
,@@? @
$num@@A B
,@@B C
ParameterDirection@@D V
.@@V W
Input@@W \
,@@\ ]
iSOCode2@@^ f
)@@f g
;@@g h
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
NCharAA: ?
,AA? @
$numAAA B
,AAB C
ParameterDirectionAAD V
.AAV W
InputAAW \
,AA\ ]
iSOCode3AA^ f
)AAf g
;AAg h
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
rowsAffectedCC 
;CC  
}EE 	
publicPP 
staticPP 
boolPP 
UpdatePP !
(PP! "
GuidQQ 
guidQQ 
,QQ 
stringRR 
nameRR 
,RR 
stringSS 
iSOCode2SS 
,SS 
stringTT 
iSOCode3TT 
)TT 
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$strVVi 
,	VV Ä
$num
VVÅ Ç
)
VVÇ É
;
VVÉ Ñ
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# *
,WW* +
	SqlDbTypeWW, 5
.WW5 6
UniqueIdentifierWW6 F
,WWF G
ParameterDirectionWWH Z
.WWZ [
InputWW[ `
,WW` a
guidWWb f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# *
,XX* +
	SqlDbTypeXX, 5
.XX5 6
NVarCharXX6 >
,XX> ?
$numXX@ C
,XXC D
ParameterDirectionXXE W
.XXW X
InputXXX ]
,XX] ^
nameXX_ c
)XXc d
;XXd e
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
NCharYY: ?
,YY? @
$numYYA B
,YYB C
ParameterDirectionYYD V
.YYV W
InputYYW \
,YY\ ]
iSOCode2YY^ f
)YYf g
;YYg h
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# .
,ZZ. /
	SqlDbTypeZZ0 9
.ZZ9 :
NCharZZ: ?
,ZZ? @
$numZZA B
,ZZB C
ParameterDirectionZZD V
.ZZV W
InputZZW \
,ZZ\ ]
iSOCode3ZZ^ f
)ZZf g
;ZZg h
int[[ 
rowsAffected[[ 
=[[ 
sph[[ "
.[[" #
ExecuteNonQuery[[# 2
([[2 3
)[[3 4
;[[4 5
return\\ 
(\\ 
rowsAffected\\  
>\\! "
$num\\# $
)\\$ %
;\\% &
}^^ 	
publicee 
staticee 
boolee 
Deleteee !
(ee! "
Guidee" &
guidee' +
)ee+ ,
{ff 	
SqlParameterHelpergg 
sphgg "
=gg# $
newgg% (
SqlParameterHelpergg) ;
(gg; <
ConnectionStringgg< L
.ggL M$
GetWriteConnectionStringggM e
(gge f
)ggf g
,ggg h
$strggi 
,	gg Ä
$num
ggÅ Ç
)
ggÇ É
;
ggÉ Ñ
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# *
,hh* +
	SqlDbTypehh, 5
.hh5 6
UniqueIdentifierhh6 F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
guidhhb f
)hhf g
;hhg h
intii 
rowsAffectedii 
=ii 
sphii "
.ii" #
ExecuteNonQueryii# 2
(ii2 3
)ii3 4
;ii4 5
returnjj 
(jj 
rowsAffectedjj  
>jj! "
$numjj# $
)jj$ %
;jj% &
}ll 	
publicrr 
staticrr 
IDataReaderrr !
GetOnerr" (
(rr( )
Guidrr) -
guidrr. 2
)rr2 3
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M#
GetReadConnectionStringttM d
(ttd e
)tte f
,ttf g
$str	tth Å
,
ttÅ Ç
$num
ttÉ Ñ
)
ttÑ Ö
;
ttÖ Ü
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# *
,uu* +
	SqlDbTypeuu, 5
.uu5 6
UniqueIdentifieruu6 F
,uuF G
ParameterDirectionuuH Z
.uuZ [
Inputuu[ `
,uu` a
guiduub f
)uuf g
;uug h
returnvv 
sphvv 
.vv 
ExecuteReadervv $
(vv$ %
)vv% &
;vv& '
}xx 	
public~~ 
static~~ 
IDataReader~~ !
GetByISOCode2~~" /
(~~/ 0
string~~0 6
countryISOCode2~~7 F
)~~F G
{ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh à
,ÄÄà â
$numÄÄä ã
)ÄÄã å
;ÄÄå ç
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# .
,
ÅÅ. /
	SqlDbType
ÅÅ0 9
.
ÅÅ9 :
NChar
ÅÅ: ?
,
ÅÅ? @
$num
ÅÅA B
,
ÅÅB C 
ParameterDirection
ÅÅD V
.
ÅÅV W
Input
ÅÅW \
,
ÅÅ\ ]
countryISOCode2
ÅÅ^ m
)
ÅÅm n
;
ÅÅn o
return
ÇÇ 
sph
ÇÇ 
.
ÇÇ 
ExecuteReader
ÇÇ $
(
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
}
ÑÑ 	
public
ââ 
static
ââ 
int
ââ 
GetCount
ââ "
(
ââ" #
)
ââ# $
{
ää 	
return
åå 
Convert
åå 
.
åå 
ToInt32
åå "
(
åå" #
	SqlHelper
åå# ,
.
åå, -
ExecuteScalar
åå- :
(
åå: ;
ConnectionString
çç  
.
çç  !%
GetReadConnectionString
çç! 8
(
çç8 9
)
çç9 :
,
çç: ;
CommandType
éé 
.
éé 
StoredProcedure
éé +
,
éé+ ,
$str
èè (
,
èè( )
null
êê 
)
êê 
)
êê 
;
êê 
}
íí 	
public
óó 
static
óó 
IDataReader
óó !
GetAll
óó" (
(
óó( )
)
óó) *
{
òò 	
return
öö 
	SqlHelper
öö 
.
öö 
ExecuteReader
öö *
(
öö* +
ConnectionString
õõ  
.
õõ  !%
GetReadConnectionString
õõ! 8
(
õõ8 9
)
õõ9 :
,
õõ: ;
CommandType
úú 
.
úú 
StoredProcedure
úú +
,
úú+ ,
$str
ùù )
,
ùù) *
null
ûû 
)
ûû 
;
ûû 
}
†† 	
public
®® 
static
®® 
IDataReader
®® !
GetPage
®®" )
(
®®) *
int
©© 

pageNumber
©© 
,
©© 
int
™™ 
pageSize
™™ 
,
™™ 
out
´´ 
int
´´ 

totalPages
´´ 
)
´´ 
{
¨¨ 	

totalPages
≠≠ 
=
≠≠ 
$num
≠≠ 
;
≠≠ 
int
ÆÆ 
	totalRows
ÆÆ 
=
ØØ 
GetCount
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
if
±± 
(
±± 
pageSize
±± 
>
±± 
$num
±± 
)
±± 

totalPages
±± (
=
±±) *
	totalRows
±±+ 4
/
±±5 6
pageSize
±±7 ?
;
±±? @
if
≥≥ 
(
≥≥ 
	totalRows
≥≥ 
<=
≥≥ 
pageSize
≥≥ %
)
≥≥% &
{
¥¥ 

totalPages
µµ 
=
µµ 
$num
µµ 
;
µµ 
}
∂∂ 
else
∑∑ 
{
∏∏ 
int
ππ 
	remainder
ππ 
;
ππ 
Math
∫∫ 
.
∫∫ 
DivRem
∫∫ 
(
∫∫ 
	totalRows
∫∫ %
,
∫∫% &
pageSize
∫∫' /
,
∫∫/ 0
out
∫∫1 4
	remainder
∫∫5 >
)
∫∫> ?
;
∫∫? @
if
ªª 
(
ªª 
	remainder
ªª 
>
ªª 
$num
ªª  !
)
ªª! "
{
ºº 

totalPages
ΩΩ 
+=
ΩΩ !
$num
ΩΩ" #
;
ΩΩ# $
}
ææ 
}
øø  
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h Ç
,¡¡Ç É
$num¡¡Ñ Ö
)¡¡Ö Ü
;¡¡Ü á
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 0
,
¬¬0 1
	SqlDbType
¬¬2 ;
.
¬¬; <
Int
¬¬< ?
,
¬¬? @ 
ParameterDirection
¬¬A S
.
¬¬S T
Input
¬¬T Y
,
¬¬Y Z

pageNumber
¬¬[ e
)
¬¬e f
;
¬¬f g
sph
√√ 
.
√√  
DefineSqlParameter
√√ "
(
√√" #
$str
√√# .
,
√√. /
	SqlDbType
√√0 9
.
√√9 :
Int
√√: =
,
√√= > 
ParameterDirection
√√? Q
.
√√Q R
Input
√√R W
,
√√W X
pageSize
√√Y a
)
√√a b
;
√√b c
return
ƒƒ 
sph
ƒƒ 
.
ƒƒ 
ExecuteReader
ƒƒ $
(
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
}
∆∆ 	
}
»» 
}   ﬁm
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGeoZone.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
	DBGeoZone !
{ 
public66 
static66 
int66 
Create66  
(66  !
Guid77 
guid77 
,77 
Guid88 
countryGuid88 
,88 
string99 
name99 
,99 
string:: 
code:: 
):: 
{;; 	
SqlParameterHelper<< 
sph<< "
=<<# $
new<<% (
SqlParameterHelper<<) ;
(<<; <
ConnectionString<<< L
.<<L M$
GetWriteConnectionString<<M e
(<<e f
)<<f g
,<<g h
$str<<i |
,<<| }
$num<<~ 
)	<< Ä
;
<<Ä Å
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# *
,==* +
	SqlDbType==, 5
.==5 6
UniqueIdentifier==6 F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
guid==b f
)==f g
;==g h
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
UniqueIdentifier>>= M
,>>M N
ParameterDirection>>O a
.>>a b
Input>>b g
,>>g h
countryGuid>>i t
)>>t u
;>>u v
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ C
,??C D
ParameterDirection??E W
.??W X
Input??X ]
,??] ^
name??_ c
)??c d
;??d e
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# *
,@@* +
	SqlDbType@@, 5
.@@5 6
NVarChar@@6 >
,@@> ?
$num@@@ C
,@@C D
ParameterDirection@@E W
.@@W X
Input@@X ]
,@@] ^
code@@_ c
)@@c d
;@@d e
intAA 
rowsAffectedAA 
=AA 
sphAA "
.AA" #
ExecuteNonQueryAA# 2
(AA2 3
)AA3 4
;AA4 5
returnBB 
rowsAffectedBB 
;BB  
}DD 	
publicOO 
staticOO 
boolOO 
UpdateOO !
(OO! "
GuidPP 
guidPP 
,PP 
GuidQQ 
countryGuidQQ 
,QQ 
stringRR 
nameRR 
,RR 
stringSS 
codeSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$strUUi |
,UU| }
$numUU~ 
)	UU Ä
;
UUÄ Å
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 1
,WW1 2
	SqlDbTypeWW3 <
.WW< =
UniqueIdentifierWW= M
,WWM N
ParameterDirectionWWO a
.WWa b
InputWWb g
,WWg h
countryGuidWWi t
)WWt u
;WWu v
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# *
,XX* +
	SqlDbTypeXX, 5
.XX5 6
NVarCharXX6 >
,XX> ?
$numXX@ C
,XXC D
ParameterDirectionXXE W
.XXW X
InputXXX ]
,XX] ^
nameXX_ c
)XXc d
;XXd e
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# *
,YY* +
	SqlDbTypeYY, 5
.YY5 6
NVarCharYY6 >
,YY> ?
$numYY@ C
,YYC D
ParameterDirectionYYE W
.YYW X
InputYYX ]
,YY] ^
codeYY_ c
)YYc d
;YYd e
intZZ 
rowsAffectedZZ 
=ZZ 
sphZZ "
.ZZ" #
ExecuteNonQueryZZ# 2
(ZZ2 3
)ZZ3 4
;ZZ4 5
return[[ 
([[ 
rowsAffected[[  
>[[! "
$num[[# $
)[[$ %
;[[% &
}]] 	
publicdd 
staticdd 
booldd 
Deletedd !
(dd! "
Guiddd" &
guiddd' +
)dd+ ,
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M$
GetWriteConnectionStringffM e
(ffe f
)fff g
,ffg h
$strffi |
,ff| }
$numff~ 
)	ff Ä
;
ffÄ Å
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# *
,gg* +
	SqlDbTypegg, 5
.gg5 6
UniqueIdentifiergg6 F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
guidggb f
)ggf g
;ggg h
inthh 
rowsAffectedhh 
=hh 
sphhh "
.hh" #
ExecuteNonQueryhh# 2
(hh2 3
)hh3 4
;hh4 5
returnii 
(ii 
rowsAffectedii  
>ii! "
$numii# $
)ii$ %
;ii% &
}kk 	
publicqq 
staticqq 
IDataReaderqq !
GetOneqq" (
(qq( )
Guidqq) -
guidqq. 2
)qq2 3
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M#
GetReadConnectionStringssM d
(ssd e
)sse f
,ssf g
$strssh ~
,ss~ 
$num
ssÄ Å
)
ssÅ Ç
;
ssÇ É
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# *
,tt* +
	SqlDbTypett, 5
.tt5 6
UniqueIdentifiertt6 F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
guidttb f
)ttf g
;ttg h
returnuu 
sphuu 
.uu 
ExecuteReaderuu $
(uu$ %
)uu% &
;uu& '
}ww 	
public}} 
static}} 
IDataReader}} !
	GetByCode}}" +
(}}+ ,
Guid}}, 0
countryGuid}}1 <
,}}< =
string}}> D
code}}E I
)}}I J
{~~ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h Å
,
Å Ç
$num
É Ñ
)
Ñ Ö
;
Ö Ü
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# 1
,
ÄÄ1 2
	SqlDbType
ÄÄ3 <
.
ÄÄ< =
UniqueIdentifier
ÄÄ= M
,
ÄÄM N 
ParameterDirection
ÄÄO a
.
ÄÄa b
Input
ÄÄb g
,
ÄÄg h
countryGuid
ÄÄi t
)
ÄÄt u
;
ÄÄu v
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# *
,
ÅÅ* +
	SqlDbType
ÅÅ, 5
.
ÅÅ5 6
NVarChar
ÅÅ6 >
,
ÅÅ> ?
$num
ÅÅ@ C
,
ÅÅC D 
ParameterDirection
ÅÅE W
.
ÅÅW X
Input
ÅÅX ]
,
ÅÅ] ^
code
ÅÅ_ c
)
ÅÅc d
;
ÅÅd e
return
ÇÇ 
sph
ÇÇ 
.
ÇÇ 
ExecuteReader
ÇÇ $
(
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
}
ÑÑ 	
public
ââ 
static
ââ 
int
ââ 
GetCount
ââ "
(
ââ" #
Guid
ââ# '
countryGuid
ââ( 3
)
ââ3 4
{
ää 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M%
GetReadConnectionString
ååM d
(
ååd e
)
ååe f
,
ååf g
$strååh Ü
,ååÜ á
$numååà â
)ååâ ä
;ååä ã
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 1
,
çç1 2
	SqlDbType
çç3 <
.
çç< =
UniqueIdentifier
çç= M
,
ççM N 
ParameterDirection
ççO a
.
çça b
Input
ççb g
,
ççg h
countryGuid
ççi t
)
ççt u
;
ççu v
return
éé 
Convert
éé 
.
éé 
ToInt32
éé "
(
éé" #
sph
éé# &
.
éé& '
ExecuteScalar
éé' 4
(
éé4 5
)
éé5 6
)
éé6 7
;
éé7 8
}
ëë 	
public
ññ 
static
ññ 
IDataReader
ññ !
GetByCountry
ññ" .
(
ññ. /
Guid
ññ/ 3
countryGuid
ññ4 ?
)
ññ? @
{
óó 	 
SqlParameterHelper
òò 
sph
òò "
=
òò# $
new
òò% ( 
SqlParameterHelper
òò) ;
(
òò; <
ConnectionString
òò< L
.
òòL M%
GetReadConnectionString
òòM d
(
òòd e
)
òòe f
,
òòf g
$stròòh Ñ
,òòÑ Ö
$numòòÜ á
)òòá à
;òòà â
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# 1
,
ôô1 2
	SqlDbType
ôô3 <
.
ôô< =
UniqueIdentifier
ôô= M
,
ôôM N 
ParameterDirection
ôôO a
.
ôôa b
Input
ôôb g
,
ôôg h
countryGuid
ôôi t
)
ôôt u
;
ôôu v
return
öö 
sph
öö 
.
öö 
ExecuteReader
öö $
(
öö$ %
)
öö% &
;
öö& '
}
ùù 	
public
•• 
static
•• 
IDataReader
•• !
GetPage
••" )
(
••) *
Guid
¶¶ 
countryGuid
¶¶ 
,
¶¶ 
int
ßß 

pageNumber
ßß 
,
ßß 
int
®® 
pageSize
®® 
,
®® 
out
©© 
int
©© 

totalPages
©© 
)
©© 
{
™™ 	

totalPages
´´ 
=
´´ 
$num
´´ 
;
´´ 
int
¨¨ 
	totalRows
¨¨ 
=
≠≠ 
GetCount
≠≠ 
(
≠≠ 
countryGuid
≠≠ &
)
≠≠& '
;
≠≠' (
if
ØØ 
(
ØØ 
pageSize
ØØ 
>
ØØ 
$num
ØØ 
)
ØØ 

totalPages
ØØ (
=
ØØ) *
	totalRows
ØØ+ 4
/
ØØ5 6
pageSize
ØØ7 ?
;
ØØ? @
if
±± 
(
±± 
	totalRows
±± 
<=
±± 
pageSize
±± %
)
±±% &
{
≤≤ 

totalPages
≥≥ 
=
≥≥ 
$num
≥≥ 
;
≥≥ 
}
¥¥ 
else
µµ 
{
∂∂ 
int
∑∑ 
	remainder
∑∑ 
;
∑∑ 
Math
∏∏ 
.
∏∏ 
DivRem
∏∏ 
(
∏∏ 
	totalRows
∏∏ %
,
∏∏% &
pageSize
∏∏' /
,
∏∏/ 0
out
∏∏1 4
	remainder
∏∏5 >
)
∏∏> ?
;
∏∏? @
if
ππ 
(
ππ 
	remainder
ππ 
>
ππ 
$num
ππ  !
)
ππ! "
{
∫∫ 

totalPages
ªª 
+=
ªª !
$num
ªª" #
;
ªª# $
}
ºº 
}
ΩΩ  
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M%
GetReadConnectionString
øøM d
(
øød e
)
øøe f
,
øøf g
$strøøh à
,øøà â
$numøøä ã
)øøã å
;øøå ç
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 1
,
¿¿1 2
	SqlDbType
¿¿3 <
.
¿¿< =
UniqueIdentifier
¿¿= M
,
¿¿M N 
ParameterDirection
¿¿O a
.
¿¿a b
Input
¿¿b g
,
¿¿g h
countryGuid
¿¿i t
)
¿¿t u
;
¿¿u v
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 0
,
¡¡0 1
	SqlDbType
¡¡2 ;
.
¡¡; <
Int
¡¡< ?
,
¡¡? @ 
ParameterDirection
¡¡A S
.
¡¡S T
Input
¡¡T Y
,
¡¡Y Z

pageNumber
¡¡[ e
)
¡¡e f
;
¡¡f g
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# .
,
¬¬. /
	SqlDbType
¬¬0 9
.
¬¬9 :
Int
¬¬: =
,
¬¬= > 
ParameterDirection
¬¬? Q
.
¬¬Q R
Input
¬¬R W
,
¬¬W X
pageSize
¬¬Y a
)
¬¬a b
;
¬¬b c
return
√√ 
sph
√√ 
.
√√ 
ExecuteReader
√√ $
(
√√$ %
)
√√% &
;
√√& '
}
≈≈ 	
}
«« 
}…… ÷€
sD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGoogleCheckoutLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBGoogleCheckoutLog +
{ 
publicII 
staticII 
intII 
CreateII  
(II  !
GuidJJ 
rowGuidJJ 
,JJ 
DateTimeKK 

createdUtcKK 
,KK  
GuidLL 
siteGuidLL 
,LL 
GuidMM 
userGuidMM 
,MM 
GuidNN 
	storeGuidNN 
,NN 
GuidOO 
cartGuidOO 
,OO 
stringPP 
notificationTypePP #
,PP# $
stringQQ 
rawResponseQQ 
,QQ 
stringRR 
serialNumberRR 
,RR  
DateTimeSS 

gTimestampSS 
,SS  
stringTT 
orderNumberTT 
,TT 
stringUU 
buyerIdUU 
,UU 
stringVV 
fullfillStateVV  
,VV  !
stringWW 
financeStateWW 
,WW  
boolXX 
emailListOptInXX 
,XX  
stringYY 
avsResponseYY 
,YY 
stringZZ 
cvnResponseZZ 
,ZZ 
DateTime[[ 
authExpDate[[  
,[[  !
decimal\\ 
authAmt\\ 
,\\ 
decimal]] 
discountTotal]] !
,]]! "
decimal^^ 
shippingTotal^^ !
,^^! "
decimal__ 
taxTotal__ 
,__ 
decimal`` 

orderTotal`` 
,`` 
decimalaa 
latestChgAmtaa  
,aa  !
decimalbb 
totalChgAmtbb 
,bb  
decimalcc 
latestRefundAmtcc #
,cc# $
decimaldd 
totalRefundAmtdd "
,dd" #
decimalee 
latestChargebackee $
,ee$ %
decimalff 
totalChargebackff #
,ff# $
stringgg 
cartXmlgg 
,gg 
stringhh 
providerNamehh 
)hh  
{ii 	
SqlParameterHelperjj 
sphjj "
=jj# $
newjj% (
SqlParameterHelperjj) ;
(jj; <
ConnectionStringjj< L
.jjL M$
GetWriteConnectionStringjjM e
(jje f
)jjf g
,jjg h
$str	jji Ü
,
jjÜ á
$num
jjà ä
)
jjä ã
;
jjã å
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# -
,kk- .
	SqlDbTypekk/ 8
.kk8 9
UniqueIdentifierkk9 I
,kkI J
ParameterDirectionkkK ]
.kk] ^
Inputkk^ c
,kkc d
rowGuidkke l
)kkl m
;kkm n
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
DateTimell< D
,llD E
ParameterDirectionllF X
.llX Y
InputllY ^
,ll^ _

createdUtcll` j
)llj k
;llk l
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# .
,mm. /
	SqlDbTypemm0 9
.mm9 :
UniqueIdentifiermm: J
,mmJ K
ParameterDirectionmmL ^
.mm^ _
Inputmm_ d
,mmd e
siteGuidmmf n
)mmn o
;mmo p
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# .
,nn. /
	SqlDbTypenn0 9
.nn9 :
UniqueIdentifiernn: J
,nnJ K
ParameterDirectionnnL ^
.nn^ _
Inputnn_ d
,nnd e
userGuidnnf n
)nnn o
;nno p
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# /
,oo/ 0
	SqlDbTypeoo1 :
.oo: ;
UniqueIdentifieroo; K
,ooK L
ParameterDirectionooM _
.oo_ `
Inputoo` e
,ooe f
	storeGuidoog p
)oop q
;ooq r
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# .
,pp. /
	SqlDbTypepp0 9
.pp9 :
UniqueIdentifierpp: J
,ppJ K
ParameterDirectionppL ^
.pp^ _
Inputpp_ d
,ppd e
cartGuidppf n
)ppn o
;ppo p
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 6
,qq6 7
	SqlDbTypeqq8 A
.qqA B
NVarCharqqB J
,qqJ K
$numqqL O
,qqO P
ParameterDirectionqqQ c
.qqc d
Inputqqd i
,qqi j
notificationTypeqqk {
)qq{ |
;qq| }
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 1
,rr1 2
	SqlDbTyperr3 <
.rr< =
NVarCharrr= E
,rrE F
-rrG H
$numrrH I
,rrI J
ParameterDirectionrrK ]
.rr] ^
Inputrr^ c
,rrc d
rawResponserre p
)rrp q
;rrq r
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 2
,ss2 3
	SqlDbTypess4 =
.ss= >
NVarCharss> F
,ssF G
$numssH J
,ssJ K
ParameterDirectionssL ^
.ss^ _
Inputss_ d
,ssd e
serialNumberssf r
)ssr s
;sss t
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 0
,tt0 1
	SqlDbTypett2 ;
.tt; <
DateTimett< D
,ttD E
ParameterDirectionttF X
.ttX Y
InputttY ^
,tt^ _

gTimestamptt` j
)ttj k
;ttk l
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# 1
,uu1 2
	SqlDbTypeuu3 <
.uu< =
NVarCharuu= E
,uuE F
$numuuG I
,uuI J
ParameterDirectionuuK ]
.uu] ^
Inputuu^ c
,uuc d
orderNumberuue p
)uup q
;uuq r
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# -
,vv- .
	SqlDbTypevv/ 8
.vv8 9
NVarCharvv9 A
,vvA B
$numvvC E
,vvE F
ParameterDirectionvvG Y
.vvY Z
InputvvZ _
,vv_ `
buyerIdvva h
)vvh i
;vvi j
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 3
,ww3 4
	SqlDbTypeww5 >
.ww> ?
NVarCharww? G
,wwG H
$numwwI K
,wwK L
ParameterDirectionwwM _
.ww_ `
Inputww` e
,wwe f
fullfillStatewwg t
)wwt u
;wwu v
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 2
,xx2 3
	SqlDbTypexx4 =
.xx= >
NVarCharxx> F
,xxF G
$numxxH J
,xxJ K
ParameterDirectionxxL ^
.xx^ _
Inputxx_ d
,xxd e
financeStatexxf r
)xxr s
;xxs t
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 4
,yy4 5
	SqlDbTypeyy6 ?
.yy? @
Bityy@ C
,yyC D
ParameterDirectionyyE W
.yyW X
InputyyX ]
,yy] ^
emailListOptInyy_ m
)yym n
;yyn o
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
NVarCharzz= E
,zzE F
$numzzG H
,zzH I
ParameterDirectionzzJ \
.zz\ ]
Inputzz] b
,zzb c
avsResponsezzd o
)zzo p
;zzp q
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 1
,{{1 2
	SqlDbType{{3 <
.{{< =
NVarChar{{= E
,{{E F
$num{{G H
,{{H I
ParameterDirection{{J \
.{{\ ]
Input{{] b
,{{b c
cvnResponse{{d o
){{o p
;{{p q
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 1
,||1 2
	SqlDbType||3 <
.||< =
DateTime||= E
,||E F
ParameterDirection||G Y
.||Y Z
Input||Z _
,||_ `
authExpDate||a l
)||l m
;||m n
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# -
,}}- .
	SqlDbType}}/ 8
.}}8 9
Decimal}}9 @
,}}@ A
ParameterDirection}}B T
.}}T U
Input}}U Z
,}}Z [
authAmt}}\ c
)}}c d
;}}d e
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 3
,~~3 4
	SqlDbType~~5 >
.~~> ?
Decimal~~? F
,~~F G
ParameterDirection~~H Z
.~~Z [
Input~~[ `
,~~` a
discountTotal~~b o
)~~o p
;~~p q
sph 
. 
DefineSqlParameter "
(" #
$str# 3
,3 4
	SqlDbType5 >
.> ?
Decimal? F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
shippingTotalb o
)o p
;p q
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
Decimal
ÄÄ: A
,
ÄÄA B 
ParameterDirection
ÄÄC U
.
ÄÄU V
Input
ÄÄV [
,
ÄÄ[ \
taxTotal
ÄÄ] e
)
ÄÄe f
;
ÄÄf g
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 0
,
ÅÅ0 1
	SqlDbType
ÅÅ2 ;
.
ÅÅ; <
Decimal
ÅÅ< C
,
ÅÅC D 
ParameterDirection
ÅÅE W
.
ÅÅW X
Input
ÅÅX ]
,
ÅÅ] ^

orderTotal
ÅÅ_ i
)
ÅÅi j
;
ÅÅj k
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 2
,
ÇÇ2 3
	SqlDbType
ÇÇ4 =
.
ÇÇ= >
Decimal
ÇÇ> E
,
ÇÇE F 
ParameterDirection
ÇÇG Y
.
ÇÇY Z
Input
ÇÇZ _
,
ÇÇ_ `
latestChgAmt
ÇÇa m
)
ÇÇm n
;
ÇÇn o
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 1
,
ÉÉ1 2
	SqlDbType
ÉÉ3 <
.
ÉÉ< =
Decimal
ÉÉ= D
,
ÉÉD E 
ParameterDirection
ÉÉF X
.
ÉÉX Y
Input
ÉÉY ^
,
ÉÉ^ _
totalChgAmt
ÉÉ` k
)
ÉÉk l
;
ÉÉl m
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 5
,
ÑÑ5 6
	SqlDbType
ÑÑ7 @
.
ÑÑ@ A
Decimal
ÑÑA H
,
ÑÑH I 
ParameterDirection
ÑÑJ \
.
ÑÑ\ ]
Input
ÑÑ] b
,
ÑÑb c
latestRefundAmt
ÑÑd s
)
ÑÑs t
;
ÑÑt u
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 4
,
ÖÖ4 5
	SqlDbType
ÖÖ6 ?
.
ÖÖ? @
Decimal
ÖÖ@ G
,
ÖÖG H 
ParameterDirection
ÖÖI [
.
ÖÖ[ \
Input
ÖÖ\ a
,
ÖÖa b
totalRefundAmt
ÖÖc q
)
ÖÖq r
;
ÖÖr s
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 6
,
ÜÜ6 7
	SqlDbType
ÜÜ8 A
.
ÜÜA B
Decimal
ÜÜB I
,
ÜÜI J 
ParameterDirection
ÜÜK ]
.
ÜÜ] ^
Input
ÜÜ^ c
,
ÜÜc d
latestChargeback
ÜÜe u
)
ÜÜu v
;
ÜÜv w
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 5
,
áá5 6
	SqlDbType
áá7 @
.
áá@ A
Decimal
ááA H
,
ááH I 
ParameterDirection
ááJ \
.
áá\ ]
Input
áá] b
,
ááb c
totalChargeback
áád s
)
áás t
;
áát u
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# -
,
àà- .
	SqlDbType
àà/ 8
.
àà8 9
NVarChar
àà9 A
,
ààA B
-
ààC D
$num
ààD E
,
ààE F 
ParameterDirection
ààG Y
.
ààY Z
Input
ààZ _
,
àà_ `
cartXml
ààa h
)
ààh i
;
àài j
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 2
,
ââ2 3
	SqlDbType
ââ4 =
.
ââ= >
NVarChar
ââ> F
,
ââF G
$num
ââH K
,
ââK L 
ParameterDirection
ââM _
.
ââ_ `
Input
ââ` e
,
ââe f
providerName
ââg s
)
ââs t
;
âât u
int
ää 
rowsAffected
ää 
=
ää 
sph
ää "
.
ää" #
ExecuteNonQuery
ää# 2
(
ää2 3
)
ää3 4
;
ää4 5
return
ãã 
rowsAffected
ãã 
;
ãã  
}
çç 	
public
≤≤ 
static
≤≤ 
bool
≤≤ 
Update
≤≤ !
(
≤≤! "
Guid
≥≥ 
rowGuid
≥≥ 
,
≥≥ 
DateTime
¥¥ 

createdUtc
¥¥ 
,
¥¥  
Guid
µµ 
siteGuid
µµ 
,
µµ 
Guid
∂∂ 
userGuid
∂∂ 
,
∂∂ 
Guid
∑∑ 
	storeGuid
∑∑ 
,
∑∑ 
Guid
∏∏ 
cartGuid
∏∏ 
,
∏∏ 
string
ππ 
notificationType
ππ #
,
ππ# $
string
∫∫ 
rawResponse
∫∫ 
,
∫∫ 
string
ªª 
serialNumber
ªª 
,
ªª  
DateTime
ºº 

gTimestamp
ºº 
,
ºº  
string
ΩΩ 
orderNumber
ΩΩ 
,
ΩΩ 
string
ææ 
buyerId
ææ 
,
ææ 
string
øø 
fullfillState
øø  
,
øø  !
string
¿¿ 
financeState
¿¿ 
,
¿¿  
bool
¡¡ 
emailListOptIn
¡¡ 
,
¡¡  
string
¬¬ 
avsResponse
¬¬ 
,
¬¬ 
string
√√ 
cvnResponse
√√ 
,
√√ 
DateTime
ƒƒ 
authExpDate
ƒƒ  
,
ƒƒ  !
decimal
≈≈ 
authAmt
≈≈ 
,
≈≈ 
decimal
∆∆ 
discountTotal
∆∆ !
,
∆∆! "
decimal
«« 
shippingTotal
«« !
,
««! "
decimal
»» 
taxTotal
»» 
,
»» 
decimal
…… 

orderTotal
…… 
,
…… 
decimal
   
latestChgAmt
    
,
    !
decimal
ÀÀ 
totalChgAmt
ÀÀ 
,
ÀÀ  
decimal
ÃÃ 
latestRefundAmt
ÃÃ #
,
ÃÃ# $
decimal
ÕÕ 
totalRefundAmt
ÕÕ "
,
ÕÕ" #
decimal
ŒŒ 
latestChargeback
ŒŒ $
,
ŒŒ$ %
decimal
œœ 
totalChargeback
œœ #
,
œœ# $
string
–– 
cartXml
–– 
)
–– 
{
—— 	 
SqlParameterHelper
““ 
sph
““ "
=
““# $
new
““% ( 
SqlParameterHelper
““) ;
(
““; <
ConnectionString
““< L
.
““L M&
GetWriteConnectionString
““M e
(
““e f
)
““f g
,
““g h
$str““i Ü
,““Ü á
$num““à ä
)““ä ã
;““ã å
sph
”” 
.
””  
DefineSqlParameter
”” "
(
””" #
$str
””# -
,
””- .
	SqlDbType
””/ 8
.
””8 9
UniqueIdentifier
””9 I
,
””I J 
ParameterDirection
””K ]
.
””] ^
Input
””^ c
,
””c d
rowGuid
””e l
)
””l m
;
””m n
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# 0
,
‘‘0 1
	SqlDbType
‘‘2 ;
.
‘‘; <
DateTime
‘‘< D
,
‘‘D E 
ParameterDirection
‘‘F X
.
‘‘X Y
Input
‘‘Y ^
,
‘‘^ _

createdUtc
‘‘` j
)
‘‘j k
;
‘‘k l
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# .
,
’’. /
	SqlDbType
’’0 9
.
’’9 :
UniqueIdentifier
’’: J
,
’’J K 
ParameterDirection
’’L ^
.
’’^ _
Input
’’_ d
,
’’d e
siteGuid
’’f n
)
’’n o
;
’’o p
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# .
,
÷÷. /
	SqlDbType
÷÷0 9
.
÷÷9 :
UniqueIdentifier
÷÷: J
,
÷÷J K 
ParameterDirection
÷÷L ^
.
÷÷^ _
Input
÷÷_ d
,
÷÷d e
userGuid
÷÷f n
)
÷÷n o
;
÷÷o p
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ "
(
◊◊" #
$str
◊◊# /
,
◊◊/ 0
	SqlDbType
◊◊1 :
.
◊◊: ;
UniqueIdentifier
◊◊; K
,
◊◊K L 
ParameterDirection
◊◊M _
.
◊◊_ `
Input
◊◊` e
,
◊◊e f
	storeGuid
◊◊g p
)
◊◊p q
;
◊◊q r
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# .
,
ÿÿ. /
	SqlDbType
ÿÿ0 9
.
ÿÿ9 :
UniqueIdentifier
ÿÿ: J
,
ÿÿJ K 
ParameterDirection
ÿÿL ^
.
ÿÿ^ _
Input
ÿÿ_ d
,
ÿÿd e
cartGuid
ÿÿf n
)
ÿÿn o
;
ÿÿo p
sph
ŸŸ 
.
ŸŸ  
DefineSqlParameter
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# 6
,
ŸŸ6 7
	SqlDbType
ŸŸ8 A
.
ŸŸA B
NVarChar
ŸŸB J
,
ŸŸJ K
$num
ŸŸL O
,
ŸŸO P 
ParameterDirection
ŸŸQ c
.
ŸŸc d
Input
ŸŸd i
,
ŸŸi j
notificationType
ŸŸk {
)
ŸŸ{ |
;
ŸŸ| }
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# 1
,
⁄⁄1 2
	SqlDbType
⁄⁄3 <
.
⁄⁄< =
NVarChar
⁄⁄= E
,
⁄⁄E F
-
⁄⁄G H
$num
⁄⁄H I
,
⁄⁄I J 
ParameterDirection
⁄⁄K ]
.
⁄⁄] ^
Input
⁄⁄^ c
,
⁄⁄c d
rawResponse
⁄⁄e p
)
⁄⁄p q
;
⁄⁄q r
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# 2
,
€€2 3
	SqlDbType
€€4 =
.
€€= >
NVarChar
€€> F
,
€€F G
$num
€€H J
,
€€J K 
ParameterDirection
€€L ^
.
€€^ _
Input
€€_ d
,
€€d e
serialNumber
€€f r
)
€€r s
;
€€s t
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# 0
,
‹‹0 1
	SqlDbType
‹‹2 ;
.
‹‹; <
DateTime
‹‹< D
,
‹‹D E 
ParameterDirection
‹‹F X
.
‹‹X Y
Input
‹‹Y ^
,
‹‹^ _

gTimestamp
‹‹` j
)
‹‹j k
;
‹‹k l
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# 1
,
››1 2
	SqlDbType
››3 <
.
››< =
NVarChar
››= E
,
››E F
$num
››G I
,
››I J 
ParameterDirection
››K ]
.
››] ^
Input
››^ c
,
››c d
orderNumber
››e p
)
››p q
;
››q r
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# -
,
ﬁﬁ- .
	SqlDbType
ﬁﬁ/ 8
.
ﬁﬁ8 9
NVarChar
ﬁﬁ9 A
,
ﬁﬁA B
$num
ﬁﬁC E
,
ﬁﬁE F 
ParameterDirection
ﬁﬁG Y
.
ﬁﬁY Z
Input
ﬁﬁZ _
,
ﬁﬁ_ `
buyerId
ﬁﬁa h
)
ﬁﬁh i
;
ﬁﬁi j
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# 3
,
ﬂﬂ3 4
	SqlDbType
ﬂﬂ5 >
.
ﬂﬂ> ?
NVarChar
ﬂﬂ? G
,
ﬂﬂG H
$num
ﬂﬂI K
,
ﬂﬂK L 
ParameterDirection
ﬂﬂM _
.
ﬂﬂ_ `
Input
ﬂﬂ` e
,
ﬂﬂe f
fullfillState
ﬂﬂg t
)
ﬂﬂt u
;
ﬂﬂu v
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# 2
,
‡‡2 3
	SqlDbType
‡‡4 =
.
‡‡= >
NVarChar
‡‡> F
,
‡‡F G
$num
‡‡H J
,
‡‡J K 
ParameterDirection
‡‡L ^
.
‡‡^ _
Input
‡‡_ d
,
‡‡d e
financeState
‡‡f r
)
‡‡r s
;
‡‡s t
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 4
,
··4 5
	SqlDbType
··6 ?
.
··? @
Bit
··@ C
,
··C D 
ParameterDirection
··E W
.
··W X
Input
··X ]
,
··] ^
emailListOptIn
··_ m
)
··m n
;
··n o
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ "
(
‚‚" #
$str
‚‚# 1
,
‚‚1 2
	SqlDbType
‚‚3 <
.
‚‚< =
NVarChar
‚‚= E
,
‚‚E F
$num
‚‚G H
,
‚‚H I 
ParameterDirection
‚‚J \
.
‚‚\ ]
Input
‚‚] b
,
‚‚b c
avsResponse
‚‚d o
)
‚‚o p
;
‚‚p q
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# 1
,
„„1 2
	SqlDbType
„„3 <
.
„„< =
NVarChar
„„= E
,
„„E F
$num
„„G H
,
„„H I 
ParameterDirection
„„J \
.
„„\ ]
Input
„„] b
,
„„b c
cvnResponse
„„d o
)
„„o p
;
„„p q
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# 1
,
‰‰1 2
	SqlDbType
‰‰3 <
.
‰‰< =
DateTime
‰‰= E
,
‰‰E F 
ParameterDirection
‰‰G Y
.
‰‰Y Z
Input
‰‰Z _
,
‰‰_ `
authExpDate
‰‰a l
)
‰‰l m
;
‰‰m n
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# -
,
ÂÂ- .
	SqlDbType
ÂÂ/ 8
.
ÂÂ8 9
Decimal
ÂÂ9 @
,
ÂÂ@ A 
ParameterDirection
ÂÂB T
.
ÂÂT U
Input
ÂÂU Z
,
ÂÂZ [
authAmt
ÂÂ\ c
)
ÂÂc d
;
ÂÂd e
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 3
,
ÊÊ3 4
	SqlDbType
ÊÊ5 >
.
ÊÊ> ?
Decimal
ÊÊ? F
,
ÊÊF G 
ParameterDirection
ÊÊH Z
.
ÊÊZ [
Input
ÊÊ[ `
,
ÊÊ` a
discountTotal
ÊÊb o
)
ÊÊo p
;
ÊÊp q
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 3
,
ÁÁ3 4
	SqlDbType
ÁÁ5 >
.
ÁÁ> ?
Decimal
ÁÁ? F
,
ÁÁF G 
ParameterDirection
ÁÁH Z
.
ÁÁZ [
Input
ÁÁ[ `
,
ÁÁ` a
shippingTotal
ÁÁb o
)
ÁÁo p
;
ÁÁp q
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# .
,
ËË. /
	SqlDbType
ËË0 9
.
ËË9 :
Decimal
ËË: A
,
ËËA B 
ParameterDirection
ËËC U
.
ËËU V
Input
ËËV [
,
ËË[ \
taxTotal
ËË] e
)
ËËe f
;
ËËf g
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 0
,
ÈÈ0 1
	SqlDbType
ÈÈ2 ;
.
ÈÈ; <
Decimal
ÈÈ< C
,
ÈÈC D 
ParameterDirection
ÈÈE W
.
ÈÈW X
Input
ÈÈX ]
,
ÈÈ] ^

orderTotal
ÈÈ_ i
)
ÈÈi j
;
ÈÈj k
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 2
,
ÍÍ2 3
	SqlDbType
ÍÍ4 =
.
ÍÍ= >
Decimal
ÍÍ> E
,
ÍÍE F 
ParameterDirection
ÍÍG Y
.
ÍÍY Z
Input
ÍÍZ _
,
ÍÍ_ `
latestChgAmt
ÍÍa m
)
ÍÍm n
;
ÍÍn o
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 1
,
ÎÎ1 2
	SqlDbType
ÎÎ3 <
.
ÎÎ< =
Decimal
ÎÎ= D
,
ÎÎD E 
ParameterDirection
ÎÎF X
.
ÎÎX Y
Input
ÎÎY ^
,
ÎÎ^ _
totalChgAmt
ÎÎ` k
)
ÎÎk l
;
ÎÎl m
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# 5
,
ÏÏ5 6
	SqlDbType
ÏÏ7 @
.
ÏÏ@ A
Decimal
ÏÏA H
,
ÏÏH I 
ParameterDirection
ÏÏJ \
.
ÏÏ\ ]
Input
ÏÏ] b
,
ÏÏb c
latestRefundAmt
ÏÏd s
)
ÏÏs t
;
ÏÏt u
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# 4
,
ÌÌ4 5
	SqlDbType
ÌÌ6 ?
.
ÌÌ? @
Decimal
ÌÌ@ G
,
ÌÌG H 
ParameterDirection
ÌÌI [
.
ÌÌ[ \
Input
ÌÌ\ a
,
ÌÌa b
totalRefundAmt
ÌÌc q
)
ÌÌq r
;
ÌÌr s
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# 6
,
ÓÓ6 7
	SqlDbType
ÓÓ8 A
.
ÓÓA B
Decimal
ÓÓB I
,
ÓÓI J 
ParameterDirection
ÓÓK ]
.
ÓÓ] ^
Input
ÓÓ^ c
,
ÓÓc d
latestChargeback
ÓÓe u
)
ÓÓu v
;
ÓÓv w
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# 5
,
ÔÔ5 6
	SqlDbType
ÔÔ7 @
.
ÔÔ@ A
Decimal
ÔÔA H
,
ÔÔH I 
ParameterDirection
ÔÔJ \
.
ÔÔ\ ]
Input
ÔÔ] b
,
ÔÔb c
totalChargeback
ÔÔd s
)
ÔÔs t
;
ÔÔt u
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
-
C D
$num
D E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
cartXml
a h
)
h i
;
i j
int
ÒÒ 
rowsAffected
ÒÒ 
=
ÒÒ 
sph
ÒÒ "
.
ÒÒ" #
ExecuteNonQuery
ÒÒ# 2
(
ÒÒ2 3
)
ÒÒ3 4
;
ÒÒ4 5
return
ÚÚ 
(
ÚÚ 
rowsAffected
ÚÚ  
>
ÚÚ! "
$num
ÚÚ# $
)
ÚÚ$ %
;
ÚÚ% &
}
ÙÙ 	
public
˚˚ 
static
˚˚ 
bool
˚˚ 
Delete
˚˚ !
(
˚˚! "
Guid
˚˚" &
rowGuid
˚˚' .
)
˚˚. /
{
¸¸ 	 
SqlParameterHelper
˝˝ 
sph
˝˝ "
=
˝˝# $
new
˝˝% ( 
SqlParameterHelper
˝˝) ;
(
˝˝; <
ConnectionString
˝˝< L
.
˝˝L M&
GetWriteConnectionString
˝˝M e
(
˝˝e f
)
˝˝f g
,
˝˝g h
$str˝˝i Ü
,˝˝Ü á
$num˝˝à â
)˝˝â ä
;˝˝ä ã
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# -
,
˛˛- .
	SqlDbType
˛˛/ 8
.
˛˛8 9
UniqueIdentifier
˛˛9 I
,
˛˛I J 
ParameterDirection
˛˛K ]
.
˛˛] ^
Input
˛˛^ c
,
˛˛c d
rowGuid
˛˛e l
)
˛˛l m
;
˛˛m n
int
ˇˇ 
rowsAffected
ˇˇ 
=
ˇˇ 
sph
ˇˇ "
.
ˇˇ" #
ExecuteNonQuery
ˇˇ# 2
(
ˇˇ2 3
)
ˇˇ3 4
;
ˇˇ4 5
return
ÄÄ 
(
ÄÄ 
rowsAffected
ÄÄ  
>
ÄÄ! "
$num
ÄÄ# $
)
ÄÄ$ %
;
ÄÄ% &
}
ÇÇ 	
public
ÑÑ 
static
ÑÑ 
bool
ÑÑ 
DeleteByCart
ÑÑ '
(
ÑÑ' (
Guid
ÑÑ( ,
cartGuid
ÑÑ- 5
)
ÑÑ5 6
{
ÖÖ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M&
GetWriteConnectionString
ÜÜM e
(
ÜÜe f
)
ÜÜf g
,
ÜÜg h
$strÜÜi å
,ÜÜå ç
$numÜÜé è
)ÜÜè ê
;ÜÜê ë
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# .
,
áá. /
	SqlDbType
áá0 9
.
áá9 :
UniqueIdentifier
áá: J
,
ááJ K 
ParameterDirection
ááL ^
.
áá^ _
Input
áá_ d
,
áád e
cartGuid
ááf n
)
áán o
;
ááo p
int
àà 
rowsAffected
àà 
=
àà 
sph
àà "
.
àà" #
ExecuteNonQuery
àà# 2
(
àà2 3
)
àà3 4
;
àà4 5
return
ââ 
(
ââ 
rowsAffected
ââ  
>
ââ! "
$num
ââ# $
)
ââ$ %
;
ââ% &
}
ãã 	
public
çç 
static
çç 
bool
çç 
DeleteBySite
çç '
(
çç' (
Guid
çç( ,
siteGuid
çç- 5
)
çç5 6
{
éé 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M&
GetWriteConnectionString
èèM e
(
èèe f
)
èèf g
,
èèg h
$strèèi å
,èèå ç
$numèèé è
)èèè ê
;èèê ë
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
UniqueIdentifier
êê: J
,
êêJ K 
ParameterDirection
êêL ^
.
êê^ _
Input
êê_ d
,
êêd e
siteGuid
êêf n
)
êên o
;
êêo p
int
ëë 
rowsAffected
ëë 
=
ëë 
sph
ëë "
.
ëë" #
ExecuteNonQuery
ëë# 2
(
ëë2 3
)
ëë3 4
;
ëë4 5
return
íí 
(
íí 
rowsAffected
íí  
>
íí! "
$num
íí# $
)
íí$ %
;
íí% &
}
îî 	
public
ññ 
static
ññ 
bool
ññ 
DeleteByStore
ññ (
(
ññ( )
Guid
ññ) -
	storeGuid
ññ. 7
)
ññ7 8
{
óó 	 
SqlParameterHelper
òò 
sph
òò "
=
òò# $
new
òò% ( 
SqlParameterHelper
òò) ;
(
òò; <
ConnectionString
òò< L
.
òòL M&
GetWriteConnectionString
òòM e
(
òòe f
)
òòf g
,
òòg h
$stròòi ç
,òòç é
$numòòè ê
)òòê ë
;òòë í
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# /
,
ôô/ 0
	SqlDbType
ôô1 :
.
ôô: ;
UniqueIdentifier
ôô; K
,
ôôK L 
ParameterDirection
ôôM _
.
ôô_ `
Input
ôô` e
,
ôôe f
	storeGuid
ôôg p
)
ôôp q
;
ôôq r
int
öö 
rowsAffected
öö 
=
öö 
sph
öö "
.
öö" #
ExecuteNonQuery
öö# 2
(
öö2 3
)
öö3 4
;
öö4 5
return
õõ 
(
õõ 
rowsAffected
õõ  
>
õõ! "
$num
õõ# $
)
õõ$ %
;
õõ% &
}
ùù 	
public
££ 
static
££ 
IDataReader
££ !
GetOne
££" (
(
££( )
Guid
££) -
rowGuid
££. 5
)
££5 6
{
§§ 	 
SqlParameterHelper
•• 
sph
•• "
=
••# $
new
••% ( 
SqlParameterHelper
••) ;
(
••; <
ConnectionString
••< L
.
••L M%
GetReadConnectionString
••M d
(
••d e
)
••e f
,
••f g
$str••h à
,••à â
$num••ä ã
)••ã å
;••å ç
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# -
,
¶¶- .
	SqlDbType
¶¶/ 8
.
¶¶8 9
UniqueIdentifier
¶¶9 I
,
¶¶I J 
ParameterDirection
¶¶K ]
.
¶¶] ^
Input
¶¶^ c
,
¶¶c d
rowGuid
¶¶e l
)
¶¶l m
;
¶¶m n
return
ßß 
sph
ßß 
.
ßß 
ExecuteReader
ßß $
(
ßß$ %
)
ßß% &
;
ßß& '
}
©© 	
public
ØØ 
static
ØØ 
IDataReader
ØØ !"
GetMostRecentByOrder
ØØ" 6
(
ØØ6 7
string
ØØ7 =
googleOrderId
ØØ> K
)
ØØK L
{
∞∞ 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h ñ
,±±ñ ó
$num±±ò ô
)±±ô ö
;±±ö õ
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# 1
,
≤≤1 2
	SqlDbType
≤≤3 <
.
≤≤< =
NVarChar
≤≤= E
,
≤≤E F
$num
≤≤G I
,
≤≤I J 
ParameterDirection
≤≤K ]
.
≤≤] ^
Input
≤≤^ c
,
≤≤c d
googleOrderId
≤≤e r
)
≤≤r s
;
≤≤s t
return
≥≥ 
sph
≥≥ 
.
≥≥ 
ExecuteReader
≥≥ $
(
≥≥$ %
)
≥≥% &
;
≥≥& '
}
¥¥ 	
public
ππ 
static
ππ 
int
ππ 
GetCountByCart
ππ (
(
ππ( )
Guid
ππ) -
cartGuid
ππ. 6
)
ππ6 7
{
∫∫ 	 
SqlParameterHelper
ªª 
sph
ªª "
=
ªª# $
new
ªª% ( 
SqlParameterHelper
ªª) ;
(
ªª; <
ConnectionString
ªª< L
.
ªªL M%
GetReadConnectionString
ªªM d
(
ªªd e
)
ªªe f
,
ªªf g
$strªªh ç
,ªªç é
$numªªè ê
)ªªê ë
;ªªë í
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# .
,
ºº. /
	SqlDbType
ºº0 9
.
ºº9 :
UniqueIdentifier
ºº: J
,
ººJ K 
ParameterDirection
ººL ^
.
ºº^ _
Input
ºº_ d
,
ººd e
cartGuid
ººf n
)
ººn o
;
ººo p
return
ææ 
Convert
ææ 
.
ææ 
ToInt32
ææ "
(
ææ" #
sph
ææ# &
.
ææ& '
ExecuteScalar
ææ' 4
(
ææ4 5
)
ææ5 6
)
ææ6 7
;
ææ7 8
}
¿¿ 	
public
≈≈ 
static
≈≈ 
int
≈≈ 
GetCountByStore
≈≈ )
(
≈≈) *
Guid
≈≈* .
	storeGuid
≈≈/ 8
)
≈≈8 9
{
∆∆ 	 
SqlParameterHelper
«« 
sph
«« "
=
««# $
new
««% ( 
SqlParameterHelper
««) ;
(
««; <
ConnectionString
««< L
.
««L M%
GetReadConnectionString
««M d
(
««d e
)
««e f
,
««f g
$str««h á
,««á à
$num««â ä
)««ä ã
;««ã å
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# /
,
»»/ 0
	SqlDbType
»»1 :
.
»»: ;
UniqueIdentifier
»»; K
,
»»K L 
ParameterDirection
»»M _
.
»»_ `
Input
»»` e
,
»»e f
	storeGuid
»»g p
)
»»p q
;
»»q r
return
   
Convert
   
.
   
ToInt32
   "
(
  " #
sph
  # &
.
  & '
ExecuteScalar
  ' 4
(
  4 5
)
  5 6
)
  6 7
;
  7 8
}
ÃÃ 	
public
—— 
static
—— 
IDataReader
—— !
GetAll
——" (
(
——( )
)
——) *
{
““ 	
return
‘‘ 
	SqlHelper
‘‘ 
.
‘‘ 
ExecuteReader
‘‘ *
(
‘‘* +
ConnectionString
’’  
.
’’  !%
GetReadConnectionString
’’! 8
(
’’8 9
)
’’9 :
,
’’: ;
CommandType
÷÷ 
.
÷÷ 
StoredProcedure
÷÷ +
,
÷÷+ ,
$str
◊◊ 0
,
◊◊0 1
null
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
⁄⁄ 	
public
„„ 
static
„„ 
IDataReader
„„ !
GetPageByCart
„„" /
(
„„/ 0
Guid
‰‰ 
cartGuid
‰‰ 
,
‰‰ 
int
ÂÂ 

pageNumber
ÂÂ 
,
ÂÂ 
int
ÊÊ 
pageSize
ÊÊ 
,
ÊÊ 
out
ÁÁ 
int
ÁÁ 

totalPages
ÁÁ 
)
ÁÁ 
{
ËË 	

totalPages
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
int
ÍÍ 
	totalRows
ÍÍ 
=
ÎÎ 
GetCountByCart
ÎÎ  
(
ÎÎ  !
cartGuid
ÎÎ! )
)
ÎÎ) *
;
ÎÎ* +
if
ÌÌ 
(
ÌÌ 
pageSize
ÌÌ 
>
ÌÌ 
$num
ÌÌ 
)
ÌÌ 

totalPages
ÌÌ (
=
ÌÌ) *
	totalRows
ÌÌ+ 4
/
ÌÌ5 6
pageSize
ÌÌ7 ?
;
ÌÌ? @
if
ÔÔ 
(
ÔÔ 
	totalRows
ÔÔ 
<=
ÔÔ 
pageSize
ÔÔ %
)
ÔÔ% &
{
 

totalPages
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
;
ÒÒ 
}
ÚÚ 
else
ÛÛ 
{
ÙÙ 
int
ıı 
	remainder
ıı 
;
ıı 
Math
ˆˆ 
.
ˆˆ 
DivRem
ˆˆ 
(
ˆˆ 
	totalRows
ˆˆ %
,
ˆˆ% &
pageSize
ˆˆ' /
,
ˆˆ/ 0
out
ˆˆ1 4
	remainder
ˆˆ5 >
)
ˆˆ> ?
;
ˆˆ? @
if
˜˜ 
(
˜˜ 
	remainder
˜˜ 
>
˜˜ 
$num
˜˜  !
)
˜˜! "
{
¯¯ 

totalPages
˘˘ 
+=
˘˘ !
$num
˘˘" #
;
˘˘# $
}
˙˙ 
}
˚˚  
SqlParameterHelper
˝˝ 
sph
˝˝ "
=
˝˝# $
new
˝˝% ( 
SqlParameterHelper
˝˝) ;
(
˝˝; <
ConnectionString
˝˝< L
.
˝˝L M%
GetReadConnectionString
˝˝M d
(
˝˝d e
)
˝˝e f
,
˝˝f g
$str˝˝h è
,˝˝è ê
$num˝˝ë í
)˝˝í ì
;˝˝ì î
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# .
,
˛˛. /
	SqlDbType
˛˛0 9
.
˛˛9 :
UniqueIdentifier
˛˛: J
,
˛˛J K 
ParameterDirection
˛˛L ^
.
˛˛^ _
Input
˛˛_ d
,
˛˛d e
cartGuid
˛˛f n
)
˛˛n o
;
˛˛o p
sph
ˇˇ 
.
ˇˇ  
DefineSqlParameter
ˇˇ "
(
ˇˇ" #
$str
ˇˇ# 0
,
ˇˇ0 1
	SqlDbType
ˇˇ2 ;
.
ˇˇ; <
Int
ˇˇ< ?
,
ˇˇ? @ 
ParameterDirection
ˇˇA S
.
ˇˇS T
Input
ˇˇT Y
,
ˇˇY Z

pageNumber
ˇˇ[ e
)
ˇˇe f
;
ˇˇf g
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
Int
ÄÄ: =
,
ÄÄ= > 
ParameterDirection
ÄÄ? Q
.
ÄÄQ R
Input
ÄÄR W
,
ÄÄW X
pageSize
ÄÄY a
)
ÄÄa b
;
ÄÄb c
return
ÅÅ 
sph
ÅÅ 
.
ÅÅ 
ExecuteReader
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
;
ÅÅ& '
}
ÉÉ 	
public
åå 
static
åå 
IDataReader
åå !
GetPageByStore
åå" 0
(
åå0 1
Guid
çç 
	storeGuid
çç 
,
çç 
int
éé 

pageNumber
éé 
,
éé 
int
èè 
pageSize
èè 
,
èè 
out
êê 
int
êê 

totalPages
êê 
)
êê 
{
ëë 	

totalPages
íí 
=
íí 
$num
íí 
;
íí 
int
ìì 
	totalRows
ìì 
=
îî 
GetCountByStore
îî !
(
îî! "
	storeGuid
îî" +
)
îî+ ,
;
îî, -
if
ññ 
(
ññ 
pageSize
ññ 
>
ññ 
$num
ññ 
)
ññ 

totalPages
ññ (
=
ññ) *
	totalRows
ññ+ 4
/
ññ5 6
pageSize
ññ7 ?
;
ññ? @
if
òò 
(
òò 
	totalRows
òò 
<=
òò 
pageSize
òò %
)
òò% &
{
ôô 

totalPages
öö 
=
öö 
$num
öö 
;
öö 
}
õõ 
else
úú 
{
ùù 
int
ûû 
	remainder
ûû 
;
ûû 
Math
üü 
.
üü 
DivRem
üü 
(
üü 
	totalRows
üü %
,
üü% &
pageSize
üü' /
,
üü/ 0
out
üü1 4
	remainder
üü5 >
)
üü> ?
;
üü? @
if
†† 
(
†† 
	remainder
†† 
>
†† 
$num
††  !
)
††! "
{
°° 

totalPages
¢¢ 
+=
¢¢ !
$num
¢¢" #
;
¢¢# $
}
££ 
}
§§  
SqlParameterHelper
¶¶ 
sph
¶¶ "
=
¶¶# $
new
¶¶% ( 
SqlParameterHelper
¶¶) ;
(
¶¶; <
ConnectionString
¶¶< L
.
¶¶L M%
GetReadConnectionString
¶¶M d
(
¶¶d e
)
¶¶e f
,
¶¶f g
$str¶¶h â
,¶¶â ä
$num¶¶ã å
)¶¶å ç
;¶¶ç é
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# /
,
ßß/ 0
	SqlDbType
ßß1 :
.
ßß: ;
UniqueIdentifier
ßß; K
,
ßßK L 
ParameterDirection
ßßM _
.
ßß_ `
Input
ßß` e
,
ßße f
	storeGuid
ßßg p
)
ßßp q
;
ßßq r
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 0
,
®®0 1
	SqlDbType
®®2 ;
.
®®; <
Int
®®< ?
,
®®? @ 
ParameterDirection
®®A S
.
®®S T
Input
®®T Y
,
®®Y Z

pageNumber
®®[ e
)
®®e f
;
®®f g
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# .
,
©©. /
	SqlDbType
©©0 9
.
©©9 :
Int
©©: =
,
©©= > 
ParameterDirection
©©? Q
.
©©Q R
Input
©©R W
,
©©W X
pageSize
©©Y a
)
©©a b
;
©©b c
return
™™ 
sph
™™ 
.
™™ 
ExecuteReader
™™ $
(
™™$ %
)
™™% &
;
™™& '
}
¨¨ 	
}
ÆÆ 
}∞∞ —¢
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbHtmlContent.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBHtmlContent %
{ 
public 
static 
int 
AddHtmlContent (
(( )
Guid 
itemGuid 
, 
Guid 

moduleGuid 
, 
int 
moduleId 
, 
string 
title 
, 
string   
excerpt   
,   
string!! 
body!! 
,!! 
string"" 
moreLink"" 
,"" 
int## 
	sortOrder## 
,## 
DateTime$$ 
	beginDate$$ 
,$$ 
DateTime%% 
endDate%% 
,%% 
DateTime&& 
createdDate&&  
,&&  !
int'' 
userId'' 
,'' 
Guid(( 
userGuid(( 
,(( 
bool)) $
excludeFromRecentContent)) )
)))) *
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str	++i Ä
,
++Ä Å
$num
++Ç Ñ
)
++Ñ Ö
;
++Ö Ü
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# .
,,,. /
	SqlDbType,,0 9
.,,9 :
UniqueIdentifier,,: J
,,,J K
ParameterDirection,,L ^
.,,^ _
Input,,_ d
,,,d e
itemGuid,,f n
),,n o
;,,o p
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# 0
,--0 1
	SqlDbType--2 ;
.--; <
UniqueIdentifier--< L
,--L M
ParameterDirection--N `
.--` a
Input--a f
,--f g

moduleGuid--h r
)--r s
;--s t
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# .
,... /
	SqlDbType..0 9
...9 :
Int..: =
,..= >
ParameterDirection..? Q
...Q R
Input..R W
,..W X
moduleId..Y a
)..a b
;..b c
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# +
,//+ ,
	SqlDbType//- 6
.//6 7
NVarChar//7 ?
,//? @
$num//A D
,//D E
ParameterDirection//F X
.//X Y
Input//Y ^
,//^ _
title//` e
)//e f
;//f g
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# -
,00- .
	SqlDbType00/ 8
.008 9
NVarChar009 A
,00A B
-00C D
$num00D E
,00E F
ParameterDirection00G Y
.00Y Z
Input00Z _
,00_ `
excerpt00a h
)00h i
;00i j
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
NVarChar116 >
,11> ?
-11@ A
$num11A B
,11B C
ParameterDirection11D V
.11V W
Input11W \
,11\ ]
body11^ b
)11b c
;11c d
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
NVarChar22: B
,22B C
$num22D G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
moreLink22c k
)22k l
;22l m
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
Int33; >
,33> ?
ParameterDirection33@ R
.33R S
Input33S X
,33X Y
	sortOrder33Z c
)33c d
;33d e
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# /
,44/ 0
	SqlDbType441 :
.44: ;
DateTime44; C
,44C D
ParameterDirection44E W
.44W X
Input44X ]
,44] ^
	beginDate44_ h
)44h i
;44i j
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# -
,55- .
	SqlDbType55/ 8
.558 9
DateTime559 A
,55A B
ParameterDirection55C U
.55U V
Input55V [
,55[ \
endDate55] d
)55d e
;55e f
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 1
,661 2
	SqlDbType663 <
.66< =
DateTime66= E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
createdDate66a l
)66l m
;66m n
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ,
,77, -
	SqlDbType77. 7
.777 8
Int778 ;
,77; <
ParameterDirection77= O
.77O P
Input77P U
,77U V
userId77W ]
)77] ^
;77^ _
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# .
,88. /
	SqlDbType880 9
.889 :
UniqueIdentifier88: J
,88J K
ParameterDirection88L ^
.88^ _
Input88_ d
,88d e
userGuid88f n
)88n o
;88o p
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# >
,99> ?
	SqlDbType99@ I
.99I J
Bit99J M
,99M N
ParameterDirection99O a
.99a b
Input99b g
,99g h%
excludeFromRecentContent	99i Å
)
99Å Ç
;
99Ç É
int:: 
newID:: 
=:: 
Convert:: 
.::  
ToInt32::  '
(::' (
sph::( +
.::+ ,
ExecuteScalar::, 9
(::9 :
)::: ;
)::; <
;::< =
return;; 
newID;; 
;;; 
}<< 	
public>> 
static>> 
bool>> 
UpdateHtmlContent>> ,
(>>, -
int??
 
itemId?? 
,?? 
int@@
 
moduleId@@ 
,@@ 
stringAA
 
titleAA 
,AA 
stringBB
 
excerptBB 
,BB 
stringCC
 
bodyCC 
,CC 
stringDD
 
moreLinkDD 
,DD 
intEE
 
	sortOrderEE 
,EE 
DateTimeFF
 
	beginDateFF 
,FF 
DateTimeGG
 
endDateGG 
,GG 
DateTimeHH
 

lastModUtcHH 
,HH 
GuidII
 
lastModUserGuidII 
,II 
boolJJ
 $
excludeFromRecentContentJJ '
)JJ' (
{KK 	
SqlParameterHelperLL 
sphLL "
=LL# $
newLL% (
SqlParameterHelperLL) ;
(LL; <
ConnectionStringLL< L
.LLL M$
GetWriteConnectionStringLLM e
(LLe f
)LLf g
,LLg h
$str	LLi Ä
,
LLÄ Å
$num
LLÇ Ñ
)
LLÑ Ö
;
LLÖ Ü
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# ,
,MM, -
	SqlDbTypeMM. 7
.MM7 8
IntMM8 ;
,MM; <
ParameterDirectionMM= O
.MMO P
InputMMP U
,MMU V
itemIdMMW ]
)MM] ^
;MM^ _
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# .
,NN. /
	SqlDbTypeNN0 9
.NN9 :
IntNN: =
,NN= >
ParameterDirectionNN? Q
.NNQ R
InputNNR W
,NNW X
moduleIdNNY a
)NNa b
;NNb c
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# +
,OO+ ,
	SqlDbTypeOO- 6
.OO6 7
NVarCharOO7 ?
,OO? @
$numOOA D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _
titleOO` e
)OOe f
;OOf g
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# -
,PP- .
	SqlDbTypePP/ 8
.PP8 9
NVarCharPP9 A
,PPA B
-PPC D
$numPPD E
,PPE F
ParameterDirectionPPG Y
.PPY Z
InputPPZ _
,PP_ `
excerptPPa h
)PPh i
;PPi j
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
NVarCharQQ6 >
,QQ> ?
-QQ@ A
$numQQA B
,QQB C
ParameterDirectionQQD V
.QQV W
InputQQW \
,QQ\ ]
bodyQQ^ b
)QQb c
;QQc d
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
NVarCharRR: B
,RRB C
$numRRD G
,RRG H
ParameterDirectionRRI [
.RR[ \
InputRR\ a
,RRa b
moreLinkRRc k
)RRk l
;RRl m
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# /
,SS/ 0
	SqlDbTypeSS1 :
.SS: ;
IntSS; >
,SS> ?
ParameterDirectionSS@ R
.SSR S
InputSSS X
,SSX Y
	sortOrderSSZ c
)SSc d
;SSd e
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# /
,TT/ 0
	SqlDbTypeTT1 :
.TT: ;
DateTimeTT; C
,TTC D
ParameterDirectionTTE W
.TTW X
InputTTX ]
,TT] ^
	beginDateTT_ h
)TTh i
;TTi j
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# -
,UU- .
	SqlDbTypeUU/ 8
.UU8 9
DateTimeUU9 A
,UUA B
ParameterDirectionUUC U
.UUU V
InputUUV [
,UU[ \
endDateUU] d
)UUd e
;UUe f
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

lastModUtcVV` j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 5
,WW5 6
	SqlDbTypeWW7 @
.WW@ A
UniqueIdentifierWWA Q
,WWQ R
ParameterDirectionWWS e
.WWe f
InputWWf k
,WWk l
lastModUserGuidWWm |
)WW| }
;WW} ~
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# >
,XX> ?
	SqlDbTypeXX@ I
.XXI J
BitXXJ M
,XXM N
ParameterDirectionXXO a
.XXa b
InputXXb g
,XXg h%
excludeFromRecentContent	XXi Å
)
XXÅ Ç
;
XXÇ É
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
(ZZ 
rowsAffectedZZ  
>ZZ! "
-ZZ# $
$numZZ$ %
)ZZ% &
;ZZ& '
}[[ 	
publicqq 
staticqq 
boolqq 
DeleteHtmlContentqq ,
(qq, -
intqq- 0
itemIdqq1 7
)qq7 8
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$str	ssi Ä
,
ssÄ Å
$num
ssÇ É
)
ssÉ Ñ
;
ssÑ Ö
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# ,
,tt, -
	SqlDbTypett. 7
.tt7 8
Inttt8 ;
,tt; <
ParameterDirectiontt= O
.ttO P
InputttP U
,ttU V
itemIdttW ]
)tt] ^
;tt^ _
intuu 
rowsAffecteduu 
=uu 
sphuu "
.uu" #
ExecuteNonQueryuu# 2
(uu2 3
)uu3 4
;uu4 5
returnvv 
(vv 
rowsAffectedvv  
>vv! "
-vv# $
$numvv$ %
)vv% &
;vv& '
}ww 	
publicyy 
staticyy 
boolyy 
DeleteBySiteyy '
(yy' (
intyy( +
siteIdyy, 2
)yy2 3
{zz 	
SqlParameterHelper{{ 
sph{{ "
={{# $
new{{% (
SqlParameterHelper{{) ;
({{; <
ConnectionString{{< L
.{{L M$
GetWriteConnectionString{{M e
({{e f
){{f g
,{{g h
$str	{{i Ü
,
{{Ü á
$num
{{à â
)
{{â ä
;
{{ä ã
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# ,
,||, -
	SqlDbType||. 7
.||7 8
Int||8 ;
,||; <
ParameterDirection||= O
.||O P
Input||P U
,||U V
siteId||W ]
)||] ^
;||^ _
int}} 
rowsAffected}} 
=}} 
sph}} "
.}}" #
ExecuteNonQuery}}# 2
(}}2 3
)}}3 4
;}}4 5
return~~ 
(~~ 
rowsAffected~~  
>~~! "
-~~# $
$num~~$ %
)~~% &
;~~& '
} 	
public
ÅÅ 
static
ÅÅ 
bool
ÅÅ 
DeleteByModule
ÅÅ )
(
ÅÅ) *
int
ÅÅ* -
moduleId
ÅÅ. 6
)
ÅÅ6 7
{
ÇÇ 	 
SqlParameterHelper
ÉÉ 
sph
ÉÉ "
=
ÉÉ# $
new
ÉÉ% ( 
SqlParameterHelper
ÉÉ) ;
(
ÉÉ; <
ConnectionString
ÉÉ< L
.
ÉÉL M&
GetWriteConnectionString
ÉÉM e
(
ÉÉe f
)
ÉÉf g
,
ÉÉg h
$strÉÉi à
,ÉÉà â
$numÉÉä ã
)ÉÉã å
;ÉÉå ç
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# .
,
ÑÑ. /
	SqlDbType
ÑÑ0 9
.
ÑÑ9 :
Int
ÑÑ: =
,
ÑÑ= > 
ParameterDirection
ÑÑ? Q
.
ÑÑQ R
Input
ÑÑR W
,
ÑÑW X
moduleId
ÑÑY a
)
ÑÑa b
;
ÑÑb c
int
ÖÖ 
rowsAffected
ÖÖ 
=
ÖÖ 
sph
ÖÖ "
.
ÖÖ" #
ExecuteNonQuery
ÖÖ# 2
(
ÖÖ2 3
)
ÖÖ3 4
;
ÖÖ4 5
return
ÜÜ 
(
ÜÜ 
rowsAffected
ÜÜ  
>
ÜÜ! "
-
ÜÜ# $
$num
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '
}
áá 	
public
ââ 
static
ââ 
IDataReader
ââ !
GetHtmlContent
ââ" 0
(
ââ0 1
int
ââ1 4
moduleId
ââ5 =
,
ââ= >
int
ââ? B
itemId
ââC I
)
ââI J
{
ää 	 
SqlParameterHelper
ãã 
sph
ãã "
=
ãã# $
new
ãã% ( 
SqlParameterHelper
ãã) ;
(
ãã; <
ConnectionString
ãã< L
.
ããL M%
GetReadConnectionString
ããM d
(
ããd e
)
ããe f
,
ããf g
$strããh Ç
,ããÇ É
$numããÑ Ö
)ããÖ Ü
;ããÜ á
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# ,
,
åå, -
	SqlDbType
åå. 7
.
åå7 8
Int
åå8 ;
,
åå; < 
ParameterDirection
åå= O
.
ååO P
Input
ååP U
,
ååU V
itemId
ååW ]
)
åå] ^
;
åå^ _
return
çç 
sph
çç 
.
çç 
ExecuteReader
çç $
(
çç$ %
)
çç% &
;
çç& '
}
éé 	
public
êê 
static
êê 
IDataReader
êê !%
GetHtmlForMetaWeblogApi
êê" 9
(
êê9 :
int
êê: =
siteId
êê> D
)
êêD E
{
ëë 	 
SqlParameterHelper
íí 
sph
íí "
=
íí# $
new
íí% ( 
SqlParameterHelper
íí) ;
(
íí; <
ConnectionString
íí< L
.
ííL M%
GetReadConnectionString
ííM d
(
ííd e
)
ííe f
,
ííf g
$strííh è
,ííè ê
$numííë í
)ííí ì
;ííì î
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# ,
,
ìì, -
	SqlDbType
ìì. 7
.
ìì7 8
Int
ìì8 ;
,
ìì; < 
ParameterDirection
ìì= O
.
ììO P
Input
ììP U
,
ììU V
siteId
ììW ]
)
ìì] ^
;
ìì^ _
return
îî 
sph
îî 
.
îî 
ExecuteReader
îî $
(
îî$ %
)
îî% &
;
îî& '
}
ïï 	
public
óó 
static
óó 
IDataReader
óó !
GetHtmlContent
óó" 0
(
óó0 1
int
òò 
moduleId
òò 
,
òò 
DateTime
ôô 
	beginDate
ôô "
)
ôô" #
{
öö 	 
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M%
GetReadConnectionString
õõM d
(
õõd e
)
õõe f
,
õõf g
$str
õõh 
,õõ Ä
$numõõÅ Ç
)õõÇ É
;õõÉ Ñ
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# .
,
úú. /
	SqlDbType
úú0 9
.
úú9 :
Int
úú: =
,
úú= > 
ParameterDirection
úú? Q
.
úúQ R
Input
úúR W
,
úúW X
moduleId
úúY a
)
úúa b
;
úúb c
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# /
,
ùù/ 0
	SqlDbType
ùù1 :
.
ùù: ;
DateTime
ùù; C
,
ùùC D 
ParameterDirection
ùùE W
.
ùùW X
Input
ùùX ]
,
ùù] ^
	beginDate
ùù_ h
)
ùùh i
;
ùùi j
return
ûû 
sph
ûû 
.
ûû 
ExecuteReader
ûû $
(
ûû$ %
)
ûû% &
;
ûû& '
}
üü 	
public
°° 
static
°° 
IDataReader
°° !"
GetHtmlContentByPage
°°" 6
(
°°6 7
int
°°7 :
siteId
°°; A
,
°°A B
int
°°C F
pageId
°°G M
)
°°M N
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M%
GetReadConnectionString
££M d
(
££d e
)
££e f
,
££f g
$str££h Ö
,££Ö Ü
$num££á à
)££à â
;££â ä
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# ,
,
§§, -
	SqlDbType
§§. 7
.
§§7 8
Int
§§8 ;
,
§§; < 
ParameterDirection
§§= O
.
§§O P
Input
§§P U
,
§§U V
siteId
§§W ]
)
§§] ^
;
§§^ _
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# ,
,
••, -
	SqlDbType
••. 7
.
••7 8
Int
••8 ;
,
••; < 
ParameterDirection
••= O
.
••O P
Input
••P U
,
••U V
pageId
••W ]
)
••] ^
;
••^ _
return
¶¶ 
sph
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
ßß 	
}
´´ 
}¨¨ ∂L
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBIndexingQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBIndexingQueue '
{ 
public"" 
static"" 
Int64"" 
Create"" "
(""" #
int## 
siteId## 
,## 
string$$ 
	indexPath$$ 
,$$ 
string%% 
serializedItem%% !
,%%! "
string&& 
itemKey&& 
,&& 
bool'' 

removeOnly'' 
)'' 
{(( 	
SqlParameterHelper)) 
sph)) "
=))# $
new))% (
SqlParameterHelper))) ;
()); <
ConnectionString))< L
.))L M$
GetWriteConnectionString))M e
())e f
)))f g
,))g h
$str	))i Ç
,
))Ç É
$num
))Ñ Ö
)
))Ö Ü
;
))Ü á
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# ,
,**, -
	SqlDbType**. 7
.**7 8
Int**8 ;
,**; <
ParameterDirection**= O
.**O P
Input**P U
,**U V
siteId**W ]
)**] ^
;**^ _
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# /
,++/ 0
	SqlDbType++1 :
.++: ;
NVarChar++; C
,++C D
$num++E H
,++H I
ParameterDirection++J \
.++\ ]
Input++] b
,++b c
	indexPath++d m
)++m n
;++n o
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# 4
,,,4 5
	SqlDbType,,6 ?
.,,? @
NVarChar,,@ H
,,,H I
-,,J K
$num,,K L
,,,L M
ParameterDirection,,N `
.,,` a
Input,,a f
,,,f g
serializedItem,,h v
),,v w
;,,w x
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# -
,--- .
	SqlDbType--/ 8
.--8 9
NVarChar--9 A
,--A B
$num--C F
,--F G
ParameterDirection--H Z
.--Z [
Input--[ `
,--` a
itemKey--b i
)--i j
;--j k
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# 0
,..0 1
	SqlDbType..2 ;
...; <
Bit..< ?
,..? @
ParameterDirection..A S
...S T
Input..T Y
,..Y Z

removeOnly..[ e
)..e f
;..f g
Int64// 
newID// 
=// 
Convert// !
.//! "
ToInt64//" )
(//) *
sph//* -
.//- .
ExecuteScalar//. ;
(//; <
)//< =
)//= >
;//> ?
return00 
newID00 
;00 
}11 	
publicTT 
staticTT 
boolTT 
DeleteTT !
(TT! "
Int64TT" '
rowIdTT( -
)TT- .
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$str	VVi Ç
,
VVÇ É
$num
VVÑ Ö
)
VVÖ Ü
;
VVÜ á
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# +
,WW+ ,
	SqlDbTypeWW- 6
.WW6 7
BigIntWW7 =
,WW= >
ParameterDirectionWW? Q
.WWQ R
InputWWR W
,WWW X
rowIdWWY ^
)WW^ _
;WW_ `
intXX 
rowsAffectedXX 
=XX 
sphXX "
.XX" #
ExecuteNonQueryXX# 2
(XX2 3
)XX3 4
;XX4 5
returnYY 
(YY 
rowsAffectedYY  
>YY! "
$numYY# $
)YY$ %
;YY% &
}[[ 	
publicbb 
staticbb 
boolbb 
	DeleteAllbb $
(bb$ %
)bb% &
{cc 	
intdd 
rowsAffecteddd 
=dd 
	SqlHelperdd (
.dd( )
ExecuteNonQuerydd) 8
(dd8 9
ConnectionStringee  
.ee  !$
GetWriteConnectionStringee! 9
(ee9 :
)ee: ;
,ee; <
CommandTypeff 
.ff 
StoredProcedureff +
,ff+ ,
$strgg ,
,gg, -
nullhh 
)hh 
;hh 
returnjj 
(jj 
rowsAffectedjj  
>jj! "
$numjj# $
)jj$ %
;jj% &
}ll 	
publicqq 
staticqq 
intqq 
GetCountqq "
(qq" #
)qq# $
{rr 	
returntt 
Converttt 
.tt 
ToInt32tt "
(tt" #
	SqlHelpertt# ,
.tt, -
ExecuteScalartt- :
(tt: ;
ConnectionStringuu  
.uu  !#
GetReadConnectionStringuu! 8
(uu8 9
)uu9 :
,uu: ;
CommandTypevv 
.vv 
StoredProcedurevv +
,vv+ ,
$strww +
,ww+ ,
nullxx 
)xx 
)xx 
;xx 
}zz 	
public 
static 
	DataTable 
GetIndexPaths  -
(- .
). /
{
ÄÄ 	
IDataReader
ÇÇ 
reader
ÇÇ 
=
ÇÇ  
	SqlHelper
ÇÇ! *
.
ÇÇ* +
ExecuteReader
ÇÇ+ 8
(
ÇÇ8 9
ConnectionString
ÉÉ  
.
ÉÉ  !%
GetReadConnectionString
ÉÉ! 8
(
ÉÉ8 9
)
ÉÉ9 :
,
ÉÉ: ;
CommandType
ÑÑ 
.
ÑÑ 
StoredProcedure
ÑÑ +
,
ÑÑ+ ,
$str
ÖÖ 6
,
ÖÖ6 7
null
ÜÜ 
)
ÜÜ 
;
ÜÜ 
return
àà 
DBPortal
àà 
.
àà $
GetTableFromDataReader
àà 2
(
àà2 3
reader
àà3 9
)
àà9 :
;
àà: ;
}
ää 	
public
åå 
static
åå 
	DataTable
åå 

GetSiteIDs
åå  *
(
åå* +
)
åå+ ,
{
çç 	
IDataReader
èè 
reader
èè 
=
èè  
	SqlHelper
èè! *
.
èè* +
ExecuteReader
èè+ 8
(
èè8 9
ConnectionString
êê  
.
êê  !%
GetReadConnectionString
êê! 8
(
êê8 9
)
êê9 :
,
êê: ;
CommandType
ëë 
.
ëë 
StoredProcedure
ëë +
,
ëë+ ,
$str
íí 7
,
íí7 8
null
ìì 
)
ìì 
;
ìì 
return
ïï 
DBPortal
ïï 
.
ïï $
GetTableFromDataReader
ïï 2
(
ïï2 3
reader
ïï3 9
)
ïï9 :
;
ïï: ;
}
óó 	
public
úú 
static
úú 
	DataTable
úú 
	GetByPath
úú  )
(
úú) *
string
úú* 0
	indexPath
úú1 :
)
úú: ;
{
ùù 	 
SqlParameterHelper
ûû 
sph
ûû "
=
ûû# $
new
ûû% ( 
SqlParameterHelper
ûû) ;
(
ûû; <
ConnectionString
ûû< L
.
ûûL M%
GetReadConnectionString
ûûM d
(
ûûd e
)
ûûe f
,
ûûf g
$strûûh á
,ûûá à
$numûûâ ä
)ûûä ã
;ûûã å
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# /
,
üü/ 0
	SqlDbType
üü1 :
.
üü: ;
NVarChar
üü; C
,
üüC D
$num
üüE H
,
üüH I 
ParameterDirection
üüJ \
.
üü\ ]
Input
üü] b
,
üüb c
	indexPath
üüd m
)
üüm n
;
üün o
IDataReader
†† 
reader
†† 
=
††  
sph
††! $
.
††$ %
ExecuteReader
††% 2
(
††2 3
)
††3 4
;
††4 5
return
¢¢ 
DBPortal
¢¢ 
.
¢¢ $
GetTableFromDataReader
¢¢ 2
(
¢¢2 3
reader
¢¢3 9
)
¢¢9 :
;
¢¢: ;
}
§§ 	
public
¶¶ 
static
¶¶ 
	DataTable
¶¶ 
	GetBySite
¶¶  )
(
¶¶) *
int
¶¶* -
siteId
¶¶. 4
)
¶¶4 5
{
ßß 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M%
GetReadConnectionString
®®M d
(
®®d e
)
®®e f
,
®®f g
$str®®h á
,®®á à
$num®®â ä
)®®ä ã
;®®ã å
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
siteId
©©W ]
)
©©] ^
;
©©^ _
IDataReader
™™ 
reader
™™ 
=
™™  
sph
™™! $
.
™™$ %
ExecuteReader
™™% 2
(
™™2 3
)
™™3 4
;
™™4 5
return
¨¨ 
DBPortal
¨¨ 
.
¨¨ $
GetTableFromDataReader
¨¨ 2
(
¨¨2 3
reader
¨¨3 9
)
¨¨9 :
;
¨¨: ;
}
ÆÆ 	
}
∂∂ 
}∏∏ æU
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLanguage.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBLanguage "
{ 
public%% 
static%% 
int%% 
Create%%  
(%%  !
Guid&& 
guid&& 
,&& 
string'' 
name'' 
,'' 
string(( 
code(( 
,(( 
int)) 
sort)) 
))) 
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i }
,++} ~
$num	++ Ä
)
++Ä Å
;
++Å Ç
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# *
,--* +
	SqlDbType--, 5
.--5 6
NVarChar--6 >
,--> ?
$num--@ C
,--C D
ParameterDirection--E W
.--W X
Input--X ]
,--] ^
name--_ c
)--c d
;--d e
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# *
,..* +
	SqlDbType.., 5
...5 6
NChar..6 ;
,..; <
$num..= >
,..> ?
ParameterDirection..@ R
...R S
Input..S X
,..X Y
code..Z ^
)..^ _
;.._ `
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
Int//6 9
,//9 :
ParameterDirection//; M
.//M N
Input//N S
,//S T
sort//U Y
)//Y Z
;//Z [
int00 
rowsAffected00 
=00 
sph00 "
.00" #
ExecuteNonQuery00# 2
(002 3
)003 4
;004 5
return11 
rowsAffected11 
;11  
}33 	
public>> 
static>> 
bool>> 
Update>> !
(>>! "
Guid?? 
guid?? 
,?? 
string@@ 
name@@ 
,@@ 
stringAA 
codeAA 
,AA 
intBB 
sortBB 
)BB 
{CC 	
SqlParameterHelperDD 
sphDD "
=DD# $
newDD% (
SqlParameterHelperDD) ;
(DD; <
ConnectionStringDD< L
.DDL M$
GetWriteConnectionStringDDM e
(DDe f
)DDf g
,DDg h
$strDDi }
,DD} ~
$num	DD Ä
)
DDÄ Å
;
DDÅ Ç
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# *
,EE* +
	SqlDbTypeEE, 5
.EE5 6
UniqueIdentifierEE6 F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
guidEEb f
)EEf g
;EEg h
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# *
,FF* +
	SqlDbTypeFF, 5
.FF5 6
NVarCharFF6 >
,FF> ?
$numFF@ C
,FFC D
ParameterDirectionFFE W
.FFW X
InputFFX ]
,FF] ^
nameFF_ c
)FFc d
;FFd e
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# *
,GG* +
	SqlDbTypeGG, 5
.GG5 6
NCharGG6 ;
,GG; <
$numGG= >
,GG> ?
ParameterDirectionGG@ R
.GGR S
InputGGS X
,GGX Y
codeGGZ ^
)GG^ _
;GG_ `
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
IntHH6 9
,HH9 :
ParameterDirectionHH; M
.HHM N
InputHHN S
,HHS T
sortHHU Y
)HHY Z
;HHZ [
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicSS 
staticSS 
boolSS 
DeleteSS !
(SS! "
GuidSS" &
guidSS' +
)SS+ ,
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$strUUi }
,UU} ~
$num	UU Ä
)
UUÄ Å
;
UUÅ Ç
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
(XX 
rowsAffectedXX  
>XX! "
$numXX# $
)XX$ %
;XX% &
}ZZ 	
public`` 
static`` 
IDataReader`` !
GetOne``" (
(``( )
Guid``) -
guid``. 2
)``2 3
{aa 	
SqlParameterHelperbb 
sphbb "
=bb# $
newbb% (
SqlParameterHelperbb) ;
(bb; <
ConnectionStringbb< L
.bbL M#
GetReadConnectionStringbbM d
(bbd e
)bbe f
,bbf g
$strbbh 
,	bb Ä
$num
bbÅ Ç
)
bbÇ É
;
bbÉ Ñ
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# *
,cc* +
	SqlDbTypecc, 5
.cc5 6
UniqueIdentifiercc6 F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
guidccb f
)ccf g
;ccg h
returndd 
sphdd 
.dd 
ExecuteReaderdd $
(dd$ %
)dd% &
;dd& '
}ff 	
publickk 
statickk 
intkk 
GetCountkk "
(kk" #
)kk# $
{ll 	
returnnn 
Convertnn 
.nn 
ToInt32nn "
(nn" #
	SqlHelpernn# ,
.nn, -
ExecuteScalarnn- :
(nn: ;
ConnectionStringoo  
.oo  !#
GetReadConnectionStringoo! 8
(oo8 9
)oo9 :
,oo: ;
CommandTypepp 
.pp 
StoredProcedurepp +
,pp+ ,
$strqq &
,qq& '
nullrr 
)rr 
)rr 
;rr 
}tt 	
publicyy 
staticyy 
IDataReaderyy !
GetAllyy" (
(yy( )
)yy) *
{zz 	
return|| 
	SqlHelper|| 
.|| 
ExecuteReader|| *
(||* +
ConnectionString}}  
.}}  !#
GetReadConnectionString}}! 8
(}}8 9
)}}9 :
,}}: ;
CommandType~~ 
.~~ 
StoredProcedure~~ +
,~~+ ,
$str '
,' (
null
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÇÇ 	
public
ää 
static
ää 
IDataReader
ää !
GetPage
ää" )
(
ää) *
int
ãã 

pageNumber
ãã 
,
ãã 
int
åå 
pageSize
åå 
,
åå 
out
çç 
int
çç 

totalPages
çç 
)
çç 
{
éé 	

totalPages
èè 
=
èè 
$num
èè 
;
èè 
int
êê 
	totalRows
êê 
=
ëë 
GetCount
ëë 
(
ëë 
)
ëë 
;
ëë 
if
ìì 
(
ìì 
pageSize
ìì 
>
ìì 
$num
ìì 
)
ìì 

totalPages
ìì (
=
ìì) *
	totalRows
ìì+ 4
/
ìì5 6
pageSize
ìì7 ?
;
ìì? @
if
ïï 
(
ïï 
	totalRows
ïï 
<=
ïï 
pageSize
ïï %
)
ïï% &
{
ññ 

totalPages
óó 
=
óó 
$num
óó 
;
óó 
}
òò 
else
ôô 
{
öö 
int
õõ 
	remainder
õõ 
;
õõ 
Math
úú 
.
úú 
DivRem
úú 
(
úú 
	totalRows
úú %
,
úú% &
pageSize
úú' /
,
úú/ 0
out
úú1 4
	remainder
úú5 >
)
úú> ?
;
úú? @
if
ùù 
(
ùù 
	remainder
ùù 
>
ùù 
$num
ùù  !
)
ùù! "
{
ûû 

totalPages
üü 
+=
üü !
$num
üü" #
;
üü# $
}
†† 
}
°°  
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M%
GetReadConnectionString
££M d
(
££d e
)
££e f
,
££f g
$str££h Ä
,££Ä Å
$num££Ç É
)££É Ñ
;££Ñ Ö
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 0
,
§§0 1
	SqlDbType
§§2 ;
.
§§; <
Int
§§< ?
,
§§? @ 
ParameterDirection
§§A S
.
§§S T
Input
§§T Y
,
§§Y Z

pageNumber
§§[ e
)
§§e f
;
§§f g
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# .
,
••. /
	SqlDbType
••0 9
.
••9 :
Int
••: =
,
••= > 
ParameterDirection
••? Q
.
••Q R
Input
••R W
,
••W X
pageSize
••Y a
)
••a b
;
••b c
return
¶¶ 
sph
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
®® 	
}
™™ 
}¨¨ ÷‡
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetter.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetter  
{ 
public,, 
static,, 
int,, 
Create,,  
(,,  !
Guid-- 

letterGuid-- 
,-- 
Guid.. 
letterInfoGuid.. 
,..  
string// 
subject// 
,// 
string00 
htmlBody00 
,00 
string11 
textBody11 
,11 
Guid22 
	createdBy22 
,22 
DateTime33 

createdUtc33 
,33  
Guid44 
	lastModBy44 
,44 
DateTime55 

lastModUtc55 
,55  
bool66 

isApproved66 
,66 
Guid77 

approvedBy77 
)77 
{88 	
SqlParameterHelper99 
sph99 "
=99# $
new99% (
SqlParameterHelper99) ;
(99; <
ConnectionString99< L
.99L M$
GetWriteConnectionString99M e
(99e f
)99f g
,99g h
$str99i {
,99{ |
$num99} 
)	99 Ä
;
99Ä Å
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
UniqueIdentifier::< L
,::L M
ParameterDirection::N `
.::` a
Input::a f
,::f g

letterGuid::h r
)::r s
;::s t
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# 4
,;;4 5
	SqlDbType;;6 ?
.;;? @
UniqueIdentifier;;@ P
,;;P Q
ParameterDirection;;R d
.;;d e
Input;;e j
,;;j k
letterInfoGuid;;l z
);;z {
;;;{ |
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# -
,<<- .
	SqlDbType<</ 8
.<<8 9
NVarChar<<9 A
,<<A B
$num<<C F
,<<F G
ParameterDirection<<H Z
.<<Z [
Input<<[ `
,<<` a
subject<<b i
)<<i j
;<<j k
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# .
,==. /
	SqlDbType==0 9
.==9 :
NVarChar==: B
,==B C
-==D E
$num==E F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
htmlBody==b j
)==j k
;==k l
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># .
,>>. /
	SqlDbType>>0 9
.>>9 :
NVarChar>>: B
,>>B C
->>D E
$num>>E F
,>>F G
ParameterDirection>>H Z
.>>Z [
Input>>[ `
,>>` a
textBody>>b j
)>>j k
;>>k l
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# /
,??/ 0
	SqlDbType??1 :
.??: ;
UniqueIdentifier??; K
,??K L
ParameterDirection??M _
.??_ `
Input??` e
,??e f
	createdBy??g p
)??p q
;??q r
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 0
,@@0 1
	SqlDbType@@2 ;
.@@; <
DateTime@@< D
,@@D E
ParameterDirection@@F X
.@@X Y
Input@@Y ^
,@@^ _

createdUtc@@` j
)@@j k
;@@k l
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# /
,AA/ 0
	SqlDbTypeAA1 :
.AA: ;
UniqueIdentifierAA; K
,AAK L
ParameterDirectionAAM _
.AA_ `
InputAA` e
,AAe f
	lastModByAAg p
)AAp q
;AAq r
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 0
,BB0 1
	SqlDbTypeBB2 ;
.BB; <
DateTimeBB< D
,BBD E
ParameterDirectionBBF X
.BBX Y
InputBBY ^
,BB^ _

lastModUtcBB` j
)BBj k
;BBk l
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 0
,CC0 1
	SqlDbTypeCC2 ;
.CC; <
BitCC< ?
,CC? @
ParameterDirectionCCA S
.CCS T
InputCCT Y
,CCY Z

isApprovedCC[ e
)CCe f
;CCf g
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 0
,DD0 1
	SqlDbTypeDD2 ;
.DD; <
UniqueIdentifierDD< L
,DDL M
ParameterDirectionDDN `
.DD` a
InputDDa f
,DDf g

approvedByDDh r
)DDr s
;DDs t
intFF 
rowsAffectedFF 
=FF 
sphFF "
.FF" #
ExecuteNonQueryFF# 2
(FF2 3
)FF3 4
;FF4 5
returnGG 
rowsAffectedGG 
;GG  
}HH 	
publicXX 
staticXX 
boolXX 
UpdateXX !
(XX! "
GuidYY 

letterGuidYY 
,YY 
GuidZZ 
letterInfoGuidZZ 
,ZZ  
string[[ 
subject[[ 
,[[ 
string\\ 
htmlBody\\ 
,\\ 
string]] 
textBody]] 
,]] 
Guid^^ 
	lastModBy^^ 
,^^ 
DateTime__ 

lastModUtc__ 
,__  
bool`` 

isApproved`` 
,`` 
Guidaa 

approvedByaa 
)aa 
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M$
GetWriteConnectionStringccM e
(cce f
)ccf g
,ccg h
$strcci {
,cc{ |
$numcc} ~
)cc~ 
;	cc Ä
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
UniqueIdentifierdd< L
,ddL M
ParameterDirectionddN `
.dd` a
Inputdda f
,ddf g

letterGuidddh r
)ddr s
;dds t
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# 4
,ee4 5
	SqlDbTypeee6 ?
.ee? @
UniqueIdentifieree@ P
,eeP Q
ParameterDirectioneeR d
.eed e
Inputeee j
,eej k
letterInfoGuideel z
)eez {
;ee{ |
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# -
,ff- .
	SqlDbTypeff/ 8
.ff8 9
NVarCharff9 A
,ffA B
$numffC F
,ffF G
ParameterDirectionffH Z
.ffZ [
Inputff[ `
,ff` a
subjectffb i
)ffi j
;ffj k
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# .
,gg. /
	SqlDbTypegg0 9
.gg9 :
NVarChargg: B
,ggB C
-ggD E
$numggE F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
htmlBodyggb j
)ggj k
;ggk l
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# .
,hh. /
	SqlDbTypehh0 9
.hh9 :
NVarCharhh: B
,hhB C
-hhD E
$numhhE F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
textBodyhhb j
)hhj k
;hhk l
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# /
,ii/ 0
	SqlDbTypeii1 :
.ii: ;
UniqueIdentifierii; K
,iiK L
ParameterDirectioniiM _
.ii_ `
Inputii` e
,iie f
	lastModByiig p
)iip q
;iiq r
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 0
,jj0 1
	SqlDbTypejj2 ;
.jj; <
DateTimejj< D
,jjD E
ParameterDirectionjjF X
.jjX Y
InputjjY ^
,jj^ _

lastModUtcjj` j
)jjj k
;jjk l
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 0
,kk0 1
	SqlDbTypekk2 ;
.kk; <
Bitkk< ?
,kk? @
ParameterDirectionkkA S
.kkS T
InputkkT Y
,kkY Z

isApprovedkk[ e
)kke f
;kkf g
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
UniqueIdentifierll< L
,llL M
ParameterDirectionllN `
.ll` a
Inputlla f
,llf g

approvedByllh r
)llr s
;lls t
intnn 
rowsAffectednn 
=nn 
sphnn "
.nn" #
ExecuteNonQuerynn# 2
(nn2 3
)nn3 4
;nn4 5
returnoo 
(oo 
rowsAffectedoo  
>oo! "
$numoo# $
)oo$ %
;oo% &
}pp 	
publicww 
staticww 
boolww 
Deleteww !
(ww! "
Guidww" &

letterGuidww' 1
)ww1 2
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$stryyi {
,yy{ |
$numyy} ~
)yy~ 
;	yy Ä
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 0
,zz0 1
	SqlDbTypezz2 ;
.zz; <
UniqueIdentifierzz< L
,zzL M
ParameterDirectionzzN `
.zz` a
Inputzza f
,zzf g

letterGuidzzh r
)zzr s
;zzs t
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}~~ 	
public
ÖÖ 
static
ÖÖ 
bool
ÖÖ  
DeleteByLetterInfo
ÖÖ -
(
ÖÖ- .
Guid
ÖÖ. 2
letterInfoGuid
ÖÖ3 A
)
ÖÖA B
{
ÜÜ 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M&
GetWriteConnectionString
ááM e
(
ááe f
)
ááf g
,
áág h
$stráái á
,ááá à
$numááâ ä
)ááä ã
;ááã å
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 4
,
àà4 5
	SqlDbType
àà6 ?
.
àà? @
UniqueIdentifier
àà@ P
,
ààP Q 
ParameterDirection
ààR d
.
ààd e
Input
ààe j
,
ààj k
letterInfoGuid
ààl z
)
ààz {
;
àà{ |
int
ââ 
rowsAffected
ââ 
=
ââ 
sph
ââ "
.
ââ" #
ExecuteNonQuery
ââ# 2
(
ââ2 3
)
ââ3 4
;
ââ4 5
return
ää 
(
ää 
rowsAffected
ää  
>
ää! "
$num
ää# $
)
ää$ %
;
ää% &
}
åå 	
public
ññ 
static
ññ 
bool
ññ 
SendClicked
ññ &
(
ññ& '
Guid
óó 

letterGuid
óó 
,
óó 
DateTime
òò 
sendClickedUtc
òò #
)
òò# $
{
ôô 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M&
GetWriteConnectionString
ööM e
(
ööe f
)
ööf g
,
öög h
$strööi Ü
,ööÜ á
$numööà â
)ööâ ä
;ööä ã
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 0
,
õõ0 1
	SqlDbType
õõ2 ;
.
õõ; <
UniqueIdentifier
õõ< L
,
õõL M 
ParameterDirection
õõN `
.
õõ` a
Input
õõa f
,
õõf g

letterGuid
õõh r
)
õõr s
;
õõs t
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 4
,
úú4 5
	SqlDbType
úú6 ?
.
úú? @
DateTime
úú@ H
,
úúH I 
ParameterDirection
úúJ \
.
úú\ ]
Input
úú] b
,
úúb c
sendClickedUtc
úúd r
)
úúr s
;
úús t
int
ûû 
rowsAffected
ûû 
=
ûû 
sph
ûû "
.
ûû" #
ExecuteNonQuery
ûû# 2
(
ûû2 3
)
ûû3 4
;
ûû4 5
return
üü 
(
üü 
rowsAffected
üü  
>
üü! "
$num
üü# $
)
üü$ %
;
üü% &
}
†† 	
public
®® 
static
®® 
bool
®® 
SendStarted
®® &
(
®®& '
Guid
©© 

letterGuid
©© 
,
©© 
DateTime
™™ 
sendStartedUtc
™™ #
)
™™# $
{
´´ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M&
GetWriteConnectionString
¨¨M e
(
¨¨e f
)
¨¨f g
,
¨¨g h
$str¨¨i Ü
,¨¨Ü á
$num¨¨à â
)¨¨â ä
;¨¨ä ã
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# 0
,
≠≠0 1
	SqlDbType
≠≠2 ;
.
≠≠; <
UniqueIdentifier
≠≠< L
,
≠≠L M 
ParameterDirection
≠≠N `
.
≠≠` a
Input
≠≠a f
,
≠≠f g

letterGuid
≠≠h r
)
≠≠r s
;
≠≠s t
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# 4
,
ÆÆ4 5
	SqlDbType
ÆÆ6 ?
.
ÆÆ? @
DateTime
ÆÆ@ H
,
ÆÆH I 
ParameterDirection
ÆÆJ \
.
ÆÆ\ ]
Input
ÆÆ] b
,
ÆÆb c
sendStartedUtc
ÆÆd r
)
ÆÆr s
;
ÆÆs t
int
∞∞ 
rowsAffected
∞∞ 
=
∞∞ 
sph
∞∞ "
.
∞∞" #
ExecuteNonQuery
∞∞# 2
(
∞∞2 3
)
∞∞3 4
;
∞∞4 5
return
±± 
(
±± 
rowsAffected
±±  
>
±±! "
$num
±±# $
)
±±$ %
;
±±% &
}
≤≤ 	
public
∫∫ 
static
∫∫ 
bool
∫∫ 
SendComplete
∫∫ '
(
∫∫' (
Guid
ªª 

letterGuid
ªª 
,
ªª 
DateTime
ºº 
sendCompleteUtc
ºº $
,
ºº$ %
int
ΩΩ 
	sendCount
ΩΩ 
)
ΩΩ 
{
ææ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M&
GetWriteConnectionString
øøM e
(
øøe f
)
øøf g
,
øøg h
$strøøi á
,øøá à
$numøøâ ä
)øøä ã
;øøã å
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 0
,
¿¿0 1
	SqlDbType
¿¿2 ;
.
¿¿; <
UniqueIdentifier
¿¿< L
,
¿¿L M 
ParameterDirection
¿¿N `
.
¿¿` a
Input
¿¿a f
,
¿¿f g

letterGuid
¿¿h r
)
¿¿r s
;
¿¿s t
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 5
,
¡¡5 6
	SqlDbType
¡¡7 @
.
¡¡@ A
DateTime
¡¡A I
,
¡¡I J 
ParameterDirection
¡¡K ]
.
¡¡] ^
Input
¡¡^ c
,
¡¡c d
sendCompleteUtc
¡¡e t
)
¡¡t u
;
¡¡u v
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# /
,
¬¬/ 0
	SqlDbType
¬¬1 :
.
¬¬: ;
Int
¬¬; >
,
¬¬> ? 
ParameterDirection
¬¬@ R
.
¬¬R S
Input
¬¬S X
,
¬¬X Y
	sendCount
¬¬Z c
)
¬¬c d
;
¬¬d e
int
ƒƒ 
rowsAffected
ƒƒ 
=
ƒƒ 
sph
ƒƒ "
.
ƒƒ" #
ExecuteNonQuery
ƒƒ# 2
(
ƒƒ2 3
)
ƒƒ3 4
;
ƒƒ4 5
return
≈≈ 
(
≈≈ 
rowsAffected
≈≈  
>
≈≈! "
$num
≈≈# $
)
≈≈$ %
;
≈≈% &
}
∆∆ 	
public
œœ 
static
œœ 
IDataReader
œœ !
GetOne
œœ" (
(
œœ( )
Guid
œœ) -

letterGuid
œœ. 8
)
œœ8 9
{
–– 	 
SqlParameterHelper
—— 
sph
—— "
=
——# $
new
——% ( 
SqlParameterHelper
——) ;
(
——; <
ConnectionString
——< L
.
——L M%
GetReadConnectionString
——M d
(
——d e
)
——e f
,
——f g
$str
——h }
,
——} ~
$num—— Ä
)——Ä Å
;——Å Ç
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# 0
,
““0 1
	SqlDbType
““2 ;
.
““; <
UniqueIdentifier
““< L
,
““L M 
ParameterDirection
““N `
.
““` a
Input
““a f
,
““f g

letterGuid
““h r
)
““r s
;
““s t
return
”” 
sph
”” 
.
”” 
ExecuteReader
”” $
(
””$ %
)
””% &
;
””& '
}
‘‘ 	
public
ŸŸ 
static
ŸŸ 
int
ŸŸ 
GetCount
ŸŸ "
(
ŸŸ" #
Guid
ŸŸ# '
letterInfoGuid
ŸŸ( 6
)
ŸŸ6 7
{
⁄⁄ 	 
SqlParameterHelper
‹‹ 
sph
‹‹ "
=
‹‹# $
new
‹‹% ( 
SqlParameterHelper
‹‹) ;
(
‹‹; <
ConnectionString
‹‹< L
.
‹‹L M%
GetReadConnectionString
‹‹M d
(
‹‹d e
)
‹‹e f
,
‹‹f g
$str
‹‹h |
,
‹‹| }
$num
‹‹~ 
)‹‹ Ä
;‹‹Ä Å
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# 4
,
››4 5
	SqlDbType
››6 ?
.
››? @
UniqueIdentifier
››@ P
,
››P Q 
ParameterDirection
››R d
.
››d e
Input
››e j
,
››j k
letterInfoGuid
››l z
)
››z {
;
››{ |
return
ﬁﬁ 
Convert
ﬁﬁ 
.
ﬁﬁ 
ToInt32
ﬁﬁ "
(
ﬁﬁ" #
sph
ﬁﬁ# &
.
ﬁﬁ& '
ExecuteScalar
ﬁﬁ' 4
(
ﬁﬁ4 5
)
ﬁﬁ5 6
)
ﬁﬁ6 7
;
ﬁﬁ7 8
}
·· 	
public
ÊÊ 
static
ÊÊ 
int
ÊÊ 
GetCountOfDrafts
ÊÊ *
(
ÊÊ* +
Guid
ÊÊ+ /
letterInfoGuid
ÊÊ0 >
)
ÊÊ> ?
{
ÁÁ 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh Ç
,ÈÈÇ É
$numÈÈÑ Ö
)ÈÈÖ Ü
;ÈÈÜ á
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 4
,
ÍÍ4 5
	SqlDbType
ÍÍ6 ?
.
ÍÍ? @
UniqueIdentifier
ÍÍ@ P
,
ÍÍP Q 
ParameterDirection
ÍÍR d
.
ÍÍd e
Input
ÍÍe j
,
ÍÍj k
letterInfoGuid
ÍÍl z
)
ÍÍz {
;
ÍÍ{ |
return
ÎÎ 
Convert
ÎÎ 
.
ÎÎ 
ToInt32
ÎÎ "
(
ÎÎ" #
sph
ÎÎ# &
.
ÎÎ& '
ExecuteScalar
ÎÎ' 4
(
ÎÎ4 5
)
ÎÎ5 6
)
ÎÎ6 7
;
ÎÎ7 8
}
ÓÓ 	
public
ÛÛ 
static
ÛÛ 
IDataReader
ÛÛ !
GetAll
ÛÛ" (
(
ÛÛ( )
Guid
ÛÛ) -
letterInfoGuid
ÛÛ. <
)
ÛÛ< =
{
ÙÙ 	 
SqlParameterHelper
ˆˆ 
sph
ˆˆ "
=
ˆˆ# $
new
ˆˆ% ( 
SqlParameterHelper
ˆˆ) ;
(
ˆˆ; <
ConnectionString
ˆˆ< L
.
ˆˆL M%
GetReadConnectionString
ˆˆM d
(
ˆˆd e
)
ˆˆe f
,
ˆˆf g
$str
ˆˆh }
,
ˆˆ} ~
$numˆˆ Ä
)ˆˆÄ Å
;ˆˆÅ Ç
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# 4
,
˜˜4 5
	SqlDbType
˜˜6 ?
.
˜˜? @
UniqueIdentifier
˜˜@ P
,
˜˜P Q 
ParameterDirection
˜˜R d
.
˜˜d e
Input
˜˜e j
,
˜˜j k
letterInfoGuid
˜˜l z
)
˜˜z {
;
˜˜{ |
return
¯¯ 
sph
¯¯ 
.
¯¯ 
ExecuteReader
¯¯ $
(
¯¯$ %
)
¯¯% &
;
¯¯& '
}
¸¸ 	
public
ÑÑ 
static
ÑÑ 
IDataReader
ÑÑ !
GetPage
ÑÑ" )
(
ÑÑ) *
Guid
ÖÖ 
letterInfoGuid
ÖÖ 
,
ÖÖ  
int
ÜÜ 

pageNumber
ÜÜ 
,
ÜÜ 
int
áá 
pageSize
áá 
,
áá 
out
àà 
int
àà 

totalPages
àà 
)
àà 
{
ââ 	

totalPages
ää 
=
ää 
$num
ää 
;
ää 
int
ãã 
	totalRows
ãã 
=
åå 
GetCount
åå 
(
åå 
letterInfoGuid
åå )
)
åå) *
;
åå* +
if
éé 
(
éé 
pageSize
éé 
>
éé 
$num
éé 
)
éé 

totalPages
éé (
=
éé) *
	totalRows
éé+ 4
/
éé5 6
pageSize
éé7 ?
;
éé? @
if
êê 
(
êê 
	totalRows
êê 
<=
êê 
pageSize
êê %
)
êê% &
{
ëë 

totalPages
íí 
=
íí 
$num
íí 
;
íí 
}
ìì 
else
îî 
{
ïï 
int
ññ 
	remainder
ññ 
;
ññ 
Math
óó 
.
óó 
DivRem
óó 
(
óó 
	totalRows
óó %
,
óó% &
pageSize
óó' /
,
óó/ 0
out
óó1 4
	remainder
óó5 >
)
óó> ?
;
óó? @
if
òò 
(
òò 
	remainder
òò 
>
òò 
$num
òò  !
)
òò! "
{
ôô 

totalPages
öö 
+=
öö !
$num
öö" #
;
öö# $
}
õõ 
}
úú  
SqlParameterHelper
ûû 
sph
ûû "
=
ûû# $
new
ûû% ( 
SqlParameterHelper
ûû) ;
(
ûû; <
ConnectionString
ûû< L
.
ûûL M%
GetReadConnectionString
ûûM d
(
ûûd e
)
ûûe f
,
ûûf g
$str
ûûh ~
,
ûû~ 
$numûûÄ Å
)ûûÅ Ç
;ûûÇ É
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 4
,
üü4 5
	SqlDbType
üü6 ?
.
üü? @
UniqueIdentifier
üü@ P
,
üüP Q 
ParameterDirection
üüR d
.
üüd e
Input
üüe j
,
üüj k
letterInfoGuid
üül z
)
üüz {
;
üü{ |
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# 0
,
††0 1
	SqlDbType
††2 ;
.
††; <
Int
††< ?
,
††? @ 
ParameterDirection
††A S
.
††S T
Input
††T Y
,
††Y Z

pageNumber
††[ e
)
††e f
;
††f g
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# .
,
°°. /
	SqlDbType
°°0 9
.
°°9 :
Int
°°: =
,
°°= > 
ParameterDirection
°°? Q
.
°°Q R
Input
°°R W
,
°°W X
pageSize
°°Y a
)
°°a b
;
°°b c
return
¢¢ 
sph
¢¢ 
.
¢¢ 
ExecuteReader
¢¢ $
(
¢¢$ %
)
¢¢% &
;
¢¢& '
}
§§ 	
public
¨¨ 
static
¨¨ 
IDataReader
¨¨ !
	GetDrafts
¨¨" +
(
¨¨+ ,
Guid
≠≠ 
letterInfoGuid
≠≠ 
,
≠≠  
int
ÆÆ 

pageNumber
ÆÆ 
,
ÆÆ 
int
ØØ 
pageSize
ØØ 
,
ØØ 
out
∞∞ 
int
∞∞ 

totalPages
∞∞ 
)
∞∞ 
{
±± 	

totalPages
≤≤ 
=
≤≤ 
$num
≤≤ 
;
≤≤ 
int
≥≥ 
	totalRows
≥≥ 
=
¥¥ 
GetCountOfDrafts
¥¥ "
(
¥¥" #
letterInfoGuid
¥¥# 1
)
¥¥1 2
;
¥¥2 3
if
∂∂ 
(
∂∂ 
pageSize
∂∂ 
>
∂∂ 
$num
∂∂ 
)
∂∂ 

totalPages
∂∂ (
=
∂∂) *
	totalRows
∂∂+ 4
/
∂∂5 6
pageSize
∂∂7 ?
;
∂∂? @
if
∏∏ 
(
∏∏ 
	totalRows
∏∏ 
<=
∏∏ 
pageSize
∏∏ %
)
∏∏% &
{
ππ 

totalPages
∫∫ 
=
∫∫ 
$num
∫∫ 
;
∫∫ 
}
ªª 
else
ºº 
{
ΩΩ 
int
ææ 
	remainder
ææ 
;
ææ 
Math
øø 
.
øø 
DivRem
øø 
(
øø 
	totalRows
øø %
,
øø% &
pageSize
øø' /
,
øø/ 0
out
øø1 4
	remainder
øø5 >
)
øø> ?
;
øø? @
if
¿¿ 
(
¿¿ 
	remainder
¿¿ 
>
¿¿ 
$num
¿¿  !
)
¿¿! "
{
¡¡ 

totalPages
¬¬ 
+=
¬¬ !
$num
¬¬" #
;
¬¬# $
}
√√ 
}
ƒƒ  
SqlParameterHelper
∆∆ 
sph
∆∆ "
=
∆∆# $
new
∆∆% ( 
SqlParameterHelper
∆∆) ;
(
∆∆; <
ConnectionString
∆∆< L
.
∆∆L M%
GetReadConnectionString
∆∆M d
(
∆∆d e
)
∆∆e f
,
∆∆f g
$str∆∆h Ñ
,∆∆Ñ Ö
$num∆∆Ü á
)∆∆á à
;∆∆à â
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 4
,
««4 5
	SqlDbType
««6 ?
.
««? @
UniqueIdentifier
««@ P
,
««P Q 
ParameterDirection
««R d
.
««d e
Input
««e j
,
««j k
letterInfoGuid
««l z
)
««z {
;
««{ |
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 0
,
»»0 1
	SqlDbType
»»2 ;
.
»»; <
Int
»»< ?
,
»»? @ 
ParameterDirection
»»A S
.
»»S T
Input
»»T Y
,
»»Y Z

pageNumber
»»[ e
)
»»e f
;
»»f g
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# .
,
……. /
	SqlDbType
……0 9
.
……9 :
Int
……: =
,
……= > 
ParameterDirection
……? Q
.
……Q R
Input
……R W
,
……W X
pageSize
……Y a
)
……a b
;
……b c
return
   
sph
   
.
   
ExecuteReader
   $
(
  $ %
)
  % &
;
  & '
}
ÃÃ 	
}
–– 
}—— Êc
tD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterHtmlTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class  
DBLetterHtmlTemplate ,
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
guid%% 
,%% 
Guid&& 
siteGuid&& 
,&& 
string'' 
title'' 
,'' 
string(( 
html(( 
,(( 
DateTime)) 

lastModUTC)) 
)))  
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str	++i á
,
++á à
$num
++â ä
)
++ä ã
;
++ã å
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# .
,--. /
	SqlDbType--0 9
.--9 :
UniqueIdentifier--: J
,--J K
ParameterDirection--L ^
.--^ _
Input--_ d
,--d e
siteGuid--f n
)--n o
;--o p
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# +
,..+ ,
	SqlDbType..- 6
...6 7
NVarChar..7 ?
,..? @
$num..A D
,..D E
ParameterDirection..F X
...X Y
Input..Y ^
,..^ _
title..` e
)..e f
;..f g
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
NVarChar//6 >
,//> ?
-//@ A
$num//A B
,//B C
ParameterDirection//D V
.//V W
Input//W \
,//\ ]
html//^ b
)//b c
;//c d
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# 0
,000 1
	SqlDbType002 ;
.00; <
DateTime00< D
,00D E
ParameterDirection00F X
.00X Y
Input00Y ^
,00^ _

lastModUTC00` j
)00j k
;00k l
int11 
rowsAffected11 
=11 
sph11 "
.11" #
ExecuteNonQuery11# 2
(112 3
)113 4
;114 5
return22 
rowsAffected22 
;22  
}33 	
public>> 
static>> 
bool>> 
Update>> !
(>>! "
Guid?? 
guid?? 
,?? 
string@@ 
title@@ 
,@@ 
stringAA 
htmlAA 
,AA 
DateTimeBB 

lastModUTCBB 
)BB  
{CC 	
SqlParameterHelperDD 
sphDD "
=DD# $
newDD% (
SqlParameterHelperDD) ;
(DD; <
ConnectionStringDD< L
.DDL M$
GetWriteConnectionStringDDM e
(DDe f
)DDf g
,DDg h
$str	DDi á
,
DDá à
$num
DDâ ä
)
DDä ã
;
DDã å
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# *
,EE* +
	SqlDbTypeEE, 5
.EE5 6
UniqueIdentifierEE6 F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
guidEEb f
)EEf g
;EEg h
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# +
,FF+ ,
	SqlDbTypeFF- 6
.FF6 7
NVarCharFF7 ?
,FF? @
$numFFA D
,FFD E
ParameterDirectionFFF X
.FFX Y
InputFFY ^
,FF^ _
titleFF` e
)FFe f
;FFf g
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# *
,GG* +
	SqlDbTypeGG, 5
.GG5 6
NVarCharGG6 >
,GG> ?
-GG@ A
$numGGA B
,GGB C
ParameterDirectionGGD V
.GGV W
InputGGW \
,GG\ ]
htmlGG^ b
)GGb c
;GGc d
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
DateTimeHH< D
,HHD E
ParameterDirectionHHF X
.HHX Y
InputHHY ^
,HH^ _

lastModUTCHH` j
)HHj k
;HHk l
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}KK 	
publicRR 
staticRR 
boolRR 
DeleteRR !
(RR! "
GuidSS 
guidSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$str	UUi á
,
UUá à
$num
UUâ ä
)
UUä ã
;
UUã å
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
(XX 
rowsAffectedXX  
>XX! "
$numXX# $
)XX$ %
;XX% &
}ZZ 	
public`` 
static`` 
IDataReader`` !
GetOne``" (
(``( )
Guidaa 
guidaa 
)aa 
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M#
GetReadConnectionStringccM d
(ccd e
)cce f
,ccf g
$str	cch â
,
ccâ ä
$num
ccã å
)
ccå ç
;
ccç é
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# *
,dd* +
	SqlDbTypedd, 5
.dd5 6
UniqueIdentifierdd6 F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
guidddb f
)ddf g
;ddg h
returnee 
sphee 
.ee 
ExecuteReaderee $
(ee$ %
)ee% &
;ee& '
}ff 	
publickk 
statickk 
intkk 
GetCountkk "
(kk" #
Guidkk# '
siteGuidkk( 0
)kk0 1
{ll 	
SqlParameterHelpernn 
sphnn "
=nn# $
newnn% (
SqlParameterHelpernn) ;
(nn; <
ConnectionStringnn< L
.nnL M#
GetReadConnectionStringnnM d
(nnd e
)nne f
,nnf g
$str	nnh à
,
nnà â
$num
nnä ã
)
nnã å
;
nnå ç
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# .
,oo. /
	SqlDbTypeoo0 9
.oo9 :
UniqueIdentifieroo: J
,ooJ K
ParameterDirectionooL ^
.oo^ _
Inputoo_ d
,ood e
siteGuidoof n
)oon o
;ooo p
returnpp 
Convertpp 
.pp 
ToInt32pp "
(pp" #
sphpp# &
.pp& '
ExecuteScalarpp' 4
(pp4 5
)pp5 6
)pp6 7
;pp7 8
}ss 	
publicxx 
staticxx 
IDataReaderxx !
GetAllxx" (
(xx( )
Guidxx) -
siteGuidxx. 6
)xx6 7
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh â
,
zzâ ä
$num
zzã å
)
zzå ç
;
zzç é
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# .
,{{. /
	SqlDbType{{0 9
.{{9 :
UniqueIdentifier{{: J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
siteGuid{{f n
){{n o
;{{o p
return|| 
sph|| 
.|| 
ExecuteReader|| $
(||$ %
)||% &
;||& '
}
ÄÄ 	
public
àà 
static
àà 
IDataReader
àà !
GetPage
àà" )
(
àà) *
Guid
ââ 
siteGuid
ââ 
,
ââ 
int
ää 

pageNumber
ää 
,
ää 
int
ãã 
pageSize
ãã 
,
ãã 
out
åå 
int
åå 

totalPages
åå 
)
åå 
{
çç 	

totalPages
éé 
=
éé 
$num
éé 
;
éé 
int
èè 
	totalRows
èè 
=
êê 
GetCount
êê 
(
êê 
siteGuid
êê #
)
êê# $
;
êê$ %
if
íí 
(
íí 
pageSize
íí 
>
íí 
$num
íí 
)
íí 

totalPages
íí (
=
íí) *
	totalRows
íí+ 4
/
íí5 6
pageSize
íí7 ?
;
íí? @
if
îî 
(
îî 
	totalRows
îî 
<=
îî 
pageSize
îî %
)
îî% &
{
ïï 

totalPages
ññ 
=
ññ 
$num
ññ 
;
ññ 
}
óó 
else
òò 
{
ôô 
int
öö 
	remainder
öö 
;
öö 
Math
õõ 
.
õõ 
DivRem
õõ 
(
õõ 
	totalRows
õõ %
,
õõ% &
pageSize
õõ' /
,
õõ/ 0
out
õõ1 4
	remainder
õõ5 >
)
õõ> ?
;
õõ? @
if
úú 
(
úú 
	remainder
úú 
>
úú 
$num
úú  !
)
úú! "
{
ùù 

totalPages
ûû 
+=
ûû !
$num
ûû" #
;
ûû# $
}
üü 
}
††  
SqlParameterHelper
¢¢ 
sph
¢¢ "
=
¢¢# $
new
¢¢% ( 
SqlParameterHelper
¢¢) ;
(
¢¢; <
ConnectionString
¢¢< L
.
¢¢L M%
GetReadConnectionString
¢¢M d
(
¢¢d e
)
¢¢e f
,
¢¢f g
$str¢¢h ä
,¢¢ä ã
$num¢¢å ç
)¢¢ç é
;¢¢é è
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# .
,
££. /
	SqlDbType
££0 9
.
££9 :
UniqueIdentifier
££: J
,
££J K 
ParameterDirection
££L ^
.
££^ _
Input
££_ d
,
££d e
siteGuid
££f n
)
££n o
;
££o p
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 0
,
§§0 1
	SqlDbType
§§2 ;
.
§§; <
Int
§§< ?
,
§§? @ 
ParameterDirection
§§A S
.
§§S T
Input
§§T Y
,
§§Y Z

pageNumber
§§[ e
)
§§e f
;
§§f g
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# .
,
••. /
	SqlDbType
••0 9
.
••9 :
Int
••: =
,
••= > 
ParameterDirection
••? Q
.
••Q R
Input
••R W
,
••W X
pageSize
••Y a
)
••a b
;
••b c
return
¶¶ 
sph
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
®® 	
}
™™ 
}¨¨ åâ
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterInfo.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetterInfo $
{ 
public55 
static55 
int55 
Create55  
(55  !
Guid66 
letterInfoGuid66 
,66  
Guid77 
siteGuid77 
,77 
string88 
title88 
,88 
string99 
description99 
,99 
string:: 
availableToRoles:: #
,::# $
bool;; 
enabled;; 
,;; 
bool<< 
allowUserFeedback<< "
,<<" #
bool== 
allowAnonFeedback== "
,==" #
string>> 
fromAddress>> 
,>> 
string?? 
fromName?? 
,?? 
string@@ 
replyToAddress@@ !
,@@! "
intAA 
sendModeAA 
,AA 
boolBB 
enableViewAsWebPageBB $
,BB$ %
boolCC 
enableSendLogCC 
,CC 
stringDD 
rolesThatCanEditDD #
,DD# $
stringEE 
rolesThatCanApproveEE &
,EE& '
stringFF 
rolesThatCanSendFF #
,FF# $
DateTimeGG 

createdUtcGG 
,GG  
GuidHH 
	createdByHH 
,HH 
DateTimeII 

lastModUtcII 
,II  
GuidJJ 
	lastModByJJ 
,JJ 
boolKK 
allowArchiveViewKK !
,KK! "
boolLL 
profileOptInLL 
,LL 
intMM 
sortRankMM 
,MM 
stringNN 
displayNameDefaultNN %
,NN% &
stringOO 
firstNameDefaultOO #
,OO# $
stringPP 
lastNameDefaultPP "
)PP" #
{QQ 	
SqlParameterHelperRR 
sphRR "
=RR# $
newRR% (
SqlParameterHelperRR) ;
(RR; <
ConnectionStringRR< L
.RRL M$
GetWriteConnectionStringRRM e
(RRe f
)RRf g
,RRg h
$strRRi 
,	RR Ä
$num
RRÅ É
)
RRÉ Ñ
;
RRÑ Ö
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 4
,SS4 5
	SqlDbTypeSS6 ?
.SS? @
UniqueIdentifierSS@ P
,SSP Q
ParameterDirectionSSR d
.SSd e
InputSSe j
,SSj k
letterInfoGuidSSl z
)SSz {
;SS{ |
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
siteGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# +
,UU+ ,
	SqlDbTypeUU- 6
.UU6 7
NVarCharUU7 ?
,UU? @
$numUUA D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _
titleUU` e
)UUe f
;UUf g
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 1
,VV1 2
	SqlDbTypeVV3 <
.VV< =
NVarCharVV= E
,VVE F
-VVG H
$numVVH I
,VVI J
ParameterDirectionVVK ]
.VV] ^
InputVV^ c
,VVc d
descriptionVVe p
)VVp q
;VVq r
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 6
,WW6 7
	SqlDbTypeWW8 A
.WWA B
NVarCharWWB J
,WWJ K
-WWL M
$numWWM N
,WWN O
ParameterDirectionWWP b
.WWb c
InputWWc h
,WWh i
availableToRolesWWj z
)WWz {
;WW{ |
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
BitXX9 <
,XX< =
ParameterDirectionXX> P
.XXP Q
InputXXQ V
,XXV W
enabledXXX _
)XX_ `
;XX` a
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 7
,YY7 8
	SqlDbTypeYY9 B
.YYB C
BitYYC F
,YYF G
ParameterDirectionYYH Z
.YYZ [
InputYY[ `
,YY` a
allowUserFeedbackYYb s
)YYs t
;YYt u
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 7
,ZZ7 8
	SqlDbTypeZZ9 B
.ZZB C
BitZZC F
,ZZF G
ParameterDirectionZZH Z
.ZZZ [
InputZZ[ `
,ZZ` a
allowAnonFeedbackZZb s
)ZZs t
;ZZt u
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 1
,[[1 2
	SqlDbType[[3 <
.[[< =
NVarChar[[= E
,[[E F
$num[[G J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
fromAddress[[f q
)[[q r
;[[r s
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
NVarChar\\: B
,\\B C
$num\\D G
,\\G H
ParameterDirection\\I [
.\\[ \
Input\\\ a
,\\a b
fromName\\c k
)\\k l
;\\l m
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 4
,]]4 5
	SqlDbType]]6 ?
.]]? @
NVarChar]]@ H
,]]H I
$num]]J M
,]]M N
ParameterDirection]]O a
.]]a b
Input]]b g
,]]g h
replyToAddress]]i w
)]]w x
;]]x y
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
Int^^: =
,^^= >
ParameterDirection^^? Q
.^^Q R
Input^^R W
,^^W X
sendMode^^Y a
)^^a b
;^^b c
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 9
,__9 :
	SqlDbType__; D
.__D E
Bit__E H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
enableViewAsWebPage__d w
)__w x
;__x y
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 3
,``3 4
	SqlDbType``5 >
.``> ?
Bit``? B
,``B C
ParameterDirection``D V
.``V W
Input``W \
,``\ ]
enableSendLog``^ k
)``k l
;``l m
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 6
,aa6 7
	SqlDbTypeaa8 A
.aaA B
NVarCharaaB J
,aaJ K
-aaL M
$numaaM N
,aaN O
ParameterDirectionaaP b
.aab c
Inputaac h
,aah i
rolesThatCanEditaaj z
)aaz {
;aa{ |
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 9
,bb9 :
	SqlDbTypebb; D
.bbD E
NVarCharbbE M
,bbM N
-bbO P
$numbbP Q
,bbQ R
ParameterDirectionbbS e
.bbe f
Inputbbf k
,bbk l 
rolesThatCanApprove	bbm Ä
)
bbÄ Å
;
bbÅ Ç
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 6
,cc6 7
	SqlDbTypecc8 A
.ccA B
NVarCharccB J
,ccJ K
-ccL M
$numccM N
,ccN O
ParameterDirectionccP b
.ccb c
Inputccc h
,cch i
rolesThatCanSendccj z
)ccz {
;cc{ |
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
DateTimedd< D
,ddD E
ParameterDirectionddF X
.ddX Y
InputddY ^
,dd^ _

createdUtcdd` j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
UniqueIdentifieree; K
,eeK L
ParameterDirectioneeM _
.ee_ `
Inputee` e
,eee f
	createdByeeg p
)eep q
;eeq r
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 0
,ff0 1
	SqlDbTypeff2 ;
.ff; <
DateTimeff< D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _

lastModUtcff` j
)ffj k
;ffk l
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# /
,gg/ 0
	SqlDbTypegg1 :
.gg: ;
UniqueIdentifiergg; K
,ggK L
ParameterDirectionggM _
.gg_ `
Inputgg` e
,gge f
	lastModByggg p
)ggp q
;ggq r
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 6
,ii6 7
	SqlDbTypeii8 A
.iiA B
BitiiB E
,iiE F
ParameterDirectioniiG Y
.iiY Z
InputiiZ _
,ii_ `
allowArchiveViewiia q
)iiq r
;iir s
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 2
,jj2 3
	SqlDbTypejj4 =
.jj= >
Bitjj> A
,jjA B
ParameterDirectionjjC U
.jjU V
InputjjV [
,jj[ \
profileOptInjj] i
)jji j
;jjj k
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# .
,kk. /
	SqlDbTypekk0 9
.kk9 :
Intkk: =
,kk= >
ParameterDirectionkk? Q
.kkQ R
InputkkR W
,kkW X
sortRankkkY a
)kka b
;kkb c
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 8
,mm8 9
	SqlDbTypemm: C
.mmC D
NVarCharmmD L
,mmL M
$nummmN P
,mmP Q
ParameterDirectionmmR d
.mmd e
Inputmme j
,mmj k
displayNameDefaultmml ~
)mm~ 
;	mm Ä
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 6
,nn6 7
	SqlDbTypenn8 A
.nnA B
NVarCharnnB J
,nnJ K
$numnnL N
,nnN O
ParameterDirectionnnP b
.nnb c
Inputnnc h
,nnh i
firstNameDefaultnnj z
)nnz {
;nn{ |
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 5
,oo5 6
	SqlDbTypeoo7 @
.oo@ A
NVarCharooA I
,ooI J
$numooK M
,ooM N
ParameterDirectionooO a
.ooa b
Inputoob g
,oog h
lastNameDefaultooi x
)oox y
;ooy z
intrr 
rowsAffectedrr 
=rr 
sphrr "
.rr" #
ExecuteNonQueryrr# 2
(rr2 3
)rr3 4
;rr4 5
returnss 
rowsAffectedss 
;ss  
}tt 	
public
êê 
static
êê 
bool
êê 
Update
êê !
(
êê! "
Guid
ëë 
letterInfoGuid
ëë 
,
ëë  
Guid
íí 
siteGuid
íí 
,
íí 
string
ìì 
title
ìì 
,
ìì 
string
îî 
description
îî 
,
îî 
string
ïï 
availableToRoles
ïï #
,
ïï# $
bool
ññ 
enabled
ññ 
,
ññ 
bool
óó 
allowUserFeedback
óó "
,
óó" #
bool
òò 
allowAnonFeedback
òò "
,
òò" #
string
ôô 
fromAddress
ôô 
,
ôô 
string
öö 
fromName
öö 
,
öö 
string
õõ 
replyToAddress
õõ !
,
õõ! "
int
úú 
sendMode
úú 
,
úú 
bool
ùù !
enableViewAsWebPage
ùù $
,
ùù$ %
bool
ûû 
enableSendLog
ûû 
,
ûû 
string
üü 
rolesThatCanEdit
üü #
,
üü# $
string
†† !
rolesThatCanApprove
†† &
,
††& '
string
°° 
rolesThatCanSend
°° #
,
°°# $
DateTime
¢¢ 

createdUtc
¢¢ 
,
¢¢  
Guid
££ 
	createdBy
££ 
,
££ 
DateTime
§§ 

lastModUtc
§§ 
,
§§  
Guid
•• 
	lastModBy
•• 
,
•• 
bool
¶¶ 
allowArchiveView
¶¶ !
,
¶¶! "
bool
ßß 
profileOptIn
ßß 
,
ßß 
int
®® 
sortRank
®® 
,
®® 
string
©©  
displayNameDefault
©© %
,
©©% &
string
™™ 
firstNameDefault
™™ #
,
™™# $
string
´´ 
lastNameDefault
´´ "
)
´´" #
{
¨¨ 	 
SqlParameterHelper
≠≠ 
sph
≠≠ "
=
≠≠# $
new
≠≠% ( 
SqlParameterHelper
≠≠) ;
(
≠≠; <
ConnectionString
≠≠< L
.
≠≠L M&
GetWriteConnectionString
≠≠M e
(
≠≠e f
)
≠≠f g
,
≠≠g h
$str
≠≠i 
,≠≠ Ä
$num≠≠Å É
)≠≠É Ñ
;≠≠Ñ Ö
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# 4
,
ÆÆ4 5
	SqlDbType
ÆÆ6 ?
.
ÆÆ? @
UniqueIdentifier
ÆÆ@ P
,
ÆÆP Q 
ParameterDirection
ÆÆR d
.
ÆÆd e
Input
ÆÆe j
,
ÆÆj k
letterInfoGuid
ÆÆl z
)
ÆÆz {
;
ÆÆ{ |
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
UniqueIdentifier
ØØ: J
,
ØØJ K 
ParameterDirection
ØØL ^
.
ØØ^ _
Input
ØØ_ d
,
ØØd e
siteGuid
ØØf n
)
ØØn o
;
ØØo p
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# +
,
∞∞+ ,
	SqlDbType
∞∞- 6
.
∞∞6 7
NVarChar
∞∞7 ?
,
∞∞? @
$num
∞∞A D
,
∞∞D E 
ParameterDirection
∞∞F X
.
∞∞X Y
Input
∞∞Y ^
,
∞∞^ _
title
∞∞` e
)
∞∞e f
;
∞∞f g
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# 1
,
±±1 2
	SqlDbType
±±3 <
.
±±< =
NVarChar
±±= E
,
±±E F
-
±±G H
$num
±±H I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d
description
±±e p
)
±±p q
;
±±q r
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# 6
,
≤≤6 7
	SqlDbType
≤≤8 A
.
≤≤A B
NVarChar
≤≤B J
,
≤≤J K
-
≤≤L M
$num
≤≤M N
,
≤≤N O 
ParameterDirection
≤≤P b
.
≤≤b c
Input
≤≤c h
,
≤≤h i
availableToRoles
≤≤j z
)
≤≤z {
;
≤≤{ |
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# -
,
≥≥- .
	SqlDbType
≥≥/ 8
.
≥≥8 9
Bit
≥≥9 <
,
≥≥< = 
ParameterDirection
≥≥> P
.
≥≥P Q
Input
≥≥Q V
,
≥≥V W
enabled
≥≥X _
)
≥≥_ `
;
≥≥` a
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 7
,
¥¥7 8
	SqlDbType
¥¥9 B
.
¥¥B C
Bit
¥¥C F
,
¥¥F G 
ParameterDirection
¥¥H Z
.
¥¥Z [
Input
¥¥[ `
,
¥¥` a
allowUserFeedback
¥¥b s
)
¥¥s t
;
¥¥t u
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 7
,
µµ7 8
	SqlDbType
µµ9 B
.
µµB C
Bit
µµC F
,
µµF G 
ParameterDirection
µµH Z
.
µµZ [
Input
µµ[ `
,
µµ` a
allowAnonFeedback
µµb s
)
µµs t
;
µµt u
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# 1
,
∂∂1 2
	SqlDbType
∂∂3 <
.
∂∂< =
NVarChar
∂∂= E
,
∂∂E F
$num
∂∂G J
,
∂∂J K 
ParameterDirection
∂∂L ^
.
∂∂^ _
Input
∂∂_ d
,
∂∂d e
fromAddress
∂∂f q
)
∂∂q r
;
∂∂r s
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# .
,
∑∑. /
	SqlDbType
∑∑0 9
.
∑∑9 :
NVarChar
∑∑: B
,
∑∑B C
$num
∑∑D G
,
∑∑G H 
ParameterDirection
∑∑I [
.
∑∑[ \
Input
∑∑\ a
,
∑∑a b
fromName
∑∑c k
)
∑∑k l
;
∑∑l m
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# 4
,
∏∏4 5
	SqlDbType
∏∏6 ?
.
∏∏? @
NVarChar
∏∏@ H
,
∏∏H I
$num
∏∏J M
,
∏∏M N 
ParameterDirection
∏∏O a
.
∏∏a b
Input
∏∏b g
,
∏∏g h
replyToAddress
∏∏i w
)
∏∏w x
;
∏∏x y
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# .
,
ππ. /
	SqlDbType
ππ0 9
.
ππ9 :
Int
ππ: =
,
ππ= > 
ParameterDirection
ππ? Q
.
ππQ R
Input
ππR W
,
ππW X
sendMode
ππY a
)
ππa b
;
ππb c
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# 9
,
∫∫9 :
	SqlDbType
∫∫; D
.
∫∫D E
Bit
∫∫E H
,
∫∫H I 
ParameterDirection
∫∫J \
.
∫∫\ ]
Input
∫∫] b
,
∫∫b c!
enableViewAsWebPage
∫∫d w
)
∫∫w x
;
∫∫x y
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 3
,
ªª3 4
	SqlDbType
ªª5 >
.
ªª> ?
Bit
ªª? B
,
ªªB C 
ParameterDirection
ªªD V
.
ªªV W
Input
ªªW \
,
ªª\ ]
enableSendLog
ªª^ k
)
ªªk l
;
ªªl m
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 6
,
ºº6 7
	SqlDbType
ºº8 A
.
ººA B
NVarChar
ººB J
,
ººJ K
-
ººL M
$num
ººM N
,
ººN O 
ParameterDirection
ººP b
.
ººb c
Input
ººc h
,
ººh i
rolesThatCanEdit
ººj z
)
ººz {
;
ºº{ |
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# 9
,
ΩΩ9 :
	SqlDbType
ΩΩ; D
.
ΩΩD E
NVarChar
ΩΩE M
,
ΩΩM N
-
ΩΩO P
$num
ΩΩP Q
,
ΩΩQ R 
ParameterDirection
ΩΩS e
.
ΩΩe f
Input
ΩΩf k
,
ΩΩk l"
rolesThatCanApproveΩΩm Ä
)ΩΩÄ Å
;ΩΩÅ Ç
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 6
,
ææ6 7
	SqlDbType
ææ8 A
.
ææA B
NVarChar
ææB J
,
ææJ K
-
ææL M
$num
ææM N
,
ææN O 
ParameterDirection
ææP b
.
ææb c
Input
ææc h
,
ææh i
rolesThatCanSend
ææj z
)
ææz {
;
ææ{ |
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# 0
,
øø0 1
	SqlDbType
øø2 ;
.
øø; <
DateTime
øø< D
,
øøD E 
ParameterDirection
øøF X
.
øøX Y
Input
øøY ^
,
øø^ _

createdUtc
øø` j
)
øøj k
;
øøk l
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# /
,
¿¿/ 0
	SqlDbType
¿¿1 :
.
¿¿: ;
UniqueIdentifier
¿¿; K
,
¿¿K L 
ParameterDirection
¿¿M _
.
¿¿_ `
Input
¿¿` e
,
¿¿e f
	createdBy
¿¿g p
)
¿¿p q
;
¿¿q r
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 0
,
¡¡0 1
	SqlDbType
¡¡2 ;
.
¡¡; <
DateTime
¡¡< D
,
¡¡D E 
ParameterDirection
¡¡F X
.
¡¡X Y
Input
¡¡Y ^
,
¡¡^ _

lastModUtc
¡¡` j
)
¡¡j k
;
¡¡k l
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# /
,
¬¬/ 0
	SqlDbType
¬¬1 :
.
¬¬: ;
UniqueIdentifier
¬¬; K
,
¬¬K L 
ParameterDirection
¬¬M _
.
¬¬_ `
Input
¬¬` e
,
¬¬e f
	lastModBy
¬¬g p
)
¬¬p q
;
¬¬q r
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ "
(
ƒƒ" #
$str
ƒƒ# 6
,
ƒƒ6 7
	SqlDbType
ƒƒ8 A
.
ƒƒA B
Bit
ƒƒB E
,
ƒƒE F 
ParameterDirection
ƒƒG Y
.
ƒƒY Z
Input
ƒƒZ _
,
ƒƒ_ `
allowArchiveView
ƒƒa q
)
ƒƒq r
;
ƒƒr s
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ "
(
≈≈" #
$str
≈≈# 2
,
≈≈2 3
	SqlDbType
≈≈4 =
.
≈≈= >
Bit
≈≈> A
,
≈≈A B 
ParameterDirection
≈≈C U
.
≈≈U V
Input
≈≈V [
,
≈≈[ \
profileOptIn
≈≈] i
)
≈≈i j
;
≈≈j k
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ "
(
∆∆" #
$str
∆∆# .
,
∆∆. /
	SqlDbType
∆∆0 9
.
∆∆9 :
Int
∆∆: =
,
∆∆= > 
ParameterDirection
∆∆? Q
.
∆∆Q R
Input
∆∆R W
,
∆∆W X
sortRank
∆∆Y a
)
∆∆a b
;
∆∆b c
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 8
,
»»8 9
	SqlDbType
»»: C
.
»»C D
NVarChar
»»D L
,
»»L M
$num
»»N P
,
»»P Q 
ParameterDirection
»»R d
.
»»d e
Input
»»e j
,
»»j k 
displayNameDefault
»»l ~
)
»»~ 
;»» Ä
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# 6
,
……6 7
	SqlDbType
……8 A
.
……A B
NVarChar
……B J
,
……J K
$num
……L N
,
……N O 
ParameterDirection
……P b
.
……b c
Input
……c h
,
……h i
firstNameDefault
……j z
)
……z {
;
……{ |
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 5
,
  5 6
	SqlDbType
  7 @
.
  @ A
NVarChar
  A I
,
  I J
$num
  K M
,
  M N 
ParameterDirection
  O a
.
  a b
Input
  b g
,
  g h
lastNameDefault
  i x
)
  x y
;
  y z
int
ÃÃ 
rowsAffected
ÃÃ 
=
ÃÃ 
sph
ÃÃ "
.
ÃÃ" #
ExecuteNonQuery
ÃÃ# 2
(
ÃÃ2 3
)
ÃÃ3 4
;
ÃÃ4 5
return
ÕÕ 
(
ÕÕ 
rowsAffected
ÕÕ  
>
ÕÕ! "
$num
ÕÕ# $
)
ÕÕ$ %
;
ÕÕ% &
}
ŒŒ 	
public
’’ 
static
’’ 
bool
’’ #
UpdateSubscriberCount
’’ 0
(
’’0 1
Guid
’’1 5
letterInfoGuid
’’6 D
)
’’D E
{
÷÷ 	 
SqlParameterHelper
◊◊ 
sph
◊◊ "
=
◊◊# $
new
◊◊% ( 
SqlParameterHelper
◊◊) ;
(
◊◊; <
ConnectionString
◊◊< L
.
◊◊L M&
GetWriteConnectionString
◊◊M e
(
◊◊e f
)
◊◊f g
,
◊◊g h
$str◊◊i é
,◊◊é è
$num◊◊ê ë
)◊◊ë í
;◊◊í ì
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 4
,
ÿÿ4 5
	SqlDbType
ÿÿ6 ?
.
ÿÿ? @
UniqueIdentifier
ÿÿ@ P
,
ÿÿP Q 
ParameterDirection
ÿÿR d
.
ÿÿd e
Input
ÿÿe j
,
ÿÿj k
letterInfoGuid
ÿÿl z
)
ÿÿz {
;
ÿÿ{ |
int
ŸŸ 
rowsAffected
ŸŸ 
=
ŸŸ 
sph
ŸŸ "
.
ŸŸ" #
ExecuteNonQuery
ŸŸ# 2
(
ŸŸ2 3
)
ŸŸ3 4
;
ŸŸ4 5
return
⁄⁄ 
(
⁄⁄ 
rowsAffected
⁄⁄  
>
⁄⁄! "
$num
⁄⁄# $
)
⁄⁄$ %
;
⁄⁄% &
}
€€ 	
public
‚‚ 
static
‚‚ 
bool
‚‚ 
Delete
‚‚ !
(
‚‚! "
Guid
„„ 
letterInfoGuid
„„ 
)
„„  
{
‰‰ 	 
SqlParameterHelper
ÂÂ 
sph
ÂÂ "
=
ÂÂ# $
new
ÂÂ% ( 
SqlParameterHelper
ÂÂ) ;
(
ÂÂ; <
ConnectionString
ÂÂ< L
.
ÂÂL M&
GetWriteConnectionString
ÂÂM e
(
ÂÂe f
)
ÂÂf g
,
ÂÂg h
$str
ÂÂi 
,ÂÂ Ä
$numÂÂÅ Ç
)ÂÂÇ É
;ÂÂÉ Ñ
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 4
,
ÊÊ4 5
	SqlDbType
ÊÊ6 ?
.
ÊÊ? @
UniqueIdentifier
ÊÊ@ P
,
ÊÊP Q 
ParameterDirection
ÊÊR d
.
ÊÊd e
Input
ÊÊe j
,
ÊÊj k
letterInfoGuid
ÊÊl z
)
ÊÊz {
;
ÊÊ{ |
int
ÁÁ 
rowsAffected
ÁÁ 
=
ÁÁ 
sph
ÁÁ "
.
ÁÁ" #
ExecuteNonQuery
ÁÁ# 2
(
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
return
ËË 
(
ËË 
rowsAffected
ËË  
>
ËË! "
$num
ËË# $
)
ËË$ %
;
ËË% &
}
ÍÍ 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !
GetOne
ÒÒ" (
(
ÒÒ( )
Guid
ÚÚ 
letterInfoGuid
ÚÚ 
)
ÚÚ  
{
ÛÛ 	 
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$strÙÙh Å
,ÙÙÅ Ç
$numÙÙÉ Ñ
)ÙÙÑ Ö
;ÙÙÖ Ü
sph
ıı 
.
ıı  
DefineSqlParameter
ıı "
(
ıı" #
$str
ıı# 4
,
ıı4 5
	SqlDbType
ıı6 ?
.
ıı? @
UniqueIdentifier
ıı@ P
,
ııP Q 
ParameterDirection
ııR d
.
ııd e
Input
ııe j
,
ııj k
letterInfoGuid
ııl z
)
ıız {
;
ıı{ |
return
ˆˆ 
sph
ˆˆ 
.
ˆˆ 
ExecuteReader
ˆˆ $
(
ˆˆ$ %
)
ˆˆ% &
;
ˆˆ& '
}
˜˜ 	
public
¸¸ 
static
¸¸ 
int
¸¸ 
GetCount
¸¸ "
(
¸¸" #
Guid
¸¸# '
siteGuid
¸¸( 0
)
¸¸0 1
{
˝˝ 	 
SqlParameterHelper
˛˛ 
sph
˛˛ "
=
˛˛# $
new
˛˛% ( 
SqlParameterHelper
˛˛) ;
(
˛˛; <
ConnectionString
˛˛< L
.
˛˛L M%
GetReadConnectionString
˛˛M d
(
˛˛d e
)
˛˛e f
,
˛˛f g
$str˛˛h Ä
,˛˛Ä Å
$num˛˛Ç É
)˛˛É Ñ
;˛˛Ñ Ö
sph
ˇˇ 
.
ˇˇ  
DefineSqlParameter
ˇˇ "
(
ˇˇ" #
$str
ˇˇ# .
,
ˇˇ. /
	SqlDbType
ˇˇ0 9
.
ˇˇ9 :
UniqueIdentifier
ˇˇ: J
,
ˇˇJ K 
ParameterDirection
ˇˇL ^
.
ˇˇ^ _
Input
ˇˇ_ d
,
ˇˇd e
siteGuid
ˇˇf n
)
ˇˇn o
;
ˇˇo p
return
ÅÅ 
Convert
ÅÅ 
.
ÅÅ 
ToInt32
ÅÅ "
(
ÅÅ" #
sph
ÅÅ# &
.
ÅÅ& '
ExecuteScalar
ÅÅ' 4
(
ÅÅ4 5
)
ÅÅ5 6
)
ÅÅ6 7
;
ÅÅ7 8
}
ÉÉ 	
public
àà 
static
àà 
IDataReader
àà !
GetAll
àà" (
(
àà( )
Guid
àà) -
siteGuid
àà. 6
)
àà6 7
{
ââ 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M%
GetReadConnectionString
ääM d
(
ääd e
)
ääe f
,
ääf g
$strääh Å
,ääÅ Ç
$numääÉ Ñ
)ääÑ Ö
;ääÖ Ü
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# .
,
ãã. /
	SqlDbType
ãã0 9
.
ãã9 :
UniqueIdentifier
ãã: J
,
ããJ K 
ParameterDirection
ããL ^
.
ãã^ _
Input
ãã_ d
,
ããd e
siteGuid
ããf n
)
ããn o
;
ãão p
return
åå 
sph
åå 
.
åå 
ExecuteReader
åå $
(
åå$ %
)
åå% &
;
åå& '
}
éé 	
public
ññ 
static
ññ 
IDataReader
ññ !
GetPage
ññ" )
(
ññ) *
Guid
óó 
siteGuid
óó 
,
óó 
int
òò 

pageNumber
òò 
,
òò 
int
ôô 
pageSize
ôô 
,
ôô 
out
öö 
int
öö 

totalPages
öö 
)
öö 
{
õõ 	

totalPages
úú 
=
úú 
$num
úú 
;
úú 
int
ùù 
	totalRows
ùù 
=
ûû 
GetCount
ûû 
(
ûû 
siteGuid
ûû #
)
ûû# $
;
ûû$ %
if
†† 
(
†† 
pageSize
†† 
>
†† 
$num
†† 
)
†† 

totalPages
†† (
=
††) *
	totalRows
††+ 4
/
††5 6
pageSize
††7 ?
;
††? @
if
¢¢ 
(
¢¢ 
	totalRows
¢¢ 
<=
¢¢ 
pageSize
¢¢ %
)
¢¢% &
{
££ 

totalPages
§§ 
=
§§ 
$num
§§ 
;
§§ 
}
•• 
else
¶¶ 
{
ßß 
int
®® 
	remainder
®® 
;
®® 
Math
©© 
.
©© 
DivRem
©© 
(
©© 
	totalRows
©© %
,
©©% &
pageSize
©©' /
,
©©/ 0
out
©©1 4
	remainder
©©5 >
)
©©> ?
;
©©? @
if
™™ 
(
™™ 
	remainder
™™ 
>
™™ 
$num
™™  !
)
™™! "
{
´´ 

totalPages
¨¨ 
+=
¨¨ !
$num
¨¨" #
;
¨¨# $
}
≠≠ 
}
ÆÆ  
SqlParameterHelper
∞∞ 
sph
∞∞ "
=
∞∞# $
new
∞∞% ( 
SqlParameterHelper
∞∞) ;
(
∞∞; <
ConnectionString
∞∞< L
.
∞∞L M%
GetReadConnectionString
∞∞M d
(
∞∞d e
)
∞∞e f
,
∞∞f g
$str∞∞h Ç
,∞∞Ç É
$num∞∞Ñ Ö
)∞∞Ö Ü
;∞∞Ü á
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
UniqueIdentifier
±±: J
,
±±J K 
ParameterDirection
±±L ^
.
±±^ _
Input
±±_ d
,
±±d e
siteGuid
±±f n
)
±±n o
;
±±o p
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# 0
,
≤≤0 1
	SqlDbType
≤≤2 ;
.
≤≤; <
Int
≤≤< ?
,
≤≤? @ 
ParameterDirection
≤≤A S
.
≤≤S T
Input
≤≤T Y
,
≤≤Y Z

pageNumber
≤≤[ e
)
≤≤e f
;
≤≤f g
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# .
,
≥≥. /
	SqlDbType
≥≥0 9
.
≥≥9 :
Int
≥≥: =
,
≥≥= > 
ParameterDirection
≥≥? Q
.
≥≥Q R
Input
≥≥R W
,
≥≥W X
pageSize
≥≥Y a
)
≥≥a b
;
≥≥b c
return
¥¥ 
sph
¥¥ 
.
¥¥ 
ExecuteReader
¥¥ $
(
¥¥$ %
)
¥¥% &
;
¥¥& '
}
∂∂ 	
}
ππ 
}∫∫ ˚ë
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterSendLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetterSendLog '
{ 
public'' 
static'' 
int'' 
Create''  
(''  !
Guid(( 

letterGuid(( 
,(( 
Guid)) 
userGuid)) 
,)) 
Guid** 
subscribeGuid** 
,** 
string++ 
emailAddress++ 
,++  
DateTime,, 
uTC,, 
,,, 
bool-- 
errorOccurred-- 
,-- 
string.. 
errorMessage.. 
)..  
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i Ç
,
00Ç É
$num
00Ñ Ö
)
00Ö Ü
;
00Ü á
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
UniqueIdentifier11< L
,11L M
ParameterDirection11N `
.11` a
Input11a f
,11f g

letterGuid11h r
)11r s
;11s t
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
userGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 3
,333 4
	SqlDbType335 >
.33> ?
UniqueIdentifier33? O
,33O P
ParameterDirection33Q c
.33c d
Input33d i
,33i j
subscribeGuid33k x
)33x y
;33y z
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 2
,442 3
	SqlDbType444 =
.44= >
NVarChar44> F
,44F G
$num44H K
,44K L
ParameterDirection44M _
.44_ `
Input44` e
,44e f
emailAddress44g s
)44s t
;44t u
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# )
,55) *
	SqlDbType55+ 4
.554 5
DateTime555 =
,55= >
ParameterDirection55? Q
.55Q R
Input55R W
,55W X
uTC55Y \
)55\ ]
;55] ^
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 3
,663 4
	SqlDbType665 >
.66> ?
Bit66? B
,66B C
ParameterDirection66D V
.66V W
Input66W \
,66\ ]
errorOccurred66^ k
)66k l
;66l m
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 2
,772 3
	SqlDbType774 =
.77= >
NVarChar77> F
,77F G
-77H I
$num77I J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
errorMessage77f r
)77r s
;77s t
int88 
newID88 
=88 
Convert88 
.88  
ToInt3288  '
(88' (
sph88( +
.88+ ,
ExecuteScalar88, 9
(889 :
)88: ;
)88; <
;88< =
return99 
newID99 
;99 
}:: 	
publicHH 
staticHH 
boolHH 
UpdateHH !
(HH! "
intII 
rowIdII 
,II 
GuidJJ 

letterGuidJJ 
,JJ 
GuidKK 
userGuidKK 
,KK 
stringLL 
emailAddressLL 
,LL  
DateTimeMM 
uTCMM 
,MM 
boolNN 
errorOccurredNN 
,NN 
stringOO 
errorMessageOO 
)OO  
{PP 	
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h
$str	QQi Ç
,
QQÇ É
$num
QQÑ Ö
)
QQÖ Ü
;
QQÜ á
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# +
,RR+ ,
	SqlDbTypeRR- 6
.RR6 7
IntRR7 :
,RR: ;
ParameterDirectionRR< N
.RRN O
InputRRO T
,RRT U
rowIdRRV [
)RR[ \
;RR\ ]
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 0
,SS0 1
	SqlDbTypeSS2 ;
.SS; <
UniqueIdentifierSS< L
,SSL M
ParameterDirectionSSN `
.SS` a
InputSSa f
,SSf g

letterGuidSSh r
)SSr s
;SSs t
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
userGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NVarCharUU> F
,UUF G
$numUUH K
,UUK L
ParameterDirectionUUM _
.UU_ `
InputUU` e
,UUe f
emailAddressUUg s
)UUs t
;UUt u
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# )
,VV) *
	SqlDbTypeVV+ 4
.VV4 5
DateTimeVV5 =
,VV= >
ParameterDirectionVV? Q
.VVQ R
InputVVR W
,VVW X
uTCVVY \
)VV\ ]
;VV] ^
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 3
,WW3 4
	SqlDbTypeWW5 >
.WW> ?
BitWW? B
,WWB C
ParameterDirectionWWD V
.WWV W
InputWWW \
,WW\ ]
errorOccurredWW^ k
)WWk l
;WWl m
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 2
,XX2 3
	SqlDbTypeXX4 =
.XX= >
NVarCharXX> F
,XXF G
-XXH I
$numXXI J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
errorMessageXXf r
)XXr s
;XXs t
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
(ZZ 
rowsAffectedZZ  
>ZZ! "
$numZZ# $
)ZZ$ %
;ZZ% &
}[[ 	
publicbb 
staticbb 
boolbb 
Deletebb !
(bb! "
intbb" %
rowIdbb& +
)bb+ ,
{cc 	
SqlParameterHelperdd 
sphdd "
=dd# $
newdd% (
SqlParameterHelperdd) ;
(dd; <
ConnectionStringdd< L
.ddL M$
GetWriteConnectionStringddM e
(dde f
)ddf g
,ddg h
$str	ddi Ç
,
ddÇ É
$num
ddÑ Ö
)
ddÖ Ü
;
ddÜ á
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# +
,ee+ ,
	SqlDbTypeee- 6
.ee6 7
Intee7 :
,ee: ;
ParameterDirectionee< N
.eeN O
InputeeO T
,eeT U
rowIdeeV [
)ee[ \
;ee\ ]
intff 
rowsAffectedff 
=ff 
sphff "
.ff" #
ExecuteNonQueryff# 2
(ff2 3
)ff3 4
;ff4 5
returngg 
(gg 
rowsAffectedgg  
>gg! "
$numgg# $
)gg$ %
;gg% &
}ii 	
publicpp 
staticpp 
boolpp 
DeleteByLetterpp )
(pp) *
Guidpp* .

letterGuidpp/ 9
)pp9 :
{qq 	
SqlParameterHelperrr 
sphrr "
=rr# $
newrr% (
SqlParameterHelperrr) ;
(rr; <
ConnectionStringrr< L
.rrL M$
GetWriteConnectionStringrrM e
(rre f
)rrf g
,rrg h
$str	rri ä
,
rrä ã
$num
rrå ç
)
rrç é
;
rré è
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 0
,ss0 1
	SqlDbTypess2 ;
.ss; <
UniqueIdentifierss< L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g

letterGuidssh r
)ssr s
;sss t
inttt 
rowsAffectedtt 
=tt 
sphtt "
.tt" #
ExecuteNonQuerytt# 2
(tt2 3
)tt3 4
;tt4 5
returnuu 
(uu 
rowsAffecteduu  
>uu! "
$numuu# $
)uu$ %
;uu% &
}ww 	
publicyy 
staticyy 
boolyy 
DeleteByLetterInfoyy -
(yy- .
Guidyy. 2
letterInfoGuidyy3 A
)yyA B
{zz 	
SqlParameterHelper{{ 
sph{{ "
={{# $
new{{% (
SqlParameterHelper{{) ;
({{; <
ConnectionString{{< L
.{{L M$
GetWriteConnectionString{{M e
({{e f
){{f g
,{{g h
$str	{{i é
,
{{é è
$num
{{ê ë
)
{{ë í
;
{{í ì
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 4
,||4 5
	SqlDbType||6 ?
.||? @
UniqueIdentifier||@ P
,||P Q
ParameterDirection||R d
.||d e
Input||e j
,||j k
letterInfoGuid||l z
)||z {
;||{ |
int}} 
rowsAffected}} 
=}} 
sph}} "
.}}" #
ExecuteNonQuery}}# 2
(}}2 3
)}}3 4
;}}4 5
return~~ 
(~~ 
rowsAffected~~  
>~~! "
$num~~# $
)~~$ %
;~~% &
}
ÄÄ 	
public
ÇÇ 
static
ÇÇ 
bool
ÇÇ 
DeleteBySite
ÇÇ '
(
ÇÇ' (
Guid
ÇÇ( ,
siteGuid
ÇÇ- 5
)
ÇÇ5 6
{
ÉÉ 	 
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M&
GetWriteConnectionString
ÑÑM e
(
ÑÑe f
)
ÑÑf g
,
ÑÑg h
$strÑÑi à
,ÑÑà â
$numÑÑä ã
)ÑÑã å
;ÑÑå ç
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# .
,
ÖÖ. /
	SqlDbType
ÖÖ0 9
.
ÖÖ9 :
UniqueIdentifier
ÖÖ: J
,
ÖÖJ K 
ParameterDirection
ÖÖL ^
.
ÖÖ^ _
Input
ÖÖ_ d
,
ÖÖd e
siteGuid
ÖÖf n
)
ÖÖn o
;
ÖÖo p
int
ÜÜ 
rowsAffected
ÜÜ 
=
ÜÜ 
sph
ÜÜ "
.
ÜÜ" #
ExecuteNonQuery
ÜÜ# 2
(
ÜÜ2 3
)
ÜÜ3 4
;
ÜÜ4 5
return
áá 
(
áá 
rowsAffected
áá  
>
áá! "
$num
áá# $
)
áá$ %
;
áá% &
}
ââ 	
public
èè 
static
èè 
IDataReader
èè !
GetOne
èè" (
(
èè( )
int
èè) ,
rowId
èè- 2
)
èè2 3
{
êê 	 
SqlParameterHelper
ëë 
sph
ëë "
=
ëë# $
new
ëë% ( 
SqlParameterHelper
ëë) ;
(
ëë; <
ConnectionString
ëë< L
.
ëëL M%
GetReadConnectionString
ëëM d
(
ëëd e
)
ëëe f
,
ëëf g
$strëëh Ñ
,ëëÑ Ö
$numëëÜ á
)ëëá à
;ëëà â
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# +
,
íí+ ,
	SqlDbType
íí- 6
.
íí6 7
Int
íí7 :
,
íí: ; 
ParameterDirection
íí< N
.
ííN O
Input
ííO T
,
ííT U
rowId
ííV [
)
íí[ \
;
íí\ ]
return
ìì 
sph
ìì 
.
ìì 
ExecuteReader
ìì $
(
ìì$ %
)
ìì% &
;
ìì& '
}
îî 	
public
ôô 
static
ôô 
int
ôô 
GetCount
ôô "
(
ôô" #
Guid
ôô# '

letterGuid
ôô( 2
)
ôô2 3
{
öö 	 
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M%
GetReadConnectionString
õõM d
(
õõd e
)
õõe f
,
õõf g
$strõõh É
,õõÉ Ñ
$numõõÖ Ü
)õõÜ á
;õõá à
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 0
,
úú0 1
	SqlDbType
úú2 ;
.
úú; <
UniqueIdentifier
úú< L
,
úúL M 
ParameterDirection
úúN `
.
úú` a
Input
úúa f
,
úúf g

letterGuid
úúh r
)
úúr s
;
úús t
return
ûû 
Convert
ûû 
.
ûû 
ToInt32
ûû "
(
ûû" #
sph
ûû# &
.
ûû& '
ExecuteScalar
ûû' 4
(
ûû4 5
)
ûû5 6
)
ûû6 7
;
ûû7 8
}
†† 	
public
•• 
static
•• 
IDataReader
•• !
GetByLetter
••" -
(
••- .
Guid
••. 2

letterGuid
••3 =
)
••= >
{
¶¶ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M%
GetReadConnectionString
ßßM d
(
ßßd e
)
ßße f
,
ßßf g
$strßßh â
,ßßâ ä
$numßßã å
)ßßå ç
;ßßç é
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 0
,
®®0 1
	SqlDbType
®®2 ;
.
®®; <
UniqueIdentifier
®®< L
,
®®L M 
ParameterDirection
®®N `
.
®®` a
Input
®®a f
,
®®f g

letterGuid
®®h r
)
®®r s
;
®®s t
return
©© 
sph
©© 
.
©© 
ExecuteReader
©© $
(
©©$ %
)
©©% &
;
©©& '
}
≠≠ 	
public
µµ 
static
µµ 
IDataReader
µµ !
GetPage
µµ" )
(
µµ) *
Guid
∂∂ 

letterGuid
∂∂ 
,
∂∂ 
int
∑∑ 

pageNumber
∑∑ 
,
∑∑ 
int
∏∏ 
pageSize
∏∏ 
,
∏∏ 
out
ππ 
int
ππ 

totalPages
ππ 
)
ππ 
{
∫∫ 	

totalPages
ªª 
=
ªª 
$num
ªª 
;
ªª 
int
ºº 
	totalRows
ºº 
=
ΩΩ 
GetCount
ΩΩ 
(
ΩΩ 

letterGuid
ΩΩ %
)
ΩΩ% &
;
ΩΩ& '
if
øø 
(
øø 
pageSize
øø 
>
øø 
$num
øø 
)
øø 

totalPages
øø (
=
øø) *
	totalRows
øø+ 4
/
øø5 6
pageSize
øø7 ?
;
øø? @
if
¡¡ 
(
¡¡ 
	totalRows
¡¡ 
<=
¡¡ 
pageSize
¡¡ %
)
¡¡% &
{
¬¬ 

totalPages
√√ 
=
√√ 
$num
√√ 
;
√√ 
}
ƒƒ 
else
≈≈ 
{
∆∆ 
int
«« 
	remainder
«« 
;
«« 
Math
»» 
.
»» 
DivRem
»» 
(
»» 
	totalRows
»» %
,
»»% &
pageSize
»»' /
,
»»/ 0
out
»»1 4
	remainder
»»5 >
)
»»> ?
;
»»? @
if
…… 
(
…… 
	remainder
…… 
>
…… 
$num
……  !
)
……! "
{
   

totalPages
ÀÀ 
+=
ÀÀ !
$num
ÀÀ" #
;
ÀÀ# $
}
ÃÃ 
}
ÕÕ  
SqlParameterHelper
œœ 
sph
œœ "
=
œœ# $
new
œœ% ( 
SqlParameterHelper
œœ) ;
(
œœ; <
ConnectionString
œœ< L
.
œœL M%
GetReadConnectionString
œœM d
(
œœd e
)
œœe f
,
œœf g
$strœœh Ö
,œœÖ Ü
$numœœá à
)œœà â
;œœâ ä
sph
–– 
.
––  
DefineSqlParameter
–– "
(
––" #
$str
––# 0
,
––0 1
	SqlDbType
––2 ;
.
––; <
UniqueIdentifier
––< L
,
––L M 
ParameterDirection
––N `
.
––` a
Input
––a f
,
––f g

letterGuid
––h r
)
––r s
;
––s t
sph
—— 
.
——  
DefineSqlParameter
—— "
(
——" #
$str
——# 0
,
——0 1
	SqlDbType
——2 ;
.
——; <
Int
——< ?
,
——? @ 
ParameterDirection
——A S
.
——S T
Input
——T Y
,
——Y Z

pageNumber
——[ e
)
——e f
;
——f g
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# .
,
““. /
	SqlDbType
““0 9
.
““9 :
Int
““: =
,
““= > 
ParameterDirection
““? Q
.
““Q R
Input
““R W
,
““W X
pageSize
““Y a
)
““a b
;
““b c
return
”” 
sph
”” 
.
”” 
ExecuteReader
”” $
(
””$ %
)
””% &
;
””& '
}
’’ 	
}
ŸŸ 
}⁄⁄ ⁄÷
tD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterSubscription.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class  
DBLetterSubscription ,
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
guid%% 
,%% 
Guid&& 
siteGuid&& 
,&& 
Guid'' 
letterInfoGuid'' 
,''  
Guid(( 
userGuid(( 
,(( 
string)) 
email)) 
,)) 
bool** 

isVerified** 
,** 
Guid++ 

verifyGuid++ 
,++ 
DateTime,, 
beginUtc,, 
,,, 
bool-- 
useHtml-- 
,-- 
string.. 
	ipAddress.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i Ñ
,
00Ñ Ö
$num
00Ü à
)
00à â
;
00â ä
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
UniqueIdentifier116 F
,11F G
ParameterDirection11H Z
.11Z [
Input11[ `
,11` a
guid11b f
)11f g
;11g h
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
siteGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 4
,334 5
	SqlDbType336 ?
.33? @
UniqueIdentifier33@ P
,33P Q
ParameterDirection33R d
.33d e
Input33e j
,33j k
letterInfoGuid33l z
)33z {
;33{ |
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
UniqueIdentifier44: J
,44J K
ParameterDirection44L ^
.44^ _
Input44_ d
,44d e
userGuid44f n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# +
,55+ ,
	SqlDbType55- 6
.556 7
NVarChar557 ?
,55? @
$num55A D
,55D E
ParameterDirection55F X
.55X Y
Input55Y ^
,55^ _
email55` e
)55e f
;55f g
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
Bit66< ?
,66? @
ParameterDirection66A S
.66S T
Input66T Y
,66Y Z

isVerified66[ e
)66e f
;66f g
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 0
,770 1
	SqlDbType772 ;
.77; <
UniqueIdentifier77< L
,77L M
ParameterDirection77N `
.77` a
Input77a f
,77f g

verifyGuid77h r
)77r s
;77s t
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# .
,88. /
	SqlDbType880 9
.889 :
DateTime88: B
,88B C
ParameterDirection88D V
.88V W
Input88W \
,88\ ]
beginUtc88^ f
)88f g
;88g h
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# -
,99- .
	SqlDbType99/ 8
.998 9
Bit999 <
,99< =
ParameterDirection99> P
.99P Q
Input99Q V
,99V W
useHtml99X _
)99_ `
;99` a
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# /
,::/ 0
	SqlDbType::1 :
.::: ;
NVarChar::; C
,::C D
$num::E H
,::H I
ParameterDirection::J \
.::\ ]
Input::] b
,::b c
	ipAddress::d m
)::m n
;::n o
int;; 
rowsAffected;; 
=;; 
sph;; "
.;;" #
ExecuteNonQuery;;# 2
(;;2 3
);;3 4
;;;4 5
return<< 
rowsAffected<< 
;<<  
}>> 	
publicFF 
staticFF 
boolFF 
UpdateFF !
(FF! "
GuidGG 
guidGG 
,GG 
GuidHH 
userGuidHH 
,HH 
boolII 
useHtmlII 
)II 
{JJ 	
SqlParameterHelperKK 
sphKK "
=KK# $
newKK% (
SqlParameterHelperKK) ;
(KK; <
ConnectionStringKK< L
.KKL M$
GetWriteConnectionStringKKM e
(KKe f
)KKf g
,KKg h
$str	KKi Ñ
,
KKÑ Ö
$num
KKÜ á
)
KKá à
;
KKà â
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# *
,LL* +
	SqlDbTypeLL, 5
.LL5 6
UniqueIdentifierLL6 F
,LLF G
ParameterDirectionLLH Z
.LLZ [
InputLL[ `
,LL` a
guidLLb f
)LLf g
;LLg h
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
UniqueIdentifierMM: J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
userGuidMMf n
)MMn o
;MMo p
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
BitNN9 <
,NN< =
ParameterDirectionNN> P
.NNP Q
InputNNQ V
,NNV W
useHtmlNNX _
)NN_ `
;NN` a
intOO 
rowsAffectedOO 
=OO 
sphOO "
.OO" #
ExecuteNonQueryOO# 2
(OO2 3
)OO3 4
;OO4 5
returnPP 
(PP 
rowsAffectedPP  
>PP! "
$numPP# $
)PP$ %
;PP% &
}RR 	
publicXX 
staticXX 
boolXX 
ExistsXX !
(XX! "
GuidXX" &
letterInfoGuidXX' 5
,XX5 6
stringXX7 =
emailXX> C
)XXC D
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh É
,
ZZÉ Ñ
$num
ZZÖ Ü
)
ZZÜ á
;
ZZá à
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 4
,[[4 5
	SqlDbType[[6 ?
.[[? @
UniqueIdentifier[[@ P
,[[P Q
ParameterDirection[[R d
.[[d e
Input[[e j
,[[j k
letterInfoGuid[[l z
)[[z {
;[[{ |
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
NVarChar\\7 ?
,\\? @
$num\\A D
,\\D E
ParameterDirection\\F X
.\\X Y
Input\\Y ^
,\\^ _
email\\` e
)\\e f
;\\f g
int]] 
count]] 
=]] 
Convert]]  
.]]  !
ToInt32]]! (
(]]( )
sph]]) ,
.]], -
ExecuteScalar]]- :
(]]: ;
)]]; <
)]]< =
;]]= >
return^^ 
(^^ 
count^^ 
>^^ 
$num^^ 
)^^ 
;^^ 
}`` 	
publicbb 
staticbb 
boolbb 
Verifybb !
(bb! "
Guidcc 
guidcc 
,cc 
booldd 

isVerifieddd 
,dd 
Guidee 

verifyGuidee 
)ee 
{ff 	
SqlParameterHelpergg 
sphgg "
=gg# $
newgg% (
SqlParameterHelpergg) ;
(gg; <
ConnectionStringgg< L
.ggL M$
GetWriteConnectionStringggM e
(gge f
)ggf g
,ggg h
$str	ggi Ñ
,
ggÑ Ö
$num
ggÜ á
)
ggá à
;
ggà â
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# *
,hh* +
	SqlDbTypehh, 5
.hh5 6
UniqueIdentifierhh6 F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
guidhhb f
)hhf g
;hhg h
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 0
,ii0 1
	SqlDbTypeii2 ;
.ii; <
Bitii< ?
,ii? @
ParameterDirectioniiA S
.iiS T
InputiiT Y
,iiY Z

isVerifiedii[ e
)iie f
;iif g
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 0
,jj0 1
	SqlDbTypejj2 ;
.jj; <
UniqueIdentifierjj< L
,jjL M
ParameterDirectionjjN `
.jj` a
Inputjja f
,jjf g

verifyGuidjjh r
)jjr s
;jjs t
intll 
rowsAffectedll 
=ll 
sphll "
.ll" #
ExecuteNonQueryll# 2
(ll2 3
)ll3 4
;ll4 5
returnmm 
(mm 
rowsAffectedmm  
>mm! "
$nummm# $
)mm$ %
;mm% &
}oo 	
publicvv 
staticvv 
boolvv 
Deletevv !
(vv! "
Guidvv" &
guidvv' +
)vv+ ,
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M$
GetWriteConnectionStringxxM e
(xxe f
)xxf g
,xxg h
$str	xxi Ñ
,
xxÑ Ö
$num
xxÜ á
)
xxá à
;
xxà â
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# *
,yy* +
	SqlDbTypeyy, 5
.yy5 6
UniqueIdentifieryy6 F
,yyF G
ParameterDirectionyyH Z
.yyZ [
Inputyy[ `
,yy` a
guidyyb f
)yyf g
;yyg h
intzz 
rowsAffectedzz 
=zz 
sphzz "
.zz" #
ExecuteNonQueryzz# 2
(zz2 3
)zz3 4
;zz4 5
return{{ 
({{ 
rowsAffected{{  
>{{! "
$num{{# $
){{$ %
;{{% &
}}} 	
public
ÑÑ 
static
ÑÑ 
bool
ÑÑ 
DeleteByLetter
ÑÑ )
(
ÑÑ) *
Guid
ÑÑ* .
letterInfoGuid
ÑÑ/ =
)
ÑÑ= >
{
ÖÖ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M&
GetWriteConnectionString
ÜÜM e
(
ÜÜe f
)
ÜÜf g
,
ÜÜg h
$strÜÜi å
,ÜÜå ç
$numÜÜé è
)ÜÜè ê
;ÜÜê ë
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 4
,
áá4 5
	SqlDbType
áá6 ?
.
áá? @
UniqueIdentifier
áá@ P
,
ááP Q 
ParameterDirection
ááR d
.
áád e
Input
ááe j
,
ááj k
letterInfoGuid
áál z
)
ááz {
;
áá{ |
int
àà 
rowsAffected
àà 
=
àà 
sph
àà "
.
àà" #
ExecuteNonQuery
àà# 2
(
àà2 3
)
àà3 4
;
àà4 5
return
ââ 
(
ââ 
rowsAffected
ââ  
>
ââ! "
$num
ââ# $
)
ââ$ %
;
ââ% &
}
ãã 	
public
çç 
static
çç 
bool
çç 
DeleteUnverified
çç +
(
çç+ ,
Guid
çç, 0
letterInfoGuid
çç1 ?
,
çç? @
DateTime
ççA I
olderThanUtc
ççJ V
)
ççV W
{
éé 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M&
GetWriteConnectionString
èèM e
(
èèe f
)
èèf g
,
èèg h
$strèèi é
,èèé è
$numèèê ë
)èèë í
;èèí ì
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 4
,
êê4 5
	SqlDbType
êê6 ?
.
êê? @
UniqueIdentifier
êê@ P
,
êêP Q 
ParameterDirection
êêR d
.
êêd e
Input
êêe j
,
êêj k
letterInfoGuid
êêl z
)
êêz {
;
êê{ |
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 2
,
ëë2 3
	SqlDbType
ëë4 =
.
ëë= >
DateTime
ëë> F
,
ëëF G 
ParameterDirection
ëëH Z
.
ëëZ [
Input
ëë[ `
,
ëë` a
olderThanUtc
ëëb n
)
ëën o
;
ëëo p
int
íí 
rowsAffected
íí 
=
íí 
sph
íí "
.
íí" #
ExecuteNonQuery
íí# 2
(
íí2 3
)
íí3 4
;
íí4 5
return
ìì 
(
ìì 
rowsAffected
ìì  
>
ìì! "
$num
ìì# $
)
ìì$ %
;
ìì% &
}
ïï 	
public
óó 
static
óó 
bool
óó 
DeleteByUser
óó '
(
óó' (
Guid
óó( ,
userGuid
óó- 5
)
óó5 6
{
òò 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M&
GetWriteConnectionString
ôôM e
(
ôôe f
)
ôôf g
,
ôôg h
$strôôi ä
,ôôä ã
$numôôå ç
)ôôç é
;ôôé è
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# .
,
öö. /
	SqlDbType
öö0 9
.
öö9 :
UniqueIdentifier
öö: J
,
ööJ K 
ParameterDirection
ööL ^
.
öö^ _
Input
öö_ d
,
ööd e
userGuid
ööf n
)
öön o
;
ööo p
int
õõ 
rowsAffected
õõ 
=
õõ 
sph
õõ "
.
õõ" #
ExecuteNonQuery
õõ# 2
(
õõ2 3
)
õõ3 4
;
õõ4 5
return
úú 
(
úú 
rowsAffected
úú  
>
úú! "
$num
úú# $
)
úú$ %
;
úú% &
}
ûû 	
public
•• 
static
•• 
bool
•• 
DeleteBySite
•• '
(
••' (
Guid
••( ,
siteGuid
••- 5
)
••5 6
{
¶¶ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M&
GetWriteConnectionString
ßßM e
(
ßße f
)
ßßf g
,
ßßg h
$strßßi ä
,ßßä ã
$numßßå ç
)ßßç é
;ßßé è
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# .
,
®®. /
	SqlDbType
®®0 9
.
®®9 :
UniqueIdentifier
®®: J
,
®®J K 
ParameterDirection
®®L ^
.
®®^ _
Input
®®_ d
,
®®d e
siteGuid
®®f n
)
®®n o
;
®®o p
int
©© 
rowsAffected
©© 
=
©© 
sph
©© "
.
©©" #
ExecuteNonQuery
©©# 2
(
©©2 3
)
©©3 4
;
©©4 5
return
™™ 
(
™™ 
rowsAffected
™™  
>
™™! "
$num
™™# $
)
™™$ %
;
™™% &
}
¨¨ 	
public
≤≤ 
static
≤≤ 
IDataReader
≤≤ !
GetOne
≤≤" (
(
≤≤( )
Guid
≤≤) -
guid
≤≤. 2
)
≤≤2 3
{
≥≥ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M%
GetReadConnectionString
¥¥M d
(
¥¥d e
)
¥¥e f
,
¥¥f g
$str¥¥h Ü
,¥¥Ü á
$num¥¥à â
)¥¥â ä
;¥¥ä ã
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# *
,
µµ* +
	SqlDbType
µµ, 5
.
µµ5 6
UniqueIdentifier
µµ6 F
,
µµF G 
ParameterDirection
µµH Z
.
µµZ [
Input
µµ[ `
,
µµ` a
guid
µµb f
)
µµf g
;
µµg h
return
∂∂ 
sph
∂∂ 
.
∂∂ 
ExecuteReader
∂∂ $
(
∂∂$ %
)
∂∂% &
;
∂∂& '
}
∏∏ 	
public
ææ 
static
ææ 
IDataReader
ææ !
GetByLetter
ææ" -
(
ææ- .
Guid
ææ. 2
letterInfoGuid
ææ3 A
)
ææA B
{
øø 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M%
GetReadConnectionString
¿¿M d
(
¿¿d e
)
¿¿e f
,
¿¿f g
$str¿¿h ã
,¿¿ã å
$num¿¿ç é
)¿¿é è
;¿¿è ê
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 4
,
¡¡4 5
	SqlDbType
¡¡6 ?
.
¡¡? @
UniqueIdentifier
¡¡@ P
,
¡¡P Q 
ParameterDirection
¡¡R d
.
¡¡d e
Input
¡¡e j
,
¡¡j k
letterInfoGuid
¡¡l z
)
¡¡z {
;
¡¡{ |
return
¬¬ 
sph
¬¬ 
.
¬¬ 
ExecuteReader
¬¬ $
(
¬¬$ %
)
¬¬% &
;
¬¬& '
}
ƒƒ 	
public
   
static
   
IDataReader
   !
	GetByUser
  " +
(
  + ,
Guid
  , 0
siteGuid
  1 9
,
  9 :
Guid
  ; ?
userGuid
  @ H
)
  H I
{
ÀÀ 	 
SqlParameterHelper
ÃÃ 
sph
ÃÃ "
=
ÃÃ# $
new
ÃÃ% ( 
SqlParameterHelper
ÃÃ) ;
(
ÃÃ; <
ConnectionString
ÃÃ< L
.
ÃÃL M%
GetReadConnectionString
ÃÃM d
(
ÃÃd e
)
ÃÃe f
,
ÃÃf g
$strÃÃh â
,ÃÃâ ä
$numÃÃã å
)ÃÃå ç
;ÃÃç é
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
UniqueIdentifier
ÕÕ: J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
siteGuid
ÕÕf n
)
ÕÕn o
;
ÕÕo p
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# .
,
ŒŒ. /
	SqlDbType
ŒŒ0 9
.
ŒŒ9 :
UniqueIdentifier
ŒŒ: J
,
ŒŒJ K 
ParameterDirection
ŒŒL ^
.
ŒŒ^ _
Input
ŒŒ_ d
,
ŒŒd e
userGuid
ŒŒf n
)
ŒŒn o
;
ŒŒo p
return
œœ 
sph
œœ 
.
œœ 
ExecuteReader
œœ $
(
œœ$ %
)
œœ% &
;
œœ& '
}
—— 	
public
◊◊ 
static
◊◊ 
IDataReader
◊◊ !

GetByEmail
◊◊" ,
(
◊◊, -
Guid
◊◊- 1
siteGuid
◊◊2 :
,
◊◊: ;
string
◊◊< B
email
◊◊C H
)
◊◊H I
{
ÿÿ 	 
SqlParameterHelper
ŸŸ 
sph
ŸŸ "
=
ŸŸ# $
new
ŸŸ% ( 
SqlParameterHelper
ŸŸ) ;
(
ŸŸ; <
ConnectionString
ŸŸ< L
.
ŸŸL M%
GetReadConnectionString
ŸŸM d
(
ŸŸd e
)
ŸŸe f
,
ŸŸf g
$strŸŸh ä
,ŸŸä ã
$numŸŸå ç
)ŸŸç é
;ŸŸé è
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# .
,
⁄⁄. /
	SqlDbType
⁄⁄0 9
.
⁄⁄9 :
UniqueIdentifier
⁄⁄: J
,
⁄⁄J K 
ParameterDirection
⁄⁄L ^
.
⁄⁄^ _
Input
⁄⁄_ d
,
⁄⁄d e
siteGuid
⁄⁄f n
)
⁄⁄n o
;
⁄⁄o p
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# +
,
€€+ ,
	SqlDbType
€€- 6
.
€€6 7
NVarChar
€€7 ?
,
€€? @
$num
€€A D
,
€€D E 
ParameterDirection
€€F X
.
€€X Y
Input
€€Y ^
,
€€^ _
email
€€` e
)
€€e f
;
€€f g
return
‹‹ 
sph
‹‹ 
.
‹‹ 
ExecuteReader
‹‹ $
(
‹‹$ %
)
‹‹% &
;
‹‹& '
}
ﬁﬁ 	
public
‡‡ 
static
‡‡ 
IDataReader
‡‡ !
Search
‡‡" (
(
‡‡( )
Guid
‡‡) -
letterInfoGuid
‡‡. <
,
‡‡< =
string
‡‡> D
emailOrIpAddress
‡‡E U
)
‡‡U V
{
·· 	 
SqlParameterHelper
‚‚ 
sph
‚‚ "
=
‚‚# $
new
‚‚% ( 
SqlParameterHelper
‚‚) ;
(
‚‚; <
ConnectionString
‚‚< L
.
‚‚L M%
GetReadConnectionString
‚‚M d
(
‚‚d e
)
‚‚e f
,
‚‚f g
$str‚‚h É
,‚‚É Ñ
$num‚‚Ö Ü
)‚‚Ü á
;‚‚á à
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# 4
,
„„4 5
	SqlDbType
„„6 ?
.
„„? @
UniqueIdentifier
„„@ P
,
„„P Q 
ParameterDirection
„„R d
.
„„d e
Input
„„e j
,
„„j k
letterInfoGuid
„„l z
)
„„z {
;
„„{ |
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# 6
,
‰‰6 7
	SqlDbType
‰‰8 A
.
‰‰A B
NVarChar
‰‰B J
,
‰‰J K
$num
‰‰L O
,
‰‰O P 
ParameterDirection
‰‰Q c
.
‰‰c d
Input
‰‰d i
,
‰‰i j
emailOrIpAddress
‰‰k {
)
‰‰{ |
;
‰‰| }
return
ÂÂ 
sph
ÂÂ 
.
ÂÂ 
ExecuteReader
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÁÁ 	
public
ÌÌ 
static
ÌÌ 
IDataReader
ÌÌ !

GetByEmail
ÌÌ" ,
(
ÌÌ, -
Guid
ÌÌ- 1
siteGuid
ÌÌ2 :
,
ÌÌ: ;
Guid
ÌÌ< @
letterInfoGuid
ÌÌA O
,
ÌÌO P
string
ÌÌQ W
email
ÌÌX ]
)
ÌÌ] ^
{
ÓÓ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh ì
,ÔÔì î
$numÔÔï ñ
)ÔÔñ ó
;ÔÔó ò
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 4
,
ÒÒ4 5
	SqlDbType
ÒÒ6 ?
.
ÒÒ? @
UniqueIdentifier
ÒÒ@ P
,
ÒÒP Q 
ParameterDirection
ÒÒR d
.
ÒÒd e
Input
ÒÒe j
,
ÒÒj k
letterInfoGuid
ÒÒl z
)
ÒÒz {
;
ÒÒ{ |
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# +
,
ÚÚ+ ,
	SqlDbType
ÚÚ- 6
.
ÚÚ6 7
NVarChar
ÚÚ7 ?
,
ÚÚ? @
$num
ÚÚA D
,
ÚÚD E 
ParameterDirection
ÚÚF X
.
ÚÚX Y
Input
ÚÚY ^
,
ÚÚ^ _
email
ÚÚ` e
)
ÚÚe f
;
ÚÚf g
return
ÛÛ 
sph
ÛÛ 
.
ÛÛ 
ExecuteReader
ÛÛ $
(
ÛÛ$ %
)
ÛÛ% &
;
ÛÛ& '
}
ıı 	
public
˜˜ 
static
˜˜ 
IDataReader
˜˜ !*
GetTop1000UsersNotSubscribed
˜˜" >
(
˜˜> ?
Guid
˜˜? C
siteGuid
˜˜D L
,
˜˜L M
Guid
˜˜N R
letterInfoGuid
˜˜S a
,
˜˜a b
bool
˜˜c g(
excludeIfAnyUnsubscribeHx˜˜h Å
)˜˜Å Ç
{
¯¯ 	 
SqlParameterHelper
˘˘ 
sph
˘˘ "
=
˘˘# $
new
˘˘% ( 
SqlParameterHelper
˘˘) ;
(
˘˘; <
ConnectionString
˘˘< L
.
˘˘L M%
GetReadConnectionString
˘˘M d
(
˘˘d e
)
˘˘e f
,
˘˘f g
$str˘˘h è
,˘˘è ê
$num˘˘ë í
)˘˘í ì
;˘˘ì î
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# .
,
˙˙. /
	SqlDbType
˙˙0 9
.
˙˙9 :
UniqueIdentifier
˙˙: J
,
˙˙J K 
ParameterDirection
˙˙L ^
.
˙˙^ _
Input
˙˙_ d
,
˙˙d e
siteGuid
˙˙f n
)
˙˙n o
;
˙˙o p
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ "
(
˚˚" #
$str
˚˚# 4
,
˚˚4 5
	SqlDbType
˚˚6 ?
.
˚˚? @
UniqueIdentifier
˚˚@ P
,
˚˚P Q 
ParameterDirection
˚˚R d
.
˚˚d e
Input
˚˚e j
,
˚˚j k
letterInfoGuid
˚˚l z
)
˚˚z {
;
˚˚{ |
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# ?
,
¸¸? @
	SqlDbType
¸¸A J
.
¸¸J K
Bit
¸¸K N
,
¸¸N O 
ParameterDirection
¸¸P b
.
¸¸b c
Input
¸¸c h
,
¸¸h i(
excludeIfAnyUnsubscribeHx¸¸j É
)¸¸É Ñ
;¸¸Ñ Ö
return
˝˝ 
sph
˝˝ 
.
˝˝ 
ExecuteReader
˝˝ $
(
˝˝$ %
)
˝˝% &
;
˝˝& '
}
ˇˇ 	
public
ÅÅ 
static
ÅÅ 
int
ÅÅ -
CountUsersNotSubscribedByLetter
ÅÅ 9
(
ÅÅ9 :
Guid
ÅÅ: >
siteGuid
ÅÅ? G
,
ÅÅG H
Guid
ÅÅI M
letterInfoGuid
ÅÅN \
,
ÅÅ\ ]
bool
ÅÅ^ b'
excludeIfAnyUnsubscribeHx
ÅÅc |
)
ÅÅ| }
{
ÇÇ 	 
SqlParameterHelper
ÉÉ 
sph
ÉÉ "
=
ÉÉ# $
new
ÉÉ% ( 
SqlParameterHelper
ÉÉ) ;
(
ÉÉ; <
ConnectionString
ÉÉ< L
.
ÉÉL M%
GetReadConnectionString
ÉÉM d
(
ÉÉd e
)
ÉÉe f
,
ÉÉf g
$strÉÉh é
,ÉÉé è
$numÉÉê ë
)ÉÉë í
;ÉÉí ì
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# .
,
ÑÑ. /
	SqlDbType
ÑÑ0 9
.
ÑÑ9 :
UniqueIdentifier
ÑÑ: J
,
ÑÑJ K 
ParameterDirection
ÑÑL ^
.
ÑÑ^ _
Input
ÑÑ_ d
,
ÑÑd e
siteGuid
ÑÑf n
)
ÑÑn o
;
ÑÑo p
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 4
,
ÖÖ4 5
	SqlDbType
ÖÖ6 ?
.
ÖÖ? @
UniqueIdentifier
ÖÖ@ P
,
ÖÖP Q 
ParameterDirection
ÖÖR d
.
ÖÖd e
Input
ÖÖe j
,
ÖÖj k
letterInfoGuid
ÖÖl z
)
ÖÖz {
;
ÖÖ{ |
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# ?
,
ÜÜ? @
	SqlDbType
ÜÜA J
.
ÜÜJ K
Bit
ÜÜK N
,
ÜÜN O 
ParameterDirection
ÜÜP b
.
ÜÜb c
Input
ÜÜc h
,
ÜÜh i(
excludeIfAnyUnsubscribeHxÜÜj É
)ÜÜÉ Ñ
;ÜÜÑ Ö
return
àà 
Convert
àà 
.
àà 
ToInt32
àà "
(
àà" #
sph
àà# &
.
àà& '
ExecuteScalar
àà' 4
(
àà4 5
)
àà5 6
)
àà6 7
;
àà7 8
}
ää 	
public
êê 
static
êê 
IDataReader
êê !&
GetSubscribersNotSentYet
êê" :
(
êê: ;
Guid
ëë 

letterGuid
ëë 
,
ëë 
Guid
íí 
letterInfoGuid
íí 
)
íí  
{
ìì 	 
SqlParameterHelper
îî 
sph
îî "
=
îî# $
new
îî% ( 
SqlParameterHelper
îî) ;
(
îî; <
ConnectionString
îî< L
.
îîL M%
GetReadConnectionString
îîM d
(
îîd e
)
îîe f
,
îîf g
$strîîh ë
,îîë í
$numîîì î
)îîî ï
;îîï ñ
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 0
,
ïï0 1
	SqlDbType
ïï2 ;
.
ïï; <
UniqueIdentifier
ïï< L
,
ïïL M 
ParameterDirection
ïïN `
.
ïï` a
Input
ïïa f
,
ïïf g

letterGuid
ïïh r
)
ïïr s
;
ïïs t
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 4
,
ññ4 5
	SqlDbType
ññ6 ?
.
ññ? @
UniqueIdentifier
ññ@ P
,
ññP Q 
ParameterDirection
ññR d
.
ññd e
Input
ññe j
,
ññj k
letterInfoGuid
ññl z
)
ññz {
;
ññ{ |
return
òò 
sph
òò 
.
òò 
ExecuteReader
òò $
(
òò$ %
)
òò% &
;
òò& '
}
ôô 	
public
üü 
static
üü 
int
üü 
GetCountByLetter
üü *
(
üü* +
Guid
üü+ /
letterInfoGuid
üü0 >
)
üü> ?
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h ä
,°°ä ã
$num°°å ç
)°°ç é
;°°é è
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 4
,
¢¢4 5
	SqlDbType
¢¢6 ?
.
¢¢? @
UniqueIdentifier
¢¢@ P
,
¢¢P Q 
ParameterDirection
¢¢R d
.
¢¢d e
Input
¢¢e j
,
¢¢j k
letterInfoGuid
¢¢l z
)
¢¢z {
;
¢¢{ |
return
§§ 
Convert
§§ 
.
§§ 
ToInt32
§§ "
(
§§" #
sph
§§# &
.
§§& '
ExecuteScalar
§§' 4
(
§§4 5
)
§§5 6
)
§§6 7
;
§§7 8
}
¶¶ 	
public
ØØ 
static
ØØ 
IDataReader
ØØ !
GetPage
ØØ" )
(
ØØ) *
Guid
∞∞ 
letterInfoGuid
∞∞ 
,
∞∞  
int
±± 

pageNumber
±± 
,
±± 
int
≤≤ 
pageSize
≤≤ 
,
≤≤ 
out
≥≥ 
int
≥≥ 

totalPages
≥≥ 
)
≥≥ 
{
¥¥ 	

totalPages
µµ 
=
µµ 
$num
µµ 
;
µµ 
int
∂∂ 
	totalRows
∂∂ 
=
∑∑ 
GetCountByLetter
∑∑ "
(
∑∑" #
letterInfoGuid
∑∑# 1
)
∑∑1 2
;
∑∑2 3
if
ππ 
(
ππ 
pageSize
ππ 
>
ππ 
$num
ππ 
)
ππ 

totalPages
ππ (
=
ππ) *
	totalRows
ππ+ 4
/
ππ5 6
pageSize
ππ7 ?
;
ππ? @
if
ªª 
(
ªª 
	totalRows
ªª 
<=
ªª 
pageSize
ªª %
)
ªª% &
{
ºº 

totalPages
ΩΩ 
=
ΩΩ 
$num
ΩΩ 
;
ΩΩ 
}
ææ 
else
øø 
{
¿¿ 
int
¡¡ 
	remainder
¡¡ 
;
¡¡ 
Math
¬¬ 
.
¬¬ 
DivRem
¬¬ 
(
¬¬ 
	totalRows
¬¬ %
,
¬¬% &
pageSize
¬¬' /
,
¬¬/ 0
out
¬¬1 4
	remainder
¬¬5 >
)
¬¬> ?
;
¬¬? @
if
√√ 
(
√√ 
	remainder
√√ 
>
√√ 
$num
√√  !
)
√√! "
{
ƒƒ 

totalPages
≈≈ 
+=
≈≈ !
$num
≈≈" #
;
≈≈# $
}
∆∆ 
}
««  
SqlParameterHelper
…… 
sph
…… "
=
……# $
new
……% ( 
SqlParameterHelper
……) ;
(
……; <
ConnectionString
……< L
.
……L M%
GetReadConnectionString
……M d
(
……d e
)
……e f
,
……f g
$str……h á
,……á à
$num……â ä
)……ä ã
;……ã å
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 4
,
  4 5
	SqlDbType
  6 ?
.
  ? @
UniqueIdentifier
  @ P
,
  P Q 
ParameterDirection
  R d
.
  d e
Input
  e j
,
  j k
letterInfoGuid
  l z
)
  z {
;
  { |
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 0
,
ÀÀ0 1
	SqlDbType
ÀÀ2 ;
.
ÀÀ; <
Int
ÀÀ< ?
,
ÀÀ? @ 
ParameterDirection
ÀÀA S
.
ÀÀS T
Input
ÀÀT Y
,
ÀÀY Z

pageNumber
ÀÀ[ e
)
ÀÀe f
;
ÀÀf g
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# .
,
ÃÃ. /
	SqlDbType
ÃÃ0 9
.
ÃÃ9 :
Int
ÃÃ: =
,
ÃÃ= > 
ParameterDirection
ÃÃ? Q
.
ÃÃQ R
Input
ÃÃR W
,
ÃÃW X
pageSize
ÃÃY a
)
ÃÃa b
;
ÃÃb c
return
ÕÕ 
sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ $
(
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
œœ 	
public
‡‡ 
static
‡‡ 
int
‡‡ 
CreateHistory
‡‡ '
(
‡‡' (
Guid
·· 
rowGuid
·· 
,
·· 
Guid
‚‚ 
siteGuid
‚‚ 
,
‚‚ 
Guid
„„ 
subscribeGuid
„„ 
,
„„ 
Guid
‰‰ 
letterInfoGuid
‰‰ 
,
‰‰  
Guid
ÂÂ 
userGuid
ÂÂ 
,
ÂÂ 
string
ÊÊ 
email
ÊÊ 
,
ÊÊ 
bool
ÁÁ 

isVerified
ÁÁ 
,
ÁÁ 
bool
ËË 
useHtml
ËË 
,
ËË 
DateTime
ÈÈ 
beginUtc
ÈÈ 
,
ÈÈ 
DateTime
ÍÍ 
endUtc
ÍÍ 
,
ÍÍ 
string
ÎÎ 
	ipAddress
ÎÎ 
)
ÎÎ 
{
ÏÏ 	 
SqlParameterHelper
ÌÌ 
sph
ÌÌ "
=
ÌÌ# $
new
ÌÌ% ( 
SqlParameterHelper
ÌÌ) ;
(
ÌÌ; <
ConnectionString
ÌÌ< L
.
ÌÌL M&
GetWriteConnectionString
ÌÌM e
(
ÌÌe f
)
ÌÌf g
,
ÌÌg h
$strÌÌi Ü
,ÌÌÜ á
$numÌÌà ä
)ÌÌä ã
;ÌÌã å
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# -
,
ÓÓ- .
	SqlDbType
ÓÓ/ 8
.
ÓÓ8 9
UniqueIdentifier
ÓÓ9 I
,
ÓÓI J 
ParameterDirection
ÓÓK ]
.
ÓÓ] ^
Input
ÓÓ^ c
,
ÓÓc d
rowGuid
ÓÓe l
)
ÓÓl m
;
ÓÓm n
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# .
,
ÔÔ. /
	SqlDbType
ÔÔ0 9
.
ÔÔ9 :
UniqueIdentifier
ÔÔ: J
,
ÔÔJ K 
ParameterDirection
ÔÔL ^
.
ÔÔ^ _
Input
ÔÔ_ d
,
ÔÔd e
siteGuid
ÔÔf n
)
ÔÔn o
;
ÔÔo p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
UniqueIdentifier
? O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
subscribeGuid
k x
)
x y
;
y z
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 4
,
ÒÒ4 5
	SqlDbType
ÒÒ6 ?
.
ÒÒ? @
UniqueIdentifier
ÒÒ@ P
,
ÒÒP Q 
ParameterDirection
ÒÒR d
.
ÒÒd e
Input
ÒÒe j
,
ÒÒj k
letterInfoGuid
ÒÒl z
)
ÒÒz {
;
ÒÒ{ |
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# .
,
ÚÚ. /
	SqlDbType
ÚÚ0 9
.
ÚÚ9 :
UniqueIdentifier
ÚÚ: J
,
ÚÚJ K 
ParameterDirection
ÚÚL ^
.
ÚÚ^ _
Input
ÚÚ_ d
,
ÚÚd e
userGuid
ÚÚf n
)
ÚÚn o
;
ÚÚo p
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# +
,
ÛÛ+ ,
	SqlDbType
ÛÛ- 6
.
ÛÛ6 7
NVarChar
ÛÛ7 ?
,
ÛÛ? @
$num
ÛÛA D
,
ÛÛD E 
ParameterDirection
ÛÛF X
.
ÛÛX Y
Input
ÛÛY ^
,
ÛÛ^ _
email
ÛÛ` e
)
ÛÛe f
;
ÛÛf g
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# 0
,
ÙÙ0 1
	SqlDbType
ÙÙ2 ;
.
ÙÙ; <
Bit
ÙÙ< ?
,
ÙÙ? @ 
ParameterDirection
ÙÙA S
.
ÙÙS T
Input
ÙÙT Y
,
ÙÙY Z

isVerified
ÙÙ[ e
)
ÙÙe f
;
ÙÙf g
sph
ıı 
.
ıı  
DefineSqlParameter
ıı "
(
ıı" #
$str
ıı# -
,
ıı- .
	SqlDbType
ıı/ 8
.
ıı8 9
Bit
ıı9 <
,
ıı< = 
ParameterDirection
ıı> P
.
ııP Q
Input
ııQ V
,
ııV W
useHtml
ııX _
)
ıı_ `
;
ıı` a
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# .
,
ˆˆ. /
	SqlDbType
ˆˆ0 9
.
ˆˆ9 :
DateTime
ˆˆ: B
,
ˆˆB C 
ParameterDirection
ˆˆD V
.
ˆˆV W
Input
ˆˆW \
,
ˆˆ\ ]
beginUtc
ˆˆ^ f
)
ˆˆf g
;
ˆˆg h
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# ,
,
˜˜, -
	SqlDbType
˜˜. 7
.
˜˜7 8
DateTime
˜˜8 @
,
˜˜@ A 
ParameterDirection
˜˜B T
.
˜˜T U
Input
˜˜U Z
,
˜˜Z [
endUtc
˜˜\ b
)
˜˜b c
;
˜˜c d
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# /
,
¯¯/ 0
	SqlDbType
¯¯1 :
.
¯¯: ;
NVarChar
¯¯; C
,
¯¯C D
$num
¯¯E H
,
¯¯H I 
ParameterDirection
¯¯J \
.
¯¯\ ]
Input
¯¯] b
,
¯¯b c
	ipAddress
¯¯d m
)
¯¯m n
;
¯¯n o
int
˘˘ 
rowsAffected
˘˘ 
=
˘˘ 
sph
˘˘ "
.
˘˘" #
ExecuteNonQuery
˘˘# 2
(
˘˘2 3
)
˘˘3 4
;
˘˘4 5
return
˙˙ 
rowsAffected
˙˙ 
;
˙˙  
}
¸¸ 	
public
ˇˇ 
static
ˇˇ 
bool
ˇˇ !
DeleteHistoryBySite
ˇˇ .
(
ˇˇ. /
Guid
ˇˇ/ 3
siteGuid
ˇˇ4 <
)
ˇˇ< =
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M&
GetWriteConnectionString
ÅÅM e
(
ÅÅe f
)
ÅÅf g
,
ÅÅg h
$strÅÅi å
,ÅÅå ç
$numÅÅé è
)ÅÅè ê
;ÅÅê ë
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
UniqueIdentifier
ÇÇ: J
,
ÇÇJ K 
ParameterDirection
ÇÇL ^
.
ÇÇ^ _
Input
ÇÇ_ d
,
ÇÇd e
siteGuid
ÇÇf n
)
ÇÇn o
;
ÇÇo p
int
ÉÉ 
rowsAffected
ÉÉ 
=
ÉÉ 
sph
ÉÉ "
.
ÉÉ" #
ExecuteNonQuery
ÉÉ# 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
$num
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
}
ÜÜ 	
public
àà 
static
àà 
bool
àà '
DeleteHistoryByLetterInfo
àà 4
(
àà4 5
Guid
àà5 9
letterInfoGuid
àà: H
)
ààH I
{
ââ 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M&
GetWriteConnectionString
ääM e
(
ääe f
)
ääf g
,
ääg h
$strääi í
,ääí ì
$numääî ï
)ääï ñ
;ääñ ó
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 4
,
ãã4 5
	SqlDbType
ãã6 ?
.
ãã? @
UniqueIdentifier
ãã@ P
,
ããP Q 
ParameterDirection
ããR d
.
ããd e
Input
ããe j
,
ããj k
letterInfoGuid
ããl z
)
ããz {
;
ãã{ |
int
åå 
rowsAffected
åå 
=
åå 
sph
åå "
.
åå" #
ExecuteNonQuery
åå# 2
(
åå2 3
)
åå3 4
;
åå4 5
return
çç 
(
çç 
rowsAffected
çç  
>
çç! "
$num
çç# $
)
çç$ %
;
çç% &
}
èè 	
}
ëë 
}íí ˇÛ
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModule.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModule  
{ 
public   
static   
int   
	AddModule   #
(  # $
int!! 
pageId!! 
,!! 
int"" 
siteId"" 
,"" 
Guid## 
siteGuid## 
,## 
int$$ 
moduleDefId$$ 
,$$ 
int%% 
moduleOrder%% 
,%% 
string&& 
paneName&& 
,&& 
string'' 
moduleTitle'' 
,'' 
string(( 
	viewRoles(( 
,(( 
string)) 
authorizedEditRoles)) &
,))& '
string** 
draftEditRoles** !
,**! "
string++ 
draftApprovalRoles++ %
,++% &
int,, 
	cacheTime,, 
,,, 
bool-- 
	showTitle-- 
,-- 
bool.. 
availableForMyPage.. #
,..# $
bool// *
allowMultipleInstancesOnMyPage// /
,/// 0
String00 
icon00 
,00 
int11 
createdByUserId11 
,11  
DateTime22 
createdDate22  
,22  !
Guid33 
guid33 
,33 
Guid44 
featureGuid44 
,44 
bool55 !
hideFromAuthenticated55 &
,55& '
bool66 #
hideFromUnauthenticated66 (
,66( )
string77 
headElement77 
,77 
int88 
publishMode88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str::i |
,::| }
$num	::~ Ä
)
::Ä Å
;
::Å Ç
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# ,
,;;, -
	SqlDbType;;. 7
.;;7 8
Int;;8 ;
,;;; <
ParameterDirection;;= O
.;;O P
Input;;P U
,;;U V
pageId;;W ]
);;] ^
;;;^ _
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# ,
,<<, -
	SqlDbType<<. 7
.<<7 8
Int<<8 ;
,<<; <
ParameterDirection<<= O
.<<O P
Input<<P U
,<<U V
siteId<<W ]
)<<] ^
;<<^ _
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 1
,==1 2
	SqlDbType==3 <
.==< =
Int=== @
,==@ A
ParameterDirection==B T
.==T U
Input==U Z
,==Z [
moduleDefId==\ g
)==g h
;==h i
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
Int>>= @
,>>@ A
ParameterDirection>>B T
.>>T U
Input>>U Z
,>>Z [
moduleOrder>>\ g
)>>g h
;>>h i
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# .
,??. /
	SqlDbType??0 9
.??9 :
NVarChar??: B
,??B C
$num??D F
,??F G
ParameterDirection??H Z
.??Z [
Input??[ `
,??` a
paneName??b j
)??j k
;??k l
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 1
,@@1 2
	SqlDbType@@3 <
.@@< =
NVarChar@@= E
,@@E F
$num@@G J
,@@J K
ParameterDirection@@L ^
.@@^ _
Input@@_ d
,@@d e
moduleTitle@@f q
)@@q r
;@@r s
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 9
,AA9 :
	SqlDbTypeAA; D
.AAD E
NVarCharAAE M
,AAM N
-AAO P
$numAAP Q
,AAQ R
ParameterDirectionAAS e
.AAe f
InputAAf k
,AAk l 
authorizedEditRoles	AAm Ä
)
AAÄ Å
;
AAÅ Ç
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 4
,BB4 5
	SqlDbTypeBB6 ?
.BB? @
NVarCharBB@ H
,BBH I
-BBJ K
$numBBK L
,BBL M
ParameterDirectionBBN `
.BB` a
InputBBa f
,BBf g
draftEditRolesBBh v
)BBv w
;BBw x
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 8
,CC8 9
	SqlDbTypeCC: C
.CCC D
NVarCharCCD L
,CCL M
-CCN O
$numCCO P
,CCP Q
ParameterDirectionCCR d
.CCd e
InputCCe j
,CCj k
draftApprovalRolesCCl ~
)CC~ 
;	CC Ä
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# /
,DD/ 0
	SqlDbTypeDD1 :
.DD: ;
IntDD; >
,DD> ?
ParameterDirectionDD@ R
.DDR S
InputDDS X
,DDX Y
	cacheTimeDDZ c
)DDc d
;DDd e
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# /
,EE/ 0
	SqlDbTypeEE1 :
.EE: ;
BitEE; >
,EE> ?
ParameterDirectionEE@ R
.EER S
InputEES X
,EEX Y
	showTitleEEZ c
)EEc d
;EEd e
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 8
,FF8 9
	SqlDbTypeFF: C
.FFC D
BitFFD G
,FFG H
ParameterDirectionFFI [
.FF[ \
InputFF\ a
,FFa b
availableForMyPageFFc u
)FFu v
;FFv w
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 5
,GG5 6
	SqlDbTypeGG7 @
.GG@ A
IntGGA D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _
createdByUserIdGG` o
)GGo p
;GGp q
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 1
,HH1 2
	SqlDbTypeHH3 <
.HH< =
DateTimeHH= E
,HHE F
ParameterDirectionHHG Y
.HHY Z
InputHHZ _
,HH_ `
createdDateHHa l
)HHl m
;HHm n
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# D
,IID E
	SqlDbTypeIIF O
.IIO P
BitIIP S
,IIS T
ParameterDirectionIIU g
.IIg h
InputIIh m
,IIm n+
allowMultipleInstancesOnMyPage	IIo ç
)
IIç é
;
IIé è
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
NVarCharJJ6 >
,JJ> ?
$numJJ@ C
,JJC D
ParameterDirectionJJE W
.JJW X
InputJJX ]
,JJ] ^
iconJJ_ c
)JJc d
;JJd e
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# *
,KK* +
	SqlDbTypeKK, 5
.KK5 6
UniqueIdentifierKK6 F
,KKF G
ParameterDirectionKKH Z
.KKZ [
InputKK[ `
,KK` a
guidKKb f
)KKf g
;KKg h
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
UniqueIdentifierLL= M
,LLM N
ParameterDirectionLLO a
.LLa b
InputLLb g
,LLg h
featureGuidLLi t
)LLt u
;LLu v
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
UniqueIdentifierMM: J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
siteGuidMMf n
)MMn o
;MMo p
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 2
,NN2 3
	SqlDbTypeNN4 =
.NN= >
BitNN> A
,NNA B
ParameterDirectionNNC U
.NNU V
InputNNV [
,NN[ \!
hideFromAuthenticatedNN] r
)NNr s
;NNs t
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 4
,OO4 5
	SqlDbTypeOO6 ?
.OO? @
BitOO@ C
,OOC D
ParameterDirectionOOE W
.OOW X
InputOOX ]
,OO] ^#
hideFromUnauthenticatedOO_ v
)OOv w
;OOw x
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
NVarCharPP; C
,PPC D
-PPE F
$numPPF G
,PPG H
ParameterDirectionPPI [
.PP[ \
InputPP\ a
,PPa b
	viewRolesPPc l
)PPl m
;PPm n
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
headElementQQe p
)QQp q
;QQq r
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 1
,RR1 2
	SqlDbTypeRR3 <
.RR< =
IntRR= @
,RR@ A
ParameterDirectionRRB T
.RRT U
InputRRU Z
,RRZ [
publishModeRR\ g
)RRg h
;RRh i
intTT 
newIDTT 
=TT 
ConvertTT 
.TT  
ToInt32TT  '
(TT' (
sphTT( +
.TT+ ,
ExecuteScalarTT, 9
(TT9 :
)TT: ;
)TT; <
;TT< =
returnVV 
newIDVV 
;VV 
}WW 	
publicYY 
staticYY 
boolYY 
UpdateModuleYY '
(YY' (
intZZ 
moduleIdZZ 
,ZZ 
int[[ 
moduleDefId[[ 
,[[ 
string\\ 
moduleTitle\\ 
,\\ 
string]] 
	viewRoles]] 
,]] 
string^^ 
authorizedEditRoles^^ &
,^^& '
string__ 
draftEditRoles__ !
,__! "
string`` 
draftApprovalRoles`` %
,``% &
intaa 
	cacheTimeaa 
,aa 
boolbb 
	showTitlebb 
,bb 
intcc 

editUserIdcc 
,cc 
booldd 
availableForMyPagedd #
,dd# $
boolee *
allowMultipleInstancesOnMyPageee /
,ee/ 0
Stringff 
iconff 
,ff 
boolgg !
hideFromAuthenticatedgg &
,gg& '
boolhh #
hideFromUnauthenticatedhh (
,hh( )
boolii 
includeInSearchii  
,ii  !
booljj 
isGlobaljj 
,jj 
stringkk 
headElementkk 
,kk 
intll 
publishModell 
)ll 
{mm 	
SqlParameterHelpernn 
sphnn "
=nn# $
newnn% (
SqlParameterHelpernn) ;
(nn; <
ConnectionStringnn< L
.nnL M$
GetWriteConnectionStringnnM e
(nne f
)nnf g
,nng h
$strnni |
,nn| }
$num	nn~ Ä
)
nnÄ Å
;
nnÅ Ç
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# .
,oo. /
	SqlDbTypeoo0 9
.oo9 :
Intoo: =
,oo= >
ParameterDirectionoo? Q
.ooQ R
InputooR W
,ooW X
moduleIdooY a
)ooa b
;oob c
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 1
,pp1 2
	SqlDbTypepp3 <
.pp< =
Intpp= @
,pp@ A
ParameterDirectionppB T
.ppT U
InputppU Z
,ppZ [
moduleDefIdpp\ g
)ppg h
;pph i
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 1
,qq1 2
	SqlDbTypeqq3 <
.qq< =
NVarCharqq= E
,qqE F
ParameterDirectionqqG Y
.qqY Z
InputqqZ _
,qq_ `
moduleTitleqqa l
)qql m
;qqm n
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 9
,rr9 :
	SqlDbTyperr; D
.rrD E
NVarCharrrE M
,rrM N
-rrO P
$numrrP Q
,rrQ R
ParameterDirectionrrS e
.rre f
Inputrrf k
,rrk l 
authorizedEditRoles	rrm Ä
)
rrÄ Å
;
rrÅ Ç
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 4
,ss4 5
	SqlDbTypess6 ?
.ss? @
NVarCharss@ H
,ssH I
-ssJ K
$numssK L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g
draftEditRolesssh v
)ssv w
;ssw x
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 8
,tt8 9
	SqlDbTypett: C
.ttC D
NVarCharttD L
,ttL M
-ttN O
$numttO P
,ttP Q
ParameterDirectionttR d
.ttd e
Inputtte j
,ttj k
draftApprovalRolesttl ~
)tt~ 
;	tt Ä
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# /
,uu/ 0
	SqlDbTypeuu1 :
.uu: ;
Intuu; >
,uu> ?
ParameterDirectionuu@ R
.uuR S
InputuuS X
,uuX Y
	cacheTimeuuZ c
)uuc d
;uud e
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# /
,vv/ 0
	SqlDbTypevv1 :
.vv: ;
Bitvv; >
,vv> ?
ParameterDirectionvv@ R
.vvR S
InputvvS X
,vvX Y
	showTitlevvZ c
)vvc d
;vvd e
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
Intww< ?
,ww? @
ParameterDirectionwwA S
.wwS T
InputwwT Y
,wwY Z

editUserIdww[ e
)wwe f
;wwf g
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 8
,xx8 9
	SqlDbTypexx: C
.xxC D
BitxxD G
,xxG H
ParameterDirectionxxI [
.xx[ \
Inputxx\ a
,xxa b
availableForMyPagexxc u
)xxu v
;xxv w
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# D
,yyD E
	SqlDbTypeyyF O
.yyO P
BityyP S
,yyS T
ParameterDirectionyyU g
.yyg h
Inputyyh m
,yym n+
allowMultipleInstancesOnMyPage	yyo ç
)
yyç é
;
yyé è
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
NVarCharzz6 >
,zz> ?
$numzz@ C
,zzC D
ParameterDirectionzzE W
.zzW X
InputzzX ]
,zz] ^
iconzz_ c
)zzc d
;zzd e
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 2
,{{2 3
	SqlDbType{{4 =
.{{= >
Bit{{> A
,{{A B
ParameterDirection{{C U
.{{U V
Input{{V [
,{{[ \!
hideFromAuthenticated{{] r
){{r s
;{{s t
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 4
,||4 5
	SqlDbType||6 ?
.||? @
Bit||@ C
,||C D
ParameterDirection||E W
.||W X
Input||X ]
,||] ^#
hideFromUnauthenticated||_ v
)||v w
;||w x
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# /
,}}/ 0
	SqlDbType}}1 :
.}}: ;
NVarChar}}; C
,}}C D
-}}E F
$num}}F G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
	viewRoles}}c l
)}}l m
;}}m n
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 5
,~~5 6
	SqlDbType~~7 @
.~~@ A
Bit~~A D
,~~D E
ParameterDirection~~F X
.~~X Y
Input~~Y ^
,~~^ _
includeInSearch~~` o
)~~o p
;~~p q
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
Bit: =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
isGlobalY a
)a b
;b c
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# 1
,
ÄÄ1 2
	SqlDbType
ÄÄ3 <
.
ÄÄ< =
NVarChar
ÄÄ= E
,
ÄÄE F
$num
ÄÄG I
,
ÄÄI J 
ParameterDirection
ÄÄK ]
.
ÄÄ] ^
Input
ÄÄ^ c
,
ÄÄc d
headElement
ÄÄe p
)
ÄÄp q
;
ÄÄq r
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 1
,
ÅÅ1 2
	SqlDbType
ÅÅ3 <
.
ÅÅ< =
Int
ÅÅ= @
,
ÅÅ@ A 
ParameterDirection
ÅÅB T
.
ÅÅT U
Input
ÅÅU Z
,
ÅÅZ [
publishMode
ÅÅ\ g
)
ÅÅg h
;
ÅÅh i
int
ÇÇ 
rowsAffected
ÇÇ 
=
ÇÇ 
sph
ÇÇ "
.
ÇÇ" #
ExecuteNonQuery
ÇÇ# 2
(
ÇÇ2 3
)
ÇÇ3 4
;
ÇÇ4 5
return
ÉÉ 
(
ÉÉ 
rowsAffected
ÉÉ  
>
ÉÉ! "
-
ÉÉ# $
$num
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ 
UpdateModuleOrder
ÜÜ ,
(
ÜÜ, -
int
ÜÜ- 0
pageId
ÜÜ1 7
,
ÜÜ7 8
int
ÜÜ9 <
moduleId
ÜÜ= E
,
ÜÜE F
int
ÜÜG J
moduleOrder
ÜÜK V
,
ÜÜV W
string
ÜÜX ^
paneName
ÜÜ_ g
)
ÜÜg h
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M&
GetWriteConnectionString
ààM e
(
ààe f
)
ààf g
,
ààg h
$stràài á
,ààá à
$numààâ ä
)ààä ã
;ààã å
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# ,
,
ââ, -
	SqlDbType
ââ. 7
.
ââ7 8
Int
ââ8 ;
,
ââ; < 
ParameterDirection
ââ= O
.
ââO P
Input
ââP U
,
ââU V
pageId
ââW ]
)
ââ] ^
;
ââ^ _
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
Int
ää: =
,
ää= > 
ParameterDirection
ää? Q
.
ääQ R
Input
ääR W
,
ääW X
moduleId
ääY a
)
ääa b
;
ääb c
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 1
,
ãã1 2
	SqlDbType
ãã3 <
.
ãã< =
Int
ãã= @
,
ãã@ A 
ParameterDirection
ããB T
.
ããT U
Input
ããU Z
,
ããZ [
moduleOrder
ãã\ g
)
ããg h
;
ããh i
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# .
,
åå. /
	SqlDbType
åå0 9
.
åå9 :
NVarChar
åå: B
,
ååB C
$num
ååD F
,
ååF G 
ParameterDirection
ååH Z
.
ååZ [
Input
åå[ `
,
åå` a
paneName
ååb j
)
ååj k
;
ååk l
int
çç 
rowsAffected
çç 
=
çç 
sph
çç "
.
çç" #
ExecuteNonQuery
çç# 2
(
çç2 3
)
çç3 4
;
çç4 5
return
éé 
(
éé 
rowsAffected
éé  
>
éé! "
-
éé# $
$num
éé$ %
)
éé% &
;
éé& '
}
èè 	
public
ëë 
static
ëë 
bool
ëë 

UpdatePage
ëë %
(
ëë% &
int
ëë& )
	oldPageId
ëë* 3
,
ëë3 4
int
ëë5 8
	newPageId
ëë9 B
,
ëëB C
int
ëëD G
moduleId
ëëH P
)
ëëP Q
{
íí 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M&
GetWriteConnectionString
ììM e
(
ììe f
)
ììf g
,
ììg h
$strììi Ä
,ììÄ Å
$numììÇ É
)ììÉ Ñ
;ììÑ Ö
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# /
,
îî/ 0
	SqlDbType
îî1 :
.
îî: ;
Int
îî; >
,
îî> ? 
ParameterDirection
îî@ R
.
îîR S
Input
îîS X
,
îîX Y
	oldPageId
îîZ c
)
îîc d
;
îîd e
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# /
,
ïï/ 0
	SqlDbType
ïï1 :
.
ïï: ;
Int
ïï; >
,
ïï> ? 
ParameterDirection
ïï@ R
.
ïïR S
Input
ïïS X
,
ïïX Y
	newPageId
ïïZ c
)
ïïc d
;
ïïd e
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
Int
ññ: =
,
ññ= > 
ParameterDirection
ññ? Q
.
ññQ R
Input
ññR W
,
ññW X
moduleId
ññY a
)
ñña b
;
ññb c
int
óó 
rowsAffected
óó 
=
óó 
sph
óó "
.
óó" #
ExecuteNonQuery
óó# 2
(
óó2 3
)
óó3 4
;
óó4 5
return
òò 
(
òò 
rowsAffected
òò  
>
òò! "
-
òò# $
$num
òò$ %
)
òò% &
;
òò& '
}
ôô 	
public
õõ 
static
õõ 
bool
õõ 
Publish
õõ "
(
õõ" #
Guid
úú 
pageGuid
úú 
,
úú 
Guid
ùù 

moduleGuid
ùù 
,
ùù 
int
ûû 
moduleId
ûû 
,
ûû 
int
üü 
pageId
üü 
,
üü 
String
†† 
paneName
†† 
,
†† 
int
°° 
moduleOrder
°° 
,
°° 
DateTime
¢¢ 
publishBeginDate
¢¢ %
,
¢¢% &
DateTime
££ 
publishEndDate
££ #
)
££# $
{
§§ 	
if
•• 
(
•• 
PageModuleExists
••  
(
••  !
moduleId
••! )
,
••) *
pageId
••+ 1
)
••1 2
)
••2 3
{
¶¶ 
return
ßß 
PageModuleUpdate
ßß '
(
ßß' (
moduleId
®® 
,
®® 
pageId
©© 
,
©© 
paneName
™™ 
,
™™ 
moduleOrder
´´ 
,
´´  
publishBeginDate
¨¨ $
,
¨¨$ %
publishEndDate
≠≠ "
)
≠≠" #
;
≠≠# $
}
ÆÆ 
else
ØØ 
{
∞∞ 
return
±± 
PageModuleInsert
±± '
(
±±' (
pageGuid
≤≤ 
,
≤≤ 

moduleGuid
≥≥ 
,
≥≥ 
moduleId
¥¥ 
,
¥¥ 
pageId
µµ 
,
µµ 
paneName
∂∂ 
,
∂∂ 
moduleOrder
∑∑ 
,
∑∑  
publishBeginDate
∏∏ $
,
∏∏$ %
publishEndDate
ππ "
)
ππ" #
;
ππ# $
}
ªª 
}
ΩΩ 	
public
øø 
static
øø 
bool
øø 
PageModuleExists
øø +
(
øø+ ,
int
øø, /
moduleId
øø0 8
,
øø8 9
int
øø: =
pageId
øø> D
)
øøD E
{
¿¿ 	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str
¡¡h ~
,
¡¡~ 
$num¡¡Ä Å
)¡¡Å Ç
;¡¡Ç É
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# .
,
¬¬. /
	SqlDbType
¬¬0 9
.
¬¬9 :
Int
¬¬: =
,
¬¬= > 
ParameterDirection
¬¬? Q
.
¬¬Q R
Input
¬¬R W
,
¬¬W X
moduleId
¬¬Y a
)
¬¬a b
;
¬¬b c
sph
√√ 
.
√√  
DefineSqlParameter
√√ "
(
√√" #
$str
√√# ,
,
√√, -
	SqlDbType
√√. 7
.
√√7 8
Int
√√8 ;
,
√√; < 
ParameterDirection
√√= O
.
√√O P
Input
√√P U
,
√√U V
pageId
√√W ]
)
√√] ^
;
√√^ _
int
ƒƒ 
count
ƒƒ 
=
ƒƒ 
Convert
ƒƒ 
.
ƒƒ  
ToInt32
ƒƒ  '
(
ƒƒ' (
sph
ƒƒ( +
.
ƒƒ+ ,
ExecuteScalar
ƒƒ, 9
(
ƒƒ9 :
)
ƒƒ: ;
)
ƒƒ; <
;
ƒƒ< =
return
≈≈ 
(
≈≈ 
count
≈≈ 
>
≈≈ 
$num
≈≈ 
)
≈≈ 
;
≈≈ 
}
∆∆ 	
public
»» 
static
»» 
	DataTable
»» #
PageModuleGetByModule
»»  5
(
»»5 6
int
»»6 9
moduleId
»»: B
)
»»B C
{
…… 	
	DataTable
   
	dataTable
   
=
    !
new
  " %
	DataTable
  & /
(
  / 0
)
  0 1
;
  1 2
	dataTable
ÀÀ 
.
ÀÀ 
Columns
ÀÀ 
.
ÀÀ 
Add
ÀÀ !
(
ÀÀ! "
$str
ÀÀ" *
,
ÀÀ* +
typeof
ÀÀ, 2
(
ÀÀ2 3
int
ÀÀ3 6
)
ÀÀ6 7
)
ÀÀ7 8
;
ÀÀ8 9
	dataTable
ÃÃ 
.
ÃÃ 
Columns
ÃÃ 
.
ÃÃ 
Add
ÃÃ !
(
ÃÃ! "
$str
ÃÃ" ,
,
ÃÃ, -
typeof
ÃÃ. 4
(
ÃÃ4 5
int
ÃÃ5 8
)
ÃÃ8 9
)
ÃÃ9 :
;
ÃÃ: ;
	dataTable
ÕÕ 
.
ÕÕ 
Columns
ÕÕ 
.
ÕÕ 
Add
ÕÕ !
(
ÕÕ! "
$str
ÕÕ" ,
,
ÕÕ, -
typeof
ÕÕ. 4
(
ÕÕ4 5
string
ÕÕ5 ;
)
ÕÕ; <
)
ÕÕ< =
;
ÕÕ= >
	dataTable
ŒŒ 
.
ŒŒ 
Columns
ŒŒ 
.
ŒŒ 
Add
ŒŒ !
(
ŒŒ! "
$str
ŒŒ" /
,
ŒŒ/ 0
typeof
ŒŒ1 7
(
ŒŒ7 8
int
ŒŒ8 ;
)
ŒŒ; <
)
ŒŒ< =
;
ŒŒ= >
	dataTable
œœ 
.
œœ 
Columns
œœ 
.
œœ 
Add
œœ !
(
œœ! "
$str
œœ" 4
,
œœ4 5
typeof
œœ6 <
(
œœ< =
DateTime
œœ= E
)
œœE F
)
œœF G
;
œœG H
	dataTable
–– 
.
–– 
Columns
–– 
.
–– 
Add
–– !
(
––! "
$str
––" 2
,
––2 3
typeof
––4 :
(
––: ;
DateTime
––; C
)
––C D
)
––D E
;
––E F
using
““ 
(
““ 
IDataReader
““ 
reader
““ %
=
““& ')
PageModuleGetReaderByModule
““( C
(
““C D
moduleId
““D L
)
““L M
)
““M N
{
”” 
while
‘‘ 
(
‘‘ 
reader
‘‘ 
.
‘‘ 
Read
‘‘ "
(
‘‘" #
)
‘‘# $
)
‘‘$ %
{
’’ 
DataRow
÷÷ 
row
÷÷ 
=
÷÷  !
	dataTable
÷÷" +
.
÷÷+ ,
NewRow
÷÷, 2
(
÷÷2 3
)
÷÷3 4
;
÷÷4 5
row
◊◊ 
[
◊◊ 
$str
◊◊  
]
◊◊  !
=
◊◊" #
reader
◊◊$ *
[
◊◊* +
$str
◊◊+ 3
]
◊◊3 4
;
◊◊4 5
row
ÿÿ 
[
ÿÿ 
$str
ÿÿ "
]
ÿÿ" #
=
ÿÿ$ %
reader
ÿÿ& ,
[
ÿÿ, -
$str
ÿÿ- 7
]
ÿÿ7 8
;
ÿÿ8 9
row
ŸŸ 
[
ŸŸ 
$str
ŸŸ "
]
ŸŸ" #
=
ŸŸ$ %
reader
ŸŸ& ,
[
ŸŸ, -
$str
ŸŸ- 7
]
ŸŸ7 8
;
ŸŸ8 9
row
⁄⁄ 
[
⁄⁄ 
$str
⁄⁄ %
]
⁄⁄% &
=
⁄⁄' (
reader
⁄⁄) /
[
⁄⁄/ 0
$str
⁄⁄0 =
]
⁄⁄= >
;
⁄⁄> ?
row
€€ 
[
€€ 
$str
€€ *
]
€€* +
=
€€, -
reader
€€. 4
[
€€4 5
$str
€€5 G
]
€€G H
;
€€H I
row
‹‹ 
[
‹‹ 
$str
‹‹ (
]
‹‹( )
=
‹‹* +
reader
‹‹, 2
[
‹‹2 3
$str
‹‹3 C
]
‹‹C D
;
‹‹D E
	dataTable
ﬁﬁ 
.
ﬁﬁ 
Rows
ﬁﬁ "
.
ﬁﬁ" #
Add
ﬁﬁ# &
(
ﬁﬁ& '
row
ﬁﬁ' *
)
ﬁﬁ* +
;
ﬁﬁ+ ,
}
ﬂﬂ 
}
·· 
return
„„ 
	dataTable
„„ 
;
„„ 
}
ÂÂ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !)
PageModuleGetReaderByModule
ÁÁ" =
(
ÁÁ= >
int
ÁÁ> A
moduleId
ÁÁB J
)
ÁÁJ K
{
ËË 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh Ü
,ÈÈÜ á
$numÈÈà â
)ÈÈâ ä
;ÈÈä ã
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# .
,
ÍÍ. /
	SqlDbType
ÍÍ0 9
.
ÍÍ9 :
Int
ÍÍ: =
,
ÍÍ= > 
ParameterDirection
ÍÍ? Q
.
ÍÍQ R
Input
ÍÍR W
,
ÍÍW X
moduleId
ÍÍY a
)
ÍÍa b
;
ÍÍb c
return
ÎÎ 
sph
ÎÎ 
.
ÎÎ 
ExecuteReader
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
}
ÏÏ 	
public
ÓÓ 
static
ÓÓ 
IDataReader
ÓÓ !'
PageModuleGetReaderByPage
ÓÓ" ;
(
ÓÓ; <
int
ÓÓ< ?
pageId
ÓÓ@ F
)
ÓÓF G
{
ÔÔ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh Ñ
,Ñ Ö
$numÜ á
)á à
;à â
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# ,
,
ÒÒ, -
	SqlDbType
ÒÒ. 7
.
ÒÒ7 8
Int
ÒÒ8 ;
,
ÒÒ; < 
ParameterDirection
ÒÒ= O
.
ÒÒO P
Input
ÒÒP U
,
ÒÒU V
pageId
ÒÒW ]
)
ÒÒ] ^
;
ÒÒ^ _
return
ÚÚ 
sph
ÚÚ 
.
ÚÚ 
ExecuteReader
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 	
public
ıı 
static
ıı 
bool
ıı 
PageModuleInsert
ıı +
(
ıı+ ,
Guid
ˆˆ 
pageGuid
ˆˆ 
,
ˆˆ 
Guid
˜˜ 

moduleGuid
˜˜ 
,
˜˜ 
int
¯¯ 
moduleId
¯¯ 
,
¯¯ 
int
˘˘ 
pageId
˘˘ 
,
˘˘ 
String
˙˙ 
paneName
˙˙ 
,
˙˙ 
int
˚˚ 
moduleOrder
˚˚ 
,
˚˚ 
DateTime
¸¸ 
publishBeginDate
¸¸ %
,
¸¸% &
DateTime
˝˝ 
publishEndDate
˝˝ #
)
˝˝# $
{
˛˛ 	 
SqlParameterHelper
ˇˇ 
sph
ˇˇ "
=
ˇˇ# $
new
ˇˇ% ( 
SqlParameterHelper
ˇˇ) ;
(
ˇˇ; <
ConnectionString
ˇˇ< L
.
ˇˇL M%
GetReadConnectionString
ˇˇM d
(
ˇˇd e
)
ˇˇe f
,
ˇˇf g
$str
ˇˇh 
,ˇˇ Ä
$numˇˇÅ Ç
)ˇˇÇ É
;ˇˇÉ Ñ
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
UniqueIdentifier
ÄÄ: J
,
ÄÄJ K 
ParameterDirection
ÄÄL ^
.
ÄÄ^ _
Input
ÄÄ_ d
,
ÄÄd e
pageGuid
ÄÄf n
)
ÄÄn o
;
ÄÄo p
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 0
,
ÅÅ0 1
	SqlDbType
ÅÅ2 ;
.
ÅÅ; <
UniqueIdentifier
ÅÅ< L
,
ÅÅL M 
ParameterDirection
ÅÅN `
.
ÅÅ` a
Input
ÅÅa f
,
ÅÅf g

moduleGuid
ÅÅh r
)
ÅÅr s
;
ÅÅs t
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
Int
ÇÇ: =
,
ÇÇ= > 
ParameterDirection
ÇÇ? Q
.
ÇÇQ R
Input
ÇÇR W
,
ÇÇW X
moduleId
ÇÇY a
)
ÇÇa b
;
ÇÇb c
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# ,
,
ÉÉ, -
	SqlDbType
ÉÉ. 7
.
ÉÉ7 8
Int
ÉÉ8 ;
,
ÉÉ; < 
ParameterDirection
ÉÉ= O
.
ÉÉO P
Input
ÉÉP U
,
ÉÉU V
pageId
ÉÉW ]
)
ÉÉ] ^
;
ÉÉ^ _
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# .
,
ÑÑ. /
	SqlDbType
ÑÑ0 9
.
ÑÑ9 :
NVarChar
ÑÑ: B
,
ÑÑB C
$num
ÑÑD F
,
ÑÑF G 
ParameterDirection
ÑÑH Z
.
ÑÑZ [
Input
ÑÑ[ `
,
ÑÑ` a
paneName
ÑÑb j
)
ÑÑj k
;
ÑÑk l
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 1
,
ÖÖ1 2
	SqlDbType
ÖÖ3 <
.
ÖÖ< =
Int
ÖÖ= @
,
ÖÖ@ A 
ParameterDirection
ÖÖB T
.
ÖÖT U
Input
ÖÖU Z
,
ÖÖZ [
moduleOrder
ÖÖ\ g
)
ÖÖg h
;
ÖÖh i
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 6
,
ÜÜ6 7
	SqlDbType
ÜÜ8 A
.
ÜÜA B
DateTime
ÜÜB J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
publishBeginDate
ÜÜf v
)
ÜÜv w
;
ÜÜw x
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 4
,
áá4 5
	SqlDbType
áá6 ?
.
áá? @
DateTime
áá@ H
,
ááH I 
ParameterDirection
ááJ \
.
áá\ ]
Input
áá] b
,
ááb c
(
áád e
publishEndDate
ááe s
==
áát v
DateTime
ááw 
.áá Ä
MinValueááÄ à
)ááà â
?ááä ã
(ááå ç
objectááç ì
)ááì î
DBNullááî ö
.ááö õ
Valueááõ †
:áá° ¢
(áá£ §
objectáá§ ™
)áá™ ´
publishEndDateáá´ π
)ááπ ∫
;áá∫ ª
int
àà 
rowsAffected
àà 
=
àà 
sph
àà "
.
àà" #
ExecuteNonQuery
àà# 2
(
àà2 3
)
àà3 4
;
àà4 5
return
ââ 
(
ââ 
rowsAffected
ââ  
>
ââ! "
-
ââ# $
$num
ââ$ %
)
ââ% &
;
ââ& '
}
ää 	
public
åå 
static
åå 
bool
åå 
PageModuleUpdate
åå +
(
åå+ ,
int
çç 
moduleId
çç 
,
çç 
int
éé 
pageId
éé 
,
éé 
String
èè 
paneName
èè 
,
èè 
int
êê 
moduleOrder
êê 
,
êê 
DateTime
ëë 
publishBeginDate
ëë %
,
ëë% &
DateTime
íí 
publishEndDate
íí #
)
íí# $
{
ìì 	 
SqlParameterHelper
îî 
sph
îî "
=
îî# $
new
îî% ( 
SqlParameterHelper
îî) ;
(
îî; <
ConnectionString
îî< L
.
îîL M&
GetWriteConnectionString
îîM e
(
îîe f
)
îîf g
,
îîg h
$strîîi Ä
,îîÄ Å
$numîîÇ É
)îîÉ Ñ
;îîÑ Ö
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# .
,
ïï. /
	SqlDbType
ïï0 9
.
ïï9 :
Int
ïï: =
,
ïï= > 
ParameterDirection
ïï? Q
.
ïïQ R
Input
ïïR W
,
ïïW X
moduleId
ïïY a
)
ïïa b
;
ïïb c
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# ,
,
ññ, -
	SqlDbType
ññ. 7
.
ññ7 8
Int
ññ8 ;
,
ññ; < 
ParameterDirection
ññ= O
.
ññO P
Input
ññP U
,
ññU V
pageId
ññW ]
)
ññ] ^
;
ññ^ _
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# .
,
óó. /
	SqlDbType
óó0 9
.
óó9 :
NVarChar
óó: B
,
óóB C
$num
óóD F
,
óóF G 
ParameterDirection
óóH Z
.
óóZ [
Input
óó[ `
,
óó` a
paneName
óób j
)
óój k
;
óók l
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 1
,
òò1 2
	SqlDbType
òò3 <
.
òò< =
Int
òò= @
,
òò@ A 
ParameterDirection
òòB T
.
òòT U
Input
òòU Z
,
òòZ [
moduleOrder
òò\ g
)
òòg h
;
òòh i
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# 6
,
ôô6 7
	SqlDbType
ôô8 A
.
ôôA B
DateTime
ôôB J
,
ôôJ K 
ParameterDirection
ôôL ^
.
ôô^ _
Input
ôô_ d
,
ôôd e
publishBeginDate
ôôf v
)
ôôv w
;
ôôw x
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 4
,
öö4 5
	SqlDbType
öö6 ?
.
öö? @
DateTime
öö@ H
,
ööH I 
ParameterDirection
ööJ \
.
öö\ ]
Input
öö] b
,
ööb c
(
ööd e
publishEndDate
ööe s
==
ööt v
DateTime
ööw 
.öö Ä
MinValueööÄ à
)ööà â
?ööä ã
(ööå ç
objectööç ì
)ööì î
DBNullööî ö
.ööö õ
Valueööõ †
:öö° ¢
(öö£ §
objectöö§ ™
)öö™ ´
publishEndDateöö´ π
)ööπ ∫
;öö∫ ª
int
õõ 
rowsAffected
õõ 
=
õõ 
sph
õõ "
.
õõ" #
ExecuteNonQuery
õõ# 2
(
õõ2 3
)
õõ3 4
;
õõ4 5
return
úú 
(
úú 
rowsAffected
úú  
>
úú! "
-
úú# $
$num
úú$ %
)
úú% &
;
úú& '
}
ùù 	
public
üü 
static
üü 
bool
üü $
PageModuleDeleteByPage
üü 1
(
üü1 2
int
üü2 5
pageId
üü6 <
)
üü< =
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M&
GetWriteConnectionString
°°M e
(
°°e f
)
°°f g
,
°°g h
$str°°i Ü
,°°Ü á
$num°°à â
)°°â ä
;°°ä ã
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# ,
,
¢¢, -
	SqlDbType
¢¢. 7
.
¢¢7 8
Int
¢¢8 ;
,
¢¢; < 
ParameterDirection
¢¢= O
.
¢¢O P
Input
¢¢P U
,
¢¢U V
pageId
¢¢W ]
)
¢¢] ^
;
¢¢^ _
int
££ 
rowsAffected
££ 
=
££ 
sph
££ "
.
££" #
ExecuteNonQuery
££# 2
(
££2 3
)
££3 4
;
££4 5
return
§§ 
(
§§ 
rowsAffected
§§  
>
§§! "
-
§§# $
$num
§§$ %
)
§§% &
;
§§& '
}
•• 	
public
ßß 
static
ßß 
bool
ßß &
UpdateCountOfUseOnMyPage
ßß 3
(
ßß3 4
int
ßß4 7
moduleId
ßß8 @
,
ßß@ A
int
ßßB E
	increment
ßßF O
)
ßßO P
{
®® 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i é
,©©é è
$num©©ê ë
)©©ë í
;©©í ì
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# .
,
™™. /
	SqlDbType
™™0 9
.
™™9 :
Int
™™: =
,
™™= > 
ParameterDirection
™™? Q
.
™™Q R
Input
™™R W
,
™™W X
moduleId
™™Y a
)
™™a b
;
™™b c
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# /
,
´´/ 0
	SqlDbType
´´1 :
.
´´: ;
Int
´´; >
,
´´> ? 
ParameterDirection
´´@ R
.
´´R S
Input
´´S X
,
´´X Y
	increment
´´Z c
)
´´c d
;
´´d e
int
¨¨ 
rowsAffected
¨¨ 
=
¨¨ 
sph
¨¨ "
.
¨¨" #
ExecuteNonQuery
¨¨# 2
(
¨¨2 3
)
¨¨3 4
;
¨¨4 5
return
≠≠ 
(
≠≠ 
rowsAffected
≠≠  
>
≠≠! "
-
≠≠# $
$num
≠≠$ %
)
≠≠% &
;
≠≠& '
}
ÆÆ 	
public
∞∞ 
static
∞∞ 
bool
∞∞ 
DeleteModule
∞∞ '
(
∞∞' (
int
∞∞( +
moduleId
∞∞, 4
)
∞∞4 5
{
±± 	 
SqlParameterHelper
≤≤ 
sph
≤≤ "
=
≤≤# $
new
≤≤% ( 
SqlParameterHelper
≤≤) ;
(
≤≤; <
ConnectionString
≤≤< L
.
≤≤L M&
GetWriteConnectionString
≤≤M e
(
≤≤e f
)
≤≤f g
,
≤≤g h
$str
≤≤i |
,
≤≤| }
$num
≤≤~ 
)≤≤ Ä
;≤≤Ä Å
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# .
,
≥≥. /
	SqlDbType
≥≥0 9
.
≥≥9 :
Int
≥≥: =
,
≥≥= > 
ParameterDirection
≥≥? Q
.
≥≥Q R
Input
≥≥R W
,
≥≥W X
moduleId
≥≥Y a
)
≥≥a b
;
≥≥b c
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
sph
¥¥ "
.
¥¥" #
ExecuteNonQuery
¥¥# 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
-
µµ# $
$num
µµ$ %
)
µµ% &
;
µµ& '
}
∂∂ 	
public
∏∏ 
static
∏∏ 
bool
∏∏ "
DeleteModuleInstance
∏∏ /
(
∏∏/ 0
int
∏∏0 3
moduleId
∏∏4 <
,
∏∏< =
int
∏∏> A
pageId
∏∏B H
)
∏∏H I
{
ππ 	 
SqlParameterHelper
∫∫ 
sph
∫∫ "
=
∫∫# $
new
∫∫% ( 
SqlParameterHelper
∫∫) ;
(
∫∫; <
ConnectionString
∫∫< L
.
∫∫L M&
GetWriteConnectionString
∫∫M e
(
∫∫e f
)
∫∫f g
,
∫∫g h
$str∫∫i Ñ
,∫∫Ñ Ö
$num∫∫Ü á
)∫∫á à
;∫∫à â
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
Int
ªª: =
,
ªª= > 
ParameterDirection
ªª? Q
.
ªªQ R
Input
ªªR W
,
ªªW X
moduleId
ªªY a
)
ªªa b
;
ªªb c
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# ,
,
ºº, -
	SqlDbType
ºº. 7
.
ºº7 8
Int
ºº8 ;
,
ºº; < 
ParameterDirection
ºº= O
.
ººO P
Input
ººP U
,
ººU V
pageId
ººW ]
)
ºº] ^
;
ºº^ _
int
ΩΩ 
rowsAffected
ΩΩ 
=
ΩΩ 
sph
ΩΩ "
.
ΩΩ" #
ExecuteNonQuery
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
return
ææ 
(
ææ 
rowsAffected
ææ  
>
ææ! "
-
ææ# $
$num
ææ$ %
)
ææ% &
;
ææ& '
}
øø 	
public
¡¡ 
static
¡¡ 
IDataReader
¡¡ !
	GetModule
¡¡" +
(
¡¡+ ,
int
¡¡, /
moduleId
¡¡0 8
)
¡¡8 9
{
¬¬ 	 
SqlParameterHelper
√√ 
sph
√√ "
=
√√# $
new
√√% ( 
SqlParameterHelper
√√) ;
(
√√; <
ConnectionString
√√< L
.
√√L M%
GetReadConnectionString
√√M d
(
√√d e
)
√√e f
,
√√f g
$str
√√h ~
,
√√~ 
$num√√Ä Å
)√√Å Ç
;√√Ç É
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ "
(
ƒƒ" #
$str
ƒƒ# .
,
ƒƒ. /
	SqlDbType
ƒƒ0 9
.
ƒƒ9 :
Int
ƒƒ: =
,
ƒƒ= > 
ParameterDirection
ƒƒ? Q
.
ƒƒQ R
Input
ƒƒR W
,
ƒƒW X
moduleId
ƒƒY a
)
ƒƒa b
;
ƒƒb c
return
≈≈ 
sph
≈≈ 
.
≈≈ 
ExecuteReader
≈≈ $
(
≈≈$ %
)
≈≈% &
;
≈≈& '
}
∆∆ 	
public
»» 
static
»» 
IDataReader
»» !
	GetModule
»»" +
(
»»+ ,
Guid
»», 0

moduleGuid
»»1 ;
)
»»; <
{
…… 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h Ñ
,  Ñ Ö
$num  Ü á
)  á à
;  à â
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# *
,
ÀÀ* +
	SqlDbType
ÀÀ, 5
.
ÀÀ5 6
UniqueIdentifier
ÀÀ6 F
,
ÀÀF G 
ParameterDirection
ÀÀH Z
.
ÀÀZ [
Input
ÀÀ[ `
,
ÀÀ` a

moduleGuid
ÀÀb l
)
ÀÀl m
;
ÀÀm n
return
ÃÃ 
sph
ÃÃ 
.
ÃÃ 
ExecuteReader
ÃÃ $
(
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ÕÕ 	
public
œœ 
static
œœ 
IDataReader
œœ !
	GetModule
œœ" +
(
œœ+ ,
int
œœ, /
moduleId
œœ0 8
,
œœ8 9
int
œœ: =
pageId
œœ> D
)
œœD E
{
–– 	 
SqlParameterHelper
—— 
sph
—— "
=
——# $
new
——% ( 
SqlParameterHelper
——) ;
(
——; <
ConnectionString
——< L
.
——L M%
GetReadConnectionString
——M d
(
——d e
)
——e f
,
——f g
$str——h Ñ
,——Ñ Ö
$num——Ü á
)——á à
;——à â
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# .
,
““. /
	SqlDbType
““0 9
.
““9 :
Int
““: =
,
““= > 
ParameterDirection
““? Q
.
““Q R
Input
““R W
,
““W X
moduleId
““Y a
)
““a b
;
““b c
sph
”” 
.
””  
DefineSqlParameter
”” "
(
””" #
$str
””# ,
,
””, -
	SqlDbType
””. 7
.
””7 8
Int
””8 ;
,
””; < 
ParameterDirection
””= O
.
””O P
Input
””P U
,
””U V
pageId
””W ]
)
””] ^
;
””^ _
return
‘‘ 
sph
‘‘ 
.
‘‘ 
ExecuteReader
‘‘ $
(
‘‘$ %
)
‘‘% &
;
‘‘& '
}
’’ 	
public
◊◊ 
static
◊◊ 
IDataReader
◊◊ !
GetPageModules
◊◊" 0
(
◊◊0 1
int
◊◊1 4
pageId
◊◊5 ;
)
◊◊; <
{
ÿÿ 	 
SqlParameterHelper
ŸŸ 
sph
ŸŸ "
=
ŸŸ# $
new
ŸŸ% ( 
SqlParameterHelper
ŸŸ) ;
(
ŸŸ; <
ConnectionString
ŸŸ< L
.
ŸŸL M%
GetReadConnectionString
ŸŸM d
(
ŸŸd e
)
ŸŸe f
,
ŸŸf g
$strŸŸh Å
,ŸŸÅ Ç
$numŸŸÉ Ñ
)ŸŸÑ Ö
;ŸŸÖ Ü
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# ,
,
⁄⁄, -
	SqlDbType
⁄⁄. 7
.
⁄⁄7 8
Int
⁄⁄8 ;
,
⁄⁄; < 
ParameterDirection
⁄⁄= O
.
⁄⁄O P
Input
⁄⁄P U
,
⁄⁄U V
pageId
⁄⁄W ]
)
⁄⁄] ^
;
⁄⁄^ _
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# 1
,
€€1 2
	SqlDbType
€€3 <
.
€€< =
DateTime
€€= E
,
€€E F 
ParameterDirection
€€G Y
.
€€Y Z
Input
€€Z _
,
€€_ `
DateTime
€€a i
.
€€i j
UtcNow
€€j p
)
€€p q
;
€€q r
return
‹‹ 
sph
‹‹ 
.
‹‹ 
ExecuteReader
‹‹ $
(
‹‹$ %
)
‹‹% &
;
‹‹& '
}
›› 	
public
‡‡ 
static
‡‡ 
IDataReader
‡‡ !
GetMyPageModules
‡‡" 2
(
‡‡2 3
int
‡‡3 6
siteId
‡‡7 =
)
‡‡= >
{
·· 	 
SqlParameterHelper
‚‚ 
sph
‚‚ "
=
‚‚# $
new
‚‚% ( 
SqlParameterHelper
‚‚) ;
(
‚‚; <
ConnectionString
‚‚< L
.
‚‚L M%
GetReadConnectionString
‚‚M d
(
‚‚d e
)
‚‚e f
,
‚‚f g
$str‚‚h Ñ
,‚‚Ñ Ö
$num‚‚Ü á
)‚‚á à
;‚‚à â
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# ,
,
„„, -
	SqlDbType
„„. 7
.
„„7 8
Int
„„8 ;
,
„„; < 
ParameterDirection
„„= O
.
„„O P
Input
„„P U
,
„„U V
siteId
„„W ]
)
„„] ^
;
„„^ _
return
‰‰ 
sph
‰‰ 
.
‰‰ 
ExecuteReader
‰‰ $
(
‰‰$ %
)
‰‰% &
;
‰‰& '
}
ÂÂ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !
GetModulesForSite
ÁÁ" 3
(
ÁÁ3 4
int
ÁÁ4 7
siteId
ÁÁ8 >
,
ÁÁ> ?
Guid
ÁÁ@ D
featureGuid
ÁÁE P
)
ÁÁP Q
{
ËË 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh Å
,ÈÈÅ Ç
$numÈÈÉ Ñ
)ÈÈÑ Ö
;ÈÈÖ Ü
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# ,
,
ÍÍ, -
	SqlDbType
ÍÍ. 7
.
ÍÍ7 8
Int
ÍÍ8 ;
,
ÍÍ; < 
ParameterDirection
ÍÍ= O
.
ÍÍO P
Input
ÍÍP U
,
ÍÍU V
siteId
ÍÍW ]
)
ÍÍ] ^
;
ÍÍ^ _
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 1
,
ÎÎ1 2
	SqlDbType
ÎÎ3 <
.
ÎÎ< =
UniqueIdentifier
ÎÎ= M
,
ÎÎM N 
ParameterDirection
ÎÎO a
.
ÎÎa b
Input
ÎÎb g
,
ÎÎg h
featureGuid
ÎÎi t
)
ÎÎt u
;
ÎÎu v
return
ÏÏ 
sph
ÏÏ 
.
ÏÏ 
ExecuteReader
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
;
ÏÏ& '
}
ÌÌ 	
public
ÚÚ 
static
ÚÚ 
int
ÚÚ 
GetCount
ÚÚ "
(
ÚÚ" #
int
ÚÚ# &
siteId
ÚÚ' -
,
ÚÚ- .
int
ÚÚ/ 2
moduleDefId
ÚÚ3 >
,
ÚÚ> ?
string
ÚÚ@ F
title
ÚÚG L
)
ÚÚL M
{
ÛÛ 	 
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$str
ÙÙh }
,
ÙÙ} ~
$numÙÙ Ä
)ÙÙÄ Å
;ÙÙÅ Ç
sph
ıı 
.
ıı  
DefineSqlParameter
ıı "
(
ıı" #
$str
ıı# ,
,
ıı, -
	SqlDbType
ıı. 7
.
ıı7 8
Int
ıı8 ;
,
ıı; < 
ParameterDirection
ıı= O
.
ııO P
Input
ııP U
,
ııU V
siteId
ııW ]
)
ıı] ^
;
ıı^ _
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# 1
,
ˆˆ1 2
	SqlDbType
ˆˆ3 <
.
ˆˆ< =
Int
ˆˆ= @
,
ˆˆ@ A 
ParameterDirection
ˆˆB T
.
ˆˆT U
Input
ˆˆU Z
,
ˆˆZ [
moduleDefId
ˆˆ\ g
)
ˆˆg h
;
ˆˆh i
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# +
,
˜˜+ ,
	SqlDbType
˜˜- 6
.
˜˜6 7
NVarChar
˜˜7 ?
,
˜˜? @
$num
˜˜A D
,
˜˜D E 
ParameterDirection
˜˜F X
.
˜˜X Y
Input
˜˜Y ^
,
˜˜^ _
title
˜˜` e
)
˜˜e f
;
˜˜f g
return
¯¯ 
Convert
¯¯ 
.
¯¯ 
ToInt32
¯¯ "
(
¯¯" #
sph
¯¯# &
.
¯¯& '
ExecuteScalar
¯¯' 4
(
¯¯4 5
)
¯¯5 6
)
¯¯6 7
;
¯¯7 8
}
˘˘ 	
public
˚˚ 
static
˚˚ 
	DataTable
˚˚ 

SelectPage
˚˚  *
(
˚˚* +
int
¸¸ 
siteId
¸¸ 
,
¸¸ 
int
˝˝ 
moduleDefId
˝˝ 
,
˝˝ 
string
˛˛ 
title
˛˛ 
,
˛˛ 
int
ˇˇ 

pageNumber
ˇˇ 
,
ˇˇ 
int
ÄÄ 
pageSize
ÄÄ 
,
ÄÄ 
bool
ÅÅ 
sortByModuleType
ÅÅ !
,
ÅÅ! "
bool
ÇÇ 
sortByAuthor
ÇÇ 
,
ÇÇ 
out
ÉÉ 
int
ÉÉ 

totalPages
ÉÉ 
)
ÉÉ 
{
ÑÑ 	

totalPages
ÖÖ 
=
ÖÖ 
$num
ÖÖ 
;
ÖÖ 
int
ÜÜ 
	totalRows
ÜÜ 
=
ÜÜ 
GetCount
ÜÜ $
(
ÜÜ$ %
siteId
ÜÜ% +
,
ÜÜ+ ,
moduleDefId
ÜÜ- 8
,
ÜÜ8 9
title
ÜÜ: ?
)
ÜÜ? @
;
ÜÜ@ A
if
àà 
(
àà 
pageSize
àà 
>
àà 
$num
àà 
)
àà 

totalPages
àà (
=
àà) *
	totalRows
àà+ 4
/
àà5 6
pageSize
àà7 ?
;
àà? @
if
ää 
(
ää 
	totalRows
ää 
<=
ää 
pageSize
ää %
)
ää% &
{
ãã 

totalPages
åå 
=
åå 
$num
åå 
;
åå 
}
çç 
else
éé 
{
èè 
int
êê 
	remainder
êê 
;
êê 
Math
ëë 
.
ëë 
DivRem
ëë 
(
ëë 
	totalRows
ëë %
,
ëë% &
pageSize
ëë' /
,
ëë/ 0
out
ëë1 4
	remainder
ëë5 >
)
ëë> ?
;
ëë? @
if
íí 
(
íí 
	remainder
íí 
>
íí 
$num
íí  !
)
íí! "
{
ìì 

totalPages
îî 
+=
îî !
$num
îî" #
;
îî# $
}
ïï 
}
ññ  
SqlParameterHelper
òò 
sph
òò "
=
òò# $
new
òò% ( 
SqlParameterHelper
òò) ;
(
òò; <
ConnectionString
òò< L
.
òòL M%
GetReadConnectionString
òòM d
(
òòd e
)
òòe f
,
òòf g
$str
òòh 
,òò Ä
$numòòÅ Ç
)òòÇ É
;òòÉ Ñ
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# ,
,
ôô, -
	SqlDbType
ôô. 7
.
ôô7 8
Int
ôô8 ;
,
ôô; < 
ParameterDirection
ôô= O
.
ôôO P
Input
ôôP U
,
ôôU V
siteId
ôôW ]
)
ôô] ^
;
ôô^ _
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 1
,
öö1 2
	SqlDbType
öö3 <
.
öö< =
Int
öö= @
,
öö@ A 
ParameterDirection
ööB T
.
ööT U
Input
ööU Z
,
ööZ [
moduleDefId
öö\ g
)
öög h
;
ööh i
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# +
,
õõ+ ,
	SqlDbType
õõ- 6
.
õõ6 7
NVarChar
õõ7 ?
,
õõ? @
$num
õõA D
,
õõD E 
ParameterDirection
õõF X
.
õõX Y
Input
õõY ^
,
õõ^ _
title
õõ` e
)
õõe f
;
õõf g
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 0
,
úú0 1
	SqlDbType
úú2 ;
.
úú; <
Int
úú< ?
,
úú? @ 
ParameterDirection
úúA S
.
úúS T
Input
úúT Y
,
úúY Z

pageNumber
úú[ e
)
úúe f
;
úúf g
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
Int
ùù: =
,
ùù= > 
ParameterDirection
ùù? Q
.
ùùQ R
Input
ùùR W
,
ùùW X
pageSize
ùùY a
)
ùùa b
;
ùùb c
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 6
,
ûû6 7
	SqlDbType
ûû8 A
.
ûûA B
Bit
ûûB E
,
ûûE F 
ParameterDirection
ûûG Y
.
ûûY Z
Input
ûûZ _
,
ûû_ `
sortByModuleType
ûûa q
)
ûûq r
;
ûûr s
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 2
,
üü2 3
	SqlDbType
üü4 =
.
üü= >
Bit
üü> A
,
üüA B 
ParameterDirection
üüC U
.
üüU V
Input
üüV [
,
üü[ \
sortByAuthor
üü] i
)
üüi j
;
üüj k
	DataTable
¢¢ 
dt
¢¢ 
=
¢¢ 
new
¢¢ 
	DataTable
¢¢ (
(
¢¢( )
)
¢¢) *
;
¢¢* +
dt
££ 
.
££ 
Columns
££ 
.
££ 
Add
££ 
(
££ 
$str
££ %
,
££% &
typeof
££' -
(
££- .
int
££. 1
)
££1 2
)
££2 3
;
££3 4
dt
§§ 
.
§§ 
Columns
§§ 
.
§§ 
Add
§§ 
(
§§ 
$str
§§ (
,
§§( )
typeof
§§* 0
(
§§0 1
String
§§1 7
)
§§7 8
)
§§8 9
;
§§9 :
dt
•• 
.
•• 
Columns
•• 
.
•• 
Add
•• 
(
•• 
$str
•• (
,
••( )
typeof
••* 0
(
••0 1
String
••1 7
)
••7 8
)
••8 9
;
••9 :
dt
¶¶ 
.
¶¶ 
Columns
¶¶ 
.
¶¶ 
Add
¶¶ 
(
¶¶ 
$str
¶¶ )
,
¶¶) *
typeof
¶¶+ 1
(
¶¶1 2
String
¶¶2 8
)
¶¶8 9
)
¶¶9 :
;
¶¶: ;
dt
ßß 
.
ßß 
Columns
ßß 
.
ßß 
Add
ßß 
(
ßß 
$str
ßß '
,
ßß' (
typeof
ßß) /
(
ßß/ 0
String
ßß0 6
)
ßß6 7
)
ßß7 8
;
ßß8 9
dt
®® 
.
®® 
Columns
®® 
.
®® 
Add
®® 
(
®® 
$str
®® 0
,
®®0 1
typeof
®®2 8
(
®®8 9
String
®®9 ?
)
®®? @
)
®®@ A
;
®®A B
dt
©© 
.
©© 
Columns
©© 
.
©© 
Add
©© 
(
©© 
$str
©© &
,
©©& '
typeof
©©( .
(
©©. /
String
©©/ 5
)
©©5 6
)
©©6 7
;
©©7 8
dt
™™ 
.
™™ 
Columns
™™ 
.
™™ 
Add
™™ 
(
™™ 
$str
™™ (
,
™™( )
typeof
™™* 0
(
™™0 1
DateTime
™™1 9
)
™™9 :
)
™™: ;
;
™™; <
dt
´´ 
.
´´ 
Columns
´´ 
.
´´ 
Add
´´ 
(
´´ 
$str
´´ %
,
´´% &
typeof
´´' -
(
´´- .
int
´´. 1
)
´´1 2
)
´´2 3
;
´´3 4
using
≠≠ 
(
≠≠ 
IDataReader
≠≠ 
reader
≠≠ %
=
≠≠& '
sph
≠≠( +
.
≠≠+ ,
ExecuteReader
≠≠, 9
(
≠≠9 :
)
≠≠: ;
)
≠≠; <
{
ÆÆ 
while
ØØ 
(
ØØ 
reader
ØØ 
.
ØØ 
Read
ØØ "
(
ØØ" #
)
ØØ# $
)
ØØ$ %
{
∞∞ 
DataRow
±± 
row
±± 
=
±±  !
dt
±±" $
.
±±$ %
NewRow
±±% +
(
±±+ ,
)
±±, -
;
±±- .
row
≤≤ 
[
≤≤ 
$str
≤≤ "
]
≤≤" #
=
≤≤$ %
reader
≤≤& ,
[
≤≤, -
$str
≤≤- 7
]
≤≤7 8
;
≤≤8 9
row
≥≥ 
[
≥≥ 
$str
≥≥ %
]
≥≥% &
=
≥≥' (
reader
≥≥) /
[
≥≥/ 0
$str
≥≥0 =
]
≥≥= >
;
≥≥> ?
row
¥¥ 
[
¥¥ 
$str
¥¥ %
]
¥¥% &
=
¥¥' (
reader
¥¥) /
[
¥¥/ 0
$str
¥¥0 =
]
¥¥= >
;
¥¥> ?
row
µµ 
[
µµ 
$str
µµ &
]
µµ& '
=
µµ( )
reader
µµ* 0
[
µµ0 1
$str
µµ1 ?
]
µµ? @
;
µµ@ A
row
∂∂ 
[
∂∂ 
$str
∂∂ $
]
∂∂$ %
=
∂∂& '
reader
∂∂( .
[
∂∂. /
$str
∂∂/ ;
]
∂∂; <
;
∂∂< =
row
∑∑ 
[
∑∑ 
$str
∑∑ -
]
∑∑- .
=
∑∑/ 0
reader
∑∑1 7
[
∑∑7 8
$str
∑∑8 M
]
∑∑M N
;
∑∑N O
row
∏∏ 
[
∏∏ 
$str
∏∏ #
]
∏∏# $
=
∏∏% &
reader
∏∏' -
[
∏∏- .
$str
∏∏. 9
]
∏∏9 :
;
∏∏: ;
row
ππ 
[
ππ 
$str
ππ %
]
ππ% &
=
ππ' (
reader
ππ) /
[
ππ/ 0
$str
ππ0 =
]
ππ= >
;
ππ> ?
row
∫∫ 
[
∫∫ 
$str
∫∫ "
]
∫∫" #
=
∫∫$ %
reader
∫∫& ,
[
∫∫, -
$str
∫∫- 7
]
∫∫7 8
;
∫∫8 9
dt
ºº 
.
ºº 
Rows
ºº 
.
ºº 
Add
ºº 
(
ºº  
row
ºº  #
)
ºº# $
;
ºº$ %
}
ææ 
}
¿¿ 
return
¬¬ 
dt
¬¬ 
;
¬¬ 
}
ƒƒ 	
public
∆∆ 
static
∆∆ 
int
∆∆ 
GetCountByFeature
∆∆ +
(
∆∆+ ,
int
∆∆, /
moduleDefId
∆∆0 ;
)
∆∆; <
{
«« 	 
SqlParameterHelper
…… 
sph
…… "
=
……# $
new
……% ( 
SqlParameterHelper
……) ;
(
……; <
ConnectionString
……< L
.
……L M%
GetReadConnectionString
……M d
(
……d e
)
……e f
,
……f g
$str……h É
,……É Ñ
$num……Ö Ü
)……Ü á
;……á à
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 1
,
  1 2
	SqlDbType
  3 <
.
  < =
Int
  = @
,
  @ A 
ParameterDirection
  B T
.
  T U
Input
  U Z
,
  Z [
moduleDefId
  \ g
)
  g h
;
  h i
return
ÃÃ 
Convert
ÃÃ 
.
ÃÃ 
ToInt32
ÃÃ "
(
ÃÃ" #
sph
ÃÃ# &
.
ÃÃ& '
ExecuteScalar
ÃÃ' 4
(
ÃÃ4 5
)
ÃÃ5 6
)
ÃÃ6 7
;
ÃÃ7 8
}
ŒŒ 	
public
—— 
static
—— 
int
—— 
GetGlobalCount
—— (
(
——( )
int
——) ,
siteId
——- 3
,
——3 4
int
——5 8
moduleDefId
——9 D
,
——D E
int
——F I
pageId
——J P
)
——P Q
{
““ 	 
SqlParameterHelper
”” 
sph
”” "
=
””# $
new
””% ( 
SqlParameterHelper
””) ;
(
””; <
ConnectionString
””< L
.
””L M%
GetReadConnectionString
””M d
(
””d e
)
””e f
,
””f g
$str””h É
,””É Ñ
$num””Ö Ü
)””Ü á
;””á à
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# ,
,
‘‘, -
	SqlDbType
‘‘. 7
.
‘‘7 8
Int
‘‘8 ;
,
‘‘; < 
ParameterDirection
‘‘= O
.
‘‘O P
Input
‘‘P U
,
‘‘U V
siteId
‘‘W ]
)
‘‘] ^
;
‘‘^ _
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# 1
,
’’1 2
	SqlDbType
’’3 <
.
’’< =
Int
’’= @
,
’’@ A 
ParameterDirection
’’B T
.
’’T U
Input
’’U Z
,
’’Z [
moduleDefId
’’\ g
)
’’g h
;
’’h i
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# ,
,
÷÷, -
	SqlDbType
÷÷. 7
.
÷÷7 8
Int
÷÷8 ;
,
÷÷; < 
ParameterDirection
÷÷= O
.
÷÷O P
Input
÷÷P U
,
÷÷U V
pageId
÷÷W ]
)
÷÷] ^
;
÷÷^ _
return
ÿÿ 
Convert
ÿÿ 
.
ÿÿ 
ToInt32
ÿÿ "
(
ÿÿ" #
sph
ÿÿ# &
.
ÿÿ& '
ExecuteScalar
ÿÿ' 4
(
ÿÿ4 5
)
ÿÿ5 6
)
ÿÿ6 7
;
ÿÿ7 8
}
ŸŸ 	
public
€€ 
static
€€ 
	DataTable
€€ 
SelectGlobalPage
€€  0
(
€€0 1
int
‹‹ 
siteId
‹‹ 
,
‹‹ 
int
›› 
moduleDefId
›› 
,
›› 
int
ﬁﬁ 
pageId
ﬁﬁ 
,
ﬁﬁ 
int
ﬂﬂ 

pageNumber
ﬂﬂ 
,
ﬂﬂ 
int
‡‡ 
pageSize
‡‡ 
,
‡‡ 
out
·· 
int
·· 

totalPages
·· 
)
·· 
{
‚‚ 	

totalPages
„„ 
=
„„ 
$num
„„ 
;
„„ 
int
‰‰ 
	totalRows
‰‰ 
=
‰‰ 
GetGlobalCount
‰‰ *
(
‰‰* +
siteId
‰‰+ 1
,
‰‰1 2
moduleDefId
‰‰3 >
,
‰‰> ?
pageId
‰‰@ F
)
‰‰F G
;
‰‰G H
if
ÊÊ 
(
ÊÊ 
pageSize
ÊÊ 
>
ÊÊ 
$num
ÊÊ 
)
ÊÊ 

totalPages
ÊÊ (
=
ÊÊ) *
	totalRows
ÊÊ+ 4
/
ÊÊ5 6
pageSize
ÊÊ7 ?
;
ÊÊ? @
if
ËË 
(
ËË 
	totalRows
ËË 
<=
ËË 
pageSize
ËË %
)
ËË% &
{
ÈÈ 

totalPages
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 
int
ÓÓ 
	remainder
ÓÓ 
;
ÓÓ 
Math
ÔÔ 
.
ÔÔ 
DivRem
ÔÔ 
(
ÔÔ 
	totalRows
ÔÔ %
,
ÔÔ% &
pageSize
ÔÔ' /
,
ÔÔ/ 0
out
ÔÔ1 4
	remainder
ÔÔ5 >
)
ÔÔ> ?
;
ÔÔ? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
ÒÒ 

totalPages
ÚÚ 
+=
ÚÚ !
$num
ÚÚ" #
;
ÚÚ# $
}
ÛÛ 
}
ÙÙ  
SqlParameterHelper
ˆˆ 
sph
ˆˆ "
=
ˆˆ# $
new
ˆˆ% ( 
SqlParameterHelper
ˆˆ) ;
(
ˆˆ; <
ConnectionString
ˆˆ< L
.
ˆˆL M%
GetReadConnectionString
ˆˆM d
(
ˆˆd e
)
ˆˆe f
,
ˆˆf g
$strˆˆh Ö
,ˆˆÖ Ü
$numˆˆá à
)ˆˆà â
;ˆˆâ ä
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# ,
,
˜˜, -
	SqlDbType
˜˜. 7
.
˜˜7 8
Int
˜˜8 ;
,
˜˜; < 
ParameterDirection
˜˜= O
.
˜˜O P
Input
˜˜P U
,
˜˜U V
siteId
˜˜W ]
)
˜˜] ^
;
˜˜^ _
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# 1
,
¯¯1 2
	SqlDbType
¯¯3 <
.
¯¯< =
Int
¯¯= @
,
¯¯@ A 
ParameterDirection
¯¯B T
.
¯¯T U
Input
¯¯U Z
,
¯¯Z [
moduleDefId
¯¯\ g
)
¯¯g h
;
¯¯h i
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# ,
,
˘˘, -
	SqlDbType
˘˘. 7
.
˘˘7 8
Int
˘˘8 ;
,
˘˘; < 
ParameterDirection
˘˘= O
.
˘˘O P
Input
˘˘P U
,
˘˘U V
pageId
˘˘W ]
)
˘˘] ^
;
˘˘^ _
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# 0
,
˙˙0 1
	SqlDbType
˙˙2 ;
.
˙˙; <
Int
˙˙< ?
,
˙˙? @ 
ParameterDirection
˙˙A S
.
˙˙S T
Input
˙˙T Y
,
˙˙Y Z

pageNumber
˙˙[ e
)
˙˙e f
;
˙˙f g
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ "
(
˚˚" #
$str
˚˚# .
,
˚˚. /
	SqlDbType
˚˚0 9
.
˚˚9 :
Int
˚˚: =
,
˚˚= > 
ParameterDirection
˚˚? Q
.
˚˚Q R
Input
˚˚R W
,
˚˚W X
pageSize
˚˚Y a
)
˚˚a b
;
˚˚b c
	DataTable
ˇˇ 
dt
ˇˇ 
=
ˇˇ 
new
ˇˇ 
	DataTable
ˇˇ (
(
ˇˇ( )
)
ˇˇ) *
;
ˇˇ* +
dt
ÄÄ 
.
ÄÄ 
Columns
ÄÄ 
.
ÄÄ 
Add
ÄÄ 
(
ÄÄ 
$str
ÄÄ %
,
ÄÄ% &
typeof
ÄÄ' -
(
ÄÄ- .
int
ÄÄ. 1
)
ÄÄ1 2
)
ÄÄ2 3
;
ÄÄ3 4
dt
ÅÅ 
.
ÅÅ 
Columns
ÅÅ 
.
ÅÅ 
Add
ÅÅ 
(
ÅÅ 
$str
ÅÅ (
,
ÅÅ( )
typeof
ÅÅ* 0
(
ÅÅ0 1
String
ÅÅ1 7
)
ÅÅ7 8
)
ÅÅ8 9
;
ÅÅ9 :
dt
ÇÇ 
.
ÇÇ 
Columns
ÇÇ 
.
ÇÇ 
Add
ÇÇ 
(
ÇÇ 
$str
ÇÇ (
,
ÇÇ( )
typeof
ÇÇ* 0
(
ÇÇ0 1
String
ÇÇ1 7
)
ÇÇ7 8
)
ÇÇ8 9
;
ÇÇ9 :
dt
ÉÉ 
.
ÉÉ 
Columns
ÉÉ 
.
ÉÉ 
Add
ÉÉ 
(
ÉÉ 
$str
ÉÉ )
,
ÉÉ) *
typeof
ÉÉ+ 1
(
ÉÉ1 2
String
ÉÉ2 8
)
ÉÉ8 9
)
ÉÉ9 :
;
ÉÉ: ;
dt
ÑÑ 
.
ÑÑ 
Columns
ÑÑ 
.
ÑÑ 
Add
ÑÑ 
(
ÑÑ 
$str
ÑÑ '
,
ÑÑ' (
typeof
ÑÑ) /
(
ÑÑ/ 0
String
ÑÑ0 6
)
ÑÑ6 7
)
ÑÑ7 8
;
ÑÑ8 9
dt
ÖÖ 
.
ÖÖ 
Columns
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
$str
ÖÖ 0
,
ÖÖ0 1
typeof
ÖÖ2 8
(
ÖÖ8 9
String
ÖÖ9 ?
)
ÖÖ? @
)
ÖÖ@ A
;
ÖÖA B
dt
ÜÜ 
.
ÜÜ 
Columns
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
$str
ÜÜ &
,
ÜÜ& '
typeof
ÜÜ( .
(
ÜÜ. /
String
ÜÜ/ 5
)
ÜÜ5 6
)
ÜÜ6 7
;
ÜÜ7 8
dt
áá 
.
áá 
Columns
áá 
.
áá 
Add
áá 
(
áá 
$str
áá (
,
áá( )
typeof
áá* 0
(
áá0 1
DateTime
áá1 9
)
áá9 :
)
áá: ;
;
áá; <
dt
àà 
.
àà 
Columns
àà 
.
àà 
Add
àà 
(
àà 
$str
àà %
,
àà% &
typeof
àà' -
(
àà- .
int
àà. 1
)
àà1 2
)
àà2 3
;
àà3 4
using
ää 
(
ää 
IDataReader
ää 
reader
ää %
=
ää& '
sph
ää( +
.
ää+ ,
ExecuteReader
ää, 9
(
ää9 :
)
ää: ;
)
ää; <
{
ãã 
while
åå 
(
åå 
reader
åå 
.
åå 
Read
åå "
(
åå" #
)
åå# $
)
åå$ %
{
çç 
DataRow
éé 
row
éé 
=
éé  !
dt
éé" $
.
éé$ %
NewRow
éé% +
(
éé+ ,
)
éé, -
;
éé- .
row
èè 
[
èè 
$str
èè "
]
èè" #
=
èè$ %
reader
èè& ,
[
èè, -
$str
èè- 7
]
èè7 8
;
èè8 9
row
êê 
[
êê 
$str
êê %
]
êê% &
=
êê' (
reader
êê) /
[
êê/ 0
$str
êê0 =
]
êê= >
;
êê> ?
row
ëë 
[
ëë 
$str
ëë %
]
ëë% &
=
ëë' (
reader
ëë) /
[
ëë/ 0
$str
ëë0 =
]
ëë= >
;
ëë> ?
row
íí 
[
íí 
$str
íí &
]
íí& '
=
íí( )
reader
íí* 0
[
íí0 1
$str
íí1 ?
]
íí? @
;
íí@ A
row
ìì 
[
ìì 
$str
ìì $
]
ìì$ %
=
ìì& '
reader
ìì( .
[
ìì. /
$str
ìì/ ;
]
ìì; <
;
ìì< =
row
îî 
[
îî 
$str
îî -
]
îî- .
=
îî/ 0
reader
îî1 7
[
îî7 8
$str
îî8 M
]
îîM N
;
îîN O
row
ïï 
[
ïï 
$str
ïï #
]
ïï# $
=
ïï% &
reader
ïï' -
[
ïï- .
$str
ïï. 9
]
ïï9 :
;
ïï: ;
row
ññ 
[
ññ 
$str
ññ %
]
ññ% &
=
ññ' (
reader
ññ) /
[
ññ/ 0
$str
ññ0 =
]
ññ= >
;
ññ> ?
row
óó 
[
óó 
$str
óó "
]
óó" #
=
óó$ %
reader
óó& ,
[
óó, -
$str
óó- 7
]
óó7 8
;
óó8 9
dt
ôô 
.
ôô 
Rows
ôô 
.
ôô 
Add
ôô 
(
ôô  
row
ôô  #
)
ôô# $
;
ôô$ %
}
õõ 
}
ùù 
return
üü 
dt
üü 
;
üü 
}
°° 	
public
££ 
static
££	 
IDataReader
££ 
GetGlobalContent
££ ,
(
££, -
int
££- 0
siteId
££1 7
)
££7 8
{
§§  
SqlParameterHelper
•• 
sph
•• 
=
•• 
new
••  
SqlParameterHelper
••  2
(
••2 3
ConnectionString
••3 C
.
••C D%
GetReadConnectionString
••D [
(
••[ \
)
••\ ]
,
••] ^
$str
••_ 
,•• Ä
$num••Å Ç
)••Ç É
;••É Ñ
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ 
(
¶¶ 
$str
¶¶ #
,
¶¶# $
	SqlDbType
¶¶% .
.
¶¶. /
Int
¶¶/ 2
,
¶¶2 3 
ParameterDirection
¶¶4 F
.
¶¶F G
Input
¶¶G L
,
¶¶L M
siteId
¶¶N T
)
¶¶T U
;
¶¶U V
return
ßß 	
sph
ßß
 
.
ßß 
ExecuteReader
ßß 
(
ßß 
)
ßß 
;
ßß 
}
®® 
}
©© 
}™™ æ¯
rD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModuleDefinition.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModuleDefinition *
{ 
public 
static 
int 
AddModuleDefinition -
(- .
Guid 
featureGuid 
, 
int 
siteId 
, 
string   
featureName   
,   
string!! 

controlSrc!! 
,!! 
int"" 
	sortOrder"" 
,"" 
int## 
defaultCacheTime##  
,##  !
String$$ 
icon$$ 
,$$ 
bool%% 
isAdmin%% 
,%% 
string&& 
resourceFile&& 
,&&  
bool'' 
isCacheable'' 
,'' 
bool(( 
isSearchable(( 
,(( 
string)) 
searchListName)) !
,))! "
bool** 
supportsPageReuse** "
,**" #
string++ 
deleteProvider++ !
,++! "
string,, 
partialView,, 
,,, 
string-- 	
skinFileName--
 
)-- 
{.. 	
SqlParameterHelper// 
sph// "
=//# $
new//% (
SqlParameterHelper//) ;
(//; <
ConnectionString//< L
.//L M$
GetWriteConnectionString//M e
(//e f
)//f g
,//g h
$str	//i Ü
,
//Ü á
$num
//à ä
)
//ä ã
;
//ã å
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# ,
,00, -
	SqlDbType00. 7
.007 8
Int008 ;
,00; <
ParameterDirection00= O
.00O P
Input00P U
,00U V
siteId00W ]
)00] ^
;00^ _
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 1
,111 2
	SqlDbType113 <
.11< =
NVarChar11= E
,11E F
$num11G J
,11J K
ParameterDirection11L ^
.11^ _
Input11_ d
,11d e
featureName11f q
)11q r
;11r s
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# 0
,220 1
	SqlDbType222 ;
.22; <
NVarChar22< D
,22D E
$num22F I
,22I J
ParameterDirection22K ]
.22] ^
Input22^ c
,22c d

controlSrc22e o
)22o p
;22p q
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
Int33; >
,33> ?
ParameterDirection33@ R
.33R S
Input33S X
,33X Y
	sortOrder33Z c
)33c d
;33d e
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# -
,44- .
	SqlDbType44/ 8
.448 9
Bit449 <
,44< =
ParameterDirection44> P
.44P Q
Input44Q V
,44V W
isAdmin44X _
)44_ `
;44` a
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# *
,55* +
	SqlDbType55, 5
.555 6
NVarChar556 >
,55> ?
$num55@ C
,55C D
ParameterDirection55E W
.55W X
Input55X ]
,55] ^
icon55_ c
)55c d
;55d e
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 6
,666 7
	SqlDbType668 A
.66A B
Int66B E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
defaultCacheTime66a q
)66q r
;66r s
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 1
,771 2
	SqlDbType773 <
.77< =
UniqueIdentifier77= M
,77M N
ParameterDirection77O a
.77a b
Input77b g
,77g h
featureGuid77i t
)77t u
;77u v
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# 2
,882 3
	SqlDbType884 =
.88= >
NVarChar88> F
,88F G
$num88H K
,88K L
ParameterDirection88M _
.88_ `
Input88` e
,88e f
resourceFile88g s
)88s t
;88t u
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# 1
,991 2
	SqlDbType993 <
.99< =
Bit99= @
,99@ A
ParameterDirection99B T
.99T U
Input99U Z
,99Z [
isCacheable99\ g
)99g h
;99h i
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 2
,::2 3
	SqlDbType::4 =
.::= >
Bit::> A
,::A B
ParameterDirection::C U
.::U V
Input::V [
,::[ \
isSearchable::] i
)::i j
;::j k
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# 4
,;;4 5
	SqlDbType;;6 ?
.;;? @
NVarChar;;@ H
,;;H I
$num;;J M
,;;M N
ParameterDirection;;O a
.;;a b
Input;;b g
,;;g h
searchListName;;i w
);;w x
;;;x y
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# 7
,<<7 8
	SqlDbType<<9 B
.<<B C
Bit<<C F
,<<F G
ParameterDirection<<H Z
.<<Z [
Input<<[ `
,<<` a
supportsPageReuse<<b s
)<<s t
;<<t u
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 4
,==4 5
	SqlDbType==6 ?
.==? @
NVarChar==@ H
,==H I
$num==J M
,==M N
ParameterDirection==O a
.==a b
Input==b g
,==g h
deleteProvider==i w
)==w x
;==x y
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
NVarChar>>= E
,>>E F
$num>>G J
,>>J K
ParameterDirection>>L ^
.>>^ _
Input>>_ d
,>>d e
partialView>>f q
)>>q r
;>>r s
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 2
,??2 3
	SqlDbType??4 =
.??= >
NVarChar??> F
,??F G
$num??H K
,??K L
ParameterDirection??M _
.??_ `
Input??` e
,??e f
skinFileName??g s
)??s t
;??t u
intBB 
newIDBB 
=BB 
ConvertBB 
.BB 
ToInt32BB 
(BB 
sphBB "
.BB" #
ExecuteScalarBB# 0
(BB0 1
)BB1 2
)BB2 3
;BB3 4
returnCC 
newIDCC 
;CC 
}DD 	
publicFF 
staticFF 
boolFF "
UpdateModuleDefinitionFF 1
(FF1 2
intGG 
moduleDefIdGG 
,GG 
stringHH 
featureNameHH 
,HH 
stringII 

controlSrcII 
,II 
intJJ 
	sortOrderJJ 
,JJ 
intKK 
defaultCacheTimeKK  
,KK  !
stringLL 
iconLL 
,LL 
boolMM 
isAdminMM 
,MM 
stringNN 
resourceFileNN 
,NN  
boolOO 
isCacheableOO 
,OO 
boolPP 
isSearchablePP 
,PP 
stringQQ 
searchListNameQQ !
,QQ! "
boolRR 
supportsPageReuseRR "
,RR" #
stringSS 
deleteProviderSS !
,SS! "
stringTT 
partialViewTT 
,TT 
stringUU 	
skinFileNameUU
 
)UU 
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M$
GetWriteConnectionStringWWM e
(WWe f
)WWf g
,WWg h
$str	WWi Ü
,
WWÜ á
$num
WWà ä
)
WWä ã
;
WWã å
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 1
,XX1 2
	SqlDbTypeXX3 <
.XX< =
IntXX= @
,XX@ A
ParameterDirectionXXB T
.XXT U
InputXXU Z
,XXZ [
moduleDefIdXX\ g
)XXg h
;XXh i
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 1
,YY1 2
	SqlDbTypeYY3 <
.YY< =
NVarCharYY= E
,YYE F
$numYYG J
,YYJ K
ParameterDirectionYYL ^
.YY^ _
InputYY_ d
,YYd e
featureNameYYf q
)YYq r
;YYr s
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 0
,ZZ0 1
	SqlDbTypeZZ2 ;
.ZZ; <
NVarCharZZ< D
,ZZD E
$numZZF I
,ZZI J
ParameterDirectionZZK ]
.ZZ] ^
InputZZ^ c
,ZZc d

controlSrcZZe o
)ZZo p
;ZZp q
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# /
,[[/ 0
	SqlDbType[[1 :
.[[: ;
Int[[; >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
	sortOrder[[Z c
)[[c d
;[[d e
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# -
,\\- .
	SqlDbType\\/ 8
.\\8 9
Bit\\9 <
,\\< =
ParameterDirection\\> P
.\\P Q
Input\\Q V
,\\V W
isAdmin\\X _
)\\_ `
;\\` a
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
NVarChar]]6 >
,]]> ?
$num]]@ C
,]]C D
ParameterDirection]]E W
.]]W X
Input]]X ]
,]]] ^
icon]]_ c
)]]c d
;]]d e
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 6
,^^6 7
	SqlDbType^^8 A
.^^A B
Int^^B E
,^^E F
ParameterDirection^^G Y
.^^Y Z
Input^^Z _
,^^_ `
defaultCacheTime^^a q
)^^q r
;^^r s
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 2
,__2 3
	SqlDbType__4 =
.__= >
NVarChar__> F
,__F G
$num__H K
,__K L
ParameterDirection__M _
.___ `
Input__` e
,__e f
resourceFile__g s
)__s t
;__t u
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 1
,``1 2
	SqlDbType``3 <
.``< =
Bit``= @
,``@ A
ParameterDirection``B T
.``T U
Input``U Z
,``Z [
isCacheable``\ g
)``g h
;``h i
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
Bitaa> A
,aaA B
ParameterDirectionaaC U
.aaU V
InputaaV [
,aa[ \
isSearchableaa] i
)aai j
;aaj k
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 4
,bb4 5
	SqlDbTypebb6 ?
.bb? @
NVarCharbb@ H
,bbH I
$numbbJ M
,bbM N
ParameterDirectionbbO a
.bba b
Inputbbb g
,bbg h
searchListNamebbi w
)bbw x
;bbx y
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 7
,cc7 8
	SqlDbTypecc9 B
.ccB C
BitccC F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
supportsPageReuseccb s
)ccs t
;cct u
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 4
,dd4 5
	SqlDbTypedd6 ?
.dd? @
NVarChardd@ H
,ddH I
$numddJ M
,ddM N
ParameterDirectionddO a
.dda b
Inputddb g
,ddg h
deleteProviderddi w
)ddw x
;ddx y
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# 1
,ee1 2
	SqlDbTypeee3 <
.ee< =
NVarCharee= E
,eeE F
$numeeG J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e
partialVieweef q
)eeq r
;eer s
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 2
,ff2 3
	SqlDbTypeff4 =
.ff= >
NVarCharff> F
,ffF G
$numffH K
,ffK L
ParameterDirectionffM _
.ff_ `
Inputff` e
,ffe f
skinFileNameffg s
)ffs t
;fft u
intgg 
rowsAffectedgg 
=gg 
sphgg 
.gg 
ExecuteNonQuerygg )
(gg) *
)gg* +
;gg+ ,
returnhh 
(hh 
rowsAffectedhh  
>hh! "
-hh# $
$numhh$ %
)hh% &
;hh& '
}ii 	
publickk 
statickk 
boolkk '
UpdateSiteModulePermissionskk 6
(kk6 7
intkk7 :
siteIdkk; A
,kkA B
intkkC F
moduleDefIdkkG R
,kkR S
stringkkT Z
authorizedRoleskk[ j
)kkj k
{ll 	
SqlParameterHelpermm 
sphmm "
=mm# $
newmm% (
SqlParameterHelpermm) ;
(mm; <
ConnectionStringmm< L
.mmL M$
GetWriteConnectionStringmmM e
(mme f
)mmf g
,mmg h
$str	mmi ä
,
mmä ã
$num
mmå ç
)
mmç é
;
mmé è
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# ,
,nn, -
	SqlDbTypenn. 7
.nn7 8
Intnn8 ;
,nn; <
ParameterDirectionnn= O
.nnO P
InputnnP U
,nnU V
siteIdnnW ]
)nn] ^
;nn^ _
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 1
,oo1 2
	SqlDbTypeoo3 <
.oo< =
Intoo= @
,oo@ A
ParameterDirectionooB T
.ooT U
InputooU Z
,ooZ [
moduleDefIdoo\ g
)oog h
;ooh i
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 5
,pp5 6
	SqlDbTypepp7 @
.pp@ A
NVarCharppA I
,ppI J
-ppK L
$numppL M
,ppM N
ParameterDirectionppO a
.ppa b
Inputppb g
,ppg h
authorizedRolesppi x
)ppx y
;ppy z
intqq 
rowsAffectedqq 
=qq 
sphqq "
.qq" #
ExecuteNonQueryqq# 2
(qq2 3
)qq3 4
;qq4 5
returnrr 
(rr 
rowsAffectedrr  
>rr! "
-rr# $
$numrr$ %
)rr% &
;rr& '
}tt 	
publicvv 
staticvv 
boolvv "
DeleteModuleDefinitionvv 1
(vv1 2
intvv2 5
moduleDefIdvv6 A
)vvA B
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M$
GetWriteConnectionStringxxM e
(xxe f
)xxf g
,xxg h
$str	xxi Ü
,
xxÜ á
$num
xxà â
)
xxâ ä
;
xxä ã
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 1
,yy1 2
	SqlDbTypeyy3 <
.yy< =
Intyy= @
,yy@ A
ParameterDirectionyyB T
.yyT U
InputyyU Z
,yyZ [
moduleDefIdyy\ g
)yyg h
;yyh i
intzz 
rowsAffectedzz 
=zz 
sphzz "
.zz" #
ExecuteNonQueryzz# 2
(zz2 3
)zz3 4
;zz4 5
return{{ 
({{ 
rowsAffected{{  
>{{! "
-{{# $
$num{{$ %
){{% &
;{{& '
}|| 	
public~~ 
static~~ 
bool~~ +
DeleteModuleDefinitionFromSites~~ :
(~~: ;
int~~; >
moduleDefId~~? J
)~~J K
{ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M&
GetWriteConnectionString
ÄÄM e
(
ÄÄe f
)
ÄÄf g
,
ÄÄg h
$strÄÄi ì
,ÄÄì î
$numÄÄï ñ
)ÄÄñ ó
;ÄÄó ò
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 1
,
ÅÅ1 2
	SqlDbType
ÅÅ3 <
.
ÅÅ< =
Int
ÅÅ= @
,
ÅÅ@ A 
ParameterDirection
ÅÅB T
.
ÅÅT U
Input
ÅÅU Z
,
ÅÅZ [
moduleDefId
ÅÅ\ g
)
ÅÅg h
;
ÅÅh i
int
ÇÇ 
rowsAffected
ÇÇ 
=
ÇÇ 
sph
ÇÇ "
.
ÇÇ" #
ExecuteNonQuery
ÇÇ# 2
(
ÇÇ2 3
)
ÇÇ3 4
;
ÇÇ4 5
return
ÉÉ 
(
ÉÉ 
rowsAffected
ÉÉ  
>
ÉÉ! "
-
ÉÉ# $
$num
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ 
DeleteSettingById
ÜÜ ,
(
ÜÜ, -
int
ÜÜ- 0
id
ÜÜ1 3
)
ÜÜ3 4
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M&
GetWriteConnectionString
ààM e
(
ààe f
)
ààf g
,
ààg h
$stràài ë
,ààë í
$numààì î
)ààî ï
;ààï ñ
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# (
,
ââ( )
	SqlDbType
ââ* 3
.
ââ3 4
Int
ââ4 7
,
ââ7 8 
ParameterDirection
ââ9 K
.
ââK L
Input
ââL Q
,
ââQ R
id
ââS U
)
ââU V
;
ââV W
int
ää 
rowsAffected
ää 
=
ää 
sph
ää "
.
ää" #
ExecuteNonQuery
ää# 2
(
ää2 3
)
ää3 4
;
ää4 5
return
ãã 
(
ãã 
rowsAffected
ãã  
>
ãã! "
-
ãã# $
$num
ãã$ %
)
ãã% &
;
ãã& '
}
åå 	
public
éé 
static
éé 
bool
éé %
DeleteSettingsByFeature
éé 2
(
éé2 3
int
éé3 6
moduleDefId
éé7 B
)
ééB C
{
èè 	 
SqlParameterHelper
êê 
sph
êê "
=
êê# $
new
êê% ( 
SqlParameterHelper
êê) ;
(
êê; <
ConnectionString
êê< L
.
êêL M&
GetWriteConnectionString
êêM e
(
êêe f
)
êêf g
,
êêg h
$strêêi ñ
,êêñ ó
$numêêò ô
)êêô ö
;êêö õ
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 1
,
ëë1 2
	SqlDbType
ëë3 <
.
ëë< =
Int
ëë= @
,
ëë@ A 
ParameterDirection
ëëB T
.
ëëT U
Input
ëëU Z
,
ëëZ [
moduleDefId
ëë\ g
)
ëëg h
;
ëëh i
int
íí 
rowsAffected
íí 
=
íí 
sph
íí "
.
íí" #
ExecuteNonQuery
íí# 2
(
íí2 3
)
íí3 4
;
íí4 5
return
ìì 
(
ìì 
rowsAffected
ìì  
>
ìì! "
-
ìì# $
$num
ìì$ %
)
ìì% &
;
ìì& '
}
îî 	
public
ññ 
static
ññ 
IDataReader
ññ !!
GetModuleDefinition
ññ" 5
(
ññ5 6
int
óó 
moduleDefId
óó 
)
óó  
{
òò 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M%
GetReadConnectionString
ôôM d
(
ôôd e
)
ôôe f
,
ôôf g
$strôôh à
,ôôà â
$numôôä ã
)ôôã å
;ôôå ç
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 1
,
öö1 2
	SqlDbType
öö3 <
.
öö< =
Int
öö= @
,
öö@ A 
ParameterDirection
ööB T
.
ööT U
Input
ööU Z
,
ööZ [
moduleDefId
öö\ g
)
öög h
;
ööh i
return
õõ 
sph
õõ 
.
õõ 
ExecuteReader
õõ $
(
õõ$ %
)
õõ% &
;
õõ& '
}
úú 	
public
ûû 
static
ûû 
IDataReader
ûû !!
GetModuleDefinition
ûû" 5
(
ûû5 6
Guid
üü 
featureGuid
üü 
)
üü 
{
†† 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h é
,°°é è
$num°°ê ë
)°°ë í
;°°í ì
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 1
,
¢¢1 2
	SqlDbType
¢¢3 <
.
¢¢< =
UniqueIdentifier
¢¢= M
,
¢¢M N 
ParameterDirection
¢¢O a
.
¢¢a b
Input
¢¢b g
,
¢¢g h
featureGuid
¢¢i t
)
¢¢t u
;
¢¢u v
return
££ 
sph
££ 
.
££ 
ExecuteReader
££ $
(
££$ %
)
££% &
;
££& '
}
§§ 	
public
¶¶ 
static
¶¶ 
void
¶¶ ,
EnsureInstallationInAdminSites
¶¶ 9
(
¶¶9 :
)
¶¶: ;
{
ßß 	
new
®®  
SqlParameterHelper
®® "
(
®®" #
ConnectionString
®®# 3
.
®®3 4&
GetWriteConnectionString
®®4 L
(
®®L M
)
®®M N
,
®®N O
$str
®®P ~
,
®®~ 
$num®®Ä Å
)®®Å Ç
.®®Ç É
ExecuteNonQuery®®É í
(®®í ì
)®®ì î
;®®î ï
}
©© 	
public
´´ 
static
´´ 
IDataReader
´´ !"
GetModuleDefinitions
´´" 6
(
´´6 7
Guid
´´7 ;
siteGuid
´´< D
)
´´D E
{
¨¨ 	 
SqlParameterHelper
≠≠ 
sph
≠≠ "
=
≠≠# $
new
≠≠% ( 
SqlParameterHelper
≠≠) ;
(
≠≠; <
ConnectionString
≠≠< L
.
≠≠L M%
GetReadConnectionString
≠≠M d
(
≠≠d e
)
≠≠e f
,
≠≠f g
$str≠≠h Ö
,≠≠Ö Ü
$num≠≠á à
)≠≠à â
;≠≠â ä
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# .
,
ÆÆ. /
	SqlDbType
ÆÆ0 9
.
ÆÆ9 :
UniqueIdentifier
ÆÆ: J
,
ÆÆJ K 
ParameterDirection
ÆÆL ^
.
ÆÆ^ _
Input
ÆÆ_ d
,
ÆÆd e
siteGuid
ÆÆf n
)
ÆÆn o
;
ÆÆo p
return
ØØ 
sph
ØØ 
.
ØØ 
ExecuteReader
ØØ $
(
ØØ$ %
)
ØØ% &
;
ØØ& '
}
∞∞ 	
public
≤≤ 
static
≤≤ 
	DataTable
≤≤ (
GetModuleDefinitionsBySite
≤≤  :
(
≤≤: ;
Guid
≤≤; ?
siteGuid
≤≤@ H
)
≤≤H I
{
≥≥ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M%
GetReadConnectionString
¥¥M d
(
¥¥d e
)
¥¥e f
,
¥¥f g
$str¥¥h Ö
,¥¥Ö Ü
$num¥¥á à
)¥¥à â
;¥¥â ä
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
	DataTable
∑∑ 
dt
∑∑ 
=
∑∑ 
new
∑∑ 
	DataTable
∑∑ (
(
∑∑( )
)
∑∑) *
;
∑∑* +
dt
∏∏ 
.
∏∏ 
Columns
∏∏ 
.
∏∏ 
Add
∏∏ 
(
∏∏ 
$str
∏∏ (
,
∏∏( )
typeof
∏∏* 0
(
∏∏0 1
int
∏∏1 4
)
∏∏4 5
)
∏∏5 6
;
∏∏6 7
dt
ππ 
.
ππ 
Columns
ππ 
.
ππ 
Add
ππ 
(
ππ 
$str
ππ (
,
ππ( )
typeof
ππ* 0
(
ππ0 1
String
ππ1 7
)
ππ7 8
)
ππ8 9
;
ππ9 :
dt
∫∫ 
.
∫∫ 
Columns
∫∫ 
.
∫∫ 
Add
∫∫ 
(
∫∫ 
$str
∫∫ (
,
∫∫( )
typeof
∫∫* 0
(
∫∫0 1
String
∫∫1 7
)
∫∫7 8
)
∫∫8 9
;
∫∫9 :
dt
ªª 
.
ªª 
Columns
ªª 
.
ªª 
Add
ªª 
(
ªª 
$str
ªª '
,
ªª' (
typeof
ªª) /
(
ªª/ 0
String
ªª0 6
)
ªª6 7
)
ªª7 8
;
ªª8 9
dt
ºº 
.
ºº 
Columns
ºº 
.
ºº 
Add
ºº 
(
ºº 
$str
ºº ,
,
ºº, -
typeof
ºº. 4
(
ºº4 5
String
ºº5 ;
)
ºº; <
)
ºº< =
;
ºº= >
using
ææ 
(
ææ 
IDataReader
ææ 
reader
ææ %
=
ææ& '
sph
ææ( +
.
ææ+ ,
ExecuteReader
ææ, 9
(
ææ9 :
)
ææ: ;
)
ææ; <
{
øø 
while
¿¿ 
(
¿¿ 
reader
¿¿ 
.
¿¿ 
Read
¿¿ "
(
¿¿" #
)
¿¿# $
)
¿¿$ %
{
¡¡ 
DataRow
¬¬ 
row
¬¬ 
=
¬¬  !
dt
¬¬" $
.
¬¬$ %
NewRow
¬¬% +
(
¬¬+ ,
)
¬¬, -
;
¬¬- .
row
√√ 
[
√√ 
$str
√√ %
]
√√% &
=
√√' (
reader
√√) /
[
√√/ 0
$str
√√0 =
]
√√= >
;
√√> ?
row
ƒƒ 
[
ƒƒ 
$str
ƒƒ %
]
ƒƒ% &
=
ƒƒ' (
reader
ƒƒ) /
[
ƒƒ/ 0
$str
ƒƒ0 6
]
ƒƒ6 7
.
ƒƒ7 8
ToString
ƒƒ8 @
(
ƒƒ@ A
)
ƒƒA B
;
ƒƒB C
row
≈≈ 
[
≈≈ 
$str
≈≈ %
]
≈≈% &
=
≈≈' (
reader
≈≈) /
[
≈≈/ 0
$str
≈≈0 =
]
≈≈= >
;
≈≈> ?
row
∆∆ 
[
∆∆ 
$str
∆∆ $
]
∆∆$ %
=
∆∆& '
reader
∆∆( .
[
∆∆. /
$str
∆∆/ ;
]
∆∆; <
;
∆∆< =
row
«« 
[
«« 
$str
«« )
]
««) *
=
««+ ,
reader
««- 3
[
««3 4
$str
««4 E
]
««E F
;
««F G
dt
»» 
.
»» 
Rows
»» 
.
»» 
Add
»» 
(
»»  
row
»»  #
)
»»# $
;
»»$ %
}
…… 
}
   
return
ÀÀ 
dt
ÀÀ 
;
ÀÀ 
}
ÃÃ 	
public
ŒŒ 
static
ŒŒ	 
IDataReader
ŒŒ /
!GetModuleDefinitionBySkinFileName
ŒŒ =
(
ŒŒ= >
string
ŒŒ> D
skinFileName
ŒŒE Q
)
ŒŒQ R
{
œœ  
SqlParameterHelper
–– 
sph
–– 
=
–– 
new
––  
SqlParameterHelper
––  2
(
––2 3
ConnectionString
––3 C
.
––C D%
GetReadConnectionString
––D [
(
––[ \
)
––\ ]
,
––] ^
$str––_ ç
,––ç é
$num––è ê
)––ê ë
;––ë í
sph
—— 
.
——  
DefineSqlParameter
—— 
(
—— 
$str
—— )
,
——) *
	SqlDbType
——+ 4
.
——4 5
NVarChar
——5 =
,
——= > 
ParameterDirection
——? Q
.
——Q R
Input
——R W
,
——W X
skinFileName
——Y e
)
——e f
;
——f g
return
““ 	
sph
““
 
.
““ 
ExecuteReader
““ 
(
““ 
)
““ 
;
““ 
}
”” 
public
’’ 
static
’’	 
IDataReader
’’ '
GetAllModuleSkinFileNames
’’ 5
(
’’5 6
)
’’6 7
{
÷÷  
SqlParameterHelper
◊◊ 
sph
◊◊ 
=
◊◊ 
new
◊◊  
SqlParameterHelper
◊◊  2
(
◊◊2 3
ConnectionString
◊◊3 C
.
◊◊C D%
GetReadConnectionString
◊◊D [
(
◊◊[ \
)
◊◊\ ]
,
◊◊] ^
$str◊◊_ Ü
,◊◊Ü á
$num◊◊à â
)◊◊â ä
;◊◊ä ã
return
ÿÿ 	
sph
ÿÿ
 
.
ÿÿ 
ExecuteReader
ÿÿ 
(
ÿÿ 
)
ÿÿ 
;
ÿÿ 
}
ŸŸ 
public
€€ 
static
€€	 
IDataReader
€€ 
GetUserModules
€€ *
(
€€* +
int
€€+ .
siteId
€€/ 5
)
€€5 6
{
‹‹ 	 
SqlParameterHelper
›› 
sph
›› "
=
››# $
new
››% ( 
SqlParameterHelper
››) ;
(
››; <
ConnectionString
››< L
.
››L M%
GetReadConnectionString
››M d
(
››d e
)
››e f
,
››f g
$str››h ê
,››ê ë
$num››í ì
)››ì î
;››î ï
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# ,
,
ﬁﬁ, -
	SqlDbType
ﬁﬁ. 7
.
ﬁﬁ7 8
Int
ﬁﬁ8 ;
,
ﬁﬁ; < 
ParameterDirection
ﬁﬁ= O
.
ﬁﬁO P
Input
ﬁﬁP U
,
ﬁﬁU V
siteId
ﬁﬁW ]
)
ﬁﬁ] ^
;
ﬁﬁ^ _
return
ﬂﬂ 
sph
ﬂﬂ 
.
ﬂﬂ 
ExecuteReader
ﬂﬂ $
(
ﬂﬂ$ %
)
ﬂﬂ% &
;
ﬂﬂ& '
}
‡‡ 	
public
‚‚ 
static
‚‚ 
IDataReader
‚‚ !"
GetSearchableModules
‚‚" 6
(
‚‚6 7
int
‚‚7 :
siteId
‚‚; A
)
‚‚A B
{
„„ 	 
SqlParameterHelper
‰‰ 
sph
‰‰ "
=
‰‰# $
new
‰‰% ( 
SqlParameterHelper
‰‰) ;
(
‰‰; <
ConnectionString
‰‰< L
.
‰‰L M%
GetReadConnectionString
‰‰M d
(
‰‰d e
)
‰‰e f
,
‰‰f g
$str‰‰h ñ
,‰‰ñ ó
$num‰‰ò ô
)‰‰ô ö
;‰‰ö õ
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# ,
,
ÂÂ, -
	SqlDbType
ÂÂ. 7
.
ÂÂ7 8
Int
ÂÂ8 ;
,
ÂÂ; < 
ParameterDirection
ÂÂ= O
.
ÂÂO P
Input
ÂÂP U
,
ÂÂU V
siteId
ÂÂW ]
)
ÂÂ] ^
;
ÂÂ^ _
return
ÊÊ 
sph
ÊÊ 
.
ÊÊ 
ExecuteReader
ÊÊ $
(
ÊÊ$ %
)
ÊÊ% &
;
ÊÊ& '
}
ÁÁ 	
public
ÚÚ 
static
ÚÚ 
bool
ÚÚ +
UpdateModuleDefinitionSetting
ÚÚ 8
(
ÚÚ8 9
Guid
ÛÛ 
featureGuid
ÛÛ 
,
ÛÛ 
int
ÙÙ 
moduleDefId
ÙÙ 
,
ÙÙ 
string
ıı 
resourceFile
ıı 
,
ıı  
string
ˆˆ 
	groupName
ˆˆ 
,
ˆˆ 
string
˜˜ 
settingName
˜˜ 
,
˜˜ 
string
¯¯ 
settingValue
¯¯ 
,
¯¯  
string
˘˘ 
controlType
˘˘ 
,
˘˘ 
string
˙˙ '
regexValidationExpression
˙˙ ,
,
˙˙, -
string
˚˚ 

controlSrc
˚˚ 
,
˚˚ 
string
¸¸ 
helpKey
¸¸ 
,
¸¸ 
int
˝˝ 
	sortOrder
˝˝ 
,
˝˝ 
string
˛˛ 	

attributes
˛˛
 
,
˛˛ 
string
ˇˇ 	
options
ˇˇ
 
)
ˇˇ 
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M&
GetWriteConnectionString
ÅÅM e
(
ÅÅe f
)
ÅÅf g
,
ÅÅg h
$strÅÅi ç
,ÅÅç é
$numÅÅè ë
)ÅÅë í
;ÅÅí ì
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 1
,
ÇÇ1 2
	SqlDbType
ÇÇ3 <
.
ÇÇ< =
Int
ÇÇ= @
,
ÇÇ@ A 
ParameterDirection
ÇÇB T
.
ÇÇT U
Input
ÇÇU Z
,
ÇÇZ [
moduleDefId
ÇÇ\ g
)
ÇÇg h
;
ÇÇh i
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 1
,
ÉÉ1 2
	SqlDbType
ÉÉ3 <
.
ÉÉ< =
NVarChar
ÉÉ= E
,
ÉÉE F
$num
ÉÉG I
,
ÉÉI J 
ParameterDirection
ÉÉK ]
.
ÉÉ] ^
Input
ÉÉ^ c
,
ÉÉc d
settingName
ÉÉe p
)
ÉÉp q
;
ÉÉq r
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 2
,
ÑÑ2 3
	SqlDbType
ÑÑ4 =
.
ÑÑ= >
NVarChar
ÑÑ> F
,
ÑÑF G
-
ÑÑH I
$num
ÑÑI J
,
ÑÑJ K 
ParameterDirection
ÑÑL ^
.
ÑÑ^ _
Input
ÑÑ_ d
,
ÑÑd e
settingValue
ÑÑf r
)
ÑÑr s
;
ÑÑs t
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 1
,
ÖÖ1 2
	SqlDbType
ÖÖ3 <
.
ÖÖ< =
NVarChar
ÖÖ= E
,
ÖÖE F
$num
ÖÖG I
,
ÖÖI J 
ParameterDirection
ÖÖK ]
.
ÖÖ] ^
Input
ÖÖ^ c
,
ÖÖc d
controlType
ÖÖe p
)
ÖÖp q
;
ÖÖq r
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# ?
,
ÜÜ? @
	SqlDbType
ÜÜA J
.
ÜÜJ K
NVarChar
ÜÜK S
,
ÜÜS T
-
ÜÜU V
$num
ÜÜV W
,
ÜÜW X 
ParameterDirection
ÜÜY k
.
ÜÜk l
Input
ÜÜl q
,
ÜÜq r(
regexValidationExpressionÜÜs å
)ÜÜå ç
;ÜÜç é
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 1
,
áá1 2
	SqlDbType
áá3 <
.
áá< =
UniqueIdentifier
áá= M
,
ááM N 
ParameterDirection
ááO a
.
ááa b
Input
ááb g
,
áág h
featureGuid
áái t
)
áát u
;
ááu v
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
NVarChar
àà> F
,
ààF G
$num
ààH K
,
ààK L 
ParameterDirection
ààM _
.
àà_ `
Input
àà` e
,
ààe f
resourceFile
ààg s
)
ààs t
;
ààt u
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 0
,
ââ0 1
	SqlDbType
ââ2 ;
.
ââ; <
NVarChar
ââ< D
,
ââD E
$num
ââF I
,
ââI J 
ParameterDirection
ââK ]
.
ââ] ^
Input
ââ^ c
,
ââc d

controlSrc
ââe o
)
ââo p
;
ââp q
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# -
,
ää- .
	SqlDbType
ää/ 8
.
ää8 9
NVarChar
ää9 A
,
ääA B
$num
ääC F
,
ääF G 
ParameterDirection
ääH Z
.
ääZ [
Input
ää[ `
,
ää` a
helpKey
ääb i
)
ääi j
;
ääj k
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# /
,
ãã/ 0
	SqlDbType
ãã1 :
.
ãã: ;
Int
ãã; >
,
ãã> ? 
ParameterDirection
ãã@ R
.
ããR S
Input
ããS X
,
ããX Y
	sortOrder
ããZ c
)
ããc d
;
ããd e
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# /
,
åå/ 0
	SqlDbType
åå1 :
.
åå: ;
NVarChar
åå; C
,
ååC D
$num
ååE H
,
ååH I 
ParameterDirection
ååJ \
.
åå\ ]
Input
åå] b
,
ååb c
	groupName
ååd m
)
ååm n
;
åån o
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
NText
çç< A
,
ççA B 
ParameterDirection
ççC U
.
ççU V
Input
ççV [
,
çç[ \

attributes
çç] g
)
ççg h
;
ççh i
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# -
,
éé- .
	SqlDbType
éé/ 8
.
éé8 9
NText
éé9 >
,
éé> ? 
ParameterDirection
éé@ R
.
ééR S
Input
ééS X
,
ééX Y
options
ééZ a
)
ééa b
;
ééb c
int
êê 
rowsAffected
êê 
=
êê 
sph
êê 
.
êê 
ExecuteNonQuery
êê )
(
êê) *
)
êê* +
;
êê+ ,
return
ëë 
(
ëë 
rowsAffected
ëë  
>
ëë! "
-
ëë# $
$num
ëë$ %
)
ëë% &
;
ëë& '
}
íí 	
public
îî 
static
îî 
bool
îî /
!UpdateModuleDefinitionSettingById
îî <
(
îî< =
int
ïï 
id
ïï 
,
ïï 
int
ññ 
moduleDefId
ññ 
,
ññ 
string
óó 
resourceFile
óó 
,
óó  
string
òò 
	groupName
òò 
,
òò 
string
ôô 
settingName
ôô 
,
ôô 
string
öö 
settingValue
öö 
,
öö  
string
õõ 
controlType
õõ 
,
õõ 
string
úú '
regexValidationExpression
úú ,
,
úú, -
string
ùù 

controlSrc
ùù 
,
ùù 
string
ûû 
helpKey
ûû 
,
ûû 
int
üü 
	sortOrder
üü 
,
üü 
string
†† 	

attributes
††
 
,
†† 
string
°° 	
options
°°
 
)
°° 
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i ë
,££ë í
$num££ì ï
)££ï ñ
;££ñ ó
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# (
,
§§( )
	SqlDbType
§§* 3
.
§§3 4
Int
§§4 7
,
§§7 8 
ParameterDirection
§§9 K
.
§§K L
Input
§§L Q
,
§§Q R
id
§§S U
)
§§U V
;
§§V W
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# 1
,
••1 2
	SqlDbType
••3 <
.
••< =
Int
••= @
,
••@ A 
ParameterDirection
••B T
.
••T U
Input
••U Z
,
••Z [
moduleDefId
••\ g
)
••g h
;
••h i
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# 1
,
¶¶1 2
	SqlDbType
¶¶3 <
.
¶¶< =
NVarChar
¶¶= E
,
¶¶E F
$num
¶¶G I
,
¶¶I J 
ParameterDirection
¶¶K ]
.
¶¶] ^
Input
¶¶^ c
,
¶¶c d
settingName
¶¶e p
)
¶¶p q
;
¶¶q r
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 2
,
ßß2 3
	SqlDbType
ßß4 =
.
ßß= >
NVarChar
ßß> F
,
ßßF G
-
ßßH I
$num
ßßI J
,
ßßJ K 
ParameterDirection
ßßL ^
.
ßß^ _
Input
ßß_ d
,
ßßd e
settingValue
ßßf r
)
ßßr s
;
ßßs t
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 1
,
®®1 2
	SqlDbType
®®3 <
.
®®< =
NVarChar
®®= E
,
®®E F
$num
®®G I
,
®®I J 
ParameterDirection
®®K ]
.
®®] ^
Input
®®^ c
,
®®c d
controlType
®®e p
)
®®p q
;
®®q r
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ?
,
©©? @
	SqlDbType
©©A J
.
©©J K
NVarChar
©©K S
,
©©S T
-
©©U V
$num
©©V W
,
©©W X 
ParameterDirection
©©Y k
.
©©k l
Input
©©l q
,
©©q r(
regexValidationExpression©©s å
)©©å ç
;©©ç é
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# 2
,
™™2 3
	SqlDbType
™™4 =
.
™™= >
NVarChar
™™> F
,
™™F G
$num
™™H K
,
™™K L 
ParameterDirection
™™M _
.
™™_ `
Input
™™` e
,
™™e f
resourceFile
™™g s
)
™™s t
;
™™t u
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 0
,
´´0 1
	SqlDbType
´´2 ;
.
´´; <
NVarChar
´´< D
,
´´D E
$num
´´F I
,
´´I J 
ParameterDirection
´´K ]
.
´´] ^
Input
´´^ c
,
´´c d

controlSrc
´´e o
)
´´o p
;
´´p q
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# -
,
¨¨- .
	SqlDbType
¨¨/ 8
.
¨¨8 9
NVarChar
¨¨9 A
,
¨¨A B
$num
¨¨C F
,
¨¨F G 
ParameterDirection
¨¨H Z
.
¨¨Z [
Input
¨¨[ `
,
¨¨` a
helpKey
¨¨b i
)
¨¨i j
;
¨¨j k
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# /
,
≠≠/ 0
	SqlDbType
≠≠1 :
.
≠≠: ;
Int
≠≠; >
,
≠≠> ? 
ParameterDirection
≠≠@ R
.
≠≠R S
Input
≠≠S X
,
≠≠X Y
	sortOrder
≠≠Z c
)
≠≠c d
;
≠≠d e
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# /
,
ÆÆ/ 0
	SqlDbType
ÆÆ1 :
.
ÆÆ: ;
NVarChar
ÆÆ; C
,
ÆÆC D
$num
ÆÆE H
,
ÆÆH I 
ParameterDirection
ÆÆJ \
.
ÆÆ\ ]
Input
ÆÆ] b
,
ÆÆb c
	groupName
ÆÆd m
)
ÆÆm n
;
ÆÆn o
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 0
,
ØØ0 1
	SqlDbType
ØØ2 ;
.
ØØ; <
NText
ØØ< A
,
ØØA B 
ParameterDirection
ØØC U
.
ØØU V
Input
ØØV [
,
ØØ[ \

attributes
ØØ] g
)
ØØg h
;
ØØh i
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# -
,
∞∞- .
	SqlDbType
∞∞/ 8
.
∞∞8 9
NText
∞∞9 >
,
∞∞> ? 
ParameterDirection
∞∞@ R
.
∞∞R S
Input
∞∞S X
,
∞∞X Y
options
∞∞Z a
)
∞∞a b
;
∞∞b c
int
±± 
rowsAffected
±± 
=
±± 
sph
±± 
.
±± 
ExecuteNonQuery
±± )
(
±±) *
)
±±* +
;
±±+ ,
return
≤≤ 
(
≤≤ 
rowsAffected
≤≤  
>
≤≤! "
-
≤≤# $
$num
≤≤$ %
)
≤≤% &
;
≤≤& '
}
≥≥ 	
public
∂∂ 
static
∂∂ 
IDataReader
∂∂ !0
"ModuleDefinitionSettingsGetSetting
∂∂" D
(
∂∂D E
Guid
∑∑ 
featureGuid
∑∑ 
,
∑∑ 
string
∏∏ 
settingName
∏∏ 
)
∏∏ 
{
ππ 	 
SqlParameterHelper
∫∫ 
sph
∫∫ "
=
∫∫# $
new
∫∫% ( 
SqlParameterHelper
∫∫) ;
(
∫∫; <
ConnectionString
∫∫< L
.
∫∫L M%
GetReadConnectionString
∫∫M d
(
∫∫d e
)
∫∫e f
,
∫∫f g
$str∫∫h è
,∫∫è ê
$num∫∫ë í
)∫∫í ì
;∫∫ì î
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 1
,
ªª1 2
	SqlDbType
ªª3 <
.
ªª< =
UniqueIdentifier
ªª= M
,
ªªM N 
ParameterDirection
ªªO a
.
ªªa b
Input
ªªb g
,
ªªg h
featureGuid
ªªi t
)
ªªt u
;
ªªu v
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 1
,
ºº1 2
	SqlDbType
ºº3 <
.
ºº< =
NVarChar
ºº= E
,
ººE F
$num
ººG I
,
ººI J 
ParameterDirection
ººK ]
.
ºº] ^
Input
ºº^ c
,
ººc d
settingName
ººe p
)
ººp q
;
ººq r
return
ΩΩ 
sph
ΩΩ 
.
ΩΩ 
ExecuteReader
ΩΩ $
(
ΩΩ$ %
)
ΩΩ% &
;
ΩΩ& '
}
ææ 	
}
¬¬ 
}√√ €\
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModuleSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModuleSettings (
{ 
public 
static 
IDataReader !
GetModuleSettings" 3
(3 4
int4 7
moduleId8 @
)@ A
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h Ç
,
Ç É
$num
Ñ Ö
)
Ö Ü
;
Ü á
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
Int: =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
moduleIdY a
)a b
;b c
return 
sph 
. 
ExecuteReader $
($ %
)% &
;& '
} 	
public 
static 
IDataReader !$
GetDefaultModuleSettings" :
(: ;
int; >
moduleDefId? J
)J K
{ 	
SqlParameterHelper   
sph   "
=  # $
new  % (
SqlParameterHelper  ) ;
(  ; <
ConnectionString  < L
.  L M#
GetReadConnectionString  M d
(  d e
)  e f
,  f g
$str	  h å
,
  å ç
$num
  é è
)
  è ê
;
  ê ë
sph!! 
.!! 
DefineSqlParameter!! "
(!!" #
$str!!# 1
,!!1 2
	SqlDbType!!3 <
.!!< =
Int!!= @
,!!@ A
ParameterDirection!!B T
.!!T U
Input!!U Z
,!!Z [
moduleDefId!!\ g
)!!g h
;!!h i
return"" 
sph"" 
."" 
ExecuteReader"" $
(""$ %
)""% &
;""& '
}## 	
public%% 
static%% 
bool%% 
CreateModuleSetting%% .
(%%. /
Guid&& 
settingGuid&& 
,&& 
Guid'' 

moduleGuid'' 
,'' 
int(( 
moduleId(( 
,(( 
string)) 
settingName)) 
,)) 
string** 
settingValue** 
,**  
string++ 
controlType++ 
,++ 
string,, %
regexValidationExpression,, ,
,,,, -
string-- 

controlSrc-- 
,-- 
string.. 
helpKey.. 
,.. 
int// 
	sortOrder// 
)// 
{00 	
SqlParameterHelper11 
sph11 "
=11# $
new11% (
SqlParameterHelper11) ;
(11; <
ConnectionString11< L
.11L M$
GetWriteConnectionString11M e
(11e f
)11f g
,11g h
$str	11i É
,
11É Ñ
$num
11Ö á
)
11á à
;
11à â
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 1
,331 2
	SqlDbType333 <
.33< =
UniqueIdentifier33= M
,33M N
ParameterDirection33O a
.33a b
Input33b g
,33g h
settingGuid33i t
)33t u
;33u v
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 0
,440 1
	SqlDbType442 ;
.44; <
UniqueIdentifier44< L
,44L M
ParameterDirection44N `
.44` a
Input44a f
,44f g

moduleGuid44h r
)44r s
;44s t
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
Int55: =
,55= >
ParameterDirection55? Q
.55Q R
Input55R W
,55W X
moduleId55Y a
)55a b
;55b c
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 1
,661 2
	SqlDbType663 <
.66< =
NVarChar66= E
,66E F
$num66G I
,66I J
ParameterDirection66K ]
.66] ^
Input66^ c
,66c d
settingName66e p
)66p q
;66q r
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 2
,772 3
	SqlDbType774 =
.77= >
NVarChar77> F
,77F G
-77H I
$num77I J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
settingValue77f r
)77r s
;77s t
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# 1
,881 2
	SqlDbType883 <
.88< =
NVarChar88= E
,88E F
$num88G I
,88I J
ParameterDirection88K ]
.88] ^
Input88^ c
,88c d
controlType88e p
)88p q
;88q r
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# ?
,99? @
	SqlDbType99A J
.99J K
NVarChar99K S
,99S T
-99U V
$num99V W
,99W X
ParameterDirection99Y k
.99k l
Input99l q
,99q r&
regexValidationExpression	99s å
)
99å ç
;
99ç é
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
NVarChar::< D
,::D E
$num::F I
,::I J
ParameterDirection::K ]
.::] ^
Input::^ c
,::c d

controlSrc::e o
)::o p
;::p q
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# -
,;;- .
	SqlDbType;;/ 8
.;;8 9
NVarChar;;9 A
,;;A B
$num;;C F
,;;F G
ParameterDirection;;H Z
.;;Z [
Input;;[ `
,;;` a
helpKey;;b i
);;i j
;;;j k
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# /
,<</ 0
	SqlDbType<<1 :
.<<: ;
Int<<; >
,<<> ?
ParameterDirection<<@ R
.<<R S
Input<<S X
,<<X Y
	sortOrder<<Z c
)<<c d
;<<d e
int>> 
rowsAffected>> 
=>> 
sph>> 
.>> 
ExecuteNonQuery>> )
(>>) *
)>>* +
;>>+ ,
return?? 
(?? 
rowsAffected??  
>??! "
-??# $
$num??$ %
)??% &
;??& '
}@@ 	
publicBB 
staticBB 
boolBB 
UpdateModuleSettingBB .
(BB. /
GuidCC 

moduleGuidCC 
,CC 
intDD 
moduleIdDD 
,DD 
stringEE 
settingNameEE 
,EE 
stringFF 
settingValueFF 
)FF  
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi É
,
HHÉ Ñ
$num
HHÖ Ü
)
HHÜ á
;
HHá à
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# 0
,II0 1
	SqlDbTypeII2 ;
.II; <
UniqueIdentifierII< L
,IIL M
ParameterDirectionIIN `
.II` a
InputIIa f
,IIf g

moduleGuidIIh r
)IIr s
;IIs t
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
IntJJ: =
,JJ= >
ParameterDirectionJJ? Q
.JJQ R
InputJJR W
,JJW X
moduleIdJJY a
)JJa b
;JJb c
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 1
,KK1 2
	SqlDbTypeKK3 <
.KK< =
NVarCharKK= E
,KKE F
$numKKG I
,KKI J
ParameterDirectionKKK ]
.KK] ^
InputKK^ c
,KKc d
settingNameKKe p
)KKp q
;KKq r
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 2
,LL2 3
	SqlDbTypeLL4 =
.LL= >
NVarCharLL> F
,LLF G
-LLH I
$numLLI J
,LLJ K
ParameterDirectionLLL ^
.LL^ _
InputLL_ d
,LLd e
settingValueLLf r
)LLr s
;LLs t
intMM 
rowsAffectedMM 
=MM 
sphMM "
.MM" #
ExecuteNonQueryMM# 2
(MM2 3
)MM3 4
;MM4 5
returnNN 
(NN 
rowsAffectedNN  
>NN! "
-NN# $
$numNN$ %
)NN% &
;NN& '
}OO 	
publicQQ 
staticQQ 
boolQQ '
CreateDefaultModuleSettingsQQ 6
(QQ6 7
intQQ7 :
moduleIdQQ; C
)QQC D
{RR 	
SqlParameterHelperSS 
sphSS "
=SS# $
newSS% (
SqlParameterHelperSS) ;
(SS; <
ConnectionStringSS< L
.SSL M$
GetWriteConnectionStringSSM e
(SSe f
)SSf g
,SSg h
$str	SSi í
,
SSí ì
$num
SSî ï
)
SSï ñ
;
SSñ ó
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
IntTT: =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
moduleIdTTY a
)TTa b
;TTb c
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
(VV 
rowsAffectedVV  
>VV! "
-VV# $
$numVV$ %
)VV% &
;VV& '
}WW 	
publicYY 
staticYY 
boolYY  
DeleteModuleSettingsYY /
(YY/ 0
intYY0 3
moduleIdYY4 <
)YY< =
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i É
,
[[É Ñ
$num
[[Ö Ü
)
[[Ü á
;
[[á à
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
Int\\: =
,\\= >
ParameterDirection\\? Q
.\\Q R
Input\\R W
,\\W X
moduleId\\Y a
)\\a b
;\\b c
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
-^^# $
$num^^$ %
)^^% &
;^^& '
}__ 	
}dd 
}ee „‰
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbPageSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPageSettings &
{ 
public 
static 
int 
Create  
(  !
int 
siteId 
, 
int 
parentId 
, 
string 
pageName 
, 
string 
	pageTitle 
, 
string 
skin 
, 
int 
	pageOrder 
, 
string   
authorizedRoles   "
,  " #
string!! 
	editRoles!! 
,!! 
string"" 
draftEditRoles"" !
,""! "
string## 
draftApprovalRoles## %
,##% &
string$$  
createChildPageRoles$$ '
,$$' (
string%% !
createChildDraftRoles%% (
,%%( )
bool&& 

requireSsl&& 
,&& 
bool'' 
allowBrowserCache'' "
,''" #
bool(( 
showBreadcrumbs((  
,((  !
bool)) $
showChildPageBreadcrumbs)) )
,))) *
string** 
pageKeyWords** 
,**  
string++ 
pageDescription++ "
,++" #
string,, 
pageEncoding,, 
,,,  
string-- 
additionalMetaTags-- %
,--% &
bool.. 
useUrl.. 
,.. 
string// 
url// 
,// 
bool00 
openInNewWindow00  
,00  !
bool11 
showChildPageMenu11 "
,11" #
bool22 
hideMainMenu22 
,22 
bool33 
includeInMenu33 
,33 
String44 
	menuImage44 
,44 
string55 
changeFrequency55 "
,55" #
string66 
siteMapPriority66 "
,66" #
Guid77 
pageGuid77 
,77 
Guid88 

parentGuid88 
,88 
bool99 
hideAfterLogin99 
,99  
Guid:: 
siteGuid:: 
,:: 
string;; 
compiledMeta;; 
,;;  
DateTime<< 
compiledMetaUtc<< $
,<<$ %
bool== 
includeInSiteMap== !
,==! "
bool>> 
isClickable>> 
,>> 
bool?? 
showHomeCrumb?? 
,?? 
bool@@ 
	isPending@@ 
,@@ 
stringAA 
canonicalOverrideAA $
,AA$ %
boolBB 
includeInSearchMapBB #
,BB# $
boolCC 
enableCommentsCC 
,CC  
boolDD !
includeInChildSiteMapDD &
,DD& '
boolEE 
expandOnSiteMapEE  
,EE  !
GuidFF 
	pubTeamIdFF 
,FF 
stringGG 
bodyCssClassGG 
,GG  
stringHH 
menuCssClassHH 
,HH  
intII 
publishModeII 
,II 
GuidJJ 
	createdByJJ 
,JJ 
stringKK 
createdFromIpKK  
,KK  !
stringLL 
menuDescriptionLL "
,LL" #
stringMM 
linkRelMM 
,MM 
stringNN 
pageHeadingNN 
,NN 
boolOO 
showPageHeadingOO  
,OO  !
DateTimePP 

pubDateUtcPP 
)PP  
{QQ 	
SqlParameterHelperSS 
sphSS "
=SS# $
newSS% (
SqlParameterHelperSS) ;
(SS; <
ConnectionStringSS< L
.SSL M$
GetWriteConnectionStringSSM e
(SSe f
)SSf g
,SSg h
$strSSi z
,SSz {
$numSS| ~
)SS~ 
;	SS Ä
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# ,
,TT, -
	SqlDbTypeTT. 7
.TT7 8
IntTT8 ;
,TT; <
ParameterDirectionTT= O
.TTO P
InputTTP U
,TTU V
siteIdTTW ]
)TT] ^
;TT^ _
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# .
,UU. /
	SqlDbTypeUU0 9
.UU9 :
IntUU: =
,UU= >
ParameterDirectionUU? Q
.UUQ R
InputUUR W
,UUW X
parentIdUUY a
)UUa b
;UUb c
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# .
,VV. /
	SqlDbTypeVV0 9
.VV9 :
NVarCharVV: B
,VVB C
$numVVD G
,VVG H
ParameterDirectionVVI [
.VV[ \
InputVV\ a
,VVa b
pageNameVVc k
)VVk l
;VVl m
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
IntWW; >
,WW> ?
ParameterDirectionWW@ R
.WWR S
InputWWS X
,WWX Y
	pageOrderWWZ c
)WWc d
;WWd e
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 5
,XX5 6
	SqlDbTypeXX7 @
.XX@ A
NVarCharXXA I
,XXI J
-XXK L
$numXXL M
,XXM N
ParameterDirectionXXO a
.XXa b
InputXXb g
,XXg h
authorizedRolesXXi x
)XXx y
;XXy z
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# /
,YY/ 0
	SqlDbTypeYY1 :
.YY: ;
NVarCharYY; C
,YYC D
-YYE F
$numYYF G
,YYG H
ParameterDirectionYYI [
.YY[ \
InputYY\ a
,YYa b
	editRolesYYc l
)YYl m
;YYm n
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 4
,ZZ4 5
	SqlDbTypeZZ6 ?
.ZZ? @
NVarCharZZ@ H
,ZZH I
-ZZJ K
$numZZK L
,ZZL M
ParameterDirectionZZN `
.ZZ` a
InputZZa f
,ZZf g
draftEditRolesZZh v
)ZZv w
;ZZw x
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 8
,[[8 9
	SqlDbType[[: C
.[[C D
NVarChar[[D L
,[[L M
-[[N O
$num[[O P
,[[P Q
ParameterDirection[[R d
.[[d e
Input[[e j
,[[j k
draftApprovalRoles[[l ~
)[[~ 
;	[[ Ä
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# :
,\\: ;
	SqlDbType\\< E
.\\E F
NVarChar\\F N
,\\N O
-\\P Q
$num\\Q R
,\\R S
ParameterDirection\\T f
.\\f g
Input\\g l
,\\l m!
createChildPageRoles	\\n Ç
)
\\Ç É
;
\\É Ñ
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ;
,]]; <
	SqlDbType]]= F
.]]F G
NVarChar]]G O
,]]O P
-]]Q R
$num]]R S
,]]S T
ParameterDirection]]U g
.]]g h
Input]]h m
,]]m n"
createChildDraftRoles	]]o Ñ
)
]]Ñ Ö
;
]]Ö Ü
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 0
,^^0 1
	SqlDbType^^2 ;
.^^; <
Bit^^< ?
,^^? @
ParameterDirection^^A S
.^^S T
Input^^T Y
,^^Y Z

requireSsl^^[ e
)^^e f
;^^f g
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 5
,__5 6
	SqlDbType__7 @
.__@ A
Bit__A D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _
showBreadcrumbs__` o
)__o p
;__p q
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# >
,``> ?
	SqlDbType``@ I
.``I J
Bit``J M
,``M N
ParameterDirection``O a
.``a b
Input``b g
,``g h%
showChildPageBreadcrumbs	``i Å
)
``Å Ç
;
``Ç É
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
NVarCharaa> F
,aaF G
$numaaH L
,aaL M
ParameterDirectionaaN `
.aa` a
Inputaaa f
,aaf g
pageKeyWordsaah t
)aat u
;aau v
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 5
,bb5 6
	SqlDbTypebb7 @
.bb@ A
NVarCharbbA I
,bbI J
$numbbK N
,bbN O
ParameterDirectionbbP b
.bbb c
Inputbbc h
,bbh i
pageDescriptionbbj y
)bby z
;bbz {
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 2
,cc2 3
	SqlDbTypecc4 =
.cc= >
NVarCharcc> F
,ccF G
$numccH K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
pageEncodingccg s
)ccs t
;cct u
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 8
,dd8 9
	SqlDbTypedd: C
.ddC D
NVarCharddD L
,ddL M
$numddN Q
,ddQ R
ParameterDirectionddS e
.dde f
Inputddf k
,ddk l
additionalMetaTagsddm 
)	dd Ä
;
ddÄ Å
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
Bitee8 ;
,ee; <
ParameterDirectionee= O
.eeO P
InputeeP U
,eeU V
useUrleeW ]
)ee] ^
;ee^ _
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# )
,ff) *
	SqlDbTypeff+ 4
.ff4 5
NVarCharff5 =
,ff= >
$numff? B
,ffB C
ParameterDirectionffD V
.ffV W
InputffW \
,ff\ ]
urlff^ a
)ffa b
;ffb c
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 5
,gg5 6
	SqlDbTypegg7 @
.gg@ A
BitggA D
,ggD E
ParameterDirectionggF X
.ggX Y
InputggY ^
,gg^ _
openInNewWindowgg` o
)ggo p
;ggp q
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 7
,hh7 8
	SqlDbTypehh9 B
.hhB C
BithhC F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
showChildPageMenuhhb s
)hhs t
;hht u
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 2
,ii2 3
	SqlDbTypeii4 =
.ii= >
Bitii> A
,iiA B
ParameterDirectioniiC U
.iiU V
InputiiV [
,ii[ \
hideMainMenuii] i
)iii j
;iij k
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# *
,jj* +
	SqlDbTypejj, 5
.jj5 6
NVarCharjj6 >
,jj> ?
$numjj@ C
,jjC D
ParameterDirectionjjE W
.jjW X
InputjjX ]
,jj] ^
skinjj_ c
)jjc d
;jjd e
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 3
,kk3 4
	SqlDbTypekk5 >
.kk> ?
Bitkk? B
,kkB C
ParameterDirectionkkD V
.kkV W
InputkkW \
,kk\ ]
includeInMenukk^ k
)kkk l
;kkl m
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# /
,ll/ 0
	SqlDbTypell1 :
.ll: ;
NVarCharll; C
,llC D
$numllE H
,llH I
ParameterDirectionllJ \
.ll\ ]
Inputll] b
,llb c
	menuImagelld m
)llm n
;lln o
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# /
,mm/ 0
	SqlDbTypemm1 :
.mm: ;
NVarCharmm; C
,mmC D
$nummmE H
,mmH I
ParameterDirectionmmJ \
.mm\ ]
Inputmm] b
,mmb c
	pageTitlemmd m
)mmm n
;mmn o
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 7
,nn7 8
	SqlDbTypenn9 B
.nnB C
BitnnC F
,nnF G
ParameterDirectionnnH Z
.nnZ [
Inputnn[ `
,nn` a
allowBrowserCachennb s
)nns t
;nnt u
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 5
,oo5 6
	SqlDbTypeoo7 @
.oo@ A
NVarCharooA I
,ooI J
$numooK M
,ooM N
ParameterDirectionooO a
.ooa b
Inputoob g
,oog h
changeFrequencyooi x
)oox y
;ooy z
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 5
,pp5 6
	SqlDbTypepp7 @
.pp@ A
NVarCharppA I
,ppI J
$numppK M
,ppM N
ParameterDirectionppO a
.ppa b
Inputppb g
,ppg h
siteMapPriorityppi x
)ppx y
;ppy z
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 5
,qq5 6
	SqlDbTypeqq7 @
.qq@ A
DateTimeqqA I
,qqI J
ParameterDirectionqqK ]
.qq] ^
Inputqq^ c
,qqc d
DateTimeqqe m
.qqm n
UtcNowqqn t
)qqt u
;qqu v
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# .
,rr. /
	SqlDbTyperr0 9
.rr9 :
UniqueIdentifierrr: J
,rrJ K
ParameterDirectionrrL ^
.rr^ _
Inputrr_ d
,rrd e
pageGuidrrf n
)rrn o
;rro p
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 0
,ss0 1
	SqlDbTypess2 ;
.ss; <
UniqueIdentifierss< L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g

parentGuidssh r
)ssr s
;sss t
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 4
,tt4 5
	SqlDbTypett6 ?
.tt? @
Bittt@ C
,ttC D
ParameterDirectionttE W
.ttW X
InputttX ]
,tt] ^
hideAfterLogintt_ m
)ttm n
;ttn o
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
UniqueIdentifieruu: J
,uuJ K
ParameterDirectionuuL ^
.uu^ _
Inputuu_ d
,uud e
siteGuiduuf n
)uun o
;uuo p
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 2
,vv2 3
	SqlDbTypevv4 =
.vv= >
NVarCharvv> F
,vvF G
-vvH I
$numvvI J
,vvJ K
ParameterDirectionvvL ^
.vv^ _
Inputvv_ d
,vvd e
compiledMetavvf r
)vvr s
;vvs t
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 5
,ww5 6
	SqlDbTypeww7 @
.ww@ A
DateTimewwA I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d
compiledMetaUtcwwe t
)wwt u
;wwu v
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 6
,xx6 7
	SqlDbTypexx8 A
.xxA B
BitxxB E
,xxE F
ParameterDirectionxxG Y
.xxY Z
InputxxZ _
,xx_ `
includeInSiteMapxxa q
)xxq r
;xxr s
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 1
,yy1 2
	SqlDbTypeyy3 <
.yy< =
Bityy= @
,yy@ A
ParameterDirectionyyB T
.yyT U
InputyyU Z
,yyZ [
isClickableyy\ g
)yyg h
;yyh i
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 3
,zz3 4
	SqlDbTypezz5 >
.zz> ?
Bitzz? B
,zzB C
ParameterDirectionzzD V
.zzV W
InputzzW \
,zz\ ]
showHomeCrumbzz^ k
)zzk l
;zzl m
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# /
,{{/ 0
	SqlDbType{{1 :
.{{: ;
Bit{{; >
,{{> ?
ParameterDirection{{@ R
.{{R S
Input{{S X
,{{X Y
	isPending{{Z c
){{c d
;{{d e
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 7
,||7 8
	SqlDbType||9 B
.||B C
NVarChar||C K
,||K L
$num||M P
,||P Q
ParameterDirection||R d
.||d e
Input||e j
,||j k
canonicalOverride||l }
)||} ~
;||~ 
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 8
,}}8 9
	SqlDbType}}: C
.}}C D
Bit}}D G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
includeInSearchMap}}c u
)}}u v
;}}v w
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 4
,~~4 5
	SqlDbType~~6 ?
.~~? @
Bit~~@ C
,~~C D
ParameterDirection~~E W
.~~W X
Input~~X ]
,~~] ^
enableComments~~_ m
)~~m n
;~~n o
sph 
. 
DefineSqlParameter "
(" #
$str# ;
,; <
	SqlDbType= F
.F G
BitG J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e!
includeInChildSiteMapf {
){ |
;| }
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# 5
,
ÄÄ5 6
	SqlDbType
ÄÄ7 @
.
ÄÄ@ A
Bit
ÄÄA D
,
ÄÄD E 
ParameterDirection
ÄÄF X
.
ÄÄX Y
Input
ÄÄY ^
,
ÄÄ^ _
expandOnSiteMap
ÄÄ` o
)
ÄÄo p
;
ÄÄp q
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# /
,
ÅÅ/ 0
	SqlDbType
ÅÅ1 :
.
ÅÅ: ;
UniqueIdentifier
ÅÅ; K
,
ÅÅK L 
ParameterDirection
ÅÅM _
.
ÅÅ_ `
Input
ÅÅ` e
,
ÅÅe f
	pubTeamId
ÅÅg p
)
ÅÅp q
;
ÅÅq r
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 2
,
ÇÇ2 3
	SqlDbType
ÇÇ4 =
.
ÇÇ= >
NVarChar
ÇÇ> F
,
ÇÇF G
$num
ÇÇH J
,
ÇÇJ K 
ParameterDirection
ÇÇL ^
.
ÇÇ^ _
Input
ÇÇ_ d
,
ÇÇd e
bodyCssClass
ÇÇf r
)
ÇÇr s
;
ÇÇs t
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 2
,
ÉÉ2 3
	SqlDbType
ÉÉ4 =
.
ÉÉ= >
NVarChar
ÉÉ> F
,
ÉÉF G
$num
ÉÉH J
,
ÉÉJ K 
ParameterDirection
ÉÉL ^
.
ÉÉ^ _
Input
ÉÉ_ d
,
ÉÉd e
menuCssClass
ÉÉf r
)
ÉÉr s
;
ÉÉs t
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 1
,
ÑÑ1 2
	SqlDbType
ÑÑ3 <
.
ÑÑ< =
Int
ÑÑ= @
,
ÑÑ@ A 
ParameterDirection
ÑÑB T
.
ÑÑT U
Input
ÑÑU Z
,
ÑÑZ [
publishMode
ÑÑ\ g
)
ÑÑg h
;
ÑÑh i
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 1
,
ÜÜ1 2
	SqlDbType
ÜÜ3 <
.
ÜÜ< =
DateTime
ÜÜ= E
,
ÜÜE F 
ParameterDirection
ÜÜG Y
.
ÜÜY Z
Input
ÜÜZ _
,
ÜÜ_ `
DateTime
ÜÜa i
.
ÜÜi j
UtcNow
ÜÜj p
)
ÜÜp q
;
ÜÜq r
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 0
,
áá0 1
	SqlDbType
áá2 ;
.
áá; <
UniqueIdentifier
áá< L
,
ááL M 
ParameterDirection
ááN `
.
áá` a
Input
ááa f
,
ááf g
	createdBy
ááh q
)
ááq r
;
áár s
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 4
,
àà4 5
	SqlDbType
àà6 ?
.
àà? @
NVarChar
àà@ H
,
ààH I
$num
ààJ L
,
ààL M 
ParameterDirection
ààN `
.
àà` a
Input
ààa f
,
ààf g
createdFromIp
ààh u
)
ààu v
;
ààv w
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 1
,
ää1 2
	SqlDbType
ää3 <
.
ää< =
DateTime
ää= E
,
ääE F 
ParameterDirection
ääG Y
.
ääY Z
Input
ääZ _
,
ää_ `
DateTime
ääa i
.
ääi j
UtcNow
ääj p
)
ääp q
;
ääq r
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 0
,
ãã0 1
	SqlDbType
ãã2 ;
.
ãã; <
UniqueIdentifier
ãã< L
,
ããL M 
ParameterDirection
ããN `
.
ãã` a
Input
ããa f
,
ããf g
	createdBy
ããh q
)
ããq r
;
ããr s
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# 4
,
åå4 5
	SqlDbType
åå6 ?
.
åå? @
NVarChar
åå@ H
,
ååH I
$num
ååJ L
,
ååL M 
ParameterDirection
ååN `
.
åå` a
Input
ååa f
,
ååf g
createdFromIp
ååh u
)
ååu v
;
ååv w
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# .
,
çç. /
	SqlDbType
çç0 9
.
çç9 :
NVarChar
çç: B
,
ççB C
-
ççD E
$num
ççE F
,
ççF G 
ParameterDirection
ççH Z
.
ççZ [
Input
çç[ `
,
çç` a
menuDescription
ççb q
)
ççq r
;
ççr s
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# -
,
èè- .
	SqlDbType
èè/ 8
.
èè8 9
NVarChar
èè9 A
,
èèA B
$num
èèC E
,
èèE F 
ParameterDirection
èèG Y
.
èèY Z
Input
èèZ _
,
èè_ `
linkRel
èèa h
)
èèh i
;
èèi j
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 1
,
êê1 2
	SqlDbType
êê3 <
.
êê< =
NVarChar
êê= E
,
êêE F
$num
êêG J
,
êêJ K 
ParameterDirection
êêL ^
.
êê^ _
Input
êê_ d
,
êêd e
pageHeading
êêf q
)
êêq r
;
êêr s
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 5
,
ëë5 6
	SqlDbType
ëë7 @
.
ëë@ A
Bit
ëëA D
,
ëëD E 
ParameterDirection
ëëF X
.
ëëX Y
Input
ëëY ^
,
ëë^ _
showPageHeading
ëë` o
)
ëëo p
;
ëëp q
if
íí 
(
íí 

pubDateUtc
íí 
==
íí 
DateTime
íí &
.
íí& '
MaxValue
íí' /
)
íí/ 0
{
ìì 
sph
îî 
.
îî  
DefineSqlParameter
îî &
(
îî& '
$str
îî' 4
,
îî4 5
	SqlDbType
îî6 ?
.
îî? @
DateTime
îî@ H
,
îîH I 
ParameterDirection
îîJ \
.
îî\ ]
Input
îî] b
,
îîb c
DBNull
îîd j
.
îîj k
Value
îîk p
)
îîp q
;
îîq r
}
ïï 
else
ññ 
{
óó 
sph
òò 
.
òò  
DefineSqlParameter
òò &
(
òò& '
$str
òò' 4
,
òò4 5
	SqlDbType
òò6 ?
.
òò? @
DateTime
òò@ H
,
òòH I 
ParameterDirection
òòJ \
.
òò\ ]
Input
òò] b
,
òòb c

pubDateUtc
òòd n
)
òòn o
;
òòo p
}
ôô 
int
úú 
newID
úú 
=
úú 
Convert
úú 
.
úú  
ToInt32
úú  '
(
úú' (
sph
úú( +
.
úú+ ,
ExecuteScalar
úú, 9
(
úú9 :
)
úú: ;
)
úú; <
;
úú< =
return
ùù 
newID
ùù 
;
ùù 
}
ûû 	
public
†† 
static
†† 
bool
†† 

UpdatePage
†† %
(
††% &
int
°° 
siteId
°° 
,
°° 
int
¢¢ 
pageId
¢¢ 
,
¢¢ 
int
££ 
parentId
££ 
,
££ 
string
§§ 
pageName
§§ 
,
§§ 
string
•• 
	pageTitle
•• 
,
•• 
string
¶¶ 
skin
¶¶ 
,
¶¶ 
int
ßß 
	pageOrder
ßß 
,
ßß 
string
®® 
authorizedRoles
®® "
,
®®" #
string
©© 
	editRoles
©© 
,
©© 
string
™™ 
draftEditRoles
™™ !
,
™™! "
string
´´  
draftApprovalRoles
´´ %
,
´´% &
string
¨¨ "
createChildPageRoles
¨¨ '
,
¨¨' (
string
≠≠ #
createChildDraftRoles
≠≠ (
,
≠≠( )
bool
ÆÆ 

requireSsl
ÆÆ 
,
ÆÆ 
bool
ØØ 
allowBrowserCache
ØØ "
,
ØØ" #
bool
∞∞ 
showBreadcrumbs
∞∞  
,
∞∞  !
bool
±± &
showChildPageBreadcrumbs
±± )
,
±±) *
string
≤≤ 
pageKeyWords
≤≤ 
,
≤≤  
string
≥≥ 
pageDescription
≥≥ "
,
≥≥" #
string
¥¥ 
pageEncoding
¥¥ 
,
¥¥  
string
µµ  
additionalMetaTags
µµ %
,
µµ% &
bool
∂∂ 
useUrl
∂∂ 
,
∂∂ 
string
∑∑ 
url
∑∑ 
,
∑∑ 
bool
∏∏ 
openInNewWindow
∏∏  
,
∏∏  !
bool
ππ 
showChildPageMenu
ππ "
,
ππ" #
bool
∫∫ 
hideMainMenu
∫∫ 
,
∫∫ 
bool
ªª 
includeInMenu
ªª 
,
ªª 
String
ºº 
	menuImage
ºº 
,
ºº 
string
ΩΩ 
changeFrequency
ΩΩ "
,
ΩΩ" #
string
ææ 
siteMapPriority
ææ "
,
ææ" #
Guid
øø 

parentGuid
øø 
,
øø 
bool
¿¿ 
hideAfterLogin
¿¿ 
,
¿¿  
string
¡¡ 
compiledMeta
¡¡ 
,
¡¡  
DateTime
¬¬ 
compiledMetaUtc
¬¬ $
,
¬¬$ %
bool
√√ 
includeInSiteMap
√√ !
,
√√! "
bool
ƒƒ 
isClickable
ƒƒ 
,
ƒƒ 
bool
≈≈ 
showHomeCrumb
≈≈ 
,
≈≈ 
bool
∆∆ 
	isPending
∆∆ 
,
∆∆ 
string
«« 
canonicalOverride
«« $
,
««$ %
bool
»»  
includeInSearchMap
»» #
,
»»# $
bool
…… 
enableComments
…… 
,
……  
bool
   #
includeInChildSiteMap
   &
,
  & '
bool
ÀÀ 
expandOnSiteMap
ÀÀ  
,
ÀÀ  !
Guid
ÃÃ 
	pubTeamId
ÃÃ 
,
ÃÃ 
string
ÕÕ 
bodyCssClass
ÕÕ 
,
ÕÕ  
string
ŒŒ 
menuCssClass
ŒŒ 
,
ŒŒ  
int
œœ 
publishMode
œœ 
,
œœ 
DateTime
–– 

createdUtc
–– 
,
––  
Guid
—— 
	createdBy
—— 
,
—— 
Guid
““ 
	lastModBy
““ 
,
““ 
string
”” 
lastModFromIp
””  
,
””  !
string
‘‘ 
menuDescription
‘‘ "
,
‘‘" #
string
’’ 
linkRel
’’ 
,
’’ 
string
÷÷ 
pageHeading
÷÷ 
,
÷÷ 
bool
◊◊ 
showPageHeading
◊◊  
,
◊◊  !
DateTime
ÿÿ 

pubDateUtc
ÿÿ 
)
ÿÿ  
{
ŸŸ 	 
SqlParameterHelper
⁄⁄ 
sph
⁄⁄ "
=
⁄⁄# $
new
⁄⁄% ( 
SqlParameterHelper
⁄⁄) ;
(
⁄⁄; <
ConnectionString
⁄⁄< L
.
⁄⁄L M&
GetWriteConnectionString
⁄⁄M e
(
⁄⁄e f
)
⁄⁄f g
,
⁄⁄g h
$str
⁄⁄i z
,
⁄⁄z {
$num
⁄⁄| ~
)
⁄⁄~ 
;⁄⁄ Ä
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# ,
,
€€, -
	SqlDbType
€€. 7
.
€€7 8
Int
€€8 ;
,
€€; < 
ParameterDirection
€€= O
.
€€O P
Input
€€P U
,
€€U V
siteId
€€W ]
)
€€] ^
;
€€^ _
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# ,
,
‹‹, -
	SqlDbType
‹‹. 7
.
‹‹7 8
Int
‹‹8 ;
,
‹‹; < 
ParameterDirection
‹‹= O
.
‹‹O P
Input
‹‹P U
,
‹‹U V
pageId
‹‹W ]
)
‹‹] ^
;
‹‹^ _
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# .
,
››. /
	SqlDbType
››0 9
.
››9 :
Int
››: =
,
››= > 
ParameterDirection
››? Q
.
››Q R
Input
››R W
,
››W X
parentId
››Y a
)
››a b
;
››b c
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# /
,
ﬁﬁ/ 0
	SqlDbType
ﬁﬁ1 :
.
ﬁﬁ: ;
Int
ﬁﬁ; >
,
ﬁﬁ> ? 
ParameterDirection
ﬁﬁ@ R
.
ﬁﬁR S
Input
ﬁﬁS X
,
ﬁﬁX Y
	pageOrder
ﬁﬁZ c
)
ﬁﬁc d
;
ﬁﬁd e
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# .
,
ﬂﬂ. /
	SqlDbType
ﬂﬂ0 9
.
ﬂﬂ9 :
NVarChar
ﬂﬂ: B
,
ﬂﬂB C
$num
ﬂﬂD G
,
ﬂﬂG H 
ParameterDirection
ﬂﬂI [
.
ﬂﬂ[ \
Input
ﬂﬂ\ a
,
ﬂﬂa b
pageName
ﬂﬂc k
)
ﬂﬂk l
;
ﬂﬂl m
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# 5
,
‡‡5 6
	SqlDbType
‡‡7 @
.
‡‡@ A
NVarChar
‡‡A I
,
‡‡I J
-
‡‡K L
$num
‡‡L M
,
‡‡M N 
ParameterDirection
‡‡O a
.
‡‡a b
Input
‡‡b g
,
‡‡g h
authorizedRoles
‡‡i x
)
‡‡x y
;
‡‡y z
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# /
,
··/ 0
	SqlDbType
··1 :
.
··: ;
NVarChar
··; C
,
··C D
-
··E F
$num
··F G
,
··G H 
ParameterDirection
··I [
.
··[ \
Input
··\ a
,
··a b
	editRoles
··c l
)
··l m
;
··m n
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ "
(
‚‚" #
$str
‚‚# 4
,
‚‚4 5
	SqlDbType
‚‚6 ?
.
‚‚? @
NVarChar
‚‚@ H
,
‚‚H I
-
‚‚J K
$num
‚‚K L
,
‚‚L M 
ParameterDirection
‚‚N `
.
‚‚` a
Input
‚‚a f
,
‚‚f g
draftEditRoles
‚‚h v
)
‚‚v w
;
‚‚w x
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# 8
,
„„8 9
	SqlDbType
„„: C
.
„„C D
NVarChar
„„D L
,
„„L M
-
„„N O
$num
„„O P
,
„„P Q 
ParameterDirection
„„R d
.
„„d e
Input
„„e j
,
„„j k 
draftApprovalRoles
„„l ~
)
„„~ 
;„„ Ä
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# :
,
‰‰: ;
	SqlDbType
‰‰< E
.
‰‰E F
NVarChar
‰‰F N
,
‰‰N O
-
‰‰P Q
$num
‰‰Q R
,
‰‰R S 
ParameterDirection
‰‰T f
.
‰‰f g
Input
‰‰g l
,
‰‰l m#
createChildPageRoles‰‰n Ç
)‰‰Ç É
;‰‰É Ñ
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# ;
,
ÂÂ; <
	SqlDbType
ÂÂ= F
.
ÂÂF G
NVarChar
ÂÂG O
,
ÂÂO P
-
ÂÂQ R
$num
ÂÂR S
,
ÂÂS T 
ParameterDirection
ÂÂU g
.
ÂÂg h
Input
ÂÂh m
,
ÂÂm n$
createChildDraftRolesÂÂo Ñ
)ÂÂÑ Ö
;ÂÂÖ Ü
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 0
,
ÊÊ0 1
	SqlDbType
ÊÊ2 ;
.
ÊÊ; <
Bit
ÊÊ< ?
,
ÊÊ? @ 
ParameterDirection
ÊÊA S
.
ÊÊS T
Input
ÊÊT Y
,
ÊÊY Z

requireSsl
ÊÊ[ e
)
ÊÊe f
;
ÊÊf g
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 5
,
ÁÁ5 6
	SqlDbType
ÁÁ7 @
.
ÁÁ@ A
Bit
ÁÁA D
,
ÁÁD E 
ParameterDirection
ÁÁF X
.
ÁÁX Y
Input
ÁÁY ^
,
ÁÁ^ _
showBreadcrumbs
ÁÁ` o
)
ÁÁo p
;
ÁÁp q
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# >
,
ËË> ?
	SqlDbType
ËË@ I
.
ËËI J
Bit
ËËJ M
,
ËËM N 
ParameterDirection
ËËO a
.
ËËa b
Input
ËËb g
,
ËËg h'
showChildPageBreadcrumbsËËi Å
)ËËÅ Ç
;ËËÇ É
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 2
,
ÈÈ2 3
	SqlDbType
ÈÈ4 =
.
ÈÈ= >
NVarChar
ÈÈ> F
,
ÈÈF G
$num
ÈÈH L
,
ÈÈL M 
ParameterDirection
ÈÈN `
.
ÈÈ` a
Input
ÈÈa f
,
ÈÈf g
pageKeyWords
ÈÈh t
)
ÈÈt u
;
ÈÈu v
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 5
,
ÍÍ5 6
	SqlDbType
ÍÍ7 @
.
ÍÍ@ A
NVarChar
ÍÍA I
,
ÍÍI J
$num
ÍÍK N
,
ÍÍN O 
ParameterDirection
ÍÍP b
.
ÍÍb c
Input
ÍÍc h
,
ÍÍh i
pageDescription
ÍÍj y
)
ÍÍy z
;
ÍÍz {
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 2
,
ÎÎ2 3
	SqlDbType
ÎÎ4 =
.
ÎÎ= >
NVarChar
ÎÎ> F
,
ÎÎF G
$num
ÎÎH K
,
ÎÎK L 
ParameterDirection
ÎÎM _
.
ÎÎ_ `
Input
ÎÎ` e
,
ÎÎe f
pageEncoding
ÎÎg s
)
ÎÎs t
;
ÎÎt u
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# 8
,
ÏÏ8 9
	SqlDbType
ÏÏ: C
.
ÏÏC D
NVarChar
ÏÏD L
,
ÏÏL M
$num
ÏÏN Q
,
ÏÏQ R 
ParameterDirection
ÏÏS e
.
ÏÏe f
Input
ÏÏf k
,
ÏÏk l 
additionalMetaTags
ÏÏm 
)ÏÏ Ä
;ÏÏÄ Å
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# ,
,
ÌÌ, -
	SqlDbType
ÌÌ. 7
.
ÌÌ7 8
Bit
ÌÌ8 ;
,
ÌÌ; < 
ParameterDirection
ÌÌ= O
.
ÌÌO P
Input
ÌÌP U
,
ÌÌU V
useUrl
ÌÌW ]
)
ÌÌ] ^
;
ÌÌ^ _
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# )
,
ÓÓ) *
	SqlDbType
ÓÓ+ 4
.
ÓÓ4 5
NVarChar
ÓÓ5 =
,
ÓÓ= >
$num
ÓÓ? B
,
ÓÓB C 
ParameterDirection
ÓÓD V
.
ÓÓV W
Input
ÓÓW \
,
ÓÓ\ ]
url
ÓÓ^ a
)
ÓÓa b
;
ÓÓb c
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# 5
,
ÔÔ5 6
	SqlDbType
ÔÔ7 @
.
ÔÔ@ A
Bit
ÔÔA D
,
ÔÔD E 
ParameterDirection
ÔÔF X
.
ÔÔX Y
Input
ÔÔY ^
,
ÔÔ^ _
openInNewWindow
ÔÔ` o
)
ÔÔo p
;
ÔÔp q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 7
,
7 8
	SqlDbType
9 B
.
B C
Bit
C F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
showChildPageMenu
b s
)
s t
;
t u
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 2
,
ÒÒ2 3
	SqlDbType
ÒÒ4 =
.
ÒÒ= >
Bit
ÒÒ> A
,
ÒÒA B 
ParameterDirection
ÒÒC U
.
ÒÒU V
Input
ÒÒV [
,
ÒÒ[ \
hideMainMenu
ÒÒ] i
)
ÒÒi j
;
ÒÒj k
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# *
,
ÚÚ* +
	SqlDbType
ÚÚ, 5
.
ÚÚ5 6
NVarChar
ÚÚ6 >
,
ÚÚ> ?
$num
ÚÚ@ C
,
ÚÚC D 
ParameterDirection
ÚÚE W
.
ÚÚW X
Input
ÚÚX ]
,
ÚÚ] ^
skin
ÚÚ_ c
)
ÚÚc d
;
ÚÚd e
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# 3
,
ÛÛ3 4
	SqlDbType
ÛÛ5 >
.
ÛÛ> ?
Bit
ÛÛ? B
,
ÛÛB C 
ParameterDirection
ÛÛD V
.
ÛÛV W
Input
ÛÛW \
,
ÛÛ\ ]
includeInMenu
ÛÛ^ k
)
ÛÛk l
;
ÛÛl m
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# /
,
ÙÙ/ 0
	SqlDbType
ÙÙ1 :
.
ÙÙ: ;
NVarChar
ÙÙ; C
,
ÙÙC D
$num
ÙÙE H
,
ÙÙH I 
ParameterDirection
ÙÙJ \
.
ÙÙ\ ]
Input
ÙÙ] b
,
ÙÙb c
	menuImage
ÙÙd m
)
ÙÙm n
;
ÙÙn o
sph
ıı 
.
ıı  
DefineSqlParameter
ıı "
(
ıı" #
$str
ıı# /
,
ıı/ 0
	SqlDbType
ıı1 :
.
ıı: ;
NVarChar
ıı; C
,
ııC D
$num
ııE H
,
ııH I 
ParameterDirection
ııJ \
.
ıı\ ]
Input
ıı] b
,
ııb c
	pageTitle
ııd m
)
ıım n
;
ıın o
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# 7
,
ˆˆ7 8
	SqlDbType
ˆˆ9 B
.
ˆˆB C
Bit
ˆˆC F
,
ˆˆF G 
ParameterDirection
ˆˆH Z
.
ˆˆZ [
Input
ˆˆ[ `
,
ˆˆ` a
allowBrowserCache
ˆˆb s
)
ˆˆs t
;
ˆˆt u
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# 5
,
˜˜5 6
	SqlDbType
˜˜7 @
.
˜˜@ A
NVarChar
˜˜A I
,
˜˜I J
$num
˜˜K M
,
˜˜M N 
ParameterDirection
˜˜O a
.
˜˜a b
Input
˜˜b g
,
˜˜g h
changeFrequency
˜˜i x
)
˜˜x y
;
˜˜y z
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# 5
,
¯¯5 6
	SqlDbType
¯¯7 @
.
¯¯@ A
NVarChar
¯¯A I
,
¯¯I J
$num
¯¯K M
,
¯¯M N 
ParameterDirection
¯¯O a
.
¯¯a b
Input
¯¯b g
,
¯¯g h
siteMapPriority
¯¯i x
)
¯¯x y
;
¯¯y z
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# 5
,
˘˘5 6
	SqlDbType
˘˘7 @
.
˘˘@ A
DateTime
˘˘A I
,
˘˘I J 
ParameterDirection
˘˘K ]
.
˘˘] ^
Input
˘˘^ c
,
˘˘c d
DateTime
˘˘e m
.
˘˘m n
UtcNow
˘˘n t
)
˘˘t u
;
˘˘u v
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# 0
,
˙˙0 1
	SqlDbType
˙˙2 ;
.
˙˙; <
UniqueIdentifier
˙˙< L
,
˙˙L M 
ParameterDirection
˙˙N `
.
˙˙` a
Input
˙˙a f
,
˙˙f g

parentGuid
˙˙h r
)
˙˙r s
;
˙˙s t
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ "
(
˚˚" #
$str
˚˚# 4
,
˚˚4 5
	SqlDbType
˚˚6 ?
.
˚˚? @
Bit
˚˚@ C
,
˚˚C D 
ParameterDirection
˚˚E W
.
˚˚W X
Input
˚˚X ]
,
˚˚] ^
hideAfterLogin
˚˚_ m
)
˚˚m n
;
˚˚n o
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 2
,
¸¸2 3
	SqlDbType
¸¸4 =
.
¸¸= >
NVarChar
¸¸> F
,
¸¸F G
-
¸¸H I
$num
¸¸I J
,
¸¸J K 
ParameterDirection
¸¸L ^
.
¸¸^ _
Input
¸¸_ d
,
¸¸d e
compiledMeta
¸¸f r
)
¸¸r s
;
¸¸s t
sph
˝˝ 
.
˝˝  
DefineSqlParameter
˝˝ "
(
˝˝" #
$str
˝˝# 5
,
˝˝5 6
	SqlDbType
˝˝7 @
.
˝˝@ A
DateTime
˝˝A I
,
˝˝I J 
ParameterDirection
˝˝K ]
.
˝˝] ^
Input
˝˝^ c
,
˝˝c d
compiledMetaUtc
˝˝e t
)
˝˝t u
;
˝˝u v
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# 6
,
˛˛6 7
	SqlDbType
˛˛8 A
.
˛˛A B
Bit
˛˛B E
,
˛˛E F 
ParameterDirection
˛˛G Y
.
˛˛Y Z
Input
˛˛Z _
,
˛˛_ `
includeInSiteMap
˛˛a q
)
˛˛q r
;
˛˛r s
sph
ˇˇ 
.
ˇˇ  
DefineSqlParameter
ˇˇ "
(
ˇˇ" #
$str
ˇˇ# 1
,
ˇˇ1 2
	SqlDbType
ˇˇ3 <
.
ˇˇ< =
Bit
ˇˇ= @
,
ˇˇ@ A 
ParameterDirection
ˇˇB T
.
ˇˇT U
Input
ˇˇU Z
,
ˇˇZ [
isClickable
ˇˇ\ g
)
ˇˇg h
;
ˇˇh i
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# 3
,
ÄÄ3 4
	SqlDbType
ÄÄ5 >
.
ÄÄ> ?
Bit
ÄÄ? B
,
ÄÄB C 
ParameterDirection
ÄÄD V
.
ÄÄV W
Input
ÄÄW \
,
ÄÄ\ ]
showHomeCrumb
ÄÄ^ k
)
ÄÄk l
;
ÄÄl m
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# /
,
ÅÅ/ 0
	SqlDbType
ÅÅ1 :
.
ÅÅ: ;
Bit
ÅÅ; >
,
ÅÅ> ? 
ParameterDirection
ÅÅ@ R
.
ÅÅR S
Input
ÅÅS X
,
ÅÅX Y
	isPending
ÅÅZ c
)
ÅÅc d
;
ÅÅd e
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 7
,
ÇÇ7 8
	SqlDbType
ÇÇ9 B
.
ÇÇB C
NVarChar
ÇÇC K
,
ÇÇK L
$num
ÇÇM P
,
ÇÇP Q 
ParameterDirection
ÇÇR d
.
ÇÇd e
Input
ÇÇe j
,
ÇÇj k
canonicalOverride
ÇÇl }
)
ÇÇ} ~
;
ÇÇ~ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 8
,
ÉÉ8 9
	SqlDbType
ÉÉ: C
.
ÉÉC D
Bit
ÉÉD G
,
ÉÉG H 
ParameterDirection
ÉÉI [
.
ÉÉ[ \
Input
ÉÉ\ a
,
ÉÉa b 
includeInSearchMap
ÉÉc u
)
ÉÉu v
;
ÉÉv w
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 4
,
ÑÑ4 5
	SqlDbType
ÑÑ6 ?
.
ÑÑ? @
Bit
ÑÑ@ C
,
ÑÑC D 
ParameterDirection
ÑÑE W
.
ÑÑW X
Input
ÑÑX ]
,
ÑÑ] ^
enableComments
ÑÑ_ m
)
ÑÑm n
;
ÑÑn o
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# ;
,
ÖÖ; <
	SqlDbType
ÖÖ= F
.
ÖÖF G
Bit
ÖÖG J
,
ÖÖJ K 
ParameterDirection
ÖÖL ^
.
ÖÖ^ _
Input
ÖÖ_ d
,
ÖÖd e#
includeInChildSiteMap
ÖÖf {
)
ÖÖ{ |
;
ÖÖ| }
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 5
,
ÜÜ5 6
	SqlDbType
ÜÜ7 @
.
ÜÜ@ A
Bit
ÜÜA D
,
ÜÜD E 
ParameterDirection
ÜÜF X
.
ÜÜX Y
Input
ÜÜY ^
,
ÜÜ^ _
expandOnSiteMap
ÜÜ` o
)
ÜÜo p
;
ÜÜp q
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# /
,
áá/ 0
	SqlDbType
áá1 :
.
áá: ;
UniqueIdentifier
áá; K
,
ááK L 
ParameterDirection
ááM _
.
áá_ `
Input
áá` e
,
ááe f
	pubTeamId
áág p
)
ááp q
;
ááq r
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
NVarChar
àà> F
,
ààF G
$num
ààH J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
bodyCssClass
ààf r
)
ààr s
;
ààs t
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 2
,
ââ2 3
	SqlDbType
ââ4 =
.
ââ= >
NVarChar
ââ> F
,
ââF G
$num
ââH J
,
ââJ K 
ParameterDirection
ââL ^
.
ââ^ _
Input
ââ_ d
,
ââd e
menuCssClass
ââf r
)
ââr s
;
ââs t
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 1
,
ää1 2
	SqlDbType
ää3 <
.
ää< =
Int
ää= @
,
ää@ A 
ParameterDirection
ääB T
.
ääT U
Input
ääU Z
,
ääZ [
publishMode
ää\ g
)
ääg h
;
ääh i
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# 1
,
åå1 2
	SqlDbType
åå3 <
.
åå< =
DateTime
åå= E
,
ååE F 
ParameterDirection
ååG Y
.
ååY Z
Input
ååZ _
,
åå_ `

createdUtc
ååa k
)
ååk l
;
åål m
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
UniqueIdentifier
çç< L
,
ççL M 
ParameterDirection
ççN `
.
çç` a
Input
çça f
,
ççf g
	createdBy
ççh q
)
ççq r
;
ççr s
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 1
,
éé1 2
	SqlDbType
éé3 <
.
éé< =
DateTime
éé= E
,
ééE F 
ParameterDirection
ééG Y
.
ééY Z
Input
ééZ _
,
éé_ `
DateTime
ééa i
.
ééi j
UtcNow
ééj p
)
éép q
;
ééq r
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# 0
,
èè0 1
	SqlDbType
èè2 ;
.
èè; <
UniqueIdentifier
èè< L
,
èèL M 
ParameterDirection
èèN `
.
èè` a
Input
èèa f
,
èèf g
	lastModBy
èèh q
)
èèq r
;
èèr s
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 4
,
êê4 5
	SqlDbType
êê6 ?
.
êê? @
NVarChar
êê@ H
,
êêH I
$num
êêJ L
,
êêL M 
ParameterDirection
êêN `
.
êê` a
Input
êêa f
,
êêf g
lastModFromIp
êêh u
)
êêu v
;
êêv w
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# .
,
ëë. /
	SqlDbType
ëë0 9
.
ëë9 :
NVarChar
ëë: B
,
ëëB C
-
ëëD E
$num
ëëE F
,
ëëF G 
ParameterDirection
ëëH Z
.
ëëZ [
Input
ëë[ `
,
ëë` a
menuDescription
ëëb q
)
ëëq r
;
ëër s
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# -
,
ìì- .
	SqlDbType
ìì/ 8
.
ìì8 9
NVarChar
ìì9 A
,
ììA B
$num
ììC E
,
ììE F 
ParameterDirection
ììG Y
.
ììY Z
Input
ììZ _
,
ìì_ `
linkRel
ììa h
)
ììh i
;
ììi j
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 1
,
îî1 2
	SqlDbType
îî3 <
.
îî< =
NVarChar
îî= E
,
îîE F
$num
îîG J
,
îîJ K 
ParameterDirection
îîL ^
.
îî^ _
Input
îî_ d
,
îîd e
pageHeading
îîf q
)
îîq r
;
îîr s
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 5
,
ïï5 6
	SqlDbType
ïï7 @
.
ïï@ A
Bit
ïïA D
,
ïïD E 
ParameterDirection
ïïF X
.
ïïX Y
Input
ïïY ^
,
ïï^ _
showPageHeading
ïï` o
)
ïïo p
;
ïïp q
if
ññ 
(
ññ 

pubDateUtc
ññ 
==
ññ 
DateTime
ññ &
.
ññ& '
MaxValue
ññ' /
)
ññ/ 0
{
óó 
sph
òò 
.
òò  
DefineSqlParameter
òò &
(
òò& '
$str
òò' 4
,
òò4 5
	SqlDbType
òò6 ?
.
òò? @
DateTime
òò@ H
,
òòH I 
ParameterDirection
òòJ \
.
òò\ ]
Input
òò] b
,
òòb c
DBNull
òòd j
.
òòj k
Value
òòk p
)
òòp q
;
òòq r
}
ôô 
else
öö 
{
õõ 
sph
úú 
.
úú  
DefineSqlParameter
úú &
(
úú& '
$str
úú' 4
,
úú4 5
	SqlDbType
úú6 ?
.
úú? @
DateTime
úú@ H
,
úúH I 
ParameterDirection
úúJ \
.
úú\ ]
Input
úú] b
,
úúb c

pubDateUtc
úúd n
)
úún o
;
úúo p
}
ùù 
int
†† 
rowsAffected
†† 
=
†† 
sph
†† "
.
††" #
ExecuteNonQuery
††# 2
(
††2 3
)
††3 4
;
††4 5
return
°° 
(
°° 
rowsAffected
°°  
>
°°! "
-
°°# $
$num
°°$ %
)
°°% &
;
°°& '
}
¢¢ 	
public
§§ 
static
§§ 
bool
§§ 
UpdateTimestamp
§§ *
(
§§* +
int
•• 
pageId
•• 
,
•• 
DateTime
¶¶ 
lastModifiedUtc
¶¶ $
)
¶¶$ %
{
ßß 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M&
GetWriteConnectionString
®®M e
(
®®e f
)
®®f g
,
®®g h
$str®®i É
,®®É Ñ
$num®®Ö Ü
)®®Ü á
;®®á à
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
pageId
©©W ]
)
©©] ^
;
©©^ _
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# 5
,
™™5 6
	SqlDbType
™™7 @
.
™™@ A
DateTime
™™A I
,
™™I J 
ParameterDirection
™™K ]
.
™™] ^
Input
™™^ c
,
™™c d
lastModifiedUtc
™™e t
)
™™t u
;
™™u v
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ "
.
´´" #
ExecuteNonQuery
´´# 2
(
´´2 3
)
´´3 4
;
´´4 5
return
¨¨ 
(
¨¨ 
rowsAffected
¨¨  
>
¨¨! "
-
¨¨# $
$num
¨¨$ %
)
¨¨% &
;
¨¨& '
}
≠≠ 	
public
ØØ 
static
ØØ 
bool
ØØ 
UpdatePageOrder
ØØ *
(
ØØ* +
int
ØØ+ .
pageId
ØØ/ 5
,
ØØ5 6
int
ØØ7 :
	pageOrder
ØØ; D
)
ØØD E
{
∞∞ 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M&
GetWriteConnectionString
±±M e
(
±±e f
)
±±f g
,
±±g h
$str±±i É
,±±É Ñ
$num±±Ö Ü
)±±Ü á
;±±á à
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# ,
,
≤≤, -
	SqlDbType
≤≤. 7
.
≤≤7 8
Int
≤≤8 ;
,
≤≤; < 
ParameterDirection
≤≤= O
.
≤≤O P
Input
≤≤P U
,
≤≤U V
pageId
≤≤W ]
)
≤≤] ^
;
≤≤^ _
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# /
,
≥≥/ 0
	SqlDbType
≥≥1 :
.
≥≥: ;
Int
≥≥; >
,
≥≥> ? 
ParameterDirection
≥≥@ R
.
≥≥R S
Input
≥≥S X
,
≥≥X Y
	pageOrder
≥≥Z c
)
≥≥c d
;
≥≥d e
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
sph
¥¥ "
.
¥¥" #
ExecuteNonQuery
¥¥# 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
-
µµ# $
$num
µµ$ %
)
µµ% &
;
µµ& '
}
∂∂ 	
public
∏∏ 
static
∏∏ 
bool
∏∏ 

DeletePage
∏∏ %
(
∏∏% &
int
∏∏& )
pageId
∏∏* 0
)
∏∏0 1
{
ππ 	 
SqlParameterHelper
∫∫ 
sph
∫∫ "
=
∫∫# $
new
∫∫% ( 
SqlParameterHelper
∫∫) ;
(
∫∫; <
ConnectionString
∫∫< L
.
∫∫L M&
GetWriteConnectionString
∫∫M e
(
∫∫e f
)
∫∫f g
,
∫∫g h
$str
∫∫i z
,
∫∫z {
$num
∫∫| }
)
∫∫} ~
;
∫∫~ 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# ,
,
ªª, -
	SqlDbType
ªª. 7
.
ªª7 8
Int
ªª8 ;
,
ªª; < 
ParameterDirection
ªª= O
.
ªªO P
Input
ªªP U
,
ªªU V
pageId
ªªW ]
)
ªª] ^
;
ªª^ _
int
ºº 
rowsAffected
ºº 
=
ºº 
sph
ºº "
.
ºº" #
ExecuteNonQuery
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
return
ΩΩ 
(
ΩΩ 
rowsAffected
ΩΩ  
>
ΩΩ! "
-
ΩΩ# $
$num
ΩΩ$ %
)
ΩΩ% &
;
ΩΩ& '
}
ææ 	
public
¿¿ 
static
¿¿ 
bool
¿¿ 
CleanupOrphans
¿¿ )
(
¿¿) *
)
¿¿* +
{
¡¡ 	 
SqlParameterHelper
¬¬ 
sph
¬¬ "
=
¬¬# $
new
¬¬% ( 
SqlParameterHelper
¬¬) ;
(
¬¬; <
ConnectionString
¬¬< L
.
¬¬L M&
GetWriteConnectionString
¬¬M e
(
¬¬e f
)
¬¬f g
,
¬¬g h
$str¬¬i Ç
,¬¬Ç É
$num¬¬Ñ Ö
)¬¬Ö Ü
;¬¬Ü á
int
√√ 
rowsAffected
√√ 
=
√√ 
sph
√√ "
.
√√" #
ExecuteNonQuery
√√# 2
(
√√2 3
)
√√3 4
;
√√4 5
return
ƒƒ 
(
ƒƒ 
rowsAffected
ƒƒ  
>
ƒƒ! "
-
ƒƒ# $
$num
ƒƒ$ %
)
ƒƒ% &
;
ƒƒ& '
}
≈≈ 	
public
…… 
static
…… 
IDataReader
…… !
GetPage
……" )
(
……) *
Guid
……* .
pageGuid
……/ 7
)
……7 8
{
   	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M%
GetReadConnectionString
ÀÀM d
(
ÀÀd e
)
ÀÀe f
,
ÀÀf g
$strÀÀh Ç
,ÀÀÇ É
$numÀÀÑ Ö
)ÀÀÖ Ü
;ÀÀÜ á
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# .
,
ÃÃ. /
	SqlDbType
ÃÃ0 9
.
ÃÃ9 :
UniqueIdentifier
ÃÃ: J
,
ÃÃJ K 
ParameterDirection
ÃÃL ^
.
ÃÃ^ _
Input
ÃÃ_ d
,
ÃÃd e
pageGuid
ÃÃf n
)
ÃÃn o
;
ÃÃo p
return
ÕÕ 
sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ $
(
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
ŒŒ 	
public
–– 
static
–– 
IDataReader
–– !
GetPage
––" )
(
––) *
int
––* -
siteId
––. 4
,
––4 5
int
––6 9
pageId
––: @
)
––@ A
{
—— 	 
SqlParameterHelper
““ 
sph
““ "
=
““# $
new
““% ( 
SqlParameterHelper
““) ;
(
““; <
ConnectionString
““< L
.
““L M%
GetReadConnectionString
““M d
(
““d e
)
““e f
,
““f g
$str
““h |
,
““| }
$num
““~ 
)““ Ä
;““Ä Å
sph
”” 
.
””  
DefineSqlParameter
”” "
(
””" #
$str
””# ,
,
””, -
	SqlDbType
””. 7
.
””7 8
Int
””8 ;
,
””; < 
ParameterDirection
””= O
.
””O P
Input
””P U
,
””U V
siteId
””W ]
)
””] ^
;
””^ _
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# ,
,
‘‘, -
	SqlDbType
‘‘. 7
.
‘‘7 8
Int
‘‘8 ;
,
‘‘; < 
ParameterDirection
‘‘= O
.
‘‘O P
Input
‘‘P U
,
‘‘U V
pageId
‘‘W ]
)
‘‘] ^
;
‘‘^ _
return
’’ 
sph
’’ 
.
’’ 
ExecuteReader
’’ $
(
’’$ %
)
’’% &
;
’’& '
}
÷÷ 	
public
ÿÿ 
static
ÿÿ 
IDataReader
ÿÿ !
GetPageList
ÿÿ" -
(
ÿÿ- .
int
ÿÿ. 1
siteId
ÿÿ2 8
)
ÿÿ8 9
{
ŸŸ 	 
SqlParameterHelper
⁄⁄ 
sph
⁄⁄ "
=
⁄⁄# $
new
⁄⁄% ( 
SqlParameterHelper
⁄⁄) ;
(
⁄⁄; <
ConnectionString
⁄⁄< L
.
⁄⁄L M%
GetReadConnectionString
⁄⁄M d
(
⁄⁄d e
)
⁄⁄e f
,
⁄⁄f g
$str⁄⁄h Ö
,⁄⁄Ö Ü
$num⁄⁄á à
)⁄⁄à â
;⁄⁄â ä
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# ,
,
€€, -
	SqlDbType
€€. 7
.
€€7 8
Int
€€8 ;
,
€€; < 
ParameterDirection
€€= O
.
€€O P
Input
€€P U
,
€€U V
siteId
€€W ]
)
€€] ^
;
€€^ _
return
‹‹ 
sph
‹‹ 
.
‹‹ 
ExecuteReader
‹‹ $
(
‹‹$ %
)
‹‹% &
;
‹‹& '
}
›› 	
public
ÊÊ 
static
ÊÊ 
IDataReader
ÊÊ !+
GetChildPagesSortedAlphabetic
ÊÊ" ?
(
ÊÊ? @
int
ÊÊ@ C
siteId
ÊÊD J
,
ÊÊJ K
int
ÊÊL O
parentId
ÊÊP X
)
ÊÊX Y
{
ÁÁ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh à
,ËËà â
$numËËä ã
)ËËã å
;ËËå ç
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# ,
,
ÈÈ, -
	SqlDbType
ÈÈ. 7
.
ÈÈ7 8
Int
ÈÈ8 ;
,
ÈÈ; < 
ParameterDirection
ÈÈ= O
.
ÈÈO P
Input
ÈÈP U
,
ÈÈU V
siteId
ÈÈW ]
)
ÈÈ] ^
;
ÈÈ^ _
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# .
,
ÍÍ. /
	SqlDbType
ÍÍ0 9
.
ÍÍ9 :
Int
ÍÍ: =
,
ÍÍ= > 
ParameterDirection
ÍÍ? Q
.
ÍÍQ R
Input
ÍÍR W
,
ÍÍW X
parentId
ÍÍY a
)
ÍÍa b
;
ÍÍb c
return
ÎÎ 
sph
ÎÎ 
.
ÎÎ 
ExecuteReader
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
}
ÏÏ 	
public
ÓÓ 
static
ÓÓ 
int
ÓÓ 
GetPendingCount
ÓÓ )
(
ÓÓ) *
Guid
ÓÓ* .
siteGuid
ÓÓ/ 7
)
ÓÓ7 8
{
ÔÔ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh â
,â ä
$numã å
)å ç
;ç é
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
UniqueIdentifier
ÒÒ: J
,
ÒÒJ K 
ParameterDirection
ÒÒL ^
.
ÒÒ^ _
Input
ÒÒ_ d
,
ÒÒd e
siteGuid
ÒÒf n
)
ÒÒn o
;
ÒÒo p
return
ÚÚ 
Convert
ÚÚ 
.
ÚÚ 
ToInt32
ÚÚ "
(
ÚÚ" #
sph
ÚÚ# &
.
ÚÚ& '
ExecuteScalar
ÚÚ' 4
(
ÚÚ4 5
)
ÚÚ5 6
)
ÚÚ6 7
;
ÚÚ7 8
}
ÛÛ 	
public
ıı 
static
ıı 
IDataReader
ıı !$
GetPendingPageListPage
ıı" 8
(
ıı8 9
Guid
ˆˆ 
siteGuid
ˆˆ 
,
ˆˆ 
int
˜˜ 

pageNumber
˜˜ 
,
˜˜ 
int
¯¯ 
pageSize
¯¯ 
,
¯¯ 
out
˘˘ 
int
˘˘ 

totalPages
˘˘ 
)
˘˘ 
{
˙˙ 	

totalPages
˚˚ 
=
˚˚ 
$num
˚˚ 
;
˚˚ 
int
¸¸ 
	totalRows
¸¸ 
=
¸¸ 
GetPendingCount
¸¸ +
(
¸¸+ ,
siteGuid
¸¸, 4
)
¸¸4 5
;
¸¸5 6
if
˛˛ 
(
˛˛ 
pageSize
˛˛ 
>
˛˛ 
$num
˛˛ 
)
˛˛ 

totalPages
˛˛ (
=
˛˛) *
	totalRows
˛˛+ 4
/
˛˛5 6
pageSize
˛˛7 ?
;
˛˛? @
if
ÄÄ 
(
ÄÄ 
	totalRows
ÄÄ 
<=
ÄÄ 
pageSize
ÄÄ %
)
ÄÄ% &
{
ÅÅ 

totalPages
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
int
ÜÜ 
	remainder
ÜÜ 
;
ÜÜ 
Math
áá 
.
áá 
DivRem
áá 
(
áá 
	totalRows
áá %
,
áá% &
pageSize
áá' /
,
áá/ 0
out
áá1 4
	remainder
áá5 >
)
áá> ?
;
áá? @
if
àà 
(
àà 
	remainder
àà 
>
àà 
$num
àà  !
)
àà! "
{
ââ 

totalPages
ää 
+=
ää !
$num
ää" #
;
ää# $
}
ãã 
}
åå  
SqlParameterHelper
éé 
sph
éé "
=
éé# $
new
éé% ( 
SqlParameterHelper
éé) ;
(
éé; <
ConnectionString
éé< L
.
ééL M%
GetReadConnectionString
ééM d
(
ééd e
)
éée f
,
ééf g
$strééh å
,ééå ç
$numééé è
)ééè ê
;ééê ë
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# .
,
èè. /
	SqlDbType
èè0 9
.
èè9 :
UniqueIdentifier
èè: J
,
èèJ K 
ParameterDirection
èèL ^
.
èè^ _
Input
èè_ d
,
èèd e
siteGuid
èèf n
)
èèn o
;
èèo p
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 0
,
êê0 1
	SqlDbType
êê2 ;
.
êê; <
Int
êê< ?
,
êê? @ 
ParameterDirection
êêA S
.
êêS T
Input
êêT Y
,
êêY Z

pageNumber
êê[ e
)
êêe f
;
êêf g
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# .
,
ëë. /
	SqlDbType
ëë0 9
.
ëë9 :
Int
ëë: =
,
ëë= > 
ParameterDirection
ëë? Q
.
ëëQ R
Input
ëëR W
,
ëëW X
pageSize
ëëY a
)
ëëa b
;
ëëb c
return
íí 
sph
íí 
.
íí 
ExecuteReader
íí $
(
íí$ %
)
íí% &
;
íí& '
}
ìì 	
public
ïï 
static
ïï 
IDataReader
ïï !
GetChildPages
ïï" /
(
ïï/ 0
int
ïï0 3
siteId
ïï4 :
,
ïï: ;
int
ïï< ?
parentPageId
ïï@ L
)
ïïL M
{
ññ 	 
SqlParameterHelper
óó 
sph
óó "
=
óó# $
new
óó% ( 
SqlParameterHelper
óó) ;
(
óó; <
ConnectionString
óó< L
.
óóL M%
GetReadConnectionString
óóM d
(
óód e
)
óóe f
,
óóf g
$stróóh É
,óóÉ Ñ
$numóóÖ Ü
)óóÜ á
;óóá à
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# ,
,
òò, -
	SqlDbType
òò. 7
.
òò7 8
Int
òò8 ;
,
òò; < 
ParameterDirection
òò= O
.
òòO P
Input
òòP U
,
òòU V
siteId
òòW ]
)
òò] ^
;
òò^ _
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# .
,
ôô. /
	SqlDbType
ôô0 9
.
ôô9 :
Int
ôô: =
,
ôô= > 
ParameterDirection
ôô? Q
.
ôôQ R
Input
ôôR W
,
ôôW X
parentPageId
ôôY e
)
ôôe f
;
ôôf g
return
öö 
sph
öö 
.
öö 
ExecuteReader
öö $
(
öö$ %
)
öö% &
;
öö& '
}
õõ 	
public
§§ 
static
§§ 
int
§§ 
GetNextPageOrder
§§ *
(
§§* +
int
•• 
siteId
•• 
,
•• 
int
¶¶ 
parentId
¶¶ 
)
¶¶ 
{
ßß 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M%
GetReadConnectionString
®®M d
(
®®d e
)
®®e f
,
®®f g
$str®®h É
,®®É Ñ
$num®®Ö Ü
)®®Ü á
;®®á à
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
siteId
©©W ]
)
©©] ^
;
©©^ _
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# .
,
™™. /
	SqlDbType
™™0 9
.
™™9 :
Int
™™: =
,
™™= > 
ParameterDirection
™™? Q
.
™™Q R
Input
™™R W
,
™™W X
parentId
™™Y a
)
™™a b
;
™™b c
int
´´ 
	pageOrder
´´ 
=
´´ 
Convert
´´ #
.
´´# $
ToInt32
´´$ +
(
´´+ ,
sph
´´, /
.
´´/ 0
ExecuteScalar
´´0 =
(
´´= >
)
´´> ?
)
´´? @
;
´´@ A
return
¨¨ 
	pageOrder
¨¨ 
;
¨¨ 
}
≠≠ 	
public
ØØ 
static
ØØ 
int
ØØ 
GetCount
ØØ "
(
ØØ" #
int
ØØ# &
siteId
ØØ' -
,
ØØ- .
bool
ØØ/ 3
includePending
ØØ4 B
)
ØØB C
{
∞∞ 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str
±±h ~
,
±±~ 
$num±±Ä Å
)±±Å Ç
;±±Ç É
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# ,
,
≥≥, -
	SqlDbType
≥≥. 7
.
≥≥7 8
Int
≥≥8 ;
,
≥≥; < 
ParameterDirection
≥≥= O
.
≥≥O P
Input
≥≥P U
,
≥≥U V
siteId
≥≥W ]
)
≥≥] ^
;
≥≥^ _
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 4
,
¥¥4 5
	SqlDbType
¥¥6 ?
.
¥¥? @
Bit
¥¥@ C
,
¥¥C D 
ParameterDirection
¥¥E W
.
¥¥W X
Input
¥¥X ]
,
¥¥] ^
includePending
¥¥_ m
)
¥¥m n
;
¥¥n o
return
µµ 
Convert
µµ 
.
µµ 
ToInt32
µµ "
(
µµ" #
sph
µµ# &
.
µµ& '
ExecuteScalar
µµ' 4
(
µµ4 5
)
µµ5 6
)
µµ6 7
;
µµ7 8
}
∂∂ 	
public
∏∏ 
static
∏∏ 
int
∏∏  
GetCountChildPages
∏∏ ,
(
∏∏, -
int
∏∏- 0
pageId
∏∏1 7
,
∏∏7 8
bool
∏∏9 =
includePending
∏∏> L
)
∏∏L M
{
ππ 	 
SqlParameterHelper
∫∫ 
sph
∫∫ "
=
∫∫# $
new
∫∫% ( 
SqlParameterHelper
∫∫) ;
(
∫∫; <
ConnectionString
∫∫< L
.
∫∫L M%
GetReadConnectionString
∫∫M d
(
∫∫d e
)
∫∫e f
,
∫∫f g
$str∫∫h Ç
,∫∫Ç É
$num∫∫Ñ Ö
)∫∫Ö Ü
;∫∫Ü á
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# ,
,
ºº, -
	SqlDbType
ºº. 7
.
ºº7 8
Int
ºº8 ;
,
ºº; < 
ParameterDirection
ºº= O
.
ººO P
Input
ººP U
,
ººU V
pageId
ººW ]
)
ºº] ^
;
ºº^ _
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# 4
,
ΩΩ4 5
	SqlDbType
ΩΩ6 ?
.
ΩΩ? @
Bit
ΩΩ@ C
,
ΩΩC D 
ParameterDirection
ΩΩE W
.
ΩΩW X
Input
ΩΩX ]
,
ΩΩ] ^
includePending
ΩΩ_ m
)
ΩΩm n
;
ΩΩn o
return
ææ 
Convert
ææ 
.
ææ 
ToInt32
ææ "
(
ææ" #
sph
ææ# &
.
ææ& '
ExecuteScalar
ææ' 4
(
ææ4 5
)
ææ5 6
)
ææ6 7
;
ææ7 8
}
øø 	
public
¡¡ 
static
¡¡ 
IDataReader
¡¡ !
GetPageOfPages
¡¡" 0
(
¡¡0 1
int
¬¬ 
siteId
¬¬ 
,
¬¬ 
bool
√√ 
includePending
√√ 
,
√√  
int
ƒƒ 

pageNumber
ƒƒ 
,
ƒƒ 
int
≈≈ 
pageSize
≈≈ 
,
≈≈ 
out
∆∆ 
int
∆∆ 

totalPages
∆∆ 
)
∆∆ 
{
«« 	

totalPages
»» 
=
»» 
$num
»» 
;
»» 
int
…… 
	totalRows
…… 
=
…… 
GetCount
…… $
(
……$ %
siteId
……% +
,
……+ ,
includePending
……- ;
)
……; <
;
……< =
if
ÀÀ 
(
ÀÀ 
pageSize
ÀÀ 
>
ÀÀ 
$num
ÀÀ 
)
ÀÀ 

totalPages
ÀÀ (
=
ÀÀ) *
	totalRows
ÀÀ+ 4
/
ÀÀ5 6
pageSize
ÀÀ7 ?
;
ÀÀ? @
if
ÕÕ 
(
ÕÕ 
	totalRows
ÕÕ 
<=
ÕÕ 
pageSize
ÕÕ %
)
ÕÕ% &
{
ŒŒ 

totalPages
œœ 
=
œœ 
$num
œœ 
;
œœ 
}
–– 
else
—— 
{
““ 
int
”” 
	remainder
”” 
;
”” 
Math
‘‘ 
.
‘‘ 
DivRem
‘‘ 
(
‘‘ 
	totalRows
‘‘ %
,
‘‘% &
pageSize
‘‘' /
,
‘‘/ 0
out
‘‘1 4
	remainder
‘‘5 >
)
‘‘> ?
;
‘‘? @
if
’’ 
(
’’ 
	remainder
’’ 
>
’’ 
$num
’’  !
)
’’! "
{
÷÷ 

totalPages
◊◊ 
+=
◊◊ !
$num
◊◊" #
;
◊◊# $
}
ÿÿ 
}
ŸŸ  
SqlParameterHelper
€€ 
sph
€€ "
=
€€# $
new
€€% ( 
SqlParameterHelper
€€) ;
(
€€; <
ConnectionString
€€< L
.
€€L M%
GetReadConnectionString
€€M d
(
€€d e
)
€€e f
,
€€f g
$str
€€h }
,
€€} ~
$num€€ Ä
)€€Ä Å
;€€Å Ç
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# ,
,
‹‹, -
	SqlDbType
‹‹. 7
.
‹‹7 8
Int
‹‹8 ;
,
‹‹; < 
ParameterDirection
‹‹= O
.
‹‹O P
Input
‹‹P U
,
‹‹U V
siteId
‹‹W ]
)
‹‹] ^
;
‹‹^ _
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# 4
,
››4 5
	SqlDbType
››6 ?
.
››? @
Bit
››@ C
,
››C D 
ParameterDirection
››E W
.
››W X
Input
››X ]
,
››] ^
includePending
››_ m
)
››m n
;
››n o
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# 0
,
ﬁﬁ0 1
	SqlDbType
ﬁﬁ2 ;
.
ﬁﬁ; <
Int
ﬁﬁ< ?
,
ﬁﬁ? @ 
ParameterDirection
ﬁﬁA S
.
ﬁﬁS T
Input
ﬁﬁT Y
,
ﬁﬁY Z

pageNumber
ﬁﬁ[ e
)
ﬁﬁe f
;
ﬁﬁf g
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# .
,
ﬂﬂ. /
	SqlDbType
ﬂﬂ0 9
.
ﬂﬂ9 :
Int
ﬂﬂ: =
,
ﬂﬂ= > 
ParameterDirection
ﬂﬂ? Q
.
ﬂﬂQ R
Input
ﬂﬂR W
,
ﬂﬂW X
pageSize
ﬂﬂY a
)
ﬂﬂa b
;
ﬂﬂb c
return
‡‡ 
sph
‡‡ 
.
‡‡ 
ExecuteReader
‡‡ $
(
‡‡$ %
)
‡‡% &
;
‡‡& '
}
‚‚ 	
}
ÂÂ 
}ÊÊ ãÜ
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPayPalLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPayPalLog #
{ 
public11 
static11 
int11 
Create11  
(11  !
Guid22 
rowGuid22 
,22 
DateTime33 

createdUtc33 
,33  
Guid44 
siteGuid44 
,44 
Guid55 
userGuid55 
,55 
Guid66 
	storeGuid66 
,66 
Guid77 
cartGuid77 
,77 
string88 
requestType88 
,88 
string99 

apiVersion99 
,99 
string:: 
rawResponse:: 
,:: 
string;; 
token;; 
,;; 
string<< 
payerId<< 
,<< 
string== 
transactionId==  
,==  !
string>> 
paymentType>> 
,>> 
string?? 
paymentStatus??  
,??  !
string@@ 
pendingReason@@  
,@@  !
stringAA 

reasonCodeAA 
,AA 
stringBB 
currencyCodeBB 
,BB  
decimalCC 
exchangeRateCC  
,CC  !
decimalDD 
	cartTotalDD 
,DD 
decimalEE 
	payPalAmtEE 
,EE 
decimalFF 
taxAmtFF 
,FF 
decimalGG 
feeAmtGG 
,GG 
decimalHH 
	settleAmtHH 
,HH 
stringII 
providerNameII 
,II  
stringJJ 
	returnUrlJJ 
,JJ 
stringKK 
serializedObjectKK #
,KK# $
stringLL 
pdtProviderNameLL "
,LL" #
stringMM 
ipnProviderNameMM "
,MM" #
stringNN 
responseNN 
)NN 
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$strPPi ~
,PP~ 
$num
PPÄ Ç
)
PPÇ É
;
PPÉ Ñ
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
UniqueIdentifierQQ9 I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
rowGuidQQe l
)QQl m
;QQm n
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
DateTimeRR< D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _

createdUtcRR` j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
siteGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
userGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# /
,UU/ 0
	SqlDbTypeUU1 :
.UU: ;
UniqueIdentifierUU; K
,UUK L
ParameterDirectionUUM _
.UU_ `
InputUU` e
,UUe f
	storeGuidUUg p
)UUp q
;UUq r
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# .
,VV. /
	SqlDbTypeVV0 9
.VV9 :
UniqueIdentifierVV: J
,VVJ K
ParameterDirectionVVL ^
.VV^ _
InputVV_ d
,VVd e
cartGuidVVf n
)VVn o
;VVo p
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 1
,WW1 2
	SqlDbTypeWW3 <
.WW< =
NVarCharWW= E
,WWE F
$numWWG J
,WWJ K
ParameterDirectionWWL ^
.WW^ _
InputWW_ d
,WWd e
requestTypeWWf q
)WWq r
;WWr s
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 0
,XX0 1
	SqlDbTypeXX2 ;
.XX; <
NVarCharXX< D
,XXD E
$numXXF H
,XXH I
ParameterDirectionXXJ \
.XX\ ]
InputXX] b
,XXb c

apiVersionXXd n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 1
,YY1 2
	SqlDbTypeYY3 <
.YY< =
NVarCharYY= E
,YYE F
-YYG H
$numYYH I
,YYI J
ParameterDirectionYYK ]
.YY] ^
InputYY^ c
,YYc d
rawResponseYYe p
)YYp q
;YYq r
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# +
,ZZ+ ,
	SqlDbTypeZZ- 6
.ZZ6 7
NVarCharZZ7 ?
,ZZ? @
$numZZA C
,ZZC D
ParameterDirectionZZE W
.ZZW X
InputZZX ]
,ZZ] ^
tokenZZ_ d
)ZZd e
;ZZe f
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# -
,[[- .
	SqlDbType[[/ 8
.[[8 9
NVarChar[[9 A
,[[A B
$num[[C E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
payerId[[a h
)[[h i
;[[i j
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 3
,\\3 4
	SqlDbType\\5 >
.\\> ?
NVarChar\\? G
,\\G H
$num\\I K
,\\K L
ParameterDirection\\M _
.\\_ `
Input\\` e
,\\e f
transactionId\\g t
)\\t u
;\\u v
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 1
,]]1 2
	SqlDbType]]3 <
.]]< =
NVarChar]]= E
,]]E F
$num]]G I
,]]I J
ParameterDirection]]K ]
.]]] ^
Input]]^ c
,]]c d
paymentType]]e p
)]]p q
;]]q r
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 3
,^^3 4
	SqlDbType^^5 >
.^^> ?
NVarChar^^? G
,^^G H
$num^^I K
,^^K L
ParameterDirection^^M _
.^^_ `
Input^^` e
,^^e f
paymentStatus^^g t
)^^t u
;^^u v
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 3
,__3 4
	SqlDbType__5 >
.__> ?
NVarChar__? G
,__G H
$num__I L
,__L M
ParameterDirection__N `
.__` a
Input__a f
,__f g
pendingReason__h u
)__u v
;__v w
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
NVarChar``< D
,``D E
$num``F H
,``H I
ParameterDirection``J \
.``\ ]
Input``] b
,``b c

reasonCode``d n
)``n o
;``o p
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
NVarCharaa> F
,aaF G
$numaaH J
,aaJ K
ParameterDirectionaaL ^
.aa^ _
Inputaa_ d
,aad e
currencyCodeaaf r
)aar s
;aas t
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
Decimalbb> E
,bbE F
ParameterDirectionbbG Y
.bbY Z
InputbbZ _
,bb_ `
exchangeRatebba m
)bbm n
;bbn o
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
Decimalcc; B
,ccB C
ParameterDirectionccD V
.ccV W
InputccW \
,cc\ ]
	cartTotalcc^ g
)ccg h
;cch i
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# /
,dd/ 0
	SqlDbTypedd1 :
.dd: ;
Decimaldd; B
,ddB C
ParameterDirectionddD V
.ddV W
InputddW \
,dd\ ]
	payPalAmtdd^ g
)ddg h
;ddh i
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
Decimalee8 ?
,ee? @
ParameterDirectioneeA S
.eeS T
InputeeT Y
,eeY Z
taxAmtee[ a
)eea b
;eeb c
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# ,
,ff, -
	SqlDbTypeff. 7
.ff7 8
Decimalff8 ?
,ff? @
ParameterDirectionffA S
.ffS T
InputffT Y
,ffY Z
feeAmtff[ a
)ffa b
;ffb c
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# /
,gg/ 0
	SqlDbTypegg1 :
.gg: ;
Decimalgg; B
,ggB C
ParameterDirectionggD V
.ggV W
InputggW \
,gg\ ]
	settleAmtgg^ g
)ggg h
;ggh i
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 2
,hh2 3
	SqlDbTypehh4 =
.hh= >
NVarCharhh> F
,hhF G
$numhhH K
,hhK L
ParameterDirectionhhM _
.hh_ `
Inputhh` e
,hhe f
providerNamehhg s
)hhs t
;hht u
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# /
,ii/ 0
	SqlDbTypeii1 :
.ii: ;
NVarCharii; C
,iiC D
$numiiE H
,iiH I
ParameterDirectioniiJ \
.ii\ ]
Inputii] b
,iib c
	returnUrliid m
)iim n
;iin o
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 6
,jj6 7
	SqlDbTypejj8 A
.jjA B
NVarCharjjB J
,jjJ K
-jjL M
$numjjM N
,jjN O
ParameterDirectionjjP b
.jjb c
Inputjjc h
,jjh i
serializedObjectjjj z
)jjz {
;jj{ |
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 5
,kk5 6
	SqlDbTypekk7 @
.kk@ A
NVarCharkkA I
,kkI J
$numkkK N
,kkN O
ParameterDirectionkkP b
.kkb c
Inputkkc h
,kkh i
pdtProviderNamekkj y
)kky z
;kkz {
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 5
,ll5 6
	SqlDbTypell7 @
.ll@ A
NVarCharllA I
,llI J
$numllK N
,llN O
ParameterDirectionllP b
.llb c
Inputllc h
,llh i
ipnProviderNamellj y
)lly z
;llz {
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# .
,mm. /
	SqlDbTypemm0 9
.mm9 :
NVarCharmm: B
,mmB C
$nummmD G
,mmG H
ParameterDirectionmmI [
.mm[ \
Inputmm\ a
,mma b
responsemmc k
)mmk l
;mml m
intoo 
rowsAffectedoo 
=oo 
sphoo "
.oo" #
ExecuteNonQueryoo# 2
(oo2 3
)oo3 4
;oo4 5
returnpp 
rowsAffectedpp 
;pp  
}rr 	
public
êê 
static
êê 
bool
êê 
Update
êê !
(
êê! "
Guid
ëë 
rowGuid
ëë 
,
ëë 
DateTime
íí 

createdUtc
íí 
,
íí  
Guid
ìì 
siteGuid
ìì 
,
ìì 
Guid
îî 
userGuid
îî 
,
îî 
Guid
ïï 
	storeGuid
ïï 
,
ïï 
Guid
ññ 
cartGuid
ññ 
,
ññ 
string
óó 
requestType
óó 
,
óó 
string
òò 

apiVersion
òò 
,
òò 
string
ôô 
rawResponse
ôô 
,
ôô 
string
öö 
token
öö 
,
öö 
string
õõ 
payerId
õõ 
,
õõ 
string
úú 
transactionId
úú  
,
úú  !
string
ùù 
paymentType
ùù 
,
ùù 
string
ûû 
paymentStatus
ûû  
,
ûû  !
string
üü 
pendingReason
üü  
,
üü  !
string
†† 

reasonCode
†† 
,
†† 
string
°° 
currencyCode
°° 
,
°°  
decimal
¢¢ 
exchangeRate
¢¢  
,
¢¢  !
decimal
££ 
	cartTotal
££ 
,
££ 
decimal
§§ 
	payPalAmt
§§ 
,
§§ 
decimal
•• 
taxAmt
•• 
,
•• 
decimal
¶¶ 
feeAmt
¶¶ 
,
¶¶ 
decimal
ßß 
	settleAmt
ßß 
)
ßß 
{
®® 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str
©©i ~
,
©©~ 
$num©©Ä Ç
)©©Ç É
;©©É Ñ
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# -
,
™™- .
	SqlDbType
™™/ 8
.
™™8 9
UniqueIdentifier
™™9 I
,
™™I J 
ParameterDirection
™™K ]
.
™™] ^
Input
™™^ c
,
™™c d
rowGuid
™™e l
)
™™l m
;
™™m n
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 0
,
´´0 1
	SqlDbType
´´2 ;
.
´´; <
DateTime
´´< D
,
´´D E 
ParameterDirection
´´F X
.
´´X Y
Input
´´Y ^
,
´´^ _

createdUtc
´´` j
)
´´j k
;
´´k l
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# .
,
¨¨. /
	SqlDbType
¨¨0 9
.
¨¨9 :
UniqueIdentifier
¨¨: J
,
¨¨J K 
ParameterDirection
¨¨L ^
.
¨¨^ _
Input
¨¨_ d
,
¨¨d e
siteGuid
¨¨f n
)
¨¨n o
;
¨¨o p
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# .
,
≠≠. /
	SqlDbType
≠≠0 9
.
≠≠9 :
UniqueIdentifier
≠≠: J
,
≠≠J K 
ParameterDirection
≠≠L ^
.
≠≠^ _
Input
≠≠_ d
,
≠≠d e
userGuid
≠≠f n
)
≠≠n o
;
≠≠o p
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# /
,
ÆÆ/ 0
	SqlDbType
ÆÆ1 :
.
ÆÆ: ;
UniqueIdentifier
ÆÆ; K
,
ÆÆK L 
ParameterDirection
ÆÆM _
.
ÆÆ_ `
Input
ÆÆ` e
,
ÆÆe f
	storeGuid
ÆÆg p
)
ÆÆp q
;
ÆÆq r
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
UniqueIdentifier
ØØ: J
,
ØØJ K 
ParameterDirection
ØØL ^
.
ØØ^ _
Input
ØØ_ d
,
ØØd e
cartGuid
ØØf n
)
ØØn o
;
ØØo p
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# 1
,
∞∞1 2
	SqlDbType
∞∞3 <
.
∞∞< =
NVarChar
∞∞= E
,
∞∞E F
$num
∞∞G J
,
∞∞J K 
ParameterDirection
∞∞L ^
.
∞∞^ _
Input
∞∞_ d
,
∞∞d e
requestType
∞∞f q
)
∞∞q r
;
∞∞r s
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# 0
,
±±0 1
	SqlDbType
±±2 ;
.
±±; <
NVarChar
±±< D
,
±±D E
$num
±±F H
,
±±H I 
ParameterDirection
±±J \
.
±±\ ]
Input
±±] b
,
±±b c

apiVersion
±±d n
)
±±n o
;
±±o p
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# 1
,
≤≤1 2
	SqlDbType
≤≤3 <
.
≤≤< =
NVarChar
≤≤= E
,
≤≤E F
-
≤≤G H
$num
≤≤H I
,
≤≤I J 
ParameterDirection
≤≤K ]
.
≤≤] ^
Input
≤≤^ c
,
≤≤c d
rawResponse
≤≤e p
)
≤≤p q
;
≤≤q r
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# +
,
≥≥+ ,
	SqlDbType
≥≥- 6
.
≥≥6 7
NVarChar
≥≥7 ?
,
≥≥? @
$num
≥≥A C
,
≥≥C D 
ParameterDirection
≥≥E W
.
≥≥W X
Input
≥≥X ]
,
≥≥] ^
token
≥≥_ d
)
≥≥d e
;
≥≥e f
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# -
,
¥¥- .
	SqlDbType
¥¥/ 8
.
¥¥8 9
NVarChar
¥¥9 A
,
¥¥A B
$num
¥¥C E
,
¥¥E F 
ParameterDirection
¥¥G Y
.
¥¥Y Z
Input
¥¥Z _
,
¥¥_ `
payerId
¥¥a h
)
¥¥h i
;
¥¥i j
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 3
,
µµ3 4
	SqlDbType
µµ5 >
.
µµ> ?
NVarChar
µµ? G
,
µµG H
$num
µµI K
,
µµK L 
ParameterDirection
µµM _
.
µµ_ `
Input
µµ` e
,
µµe f
transactionId
µµg t
)
µµt u
;
µµu v
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# 1
,
∂∂1 2
	SqlDbType
∂∂3 <
.
∂∂< =
NVarChar
∂∂= E
,
∂∂E F
$num
∂∂G I
,
∂∂I J 
ParameterDirection
∂∂K ]
.
∂∂] ^
Input
∂∂^ c
,
∂∂c d
paymentType
∂∂e p
)
∂∂p q
;
∂∂q r
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# 3
,
∑∑3 4
	SqlDbType
∑∑5 >
.
∑∑> ?
NVarChar
∑∑? G
,
∑∑G H
$num
∑∑I K
,
∑∑K L 
ParameterDirection
∑∑M _
.
∑∑_ `
Input
∑∑` e
,
∑∑e f
paymentStatus
∑∑g t
)
∑∑t u
;
∑∑u v
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# 3
,
∏∏3 4
	SqlDbType
∏∏5 >
.
∏∏> ?
NVarChar
∏∏? G
,
∏∏G H
$num
∏∏I L
,
∏∏L M 
ParameterDirection
∏∏N `
.
∏∏` a
Input
∏∏a f
,
∏∏f g
pendingReason
∏∏h u
)
∏∏u v
;
∏∏v w
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# 0
,
ππ0 1
	SqlDbType
ππ2 ;
.
ππ; <
NVarChar
ππ< D
,
ππD E
$num
ππF H
,
ππH I 
ParameterDirection
ππJ \
.
ππ\ ]
Input
ππ] b
,
ππb c

reasonCode
ππd n
)
ππn o
;
ππo p
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# 2
,
∫∫2 3
	SqlDbType
∫∫4 =
.
∫∫= >
NVarChar
∫∫> F
,
∫∫F G
$num
∫∫H J
,
∫∫J K 
ParameterDirection
∫∫L ^
.
∫∫^ _
Input
∫∫_ d
,
∫∫d e
currencyCode
∫∫f r
)
∫∫r s
;
∫∫s t
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 2
,
ªª2 3
	SqlDbType
ªª4 =
.
ªª= >
Decimal
ªª> E
,
ªªE F 
ParameterDirection
ªªG Y
.
ªªY Z
Input
ªªZ _
,
ªª_ `
exchangeRate
ªªa m
)
ªªm n
;
ªªn o
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# /
,
ºº/ 0
	SqlDbType
ºº1 :
.
ºº: ;
Decimal
ºº; B
,
ººB C 
ParameterDirection
ººD V
.
ººV W
Input
ººW \
,
ºº\ ]
	cartTotal
ºº^ g
)
ººg h
;
ººh i
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# /
,
ΩΩ/ 0
	SqlDbType
ΩΩ1 :
.
ΩΩ: ;
Decimal
ΩΩ; B
,
ΩΩB C 
ParameterDirection
ΩΩD V
.
ΩΩV W
Input
ΩΩW \
,
ΩΩ\ ]
	payPalAmt
ΩΩ^ g
)
ΩΩg h
;
ΩΩh i
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# ,
,
ææ, -
	SqlDbType
ææ. 7
.
ææ7 8
Decimal
ææ8 ?
,
ææ? @ 
ParameterDirection
ææA S
.
ææS T
Input
ææT Y
,
ææY Z
taxAmt
ææ[ a
)
ææa b
;
ææb c
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# ,
,
øø, -
	SqlDbType
øø. 7
.
øø7 8
Decimal
øø8 ?
,
øø? @ 
ParameterDirection
øøA S
.
øøS T
Input
øøT Y
,
øøY Z
feeAmt
øø[ a
)
øøa b
;
øøb c
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# /
,
¿¿/ 0
	SqlDbType
¿¿1 :
.
¿¿: ;
Decimal
¿¿; B
,
¿¿B C 
ParameterDirection
¿¿D V
.
¿¿V W
Input
¿¿W \
,
¿¿\ ]
	settleAmt
¿¿^ g
)
¿¿g h
;
¿¿h i
int
¡¡ 
rowsAffected
¡¡ 
=
¡¡ 
sph
¡¡ "
.
¡¡" #
ExecuteNonQuery
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
$num
¬¬# $
)
¬¬$ %
;
¬¬% &
}
ƒƒ 	
public
ÀÀ 
static
ÀÀ 
bool
ÀÀ 
Delete
ÀÀ !
(
ÀÀ! "
Guid
ÀÀ" &
rowGuid
ÀÀ' .
)
ÀÀ. /
{
ÃÃ 	 
SqlParameterHelper
ÕÕ 
sph
ÕÕ "
=
ÕÕ# $
new
ÕÕ% ( 
SqlParameterHelper
ÕÕ) ;
(
ÕÕ; <
ConnectionString
ÕÕ< L
.
ÕÕL M&
GetWriteConnectionString
ÕÕM e
(
ÕÕe f
)
ÕÕf g
,
ÕÕg h
$str
ÕÕi ~
,
ÕÕ~ 
$numÕÕÄ Å
)ÕÕÅ Ç
;ÕÕÇ É
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# -
,
ŒŒ- .
	SqlDbType
ŒŒ/ 8
.
ŒŒ8 9
UniqueIdentifier
ŒŒ9 I
,
ŒŒI J 
ParameterDirection
ŒŒK ]
.
ŒŒ] ^
Input
ŒŒ^ c
,
ŒŒc d
rowGuid
ŒŒe l
)
ŒŒl m
;
ŒŒm n
int
œœ 
rowsAffected
œœ 
=
œœ 
sph
œœ "
.
œœ" #
ExecuteNonQuery
œœ# 2
(
œœ2 3
)
œœ3 4
;
œœ4 5
return
–– 
(
–– 
rowsAffected
––  
>
––! "
$num
––# $
)
––$ %
;
––% &
}
““ 	
public
‘‘ 
static
‘‘ 
bool
‘‘ 
DeleteByCart
‘‘ '
(
‘‘' (
Guid
‘‘( ,
cartGuid
‘‘- 5
)
‘‘5 6
{
’’ 	 
SqlParameterHelper
÷÷ 
sph
÷÷ "
=
÷÷# $
new
÷÷% ( 
SqlParameterHelper
÷÷) ;
(
÷÷; <
ConnectionString
÷÷< L
.
÷÷L M&
GetWriteConnectionString
÷÷M e
(
÷÷e f
)
÷÷f g
,
÷÷g h
$str÷÷i Ñ
,÷÷Ñ Ö
$num÷÷Ü á
)÷÷á à
;÷÷à â
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ "
(
◊◊" #
$str
◊◊# .
,
◊◊. /
	SqlDbType
◊◊0 9
.
◊◊9 :
UniqueIdentifier
◊◊: J
,
◊◊J K 
ParameterDirection
◊◊L ^
.
◊◊^ _
Input
◊◊_ d
,
◊◊d e
cartGuid
◊◊f n
)
◊◊n o
;
◊◊o p
int
ÿÿ 
rowsAffected
ÿÿ 
=
ÿÿ 
sph
ÿÿ "
.
ÿÿ" #
ExecuteNonQuery
ÿÿ# 2
(
ÿÿ2 3
)
ÿÿ3 4
;
ÿÿ4 5
return
ŸŸ 
(
ŸŸ 
rowsAffected
ŸŸ  
>
ŸŸ! "
$num
ŸŸ# $
)
ŸŸ$ %
;
ŸŸ% &
}
€€ 	
public
›› 
static
›› 
bool
›› 
DeleteBySite
›› '
(
››' (
Guid
››( ,
siteGuid
››- 5
)
››5 6
{
ﬁﬁ 	 
SqlParameterHelper
ﬂﬂ 
sph
ﬂﬂ "
=
ﬂﬂ# $
new
ﬂﬂ% ( 
SqlParameterHelper
ﬂﬂ) ;
(
ﬂﬂ; <
ConnectionString
ﬂﬂ< L
.
ﬂﬂL M&
GetWriteConnectionString
ﬂﬂM e
(
ﬂﬂe f
)
ﬂﬂf g
,
ﬂﬂg h
$strﬂﬂi Ñ
,ﬂﬂÑ Ö
$numﬂﬂÜ á
)ﬂﬂá à
;ﬂﬂà â
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# .
,
‡‡. /
	SqlDbType
‡‡0 9
.
‡‡9 :
UniqueIdentifier
‡‡: J
,
‡‡J K 
ParameterDirection
‡‡L ^
.
‡‡^ _
Input
‡‡_ d
,
‡‡d e
siteGuid
‡‡f n
)
‡‡n o
;
‡‡o p
int
·· 
rowsAffected
·· 
=
·· 
sph
·· "
.
··" #
ExecuteNonQuery
··# 2
(
··2 3
)
··3 4
;
··4 5
return
‚‚ 
(
‚‚ 
rowsAffected
‚‚  
>
‚‚! "
$num
‚‚# $
)
‚‚$ %
;
‚‚% &
}
‰‰ 	
public
ÊÊ 
static
ÊÊ 
bool
ÊÊ 
DeleteByStore
ÊÊ (
(
ÊÊ( )
Guid
ÊÊ) -
	storeGuid
ÊÊ. 7
)
ÊÊ7 8
{
ÁÁ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M&
GetWriteConnectionString
ËËM e
(
ËËe f
)
ËËf g
,
ËËg h
$strËËi Ö
,ËËÖ Ü
$numËËá à
)ËËà â
;ËËâ ä
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# /
,
ÈÈ/ 0
	SqlDbType
ÈÈ1 :
.
ÈÈ: ;
UniqueIdentifier
ÈÈ; K
,
ÈÈK L 
ParameterDirection
ÈÈM _
.
ÈÈ_ `
Input
ÈÈ` e
,
ÈÈe f
	storeGuid
ÈÈg p
)
ÈÈp q
;
ÈÈq r
int
ÍÍ 
rowsAffected
ÍÍ 
=
ÍÍ 
sph
ÍÍ "
.
ÍÍ" #
ExecuteNonQuery
ÍÍ# 2
(
ÍÍ2 3
)
ÍÍ3 4
;
ÍÍ4 5
return
ÎÎ 
(
ÎÎ 
rowsAffected
ÎÎ  
>
ÎÎ! "
$num
ÎÎ# $
)
ÎÎ$ %
;
ÎÎ% &
}
ÌÌ 	
public
ÛÛ 
static
ÛÛ 
IDataReader
ÛÛ !
GetOne
ÛÛ" (
(
ÛÛ( )
Guid
ÛÛ) -
rowGuid
ÛÛ. 5
)
ÛÛ5 6
{
ÙÙ 	 
SqlParameterHelper
ıı 
sph
ıı "
=
ıı# $
new
ıı% ( 
SqlParameterHelper
ıı) ;
(
ıı; <
ConnectionString
ıı< L
.
ııL M%
GetReadConnectionString
ııM d
(
ııd e
)
ııe f
,
ııf g
$strııh Ä
,ııÄ Å
$numııÇ É
)ııÉ Ñ
;ııÑ Ö
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ "
(
ˆˆ" #
$str
ˆˆ# -
,
ˆˆ- .
	SqlDbType
ˆˆ/ 8
.
ˆˆ8 9
UniqueIdentifier
ˆˆ9 I
,
ˆˆI J 
ParameterDirection
ˆˆK ]
.
ˆˆ] ^
Input
ˆˆ^ c
,
ˆˆc d
rowGuid
ˆˆe l
)
ˆˆl m
;
ˆˆm n
return
˜˜ 
sph
˜˜ 
.
˜˜ 
ExecuteReader
˜˜ $
(
˜˜$ %
)
˜˜% &
;
˜˜& '
}
˘˘ 	
public
ˇˇ 
static
ˇˇ 
IDataReader
ˇˇ !
	GetByCart
ˇˇ" +
(
ˇˇ+ ,
Guid
ˇˇ, 0
cartGuid
ˇˇ1 9
)
ˇˇ9 :
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M%
GetReadConnectionString
ÅÅM d
(
ÅÅd e
)
ÅÅe f
,
ÅÅf g
$strÅÅh É
,ÅÅÉ Ñ
$numÅÅÖ Ü
)ÅÅÜ á
;ÅÅá à
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
UniqueIdentifier
ÇÇ: J
,
ÇÇJ K 
ParameterDirection
ÇÇL ^
.
ÇÇ^ _
Input
ÇÇ_ d
,
ÇÇd e
cartGuid
ÇÇf n
)
ÇÇn o
;
ÇÇo p
return
ÉÉ 
sph
ÉÉ 
.
ÉÉ 
ExecuteReader
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÖÖ 	
public
ãã 
static
ãã 
IDataReader
ãã !#
GetSetExpressCheckout
ãã" 7
(
ãã7 8
string
ãã8 >
token
ãã? D
)
ããD E
{
åå 	 
SqlParameterHelper
çç 
sph
çç "
=
çç# $
new
çç% ( 
SqlParameterHelper
çç) ;
(
çç; <
ConnectionString
çç< L
.
ççL M%
GetReadConnectionString
ççM d
(
ççd e
)
ççe f
,
ççf g
$strççh ñ
,ççñ ó
$numççò ô
)ççô ö
;ççö õ
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# +
,
éé+ ,
	SqlDbType
éé- 6
.
éé6 7
NVarChar
éé7 ?
,
éé? @
$num
ééA C
,
ééC D 
ParameterDirection
ééE W
.
ééW X
Input
ééX ]
,
éé] ^
token
éé_ d
)
ééd e
;
éée f
return
èè 
sph
èè 
.
èè 
ExecuteReader
èè $
(
èè$ %
)
èè% &
;
èè& '
}
ëë 	
public
îî 
static
îî 
IDataReader
îî !
GetMostRecentLog
îî" 2
(
îî2 3
Guid
îî3 7
cartGuid
îî8 @
,
îî@ A
string
îîB H
requestType
îîI T
)
îîT U
{
ïï 	 
SqlParameterHelper
ññ 
sph
ññ "
=
ññ# $
new
ññ% ( 
SqlParameterHelper
ññ) ;
(
ññ; <
ConnectionString
ññ< L
.
ññL M%
GetReadConnectionString
ññM d
(
ññd e
)
ññe f
,
ññf g
$strññh Ü
,ññÜ á
$numññà â
)ññâ ä
;ññä ã
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# .
,
óó. /
	SqlDbType
óó0 9
.
óó9 :
UniqueIdentifier
óó: J
,
óóJ K 
ParameterDirection
óóM _
.
óó_ `
Input
óó` e
,
óóe f
cartGuid
óóg o
)
óóo p
;
óóp q
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 1
,
òò1 2
	SqlDbType
òò3 <
.
òò< =
NVarChar
òò= E
,
òòE F
$num
òòG J
,
òòJ K 
ParameterDirection
òòL ^
.
òò^ _
Input
òò_ d
,
òòd e
requestType
òòf q
)
òòq r
;
òòr s
return
ôô 
sph
ôô 
.
ôô 
ExecuteReader
ôô $
(
ôô$ %
)
ôô% &
;
ôô& '
}
õõ 	
}
‡‡ 
}‚‚ €Ø
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPlugNPayLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPlugNPayLog %
{ 
public66 
static66 
int66 
Create66  
(66  !
Guid77 
rowGuid77 
,77 
DateTime88 

createdUtc88 
,88  
Guid99 
siteGuid99 
,99 
Guid:: 
userGuid:: 
,:: 
Guid;; 
	storeGuid;; 
,;; 
Guid<< 
cartGuid<< 
,<< 
string== 
rawResponse== 
,== 
string>> 
responseCode>> 
,>>  
string?? 
responseReasonCode?? %
,??% &
string@@ 
reason@@ 
,@@ 
stringAA 
avsCodeAA 
,AA 
stringBB 
ccvCodeBB 
,BB 
stringCC 
cavCodeCC 
,CC 
stringDD 
transactionIdDD  
,DD  !
stringEE 
transactionTypeEE "
,EE" #
stringFF 
methodFF 
,FF 
stringGG 
authCodeGG 
,GG 
decimalHH 
amountHH 
,HH 
decimalII 
taxII 
,II 
decimalJJ 
dutyJJ 
,JJ 
decimalKK 
freightKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi Ä
,
MMÄ Å
$num
MMÇ Ñ
)
MMÑ Ö
;
MMÖ Ü
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
UniqueIdentifierNN9 I
,NNI J
ParameterDirectionNNK ]
.NN] ^
InputNN^ c
,NNc d
rowGuidNNe l
)NNl m
;NNm n
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
DateTimeOO< D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _

createdUtcOO` j
)OOj k
;OOk l
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
UniqueIdentifierQQ: J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
userGuidQQf n
)QQn o
;QQo p
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# /
,RR/ 0
	SqlDbTypeRR1 :
.RR: ;
UniqueIdentifierRR; K
,RRK L
ParameterDirectionRRM _
.RR_ `
InputRR` e
,RRe f
	storeGuidRRg p
)RRp q
;RRq r
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
cartGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
rawResponseTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NVarCharUU> F
,UUF G
$numUUH J
,UUJ K
ParameterDirectionUUL ^
.UU^ _
InputUU_ d
,UUd e
responseCodeUUf r
)UUr s
;UUs t
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 8
,VV8 9
	SqlDbTypeVV: C
.VVC D
NVarCharVVD L
,VVL M
$numVVN P
,VVP Q
ParameterDirectionVVR d
.VVd e
InputVVe j
,VVj k
responseReasonCodeVVl ~
)VV~ 
;	VV Ä
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# ,
,WW, -
	SqlDbTypeWW. 7
.WW7 8
NVarCharWW8 @
,WW@ A
-WWB C
$numWWC D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _
reasonWW` f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
NVarCharXX9 A
,XXA B
$numXXC E
,XXE F
ParameterDirectionXXG Y
.XXY Z
InputXXZ _
,XX_ `
avsCodeXXa h
)XXh i
;XXi j
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# -
,YY- .
	SqlDbTypeYY/ 8
.YY8 9
NVarCharYY9 A
,YYA B
$numYYC E
,YYE F
ParameterDirectionYYG Y
.YYY Z
InputYYZ _
,YY_ `
ccvCodeYYa h
)YYh i
;YYi j
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# -
,ZZ- .
	SqlDbTypeZZ/ 8
.ZZ8 9
NVarCharZZ9 A
,ZZA B
$numZZC E
,ZZE F
ParameterDirectionZZG Y
.ZZY Z
InputZZZ _
,ZZ_ `
cavCodeZZa h
)ZZh i
;ZZi j
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 3
,[[3 4
	SqlDbType[[5 >
.[[> ?
NVarChar[[? G
,[[G H
$num[[I K
,[[K L
ParameterDirection[[M _
.[[_ `
Input[[` e
,[[e f
transactionId[[g t
)[[t u
;[[u v
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 5
,\\5 6
	SqlDbType\\7 @
.\\@ A
NVarChar\\A I
,\\I J
$num\\K M
,\\M N
ParameterDirection\\O a
.\\a b
Input\\b g
,\\g h
transactionType\\i x
)\\x y
;\\y z
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ,
,]], -
	SqlDbType]]. 7
.]]7 8
NVarChar]]8 @
,]]@ A
$num]]B D
,]]D E
ParameterDirection]]F X
.]]X Y
Input]]Y ^
,]]^ _
method]]` f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
NVarChar^^: B
,^^B C
$num^^D F
,^^F G
ParameterDirection^^H Z
.^^Z [
Input^^[ `
,^^` a
authCode^^b j
)^^j k
;^^k l
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Decimal__8 ?
,__? @
ParameterDirection__A S
.__S T
Input__T Y
,__Y Z
amount__[ a
)__a b
;__b c
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# )
,``) *
	SqlDbType``+ 4
.``4 5
Decimal``5 <
,``< =
ParameterDirection``> P
.``P Q
Input``Q V
,``V W
tax``X [
)``[ \
;``\ ]
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
Decimalaa6 =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
dutyaaY ]
)aa] ^
;aa^ _
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
Decimalbb9 @
,bb@ A
ParameterDirectionbbB T
.bbT U
InputbbU Z
,bbZ [
freightbb\ c
)bbc d
;bbd e
intcc 
rowsAffectedcc 
=cc 
sphcc "
.cc" #
ExecuteNonQuerycc# 2
(cc2 3
)cc3 4
;cc4 5
returndd 
rowsAffecteddd 
;dd  
}ff 	
public
ÅÅ 
static
ÅÅ 
bool
ÅÅ 
Update
ÅÅ !
(
ÅÅ! "
Guid
ÇÇ 
rowGuid
ÇÇ 
,
ÇÇ 
Guid
ÉÉ 
siteGuid
ÉÉ 
,
ÉÉ 
Guid
ÑÑ 
userGuid
ÑÑ 
,
ÑÑ 
Guid
ÖÖ 
	storeGuid
ÖÖ 
,
ÖÖ 
Guid
ÜÜ 
cartGuid
ÜÜ 
,
ÜÜ 
string
áá 
rawResponse
áá 
,
áá 
string
àà 
responseCode
àà 
,
àà  
string
ââ  
responseReasonCode
ââ %
,
ââ% &
string
ää 
reason
ää 
,
ää 
string
ãã 
avsCode
ãã 
,
ãã 
string
åå 
ccvCode
åå 
,
åå 
string
çç 
cavCode
çç 
,
çç 
string
éé 
transactionId
éé  
,
éé  !
string
èè 
transactionType
èè "
,
èè" #
string
êê 
method
êê 
,
êê 
string
ëë 
authCode
ëë 
,
ëë 
decimal
íí 
amount
íí 
,
íí 
decimal
ìì 
tax
ìì 
,
ìì 
decimal
îî 
duty
îî 
,
îî 
decimal
ïï 
freight
ïï 
)
ïï 
{
ññ 	 
SqlParameterHelper
óó 
sph
óó "
=
óó# $
new
óó% ( 
SqlParameterHelper
óó) ;
(
óó; <
ConnectionString
óó< L
.
óóL M&
GetWriteConnectionString
óóM e
(
óóe f
)
óóf g
,
óóg h
$stróói Ä
,óóÄ Å
$numóóÇ Ñ
)óóÑ Ö
;óóÖ Ü
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# -
,
òò- .
	SqlDbType
òò/ 8
.
òò8 9
UniqueIdentifier
òò9 I
,
òòI J 
ParameterDirection
òòK ]
.
òò] ^
Input
òò^ c
,
òòc d
rowGuid
òòe l
)
òòl m
;
òòm n
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# .
,
ôô. /
	SqlDbType
ôô0 9
.
ôô9 :
UniqueIdentifier
ôô: J
,
ôôJ K 
ParameterDirection
ôôL ^
.
ôô^ _
Input
ôô_ d
,
ôôd e
siteGuid
ôôf n
)
ôôn o
;
ôôo p
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# .
,
öö. /
	SqlDbType
öö0 9
.
öö9 :
UniqueIdentifier
öö: J
,
ööJ K 
ParameterDirection
ööL ^
.
öö^ _
Input
öö_ d
,
ööd e
userGuid
ööf n
)
öön o
;
ööo p
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# /
,
õõ/ 0
	SqlDbType
õõ1 :
.
õõ: ;
UniqueIdentifier
õõ; K
,
õõK L 
ParameterDirection
õõM _
.
õõ_ `
Input
õõ` e
,
õõe f
	storeGuid
õõg p
)
õõp q
;
õõq r
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# .
,
úú. /
	SqlDbType
úú0 9
.
úú9 :
UniqueIdentifier
úú: J
,
úúJ K 
ParameterDirection
úúL ^
.
úú^ _
Input
úú_ d
,
úúd e
cartGuid
úúf n
)
úún o
;
úúo p
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# 1
,
ùù1 2
	SqlDbType
ùù3 <
.
ùù< =
NVarChar
ùù= E
,
ùùE F
-
ùùG H
$num
ùùH I
,
ùùI J 
ParameterDirection
ùùK ]
.
ùù] ^
Input
ùù^ c
,
ùùc d
rawResponse
ùùe p
)
ùùp q
;
ùùq r
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 2
,
ûû2 3
	SqlDbType
ûû4 =
.
ûû= >
NVarChar
ûû> F
,
ûûF G
$num
ûûH J
,
ûûJ K 
ParameterDirection
ûûL ^
.
ûû^ _
Input
ûû_ d
,
ûûd e
responseCode
ûûf r
)
ûûr s
;
ûûs t
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 8
,
üü8 9
	SqlDbType
üü: C
.
üüC D
NVarChar
üüD L
,
üüL M
$num
üüN P
,
üüP Q 
ParameterDirection
üüR d
.
üüd e
Input
üüe j
,
üüj k 
responseReasonCode
üül ~
)
üü~ 
;üü Ä
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# ,
,
††, -
	SqlDbType
††. 7
.
††7 8
NVarChar
††8 @
,
††@ A
-
††B C
$num
††C D
,
††D E 
ParameterDirection
††F X
.
††X Y
Input
††Y ^
,
††^ _
reason
††` f
)
††f g
;
††g h
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# -
,
°°- .
	SqlDbType
°°/ 8
.
°°8 9
NVarChar
°°9 A
,
°°A B
$num
°°C E
,
°°E F 
ParameterDirection
°°G Y
.
°°Y Z
Input
°°Z _
,
°°_ `
avsCode
°°a h
)
°°h i
;
°°i j
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# -
,
¢¢- .
	SqlDbType
¢¢/ 8
.
¢¢8 9
NVarChar
¢¢9 A
,
¢¢A B
$num
¢¢C E
,
¢¢E F 
ParameterDirection
¢¢G Y
.
¢¢Y Z
Input
¢¢Z _
,
¢¢_ `
ccvCode
¢¢a h
)
¢¢h i
;
¢¢i j
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# -
,
££- .
	SqlDbType
££/ 8
.
££8 9
NVarChar
££9 A
,
££A B
$num
££C E
,
££E F 
ParameterDirection
££G Y
.
££Y Z
Input
££Z _
,
££_ `
cavCode
££a h
)
££h i
;
££i j
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 3
,
§§3 4
	SqlDbType
§§5 >
.
§§> ?
NVarChar
§§? G
,
§§G H
$num
§§I K
,
§§K L 
ParameterDirection
§§M _
.
§§_ `
Input
§§` e
,
§§e f
transactionId
§§g t
)
§§t u
;
§§u v
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# 5
,
••5 6
	SqlDbType
••7 @
.
••@ A
NVarChar
••A I
,
••I J
$num
••K M
,
••M N 
ParameterDirection
••O a
.
••a b
Input
••b g
,
••g h
transactionType
••i x
)
••x y
;
••y z
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# ,
,
¶¶, -
	SqlDbType
¶¶. 7
.
¶¶7 8
NVarChar
¶¶8 @
,
¶¶@ A
$num
¶¶B D
,
¶¶D E 
ParameterDirection
¶¶F X
.
¶¶X Y
Input
¶¶Y ^
,
¶¶^ _
method
¶¶` f
)
¶¶f g
;
¶¶g h
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# .
,
ßß. /
	SqlDbType
ßß0 9
.
ßß9 :
NVarChar
ßß: B
,
ßßB C
$num
ßßD F
,
ßßF G 
ParameterDirection
ßßH Z
.
ßßZ [
Input
ßß[ `
,
ßß` a
authCode
ßßb j
)
ßßj k
;
ßßk l
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# ,
,
®®, -
	SqlDbType
®®. 7
.
®®7 8
Decimal
®®8 ?
,
®®? @ 
ParameterDirection
®®A S
.
®®S T
Input
®®T Y
,
®®Y Z
amount
®®[ a
)
®®a b
;
®®b c
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# )
,
©©) *
	SqlDbType
©©+ 4
.
©©4 5
Decimal
©©5 <
,
©©< = 
ParameterDirection
©©> P
.
©©P Q
Input
©©Q V
,
©©V W
tax
©©X [
)
©©[ \
;
©©\ ]
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# *
,
™™* +
	SqlDbType
™™, 5
.
™™5 6
Decimal
™™6 =
,
™™= > 
ParameterDirection
™™? Q
.
™™Q R
Input
™™R W
,
™™W X
duty
™™Y ]
)
™™] ^
;
™™^ _
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# -
,
´´- .
	SqlDbType
´´/ 8
.
´´8 9
Decimal
´´9 @
,
´´@ A 
ParameterDirection
´´B T
.
´´T U
Input
´´U Z
,
´´Z [
freight
´´\ c
)
´´c d
;
´´d e
int
¨¨ 
rowsAffected
¨¨ 
=
¨¨ 
sph
¨¨ "
.
¨¨" #
ExecuteNonQuery
¨¨# 2
(
¨¨2 3
)
¨¨3 4
;
¨¨4 5
return
≠≠ 
(
≠≠ 
rowsAffected
≠≠  
>
≠≠! "
$num
≠≠# $
)
≠≠$ %
;
≠≠% &
}
ØØ 	
public
∂∂ 
static
∂∂ 
bool
∂∂ 
Delete
∂∂ !
(
∂∂! "
Guid
∂∂" &
rowGuid
∂∂' .
)
∂∂. /
{
∑∑ 	 
SqlParameterHelper
∏∏ 
sph
∏∏ "
=
∏∏# $
new
∏∏% ( 
SqlParameterHelper
∏∏) ;
(
∏∏; <
ConnectionString
∏∏< L
.
∏∏L M&
GetWriteConnectionString
∏∏M e
(
∏∏e f
)
∏∏f g
,
∏∏g h
$str∏∏i Ä
,∏∏Ä Å
$num∏∏Ç É
)∏∏É Ñ
;∏∏Ñ Ö
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# -
,
ππ- .
	SqlDbType
ππ/ 8
.
ππ8 9
UniqueIdentifier
ππ9 I
,
ππI J 
ParameterDirection
ππK ]
.
ππ] ^
Input
ππ^ c
,
ππc d
rowGuid
ππe l
)
ππl m
;
ππm n
int
∫∫ 
rowsAffected
∫∫ 
=
∫∫ 
sph
∫∫ "
.
∫∫" #
ExecuteNonQuery
∫∫# 2
(
∫∫2 3
)
∫∫3 4
;
∫∫4 5
return
ªª 
(
ªª 
rowsAffected
ªª  
>
ªª! "
$num
ªª# $
)
ªª$ %
;
ªª% &
}
ΩΩ 	
public
√√ 
static
√√ 
IDataReader
√√ !
GetOne
√√" (
(
√√( )
Guid
√√) -
rowGuid
√√. 5
)
√√5 6
{
ƒƒ 	 
SqlParameterHelper
≈≈ 
sph
≈≈ "
=
≈≈# $
new
≈≈% ( 
SqlParameterHelper
≈≈) ;
(
≈≈; <
ConnectionString
≈≈< L
.
≈≈L M%
GetReadConnectionString
≈≈M d
(
≈≈d e
)
≈≈e f
,
≈≈f g
$str≈≈h Ç
,≈≈Ç É
$num≈≈Ñ Ö
)≈≈Ö Ü
;≈≈Ü á
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ "
(
∆∆" #
$str
∆∆# -
,
∆∆- .
	SqlDbType
∆∆/ 8
.
∆∆8 9
UniqueIdentifier
∆∆9 I
,
∆∆I J 
ParameterDirection
∆∆K ]
.
∆∆] ^
Input
∆∆^ c
,
∆∆c d
rowGuid
∆∆e l
)
∆∆l m
;
∆∆m n
return
«« 
sph
«« 
.
«« 
ExecuteReader
«« $
(
««$ %
)
««% &
;
««& '
}
…… 	
public
œœ 
static
œœ 
IDataReader
œœ !
	GetByCart
œœ" +
(
œœ+ ,
Guid
œœ, 0
cartGuid
œœ1 9
)
œœ9 :
{
–– 	 
SqlParameterHelper
—— 
sph
—— "
=
——# $
new
——% ( 
SqlParameterHelper
——) ;
(
——; <
ConnectionString
——< L
.
——L M%
GetReadConnectionString
——M d
(
——d e
)
——e f
,
——f g
$str——h Ö
,——Ö Ü
$num——á à
)——à â
;——â ä
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# .
,
““. /
	SqlDbType
““0 9
.
““9 :
UniqueIdentifier
““: J
,
““J K 
ParameterDirection
““L ^
.
““^ _
Input
““_ d
,
““d e
cartGuid
““f n
)
““n o
;
““o p
return
”” 
sph
”” 
.
”” 
ExecuteReader
”” $
(
””$ %
)
””% &
;
””& '
}
’’ 	
}
‹‹ 
}ﬁﬁ ≥ç
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbPortal.cs
	namespace!! 	

mojoPortal!!
 
.!! 
Data!! 
{"" 
public'' 

static'' 
class'' 
DBPortal''  
{(( 
private** 
static** 
readonly** 
ILog**  $
log**% (
=**) *

LogManager**+ 5
.**5 6
	GetLogger**6 ?
(**? @
typeof**@ F
(**F G
DBPortal**G O
)**O P
)**P Q
;**Q R
private;; 
static;; 
string;; 
GetdbOwnerPrefix;; .
(;;. /
);;/ 0
{<< 	
string== 
ownerPrefix== 
===  
$str==! )
;==) *
if>> 
(>>  
ConfigurationManager>> $
.>>$ %
AppSettings>>% 0
[>>0 1
$str>>1 C
]>>C D
!=>>E G
null>>H L
)>>L M
{?? 
ownerPrefix@@ 
=@@  
ConfigurationManager@@ 2
.@@2 3
AppSettings@@3 >
[@@> ?
$str@@? Q
]@@Q R
;@@R S
}BB 
returnDD 
ownerPrefixDD 
;DD 
}EE 	
publicGG 
staticGG 
voidGG 
EnsureDatabaseGG )
(GG) *
)GG* +
{HH 	
SqlConnectionMM 

connectionMM $
=MM% &
newMM' *
SqlConnectionMM+ 8
(MM8 9
ConnectionStringMM9 I
.MMI J$
GetWriteConnectionStringMMJ b
(MMb c
)MMc d
)MMd e
;MMe f
SqlConnectionNN 
MasterConnectionNN *
=NN+ ,
newNN- 0
SqlConnectionNN1 >
(NN> ?
)NN? @
;NN@ A
tryPP 
{QQ &
SqlConnectionStringBuilderRR *
masterRR+ 1
=RR2 3
newRR4 7&
SqlConnectionStringBuilderRR8 R
(RRR S
)RRS T
;RRT U
masterSS 
.SS 
ConnectionStringSS '
=SS( )

connectionSS* 4
.SS4 5
ConnectionStringSS5 E
;SSE F
masterTT 
[TT 
$strTT 
]TT  
=TT! "

connectionTT# -
.TT- .

DataSourceTT. 8
;TT8 9
masterUU 
[UU 
$strUU !
]UU! "
=UU# $
$strUU% -
;UU- .
MasterConnectionWW  
=WW! "
newWW# &
SqlConnectionWW' 4
(WW4 5
masterWW5 ;
.WW; <
ConnectionStringWW< L
)WWL M
;WWM N
StringBuilderYY 
sqlYY !
=YY" #
newYY$ '
StringBuilderYY( 5
(YY5 6
)YY6 7
;YY7 8
sqlZZ 
.ZZ 
AppendZZ 
(ZZ 
$strZZ o
)ZZo p
;ZZp q
sql[[ 
.[[ 
Append[[ 
([[ 

connection[[ %
.[[% &
Database[[& .
)[[. /
;[[/ 0
sql\\ 
.\\ 
Append\\ 
(\\ 
$str\\ +
)\\+ ,
;\\, -

SqlCommand^^ 
command^^ "
=^^# $
new^^% (

SqlCommand^^) 3
(^^3 4
sql^^4 7
.^^7 8
ToString^^8 @
(^^@ A
)^^A B
,^^B C
MasterConnection^^D T
)^^T U
;^^U V
command__ 
.__ 

Parameters__ "
.__" #
AddWithValue__# /
(__/ 0
$str__0 7
,__7 8

connection__9 C
.__C D
Database__D L
)__L M
;__M N
MasterConnection``  
.``  !
Open``! %
(``% &
)``& '
;``' (
intaa 
resaa 
=aa 
commandaa !
.aa! "
ExecuteNonQueryaa" 1
(aa1 2
)aa2 3
;aa3 4
ifcc 
(cc 
rescc 
==cc 
-cc 
$numcc 
)cc 
{dd 
logdd 
.dd 
Infodd 
(dd 
$strdd A
)ddA B
;ddB C
}ddD E
elseee 
{ff 
logff 
.ff 
Infoff 
(ff 
$strff =
)ff= >
;ff> ?
}ff@ A
}hh 
catchii 
(ii 
	Exceptionii 
exii 
)ii 
{jj 
logkk 
.kk 
Errorkk 
(kk 
$strkk <
,kk< =
exkk> @
)kk@ A
;kkA B
}ll 
finallymm 
{nn 
ifoo 
(oo 
MasterConnectionoo $
.oo$ %
Stateoo% *
==oo+ -
ConnectionStateoo. =
.oo= >
Openoo> B
)ooB C
MasterConnectionpp $
.pp$ %
Closepp% *
(pp* +
)pp+ ,
;pp, -
}qq 
}ss 	
publicyy 
staticyy 
Stringyy 

DBPlatformyy '
(yy' (
)yy( )
{zz 	
return{{ 
$str{{ 
;{{ 
}|| 	
public
ÉÉ 
static
ÉÉ 
IDataReader
ÉÉ !,
DatabaseHelperGetApplicationId
ÉÉ" @
(
ÉÉ@ A
string
ÉÉA G
applicationName
ÉÉH W
)
ÉÉW X
{
ÑÑ 	
return
ÖÖ %
DatabaseHelperGetReader
ÖÖ *
(
ÖÖ* +
ConnectionString
ÜÜ  
.
ÜÜ  !%
GetReadConnectionString
ÜÜ! 8
(
ÜÜ8 9
)
ÜÜ9 :
,
ÜÜ: ;
$str
áá "
,
áá" #
$str
àà 3
+
àà4 5
applicationName
àà6 E
.
ààE F
ToLower
ààF M
(
ààM N
)
ààN O
+
ààP Q
$str
ààR U
)
ààU V
;
ààV W
}
ââ 	
public
ïï 
static
ïï 
bool
ïï +
SchemaVersionAddSchemaVersion
ïï 8
(
ïï8 9
Guid
ññ
 
applicationId
ññ 
,
ññ 
string
óó
 
applicationName
óó  
,
óó  !
int
òò
 
major
òò 
,
òò 
int
ôô
 
minor
ôô 
,
ôô 
int
öö
 
build
öö 
,
öö 
int
õõ
 
revision
õõ 
)
õõ 
{
úú 	 
SqlParameterHelper
ûû 
sph
ûû "
=
ûû# $
new
ûû% ( 
SqlParameterHelper
ûû) ;
(
ûû; <
ConnectionString
ûû< L
.
ûûL M&
GetWriteConnectionString
ûûM e
(
ûûe f
)
ûûf g
,
ûûg h
$strûûi Ç
,ûûÇ É
$numûûÑ Ö
)ûûÖ Ü
;ûûÜ á
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 3
,
üü3 4
	SqlDbType
üü5 >
.
üü> ?
UniqueIdentifier
üü? O
,
üüO P 
ParameterDirection
üüQ c
.
üüc d
Input
üüd i
,
üüi j
applicationId
üük x
)
üüx y
;
üüy z
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# 5
,
††5 6
	SqlDbType
††7 @
.
††@ A
NVarChar
††A I
,
††I J 
ParameterDirection
††K ]
.
††] ^
Input
††^ c
,
††c d
applicationName
††e t
)
††t u
;
††u v
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# +
,
°°+ ,
	SqlDbType
°°- 6
.
°°6 7
Int
°°7 :
,
°°: ; 
ParameterDirection
°°< N
.
°°N O
Input
°°O T
,
°°T U
major
°°V [
)
°°[ \
;
°°\ ]
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# +
,
¢¢+ ,
	SqlDbType
¢¢- 6
.
¢¢6 7
Int
¢¢7 :
,
¢¢: ; 
ParameterDirection
¢¢< N
.
¢¢N O
Input
¢¢O T
,
¢¢T U
minor
¢¢V [
)
¢¢[ \
;
¢¢\ ]
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# +
,
££+ ,
	SqlDbType
££- 6
.
££6 7
Int
££7 :
,
££: ; 
ParameterDirection
££< N
.
££N O
Input
££O T
,
££T U
build
££V [
)
££[ \
;
££\ ]
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# .
,
§§. /
	SqlDbType
§§0 9
.
§§9 :
Int
§§: =
,
§§= > 
ParameterDirection
§§? Q
.
§§Q R
Input
§§R W
,
§§W X
revision
§§Y a
)
§§a b
;
§§b c
int
•• 
rowsAffected
•• 
=
•• 
Convert
•• &
.
••& '
ToInt32
••' .
(
••. /
sph
••/ 2
.
••2 3
ExecuteNonQuery
••3 B
(
••B C
)
••C D
)
••D E
;
••E F
return
¶¶ 
(
¶¶ 
rowsAffected
¶¶  
>
¶¶! "
$num
¶¶# $
)
¶¶$ %
;
¶¶% &
}
ßß 	
public
™™ 
static
™™ 
bool
™™ .
 SchemaVersionUpdateSchemaVersion
™™ ;
(
™™; <
Guid
´´ 
applicationId
´´ 
,
´´ 
string
¨¨ 
applicationName
¨¨ "
,
¨¨" #
int
≠≠ 
major
≠≠ 
,
≠≠ 
int
ÆÆ 
minor
ÆÆ 
,
ÆÆ 
int
ØØ 
build
ØØ 
,
ØØ 
int
∞∞ 
revision
∞∞ 
)
∞∞ 
{
±± 	 
SqlParameterHelper
≤≤ 
sph
≤≤ "
=
≤≤# $
new
≤≤% ( 
SqlParameterHelper
≤≤) ;
(
≤≤; <
ConnectionString
≤≤< L
.
≤≤L M&
GetWriteConnectionString
≤≤M e
(
≤≤e f
)
≤≤f g
,
≤≤g h
$str≤≤i Ç
,≤≤Ç É
$num≤≤Ñ Ö
)≤≤Ö Ü
;≤≤Ü á
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# 3
,
≥≥3 4
	SqlDbType
≥≥5 >
.
≥≥> ?
UniqueIdentifier
≥≥? O
,
≥≥O P 
ParameterDirection
≥≥Q c
.
≥≥c d
Input
≥≥d i
,
≥≥i j
applicationId
≥≥k x
)
≥≥x y
;
≥≥y z
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 5
,
¥¥5 6
	SqlDbType
¥¥7 @
.
¥¥@ A
NVarChar
¥¥A I
,
¥¥I J 
ParameterDirection
¥¥K ]
.
¥¥] ^
Input
¥¥^ c
,
¥¥c d
applicationName
¥¥e t
)
¥¥t u
;
¥¥u v
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# +
,
µµ+ ,
	SqlDbType
µµ- 6
.
µµ6 7
Int
µµ7 :
,
µµ: ; 
ParameterDirection
µµ< N
.
µµN O
Input
µµO T
,
µµT U
major
µµV [
)
µµ[ \
;
µµ\ ]
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# +
,
∂∂+ ,
	SqlDbType
∂∂- 6
.
∂∂6 7
Int
∂∂7 :
,
∂∂: ; 
ParameterDirection
∂∂< N
.
∂∂N O
Input
∂∂O T
,
∂∂T U
minor
∂∂V [
)
∂∂[ \
;
∂∂\ ]
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# +
,
∑∑+ ,
	SqlDbType
∑∑- 6
.
∑∑6 7
Int
∑∑7 :
,
∑∑: ; 
ParameterDirection
∑∑< N
.
∑∑N O
Input
∑∑O T
,
∑∑T U
build
∑∑V [
)
∑∑[ \
;
∑∑\ ]
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# .
,
∏∏. /
	SqlDbType
∏∏0 9
.
∏∏9 :
Int
∏∏: =
,
∏∏= > 
ParameterDirection
∏∏? Q
.
∏∏Q R
Input
∏∏R W
,
∏∏W X
revision
∏∏Y a
)
∏∏a b
;
∏∏b c
int
ππ 
rowsAffected
ππ 
=
ππ 
sph
ππ "
.
ππ" #
ExecuteNonQuery
ππ# 2
(
ππ2 3
)
ππ3 4
;
ππ4 5
return
∫∫ 
(
∫∫ 
rowsAffected
∫∫  
>
∫∫! "
-
∫∫# $
$num
∫∫$ %
)
∫∫% &
;
∫∫& '
}
ªª 	
public
ΩΩ 
static
ΩΩ 
bool
ΩΩ .
 SchemaVersionDeleteSchemaVersion
ΩΩ ;
(
ΩΩ; <
Guid
ΩΩ< @
applicationId
ΩΩA N
)
ΩΩN O
{
ææ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M&
GetWriteConnectionString
øøM e
(
øøe f
)
øøf g
,
øøg h
$strøøi Ç
,øøÇ É
$numøøÑ Ö
)øøÖ Ü
;øøÜ á
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 3
,
¿¿3 4
	SqlDbType
¿¿5 >
.
¿¿> ?
UniqueIdentifier
¿¿? O
,
¿¿O P 
ParameterDirection
¿¿Q c
.
¿¿c d
Input
¿¿d i
,
¿¿i j
applicationId
¿¿k x
)
¿¿x y
;
¿¿y z
int
¡¡ 
rowsAffected
¡¡ 
=
¡¡ 
sph
¡¡ "
.
¡¡" #
ExecuteNonQuery
¡¡# 2
(
¡¡2 3
)
¡¡3 4
;
¡¡4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
-
¬¬# $
$num
¬¬$ %
)
¬¬% &
;
¬¬& '
}
√√ 	
public
≈≈ 
static
≈≈ 
bool
≈≈ !
SchemaVersionExists
≈≈ .
(
≈≈. /
Guid
≈≈/ 3
applicationId
≈≈4 A
)
≈≈A B
{
∆∆ 	
bool
«« 
result
«« 
=
«« 
false
«« 
;
««  
using
…… 
(
…… 
IDataReader
…… 
reader
…… %
=
……& '+
SchemaVersionGetSchemaVersion
……( E
(
……E F
applicationId
……F S
)
……S T
)
……T U
{
   
if
ÀÀ 
(
ÀÀ 
reader
ÀÀ 
.
ÀÀ 
Read
ÀÀ 
(
ÀÀ  
)
ÀÀ  !
)
ÀÀ! "
{
ÃÃ 
result
ÕÕ 
=
ÕÕ 
true
ÕÕ !
;
ÕÕ! "
}
ŒŒ 
}
œœ 
return
—— 
result
—— 
;
—— 
}
““ 	
public
÷÷ 
static
÷÷ 
IDataReader
÷÷ !+
SchemaVersionGetSchemaVersion
÷÷" ?
(
÷÷? @
Guid
÷÷@ D
applicationId
÷÷E R
)
÷÷R S
{
◊◊ 	 
SqlParameterHelper
ÿÿ 
sph
ÿÿ "
=
ÿÿ# $
new
ÿÿ% ( 
SqlParameterHelper
ÿÿ) ;
(
ÿÿ; <
ConnectionString
ÿÿ< L
.
ÿÿL M%
GetReadConnectionString
ÿÿM d
(
ÿÿd e
)
ÿÿe f
,
ÿÿf g
$strÿÿh Ñ
,ÿÿÑ Ö
$numÿÿÜ á
)ÿÿá à
;ÿÿà â
sph
ŸŸ 
.
ŸŸ  
DefineSqlParameter
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# 3
,
ŸŸ3 4
	SqlDbType
ŸŸ5 >
.
ŸŸ> ?
UniqueIdentifier
ŸŸ? O
,
ŸŸO P 
ParameterDirection
ŸŸQ c
.
ŸŸc d
Input
ŸŸd i
,
ŸŸi j
applicationId
ŸŸk x
)
ŸŸx y
;
ŸŸy z
return
⁄⁄ 
sph
⁄⁄ 
.
⁄⁄ 
ExecuteReader
⁄⁄ $
(
⁄⁄$ %
)
⁄⁄% &
;
⁄⁄& '
}
€€ 	
public
›› 
static
›› 
IDataReader
›› !%
SchemaVersionGetNonCore
››" 9
(
››9 :
)
››: ;
{
ﬁﬁ 	 
SqlParameterHelper
ﬂﬂ 
sph
ﬂﬂ "
=
ﬂﬂ# $
new
ﬂﬂ% ( 
SqlParameterHelper
ﬂﬂ) ;
(
ﬂﬂ; <
ConnectionString
ﬂﬂ< L
.
ﬂﬂL M%
GetReadConnectionString
ﬂﬂM d
(
ﬂﬂd e
)
ﬂﬂe f
,
ﬂﬂf g
$strﬂﬂh à
,ﬂﬂà â
$numﬂﬂä ã
)ﬂﬂã å
;ﬂﬂå ç
return
‡‡ 
sph
‡‡ 
.
‡‡ 
ExecuteReader
‡‡ $
(
‡‡$ %
)
‡‡% &
;
‡‡& '
}
·· 	
public
„„ 
static
„„ 
int
„„ 7
)SchemaScriptHistoryAddSchemaScriptHistory
„„ C
(
„„C D
Guid
‰‰ 
applicationId
‰‰ 
,
‰‰ 
string
ÂÂ 

scriptFile
ÂÂ 
,
ÂÂ 
DateTime
ÊÊ 
runTime
ÊÊ 
,
ÊÊ 
bool
ÁÁ 
errorOccurred
ÁÁ 
,
ÁÁ 
string
ËË 
errorMessage
ËË 
,
ËË  
string
ÈÈ 

scriptBody
ÈÈ 
)
ÈÈ 
{
ÍÍ 	 
SqlParameterHelper
ÏÏ 
sph
ÏÏ "
=
ÏÏ# $
new
ÏÏ% ( 
SqlParameterHelper
ÏÏ) ;
(
ÏÏ; <
ConnectionString
ÏÏ< L
.
ÏÏL M&
GetWriteConnectionString
ÏÏM e
(
ÏÏe f
)
ÏÏf g
,
ÏÏg h
$strÏÏi à
,ÏÏà â
$numÏÏä ã
)ÏÏã å
;ÏÏå ç
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# 3
,
ÌÌ3 4
	SqlDbType
ÌÌ5 >
.
ÌÌ> ?
UniqueIdentifier
ÌÌ? O
,
ÌÌO P 
ParameterDirection
ÌÌQ c
.
ÌÌc d
Input
ÌÌd i
,
ÌÌi j
applicationId
ÌÌk x
)
ÌÌx y
;
ÌÌy z
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# 0
,
ÓÓ0 1
	SqlDbType
ÓÓ2 ;
.
ÓÓ; <
NVarChar
ÓÓ< D
,
ÓÓD E
$num
ÓÓF I
,
ÓÓI J 
ParameterDirection
ÓÓK ]
.
ÓÓ] ^
Input
ÓÓ^ c
,
ÓÓc d

scriptFile
ÓÓe o
)
ÓÓo p
;
ÓÓp q
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# -
,
ÔÔ- .
	SqlDbType
ÔÔ/ 8
.
ÔÔ8 9
DateTime
ÔÔ9 A
,
ÔÔA B 
ParameterDirection
ÔÔC U
.
ÔÔU V
Input
ÔÔV [
,
ÔÔ[ \
runTime
ÔÔ] d
)
ÔÔd e
;
ÔÔe f
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
Bit
? B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
errorOccurred
^ k
)
k l
;
l m
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 2
,
ÒÒ2 3
	SqlDbType
ÒÒ4 =
.
ÒÒ= >
NVarChar
ÒÒ> F
,
ÒÒF G
-
ÒÒH I
$num
ÒÒI J
,
ÒÒJ K 
ParameterDirection
ÒÒL ^
.
ÒÒ^ _
Input
ÒÒ_ d
,
ÒÒd e
errorMessage
ÒÒf r
)
ÒÒr s
;
ÒÒs t
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 0
,
ÚÚ0 1
	SqlDbType
ÚÚ2 ;
.
ÚÚ; <
NVarChar
ÚÚ< D
,
ÚÚD E
-
ÚÚF G
$num
ÚÚG H
,
ÚÚH I 
ParameterDirection
ÚÚJ \
.
ÚÚ\ ]
Input
ÚÚ] b
,
ÚÚb c

scriptBody
ÚÚd n
)
ÚÚn o
;
ÚÚo p
int
ÛÛ 
newID
ÛÛ 
=
ÛÛ 
Convert
ÛÛ 
.
ÛÛ  
ToInt32
ÛÛ  '
(
ÛÛ' (
sph
ÛÛ( +
.
ÛÛ+ ,
ExecuteScalar
ÛÛ, 9
(
ÛÛ9 :
)
ÛÛ: ;
)
ÛÛ; <
;
ÛÛ< =
return
ÙÙ 
newID
ÙÙ 
;
ÙÙ 
}
ıı 	
public
˜˜ 
static
˜˜ 
bool
˜˜ :
,SchemaScriptHistoryDeleteSchemaScriptHistory
˜˜ G
(
˜˜G H
int
˜˜H K
id
˜˜L N
)
˜˜N O
{
¯¯ 	 
SqlParameterHelper
˘˘ 
sph
˘˘ "
=
˘˘# $
new
˘˘% ( 
SqlParameterHelper
˘˘) ;
(
˘˘; <
ConnectionString
˘˘< L
.
˘˘L M&
GetWriteConnectionString
˘˘M e
(
˘˘e f
)
˘˘f g
,
˘˘g h
$str˘˘i à
,˘˘à â
$num˘˘ä ã
)˘˘ã å
;˘˘å ç
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# (
,
˙˙( )
	SqlDbType
˙˙* 3
.
˙˙3 4
Int
˙˙4 7
,
˙˙7 8 
ParameterDirection
˙˙9 K
.
˙˙K L
Input
˙˙L Q
,
˙˙Q R
id
˙˙S U
)
˙˙U V
;
˙˙V W
int
˚˚ 
rowsAffected
˚˚ 
=
˚˚ 
sph
˚˚ "
.
˚˚" #
ExecuteNonQuery
˚˚# 2
(
˚˚2 3
)
˚˚3 4
;
˚˚4 5
return
¸¸ 
(
¸¸ 
rowsAffected
¸¸  
>
¸¸! "
-
¸¸# $
$num
¸¸$ %
)
¸¸% &
;
¸¸& '
}
˝˝ 	
public
ˇˇ 
static
ˇˇ 
IDataReader
ˇˇ !7
)SchemaScriptHistoryGetSchemaScriptHistory
ˇˇ" K
(
ˇˇK L
int
ˇˇL O
id
ˇˇP R
)
ˇˇR S
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M%
GetReadConnectionString
ÅÅM d
(
ÅÅd e
)
ÅÅe f
,
ÅÅf g
$strÅÅh ä
,ÅÅä ã
$numÅÅå ç
)ÅÅç é
;ÅÅé è
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# (
,
ÇÇ( )
	SqlDbType
ÇÇ* 3
.
ÇÇ3 4
Int
ÇÇ4 7
,
ÇÇ7 8 
ParameterDirection
ÇÇ9 K
.
ÇÇK L
Input
ÇÇL Q
,
ÇÇQ R
id
ÇÇS U
)
ÇÇU V
;
ÇÇV W
return
ÉÉ 
sph
ÉÉ 
.
ÉÉ 
ExecuteReader
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
IDataReader
ÜÜ !7
)SchemaScriptHistoryGetSchemaScriptHistory
ÜÜ" K
(
ÜÜK L
Guid
ÜÜL P
applicationId
ÜÜQ ^
)
ÜÜ^ _
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh å
,ààå ç
$numààé è
)ààè ê
;ààê ë
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 3
,
ââ3 4
	SqlDbType
ââ5 >
.
ââ> ?
UniqueIdentifier
ââ? O
,
ââO P 
ParameterDirection
ââQ c
.
ââc d
Input
ââd i
,
ââi j
applicationId
ââk x
)
ââx y
;
âây z
return
ää 
sph
ää 
.
ää 
ExecuteReader
ää $
(
ää$ %
)
ää% &
;
ää& '
}
ãã 	
public
çç 
static
çç 
IDataReader
çç !<
.SchemaScriptHistoryGetSchemaScriptErrorHistory
çç" P
(
ççP Q
Guid
ççQ U
applicationId
ççV c
)
ççc d
{
éé 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh í
,èèí ì
$numèèî ï
)èèï ñ
;èèñ ó
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# (
,
êê( )
	SqlDbType
êê* 3
.
êê3 4
UniqueIdentifier
êê4 D
,
êêD E 
ParameterDirection
êêF X
.
êêX Y
Input
êêY ^
,
êê^ _
applicationId
êê` m
)
êêm n
;
êên o
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
íí 	
public
îî 
static
îî 
bool
îî '
SchemaScriptHistoryExists
îî 4
(
îî4 5
Guid
îî5 9
applicationId
îî: G
,
îîG H
String
îîI O

scriptFile
îîP Z
)
îîZ [
{
ïï 	 
SqlParameterHelper
ññ 
sph
ññ "
=
ññ# $
new
ññ% ( 
SqlParameterHelper
ññ) ;
(
ññ; <
ConnectionString
ññ< L
.
ññL M%
GetReadConnectionString
ññM d
(
ññd e
)
ññe f
,
ññf g
$strññh á
,ññá à
$numññâ ä
)ññä ã
;ññã å
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# 3
,
óó3 4
	SqlDbType
óó5 >
.
óó> ?
UniqueIdentifier
óó? O
,
óóO P 
ParameterDirection
óóQ c
.
óóc d
Input
óód i
,
óói j
applicationId
óók x
)
óóx y
;
óóy z
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 0
,
òò0 1
	SqlDbType
òò2 ;
.
òò; <
NVarChar
òò< D
,
òòD E
$num
òòF I
,
òòI J 
ParameterDirection
òòK ]
.
òò] ^
Input
òò^ c
,
òòc d

scriptFile
òòe o
)
òòo p
;
òòp q
int
ôô 
count
ôô 
=
ôô 
Convert
ôô 
.
ôô  
ToInt32
ôô  '
(
ôô' (
sph
ôô( +
.
ôô+ ,
ExecuteScalar
ôô, 9
(
ôô9 :
)
ôô: ;
)
ôô; <
;
ôô< =
return
öö 
(
öö 
count
öö 
>
öö 
$num
öö 
)
öö 
;
öö 
}
õõ 	
public
§§ 
static
§§ 
	DataTable
§§ $
GetTableFromDataReader
§§  6
(
§§6 7
IDataReader
§§7 B
reader
§§C I
)
§§I J
{
•• 	
	DataTable
¶¶ 
	dataTable
¶¶ 
=
¶¶  !
new
¶¶" %
	DataTable
¶¶& /
(
¶¶/ 0
)
¶¶0 1
;
¶¶1 2

DataColumn
ßß 
column
ßß 
;
ßß 
DataRow
®® 
row
®® 
;
®® 
	ArrayList
©© 
	arrayList
©© 
=
©©  !
new
©©" %
	ArrayList
©©& /
(
©©/ 0
)
©©0 1
;
©©1 2
try
´´ 
{
¨¨ 
	DataTable
≠≠ 
schemaTable
≠≠ %
=
≠≠& '
reader
≠≠( .
.
≠≠. /
GetSchemaTable
≠≠/ =
(
≠≠= >
)
≠≠> ?
;
≠≠? @
for
ØØ 
(
ØØ 
int
ØØ 
i
ØØ 
=
ØØ 
$num
ØØ 
;
ØØ 
i
ØØ  !
<
ØØ" #
schemaTable
ØØ$ /
.
ØØ/ 0
Rows
ØØ0 4
.
ØØ4 5
Count
ØØ5 :
;
ØØ: ;
i
ØØ< =
++
ØØ= ?
)
ØØ? @
{
∞∞ 
column
≤≤ 
=
≤≤ 
new
≤≤  

DataColumn
≤≤! +
(
≤≤+ ,
)
≤≤, -
;
≤≤- .
if
¥¥ 
(
¥¥ 
!
¥¥ 
	dataTable
¥¥ "
.
¥¥" #
Columns
¥¥# *
.
¥¥* +
Contains
¥¥+ 3
(
¥¥3 4
schemaTable
¥¥4 ?
.
¥¥? @
Rows
¥¥@ D
[
¥¥D E
i
¥¥E F
]
¥¥F G
[
¥¥G H
$str
¥¥H T
]
¥¥T U
.
¥¥U V
ToString
¥¥V ^
(
¥¥^ _
)
¥¥_ `
)
¥¥` a
)
¥¥a b
{
µµ 
column
∑∑ 
.
∑∑ 

ColumnName
∑∑ )
=
∑∑* +
schemaTable
∑∑, 7
.
∑∑7 8
Rows
∑∑8 <
[
∑∑< =
i
∑∑= >
]
∑∑> ?
[
∑∑? @
$str
∑∑@ L
]
∑∑L M
.
∑∑M N
ToString
∑∑N V
(
∑∑V W
)
∑∑W X
;
∑∑X Y
column
∫∫ 
.
∫∫ 
AllowDBNull
∫∫ *
=
∫∫+ ,
Convert
∫∫- 4
.
∫∫4 5
	ToBoolean
∫∫5 >
(
∫∫> ?
schemaTable
∫∫? J
.
∫∫J K
Rows
∫∫K O
[
∫∫O P
i
∫∫P Q
]
∫∫Q R
[
∫∫R S
$str
∫∫S `
]
∫∫` a
)
∫∫a b
;
∫∫b c
column
ªª 
.
ªª 
ReadOnly
ªª '
=
ªª( )
Convert
ªª* 1
.
ªª1 2
	ToBoolean
ªª2 ;
(
ªª; <
schemaTable
ªª< G
.
ªªG H
Rows
ªªH L
[
ªªL M
i
ªªM N
]
ªªN O
[
ªªO P
$str
ªªP \
]
ªª\ ]
)
ªª] ^
;
ªª^ _
	arrayList
ºº !
.
ºº! "
Add
ºº" %
(
ºº% &
column
ºº& ,
.
ºº, -

ColumnName
ºº- 7
)
ºº7 8
;
ºº8 9
	dataTable
ΩΩ !
.
ΩΩ! "
Columns
ΩΩ" )
.
ΩΩ) *
Add
ΩΩ* -
(
ΩΩ- .
column
ΩΩ. 4
)
ΩΩ4 5
;
ΩΩ5 6
}
øø 
}
¡¡ 
while
√√ 
(
√√ 
reader
√√ 
.
√√ 
Read
√√ "
(
√√" #
)
√√# $
)
√√$ %
{
ƒƒ 
row
∆∆ 
=
∆∆ 
	dataTable
∆∆ #
.
∆∆# $
NewRow
∆∆$ *
(
∆∆* +
)
∆∆+ ,
;
∆∆, -
for
»» 
(
»» 
int
»» 
i
»» 
=
»»  
$num
»»! "
;
»»" #
i
»»$ %
<
»»& '
	arrayList
»»( 1
.
»»1 2
Count
»»2 7
;
»»7 8
i
»»9 :
++
»»: <
)
»»< =
{
…… 
row
ÀÀ 
[
ÀÀ 
(
ÀÀ 
(
ÀÀ 
System
ÀÀ $
.
ÀÀ$ %
String
ÀÀ% +
)
ÀÀ+ ,
	arrayList
ÀÀ, 5
[
ÀÀ5 6
i
ÀÀ6 7
]
ÀÀ7 8
)
ÀÀ8 9
]
ÀÀ9 :
=
ÀÀ; <
reader
ÀÀ= C
[
ÀÀC D
(
ÀÀD E
System
ÀÀE K
.
ÀÀK L
String
ÀÀL R
)
ÀÀR S
	arrayList
ÀÀS \
[
ÀÀ\ ]
i
ÀÀ] ^
]
ÀÀ^ _
]
ÀÀ_ `
;
ÀÀ` a
}
ÕÕ 
	dataTable
œœ 
.
œœ 
Rows
œœ "
.
œœ" #
Add
œœ# &
(
œœ& '
row
œœ' *
)
œœ* +
;
œœ+ ,
}
—— 
}
”” 
finally
‘‘ 
{
’’ 
reader
÷÷ 
.
÷÷ 
Close
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 
return
ŸŸ 
	dataTable
ŸŸ 
;
ŸŸ 
}
€€ 	
public
›› 
static
›› 
bool
›› -
DatabaseHelperCanAccessDatabase
›› :
(
››: ;
String
››; A$
overrideConnectionInfo
››B X
)
››X Y
{
ﬁﬁ 	
bool
‰‰ 
result
‰‰ 
=
‰‰ 
false
‰‰ 
;
‰‰  
SqlConnection
ÊÊ 

connection
ÊÊ $
;
ÊÊ$ %
if
ËË 
(
ËË 
(
ÈÈ $
overrideConnectionInfo
ÈÈ '
!=
ÈÈ( *
null
ÈÈ+ /
)
ÈÈ/ 0
&&
ÍÍ 
(
ÍÍ $
overrideConnectionInfo
ÍÍ *
.
ÍÍ* +
Length
ÍÍ+ 1
>
ÍÍ2 3
$num
ÍÍ4 5
)
ÍÍ5 6
)
ÎÎ 
{
ÏÏ 

connection
ÌÌ 
=
ÌÌ 
new
ÌÌ  
SqlConnection
ÌÌ! .
(
ÌÌ. /$
overrideConnectionInfo
ÌÌ/ E
)
ÌÌE F
;
ÌÌF G
}
ÓÓ 
else
ÔÔ 
{
 

connection
ÒÒ 
=
ÒÒ 
new
ÒÒ  
SqlConnection
ÒÒ! .
(
ÒÒ. /
ConnectionString
ÒÒ/ ?
.
ÒÒ? @%
GetReadConnectionString
ÒÒ@ W
(
ÒÒW X
)
ÒÒX Y
)
ÒÒY Z
;
ÒÒZ [
}
ÚÚ 
try
ÙÙ 
{
ıı 

connection
ˆˆ 
.
ˆˆ 
Open
ˆˆ 
(
ˆˆ  
)
ˆˆ  !
;
ˆˆ! "
result
˜˜ 
=
˜˜ 
(
˜˜ 

connection
˜˜ $
.
˜˜$ %
State
˜˜% *
==
˜˜+ -
ConnectionState
˜˜. =
.
˜˜= >
Open
˜˜> B
)
˜˜B C
;
˜˜C D
}
˘˘ 
catch
˙˙ 
{
˙˙ 
}
˙˙ 
finally
˚˚ 
{
¸¸ 
if
˝˝ 
(
˝˝ 

connection
˝˝ 
.
˝˝ 
State
˝˝ $
==
˝˝% '
ConnectionState
˝˝( 7
.
˝˝7 8
Open
˝˝8 <
)
˝˝< =

connection
˛˛ 
.
˛˛ 
Close
˛˛ $
(
˛˛$ %
)
˛˛% &
;
˛˛& '
}
ˇˇ 
return
ÇÇ 
result
ÇÇ 
;
ÇÇ 
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
DbException
ÜÜ !.
 DatabaseHelperGetConnectionError
ÜÜ" B
(
ÜÜB C
String
ÜÜC I$
overrideConnectionInfo
ÜÜJ `
)
ÜÜ` a
{
áá 	
DbException
àà 
	exception
àà !
=
àà" #
null
àà$ (
;
àà( )
SqlConnection
ää 

connection
ää $
;
ää$ %
if
åå 
(
åå 
(
çç $
overrideConnectionInfo
çç '
!=
çç( *
null
çç+ /
)
çç/ 0
&&
éé 
(
éé $
overrideConnectionInfo
éé *
.
éé* +
Length
éé+ 1
>
éé2 3
$num
éé4 5
)
éé5 6
)
èè 
{
êê 

connection
ëë 
=
ëë 
new
ëë  
SqlConnection
ëë! .
(
ëë. /$
overrideConnectionInfo
ëë/ E
)
ëëE F
;
ëëF G
}
íí 
else
ìì 
{
îî 

connection
ïï 
=
ïï 
new
ïï  
SqlConnection
ïï! .
(
ïï. /
ConnectionString
ïï/ ?
.
ïï? @%
GetReadConnectionString
ïï@ W
(
ïïW X
)
ïïX Y
)
ïïY Z
;
ïïZ [
}
ññ 
try
òò 
{
ôô 

connection
öö 
.
öö 
Open
öö 
(
öö  
)
öö  !
;
öö! "
}
ùù 
catch
ûû 
(
ûû 
DbException
ûû 
ex
ûû !
)
ûû! "
{
üü 
	exception
†† 
=
†† 
ex
†† 
;
†† 
}
°° 
finally
¢¢ 
{
££ 
if
§§ 
(
§§ 

connection
§§ 
.
§§ 
State
§§ $
==
§§% '
ConnectionState
§§( 7
.
§§7 8
Open
§§8 <
)
§§< =

connection
•• 
.
•• 
Close
•• $
(
••$ %
)
••% &
;
••& '
}
¶¶ 
return
©© 
	exception
©© 
;
©© 
}
´´ 	
public
≠≠ 
static
≠≠ 
bool
≠≠ -
DatabaseHelperCanAccessDatabase
≠≠ :
(
≠≠: ;
)
≠≠; <
{
ÆÆ 	
return
ØØ -
DatabaseHelperCanAccessDatabase
ØØ 2
(
ØØ2 3
null
ØØ3 7
)
ØØ7 8
;
ØØ8 9
}
∞∞ 	
public
≤≤ 
static
≤≤ 
bool
≤≤ *
DatabaseHelperCanAlterSchema
≤≤ 7
(
≤≤7 8
string
≤≤8 >$
overrideConnectionInfo
≤≤? U
)
≤≤U V
{
≥≥ 	
bool
µµ 
result
µµ 
=
µµ 
true
µµ 
;
µµ 
StringBuilder
∏∏ 

sqlCommand
∏∏ $
=
∏∏% &
new
∏∏' *
StringBuilder
∏∏+ 8
(
∏∏8 9
)
∏∏9 :
;
∏∏: ;

sqlCommand
›› 
.
›› 
Append
›› 
(
›› 
$str
ﬁÈ 
)
ÈÈ 
;
ÈÈ 
try
ÎÎ 
{
ÏÏ %
DatabaseHelperRunScript
ÌÌ '
(
ÌÌ' (

sqlCommand
ÓÓ 
.
ÓÓ 
ToString
ÓÓ '
(
ÓÓ' (
)
ÓÓ( )
,
ÓÓ) *$
overrideConnectionInfo
ÔÔ *
)
ÔÔ* +
;
ÔÔ+ ,
}
 
catch
ÒÒ 
(
ÒÒ 
DbException
ÒÒ 
)
ÒÒ 
{
ÚÚ 
result
ÛÛ 
=
ÛÛ 
false
ÛÛ 
;
ÛÛ 
}
ÙÙ 
catch
ıı 
(
ıı 
ArgumentException
ıı $
)
ıı$ %
{
ˆˆ 
result
˜˜ 
=
˜˜ 
false
˜˜ 
;
˜˜ 
}
¯¯ 

sqlCommand
˙˙ 
=
˙˙ 
new
˙˙ 
StringBuilder
˙˙ *
(
˙˙* +
)
˙˙+ ,
;
˙˙, -

sqlCommand
˚˚ 
.
˚˚ 
Append
˚˚ 
(
˚˚ 
$str
¸ˇ 
)
ˇˇ 
;
ˇˇ 
try
ÅÅ 
{
ÇÇ %
DatabaseHelperRunScript
ÉÉ '
(
ÉÉ' (

sqlCommand
ÑÑ 
.
ÑÑ 
ToString
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
,
ÑÑ) *$
overrideConnectionInfo
ÖÖ *
)
ÖÖ* +
;
ÖÖ+ ,
}
ÜÜ 
catch
áá 
(
áá 
DbException
áá 
)
áá 
{
àà 
result
ââ 
=
ââ 
false
ââ 
;
ââ 
}
ää 
catch
ãã 
(
ãã 
ArgumentException
ãã $
)
ãã$ %
{
åå 
result
çç 
=
çç 
false
çç 
;
çç 
}
éé 

sqlCommand
êê 
=
êê 
new
êê 
StringBuilder
êê *
(
êê* +
)
êê+ ,
;
êê, -

sqlCommand
ëë 
.
ëë 
Append
ëë 
(
ëë 
$str
íî 
)
îî 
;
îî 
try
ññ 
{
óó %
DatabaseHelperRunScript
òò '
(
òò' (

sqlCommand
òò( 2
.
òò2 3
ToString
òò3 ;
(
òò; <
)
òò< =
,
òò= >$
overrideConnectionInfo
òò? U
)
òòU V
;
òòV W
}
ôô 
catch
öö 
(
öö 
DbException
öö 
)
öö 
{
õõ 
result
úú 
=
úú 
false
úú 
;
úú 
}
ùù 
catch
ûû 
(
ûû 
ArgumentException
ûû $
)
ûû$ %
{
üü 
result
†† 
=
†† 
false
†† 
;
†† 
}
°° 
return
©© 
result
©© 
;
©© 
}
´´ 	
private
≠≠ 
static
≠≠ 
bool
≠≠ B
4DatabaseHelperCanAlterSchemaHackForMissingServicePak
≠≠ P
(
≠≠P Q
string
≠≠Q W$
overrideConnectionInfo
≠≠X n
)
≠≠n o
{
ÆÆ 	
bool
∞∞ 
result
∞∞ 
=
∞∞ 
true
∞∞ 
;
∞∞ 
StringBuilder
≥≥ 

sqlCommand
≥≥ $
=
≥≥% &
new
≥≥' *
StringBuilder
≥≥+ 8
(
≥≥8 9
)
≥≥9 :
;
≥≥: ;

sqlCommand
¥¥ 
.
¥¥ 
Append
¥¥ 
(
¥¥ 
$str
µ≈ 
)
≈≈ 
;
≈≈ 
try
»» 
{
…… %
DatabaseHelperRunScript
   '
(
  ' (

sqlCommand
ÀÀ 
.
ÀÀ 
ToString
ÀÀ '
(
ÀÀ' (
)
ÀÀ( )
,
ÀÀ) *$
overrideConnectionInfo
ÃÃ *
)
ÃÃ* +
;
ÃÃ+ ,
}
ÕÕ 
catch
ŒŒ 
(
ŒŒ 
DbException
ŒŒ 
)
ŒŒ 
{
œœ 
result
–– 
=
–– 
false
–– 
;
–– 
}
—— 
catch
““ 
(
““ 
ArgumentException
““ $
)
““$ %
{
”” 
result
‘‘ 
=
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 

sqlCommand
◊◊ 
=
◊◊ 
new
◊◊ 
StringBuilder
◊◊ *
(
◊◊* +
)
◊◊+ ,
;
◊◊, -

sqlCommand
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
Ÿ‹ 
)
‹‹ 
;
‹‹ 
try
ﬁﬁ 
{
ﬂﬂ %
DatabaseHelperRunScript
‡‡ '
(
‡‡' (

sqlCommand
·· 
.
·· 
ToString
·· '
(
··' (
)
··( )
,
··) *$
overrideConnectionInfo
‚‚ *
)
‚‚* +
;
‚‚+ ,
}
„„ 
catch
‰‰ 
(
‰‰ 
DbException
‰‰ 
)
‰‰ 
{
ÂÂ 
result
ÊÊ 
=
ÊÊ 
false
ÊÊ 
;
ÊÊ 
}
ÁÁ 
catch
ËË 
(
ËË 
ArgumentException
ËË $
)
ËË$ %
{
ÈÈ 
result
ÍÍ 
=
ÍÍ 
false
ÍÍ 
;
ÍÍ 
}
ÎÎ 

sqlCommand
ÌÌ 
=
ÌÌ 
new
ÌÌ 
StringBuilder
ÌÌ *
(
ÌÌ* +
)
ÌÌ+ ,
;
ÌÌ, -

sqlCommand
ÓÓ 
.
ÓÓ 
Append
ÓÓ 
(
ÓÓ 
$str
ÔÒ 
)
ÒÒ 
;
ÒÒ 
try
ÛÛ 
{
ÙÙ %
DatabaseHelperRunScript
ıı '
(
ıı' (

sqlCommand
ıı( 2
.
ıı2 3
ToString
ıı3 ;
(
ıı; <
)
ıı< =
,
ıı= >$
overrideConnectionInfo
ıı? U
)
ııU V
;
ııV W
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
DbException
˜˜ 
)
˜˜ 
{
¯¯ 
result
˘˘ 
=
˘˘ 
false
˘˘ 
;
˘˘ 
}
˙˙ 
catch
˚˚ 
(
˚˚ 
ArgumentException
˚˚ $
)
˚˚$ %
{
¸¸ 
result
˝˝ 
=
˝˝ 
false
˝˝ 
;
˝˝ 
}
˛˛ 
return
ÇÇ 
result
ÇÇ 
;
ÇÇ 
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
bool
ÜÜ 4
&DatabaseHelperCanCreateTemporaryTables
ÜÜ A
(
ÜÜA B
)
ÜÜB C
{
áá 	
bool
àà 
result
àà 
=
àà 
false
àà 
;
àà  
StringBuilder
ää 

sqlCommand
ää $
=
ää% &
new
ää' *
StringBuilder
ää+ 8
(
ää8 9
)
ää9 :
;
ää: ;

sqlCommand
ãã 
.
ãã 
Append
ãã 
(
ãã 
$str
åô 
)
ôô 
;
ôô 
try
õõ 
{
úú %
DatabaseHelperRunScript
ùù '
(
ùù' (

sqlCommand
ùù( 2
.
ùù2 3
ToString
ùù3 ;
(
ùù; <
)
ùù< =
,
ùù= >
ConnectionString
ùù? O
.
ùùO P&
GetWriteConnectionString
ùùP h
(
ùùh i
)
ùùi j
)
ùùj k
;
ùùk l
result
ûû 
=
ûû 
true
ûû 
;
ûû 
}
üü 
catch
†† 
{
°° 
result
¢¢ 
=
¢¢ 
false
¢¢ 
;
¢¢ 
}
££ 
return
¶¶ 
result
¶¶ 
;
¶¶ 
}
®® 	
public
™™ 
static
™™ 
bool
™™ %
DatabaseHelperRunScript
™™ 2
(
™™2 3
FileInfo
´´ 

scriptFile
´´ 
,
´´  
String
¨¨ $
overrideConnectionInfo
¨¨ )
)
¨¨) *
{
≠≠ 	
if
ÆÆ 
(
ÆÆ 

scriptFile
ÆÆ 
==
ÆÆ 
null
ÆÆ "
)
ÆÆ" #
return
ÆÆ$ *
false
ÆÆ+ 0
;
ÆÆ0 1
string
∞∞ 
script
∞∞ 
=
∞∞ 
File
∞∞  
.
∞∞  !
ReadAllText
∞∞! ,
(
∞∞, -

scriptFile
∞∞- 7
.
∞∞7 8
FullName
∞∞8 @
)
∞∞@ A
;
∞∞A B
if
≤≤ 
(
≤≤ 
(
≤≤ 
script
≤≤ 
==
≤≤ 
null
≤≤ 
)
≤≤  
||
≤≤! #
(
≤≤$ %
script
≤≤% +
.
≤≤+ ,
Length
≤≤, 2
==
≤≤3 5
$num
≤≤6 7
)
≤≤7 8
)
≤≤8 9
return
≤≤: @
true
≤≤A E
;
≤≤E F
return
¥¥ %
DatabaseHelperRunScript
¥¥ *
(
¥¥* +
script
¥¥+ 1
,
¥¥1 2$
overrideConnectionInfo
¥¥3 I
)
¥¥I J
;
¥¥J K
}
∂∂ 	
public
ππ 
static
ππ 
bool
ππ %
DatabaseHelperRunScript
ππ 2
(
ππ2 3
string
ππ3 9
script
ππ: @
,
ππ@ A
string
ππB H$
overrideConnectionInfo
ππI _
)
ππ_ `
{
∫∫ 	
if
ªª 
(
ªª 
(
ªª 
script
ªª 
==
ªª 
null
ªª 
)
ªª  
||
ªª! #
(
ªª$ %
script
ªª% +
.
ªª+ ,
Length
ªª, 2
==
ªª3 5
$num
ªª6 7
)
ªª7 8
)
ªª8 9
return
ªª: @
true
ªªA E
;
ªªE F
string
ΩΩ 
ownerPrefix
ΩΩ 
=
ΩΩ  
GetdbOwnerPrefix
ΩΩ! 1
(
ΩΩ1 2
)
ΩΩ2 3
;
ΩΩ3 4
if
ææ 
(
ææ 
ownerPrefix
ææ 
!=
ææ 
$str
ææ '
)
ææ' (
{
øø 
script
¿¿ 
=
¿¿ 
script
¿¿ 
.
¿¿  
Replace
¿¿  '
(
¿¿' (
$str
¿¿( 0
,
¿¿0 1
ownerPrefix
¿¿2 =
)
¿¿= >
;
¿¿> ?
}
¡¡ 
bool
√√ 
result
√√ 
=
√√ 
false
√√ 
;
√√  
SqlConnection
ƒƒ 

connection
ƒƒ $
;
ƒƒ$ %
if
∆∆ 
(
∆∆ 
(
«« $
overrideConnectionInfo
«« '
!=
««( *
null
««+ /
)
««/ 0
&&
»» 
(
»» $
overrideConnectionInfo
»» *
.
»»* +
Length
»»+ 1
>
»»2 3
$num
»»4 5
)
»»5 6
)
…… 
{
   

connection
ÀÀ 
=
ÀÀ 
new
ÀÀ  
SqlConnection
ÀÀ! .
(
ÀÀ. /$
overrideConnectionInfo
ÀÀ/ E
)
ÀÀE F
;
ÀÀF G
}
ÃÃ 
else
ÕÕ 
{
ŒŒ 

connection
œœ 
=
œœ 
new
œœ  
SqlConnection
œœ! .
(
œœ. /
ConnectionString
œœ/ ?
.
œœ? @&
GetWriteConnectionString
œœ@ X
(
œœX Y
)
œœY Z
)
œœZ [
;
œœ[ \
}
–– 
string
““ 
[
““ 
]
““ 
	delimiter
““ 
=
““  
new
““! $
string
““% +
[
““+ ,
]
““, -
{
““. /
$str
““0 8
}
““9 :
;
““: ;
script
‘‘ 
=
‘‘ 
script
‘‘ 
.
‘‘ 
Replace
‘‘ #
(
‘‘# $
$str
‘‘$ (
,
‘‘( )
$str
‘‘* 2
)
‘‘2 3
;
‘‘3 4
string
÷÷ 
[
÷÷ 
]
÷÷ 
arrSqlStatements
÷÷ %
=
÷÷& '
script
÷÷( .
.
÷÷. /
Split
÷÷/ 4
(
÷÷4 5
	delimiter
÷÷5 >
,
÷÷> ? 
StringSplitOptions
÷÷@ R
.
÷÷R S 
RemoveEmptyEntries
÷÷S e
)
÷÷e f
;
÷÷f g

connection
ÿÿ 
.
ÿÿ 
Open
ÿÿ 
(
ÿÿ 
)
ÿÿ 
;
ÿÿ 
SqlTransaction
⁄⁄ 
transaction
⁄⁄ &
=
⁄⁄' (

connection
⁄⁄) 3
.
⁄⁄3 4
BeginTransaction
⁄⁄4 D
(
⁄⁄D E
)
⁄⁄E F
;
⁄⁄F G
string
€€ 
currentStatement
€€ #
=
€€$ %
string
€€& ,
.
€€, -
Empty
€€- 2
;
€€2 3
try
›› 
{
ﬁﬁ 
foreach
ﬂﬂ 
(
ﬂﬂ 
String
ﬂﬂ 
sqlStatement
ﬂﬂ  ,
in
ﬂﬂ- /
arrSqlStatements
ﬂﬂ0 @
)
ﬂﬂ@ A
{
‡‡ 
if
·· 
(
·· 
sqlStatement
·· $
.
··$ %
Trim
··% )
(
··) *
)
··* +
.
··+ ,
Length
··, 2
>
··3 4
$num
··5 6
)
··6 7
{
‚‚ 
currentStatement
„„ (
=
„„) *
sqlStatement
„„+ 7
;
„„7 8
	SqlHelper
‰‰ !
.
‰‰! "
ExecuteNonQuery
‰‰" 1
(
‰‰1 2
transaction
ÂÂ '
,
ÂÂ' (
CommandType
ÊÊ '
.
ÊÊ' (
Text
ÊÊ( ,
,
ÊÊ, -
sqlStatement
ÁÁ (
,
ÁÁ( )
null
ËË  
)
ËË  !
;
ËË! "
}
ÍÍ 
}
ÎÎ 
transaction
ÓÓ 
.
ÓÓ 
Commit
ÓÓ "
(
ÓÓ" #
)
ÓÓ# $
;
ÓÓ$ %
result
ÔÔ 
=
ÔÔ 
true
ÔÔ 
;
ÔÔ 
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
SqlException
ÚÚ 
ex
ÚÚ  "
)
ÚÚ" #
{
ÛÛ 
transaction
ÙÙ 
.
ÙÙ 
Rollback
ÙÙ $
(
ÙÙ$ %
)
ÙÙ% &
;
ÙÙ& '
log
ıı 
.
ıı 
Error
ıı 
(
ıı 
$str
ıı 5
,
ıı5 6
ex
ıı7 9
)
ıı9 :
;
ıı: ;
log
ˆˆ 
.
ˆˆ 
Info
ˆˆ 
(
ˆˆ 
$str
ˆˆ 5
+
ˆˆ6 7
currentStatement
ˆˆ8 H
)
ˆˆH I
;
ˆˆI J
throw
˜˜ 
;
˜˜ 
}
¯¯ 
finally
˘˘ 
{
˙˙ 

connection
˚˚ 
.
˚˚ 
Close
˚˚  
(
˚˚  !
)
˚˚! "
;
˚˚" #
}
˝˝ 
return
ˇˇ 
result
ˇˇ 
;
ˇˇ 
}
ÄÄ 	
public
ßß 
static
ßß 
bool
ßß ,
DatabaseHelperUpdateTableField
ßß 9
(
ßß9 :
String
®® 
connectionString
®® #
,
®®# $
String
©© 
	tableName
©© 
,
©© 
String
™™ 
keyFieldName
™™ 
,
™™  
String
´´ 
keyFieldValue
´´  
,
´´  !
String
¨¨ 
dataFieldName
¨¨  
,
¨¨  !
String
≠≠ 
dataFieldValue
≠≠ !
,
≠≠! "
String
ÆÆ 
additionalWhere
ÆÆ "
)
ÆÆ" #
{
ØØ 	
bool
∞∞ 
result
∞∞ 
=
∞∞ 
false
∞∞ 
;
∞∞  
StringBuilder
≤≤ 

sqlCommand
≤≤ $
=
≤≤% &
new
≤≤' *
StringBuilder
≤≤+ 8
(
≤≤8 9
)
≤≤9 :
;
≤≤: ;

sqlCommand
≥≥ 
.
≥≥ 
Append
≥≥ 
(
≥≥ 
$str
≥≥ '
+
≥≥( )
	tableName
≥≥* 3
+
≥≥4 5
$str
≥≥6 9
)
≥≥9 :
;
≥≥: ;

sqlCommand
¥¥ 
.
¥¥ 
Append
¥¥ 
(
¥¥ 
$str
¥¥ %
+
¥¥& '
dataFieldName
¥¥( 5
+
¥¥6 7
$str
¥¥8 I
)
¥¥I J
;
¥¥J K

sqlCommand
µµ 
.
µµ 
Append
µµ 
(
µµ 
$str
µµ '
+
µµ( )
keyFieldName
µµ* 6
+
µµ7 8
$str
µµ9 >
+
µµ? @
keyFieldValue
µµA N
)
µµN O
;
µµO P

sqlCommand
∂∂ 
.
∂∂ 
Append
∂∂ 
(
∂∂ 
$str
∂∂ !
+
∂∂" #
additionalWhere
∂∂$ 3
+
∂∂4 5
$str
∂∂6 9
)
∂∂9 :
;
∂∂: ;

sqlCommand
∑∑ 
.
∑∑ 
Append
∑∑ 
(
∑∑ 
$str
∑∑ "
)
∑∑" #
;
∑∑# $
SqlParameter
ππ 
[
ππ 
]
ππ 
arParams
ππ #
=
ππ$ %
new
ππ& )
SqlParameter
ππ* 6
[
ππ6 7
$num
ππ7 8
]
ππ8 9
;
ππ9 :
arParams
ªª 
[
ªª 
$num
ªª 
]
ªª 
=
ªª 
new
ªª 
SqlParameter
ªª *
(
ªª* +
$str
ªª+ 8
,
ªª8 9
	SqlDbType
ªª: C
.
ªªC D
Text
ªªD H
)
ªªH I
;
ªªI J
arParams
ºº 
[
ºº 
$num
ºº 
]
ºº 
.
ºº 
	Direction
ºº !
=
ºº" # 
ParameterDirection
ºº$ 6
.
ºº6 7
Input
ºº7 <
;
ºº< =
arParams
ΩΩ 
[
ΩΩ 
$num
ΩΩ 
]
ΩΩ 
.
ΩΩ 
Value
ΩΩ 
=
ΩΩ 
dataFieldValue
ΩΩ  .
;
ΩΩ. /
int
√√ 
rowsAffected
√√  
=
√√! "
	SqlHelper
√√# ,
.
√√, -
ExecuteNonQuery
√√- <
(
√√< =
connectionString
ƒƒ $
,
ƒƒ$ %
CommandType
≈≈ 
.
≈≈  
Text
≈≈  $
,
≈≈$ %

sqlCommand
∆∆ 
.
∆∆ 
ToString
∆∆ '
(
∆∆' (
)
∆∆( )
,
∆∆) *
arParams
∆∆+ 3
)
∆∆3 4
;
∆∆4 5
result
»» 
=
»» 
(
»» 
rowsAffected
»» &
>
»»' (
$num
»») *
)
»»* +
;
»»+ ,
return
–– 
result
–– 
;
–– 
}
““ 	
public
ÍÍ 
static
ÍÍ 
bool
ÍÍ ,
DatabaseHelperUpdateTableField
ÍÍ 9
(
ÍÍ9 :
String
ÎÎ 
	tableName
ÎÎ 
,
ÎÎ 
String
ÏÏ 
keyFieldName
ÏÏ 
,
ÏÏ  
String
ÌÌ 
keyFieldValue
ÌÌ  
,
ÌÌ  !
String
ÓÓ 
dataFieldName
ÓÓ  
,
ÓÓ  !
String
ÔÔ 
dataFieldValue
ÔÔ !
,
ÔÔ! "
String
 
additionalWhere
 "
)
" #
{
ÒÒ 	
bool
ÚÚ 
result
ÚÚ 
=
ÚÚ 
false
ÚÚ 
;
ÚÚ  
StringBuilder
ÙÙ 

sqlCommand
ÙÙ $
=
ÙÙ% &
new
ÙÙ' *
StringBuilder
ÙÙ+ 8
(
ÙÙ8 9
)
ÙÙ9 :
;
ÙÙ: ;

sqlCommand
ıı 
.
ıı 
Append
ıı 
(
ıı 
$str
ıı '
+
ıı( )
	tableName
ıı* 3
+
ıı4 5
$str
ıı6 9
)
ıı9 :
;
ıı: ;

sqlCommand
ˆˆ 
.
ˆˆ 
Append
ˆˆ 
(
ˆˆ 
$str
ˆˆ %
+
ˆˆ& '
dataFieldName
ˆˆ( 5
+
ˆˆ6 7
$str
ˆˆ8 I
)
ˆˆI J
;
ˆˆJ K

sqlCommand
˜˜ 
.
˜˜ 
Append
˜˜ 
(
˜˜ 
$str
˜˜ '
+
˜˜( )
keyFieldName
˜˜* 6
+
˜˜7 8
$str
˜˜9 >
+
˜˜? @
keyFieldValue
˜˜A N
)
˜˜N O
;
˜˜O P

sqlCommand
¯¯ 
.
¯¯ 
Append
¯¯ 
(
¯¯ 
$str
¯¯ !
+
¯¯" #
additionalWhere
¯¯$ 3
+
¯¯4 5
$str
¯¯6 9
)
¯¯9 :
;
¯¯: ;

sqlCommand
˘˘ 
.
˘˘ 
Append
˘˘ 
(
˘˘ 
$str
˘˘ "
)
˘˘" #
;
˘˘# $
SqlParameter
˚˚ 
[
˚˚ 
]
˚˚ 
arParams
˚˚ #
=
˚˚$ %
new
˚˚& )
SqlParameter
˚˚* 6
[
˚˚6 7
$num
˚˚7 8
]
˚˚8 9
;
˚˚9 :
arParams
˝˝ 
[
˝˝ 
$num
˝˝ 
]
˝˝ 
=
˝˝ 
new
˝˝ 
SqlParameter
˝˝ *
(
˝˝* +
$str
˝˝+ 8
,
˝˝8 9
	SqlDbType
˝˝: C
.
˝˝C D
Text
˝˝D H
)
˝˝H I
;
˝˝I J
arParams
˛˛ 
[
˛˛ 
$num
˛˛ 
]
˛˛ 
.
˛˛ 
	Direction
˛˛ !
=
˛˛" # 
ParameterDirection
˛˛$ 6
.
˛˛6 7
Input
˛˛7 <
;
˛˛< =
arParams
ˇˇ 
[
ˇˇ 
$num
ˇˇ 
]
ˇˇ 
.
ˇˇ 
Value
ˇˇ 
=
ˇˇ 
dataFieldValue
ˇˇ  .
;
ˇˇ. /
int
ÖÖ 
rowsAffected
ÖÖ  
=
ÖÖ! "
	SqlHelper
ÖÖ# ,
.
ÖÖ, -
ExecuteNonQuery
ÖÖ- <
(
ÖÖ< =
ConnectionString
ÜÜ $
.
ÜÜ$ %&
GetWriteConnectionString
ÜÜ% =
(
ÜÜ= >
)
ÜÜ> ?
,
ÜÜ? @
CommandType
áá 
.
áá  
Text
áá  $
,
áá$ %

sqlCommand
àà 
.
àà 
ToString
àà '
(
àà' (
)
àà( )
,
àà) *
arParams
àà+ 3
)
àà3 4
;
àà4 5
result
ää 
=
ää 
(
ää 
rowsAffected
ää &
>
ää' (
$num
ää) *
)
ää* +
;
ää+ ,
return
íí 
result
íí 
;
íí 
}
îî 	
public
µµ 
static
µµ 
IDataReader
µµ !%
DatabaseHelperGetReader
µµ" 9
(
µµ9 :
String
∂∂ 
connectionString
∂∂ #
,
∂∂# $
String
∑∑ 
	tableName
∑∑ 
,
∑∑ 
String
∏∏ 
whereClause
∏∏ 
)
∏∏ 
{
ππ 	
StringBuilder
∫∫ 

sqlCommand
∫∫ $
=
∫∫% &
new
∫∫' *
StringBuilder
∫∫+ 8
(
∫∫8 9
)
∫∫9 :
;
∫∫: ;

sqlCommand
ªª 
.
ªª 
Append
ªª 
(
ªª 
$str
ªª )
)
ªª) *
;
ªª* +

sqlCommand
ºº 
.
ºº 
Append
ºº 
(
ºº 
$str
ºº %
+
ºº& '
	tableName
ºº( 1
+
ºº2 3
$str
ºº4 7
)
ºº7 8
;
ºº8 9

sqlCommand
ΩΩ 
.
ΩΩ 
Append
ΩΩ 
(
ΩΩ 
whereClause
ΩΩ )
)
ΩΩ) *
;
ΩΩ* +

sqlCommand
ææ 
.
ææ 
Append
ææ 
(
ææ 
$str
ææ "
)
ææ" #
;
ææ# $
return
¿¿ 
	SqlHelper
¿¿ 
.
¿¿ 
ExecuteReader
¿¿ *
(
¿¿* +
connectionString
¡¡  
,
¡¡  !
CommandType
¬¬ 
.
¬¬ 
Text
¬¬  
,
¬¬  !

sqlCommand
√√ 
.
√√ 
ToString
√√ #
(
√√# $
)
√√$ %
)
√√% &
;
√√& '
}
≈≈ 	
public
«« 
static
«« 
IDataReader
«« !%
DatabaseHelperGetReader
««" 9
(
««9 :
string
»» 
connectionString
»» #
,
»»# $
string
…… 
query
…… 
)
   
{
ÀÀ 	
if
ÃÃ 
(
ÃÃ 
string
ÃÃ 
.
ÃÃ 
IsNullOrEmpty
ÃÃ $
(
ÃÃ$ %
connectionString
ÃÃ% 5
)
ÃÃ5 6
)
ÃÃ6 7
{
ÃÃ8 9
connectionString
ÃÃ: J
=
ÃÃK L
ConnectionString
ÃÃM ]
.
ÃÃ] ^%
GetReadConnectionString
ÃÃ^ u
(
ÃÃu v
)
ÃÃv w
;
ÃÃw x
}
ÃÃy z
return
ŒŒ 
	SqlHelper
ŒŒ 
.
ŒŒ 
ExecuteReader
ŒŒ *
(
ŒŒ* +
connectionString
œœ  
,
œœ  !
CommandType
–– 
.
–– 
Text
––  
,
––  !
query
—— 
)
—— 
;
—— 
}
”” 	
public
’’ 
static
’’ 
int
’’ *
DatabaseHelperExecteNonQuery
’’ 6
(
’’6 7
string
÷÷ 
connectionString
÷÷ #
,
÷÷# $
string
◊◊ 
query
◊◊ 
)
ÿÿ 
{
ŸŸ 	
if
⁄⁄ 
(
⁄⁄ 
string
⁄⁄ 
.
⁄⁄ 
IsNullOrEmpty
⁄⁄ $
(
⁄⁄$ %
connectionString
⁄⁄% 5
)
⁄⁄5 6
)
⁄⁄6 7
{
⁄⁄8 9
connectionString
⁄⁄: J
=
⁄⁄K L
ConnectionString
⁄⁄M ]
.
⁄⁄] ^&
GetWriteConnectionString
⁄⁄^ v
(
⁄⁄v w
)
⁄⁄w x
;
⁄⁄x y
}
⁄⁄z {
int
‹‹ 
rowsAffected
‹‹ 
=
‹‹ 
	SqlHelper
‹‹  )
.
‹‹) *
ExecuteNonQuery
‹‹* 9
(
‹‹9 :
connectionString
››  
,
››  !
CommandType
ﬁﬁ 
.
ﬁﬁ 
Text
ﬁﬁ  
,
ﬁﬁ  !
query
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
return
·· 
rowsAffected
·· 
;
··  
}
„„ 	
public
ÂÂ 
static
ÂÂ 
	DataTable
ÂÂ $
DatabaseHelperGetTable
ÂÂ  6
(
ÂÂ6 7
String
ÊÊ 
connectionString
ÊÊ #
,
ÊÊ# $
String
ÁÁ 
	tableName
ÁÁ 
,
ÁÁ 
String
ËË 
whereClause
ËË 
)
ËË 
{
ÈÈ 	
StringBuilder
ÍÍ 

sqlCommand
ÍÍ $
=
ÍÍ% &
new
ÍÍ' *
StringBuilder
ÍÍ+ 8
(
ÍÍ8 9
)
ÍÍ9 :
;
ÍÍ: ;

sqlCommand
ÎÎ 
.
ÎÎ 
Append
ÎÎ 
(
ÎÎ 
$str
ÎÎ )
)
ÎÎ) *
;
ÎÎ* +

sqlCommand
ÏÏ 
.
ÏÏ 
Append
ÏÏ 
(
ÏÏ 
$str
ÏÏ %
+
ÏÏ& '
	tableName
ÏÏ( 1
+
ÏÏ2 3
$str
ÏÏ4 7
)
ÏÏ7 8
;
ÏÏ8 9

sqlCommand
ÌÌ 
.
ÌÌ 
Append
ÌÌ 
(
ÌÌ 
whereClause
ÌÌ )
)
ÌÌ) *
;
ÌÌ* +

sqlCommand
ÓÓ 
.
ÓÓ 
Append
ÓÓ 
(
ÓÓ 
$str
ÓÓ "
)
ÓÓ" #
;
ÓÓ# $
DataSet
 
ds
 
=
 
	SqlHelper
 "
.
" #
ExecuteDataset
# 1
(
1 2
connectionString
ÒÒ  
,
ÒÒ  !
CommandType
ÚÚ 
.
ÚÚ 
Text
ÚÚ  
,
ÚÚ  !

sqlCommand
ÛÛ 
.
ÛÛ 
ToString
ÛÛ #
(
ÛÛ# $
)
ÛÛ$ %
)
ÛÛ% &
;
ÛÛ& '
return
ıı 
ds
ıı 
.
ıı 
Tables
ıı 
[
ıı 
$num
ıı 
]
ıı 
;
ıı  
}
˜˜ 	
public
˘˘ 
static
˘˘ 
void
˘˘ >
0DatabaseHelperDoForumVersion2202PostUpgradeTasks
˘˘ K
(
˘˘K L
String
˙˙ $
overrideConnectionInfo
˙˙ )
)
˙˙) *
{
˚˚ 	
}
˛˛ 	
public
ÄÄ 
static
ÄÄ 
void
ÄÄ >
0DatabaseHelperDoForumVersion2203PostUpgradeTasks
ÄÄ K
(
ÄÄK L
String
ÅÅ $
overrideConnectionInfo
ÅÅ )
)
ÅÅ) *
{
ÇÇ 	
}
ÖÖ 	
public
áá 
static
áá 
void
áá 9
+DatabaseHelperDoVersion2320PostUpgradeTasks
áá F
(
ááF G
String
àà $
overrideConnectionInfo
àà )
)
àà) *
{
ââ 	
}
åå 	
public
éé 
static
éé 
void
éé 9
+DatabaseHelperDoVersion2230PostUpgradeTasks
éé F
(
ééF G
String
ééG M$
overrideConnectionInfo
ééN d
)
ééd e
{
èè 	
}
êê 	
public
íí 
static
íí 
void
íí 9
+DatabaseHelperDoVersion2234PostUpgradeTasks
íí F
(
ííF G
String
ííG M$
overrideConnectionInfo
ííN d
)
ííd e
{
ìì 	
}
îî 	
public
ññ 
static
ññ 
void
ññ 9
+DatabaseHelperDoVersion2247PostUpgradeTasks
ññ F
(
ññF G
String
ññG M$
overrideConnectionInfo
ññN d
)
ññd e
{
óó 	
}
òò 	
public
öö 
static
öö 
void
öö 9
+DatabaseHelperDoVersion2253PostUpgradeTasks
öö F
(
ööF G
String
õõ $
overrideConnectionInfo
õõ )
)
õõ) *
{
úú 	
}
üü 	
public
°° 
static
°° 
bool
°° ,
DatabaseHelperSitesTableExists
°° 9
(
°°9 :
)
°°: ;
{
¢¢ 	
return
££ '
DatabaseHelperTableExists
££ ,
(
££, -
$str
££- 7
)
££7 8
;
££8 9
}
§§ 	
public
¶¶ 
static
¶¶ 
bool
¶¶ '
DatabaseHelperTableExists
¶¶ 4
(
¶¶4 5
string
¶¶5 ;
	tableName
¶¶< E
)
¶¶E F
{
ßß 	
using
™™ 
(
™™ 
SqlConnection
™™  

connection
™™! +
=
™™, -
new
™™. 1
SqlConnection
™™2 ?
(
™™? @
ConnectionString
™™@ P
.
™™P Q%
GetReadConnectionString
™™Q h
(
™™h i
)
™™i j
)
™™j k
)
™™k l
{
´´ 
string
¨¨ 
[
¨¨ 
]
¨¨ 
restrictions
¨¨ %
=
¨¨& '
new
¨¨( +
string
¨¨, 2
[
¨¨2 3
$num
¨¨3 4
]
¨¨4 5
;
¨¨5 6
restrictions
≠≠ 
[
≠≠ 
$num
≠≠ 
]
≠≠ 
=
≠≠  !
	tableName
≠≠" +
;
≠≠+ ,

connection
ÆÆ 
.
ÆÆ 
Open
ÆÆ 
(
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
	DataTable
ØØ 
table
ØØ 
=
ØØ  !

connection
ØØ" ,
.
ØØ, -
	GetSchema
ØØ- 6
(
ØØ6 7
$str
ØØ7 ?
,
ØØ? @
restrictions
ØØA M
)
ØØM N
;
ØØN O
if
∞∞ 
(
∞∞ 
table
∞∞ 
!=
∞∞ 
null
∞∞ !
)
∞∞! "
{
±± 
return
≤≤ 
(
≤≤ 
table
≤≤ !
.
≤≤! "
Rows
≤≤" &
.
≤≤& '
Count
≤≤' ,
>
≤≤- .
$num
≤≤/ 0
)
≤≤0 1
;
≤≤1 2
}
≥≥ 
}
¥¥ 
return
∂∂ 
false
∂∂ 
;
∂∂ 
}
∑∑ 	
}
∏	∏	 
}π	π	 ’ü
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBRedirectList.cs
	namespace

 	

mojoPortal


 
.

 
Data

 
{ 
public 

static 
class 
DBRedirectList &
{ 
public'' 
static'' 
int'' 
Create''  
(''  !
Guid(( 
rowGuid(( 
,(( 
Guid)) 
siteGuid)) 
,)) 
int** 
siteID** 
,** 
string++ 
oldUrl++ 
,++ 
string,, 
newUrl,, 
,,, 
DateTime-- 

createdUtc-- 
,--  
DateTime.. 
	expireUtc.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i Å
,
00Å Ç
$num
00É Ñ
)
00Ñ Ö
;
00Ö Ü
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# -
,11- .
	SqlDbType11/ 8
.118 9
UniqueIdentifier119 I
,11I J
ParameterDirection11K ]
.11] ^
Input11^ c
,11c d
rowGuid11e l
)11l m
;11m n
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
siteGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# ,
,33, -
	SqlDbType33. 7
.337 8
Int338 ;
,33; <
ParameterDirection33= O
.33O P
Input33P U
,33U V
siteID33W ]
)33] ^
;33^ _
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# ,
,44, -
	SqlDbType44. 7
.447 8
NVarChar448 @
,44@ A
$num44B E
,44E F
ParameterDirection44G Y
.44Y Z
Input44Z _
,44_ `
oldUrl44a g
)44g h
;44h i
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# ,
,55, -
	SqlDbType55. 7
.557 8
NVarChar558 @
,55@ A
$num55B E
,55E F
ParameterDirection55G Y
.55Y Z
Input55Z _
,55_ `
newUrl55a g
)55g h
;55h i
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
DateTime66< D
,66D E
ParameterDirection66F X
.66X Y
Input66Y ^
,66^ _

createdUtc66` j
)66j k
;66k l
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# /
,77/ 0
	SqlDbType771 :
.77: ;
DateTime77; C
,77C D
ParameterDirection77E W
.77W X
Input77X ]
,77] ^
	expireUtc77_ h
)77h i
;77i j
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
rowsAffected99 
;99  
};; 	
publicEE 
staticEE 
boolEE 
UpdateEE !
(EE! "
GuidFF 
rowGuidFF 
,FF 
stringGG 
oldUrlGG 
,GG 
stringHH 
newUrlHH 
,HH 
DateTimeII 
	expireUtcII 
)II 
{JJ 	
SqlParameterHelperKK 
sphKK "
=KK# $
newKK% (
SqlParameterHelperKK) ;
(KK; <
ConnectionStringKK< L
.KKL M$
GetWriteConnectionStringKKM e
(KKe f
)KKf g
,KKg h
$str	KKi Å
,
KKÅ Ç
$num
KKÉ Ñ
)
KKÑ Ö
;
KKÖ Ü
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# -
,LL- .
	SqlDbTypeLL/ 8
.LL8 9
UniqueIdentifierLL9 I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
rowGuidLLe l
)LLl m
;LLm n
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# ,
,MM, -
	SqlDbTypeMM. 7
.MM7 8
NVarCharMM8 @
,MM@ A
$numMMB E
,MME F
ParameterDirectionMMG Y
.MMY Z
InputMMZ _
,MM_ `
oldUrlMMa g
)MMg h
;MMh i
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# ,
,NN, -
	SqlDbTypeNN. 7
.NN7 8
NVarCharNN8 @
,NN@ A
$numNNB E
,NNE F
ParameterDirectionNNG Y
.NNY Z
InputNNZ _
,NN_ `
newUrlNNa g
)NNg h
;NNh i
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# /
,OO/ 0
	SqlDbTypeOO1 :
.OO: ;
DateTimeOO; C
,OOC D
ParameterDirectionOOE W
.OOW X
InputOOX ]
,OO] ^
	expireUtcOO_ h
)OOh i
;OOi j
intPP 
rowsAffectedPP 
=PP 
sphPP "
.PP" #
ExecuteNonQueryPP# 2
(PP2 3
)PP3 4
;PP4 5
returnQQ 
(QQ 
rowsAffectedQQ  
>QQ! "
$numQQ# $
)QQ$ %
;QQ% &
}SS 	
public\\ 
static\\ 
bool\\ 
Delete\\ !
(\\! "
Guid\\" &
rowGuid\\' .
)\\. /
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M$
GetWriteConnectionString^^M e
(^^e f
)^^f g
,^^g h
$str	^^i Å
,
^^Å Ç
$num
^^É Ñ
)
^^Ñ Ö
;
^^Ö Ü
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# -
,__- .
	SqlDbType__/ 8
.__8 9
UniqueIdentifier__9 I
,__I J
ParameterDirection__K ]
.__] ^
Input__^ c
,__c d
rowGuid__e l
)__l m
;__m n
int`` 
rowsAffected`` 
=`` 
sph`` "
.``" #
ExecuteNonQuery``# 2
(``2 3
)``3 4
;``4 5
returnaa 
(aa 
rowsAffectedaa  
>aa! "
$numaa# $
)aa$ %
;aa% &
}cc 	
publicii 
staticii 
IDataReaderii !
GetOneii" (
(ii( )
Guidii* .
rowGuidii/ 6
)ii6 7
{jj 	
SqlParameterHelperkk 
sphkk "
=kk# $
newkk% (
SqlParameterHelperkk) ;
(kk; <
ConnectionStringkk< L
.kkL M#
GetReadConnectionStringkkM d
(kkd e
)kke f
,kkf g
$str	kkh É
,
kkÉ Ñ
$num
kkÖ Ü
)
kkÜ á
;
kká à
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# -
,ll- .
	SqlDbTypell/ 8
.ll8 9
UniqueIdentifierll9 I
,llI J
ParameterDirectionllK ]
.ll] ^
Inputll^ c
,llc d
rowGuidlle l
)lll m
;llm n
returnmm 
sphmm 
.mm 
ExecuteReadermm $
(mm$ %
)mm% &
;mm& '
}oo 	
publicvv 
staticvv 
IDataReadervv !
GetBySiteAndUrlvv" 1
(vv1 2
intvv2 5
siteIdvv6 <
,vv< =
stringvv> D
oldUrlvvE K
)vvK L
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M#
GetReadConnectionStringxxM d
(xxd e
)xxe f
,xxf g
$str	xxh å
,
xxå ç
$num
xxé è
)
xxè ê
;
xxê ë
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# ,
,yy, -
	SqlDbTypeyy. 7
.yy7 8
Intyy8 ;
,yy; <
ParameterDirectionyy= O
.yyO P
InputyyP U
,yyU V
siteIdyyW ]
)yy] ^
;yy^ _
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# ,
,zz, -
	SqlDbTypezz. 7
.zz7 8
NVarCharzz8 @
,zz@ A
$numzzB E
,zzE F
ParameterDirectionzzG Y
.zzY Z
InputzzZ _
,zz_ `
oldUrlzza g
)zzg h
;zzh i
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 1
,{{1 2
	SqlDbType{{3 <
.{{< =
DateTime{{= E
,{{E F
ParameterDirection{{G Y
.{{Y Z
Input{{Z _
,{{_ `
DateTime{{a i
.{{i j
UtcNow{{j p
){{p q
;{{q r
return|| 
sph|| 
.|| 
ExecuteReader|| $
(||$ %
)||% &
;||& '
}~~ 	
public
ÑÑ 
static
ÑÑ 
bool
ÑÑ 
Exists
ÑÑ !
(
ÑÑ! "
int
ÑÑ" %
siteId
ÑÑ& ,
,
ÑÑ, -
string
ÑÑ. 4
oldUrl
ÑÑ5 ;
)
ÑÑ; <
{
ÖÖ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$strÜÜh Ä
,ÜÜÄ Å
$numÜÜÇ É
)ÜÜÉ Ñ
;ÜÜÑ Ö
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# ,
,
áá, -
	SqlDbType
áá. 7
.
áá7 8
Int
áá8 ;
,
áá; < 
ParameterDirection
áá= O
.
ááO P
Input
ááP U
,
ááU V
siteId
ááW ]
)
áá] ^
;
áá^ _
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# ,
,
àà, -
	SqlDbType
àà. 7
.
àà7 8
NVarChar
àà8 @
,
àà@ A
$num
ààB E
,
ààE F 
ParameterDirection
ààG Y
.
ààY Z
Input
ààZ _
,
àà_ `
oldUrl
ààa g
)
ààg h
;
ààh i
int
ââ 
count
ââ 
=
ââ 
Convert
ââ 
.
ââ  
ToInt32
ââ  '
(
ââ' (
sph
ââ( +
.
ââ+ ,
ExecuteScalar
ââ, 9
(
ââ9 :
)
ââ: ;
)
ââ; <
;
ââ< =
return
ää 
(
ää 
count
ää 
>
ää 
$num
ää 
)
ää 
;
ää 
}
åå 	
public
ëë 
static
ëë 
int
ëë 
GetCount
ëë "
(
ëë" #
int
ëë# &
siteId
ëë' -
,
ëë- .
string
ëë/ 5

searchTerm
ëë6 @
=
ëëA B
$str
ëëC E
)
ëëE F
{
íí 	
var
ìì 
	useSearch
ìì 
=
ìì 
!
ìì 
string
ìì 
.
ìì  
IsNullOrWhiteSpace
ìì -
(
ìì- .

searchTerm
ìì. 8
)
ìì8 9
;
ìì9 :
if
ïï 
(
ïï 
	useSearch
ïï 
)
ïï 
{
ññ  
SqlParameterHelper
óó 
sph
óó 
=
óó 
new
óó   
SqlParameterHelper
óó! 3
(
óó3 4
ConnectionString
óó4 D
.
óóD E%
GetReadConnectionString
óóE \
(
óó\ ]
)
óó] ^
,
óó^ _
$stróó` Ä
,óóÄ Å
$numóóÇ É
)óóÉ Ñ
;óóÑ Ö
sph
òò 
.
òò  
DefineSqlParameter
òò 
(
òò 
$str
òò $
,
òò$ %
	SqlDbType
òò& /
.
òò/ 0
Int
òò0 3
,
òò3 4 
ParameterDirection
òò5 G
.
òòG H
Input
òòH M
,
òòM N
siteId
òòO U
)
òòU V
;
òòV W
sph
ôô 
.
ôô  
DefineSqlParameter
ôô 
(
ôô 
$str
ôô (
,
ôô( )
	SqlDbType
ôô* 3
.
ôô3 4
NVarChar
ôô4 <
,
ôô< =
$num
ôô> A
,
ôôA B 
ParameterDirection
ôôC U
.
ôôU V
Input
ôôV [
,
ôô[ \

searchTerm
ôô] g
)
ôôg h
;
ôôh i
return
öö 

Convert
öö 
.
öö 
ToInt32
öö 
(
öö 
sph
öö 
.
öö 
ExecuteScalar
öö ,
(
öö, -
)
öö- .
)
öö. /
;
öö/ 0
}
õõ 
else
úú 
{
ùù  
SqlParameterHelper
ûû 
sph
ûû 
=
ûû 
new
ûû   
SqlParameterHelper
ûû! 3
(
ûû3 4
ConnectionString
ûû4 D
.
ûûD E%
GetReadConnectionString
ûûE \
(
ûû\ ]
)
ûû] ^
,
ûû^ _
$str
ûû` z
,
ûûz {
$num
ûû| }
)
ûû} ~
;
ûû~ 
sph
üü 
.
üü  
DefineSqlParameter
üü 
(
üü 
$str
üü $
,
üü$ %
	SqlDbType
üü& /
.
üü/ 0
Int
üü0 3
,
üü3 4 
ParameterDirection
üü5 G
.
üüG H
Input
üüH M
,
üüM N
siteId
üüO U
)
üüU V
;
üüV W
return
†† 

Convert
†† 
.
†† 
ToInt32
†† 
(
†† 
sph
†† 
.
†† 
ExecuteScalar
†† ,
(
††, -
)
††- .
)
††. /
;
††/ 0
}
°° 
}
££ 	
public
´´ 
static
´´	 
IDataReader
´´ 
GetPage
´´ #
(
´´# $
int
¨¨ 
siteId
¨¨ 
,
¨¨ 
int
≠≠ 

pageNumber
≠≠ 
,
≠≠ 
int
ÆÆ 
pageSize
ÆÆ 
,
ÆÆ 
out
ØØ 
int
ØØ 


totalPages
ØØ 
,
ØØ 
string
∞∞ 	

searchTerm
∞∞
 
=
∞∞ 
$str
∞∞ 
)
∞∞ 
{
±± 
var
≤≤ 
	useSearch
≤≤ 
=
≤≤ 
!
≤≤ 
string
≤≤ 
.
≤≤  
IsNullOrWhiteSpace
≤≤ -
(
≤≤- .

searchTerm
≤≤. 8
)
≤≤8 9
;
≤≤9 :

totalPages
≥≥ 
=
≥≥ 
$num
≥≥ 
;
≥≥ 
int
¥¥ 
	totalRows
¥¥ 
=
¥¥ 
GetCount
¥¥ 
(
¥¥ 
siteId
¥¥ "
,
¥¥" #

searchTerm
¥¥$ .
)
¥¥. /
;
¥¥/ 0
if
∂∂ 
(
∂∂ 
pageSize
∂∂ 
>
∂∂ 
$num
∂∂ 
)
∂∂ 

totalPages
∂∂ 
=
∂∂  !
	totalRows
∂∂" +
/
∂∂, -
pageSize
∂∂. 6
;
∂∂6 7
if
∏∏ 
(
∏∏ 
	totalRows
∏∏ 
<=
∏∏ 
pageSize
∏∏ 
)
∏∏ 
{
ππ 

totalPages
∫∫ 
=
∫∫ 
$num
∫∫ 
;
∫∫ 
}
ªª 
else
ºº 
{
ΩΩ 
int
ææ 
	remainder
ææ 
;
ææ 
Math
øø 
.
øø 	
DivRem
øø	 
(
øø 
	totalRows
øø 
,
øø 
pageSize
øø #
,
øø# $
out
øø% (
	remainder
øø) 2
)
øø2 3
;
øø3 4
if
¿¿ 
(
¿¿ 
	remainder
¿¿ 
>
¿¿ 
$num
¿¿ 
)
¿¿ 
{
¡¡ 

totalPages
¬¬ 
+=
¬¬ 
$num
¬¬ 
;
¬¬ 
}
√√ 
}
ƒƒ 
if
∆∆ 
(
∆∆ 
	useSearch
∆∆ 
)
∆∆ 
{
««  
SqlParameterHelper
»» 
sph
»» 
=
»» 
new
»»   
SqlParameterHelper
»»! 3
(
»»3 4
ConnectionString
»»4 D
.
»»D E%
GetReadConnectionString
»»E \
(
»»\ ]
)
»»] ^
,
»»^ _
$str»»` Ç
,»»Ç É
$num»»Ñ Ö
)»»Ö Ü
;»»Ü á
sph
…… 
.
……  
DefineSqlParameter
…… 
(
…… 
$str
…… $
,
……$ %
	SqlDbType
……& /
.
……/ 0
Int
……0 3
,
……3 4 
ParameterDirection
……5 G
.
……G H
Input
……H M
,
……M N
siteId
……O U
)
……U V
;
……V W
sph
   
.
    
DefineSqlParameter
   
(
   
$str
   (
,
  ( )
	SqlDbType
  * 3
.
  3 4
NVarChar
  4 <
,
  < =
$num
  > A
,
  A B 
ParameterDirection
  C U
.
  U V
Input
  V [
,
  [ \

searchTerm
  ] g
)
  g h
;
  h i
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ 
(
ÀÀ 
$str
ÀÀ (
,
ÀÀ( )
	SqlDbType
ÀÀ* 3
.
ÀÀ3 4
Int
ÀÀ4 7
,
ÀÀ7 8 
ParameterDirection
ÀÀ9 K
.
ÀÀK L
Input
ÀÀL Q
,
ÀÀQ R

pageNumber
ÀÀS ]
)
ÀÀ] ^
;
ÀÀ^ _
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ 
(
ÃÃ 
$str
ÃÃ &
,
ÃÃ& '
	SqlDbType
ÃÃ( 1
.
ÃÃ1 2
Int
ÃÃ2 5
,
ÃÃ5 6 
ParameterDirection
ÃÃ7 I
.
ÃÃI J
Input
ÃÃJ O
,
ÃÃO P
pageSize
ÃÃQ Y
)
ÃÃY Z
;
ÃÃZ [
return
ÕÕ 

sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
ŒŒ 
else
œœ 
{
––  
SqlParameterHelper
—— 
sph
—— 
=
—— 
new
——   
SqlParameterHelper
——! 3
(
——3 4
ConnectionString
——4 D
.
——D E%
GetReadConnectionString
——E \
(
——\ ]
)
——] ^
,
——^ _
$str
——` |
,
——| }
$num
——~ 
)—— Ä
;——Ä Å
sph
““ 
.
““  
DefineSqlParameter
““ 
(
““ 
$str
““ $
,
““$ %
	SqlDbType
““& /
.
““/ 0
Int
““0 3
,
““3 4 
ParameterDirection
““5 G
.
““G H
Input
““H M
,
““M N
siteId
““O U
)
““U V
;
““V W
sph
”” 
.
””  
DefineSqlParameter
”” 
(
”” 
$str
”” (
,
””( )
	SqlDbType
””* 3
.
””3 4
Int
””4 7
,
””7 8 
ParameterDirection
””9 K
.
””K L
Input
””L Q
,
””Q R

pageNumber
””S ]
)
””] ^
;
””^ _
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ 
(
‘‘ 
$str
‘‘ &
,
‘‘& '
	SqlDbType
‘‘( 1
.
‘‘1 2
Int
‘‘2 5
,
‘‘5 6 
ParameterDirection
‘‘7 I
.
‘‘I J
Input
‘‘J O
,
‘‘O P
pageSize
‘‘Q Y
)
‘‘Y Z
;
‘‘Z [
return
’’ 

sph
’’ 
.
’’ 
ExecuteReader
’’ 
(
’’ 
)
’’ 
;
’’ 
}
÷÷ 
}
◊◊ 
}
ŸŸ 
}⁄⁄ ôÈ
gD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbRoles.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBRoles 
{ 
public 
static 
int 

RoleCreate $
($ %
Guid 
roleGuid 
, 
Guid 
siteGuid 
, 
int 
siteId 
, 
string 
roleName 
, 
string 	
displayName
 
) 
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri z
,z {
$num| }
)} ~
;~ 
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
roleGuidf n
)n o
;o p
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
siteGuidf n
)n o
;o p
sph 
. 
DefineSqlParameter "
(" #
$str# ,
,, -
	SqlDbType. 7
.7 8
Int8 ;
,; <
ParameterDirection= O
.O P
InputP U
,U V
siteIdW ]
)] ^
;^ _
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
NVarChar: B
,B C
$numD F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
roleNameb j
)j k
;k l
sph 
. 
DefineSqlParameter "
(" #
$str# 1
,1 2
	SqlDbType3 <
.< =
NVarChar= E
,E F
$numG I
,I J
ParameterDirectionK ]
.] ^
Input^ c
,c d
displayNamee p
)p q
;q r
int 
newID 
= 
Convert 
. 
ToInt32 
( 
sph "
." #
ExecuteScalar# 0
(0 1
)1 2
)2 3
;3 4
return   
newID   
;   
}!! 	
public## 
static## 
bool## 
Update## !
(##! "
int##" %
roleId##& ,
,##, -
string##. 4
displayName##5 @
)##@ A
{$$ 	
SqlParameterHelper%% 
sph%% "
=%%# $
new%%% (
SqlParameterHelper%%) ;
(%%; <
ConnectionString%%< L
.%%L M$
GetWriteConnectionString%%M e
(%%e f
)%%f g
,%%g h
$str%%i z
,%%z {
$num%%| }
)%%} ~
;%%~ 
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# ,
,&&, -
	SqlDbType&&. 7
.&&7 8
Int&&8 ;
,&&; <
ParameterDirection&&= O
.&&O P
Input&&P U
,&&U V
roleId&&W ]
)&&] ^
;&&^ _
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# 1
,''1 2
	SqlDbType''3 <
.''< =
NVarChar''= E
,''E F
$num''G I
,''I J
ParameterDirection''K ]
.''] ^
Input''^ c
,''c d
displayName''e p
)''p q
;''q r
int(( 
rowsAffected(( 
=(( 
sph(( "
.((" #
ExecuteNonQuery((# 2
(((2 3
)((3 4
;((4 5
return)) 
()) 
rowsAffected))  
>))! "
-))# $
$num))$ %
)))% &
;))& '
}** 	
public,, 
static,, 
bool,, 
Delete,, !
(,,! "
int,," %
roleId,,& ,
),,, -
{-- 	
SqlParameterHelper.. 
sph.. "
=..# $
new..% (
SqlParameterHelper..) ;
(..; <
ConnectionString..< L
...L M$
GetWriteConnectionString..M e
(..e f
)..f g
,..g h
$str..i z
,..z {
$num..| }
)..} ~
;..~ 
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# ,
,//, -
	SqlDbType//. 7
.//7 8
Int//8 ;
,//; <
ParameterDirection//= O
.//O P
Input//P U
,//U V
roleId//W ]
)//] ^
;//^ _
int00 
rowsAffected00 
=00 
sph00 "
.00" #
ExecuteNonQuery00# 2
(002 3
)003 4
;004 5
return11 
(11 
rowsAffected11  
>11! "
-11# $
$num11$ %
)11% &
;11& '
}22 	
public44 
static44 
bool44 
DeleteUserRoles44 *
(44* +
int44+ .
userId44/ 5
)445 6
{55 	
SqlParameterHelper66 
sph66 "
=66# $
new66% (
SqlParameterHelper66) ;
(66; <
ConnectionString66< L
.66L M$
GetWriteConnectionString66M e
(66e f
)66f g
,66g h
$str	66i á
,
66á à
$num
66â ä
)
66ä ã
;
66ã å
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ,
,77, -
	SqlDbType77. 7
.777 8
Int778 ;
,77; <
ParameterDirection77= O
.77O P
Input77P U
,77U V
userId77W ]
)77] ^
;77^ _
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
(99 
rowsAffected99  
>99! "
-99# $
$num99$ %
)99% &
;99& '
}:: 	
public<< 
static<< 
bool<< 
Exists<< !
(<<! "
int<<" %
siteId<<& ,
,<<, -
string<<. 4
roleName<<5 =
)<<= >
{== 	
SqlParameterHelper>> 
sph>> "
=>># $
new>>% (
SqlParameterHelper>>) ;
(>>; <
ConnectionString>>< L
.>>L M#
GetReadConnectionString>>M d
(>>d e
)>>e f
,>>f g
$str>>h }
,>>} ~
$num	>> Ä
)
>>Ä Å
;
>>Å Ç
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# ,
,??, -
	SqlDbType??. 7
.??7 8
Int??8 ;
,??; <
ParameterDirection??= O
.??O P
Input??P U
,??U V
siteId??W ]
)??] ^
;??^ _
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# .
,@@. /
	SqlDbType@@0 9
.@@9 :
NVarChar@@: B
,@@B C
$num@@D F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
roleName@@b j
)@@j k
;@@k l
intAA 
countAA 
=AA 
ConvertAA 
.AA  
ToInt32AA  '
(AA' (
sphAA( +
.AA+ ,
ExecuteScalarAA, 9
(AA9 :
)AA: ;
)AA; <
;AA< =
returnBB 
(BB 
countBB 
>BB 
$numBB 
)BB 
;BB 
}DD 	
publicFF 
staticFF 
IDataReaderFF !
GetByIdFF" )
(FF) *
intFF* -
roleIdFF. 4
)FF4 5
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M#
GetReadConnectionStringHHM d
(HHd e
)HHe f
,HHf g
$strHHh |
,HH| }
$numHH~ 
)	HH Ä
;
HHÄ Å
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# ,
,II, -
	SqlDbTypeII. 7
.II7 8
IntII8 ;
,II; <
ParameterDirectionII= O
.IIO P
InputIIP U
,IIU V
roleIdIIW ]
)II] ^
;II^ _
returnJJ 
sphJJ 
.JJ 
ExecuteReaderJJ $
(JJ$ %
)JJ% &
;JJ& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !
	GetByNameMM" +
(MM+ ,
intMM, /
siteIdMM0 6
,MM6 7
stringMM8 >
roleNameMM? G
)MMG H
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh Ç
,
OOÇ É
$num
OOÑ Ö
)
OOÖ Ü
;
OOÜ á
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
IntPP8 ;
,PP; <
ParameterDirectionPP= O
.PPO P
InputPPP U
,PPU V
siteIdPPW ]
)PP] ^
;PP^ _
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
NVarCharQQ: B
,QQB C
$numQQD F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
roleNameQQb j
)QQj k
;QQk l
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}SS 	
publicUU 
staticUU 
IDataReaderUU !
GetSiteRolesUU" .
(UU. /
intUU/ 2
siteIdUU3 9
)UU9 :
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M#
GetReadConnectionStringWWM d
(WWd e
)WWe f
,WWf g
$strWWh y
,WWy z
$numWW{ |
)WW| }
;WW} ~
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# ,
,XX, -
	SqlDbTypeXX. 7
.XX7 8
IntXX8 ;
,XX; <
ParameterDirectionXX= O
.XXO P
InputXXP U
,XXU V
siteIdXXW ]
)XX] ^
;XX^ _
returnYY 
sphYY 
.YY 
ExecuteReaderYY $
(YY$ %
)YY% &
;YY& '
}ZZ 	
public\\ 
static\\ 
IDataReader\\ !
GetRoleMembers\\" 0
(\\0 1
int\\1 4
roleId\\5 ;
)\\; <
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M#
GetReadConnectionString^^M d
(^^d e
)^^e f
,^^f g
$str	^^h Ö
,
^^Ö Ü
$num
^^á à
)
^^à â
;
^^â ä
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Int__8 ;
,__; <
ParameterDirection__= O
.__O P
Input__P U
,__U V
roleId__W ]
)__] ^
;__^ _
return`` 
sph`` 
.`` 
ExecuteReader`` $
(``$ %
)``% &
;``& '
}aa 	
publiccc 
staticcc 
intcc $
GetCountOfUsersNotInRolecc 2
(cc2 3
intcc3 6
siteIdcc7 =
,cc= >
intcc? B
roleIdccC I
)ccI J
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M#
GetReadConnectionStringeeM d
(eed e
)eee f
,eef g
$str	eeh Ö
,
eeÖ Ü
$num
eeá à
)
eeà â
;
eeâ ä
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# ,
,ff, -
	SqlDbTypeff. 7
.ff7 8
Intff8 ;
,ff; <
ParameterDirectionff= O
.ffO P
InputffP U
,ffU V
siteIdffW ]
)ff] ^
;ff^ _
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# ,
,gg, -
	SqlDbTypegg. 7
.gg7 8
Intgg8 ;
,gg; <
ParameterDirectiongg= O
.ggO P
InputggP U
,ggU V
roleIdggW ]
)gg] ^
;gg^ _
returnii 
Convertii 
.ii 
ToInt32ii "
(ii" #
sphii# &
.ii& '
ExecuteScalarii' 4
(ii4 5
)ii5 6
)ii6 7
;ii7 8
}jj 	
publicll 
staticll 
IDataReaderll !
GetUsersNotInRolell" 3
(ll3 4
intmm 
siteIdmm 
,mm 
intnn 
roleIdnn 
,nn 
intoo 

pageNumberoo 
,oo 
intpp 
pageSizepp 
,pp 
outqq 
intqq 


totalPagesqq 
)qq 
{rr 	

totalPagesss 
=ss 
$numss 
;ss 
inttt 
	totalRowstt 
=tt $
GetCountOfUsersNotInRolett 4
(tt4 5
siteIdtt5 ;
,tt; <
roleIdtt= C
)ttC D
;ttD E
ifvv 
(vv 
pageSizevv 
>vv 
$numvv 
)vv 

totalPagesvv (
=vv) *
	totalRowsvv+ 4
/vv5 6
pageSizevv7 ?
;vv? @
ifxx 
(xx 
	totalRowsxx 
<=xx 
pageSizexx %
)xx% &
{yy 

totalPageszz 
=zz 
$numzz 
;zz 
}{{ 
else|| 
{}} 
int~~ 
	remainder~~ 
;~~ 
Math 
. 
DivRem 
( 
	totalRows %
,% &
pageSize' /
,/ 0
out1 4
	remainder5 >
)> ?
;? @
if
ÄÄ 
(
ÄÄ 
	remainder
ÄÄ 
>
ÄÄ 
$num
ÄÄ  !
)
ÄÄ! "
{
ÅÅ 

totalPages
ÇÇ 
+=
ÇÇ !
$num
ÇÇ" #
;
ÇÇ# $
}
ÉÉ 
}
ÑÑ  
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$strÜÜh Ü
,ÜÜÜ á
$numÜÜà â
)ÜÜâ ä
;ÜÜä ã
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# ,
,
áá, -
	SqlDbType
áá. 7
.
áá7 8
Int
áá8 ;
,
áá; < 
ParameterDirection
áá= O
.
ááO P
Input
ááP U
,
ááU V
siteId
ááW ]
)
áá] ^
;
áá^ _
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# ,
,
àà, -
	SqlDbType
àà. 7
.
àà7 8
Int
àà8 ;
,
àà; < 
ParameterDirection
àà= O
.
ààO P
Input
ààP U
,
ààU V
roleId
ààW ]
)
àà] ^
;
àà^ _
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 0
,
ââ0 1
	SqlDbType
ââ2 ;
.
ââ; <
Int
ââ< ?
,
ââ? @ 
ParameterDirection
ââA S
.
ââS T
Input
ââT Y
,
ââY Z

pageNumber
ââ[ e
)
ââe f
;
ââf g
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
Int
ää: =
,
ää= > 
ParameterDirection
ää? Q
.
ääQ R
Input
ääR W
,
ääW X
pageSize
ääY a
)
ääa b
;
ääb c
return
ãã 
sph
ãã 
.
ãã 
ExecuteReader
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
åå 	
public
éé 
static
éé 
int
éé #
GetCountOfUsersInRole
éé /
(
éé/ 0
int
éé0 3
siteId
éé4 :
,
éé: ;
int
éé< ?
roleId
éé@ F
)
ééF G
{
èè 	 
SqlParameterHelper
êê 
sph
êê "
=
êê# $
new
êê% ( 
SqlParameterHelper
êê) ;
(
êê; <
ConnectionString
êê< L
.
êêL M%
GetReadConnectionString
êêM d
(
êêd e
)
êêe f
,
êêf g
$strêêh Ç
,êêÇ É
$numêêÑ Ö
)êêÖ Ü
;êêÜ á
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# ,
,
ëë, -
	SqlDbType
ëë. 7
.
ëë7 8
Int
ëë8 ;
,
ëë; < 
ParameterDirection
ëë= O
.
ëëO P
Input
ëëP U
,
ëëU V
siteId
ëëW ]
)
ëë] ^
;
ëë^ _
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# ,
,
íí, -
	SqlDbType
íí. 7
.
íí7 8
Int
íí8 ;
,
íí; < 
ParameterDirection
íí= O
.
ííO P
Input
ííP U
,
ííU V
roleId
ííW ]
)
íí] ^
;
íí^ _
return
îî 
Convert
îî 
.
îî 
ToInt32
îî "
(
îî" #
sph
îî# &
.
îî& '
ExecuteScalar
îî' 4
(
îî4 5
)
îî5 6
)
îî6 7
;
îî7 8
}
ïï 	
public
óó 
static
óó 
IDataReader
óó !
GetUsersInRole
óó" 0
(
óó0 1
int
òò 
siteId
òò 
,
òò 
int
ôô 
roleId
ôô 
,
ôô 
int
öö 

pageNumber
öö 
,
öö 
int
õõ 
pageSize
õõ 
,
õõ 
out
úú 
int
úú 

totalPages
úú 
)
úú 
{
ùù 	

totalPages
ûû 
=
ûû 
$num
ûû 
;
ûû 
int
üü 
	totalRows
üü 
=
üü #
GetCountOfUsersInRole
üü 1
(
üü1 2
siteId
üü2 8
,
üü8 9
roleId
üü: @
)
üü@ A
;
üüA B
if
°° 
(
°° 
pageSize
°° 
>
°° 
$num
°° 
)
°° 

totalPages
°° (
=
°°) *
	totalRows
°°+ 4
/
°°5 6
pageSize
°°7 ?
;
°°? @
if
££ 
(
££ 
	totalRows
££ 
<=
££ 
pageSize
££ %
)
££% &
{
§§ 

totalPages
•• 
=
•• 
$num
•• 
;
•• 
}
¶¶ 
else
ßß 
{
®® 
int
©© 
	remainder
©© 
;
©© 
Math
™™ 
.
™™ 
DivRem
™™ 
(
™™ 
	totalRows
™™ %
,
™™% &
pageSize
™™' /
,
™™/ 0
out
™™1 4
	remainder
™™5 >
)
™™> ?
;
™™? @
if
´´ 
(
´´ 
	remainder
´´ 
>
´´ 
$num
´´  !
)
´´! "
{
¨¨ 

totalPages
≠≠ 
+=
≠≠ !
$num
≠≠" #
;
≠≠# $
}
ÆÆ 
}
ØØ  
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h É
,±±É Ñ
$num±±Ö Ü
)±±Ü á
;±±á à
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# ,
,
≤≤, -
	SqlDbType
≤≤. 7
.
≤≤7 8
Int
≤≤8 ;
,
≤≤; < 
ParameterDirection
≤≤= O
.
≤≤O P
Input
≤≤P U
,
≤≤U V
siteId
≤≤W ]
)
≤≤] ^
;
≤≤^ _
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# ,
,
≥≥, -
	SqlDbType
≥≥. 7
.
≥≥7 8
Int
≥≥8 ;
,
≥≥; < 
ParameterDirection
≥≥= O
.
≥≥O P
Input
≥≥P U
,
≥≥U V
roleId
≥≥W ]
)
≥≥] ^
;
≥≥^ _
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 0
,
¥¥0 1
	SqlDbType
¥¥2 ;
.
¥¥; <
Int
¥¥< ?
,
¥¥? @ 
ParameterDirection
¥¥A S
.
¥¥S T
Input
¥¥T Y
,
¥¥Y Z

pageNumber
¥¥[ e
)
¥¥e f
;
¥¥f g
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
Int
µµ: =
,
µµ= > 
ParameterDirection
µµ? Q
.
µµQ R
Input
µµR W
,
µµW X
pageSize
µµY a
)
µµa b
;
µµb c
return
∂∂ 
sph
∂∂ 
.
∂∂ 
ExecuteReader
∂∂ $
(
∂∂$ %
)
∂∂% &
;
∂∂& '
}
∑∑ 	
public
ππ 
static
ππ 
IDataReader
ππ !!
GetRolesUserIsNotIn
ππ" 5
(
ππ5 6
int
∫∫ 
siteId
∫∫ 
,
∫∫ 
int
ªª 
userId
ªª 
)
ªª 
{
ºº 	 
SqlParameterHelper
ΩΩ 
sph
ΩΩ "
=
ΩΩ# $
new
ΩΩ% ( 
SqlParameterHelper
ΩΩ) ;
(
ΩΩ; <
ConnectionString
ΩΩ< L
.
ΩΩL M%
GetReadConnectionString
ΩΩM d
(
ΩΩd e
)
ΩΩe f
,
ΩΩf g
$strΩΩh â
,ΩΩâ ä
$numΩΩã å
)ΩΩå ç
;ΩΩç é
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# ,
,
ææ, -
	SqlDbType
ææ. 7
.
ææ7 8
Int
ææ8 ;
,
ææ; < 
ParameterDirection
ææ= O
.
ææO P
Input
ææP U
,
ææU V
siteId
ææW ]
)
ææ] ^
;
ææ^ _
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# ,
,
øø, -
	SqlDbType
øø. 7
.
øø7 8
Int
øø8 ;
,
øø; < 
ParameterDirection
øø= O
.
øøO P
Input
øøP U
,
øøU V
userId
øøW ]
)
øø] ^
;
øø^ _
return
¿¿ 
sph
¿¿ 
.
¿¿ 
ExecuteReader
¿¿ $
(
¿¿$ %
)
¿¿% &
;
¿¿& '
}
¡¡ 	
public
√√ 
static
√√ 
bool
√√ 
AddUser
√√ "
(
√√" #
int
ƒƒ 
roleId
ƒƒ 
,
ƒƒ 
int
≈≈ 
userId
≈≈ 
,
≈≈ 
Guid
∆∆ 
roleGuid
∆∆ 
,
∆∆ 
Guid
«« 
userGuid
«« 
)
»» 
{
…… 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M&
GetWriteConnectionString
  M e
(
  e f
)
  f g
,
  g h
$str
  i ~
,
  ~ 
$num  Ä Å
)  Å Ç
;  Ç É
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# ,
,
ÀÀ, -
	SqlDbType
ÀÀ. 7
.
ÀÀ7 8
Int
ÀÀ8 ;
,
ÀÀ; < 
ParameterDirection
ÀÀ= O
.
ÀÀO P
Input
ÀÀP U
,
ÀÀU V
roleId
ÀÀW ]
)
ÀÀ] ^
;
ÀÀ^ _
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# ,
,
ÃÃ, -
	SqlDbType
ÃÃ. 7
.
ÃÃ7 8
Int
ÃÃ8 ;
,
ÃÃ; < 
ParameterDirection
ÃÃ= O
.
ÃÃO P
Input
ÃÃP U
,
ÃÃU V
userId
ÃÃW ]
)
ÃÃ] ^
;
ÃÃ^ _
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
UniqueIdentifier
ÕÕ: J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
roleGuid
ÕÕf n
)
ÕÕn o
;
ÕÕo p
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# .
,
ŒŒ. /
	SqlDbType
ŒŒ0 9
.
ŒŒ9 :
UniqueIdentifier
ŒŒ: J
,
ŒŒJ K 
ParameterDirection
ŒŒL ^
.
ŒŒ^ _
Input
ŒŒ_ d
,
ŒŒd e
userGuid
ŒŒf n
)
ŒŒn o
;
ŒŒo p
int
–– 
rowsAffected
–– 
=
–– 
sph
–– "
.
––" #
ExecuteNonQuery
––# 2
(
––2 3
)
––3 4
;
––4 5
return
—— 
(
—— 
rowsAffected
——  
>
——! "
-
——# $
$num
——$ %
)
——% &
;
——& '
}
““ 	
public
‘‘ 
static
‘‘ 
bool
‘‘ 

RemoveUser
‘‘ %
(
‘‘% &
int
‘‘& )
roleId
‘‘* 0
,
‘‘0 1
int
‘‘2 5
userId
‘‘6 <
)
‘‘< =
{
’’ 	 
SqlParameterHelper
÷÷ 
sph
÷÷ "
=
÷÷# $
new
÷÷% ( 
SqlParameterHelper
÷÷) ;
(
÷÷; <
ConnectionString
÷÷< L
.
÷÷L M&
GetWriteConnectionString
÷÷M e
(
÷÷e f
)
÷÷f g
,
÷÷g h
$str
÷÷i ~
,
÷÷~ 
$num÷÷Ä Å
)÷÷Å Ç
;÷÷Ç É
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ "
(
◊◊" #
$str
◊◊# ,
,
◊◊, -
	SqlDbType
◊◊. 7
.
◊◊7 8
Int
◊◊8 ;
,
◊◊; < 
ParameterDirection
◊◊= O
.
◊◊O P
Input
◊◊P U
,
◊◊U V
roleId
◊◊W ]
)
◊◊] ^
;
◊◊^ _
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# ,
,
ÿÿ, -
	SqlDbType
ÿÿ. 7
.
ÿÿ7 8
Int
ÿÿ8 ;
,
ÿÿ; < 
ParameterDirection
ÿÿ= O
.
ÿÿO P
Input
ÿÿP U
,
ÿÿU V
userId
ÿÿW ]
)
ÿÿ] ^
;
ÿÿ^ _
int
ŸŸ 
rowsAffected
ŸŸ 
=
ŸŸ 
sph
ŸŸ "
.
ŸŸ" #
ExecuteNonQuery
ŸŸ# 2
(
ŸŸ2 3
)
ŸŸ3 4
;
ŸŸ4 5
return
⁄⁄ 
(
⁄⁄ 
rowsAffected
⁄⁄  
>
⁄⁄! "
-
⁄⁄# $
$num
⁄⁄$ %
)
⁄⁄% &
;
⁄⁄& '
}
€€ 	
public
ﬁﬁ 
static
ﬁﬁ 
int
ﬁﬁ !
GetCountOfSiteRoles
ﬁﬁ -
(
ﬁﬁ- .
int
ﬁﬁ. 1
siteId
ﬁﬁ2 8
)
ﬁﬁ8 9
{
ﬂﬂ 	 
SqlParameterHelper
‡‡ 
sph
‡‡ "
=
‡‡# $
new
‡‡% ( 
SqlParameterHelper
‡‡) ;
(
‡‡; <
ConnectionString
‡‡< L
.
‡‡L M%
GetReadConnectionString
‡‡M d
(
‡‡d e
)
‡‡e f
,
‡‡f g
$str
‡‡h ~
,
‡‡~ 
$num‡‡Ä Å
)‡‡Å Ç
;‡‡Ç É
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# ,
,
··, -
	SqlDbType
··. 7
.
··7 8
Int
··8 ;
,
··; < 
ParameterDirection
··= O
.
··O P
Input
··P U
,
··U V
siteId
··W ]
)
··] ^
;
··^ _
return
‰‰ 
Convert
‰‰ 
.
‰‰ 
ToInt32
‰‰ "
(
‰‰" #
sph
‰‰# &
.
‰‰& '
ExecuteScalar
‰‰' 4
(
‰‰4 5
)
‰‰5 6
)
‰‰6 7
;
‰‰7 8
}
ÂÂ 	
}
ËË 
}ÈÈ ûK
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSavedQuery.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSavedQuery $
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
id%% 
,%% 
string&& 
name&& 
,&& 
string'' 
	statement'' 
,'' 
DateTime(( 

createdUtc(( 
,((  
Guid)) 
	createdBy)) 
))) 
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i 
,	++ Ä
$num
++Å Ç
)
++Ç É
;
++É Ñ
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# (
,,,( )
	SqlDbType,,* 3
.,,3 4
UniqueIdentifier,,4 D
,,,D E
ParameterDirection,,F X
.,,X Y
Input,,Y ^
,,,^ _
id,,` b
),,b c
;,,c d
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# *
,--* +
	SqlDbType--, 5
.--5 6
NVarChar--6 >
,--> ?
$num--@ B
,--B C
ParameterDirection--D V
.--V W
Input--W \
,--\ ]
name--^ b
)--b c
;--c d
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# /
,../ 0
	SqlDbType..1 :
...: ;
NVarChar..; C
,..C D
-..E F
$num..F G
,..G H
ParameterDirection..I [
...[ \
Input..\ a
,..a b
	statement..c l
)..l m
;..m n
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# 0
,//0 1
	SqlDbType//2 ;
.//; <
DateTime//< D
,//D E
ParameterDirection//F X
.//X Y
Input//Y ^
,//^ _

createdUtc//` j
)//j k
;//k l
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# /
,00/ 0
	SqlDbType001 :
.00: ;
UniqueIdentifier00; K
,00K L
ParameterDirection00M _
.00_ `
Input00` e
,00e f
	createdBy00g p
)00p q
;00q r
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
DateTime11< D
,11D E
ParameterDirection11F X
.11X Y
Input11Y ^
,11^ _

createdUtc11` j
)11j k
;11k l
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# /
,22/ 0
	SqlDbType221 :
.22: ;
UniqueIdentifier22; K
,22K L
ParameterDirection22M _
.22_ `
Input22` e
,22e f
	createdBy22g p
)22p q
;22q r
int33 
rowsAffected33 
=33 
sph33 "
.33" #
ExecuteNonQuery33# 2
(332 3
)333 4
;334 5
return44 
rowsAffected44 
;44  
}66 	
publicAA 
staticAA 
boolAA 
UpdateAA !
(AA! "
GuidBB 
idBB 
,BB 
stringCC 
	statementCC 
,CC 
DateTimeDD 

lastModUtcDD 
,DD  
GuidEE 
	lastModByEE 
)EE 
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi 
,	GG Ä
$num
GGÅ Ç
)
GGÇ É
;
GGÉ Ñ
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# (
,HH( )
	SqlDbTypeHH* 3
.HH3 4
UniqueIdentifierHH4 D
,HHD E
ParameterDirectionHHF X
.HHX Y
InputHHY ^
,HH^ _
idHH` b
)HHb c
;HHc d
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# /
,II/ 0
	SqlDbTypeII1 :
.II: ;
NVarCharII; C
,IIC D
-IIE F
$numIIF G
,IIG H
ParameterDirectionIII [
.II[ \
InputII\ a
,IIa b
	statementIIc l
)IIl m
;IIm n
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# 0
,JJ0 1
	SqlDbTypeJJ2 ;
.JJ; <
DateTimeJJ< D
,JJD E
ParameterDirectionJJF X
.JJX Y
InputJJY ^
,JJ^ _

lastModUtcJJ` j
)JJj k
;JJk l
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# /
,KK/ 0
	SqlDbTypeKK1 :
.KK: ;
UniqueIdentifierKK; K
,KKK L
ParameterDirectionKKM _
.KK_ `
InputKK` e
,KKe f
	lastModByKKg p
)KKp q
;KKq r
intLL 
rowsAffectedLL 
=LL 
sphLL "
.LL" #
ExecuteNonQueryLL# 2
(LL2 3
)LL3 4
;LL4 5
returnMM 
(MM 
rowsAffectedMM  
>MM! "
$numMM# $
)MM$ %
;MM% &
}OO 	
publicVV 
staticVV 
boolVV 
DeleteVV !
(VV! "
GuidVV" &
idVV' )
)VV) *
{WW 	
SqlParameterHelperXX 
sphXX "
=XX# $
newXX% (
SqlParameterHelperXX) ;
(XX; <
ConnectionStringXX< L
.XXL M$
GetWriteConnectionStringXXM e
(XXe f
)XXf g
,XXg h
$strXXi 
,	XX Ä
$num
XXÅ Ç
)
XXÇ É
;
XXÉ Ñ
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# (
,YY( )
	SqlDbTypeYY* 3
.YY3 4
UniqueIdentifierYY4 D
,YYD E
ParameterDirectionYYF X
.YYX Y
InputYYY ^
,YY^ _
idYY` b
)YYb c
;YYc d
intZZ 
rowsAffectedZZ 
=ZZ 
sphZZ "
.ZZ" #
ExecuteNonQueryZZ# 2
(ZZ2 3
)ZZ3 4
;ZZ4 5
return[[ 
([[ 
rowsAffected[[  
>[[! "
$num[[# $
)[[$ %
;[[% &
}]] 	
publiccc 
staticcc 
IDataReadercc !
GetOnecc" (
(cc( )
Guidcc) -
idcc. 0
)cc0 1
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M#
GetReadConnectionStringeeM d
(eed e
)eee f
,eef g
$str	eeh Å
,
eeÅ Ç
$num
eeÉ Ñ
)
eeÑ Ö
;
eeÖ Ü
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# (
,ff( )
	SqlDbTypeff* 3
.ff3 4
UniqueIdentifierff4 D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _
idff` b
)ffb c
;ffc d
returngg 
sphgg 
.gg 
ExecuteReadergg $
(gg$ %
)gg% &
;gg& '
}ii 	
publicoo 
staticoo 
IDataReaderoo !
GetOneoo" (
(oo( )
stringoo) /
nameoo0 4
)oo4 5
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M#
GetReadConnectionStringqqM d
(qqd e
)qqe f
,qqf g
$str	qqh á
,
qqá à
$num
qqâ ä
)
qqä ã
;
qqã å
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# *
,rr* +
	SqlDbTyperr, 5
.rr5 6
NVarCharrr6 >
,rr> ?
$numrr@ B
,rrB C
ParameterDirectionrrD V
.rrV W
InputrrW \
,rr\ ]
namerr^ b
)rrb c
;rrc d
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}uu 	
public|| 
static|| 
IDataReader|| !
GetAll||" (
(||( )
)||) *
{}} 	
return 
	SqlHelper 
. 
ExecuteReader *
(* +
ConnectionString
ÄÄ  
.
ÄÄ  !%
GetReadConnectionString
ÄÄ! 8
(
ÄÄ8 9
)
ÄÄ9 :
,
ÄÄ: ;
CommandType
ÅÅ 
.
ÅÅ 
StoredProcedure
ÅÅ +
,
ÅÅ+ ,
$str
ÇÇ )
,
ÇÇ) *
null
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÖÖ 	
}
ââ 
}ãã ∆N
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteFolder.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteFolder $
{ 
public 
static 
int 
Add 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
string 

folderName 
) 
{   	
SqlParameterHelper!! 
sph!! "
=!!# $
new!!% (
SqlParameterHelper!!) ;
(!!; <
ConnectionString!!< L
.!!L M$
GetWriteConnectionString!!M e
(!!e f
)!!f g
,!!g h
$str	!!i Ä
,
!!Ä Å
$num
!!Ç É
)
!!É Ñ
;
!!Ñ Ö
sph"" 
."" 
DefineSqlParameter"" "
(""" #
$str""# *
,""* +
	SqlDbType"", 5
.""5 6
UniqueIdentifier""6 F
,""F G
ParameterDirection""H Z
.""Z [
Input""[ `
,""` a
guid""b f
)""f g
;""g h
sph## 
.## 
DefineSqlParameter## "
(##" #
$str### .
,##. /
	SqlDbType##0 9
.##9 :
UniqueIdentifier##: J
,##J K
ParameterDirection##L ^
.##^ _
Input##_ d
,##d e
siteGuid##f n
)##n o
;##o p
sph$$ 
.$$ 
DefineSqlParameter$$ "
($$" #
$str$$# 0
,$$0 1
	SqlDbType$$2 ;
.$$; <
NVarChar$$< D
,$$D E
$num$$F I
,$$I J
ParameterDirection$$K ]
.$$] ^
Input$$^ c
,$$c d

folderName$$e o
)$$o p
;$$p q
int%% 
rowsAffected%% 
=%% 
Convert%% &
.%%& '
ToInt32%%' .
(%%. /
sph%%/ 2
.%%2 3
ExecuteNonQuery%%3 B
(%%B C
)%%C D
)%%D E
;%%E F
return&& 
rowsAffected&& 
;&&  
}'' 	
public)) 
static)) 
bool)) 
Update)) !
())! "
Guid** 
guid** 
,** 
Guid++ 
siteGuid++ 
,++ 
string,, 

folderName,, 
),, 
{-- 	
SqlParameterHelper.. 
sph.. "
=..# $
new..% (
SqlParameterHelper..) ;
(..; <
ConnectionString..< L
...L M$
GetWriteConnectionString..M e
(..e f
)..f g
,..g h
$str	..i Ä
,
..Ä Å
$num
..Ç É
)
..É Ñ
;
..Ñ Ö
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
UniqueIdentifier//6 F
,//F G
ParameterDirection//H Z
.//Z [
Input//[ `
,//` a
guid//b f
)//f g
;//g h
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# .
,00. /
	SqlDbType000 9
.009 :
UniqueIdentifier00: J
,00J K
ParameterDirection00L ^
.00^ _
Input00_ d
,00d e
siteGuid00f n
)00n o
;00o p
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
NVarChar11< D
,11D E
$num11F I
,11I J
ParameterDirection11K ]
.11] ^
Input11^ c
,11c d

folderName11e o
)11o p
;11p q
int22 
rowsAffected22 
=22 
sph22 "
.22" #
ExecuteNonQuery22# 2
(222 3
)223 4
;224 5
return33 
(33 
rowsAffected33  
>33! "
-33# $
$num33$ %
)33% &
;33& '
}44 	
public66 
static66 
bool66 
Delete66 !
(66! "
Guid66" &
guid66' +
)66+ ,
{77 	
SqlParameterHelper88 
sph88 "
=88# $
new88% (
SqlParameterHelper88) ;
(88; <
ConnectionString88< L
.88L M$
GetWriteConnectionString88M e
(88e f
)88f g
,88g h
$str	88i Ä
,
88Ä Å
$num
88Ç É
)
88É Ñ
;
88Ñ Ö
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# *
,99* +
	SqlDbType99, 5
.995 6
UniqueIdentifier996 F
,99F G
ParameterDirection99H Z
.99Z [
Input99[ `
,99` a
guid99b f
)99f g
;99g h
int:: 
rowsAffected:: 
=:: 
sph:: "
.::" #
ExecuteNonQuery::# 2
(::2 3
)::3 4
;::4 5
return;; 
(;; 
rowsAffected;;  
>;;! "
-;;# $
$num;;$ %
);;% &
;;;& '
}<< 	
public>> 
static>> 
bool>> 
Exists>> !
(>>! "
string>>" (

folderName>>) 3
)>>3 4
{?? 	
SqlParameterHelper@@ 
sph@@ "
=@@# $
new@@% (
SqlParameterHelper@@) ;
(@@; <
ConnectionString@@< L
.@@L M#
GetReadConnectionString@@M d
(@@d e
)@@e f
,@@f g
$str@@h ~
,@@~ 
$num
@@Ä Å
)
@@Å Ç
;
@@Ç É
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 0
,AA0 1
	SqlDbTypeAA2 ;
.AA; <
NVarCharAA< D
,AAD E
$numAAF I
,AAI J
ParameterDirectionAAK ]
.AA] ^
InputAA^ c
,AAc d

folderNameAAe o
)AAo p
;AAp q
intBB 
countBB 
=BB 
ConvertBB 
.BB  
ToInt32BB  '
(BB' (
sphBB( +
.BB+ ,
ExecuteScalarBB, 9
(BB9 :
)BB: ;
)BB; <
;BB< =
returnCC 
(CC 
countCC 
>CC 
$numCC 
)CC 
;CC 
}DD 	
publicFF 
staticFF 
IDataReaderFF !
GetOneFF" (
(FF( )
GuidFF) -
guidFF. 2
)FF2 3
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M#
GetReadConnectionStringHHM d
(HHd e
)HHe f
,HHf g
$str	HHh Ç
,
HHÇ É
$num
HHÑ Ö
)
HHÖ Ü
;
HHÜ á
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
returnJJ 
sphJJ 
.JJ 
ExecuteReaderJJ $
(JJ$ %
)JJ% &
;JJ& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !
	GetBySiteMM" +
(MM+ ,
GuidMM, 0
siteGuidMM1 9
)MM9 :
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh Ö
,
OOÖ Ü
$num
OOá à
)
OOà â
;
OOâ ä
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
returnQQ 
sphQQ 
.QQ 
ExecuteReaderQQ $
(QQ$ %
)QQ% &
;QQ& '
}RR 	
publicTT 
staticTT 
GuidTT 
GetSiteGuidTT &
(TT& '
stringTT' -

folderNameTT. 8
)TT8 9
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M#
GetReadConnectionStringVVM d
(VVd e
)VVe f
,VVf g
$str	VVh è
,
VVè ê
$num
VVë í
)
VVí ì
;
VVì î
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 0
,WW0 1
	SqlDbTypeWW2 ;
.WW; <
NVarCharWW< D
,WWD E
$numWWF I
,WWI J
ParameterDirectionWWK ]
.WW] ^
InputWW^ c
,WWc d

folderNameWWe o
)WWo p
;WWp q
stringXX 
strGuidXX 
=XX 
sphXX  
.XX  !
ExecuteScalarXX! .
(XX. /
)XX/ 0
.XX0 1
ToStringXX1 9
(XX9 :
)XX: ;
;XX; <
ifYY 
(YY 
strGuidYY 
.YY 
LengthYY 
==YY !
$numYY" $
)YY$ %
{ZZ 
return[[ 
new[[ 
Guid[[ 
([[  
strGuid[[  '
)[[' (
;[[( )
}\\ 
return]] 
Guid]] 
.]] 
Empty]] 
;]] 
}^^ 	
}cc 
}dd òx
uD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSitePersonalization.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class !
DBSitePersonalization -
{ 
public 
static 
void #
SavePersonalizationBlob 2
(2 3
int 
siteId 
, 
String 
path 
, 
Guid 
userGuid 
, 
byte 
[ 
] 
dataBlob 
, 
DateTime 
lastUpdateTime #
)# $
{   	
SqlParameterHelper!! 
sph!! "
=!!# $
new!!% (
SqlParameterHelper!!) ;
(!!; <
ConnectionString!!< L
.!!L M$
GetWriteConnectionString!!M e
(!!e f
)!!f g
,!!g h
$str	!!i ò
,
!!ò ô
$num
!!ö õ
)
!!õ ú
;
!!ú ù
sph"" 
."" 
DefineSqlParameter"" "
(""" #
$str""# ,
,"", -
	SqlDbType"". 7
.""7 8
Int""8 ;
,""; <
ParameterDirection""= O
.""O P
Input""P U
,""U V
siteId""W ]
)""] ^
;""^ _
sph## 
.## 
DefineSqlParameter## "
(##" #
$str### *
,##* +
	SqlDbType##, 5
.##5 6
NVarChar##6 >
,##> ?
$num##@ C
,##C D
ParameterDirection##E W
.##W X
Input##X ]
,##] ^
path##_ c
)##c d
;##d e
sph$$ 
.$$ 
DefineSqlParameter$$ "
($$" #
$str$$# ,
,$$, -
	SqlDbType$$. 7
.$$7 8
UniqueIdentifier$$8 H
,$$H I
ParameterDirection$$J \
.$$\ ]
Input$$] b
,$$b c
userGuid$$d l
)$$l m
;$$m n
sph%% 
.%% 
DefineSqlParameter%% "
(%%" #
$str%%# 2
,%%2 3
	SqlDbType%%4 =
.%%= >
	VarBinary%%> G
,%%G H
-%%I J
$num%%J K
,%%K L
ParameterDirection%%M _
.%%_ `
Input%%` e
,%%e f
dataBlob%%g o
)%%o p
;%%p q
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# 0
,&&0 1
	SqlDbType&&2 ;
.&&; <
DateTime&&< D
,&&D E
ParameterDirection&&F X
.&&X Y
Input&&Y ^
,&&^ _
lastUpdateTime&&` n
)&&n o
;&&o p
sph'' 
.'' 
ExecuteNonQuery'' 
(''  
)''  !
;''! "
}(( 	
public** 
static** 
byte** 
[** 
]** "
GetPersonalizationBlob** 3
(**3 4
int++ 
siteId++ 
,++ 
String,, 
path,, 
,,, 
Guid-- 
userGuid-- 
)-- 
{.. 	
SqlParameterHelper// 
sph// "
=//# $
new//% (
SqlParameterHelper//) ;
(//; <
ConnectionString//< L
.//L M#
GetReadConnectionString//M d
(//d e
)//e f
,//f g
$str	//h ó
,
//ó ò
$num
//ô ö
)
//ö õ
;
//õ ú
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# ,
,00, -
	SqlDbType00. 7
.007 8
Int008 ;
,00; <
ParameterDirection00= O
.00O P
Input00P U
,00U V
siteId00W ]
)00] ^
;00^ _
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
NVarChar116 >
,11> ?
$num11@ C
,11C D
ParameterDirection11E W
.11W X
Input11X ]
,11] ^
path11_ c
)11c d
;11d e
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# ,
,22, -
	SqlDbType22. 7
.227 8
UniqueIdentifier228 H
,22H I
ParameterDirection22J \
.22\ ]
Input22] b
,22b c
userGuid22d l
)22l m
;22m n
byte33 
[33 
]33 
result33 
=33 
(33 
byte33 !
[33! "
]33" #
)33# $
sph33$ '
.33' (
ExecuteScalar33( 5
(335 6
)336 7
;337 8
return44 
result44 
;44 
}55 	
public77 
static77 
void77 $
ResetPersonalizationBlob77 3
(773 4
int88 
siteId88 
,88 
String99 
path99 
,99 
Guid:: 
userGuid:: 
):: 
{;; 	
SqlParameterHelper<< 
sph<< "
=<<# $
new<<% (
SqlParameterHelper<<) ;
(<<; <
ConnectionString<<< L
.<<L M$
GetWriteConnectionString<<M e
(<<e f
)<<f g
,<<g h
$str	<<i ö
,
<<ö õ
$num
<<ú ù
)
<<ù û
;
<<û ü
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# ,
,==, -
	SqlDbType==. 7
.==7 8
Int==8 ;
,==; <
ParameterDirection=== O
.==O P
Input==P U
,==U V
siteId==W ]
)==] ^
;==^ _
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># *
,>>* +
	SqlDbType>>, 5
.>>5 6
NVarChar>>6 >
,>>> ?
$num>>@ C
,>>C D
ParameterDirection>>E W
.>>W X
Input>>X ]
,>>] ^
path>>_ c
)>>c d
;>>d e
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# ,
,??, -
	SqlDbType??. 7
.??7 8
UniqueIdentifier??8 H
,??H I
ParameterDirection??J \
.??\ ]
Input??] b
,??b c
userGuid??d l
)??l m
;??m n
sph@@ 
.@@ 
ExecuteNonQuery@@ 
(@@  
)@@  !
;@@! "
}AA 	
publicCC 
staticCC 
voidCC $
ResetPersonalizationBlobCC 3
(CC3 4
intDD 
siteIdDD 
,DD 
StringEE 
pathEE 
)EE 
{FF 	
StringBuilderHH 

sqlCommandHH $
=HH% &
newHH' *
StringBuilderHH+ 8
(HH8 9
)HH9 :
;HH: ;

sqlCommandII 
.II 
AppendII 
(II 
$strII (
)II( )
;II) *

sqlCommandJJ 
.JJ 
AppendJJ 
(JJ 
$strJJ E
)JJE F
;JJF G

sqlCommandKK 
.KK 
AppendKK 
(KK 
$strKK 4
)KK4 5
;KK5 6

sqlCommandLL 
.LL 
AppendLL 
(LL 
$strLL 1
)LL1 2
;LL2 3

sqlCommandMM 
.MM 
AppendMM 
(MM 
$strMM 5
)MM5 6
;MM6 7

sqlCommandNN 
.NN 
AppendNN 
(NN 
$strNN 8
)NN8 9
;NN9 :

sqlCommandOO 
.OO 
AppendOO 
(OO 
$strOO $
)OO$ %
;OO% &
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h

sqlCommandQQi s
.QQs t
ToStringQQt |
(QQ| }
)QQ} ~
,QQ~ 
CommandType
QQÄ ã
.
QQã å
Text
QQå ê
,
QQê ë
$num
QQí ì
)
QQì î
;
QQî ï
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# ,
,RR, -
	SqlDbTypeRR. 7
.RR7 8
IntRR8 ;
,RR; <
ParameterDirectionRR= O
.RRO P
InputRRP U
,RRU V
siteIdRRW ]
)RR] ^
;RR^ _
sphTT 
.TT 
ExecuteNonQueryTT 
(TT  
)TT  !
;TT! "
}UU 	
publicWW 
staticWW 
byteWW 
[WW 
]WW *
GetPersonalizationBlobAllUsersWW ;
(WW; <
intXX 
siteIdXX 
,XX 
StringYY 
pathYY 
)YY 
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M#
GetReadConnectionString[[M d
([[d e
)[[e f
,[[f g
$str	[[h ò
,
[[ò ô
$num
[[ö õ
)
[[õ ú
;
[[ú ù
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# ,
,\\, -
	SqlDbType\\. 7
.\\7 8
Int\\8 ;
,\\; <
ParameterDirection\\= O
.\\O P
Input\\P U
,\\U V
siteId\\W ]
)\\] ^
;\\^ _
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
NVarChar]]6 >
,]]> ?
$num]]@ C
,]]C D
ParameterDirection]]E W
.]]W X
Input]]X ]
,]]] ^
path]]_ c
)]]c d
;]]d e
byte__ 
[__ 
]__ 
result__ 
=__ 
(__ 
byte__ !
[__! "
]__" #
)__# $
sph__$ '
.__' (
ExecuteScalar__( 5
(__5 6
)__6 7
;__7 8
return`` 
result`` 
;`` 
}aa 	
publiccc 
staticcc 
voidcc +
SavePersonalizationBlobAllUserscc :
(cc: ;
intdd 
siteIddd 
,dd 
Stringee 
pathee 
,ee 
byteff 
[ff 
]ff 
dataBlobff 
,ff 
DateTimegg 
lastUpdateTimegg #
)gg# $
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M$
GetWriteConnectionStringiiM e
(iie f
)iif g
,iig h
$str	iii ô
,
iiô ö
$num
iiõ ú
)
iiú ù
;
iiù û
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# ,
,jj, -
	SqlDbTypejj. 7
.jj7 8
Intjj8 ;
,jj; <
ParameterDirectionjj= O
.jjO P
InputjjP U
,jjU V
siteIdjjW ]
)jj] ^
;jj^ _
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# *
,kk* +
	SqlDbTypekk, 5
.kk5 6
NVarCharkk6 >
,kk> ?
$numkk@ C
,kkC D
ParameterDirectionkkE W
.kkW X
InputkkX ]
,kk] ^
pathkk_ c
)kkc d
;kkd e
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 2
,ll2 3
	SqlDbTypell4 =
.ll= >
	VarBinaryll> G
,llG H
-llI J
$numllJ K
,llK L
ParameterDirectionllM _
.ll_ `
Inputll` e
,lle f
dataBlobllg o
)llo p
;llp q
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 0
,mm0 1
	SqlDbTypemm2 ;
.mm; <
DateTimemm< D
,mmD E
ParameterDirectionmmF X
.mmX Y
InputmmY ^
,mm^ _
lastUpdateTimemm` n
)mmn o
;mmo p
sphnn 
.nn 
ExecuteNonQuerynn 
(nn  
)nn  !
;nn! "
}qq 	
publicss 
staticss 
intss 
GetCountOfStatess )
(ss) *
inttt 
siteIdtt 
,tt 
Stringuu 
pathuu 
,uu 
boolvv 
allUserScopevv 
,vv 
Guidww 
userGuidww 
,ww 
DateTimexx 
inactiveSincexx "
)xx" #
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh û
,
zzû ü
$num
zz† °
)
zz° ¢
;
zz¢ £
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# ,
,{{, -
	SqlDbType{{. 7
.{{7 8
Int{{8 ;
,{{; <
ParameterDirection{{= O
.{{O P
Input{{P U
,{{U V
siteId{{W ]
){{] ^
;{{^ _
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# *
,||* +
	SqlDbType||, 5
.||5 6
NVarChar||6 >
,||> ?
$num||@ C
,||C D
ParameterDirection||E W
.||W X
Input||X ]
,||] ^
path||_ c
)||c d
;||d e
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
Bit}}? B
,}}B C
ParameterDirection}}D V
.}}V W
Input}}W \
,}}\ ]
allUserScope}}^ j
)}}j k
;}}k l
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# ,
,~~, -
	SqlDbType~~. 7
.~~7 8
UniqueIdentifier~~8 H
,~~H I
ParameterDirection~~J \
.~~\ ]
Input~~] b
,~~b c
userGuid~~d l
)~~l m
;~~m n
sph 
. 
DefineSqlParameter "
(" #
$str# 7
,7 8
	SqlDbType9 B
.B C
DateTimeC K
,K L
ParameterDirectionM _
._ `
Input` e
,e f
inactiveSinceg t
)t u
;u v
int
ÄÄ 
result
ÄÄ 
=
ÄÄ 
Convert
ÄÄ  
.
ÄÄ  !
ToInt32
ÄÄ! (
(
ÄÄ( )
sph
ÄÄ) ,
.
ÄÄ, -
ExecuteScalar
ÄÄ- :
(
ÄÄ: ;
)
ÄÄ; <
)
ÄÄ< =
;
ÄÄ= >
return
ÅÅ 
result
ÅÅ 
;
ÅÅ 
}
ÇÇ 	
}
«« 
}»» ‚ñ
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteSettings &
{ 
public 
static 
int 
Create  
(  !
Guid 
siteGuid 
, 
String 
siteName 
, 
String   
skin   
,   
String!! 
logo!! 
,!! 
String"" 
icon"" 
,"" 
bool##  
allowNewRegistration## %
,##% &
bool$$ 
allowUserSkins$$ 
,$$  
bool%% 
allowPageSkins%% 
,%%  
bool&&  
allowHideMenuOnPages&& %
,&&% &
bool'' !
useSecureRegistration'' &
,''& '
bool(( 
useSslOnAllPages(( !
,((! "
String)) 
defaultPageKeywords)) &
,))& '
String** "
defaultPageDescription** )
,**) *
String++ 
defaultPageEncoding++ &
,++& '
String,, %
defaultAdditionalMetaTags,, ,
,,,, -
bool-- 
isServerAdminSite-- "
,--" #
bool.. 
useLdapAuth.. 
,.. 
bool// *
autoCreateLdapUserOnFirstLogin// /
,/// 0
String00 

ldapServer00 
,00 
int11 
ldapPort11 
,11 
String22 

ldapDomain22 
,22 
String33 

ldapRootDN33 
,33 
String44 
ldapUserDNKey44  
,44  !
bool55 #
allowUserFullNameChange55 (
,55( )
bool66 
useEmailForLogin66 !
,66! "
bool77 
reallyDeleteUsers77 "
,77" #
String88 

editorSkin88 
,88 
String99 %
defaultFriendlyUrlPattern99 ,
,99, -
bool:: 
enableMyPageFeature:: $
,::$ %
string;; 
editorProvider;; !
,;;! "
string<< 
datePickerProvider<< %
,<<% &
string== 
captchaProvider== "
,==" #
string>> 
recaptchaPrivateKey>> &
,>>& '
string?? 
recaptchaPublicKey?? %
,??% &
string@@ 
wordpressApiKey@@ "
,@@" #
stringAA 
windowsLiveAppIdAA #
,AA# $
stringBB 
windowsLiveKeyBB !
,BB! "
boolCC 
allowOpenIdAuthCC  
,CC  !
boolDD  
allowWindowsLiveAuthDD %
,DD% &
stringEE 

gmapApiKeyEE 
,EE 
stringFF 
apiKeyExtra1FF 
,FF  
stringGG 
apiKeyExtra2GG 
,GG  
stringHH 
apiKeyExtra3HH 
,HH  
stringII 
apiKeyExtra4II 
,II  
stringJJ 
apiKeyExtra5JJ 
,JJ  
boolKK 
disableDbAuthKK 
)KK 
{LL 	
SqlParameterHelperNN 
sphNN "
=NN# $
newNN% (
SqlParameterHelperNN) ;
(NN; <
ConnectionStringNN< L
.NNL M$
GetWriteConnectionStringNNM e
(NNe f
)NNf g
,NNg h
$strNNi z
,NNz {
$numNN| ~
)NN~ 
;	NN Ä
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
NVarCharOO: B
,OOB C
$numOOD G
,OOG H
ParameterDirectionOOI [
.OO[ \
InputOO\ a
,OOa b
siteNameOOc k
)OOk l
;OOl m
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
skinPP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
NVarCharQQ6 >
,QQ> ?
$numQQ@ B
,QQB C
ParameterDirectionQQD V
.QQV W
InputQQW \
,QQ\ ]
logoQQ^ b
)QQb c
;QQc d
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# *
,RR* +
	SqlDbTypeRR, 5
.RR5 6
NVarCharRR6 >
,RR> ?
$numRR@ B
,RRB C
ParameterDirectionRRD V
.RRV W
InputRRW \
,RR\ ]
iconRR^ b
)RRb c
;RRc d
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 4
,SS4 5
	SqlDbTypeSS6 ?
.SS? @
BitSS@ C
,SSC D
ParameterDirectionSSE W
.SSW X
InputSSX ]
,SS] ^
allowUserSkinsSS_ m
)SSm n
;SSn o
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# :
,TT: ;
	SqlDbTypeTT< E
.TTE F
BitTTF I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d 
allowNewRegistrationTTe y
)TTy z
;TTz {
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# ;
,UU; <
	SqlDbTypeUU= F
.UUF G
BitUUG J
,UUJ K
ParameterDirectionUUL ^
.UU^ _
InputUU_ d
,UUd e!
useSecureRegistrationUUf {
)UU{ |
;UU| }
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 6
,VV6 7
	SqlDbTypeVV8 A
.VVA B
BitVVB E
,VVE F
ParameterDirectionVVG Y
.VVY Z
InputVVZ _
,VV_ `
useSslOnAllPagesVVa q
)VVq r
;VVr s
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 9
,WW9 :
	SqlDbTypeWW; D
.WWD E
NVarCharWWE M
,WWM N
$numWWO R
,WWR S
ParameterDirectionWWT f
.WWf g
InputWWg l
,WWl m 
defaultPageKeywords	WWn Å
)
WWÅ Ç
;
WWÇ É
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# <
,XX< =
	SqlDbTypeXX> G
.XXG H
NVarCharXXH P
,XXP Q
$numXXR U
,XXU V
ParameterDirectionXXW i
.XXi j
InputXXj o
,XXo p#
defaultPageDescription	XXq á
)
XXá à
;
XXà â
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 9
,YY9 :
	SqlDbTypeYY; D
.YYD E
NVarCharYYE M
,YYM N
$numYYO R
,YYR S
ParameterDirectionYYT f
.YYf g
InputYYg l
,YYl m 
defaultPageEncoding	YYn Å
)
YYÅ Ç
;
YYÇ É
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# ?
,ZZ? @
	SqlDbTypeZZA J
.ZZJ K
NVarCharZZK S
,ZZS T
$numZZU X
,ZZX Y
ParameterDirectionZZZ l
.ZZl m
InputZZm r
,ZZr s&
defaultAdditionalMetaTags	ZZt ç
)
ZZç é
;
ZZé è
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 7
,[[7 8
	SqlDbType[[9 B
.[[B C
Bit[[C F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
isServerAdminSite[[b s
)[[s t
;[[t u
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 4
,\\4 5
	SqlDbType\\6 ?
.\\? @
Bit\\@ C
,\\C D
ParameterDirection\\E W
.\\W X
Input\\X ]
,\\] ^
allowPageSkins\\_ m
)\\m n
;\\n o
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# :
,]]: ;
	SqlDbType]]< E
.]]E F
Bit]]F I
,]]I J
ParameterDirection]]K ]
.]]] ^
Input]]^ c
,]]c d 
allowHideMenuOnPages]]e y
)]]y z
;]]z {
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 1
,^^1 2
	SqlDbType^^3 <
.^^< =
Bit^^= @
,^^@ A
ParameterDirection^^B T
.^^T U
Input^^U Z
,^^Z [
useLdapAuth^^\ g
)^^g h
;^^h i
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# D
,__D E
	SqlDbType__F O
.__O P
Bit__P S
,__S T
ParameterDirection__U g
.__g h
Input__h m
,__m n+
autoCreateLdapUserOnFirstLogin	__o ç
)
__ç é
;
__é è
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
NVarChar``< D
,``D E
$num``F I
,``I J
ParameterDirection``K ]
.``] ^
Input``^ c
,``c d

ldapServer``e o
)``o p
;``p q
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# .
,aa. /
	SqlDbTypeaa0 9
.aa9 :
Intaa: =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
ldapPortaaY a
)aaa b
;aab c
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
$numbbF I
,bbI J
ParameterDirectionbbK ]
.bb] ^
Inputbb^ c
,bbc d

ldapDomainbbe o
)bbo p
;bbp q
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 0
,cc0 1
	SqlDbTypecc2 ;
.cc; <
NVarCharcc< D
,ccD E
$numccF I
,ccI J
ParameterDirectionccK ]
.cc] ^
Inputcc^ c
,ccc d

ldapRootDNcce o
)cco p
;ccp q
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 3
,dd3 4
	SqlDbTypedd5 >
.dd> ?
NVarChardd? G
,ddG H
$numddI K
,ddK L
ParameterDirectionddM _
.dd_ `
Inputdd` e
,dde f
ldapUserDNKeyddg t
)ddt u
;ddu v
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# =
,ee= >
	SqlDbTypeee? H
.eeH I
BiteeI L
,eeL M
ParameterDirectioneeN `
.ee` a
Inputeea f
,eef g#
allowUserFullNameChangeeeh 
)	ee Ä
;
eeÄ Å
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 6
,ff6 7
	SqlDbTypeff8 A
.ffA B
BitffB E
,ffE F
ParameterDirectionffG Y
.ffY Z
InputffZ _
,ff_ `
useEmailForLoginffa q
)ffq r
;ffr s
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 7
,gg7 8
	SqlDbTypegg9 B
.ggB C
BitggC F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
reallyDeleteUsersggb s
)ggs t
;ggt u
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 0
,hh0 1
	SqlDbTypehh2 ;
.hh; <
NVarCharhh< D
,hhD E
$numhhF H
,hhH I
ParameterDirectionhhJ \
.hh\ ]
Inputhh] b
,hhb c

editorSkinhhd n
)hhn o
;hho p
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# C
,iiC D
	SqlDbTypeiiE N
.iiN O
NVarChariiO W
,iiW X
$numiiY [
,ii[ \
ParameterDirectionii] o
.iio p
Inputiip u
,iiu v&
defaultFriendlyUrlPattern	iiw ê
)
iiê ë
;
iië í
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
siteGuidjjf n
)jjn o
;jjo p
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 9
,kk9 :
	SqlDbTypekk; D
.kkD E
BitkkE H
,kkH I
ParameterDirectionkkJ \
.kk\ ]
Inputkk] b
,kkb c
enableMyPageFeaturekkd w
)kkw x
;kkx y
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 4
,ll4 5
	SqlDbTypell6 ?
.ll? @
NVarCharll@ H
,llH I
$numllJ M
,llM N
ParameterDirectionllO a
.lla b
Inputllb g
,llg h
editorProviderlli w
)llw x
;llx y
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 8
,mm8 9
	SqlDbTypemm: C
.mmC D
NVarCharmmD L
,mmL M
$nummmN Q
,mmQ R
ParameterDirectionmmS e
.mme f
Inputmmf k
,mmk l
datePickerProvidermmm 
)	mm Ä
;
mmÄ Å
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 5
,nn5 6
	SqlDbTypenn7 @
.nn@ A
NVarCharnnA I
,nnI J
$numnnK N
,nnN O
ParameterDirectionnnP b
.nnb c
Inputnnc h
,nnh i
captchaProvidernnj y
)nny z
;nnz {
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 9
,oo9 :
	SqlDbTypeoo; D
.ooD E
NVarCharooE M
,ooM N
$numooO R
,ooR S
ParameterDirectionooT f
.oof g
Inputoog l
,ool m 
recaptchaPrivateKey	oon Å
)
ooÅ Ç
;
ooÇ É
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 8
,pp8 9
	SqlDbTypepp: C
.ppC D
NVarCharppD L
,ppL M
$numppN Q
,ppQ R
ParameterDirectionppS e
.ppe f
Inputppf k
,ppk l
recaptchaPublicKeyppm 
)	pp Ä
;
ppÄ Å
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 5
,qq5 6
	SqlDbTypeqq7 @
.qq@ A
NVarCharqqA I
,qqI J
$numqqK N
,qqN O
ParameterDirectionqqP b
.qqb c
Inputqqc h
,qqh i
wordpressApiKeyqqj y
)qqy z
;qqz {
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 6
,rr6 7
	SqlDbTyperr8 A
.rrA B
NVarCharrrB J
,rrJ K
$numrrL O
,rrO P
ParameterDirectionrrQ c
.rrc d
Inputrrd i
,rri j
windowsLiveAppIdrrk {
)rr{ |
;rr| }
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 4
,ss4 5
	SqlDbTypess6 ?
.ss? @
NVarCharss@ H
,ssH I
$numssJ M
,ssM N
ParameterDirectionssO a
.ssa b
Inputssb g
,ssg h
windowsLiveKeyssi w
)ssw x
;ssx y
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 5
,tt5 6
	SqlDbTypett7 @
.tt@ A
BitttA D
,ttD E
ParameterDirectionttF X
.ttX Y
InputttY ^
,tt^ _
allowOpenIdAuthtt` o
)tto p
;ttp q
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# :
,uu: ;
	SqlDbTypeuu< E
.uuE F
BituuF I
,uuI J
ParameterDirectionuuK ]
.uu] ^
Inputuu^ c
,uuc d 
allowWindowsLiveAuthuue y
)uuy z
;uuz {
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
NVarCharww< D
,wwD E
$numwwF I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d

gmapApiKeywwe o
)wwo p
;wwp q
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 2
,xx2 3
	SqlDbTypexx4 =
.xx= >
NVarCharxx> F
,xxF G
$numxxH K
,xxK L
ParameterDirectionxxM _
.xx_ `
Inputxx` e
,xxe f
apiKeyExtra1xxg s
)xxs t
;xxt u
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 2
,yy2 3
	SqlDbTypeyy4 =
.yy= >
NVarCharyy> F
,yyF G
$numyyH K
,yyK L
ParameterDirectionyyM _
.yy_ `
Inputyy` e
,yye f
apiKeyExtra2yyg s
)yys t
;yyt u
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 2
,zz2 3
	SqlDbTypezz4 =
.zz= >
NVarCharzz> F
,zzF G
$numzzH K
,zzK L
ParameterDirectionzzM _
.zz_ `
Inputzz` e
,zze f
apiKeyExtra3zzg s
)zzs t
;zzt u
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 2
,{{2 3
	SqlDbType{{4 =
.{{= >
NVarChar{{> F
,{{F G
$num{{H K
,{{K L
ParameterDirection{{M _
.{{_ `
Input{{` e
,{{e f
apiKeyExtra4{{g s
){{s t
;{{t u
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 2
,||2 3
	SqlDbType||4 =
.||= >
NVarChar||> F
,||F G
$num||H K
,||K L
ParameterDirection||M _
.||_ `
Input||` e
,||e f
apiKeyExtra5||g s
)||s t
;||t u
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
Bit}}? B
,}}B C
ParameterDirection}}D V
.}}V W
Input}}W \
,}}\ ]
disableDbAuth}}^ k
)}}k l
;}}l m
int 
newID 
= 
Convert 
.  
ToInt32  '
(' (
sph( +
.+ ,
ExecuteScalar, 9
(9 :
): ;
); <
;< =
return
ÄÄ 
newID
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
static
ÉÉ 
bool
ÉÉ 
Update
ÉÉ !
(
ÉÉ! "
int
ÑÑ 
siteId
ÑÑ 
,
ÑÑ 
string
ÖÖ 
siteName
ÖÖ 
,
ÖÖ 
string
ÜÜ 
skin
ÜÜ 
,
ÜÜ 
string
áá 
logo
áá 
,
áá 
string
àà 
icon
àà 
,
àà 
bool
ââ "
allowNewRegistration
ââ %
,
ââ% &
bool
ää 
allowUserSkins
ää 
,
ää  
bool
ãã 
allowPageSkins
ãã 
,
ãã  
bool
åå "
allowHideMenuOnPages
åå %
,
åå% &
bool
çç #
useSecureRegistration
çç &
,
çç& '
bool
éé 
useSslOnAllPages
éé !
,
éé! "
string
èè !
defaultPageKeywords
èè &
,
èè& '
string
êê $
defaultPageDescription
êê )
,
êê) *
string
ëë !
defaultPageEncoding
ëë &
,
ëë& '
string
íí '
defaultAdditionalMetaTags
íí ,
,
íí, -
bool
ìì 
isServerAdminSite
ìì "
,
ìì" #
bool
îî 
useLdapAuth
îî 
,
îî 
bool
ïï ,
autoCreateLdapUserOnFirstLogin
ïï /
,
ïï/ 0
string
ññ 

ldapServer
ññ 
,
ññ 
int
óó 
ldapPort
óó 
,
óó 
String
òò 

ldapDomain
òò 
,
òò 
string
ôô 

ldapRootDN
ôô 
,
ôô 
string
öö 
ldapUserDNKey
öö  
,
öö  !
bool
õõ %
allowUserFullNameChange
õõ (
,
õõ( )
bool
úú 
useEmailForLogin
úú !
,
úú! "
bool
ùù 
reallyDeleteUsers
ùù "
,
ùù" #
String
ûû 

editorSkin
ûû 
,
ûû 
String
üü '
defaultFriendlyUrlPattern
üü ,
,
üü, -
bool
†† !
enableMyPageFeature
†† $
,
††$ %
string
°° 
editorProvider
°° !
,
°°! "
string
¢¢  
datePickerProvider
¢¢ %
,
¢¢% &
string
££ 
captchaProvider
££ "
,
££" #
string
§§ !
recaptchaPrivateKey
§§ &
,
§§& '
string
••  
recaptchaPublicKey
•• %
,
••% &
string
¶¶ 
wordpressApiKey
¶¶ "
,
¶¶" #
string
ßß 
windowsLiveAppId
ßß #
,
ßß# $
string
®® 
windowsLiveKey
®® !
,
®®! "
bool
©© 
allowOpenIdAuth
©©  
,
©©  !
bool
™™ "
allowWindowsLiveAuth
™™ %
,
™™% &
string
´´ 

gmapApiKey
´´ 
,
´´ 
string
¨¨ 
apiKeyExtra1
¨¨ 
,
¨¨  
string
≠≠ 
apiKeyExtra2
≠≠ 
,
≠≠  
string
ÆÆ 
apiKeyExtra3
ÆÆ 
,
ÆÆ  
string
ØØ 
apiKeyExtra4
ØØ 
,
ØØ  
string
∞∞ 
apiKeyExtra5
∞∞ 
,
∞∞  
bool
±± 
disableDbAuth
±± 
)
±± 
{
≤≤ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M&
GetWriteConnectionString
¥¥M e
(
¥¥e f
)
¥¥f g
,
¥¥g h
$str
¥¥i z
,
¥¥z {
$num
¥¥| ~
)
¥¥~ 
;¥¥ Ä
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# ,
,
µµ, -
	SqlDbType
µµ. 7
.
µµ7 8
Int
µµ8 ;
,
µµ; < 
ParameterDirection
µµ= O
.
µµO P
Input
µµP U
,
µµU V
siteId
µµW ]
)
µµ] ^
;
µµ^ _
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# .
,
∂∂. /
	SqlDbType
∂∂0 9
.
∂∂9 :
NVarChar
∂∂: B
,
∂∂B C
$num
∂∂D G
,
∂∂G H 
ParameterDirection
∂∂I [
.
∂∂[ \
Input
∂∂\ a
,
∂∂a b
siteName
∂∂c k
)
∂∂k l
;
∂∂l m
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# *
,
∑∑* +
	SqlDbType
∑∑, 5
.
∑∑5 6
NVarChar
∑∑6 >
,
∑∑> ?
$num
∑∑@ C
,
∑∑C D 
ParameterDirection
∑∑E W
.
∑∑W X
Input
∑∑X ]
,
∑∑] ^
skin
∑∑_ c
)
∑∑c d
;
∑∑d e
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# *
,
∏∏* +
	SqlDbType
∏∏, 5
.
∏∏5 6
NVarChar
∏∏6 >
,
∏∏> ?
$num
∏∏@ B
,
∏∏B C 
ParameterDirection
∏∏D V
.
∏∏V W
Input
∏∏W \
,
∏∏\ ]
logo
∏∏^ b
)
∏∏b c
;
∏∏c d
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# *
,
ππ* +
	SqlDbType
ππ, 5
.
ππ5 6
NVarChar
ππ6 >
,
ππ> ?
$num
ππ@ B
,
ππB C 
ParameterDirection
ππD V
.
ππV W
Input
ππW \
,
ππ\ ]
icon
ππ^ b
)
ππb c
;
ππc d
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# :
,
∫∫: ;
	SqlDbType
∫∫< E
.
∫∫E F
Bit
∫∫F I
,
∫∫I J 
ParameterDirection
∫∫K ]
.
∫∫] ^
Input
∫∫^ c
,
∫∫c d"
allowNewRegistration
∫∫e y
)
∫∫y z
;
∫∫z {
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 4
,
ªª4 5
	SqlDbType
ªª6 ?
.
ªª? @
Bit
ªª@ C
,
ªªC D 
ParameterDirection
ªªE W
.
ªªW X
Input
ªªX ]
,
ªª] ^
allowUserSkins
ªª_ m
)
ªªm n
;
ªªn o
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# ;
,
ºº; <
	SqlDbType
ºº= F
.
ººF G
Bit
ººG J
,
ººJ K 
ParameterDirection
ººL ^
.
ºº^ _
Input
ºº_ d
,
ººd e#
useSecureRegistration
ººf {
)
ºº{ |
;
ºº| }
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ "
(
ΩΩ" #
$str
ΩΩ# 6
,
ΩΩ6 7
	SqlDbType
ΩΩ8 A
.
ΩΩA B
Bit
ΩΩB E
,
ΩΩE F 
ParameterDirection
ΩΩG Y
.
ΩΩY Z
Input
ΩΩZ _
,
ΩΩ_ `
useSslOnAllPages
ΩΩa q
)
ΩΩq r
;
ΩΩr s
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 9
,
ææ9 :
	SqlDbType
ææ; D
.
ææD E
NVarChar
ææE M
,
ææM N
$num
ææO R
,
ææR S 
ParameterDirection
ææT f
.
ææf g
Input
ææg l
,
ææl m"
defaultPageKeywordsææn Å
)ææÅ Ç
;ææÇ É
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# <
,
øø< =
	SqlDbType
øø> G
.
øøG H
NVarChar
øøH P
,
øøP Q
$num
øøR U
,
øøU V 
ParameterDirection
øøW i
.
øøi j
Input
øøj o
,
øøo p%
defaultPageDescriptionøøq á
)øøá à
;øøà â
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 9
,
¿¿9 :
	SqlDbType
¿¿; D
.
¿¿D E
NVarChar
¿¿E M
,
¿¿M N
$num
¿¿O R
,
¿¿R S 
ParameterDirection
¿¿T f
.
¿¿f g
Input
¿¿g l
,
¿¿l m"
defaultPageEncoding¿¿n Å
)¿¿Å Ç
;¿¿Ç É
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# ?
,
¡¡? @
	SqlDbType
¡¡A J
.
¡¡J K
NVarChar
¡¡K S
,
¡¡S T
$num
¡¡U X
,
¡¡X Y 
ParameterDirection
¡¡Z l
.
¡¡l m
Input
¡¡m r
,
¡¡r s(
defaultAdditionalMetaTags¡¡t ç
)¡¡ç é
;¡¡é è
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 7
,
¬¬7 8
	SqlDbType
¬¬9 B
.
¬¬B C
Bit
¬¬C F
,
¬¬F G 
ParameterDirection
¬¬H Z
.
¬¬Z [
Input
¬¬[ `
,
¬¬` a
isServerAdminSite
¬¬b s
)
¬¬s t
;
¬¬t u
sph
√√ 
.
√√  
DefineSqlParameter
√√ "
(
√√" #
$str
√√# 4
,
√√4 5
	SqlDbType
√√6 ?
.
√√? @
Bit
√√@ C
,
√√C D 
ParameterDirection
√√E W
.
√√W X
Input
√√X ]
,
√√] ^
allowPageSkins
√√_ m
)
√√m n
;
√√n o
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ "
(
ƒƒ" #
$str
ƒƒ# :
,
ƒƒ: ;
	SqlDbType
ƒƒ< E
.
ƒƒE F
Bit
ƒƒF I
,
ƒƒI J 
ParameterDirection
ƒƒK ]
.
ƒƒ] ^
Input
ƒƒ^ c
,
ƒƒc d"
allowHideMenuOnPages
ƒƒe y
)
ƒƒy z
;
ƒƒz {
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ "
(
≈≈" #
$str
≈≈# 1
,
≈≈1 2
	SqlDbType
≈≈3 <
.
≈≈< =
Bit
≈≈= @
,
≈≈@ A 
ParameterDirection
≈≈B T
.
≈≈T U
Input
≈≈U Z
,
≈≈Z [
useLdapAuth
≈≈\ g
)
≈≈g h
;
≈≈h i
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ "
(
∆∆" #
$str
∆∆# D
,
∆∆D E
	SqlDbType
∆∆F O
.
∆∆O P
Bit
∆∆P S
,
∆∆S T 
ParameterDirection
∆∆U g
.
∆∆g h
Input
∆∆h m
,
∆∆m n-
autoCreateLdapUserOnFirstLogin∆∆o ç
)∆∆ç é
;∆∆é è
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 0
,
««0 1
	SqlDbType
««2 ;
.
««; <
NVarChar
««< D
,
««D E
$num
««F I
,
««I J 
ParameterDirection
««K ]
.
««] ^
Input
««^ c
,
««c d

ldapServer
««e o
)
««o p
;
««p q
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# .
,
»». /
	SqlDbType
»»0 9
.
»»9 :
Int
»»: =
,
»»= > 
ParameterDirection
»»? Q
.
»»Q R
Input
»»R W
,
»»W X
ldapPort
»»Y a
)
»»a b
;
»»b c
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# 0
,
……0 1
	SqlDbType
……2 ;
.
……; <
NVarChar
……< D
,
……D E
$num
……F I
,
……I J 
ParameterDirection
……K ]
.
……] ^
Input
……^ c
,
……c d

ldapRootDN
……e o
)
……o p
;
……p q
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 3
,
  3 4
	SqlDbType
  5 >
.
  > ?
NVarChar
  ? G
,
  G H
$num
  I K
,
  K L 
ParameterDirection
  M _
.
  _ `
Input
  ` e
,
  e f
ldapUserDNKey
  g t
)
  t u
;
  u v
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# =
,
ÀÀ= >
	SqlDbType
ÀÀ? H
.
ÀÀH I
Bit
ÀÀI L
,
ÀÀL M 
ParameterDirection
ÀÀN `
.
ÀÀ` a
Input
ÀÀa f
,
ÀÀf g%
allowUserFullNameChange
ÀÀh 
)ÀÀ Ä
;ÀÀÄ Å
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# 6
,
ÃÃ6 7
	SqlDbType
ÃÃ8 A
.
ÃÃA B
Bit
ÃÃB E
,
ÃÃE F 
ParameterDirection
ÃÃG Y
.
ÃÃY Z
Input
ÃÃZ _
,
ÃÃ_ `
useEmailForLogin
ÃÃa q
)
ÃÃq r
;
ÃÃr s
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# 7
,
ÕÕ7 8
	SqlDbType
ÕÕ9 B
.
ÕÕB C
Bit
ÕÕC F
,
ÕÕF G 
ParameterDirection
ÕÕH Z
.
ÕÕZ [
Input
ÕÕ[ `
,
ÕÕ` a
reallyDeleteUsers
ÕÕb s
)
ÕÕs t
;
ÕÕt u
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ "
(
ŒŒ" #
$str
ŒŒ# 0
,
ŒŒ0 1
	SqlDbType
ŒŒ2 ;
.
ŒŒ; <
NVarChar
ŒŒ< D
,
ŒŒD E
$num
ŒŒF H
,
ŒŒH I 
ParameterDirection
ŒŒJ \
.
ŒŒ\ ]
Input
ŒŒ] b
,
ŒŒb c

editorSkin
ŒŒd n
)
ŒŒn o
;
ŒŒo p
sph
œœ 
.
œœ  
DefineSqlParameter
œœ "
(
œœ" #
$str
œœ# C
,
œœC D
	SqlDbType
œœE N
.
œœN O
NVarChar
œœO W
,
œœW X
$num
œœY [
,
œœ[ \ 
ParameterDirection
œœ] o
.
œœo p
Input
œœp u
,
œœu v(
defaultFriendlyUrlPatternœœw ê
)œœê ë
;œœë í
sph
–– 
.
––  
DefineSqlParameter
–– "
(
––" #
$str
––# 9
,
––9 :
	SqlDbType
––; D
.
––D E
Bit
––E H
,
––H I 
ParameterDirection
––J \
.
––\ ]
Input
––] b
,
––b c!
enableMyPageFeature
––d w
)
––w x
;
––x y
sph
—— 
.
——  
DefineSqlParameter
—— "
(
——" #
$str
——# 0
,
——0 1
	SqlDbType
——2 ;
.
——; <
NVarChar
——< D
,
——D E
$num
——F I
,
——I J 
ParameterDirection
——K ]
.
——] ^
Input
——^ c
,
——c d

ldapDomain
——e o
)
——o p
;
——p q
sph
““ 
.
““  
DefineSqlParameter
““ "
(
““" #
$str
““# 4
,
““4 5
	SqlDbType
““6 ?
.
““? @
NVarChar
““@ H
,
““H I
$num
““J M
,
““M N 
ParameterDirection
““O a
.
““a b
Input
““b g
,
““g h
editorProvider
““i w
)
““w x
;
““x y
sph
”” 
.
””  
DefineSqlParameter
”” "
(
””" #
$str
””# 8
,
””8 9
	SqlDbType
””: C
.
””C D
NVarChar
””D L
,
””L M
$num
””N Q
,
””Q R 
ParameterDirection
””S e
.
””e f
Input
””f k
,
””k l 
datePickerProvider
””m 
)”” Ä
;””Ä Å
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ "
(
‘‘" #
$str
‘‘# 5
,
‘‘5 6
	SqlDbType
‘‘7 @
.
‘‘@ A
NVarChar
‘‘A I
,
‘‘I J
$num
‘‘K N
,
‘‘N O 
ParameterDirection
‘‘P b
.
‘‘b c
Input
‘‘c h
,
‘‘h i
captchaProvider
‘‘j y
)
‘‘y z
;
‘‘z {
sph
’’ 
.
’’  
DefineSqlParameter
’’ "
(
’’" #
$str
’’# 9
,
’’9 :
	SqlDbType
’’; D
.
’’D E
NVarChar
’’E M
,
’’M N
$num
’’O R
,
’’R S 
ParameterDirection
’’T f
.
’’f g
Input
’’g l
,
’’l m"
recaptchaPrivateKey’’n Å
)’’Å Ç
;’’Ç É
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# 8
,
÷÷8 9
	SqlDbType
÷÷: C
.
÷÷C D
NVarChar
÷÷D L
,
÷÷L M
$num
÷÷N Q
,
÷÷Q R 
ParameterDirection
÷÷S e
.
÷÷e f
Input
÷÷f k
,
÷÷k l 
recaptchaPublicKey
÷÷m 
)÷÷ Ä
;÷÷Ä Å
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ "
(
◊◊" #
$str
◊◊# 5
,
◊◊5 6
	SqlDbType
◊◊7 @
.
◊◊@ A
NVarChar
◊◊A I
,
◊◊I J
$num
◊◊K N
,
◊◊N O 
ParameterDirection
◊◊P b
.
◊◊b c
Input
◊◊c h
,
◊◊h i
wordpressApiKey
◊◊j y
)
◊◊y z
;
◊◊z {
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 6
,
ÿÿ6 7
	SqlDbType
ÿÿ8 A
.
ÿÿA B
NVarChar
ÿÿB J
,
ÿÿJ K
$num
ÿÿL O
,
ÿÿO P 
ParameterDirection
ÿÿQ c
.
ÿÿc d
Input
ÿÿd i
,
ÿÿi j
windowsLiveAppId
ÿÿk {
)
ÿÿ{ |
;
ÿÿ| }
sph
ŸŸ 
.
ŸŸ  
DefineSqlParameter
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# 4
,
ŸŸ4 5
	SqlDbType
ŸŸ6 ?
.
ŸŸ? @
NVarChar
ŸŸ@ H
,
ŸŸH I
$num
ŸŸJ M
,
ŸŸM N 
ParameterDirection
ŸŸO a
.
ŸŸa b
Input
ŸŸb g
,
ŸŸg h
windowsLiveKey
ŸŸi w
)
ŸŸw x
;
ŸŸx y
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# 5
,
⁄⁄5 6
	SqlDbType
⁄⁄7 @
.
⁄⁄@ A
Bit
⁄⁄A D
,
⁄⁄D E 
ParameterDirection
⁄⁄F X
.
⁄⁄X Y
Input
⁄⁄Y ^
,
⁄⁄^ _
allowOpenIdAuth
⁄⁄` o
)
⁄⁄o p
;
⁄⁄p q
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# :
,
€€: ;
	SqlDbType
€€< E
.
€€E F
Bit
€€F I
,
€€I J 
ParameterDirection
€€K ]
.
€€] ^
Input
€€^ c
,
€€c d"
allowWindowsLiveAuth
€€e y
)
€€y z
;
€€z {
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# 0
,
‹‹0 1
	SqlDbType
‹‹2 ;
.
‹‹; <
NVarChar
‹‹< D
,
‹‹D E
$num
‹‹F I
,
‹‹I J 
ParameterDirection
‹‹K ]
.
‹‹] ^
Input
‹‹^ c
,
‹‹c d

gmapApiKey
‹‹e o
)
‹‹o p
;
‹‹p q
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# 2
,
››2 3
	SqlDbType
››4 =
.
››= >
NVarChar
››> F
,
››F G
$num
››H K
,
››K L 
ParameterDirection
››M _
.
››_ `
Input
››` e
,
››e f
apiKeyExtra1
››g s
)
››s t
;
››t u
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ "
(
ﬁﬁ" #
$str
ﬁﬁ# 2
,
ﬁﬁ2 3
	SqlDbType
ﬁﬁ4 =
.
ﬁﬁ= >
NVarChar
ﬁﬁ> F
,
ﬁﬁF G
$num
ﬁﬁH K
,
ﬁﬁK L 
ParameterDirection
ﬁﬁM _
.
ﬁﬁ_ `
Input
ﬁﬁ` e
,
ﬁﬁe f
apiKeyExtra2
ﬁﬁg s
)
ﬁﬁs t
;
ﬁﬁt u
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ "
(
ﬂﬂ" #
$str
ﬂﬂ# 2
,
ﬂﬂ2 3
	SqlDbType
ﬂﬂ4 =
.
ﬂﬂ= >
NVarChar
ﬂﬂ> F
,
ﬂﬂF G
$num
ﬂﬂH K
,
ﬂﬂK L 
ParameterDirection
ﬂﬂM _
.
ﬂﬂ_ `
Input
ﬂﬂ` e
,
ﬂﬂe f
apiKeyExtra3
ﬂﬂg s
)
ﬂﬂs t
;
ﬂﬂt u
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ "
(
‡‡" #
$str
‡‡# 2
,
‡‡2 3
	SqlDbType
‡‡4 =
.
‡‡= >
NVarChar
‡‡> F
,
‡‡F G
$num
‡‡H K
,
‡‡K L 
ParameterDirection
‡‡M _
.
‡‡_ `
Input
‡‡` e
,
‡‡e f
apiKeyExtra4
‡‡g s
)
‡‡s t
;
‡‡t u
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 2
,
··2 3
	SqlDbType
··4 =
.
··= >
NVarChar
··> F
,
··F G
$num
··H K
,
··K L 
ParameterDirection
··M _
.
··_ `
Input
··` e
,
··e f
apiKeyExtra5
··g s
)
··s t
;
··t u
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ "
(
‚‚" #
$str
‚‚# 3
,
‚‚3 4
	SqlDbType
‚‚5 >
.
‚‚> ?
Bit
‚‚? B
,
‚‚B C 
ParameterDirection
‚‚D V
.
‚‚V W
Input
‚‚W \
,
‚‚\ ]
disableDbAuth
‚‚^ k
)
‚‚k l
;
‚‚l m
int
„„ 
rowsAffected
„„ 
=
„„ 
sph
„„ "
.
„„" #
ExecuteNonQuery
„„# 2
(
„„2 3
)
„„3 4
;
„„4 5
return
‰‰ 
(
‰‰ 
rowsAffected
‰‰  
>
‰‰! "
-
‰‰# $
$num
‰‰$ %
)
‰‰% &
;
‰‰& '
}
ÂÂ 	
public
ÁÁ 
static
ÁÁ 
bool
ÁÁ &
UpdateExtendedProperties
ÁÁ 3
(
ÁÁ3 4
int
ËË 
siteId
ËË 
,
ËË 
bool
ÈÈ $
allowPasswordRetrieval
ÈÈ '
,
ÈÈ' (
bool
ÍÍ  
allowPasswordReset
ÍÍ #
,
ÍÍ# $
bool
ÎÎ '
requiresQuestionAndAnswer
ÎÎ *
,
ÎÎ* +
int
ÏÏ (
maxInvalidPasswordAttempts
ÏÏ *
,
ÏÏ* +
int
ÌÌ *
passwordAttemptWindowMinutes
ÌÌ ,
,
ÌÌ, -
bool
ÓÓ !
requiresUniqueEmail
ÓÓ $
,
ÓÓ$ %
int
ÔÔ 
passwordFormat
ÔÔ 
,
ÔÔ 
int
 '
minRequiredPasswordLength
 )
,
) *
int
ÒÒ 2
$minRequiredNonAlphanumericCharacters
ÒÒ 4
,
ÒÒ4 5
String
ÚÚ /
!passwordStrengthRegularExpression
ÚÚ 4
,
ÚÚ4 5
String
ÛÛ %
defaultEmailFromAddress
ÛÛ *
)
ÙÙ 
{
ıı 	 
SqlParameterHelper
ˆˆ 
sph
ˆˆ "
=
ˆˆ# $
new
ˆˆ% ( 
SqlParameterHelper
ˆˆ) ;
(
ˆˆ; <
ConnectionString
ˆˆ< L
.
ˆˆL M&
GetWriteConnectionString
ˆˆM e
(
ˆˆe f
)
ˆˆf g
,
ˆˆg h
$strˆˆi å
,ˆˆå ç
$numˆˆé ê
)ˆˆê ë
;ˆˆë í
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ "
(
˜˜" #
$str
˜˜# ,
,
˜˜, -
	SqlDbType
˜˜. 7
.
˜˜7 8
Int
˜˜8 ;
,
˜˜; < 
ParameterDirection
˜˜= O
.
˜˜O P
Input
˜˜P U
,
˜˜U V
siteId
˜˜W ]
)
˜˜] ^
;
˜˜^ _
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# <
,
¯¯< =
	SqlDbType
¯¯> G
.
¯¯G H
Bit
¯¯H K
,
¯¯K L 
ParameterDirection
¯¯M _
.
¯¯_ `
Input
¯¯` e
,
¯¯e f$
allowPasswordRetrieval
¯¯g }
)
¯¯} ~
;
¯¯~ 
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# 8
,
˘˘8 9
	SqlDbType
˘˘: C
.
˘˘C D
Bit
˘˘D G
,
˘˘G H 
ParameterDirection
˘˘I [
.
˘˘[ \
Input
˘˘\ a
,
˘˘a b 
allowPasswordReset
˘˘c u
)
˘˘u v
;
˘˘v w
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# ?
,
˙˙? @
	SqlDbType
˙˙A J
.
˙˙J K
Bit
˙˙K N
,
˙˙N O 
ParameterDirection
˙˙P b
.
˙˙b c
Input
˙˙c h
,
˙˙h i(
requiresQuestionAndAnswer˙˙j É
)˙˙É Ñ
;˙˙Ñ Ö
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ "
(
˚˚" #
$str
˚˚# @
,
˚˚@ A
	SqlDbType
˚˚B K
.
˚˚K L
Int
˚˚L O
,
˚˚O P 
ParameterDirection
˚˚Q c
.
˚˚c d
Input
˚˚d i
,
˚˚i j)
maxInvalidPasswordAttempts˚˚k Ö
)˚˚Ö Ü
;˚˚Ü á
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# B
,
¸¸B C
	SqlDbType
¸¸D M
.
¸¸M N
Int
¸¸N Q
,
¸¸Q R 
ParameterDirection
¸¸S e
.
¸¸e f
Input
¸¸f k
,
¸¸k l+
passwordAttemptWindowMinutes¸¸m â
)¸¸â ä
;¸¸ä ã
sph
˝˝ 
.
˝˝  
DefineSqlParameter
˝˝ "
(
˝˝" #
$str
˝˝# 9
,
˝˝9 :
	SqlDbType
˝˝; D
.
˝˝D E
Bit
˝˝E H
,
˝˝H I 
ParameterDirection
˝˝J \
.
˝˝\ ]
Input
˝˝] b
,
˝˝b c!
requiresUniqueEmail
˝˝d w
)
˝˝w x
;
˝˝x y
sph
˛˛ 
.
˛˛  
DefineSqlParameter
˛˛ "
(
˛˛" #
$str
˛˛# 4
,
˛˛4 5
	SqlDbType
˛˛6 ?
.
˛˛? @
Int
˛˛@ C
,
˛˛C D 
ParameterDirection
˛˛E W
.
˛˛W X
Input
˛˛X ]
,
˛˛] ^
passwordFormat
˛˛_ m
)
˛˛m n
;
˛˛n o
sph
ˇˇ 
.
ˇˇ  
DefineSqlParameter
ˇˇ "
(
ˇˇ" #
$str
ˇˇ# ?
,
ˇˇ? @
	SqlDbType
ˇˇA J
.
ˇˇJ K
Int
ˇˇK N
,
ˇˇN O 
ParameterDirection
ˇˇP b
.
ˇˇb c
Input
ˇˇc h
,
ˇˇh i(
minRequiredPasswordLengthˇˇj É
)ˇˇÉ Ñ
;ˇˇÑ Ö
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# J
,
ÄÄJ K
	SqlDbType
ÄÄL U
.
ÄÄU V
Int
ÄÄV Y
,
ÄÄY Z 
ParameterDirection
ÄÄ[ m
.
ÄÄm n
Input
ÄÄn s
,
ÄÄs t3
$minRequiredNonAlphanumericCharactersÄÄu ô
)ÄÄô ö
;ÄÄö õ
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# G
,
ÅÅG H
	SqlDbType
ÅÅI R
.
ÅÅR S
NVarChar
ÅÅS [
,
ÅÅ[ \
-
ÅÅ] ^
$num
ÅÅ^ _
,
ÅÅ_ ` 
ParameterDirection
ÅÅa s
.
ÅÅs t
Input
ÅÅt y
,
ÅÅy z0
!passwordStrengthRegularExpressionÅÅ{ ú
)ÅÅú ù
;ÅÅù û
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# =
,
ÇÇ= >
	SqlDbType
ÇÇ? H
.
ÇÇH I
NVarChar
ÇÇI Q
,
ÇÇQ R
$num
ÇÇS V
,
ÇÇV W 
ParameterDirection
ÇÇX j
.
ÇÇj k
Input
ÇÇk p
,
ÇÇp q&
defaultEmailFromAddressÇÇr â
)ÇÇâ ä
;ÇÇä ã
int
ÉÉ 
rowsAffected
ÉÉ 
=
ÉÉ 
sph
ÉÉ "
.
ÉÉ" #
ExecuteNonQuery
ÉÉ# 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
-
ÑÑ# $
$num
ÑÑ$ %
)
ÑÑ% &
;
ÑÑ& '
}
ÖÖ 	
public
áá 
static
áá 
bool
áá  
UpdateRelatedSites
áá -
(
áá- .
int
àà 
siteId
àà 
,
àà 
bool
ââ "
allowNewRegistration
ââ %
,
ââ% &
bool
ää #
useSecureRegistration
ää &
,
ää& '
bool
ãã 
useLdapAuth
ãã 
,
ãã 
bool
åå ,
autoCreateLdapUserOnFirstLogin
åå /
,
åå/ 0
string
çç 

ldapServer
çç 
,
çç 
string
éé 

ldapDomain
éé 
,
éé 
int
èè 
ldapPort
èè 
,
èè 
string
êê 

ldapRootDN
êê 
,
êê 
string
ëë 
ldapUserDNKey
ëë  
,
ëë  !
bool
íí %
allowUserFullNameChange
íí (
,
íí( )
bool
ìì 
useEmailForLogin
ìì !
,
ìì! "
bool
îî 
allowOpenIdAuth
îî  
,
îî  !
bool
ïï "
allowWindowsLiveAuth
ïï %
,
ïï% &
bool
ññ $
allowPasswordRetrieval
ññ '
,
ññ' (
bool
óó  
allowPasswordReset
óó #
,
óó# $
bool
òò '
requiresQuestionAndAnswer
òò *
,
òò* +
int
ôô (
maxInvalidPasswordAttempts
ôô *
,
ôô* +
int
öö *
passwordAttemptWindowMinutes
öö ,
,
öö, -
bool
õõ !
requiresUniqueEmail
õõ $
,
õõ$ %
int
úú 
passwordFormat
úú 
,
úú 
int
ùù '
minRequiredPasswordLength
ùù )
,
ùù) *
int
ûû !
minReqNonAlphaChars
ûû #
,
ûû# $
string
üü 
pwdStrengthRegex
üü #
)
†† 
{
°° 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i ç
,££ç é
$num££è ë
)££ë í
;££í ì
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# ,
,
§§, -
	SqlDbType
§§. 7
.
§§7 8
Int
§§8 ;
,
§§; < 
ParameterDirection
§§= O
.
§§O P
Input
§§P U
,
§§U V
siteId
§§W ]
)
§§] ^
;
§§^ _
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# :
,
••: ;
	SqlDbType
••< E
.
••E F
Bit
••F I
,
••I J 
ParameterDirection
••K ]
.
••] ^
Input
••^ c
,
••c d"
allowNewRegistration
••e y
)
••y z
;
••z {
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# ;
,
¶¶; <
	SqlDbType
¶¶= F
.
¶¶F G
Bit
¶¶G J
,
¶¶J K 
ParameterDirection
¶¶L ^
.
¶¶^ _
Input
¶¶_ d
,
¶¶d e#
useSecureRegistration
¶¶f {
)
¶¶{ |
;
¶¶| }
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 1
,
ßß1 2
	SqlDbType
ßß3 <
.
ßß< =
Bit
ßß= @
,
ßß@ A 
ParameterDirection
ßßB T
.
ßßT U
Input
ßßU Z
,
ßßZ [
useLdapAuth
ßß\ g
)
ßßg h
;
ßßh i
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# D
,
®®D E
	SqlDbType
®®F O
.
®®O P
Bit
®®P S
,
®®S T 
ParameterDirection
®®U g
.
®®g h
Input
®®h m
,
®®m n-
autoCreateLdapUserOnFirstLogin®®o ç
)®®ç é
;®®é è
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# 0
,
©©0 1
	SqlDbType
©©2 ;
.
©©; <
NVarChar
©©< D
,
©©D E
$num
©©F I
,
©©I J 
ParameterDirection
©©K ]
.
©©] ^
Input
©©^ c
,
©©c d

ldapServer
©©e o
)
©©o p
;
©©p q
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# 0
,
™™0 1
	SqlDbType
™™2 ;
.
™™; <
NVarChar
™™< D
,
™™D E
$num
™™F I
,
™™I J 
ParameterDirection
™™K ]
.
™™] ^
Input
™™^ c
,
™™c d

ldapDomain
™™e o
)
™™o p
;
™™p q
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
Int
´´: =
,
´´= > 
ParameterDirection
´´? Q
.
´´Q R
Input
´´R W
,
´´W X
ldapPort
´´Y a
)
´´a b
;
´´b c
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 0
,
¨¨0 1
	SqlDbType
¨¨2 ;
.
¨¨; <
NVarChar
¨¨< D
,
¨¨D E
$num
¨¨F I
,
¨¨I J 
ParameterDirection
¨¨K ]
.
¨¨] ^
Input
¨¨^ c
,
¨¨c d

ldapRootDN
¨¨e o
)
¨¨o p
;
¨¨p q
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# 3
,
≠≠3 4
	SqlDbType
≠≠5 >
.
≠≠> ?
NVarChar
≠≠? G
,
≠≠G H
$num
≠≠I K
,
≠≠K L 
ParameterDirection
≠≠M _
.
≠≠_ `
Input
≠≠` e
,
≠≠e f
ldapUserDNKey
≠≠g t
)
≠≠t u
;
≠≠u v
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# =
,
ÆÆ= >
	SqlDbType
ÆÆ? H
.
ÆÆH I
Bit
ÆÆI L
,
ÆÆL M 
ParameterDirection
ÆÆN `
.
ÆÆ` a
Input
ÆÆa f
,
ÆÆf g%
allowUserFullNameChange
ÆÆh 
)ÆÆ Ä
;ÆÆÄ Å
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 6
,
ØØ6 7
	SqlDbType
ØØ8 A
.
ØØA B
Bit
ØØB E
,
ØØE F 
ParameterDirection
ØØG Y
.
ØØY Z
Input
ØØZ _
,
ØØ_ `
useEmailForLogin
ØØa q
)
ØØq r
;
ØØr s
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ "
(
∞∞" #
$str
∞∞# 5
,
∞∞5 6
	SqlDbType
∞∞7 @
.
∞∞@ A
Bit
∞∞A D
,
∞∞D E 
ParameterDirection
∞∞F X
.
∞∞X Y
Input
∞∞Y ^
,
∞∞^ _
allowOpenIdAuth
∞∞` o
)
∞∞o p
;
∞∞p q
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# :
,
±±: ;
	SqlDbType
±±< E
.
±±E F
Bit
±±F I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d"
allowWindowsLiveAuth
±±e y
)
±±y z
;
±±z {
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# <
,
≤≤< =
	SqlDbType
≤≤> G
.
≤≤G H
Bit
≤≤H K
,
≤≤K L 
ParameterDirection
≤≤M _
.
≤≤_ `
Input
≤≤` e
,
≤≤e f$
allowPasswordRetrieval
≤≤g }
)
≤≤} ~
;
≤≤~ 
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# 8
,
≥≥8 9
	SqlDbType
≥≥: C
.
≥≥C D
Bit
≥≥D G
,
≥≥G H 
ParameterDirection
≥≥I [
.
≥≥[ \
Input
≥≥\ a
,
≥≥a b 
allowPasswordReset
≥≥c u
)
≥≥u v
;
≥≥v w
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# ?
,
¥¥? @
	SqlDbType
¥¥A J
.
¥¥J K
Bit
¥¥K N
,
¥¥N O 
ParameterDirection
¥¥P b
.
¥¥b c
Input
¥¥c h
,
¥¥h i(
requiresQuestionAndAnswer¥¥j É
)¥¥É Ñ
;¥¥Ñ Ö
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# @
,
µµ@ A
	SqlDbType
µµB K
.
µµK L
Int
µµL O
,
µµO P 
ParameterDirection
µµQ c
.
µµc d
Input
µµd i
,
µµi j)
maxInvalidPasswordAttemptsµµk Ö
)µµÖ Ü
;µµÜ á
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# B
,
∂∂B C
	SqlDbType
∂∂D M
.
∂∂M N
Int
∂∂N Q
,
∂∂Q R 
ParameterDirection
∂∂S e
.
∂∂e f
Input
∂∂f k
,
∂∂k l+
passwordAttemptWindowMinutes∂∂m â
)∂∂â ä
;∂∂ä ã
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# 9
,
∑∑9 :
	SqlDbType
∑∑; D
.
∑∑D E
Bit
∑∑E H
,
∑∑H I 
ParameterDirection
∑∑J \
.
∑∑\ ]
Input
∑∑] b
,
∑∑b c!
requiresUniqueEmail
∑∑d w
)
∑∑w x
;
∑∑x y
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ "
(
∏∏" #
$str
∏∏# 4
,
∏∏4 5
	SqlDbType
∏∏6 ?
.
∏∏? @
Int
∏∏@ C
,
∏∏C D 
ParameterDirection
∏∏E W
.
∏∏W X
Input
∏∏X ]
,
∏∏] ^
passwordFormat
∏∏_ m
)
∏∏m n
;
∏∏n o
sph
ππ 
.
ππ  
DefineSqlParameter
ππ "
(
ππ" #
$str
ππ# ?
,
ππ? @
	SqlDbType
ππA J
.
ππJ K
Int
ππK N
,
ππN O 
ParameterDirection
ππP b
.
ππb c
Input
ππc h
,
ππh i(
minRequiredPasswordLengthππj É
)ππÉ Ñ
;ππÑ Ö
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ "
(
∫∫" #
$str
∫∫# 9
,
∫∫9 :
	SqlDbType
∫∫; D
.
∫∫D E
Int
∫∫E H
,
∫∫H I 
ParameterDirection
∫∫J \
.
∫∫\ ]
Input
∫∫] b
,
∫∫b c!
minReqNonAlphaChars
∫∫d w
)
∫∫w x
;
∫∫x y
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 6
,
ªª6 7
	SqlDbType
ªª8 A
.
ªªA B
NVarChar
ªªB J
,
ªªJ K
-
ªªL M
$num
ªªM N
,
ªªN O 
ParameterDirection
ªªP b
.
ªªb c
Input
ªªc h
,
ªªh i
pwdStrengthRegex
ªªj z
)
ªªz {
;
ªª{ |
int
ΩΩ 
rowsAffected
ΩΩ 
=
ΩΩ 
sph
ΩΩ "
.
ΩΩ" #
ExecuteNonQuery
ΩΩ# 2
(
ΩΩ2 3
)
ΩΩ3 4
;
ΩΩ4 5
return
ææ 
(
ææ 
rowsAffected
ææ  
>
ææ! "
-
ææ# $
$num
ææ$ %
)
ææ% &
;
ææ& '
}
øø 	
public
¡¡ 
static
¡¡ 
bool
¡¡ +
UpdateRelatedSitesWindowsLive
¡¡ 8
(
¡¡8 9
int
¬¬ 
siteId
¬¬ 
,
¬¬ 
string
√√ 
windowsLiveAppId
√√ #
,
√√# $
string
ƒƒ 
windowsLiveKey
ƒƒ !
)
≈≈ 
{
∆∆ 	 
SqlParameterHelper
«« 
sph
«« "
=
««# $
new
««% ( 
SqlParameterHelper
««) ;
(
««; <
ConnectionString
««< L
.
««L M&
GetWriteConnectionString
««M e
(
««e f
)
««f g
,
««g h
$str««i ã
,««ã å
$num««ç é
)««é è
;««è ê
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# ,
,
»», -
	SqlDbType
»». 7
.
»»7 8
Int
»»8 ;
,
»»; < 
ParameterDirection
»»= O
.
»»O P
Input
»»P U
,
»»U V
siteId
»»W ]
)
»»] ^
;
»»^ _
sph
…… 
.
……  
DefineSqlParameter
…… "
(
……" #
$str
……# 6
,
……6 7
	SqlDbType
……8 A
.
……A B
NVarChar
……B J
,
……J K
$num
……L O
,
……O P 
ParameterDirection
……Q c
.
……c d
Input
……d i
,
……i j
windowsLiveAppId
……k {
)
……{ |
;
……| }
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 4
,
  4 5
	SqlDbType
  6 ?
.
  ? @
NVarChar
  @ H
,
  H I
$num
  J M
,
  M N 
ParameterDirection
  O a
.
  a b
Input
  b g
,
  g h
windowsLiveKey
  i w
)
  w x
;
  x y
int
ÃÃ 
rowsAffected
ÃÃ 
=
ÃÃ 
sph
ÃÃ "
.
ÃÃ" #
ExecuteNonQuery
ÃÃ# 2
(
ÃÃ2 3
)
ÃÃ3 4
;
ÃÃ4 5
return
ÕÕ 
(
ÕÕ 
rowsAffected
ÕÕ  
>
ÕÕ! "
-
ÕÕ# $
$num
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
ŒŒ 	
public
”” 
static
”” 
bool
”” 
Delete
”” !
(
””! "
int
””" %
siteId
””& ,
)
””, -
{
‘‘ 	 
SqlParameterHelper
’’ 
sph
’’ "
=
’’# $
new
’’% ( 
SqlParameterHelper
’’) ;
(
’’; <
ConnectionString
’’< L
.
’’L M&
GetWriteConnectionString
’’M e
(
’’e f
)
’’f g
,
’’g h
$str
’’i z
,
’’z {
$num
’’| }
)
’’} ~
;
’’~ 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# ,
,
÷÷, -
	SqlDbType
÷÷. 7
.
÷÷7 8
Int
÷÷8 ;
,
÷÷; < 
ParameterDirection
÷÷= O
.
÷÷O P
Input
÷÷P U
,
÷÷U V
siteId
÷÷W ]
)
÷÷] ^
;
÷÷^ _
int
ŸŸ 
rowsAffected
ŸŸ 
=
ŸŸ 
sph
ŸŸ "
.
ŸŸ" #
ExecuteNonQuery
ŸŸ# 2
(
ŸŸ2 3
)
ŸŸ3 4
;
ŸŸ4 5
return
⁄⁄ 
(
⁄⁄ 
rowsAffected
⁄⁄  
>
⁄⁄! "
-
⁄⁄# $
$num
⁄⁄$ %
)
⁄⁄% &
;
⁄⁄& '
}
€€ 	
public
›› 
static
›› 
IDataReader
›› !
GetSiteList
››" -
(
››- .
)
››. /
{
ﬁﬁ 	 
SqlParameterHelper
ﬂﬂ 
sph
ﬂﬂ "
=
ﬂﬂ# $
new
ﬂﬂ% ( 
SqlParameterHelper
ﬂﬂ) ;
(
ﬂﬂ; <
ConnectionString
ﬂﬂ< L
.
ﬂﬂL M%
GetReadConnectionString
ﬂﬂM d
(
ﬂﬂd e
)
ﬂﬂe f
,
ﬂﬂf g
$str
ﬂﬂh |
,
ﬂﬂ| }
$num
ﬂﬂ~ 
)ﬂﬂ Ä
;ﬂﬂÄ Å
return
‡‡ 
sph
‡‡ 
.
‡‡ 
ExecuteReader
‡‡ $
(
‡‡$ %
)
‡‡% &
;
‡‡& '
}
·· 	
public
„„ 
static
„„ 
IDataReader
„„ !
GetSite
„„" )
(
„„) *
string
„„* 0
hostName
„„1 9
)
„„9 :
{
‰‰ 	 
SqlParameterHelper
ÂÂ 
sph
ÂÂ "
=
ÂÂ# $
new
ÂÂ% ( 
SqlParameterHelper
ÂÂ) ;
(
ÂÂ; <
ConnectionString
ÂÂ< L
.
ÂÂL M%
GetReadConnectionString
ÂÂM d
(
ÂÂd e
)
ÂÂe f
,
ÂÂf g
$strÂÂh Ç
,ÂÂÇ É
$numÂÂÑ Ö
)ÂÂÖ Ü
;ÂÂÜ á
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# .
,
ÊÊ. /
	SqlDbType
ÊÊ0 9
.
ÊÊ9 :
NVarChar
ÊÊ: B
,
ÊÊB C
$num
ÊÊD F
,
ÊÊF G 
ParameterDirection
ÊÊH Z
.
ÊÊZ [
Input
ÊÊ[ `
,
ÊÊ` a
hostName
ÊÊb j
)
ÊÊj k
;
ÊÊk l
return
ÁÁ 
sph
ÁÁ 
.
ÁÁ 
ExecuteReader
ÁÁ $
(
ÁÁ$ %
)
ÁÁ% &
;
ÁÁ& '
}
ÈÈ 	
public
ÏÏ 
static
ÏÏ 
void
ÏÏ 

AddFeature
ÏÏ %
(
ÏÏ% &
Guid
ÏÏ& *
siteGuid
ÏÏ+ 3
,
ÏÏ3 4
Guid
ÏÏ5 9
featureGuid
ÏÏ: E
)
ÏÏE F
{
ÌÌ 	 
SqlParameterHelper
ÓÓ 
sph
ÓÓ "
=
ÓÓ# $
new
ÓÓ% ( 
SqlParameterHelper
ÓÓ) ;
(
ÓÓ; <
ConnectionString
ÓÓ< L
.
ÓÓL M%
GetReadConnectionString
ÓÓM d
(
ÓÓd e
)
ÓÓe f
,
ÓÓf g
$strÓÓh â
,ÓÓâ ä
$numÓÓã å
)ÓÓå ç
;ÓÓç é
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# .
,
ÔÔ. /
	SqlDbType
ÔÔ0 9
.
ÔÔ9 :
UniqueIdentifier
ÔÔ: J
,
ÔÔJ K 
ParameterDirection
ÔÔL ^
.
ÔÔ^ _
Input
ÔÔ_ d
,
ÔÔd e
siteGuid
ÔÔf n
)
ÔÔn o
;
ÔÔo p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
sph
ÚÚ 
.
ÚÚ 
ExecuteNonQuery
ÚÚ 
(
ÚÚ  
)
ÚÚ  !
;
ÚÚ! "
}
ÙÙ 	
public
ˆˆ 
static
ˆˆ 
void
ˆˆ 
RemoveFeature
ˆˆ (
(
ˆˆ( )
Guid
ˆˆ) -
siteGuid
ˆˆ. 6
,
ˆˆ6 7
Guid
ˆˆ8 <
featureGuid
ˆˆ= H
)
ˆˆH I
{
˜˜ 	 
SqlParameterHelper
¯¯ 
sph
¯¯ "
=
¯¯# $
new
¯¯% ( 
SqlParameterHelper
¯¯) ;
(
¯¯; <
ConnectionString
¯¯< L
.
¯¯L M%
GetReadConnectionString
¯¯M d
(
¯¯d e
)
¯¯e f
,
¯¯f g
$str¯¯h â
,¯¯â ä
$num¯¯ã å
)¯¯å ç
;¯¯ç é
sph
˘˘ 
.
˘˘  
DefineSqlParameter
˘˘ "
(
˘˘" #
$str
˘˘# .
,
˘˘. /
	SqlDbType
˘˘0 9
.
˘˘9 :
UniqueIdentifier
˘˘: J
,
˘˘J K 
ParameterDirection
˘˘L ^
.
˘˘^ _
Input
˘˘_ d
,
˘˘d e
siteGuid
˘˘f n
)
˘˘n o
;
˘˘o p
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ "
(
˙˙" #
$str
˙˙# 1
,
˙˙1 2
	SqlDbType
˙˙3 <
.
˙˙< =
UniqueIdentifier
˙˙= M
,
˙˙M N 
ParameterDirection
˙˙O a
.
˙˙a b
Input
˙˙b g
,
˙˙g h
featureGuid
˙˙i t
)
˙˙t u
;
˙˙u v
sph
˚˚ 
.
˚˚ 
ExecuteNonQuery
˚˚ 
(
˚˚  
)
˚˚  !
;
˚˚! "
}
¸¸ 	
public
ˇˇ 
static
ˇˇ 
IDataReader
ˇˇ !
GetSite
ˇˇ" )
(
ˇˇ) *
int
ˇˇ* -
siteId
ˇˇ. 4
)
ˇˇ4 5
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M%
GetReadConnectionString
ÅÅM d
(
ÅÅd e
)
ÅÅe f
,
ÅÅf g
$str
ÅÅh |
,
ÅÅ| }
$num
ÅÅ~ 
)ÅÅ Ä
;ÅÅÄ Å
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# ,
,
ÇÇ, -
	SqlDbType
ÇÇ. 7
.
ÇÇ7 8
Int
ÇÇ8 ;
,
ÇÇ; < 
ParameterDirection
ÇÇ= O
.
ÇÇO P
Input
ÇÇP U
,
ÇÇU V
siteId
ÇÇW ]
)
ÇÇ] ^
;
ÇÇ^ _
return
ÉÉ 
sph
ÉÉ 
.
ÉÉ 
ExecuteReader
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ÑÑ 	
public
ÜÜ 
static
ÜÜ 
IDataReader
ÜÜ !
GetSite
ÜÜ" )
(
ÜÜ) *
Guid
ÜÜ* .
siteGuid
ÜÜ/ 7
)
ÜÜ7 8
{
áá 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh Ç
,ààÇ É
$numààÑ Ö
)ààÖ Ü
;ààÜ á
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# .
,
ââ. /
	SqlDbType
ââ0 9
.
ââ9 :
UniqueIdentifier
ââ: J
,
ââJ K 
ParameterDirection
ââL ^
.
ââ^ _
Input
ââ_ d
,
ââd e
siteGuid
ââf n
)
âân o
;
ââo p
return
ää 
sph
ää 
.
ää 
ExecuteReader
ää $
(
ää$ %
)
ää% &
;
ää& '
}
ãã 	
public
èè 
static
èè 
IDataReader
èè !!
GetPageListForAdmin
èè" 5
(
èè5 6
int
èè6 9
siteId
èè: @
)
èè@ A
{
êê 	 
SqlParameterHelper
ëë 
sph
ëë "
=
ëë# $
new
ëë% ( 
SqlParameterHelper
ëë) ;
(
ëë; <
ConnectionString
ëë< L
.
ëëL M%
GetReadConnectionString
ëëM d
(
ëëd e
)
ëëe f
,
ëëf g
$str
ëëh }
,
ëë} ~
$numëë Ä
)ëëÄ Å
;ëëÅ Ç
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# ,
,
íí, -
	SqlDbType
íí. 7
.
íí7 8
Int
íí8 ;
,
íí; < 
ParameterDirection
íí= O
.
ííO P
Input
ííP U
,
ííU V
siteId
ííW ]
)
íí] ^
;
íí^ _
return
ìì 
sph
ìì 
.
ìì 
ExecuteReader
ìì $
(
ìì$ %
)
ìì% &
;
ìì& '
}
îî 	
public
ññ 
static
ññ 
IDataReader
ññ !
GetHostList
ññ" -
(
ññ- .
int
ññ. 1
siteId
ññ2 8
)
ññ8 9
{
óó 	 
SqlParameterHelper
òò 
sph
òò "
=
òò# $
new
òò% ( 
SqlParameterHelper
òò) ;
(
òò; <
ConnectionString
òò< L
.
òòL M%
GetReadConnectionString
òòM d
(
òòd e
)
òòe f
,
òòf g
$str
òòh }
,
òò} ~
$numòò Ä
)òòÄ Å
;òòÅ Ç
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# ,
,
ôô, -
	SqlDbType
ôô. 7
.
ôô7 8
Int
ôô8 ;
,
ôô; < 
ParameterDirection
ôô= O
.
ôôO P
Input
ôôP U
,
ôôU V
siteId
ôôW ]
)
ôô] ^
;
ôô^ _
return
öö 
sph
öö 
.
öö 
ExecuteReader
öö $
(
öö$ %
)
öö% &
;
öö& '
}
õõ 	
public
ùù 
static
ùù	 
IDataReader
ùù 
GetHostList
ùù '
(
ùù' (
)
ùù( )
{
ûû  
SqlParameterHelper
üü 
sph
üü 
=
üü 
new
üü  
SqlParameterHelper
üü  2
(
üü2 3
ConnectionString
üü3 C
.
üüC D%
GetReadConnectionString
üüD [
(
üü[ \
)
üü\ ]
,
üü] ^
$str
üü_ w
,
üüw x
$num
üüy z
)
üüz {
;
üü{ |
return
†† 	
sph
††
 
.
†† 
ExecuteReader
†† 
(
†† 
)
†† 
;
†† 
}
°° 
public
££ 
static
££	 
void
££ 
AddHost
££ 
(
££ 
Guid
££ !
siteGuid
££" *
,
££* +
int
££, /
siteId
££0 6
,
££6 7
string
££8 >
hostName
££? G
)
££G H
{
§§ 	 
SqlParameterHelper
•• 
sph
•• "
=
••# $
new
••% ( 
SqlParameterHelper
••) ;
(
••; <
ConnectionString
••< L
.
••L M&
GetWriteConnectionString
••M e
(
••e f
)
••f g
,
••g h
$str
••i ~
,
••~ 
$num••Ä Å
)••Å Ç
;••Ç É
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
UniqueIdentifier
¶¶: J
,
¶¶J K 
ParameterDirection
¶¶L ^
.
¶¶^ _
Input
¶¶_ d
,
¶¶d e
siteGuid
¶¶f n
)
¶¶n o
;
¶¶o p
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# ,
,
ßß, -
	SqlDbType
ßß. 7
.
ßß7 8
Int
ßß8 ;
,
ßß; < 
ParameterDirection
ßß= O
.
ßßO P
Input
ßßP U
,
ßßU V
siteId
ßßW ]
)
ßß] ^
;
ßß^ _
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# .
,
®®. /
	SqlDbType
®®0 9
.
®®9 :
NVarChar
®®: B
,
®®B C
$num
®®D G
,
®®G H 
ParameterDirection
®®I [
.
®®[ \
Input
®®\ a
,
®®a b
hostName
®®c k
)
®®k l
;
®®l m
sph
©© 
.
©© 
ExecuteNonQuery
©© 
(
©©  
)
©©  !
;
©©! "
}
™™ 	
public
¨¨ 
static
¨¨ 
void
¨¨ 

DeleteHost
¨¨ %
(
¨¨% &
int
¨¨& )
hostId
¨¨* 0
)
¨¨0 1
{
≠≠ 	 
SqlParameterHelper
ÆÆ 
sph
ÆÆ "
=
ÆÆ# $
new
ÆÆ% ( 
SqlParameterHelper
ÆÆ) ;
(
ÆÆ; <
ConnectionString
ÆÆ< L
.
ÆÆL M&
GetWriteConnectionString
ÆÆM e
(
ÆÆe f
)
ÆÆf g
,
ÆÆg h
$str
ÆÆi ~
,
ÆÆ~ 
$numÆÆÄ Å
)ÆÆÅ Ç
;ÆÆÇ É
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# ,
,
ØØ, -
	SqlDbType
ØØ. 7
.
ØØ7 8
Int
ØØ8 ;
,
ØØ; < 
ParameterDirection
ØØ= O
.
ØØO P
Input
ØØP U
,
ØØU V
hostId
ØØW ]
)
ØØ] ^
;
ØØ^ _
sph
∞∞ 
.
∞∞ 
ExecuteNonQuery
∞∞ 
(
∞∞  
)
∞∞  !
;
∞∞! "
}
±± 	
public
¥¥ 
static
¥¥ 
int
¥¥ 
CountOtherSites
¥¥ )
(
¥¥) *
int
¥¥* -
currentSiteId
¥¥. ;
)
¥¥; <
{
µµ 	 
SqlParameterHelper
∂∂ 
sph
∂∂ "
=
∂∂# $
new
∂∂% ( 
SqlParameterHelper
∂∂) ;
(
∂∂; <
ConnectionString
∂∂< L
.
∂∂L M%
GetReadConnectionString
∂∂M d
(
∂∂d e
)
∂∂e f
,
∂∂f g
$str∂∂h Ç
,∂∂Ç É
$num∂∂Ñ Ö
)∂∂Ö Ü
;∂∂Ü á
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ "
(
∑∑" #
$str
∑∑# 3
,
∑∑3 4
	SqlDbType
∑∑5 >
.
∑∑> ?
Int
∑∑? B
,
∑∑B C 
ParameterDirection
∑∑D V
.
∑∑V W
Input
∑∑W \
,
∑∑\ ]
currentSiteId
∑∑^ k
)
∑∑k l
;
∑∑l m
return
ππ 
Convert
ππ 
.
ππ 
ToInt32
ππ "
(
ππ" #
sph
ππ# &
.
ππ& '
ExecuteScalar
ππ' 4
(
ππ4 5
)
ππ5 6
)
ππ6 7
;
ππ7 8
}
ªª 	
public
ΩΩ 
static
ΩΩ 
IDataReader
ΩΩ !!
GetPageOfOtherSites
ΩΩ" 5
(
ΩΩ5 6
int
ææ 
currentSiteId
ææ 
,
ææ 
int
øø 

pageNumber
øø 
,
øø 
int
¿¿ 
pageSize
¿¿ 
,
¿¿ 
out
¡¡ 
int
¡¡ 

totalPages
¡¡ 
)
¡¡ 
{
¬¬ 	

totalPages
√√ 
=
√√ 
$num
√√ 
;
√√ 
int
ƒƒ 
	totalRows
ƒƒ 
=
ƒƒ 
CountOtherSites
ƒƒ +
(
ƒƒ+ ,
currentSiteId
ƒƒ, 9
)
ƒƒ9 :
;
ƒƒ: ;
if
∆∆ 
(
∆∆ 
pageSize
∆∆ 
>
∆∆ 
$num
∆∆ 
)
∆∆ 

totalPages
∆∆ (
=
∆∆) *
	totalRows
∆∆+ 4
/
∆∆5 6
pageSize
∆∆7 ?
;
∆∆? @
if
»» 
(
»» 
	totalRows
»» 
<=
»» 
pageSize
»» %
)
»»% &
{
…… 

totalPages
   
=
   
$num
   
;
   
}
ÀÀ 
else
ÃÃ 
{
ÕÕ 
int
ŒŒ 
	remainder
ŒŒ 
;
ŒŒ 
Math
œœ 
.
œœ 
DivRem
œœ 
(
œœ 
	totalRows
œœ %
,
œœ% &
pageSize
œœ' /
,
œœ/ 0
out
œœ1 4
	remainder
œœ5 >
)
œœ> ?
;
œœ? @
if
–– 
(
–– 
	remainder
–– 
>
–– 
$num
––  !
)
––! "
{
—— 

totalPages
““ 
+=
““ !
$num
““" #
;
““# $
}
”” 
}
‘‘  
SqlParameterHelper
÷÷ 
sph
÷÷ "
=
÷÷# $
new
÷÷% ( 
SqlParameterHelper
÷÷) ;
(
÷÷; <
ConnectionString
÷÷< L
.
÷÷L M%
GetReadConnectionString
÷÷M d
(
÷÷d e
)
÷÷e f
,
÷÷f g
$str÷÷h á
,÷÷á à
$num÷÷â ä
)÷÷ä ã
;÷÷ã å
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ "
(
◊◊" #
$str
◊◊# 3
,
◊◊3 4
	SqlDbType
◊◊5 >
.
◊◊> ?
Int
◊◊? B
,
◊◊B C 
ParameterDirection
◊◊D V
.
◊◊V W
Input
◊◊W \
,
◊◊\ ]
currentSiteId
◊◊^ k
)
◊◊k l
;
◊◊l m
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 0
,
ÿÿ0 1
	SqlDbType
ÿÿ2 ;
.
ÿÿ; <
Int
ÿÿ< ?
,
ÿÿ? @ 
ParameterDirection
ÿÿA S
.
ÿÿS T
Input
ÿÿT Y
,
ÿÿY Z

pageNumber
ÿÿ[ e
)
ÿÿe f
;
ÿÿf g
sph
ŸŸ 
.
ŸŸ  
DefineSqlParameter
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# .
,
ŸŸ. /
	SqlDbType
ŸŸ0 9
.
ŸŸ9 :
Int
ŸŸ: =
,
ŸŸ= > 
ParameterDirection
ŸŸ? Q
.
ŸŸQ R
Input
ŸŸR W
,
ŸŸW X
pageSize
ŸŸY a
)
ŸŸa b
;
ŸŸb c
return
⁄⁄ 
sph
⁄⁄ 
.
⁄⁄ 
ExecuteReader
⁄⁄ $
(
⁄⁄$ %
)
⁄⁄% &
;
⁄⁄& '
}
‹‹ 	
public
ﬂﬂ 
static
ﬂﬂ 
int
ﬂﬂ !
GetSiteIdByHostName
ﬂﬂ -
(
ﬂﬂ- .
string
ﬂﬂ. 4
hostName
ﬂﬂ5 =
)
ﬂﬂ= >
{
‡‡ 	 
SqlParameterHelper
·· 
sph
·· "
=
··# $
new
··% ( 
SqlParameterHelper
··) ;
(
··; <
ConnectionString
··< L
.
··L M%
GetReadConnectionString
··M d
(
··d e
)
··e f
,
··f g
$str··h â
,··â ä
$num··ã å
)··å ç
;··ç é
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ "
(
‚‚" #
$str
‚‚# .
,
‚‚. /
	SqlDbType
‚‚0 9
.
‚‚9 :
NVarChar
‚‚: B
,
‚‚B C
$num
‚‚D G
,
‚‚G H 
ParameterDirection
‚‚I [
.
‚‚[ \
Input
‚‚\ a
,
‚‚a b
hostName
‚‚c k
)
‚‚k l
;
‚‚l m
return
‰‰ 
Convert
‰‰ 
.
‰‰ 
ToInt32
‰‰ "
(
‰‰" #
sph
‰‰# &
.
‰‰& '
ExecuteScalar
‰‰' 4
(
‰‰4 5
)
‰‰5 6
)
‰‰6 7
;
‰‰7 8
}
ÊÊ 	
public
ËË 
static
ËË 
int
ËË 
GetSiteIdByFolder
ËË +
(
ËË+ ,
string
ËË, 2

folderName
ËË3 =
)
ËË= >
{
ÈÈ 	 
SqlParameterHelper
ÍÍ 
sph
ÍÍ "
=
ÍÍ# $
new
ÍÍ% ( 
SqlParameterHelper
ÍÍ) ;
(
ÍÍ; <
ConnectionString
ÍÍ< L
.
ÍÍL M%
GetReadConnectionString
ÍÍM d
(
ÍÍd e
)
ÍÍe f
,
ÍÍf g
$strÍÍh ç
,ÍÍç é
$numÍÍè ê
)ÍÍê ë
;ÍÍë í
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 0
,
ÎÎ0 1
	SqlDbType
ÎÎ2 ;
.
ÎÎ; <
NVarChar
ÎÎ< D
,
ÎÎD E
$num
ÎÎF I
,
ÎÎI J 
ParameterDirection
ÎÎK ]
.
ÎÎ] ^
Input
ÎÎ^ c
,
ÎÎc d

folderName
ÎÎe o
)
ÎÎo p
;
ÎÎp q
return
ÌÌ 
Convert
ÌÌ 
.
ÌÌ 
ToInt32
ÌÌ "
(
ÌÌ" #
sph
ÌÌ# &
.
ÌÌ& '
ExecuteScalar
ÌÌ' 4
(
ÌÌ4 5
)
ÌÌ5 6
)
ÌÌ6 7
;
ÌÌ7 8
}
ÔÔ 	
public
ÒÒ 
static
ÒÒ	 
bool
ÒÒ 
HostNameExists
ÒÒ #
(
ÒÒ# $
string
ÒÒ$ *
hostName
ÒÒ+ 3
)
ÒÒ3 4
{
ÚÚ  
SqlParameterHelper
ÛÛ 
sph
ÛÛ 
=
ÛÛ 
new
ÛÛ  
SqlParameterHelper
ÛÛ  2
(
ÛÛ2 3
ConnectionString
ÛÛ3 C
.
ÛÛC D%
GetReadConnectionString
ÛÛD [
(
ÛÛ[ \
)
ÛÛ\ ]
,
ÛÛ] ^
$str
ÛÛ_ s
,
ÛÛs t
$num
ÛÛu v
)
ÛÛv w
;
ÛÛw x
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ 
(
ÙÙ 
$str
ÙÙ %
,
ÙÙ% &
	SqlDbType
ÙÙ' 0
.
ÙÙ0 1
NVarChar
ÙÙ1 9
,
ÙÙ9 :
$num
ÙÙ; >
,
ÙÙ> ? 
ParameterDirection
ÙÙ@ R
.
ÙÙR S
Input
ÙÙS X
,
ÙÙX Y
hostName
ÙÙZ b
)
ÙÙb c
;
ÙÙc d
int
ıı 
count
ıı 
=
ıı 
Convert
ıı 
.
ıı 
ToInt32
ıı 
(
ıı 
sph
ıı "
.
ıı" #
ExecuteScalar
ıı# 0
(
ıı0 1
)
ıı1 2
)
ıı2 3
;
ıı3 4
return
ˆˆ 	
(
ˆˆ
 
count
ˆˆ 
>
ˆˆ 
$num
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
public
¯¯ 
static
¯¯	 
void
¯¯ .
 UpdateSkinVersionGuidForAllSites
¯¯ 5
(
¯¯5 6
)
¯¯6 7
{
˘˘  
SqlParameterHelper
˙˙ 
sph
˙˙ 
=
˙˙ 
new
˙˙  
SqlParameterHelper
˙˙  2
(
˙˙2 3
ConnectionString
˙˙3 C
.
˙˙C D%
GetReadConnectionString
˙˙D [
(
˙˙[ \
)
˙˙\ ]
,
˙˙] ^
$str˙˙_ ä
,˙˙ä ã
$num˙˙å ç
)˙˙ç é
;˙˙é è
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ 
(
˚˚ 
$str
˚˚ $
,
˚˚$ %
	SqlDbType
˚˚& /
.
˚˚/ 0
NVarChar
˚˚0 8
,
˚˚8 9
$num
˚˚: =
,
˚˚= > 
ParameterDirection
˚˚? Q
.
˚˚Q R
Input
˚˚R W
,
˚˚W X
Guid
˚˚Y ]
.
˚˚] ^
NewGuid
˚˚^ e
(
˚˚e f
)
˚˚f g
)
˚˚g h
;
˚˚h i
sph
˝˝ 
.
˝˝ 
ExecuteScalar
˝˝ 
(
˝˝ 
)
˝˝ 
;
˝˝ 
}
˛˛ 
}
ˇˇ 
}ÄÄ Ø8
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSiteSettingsEx.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteSettingsEx (
{ 
public 
static 
IDataReader !!
GetSiteSettingsExList" 7
(7 8
int8 ;
siteId< B
)B C
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h Ö
,
Ö Ü
$num
á à
)
à â
;
â ä
sph   
.   
DefineSqlParameter   "
(  " #
$str  # ,
,  , -
	SqlDbType  . 7
.  7 8
Int  8 ;
,  ; <
ParameterDirection  = O
.  O P
Input  P U
,  U V
siteId  W ]
)  ] ^
;  ^ _
return!! 
sph!! 
.!! 
ExecuteReader!! $
(!!$ %
)!!% &
;!!& '
}"" 	
public%% 
static%% 
void%% 
EnsureSettings%% )
(%%) *
)%%* +
{&& 	
new'' 
SqlParameterHelper'' "
(''" #
ConnectionString''# 3
.''3 4$
GetWriteConnectionString''4 L
(''L M
)''M N
,''N O
$str''P u
,''u v
$num''w x
)''x y
.''y z
ExecuteNonQuery	''z â
(
''â ä
)
''ä ã
;
''ã å
}(( 	
public** 
static** 
bool** 
SaveExpandoProperty** .
(**. /
int++ 
siteId++ 
,++ 
Guid,, 
siteGuid,, 
,,, 
string-- 
	groupName-- 
,-- 
string.. 
keyName.. 
,.. 
string// 
keyValue// 
)// 
{00 	
SqlParameterHelper11 
sph11 "
=11# $
new11% (
SqlParameterHelper11) ;
(11; <
ConnectionString11< L
.11L M$
GetWriteConnectionString11M e
(11e f
)11f g
,11g h
$str	11i Å
,
11Å Ç
$num
11É Ñ
)
11Ñ Ö
;
11Ö Ü
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# ,
,22, -
	SqlDbType22. 7
.227 8
Int228 ;
,22; <
ParameterDirection22= O
.22O P
Input22P U
,22U V
siteId22W ]
)22] ^
;22^ _
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# .
,33. /
	SqlDbType330 9
.339 :
UniqueIdentifier33: J
,33J K
ParameterDirection33L ^
.33^ _
Input33_ d
,33d e
siteGuid33f n
)33n o
;33o p
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# -
,44- .
	SqlDbType44/ 8
.448 9
NVarChar449 A
,44A B
$num44C F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
keyName44b i
)44i j
;44j k
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
NVarChar55: B
,55B C
-55D E
$num55E F
,55F G
ParameterDirection55H Z
.55Z [
Input55[ `
,55` a
keyValue55b j
)55j k
;55k l
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# /
,66/ 0
	SqlDbType661 :
.66: ;
NVarChar66; C
,66C D
$num66E H
,66H I
ParameterDirection66J \
.66\ ]
Input66] b
,66b c
keyName66d k
)66k l
;66l m
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
(99 
rowsAffected99  
>99! "
-99# $
$num99$ %
)99% &
;99& '
};; 	
public== 
static== 
bool== &
UpdateRelatedSitesProperty== 5
(==5 6
int>> 
siteId>> 
,>> 
string?? 
keyName?? 
,?? 
string@@ 
keyValue@@ 
)@@ 
{AA 	
SqlParameterHelperBB 
sphBB "
=BB# $
newBB% (
SqlParameterHelperBB) ;
(BB; <
ConnectionStringBB< L
.BBL M$
GetWriteConnectionStringBBM e
(BBe f
)BBf g
,BBg h
$str	BBi ä
,
BBä ã
$num
BBå ç
)
BBç é
;
BBé è
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# ,
,CC, -
	SqlDbTypeCC. 7
.CC7 8
IntCC8 ;
,CC; <
ParameterDirectionCC= O
.CCO P
InputCCP U
,CCU V
siteIdCCW ]
)CC] ^
;CC^ _
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# -
,DD- .
	SqlDbTypeDD/ 8
.DD8 9
NVarCharDD9 A
,DDA B
$numDDC F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
keyNameDDb i
)DDi j
;DDj k
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
NVarCharEE: B
,EEB C
-EED E
$numEEE F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
keyValueEEb j
)EEj k
;EEk l
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
(II 
rowsAffectedII  
>II! "
-II# $
$numII$ %
)II% &
;II& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !%
GetDefaultExpandoSettingsMM" ;
(MM; <
)MM< =
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh à
,
OOà â
$num
OOä ã
)
OOã å
;
OOå ç
returnPP 
sphPP 
.PP 
ExecuteReaderPP $
(PP$ %
)PP% &
;PP& '
}QQ 	
}TT 
}UU ¨˛
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteUser.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 

DBSiteUser 
{ 
public		 
static			 
IDataReader		 
GetUserList		 '
(		' (
int		( +
siteId		, 2
)		2 3
{

 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ p
,p q
$numr s
)s t
;t u
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public 
static	 
IDataReader #
GetUserCountByYearMonth 3
(3 4
int4 7
siteId8 >
)> ?
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ }
,} ~
$num	 Ä
)
Ä Å
;
Å Ç
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public 
static	 
IDataReader  
GetSmartDropDownData 0
(0 1
int1 4
siteId5 ;
,; <
string= C
queryD I
,I J
intK N
	rowsToGetO X
)X Y
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ w
,w x
$numy z
)z {
;{ |
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
sph 
. 
DefineSqlParameter 
( 
$str "
," #
	SqlDbType$ -
.- .
NVarChar. 6
,6 7
$num8 :
,: ;
ParameterDirection< N
.N O
InputO T
,T U
queryV [
)[ \
;\ ]
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
Int2 5
,5 6
ParameterDirection7 I
.I J
InputJ O
,O P
	rowsToGetQ Z
)Z [
;[ \
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public   
static  	 
IDataReader   
EmailLookup   '
(  ' (
int  ( +
siteId  , 2
,  2 3
string  4 :
query  ; @
,  @ A
int  B E
	rowsToGet  F O
)  O P
{!! 
SqlParameterHelper"" 
sph"" 
="" 
new"" 
SqlParameterHelper""  2
(""2 3
ConnectionString""3 C
.""C D#
GetReadConnectionString""D [
(""[ \
)""\ ]
,""] ^
$str""_ u
,""u v
$num""w x
)""x y
;""y z
sph## 
.## 
DefineSqlParameter## 
(## 
$str## #
,### $
	SqlDbType##% .
.##. /
Int##/ 2
,##2 3
ParameterDirection##4 F
.##F G
Input##G L
,##L M
siteId##N T
)##T U
;##U V
sph$$ 
.$$ 
DefineSqlParameter$$ 
($$ 
$str$$ "
,$$" #
	SqlDbType$$$ -
.$$- .
NVarChar$$. 6
,$$6 7
$num$$8 :
,$$: ;
ParameterDirection$$< N
.$$N O
Input$$O T
,$$T U
query$$V [
)$$[ \
;$$\ ]
sph%% 
.%% 
DefineSqlParameter%% 
(%% 
$str%% &
,%%& '
	SqlDbType%%( 1
.%%1 2
Int%%2 5
,%%5 6
ParameterDirection%%7 I
.%%I J
Input%%J O
,%%O P
	rowsToGet%%Q Z
)%%Z [
;%%[ \
return&& 	
sph&&
 
.&& 
ExecuteReader&& 
(&& 
)&& 
;&& 
}'' 
public)) 
static))	 
int)) 
	UserCount)) 
()) 
int)) !
siteId))" (
)))( )
{** 
SqlParameterHelper++ 
sph++ 
=++ 
new++ 
SqlParameterHelper++  2
(++2 3
ConnectionString++3 C
.++C D#
GetReadConnectionString++D [
(++[ \
)++\ ]
,++] ^
$str++_ o
,++o p
$num++q r
)++r s
;++s t
sph,, 
.,, 
DefineSqlParameter,, 
(,, 
$str,, #
,,,# $
	SqlDbType,,% .
.,,. /
Int,,/ 2
,,,2 3
ParameterDirection,,4 F
.,,F G
Input,,G L
,,,L M
siteId,,N T
),,T U
;,,U V
int-- 
count-- 
=-- 
Convert-- 
.-- 
ToInt32-- 
(-- 
sph-- "
.--" #
ExecuteScalar--# 0
(--0 1
)--1 2
)--2 3
;--3 4
return.. 	
count..
 
;.. 
}// 
public11 
static11	 
int11 
	UserCount11 
(11 
int11 !
siteId11" (
,11( )
string11* 0
nameBeginsWith111 ?
,11? @
string11A G
nameFilterMode11H V
)11V W
{22 
switch33 	
(33
 
nameFilterMode33 
)33 
{44 
case55 
$str55	 
:55 
default66 
:66 
SqlParameterHelper77 
sph77 
=77 
new77 !
SqlParameterHelper77" 4
(774 5
ConnectionString775 E
.77E F#
GetReadConnectionString77F ]
(77] ^
)77^ _
,77_ `
$str	77a â
,
77â ä
$num
77ã å
)
77å ç
;
77ç é
sph88 
.88 	
DefineSqlParameter88	 
(88 
$str88 %
,88% &
	SqlDbType88' 0
.880 1
Int881 4
,884 5
ParameterDirection886 H
.88H I
Input88I N
,88N O
siteId88P V
)88V W
;88W X
sph99 
.99 	
DefineSqlParameter99	 
(99 
$str99 )
,99) *
	SqlDbType99+ 4
.994 5
NVarChar995 =
,99= >
$num99? A
,99A B
ParameterDirection99C U
.99U V
Input99V [
,99[ \
nameBeginsWith99] k
)99k l
;99l m
return:: 
Convert:: 
.:: 
ToInt32:: 
(:: 
sph:: 
.::  
ExecuteScalar::  -
(::- .
)::. /
)::/ 0
;::0 1
case<< 
$str<<	 
:<< 
SqlParameterHelper== 
sph2== 
=== 
new== "
SqlParameterHelper==# 5
(==5 6
ConnectionString==6 F
.==F G#
GetReadConnectionString==G ^
(==^ _
)==_ `
,==` a
$str	==b á
,
==á à
$num
==â ä
)
==ä ã
;
==ã å
sph2>> 	
.>>	 

DefineSqlParameter>>
 
(>> 
$str>> &
,>>& '
	SqlDbType>>( 1
.>>1 2
Int>>2 5
,>>5 6
ParameterDirection>>7 I
.>>I J
Input>>J O
,>>O P
siteId>>Q W
)>>W X
;>>X Y
sph2?? 	
.??	 

DefineSqlParameter??
 
(?? 
$str?? *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ B
,??B C
ParameterDirection??D V
.??V W
Input??W \
,??\ ]
nameBeginsWith??^ l
)??l m
;??m n
return@@ 
Convert@@ 
.@@ 
ToInt32@@ 
(@@ 
sph2@@  
.@@  !
ExecuteScalar@@! .
(@@. /
)@@/ 0
)@@0 1
;@@1 2
}AA 
}BB 
publicDD 
staticDD	 
intDD -
!CountUsersByRegistrationDateRangeDD 5
(DD5 6
intEE 
siteIdEE 
,EE 
DateTimeFF 
	beginDateFF 
,FF 
DateTimeGG 
endDateGG 
)GG 
{HH 
SqlParameterHelperII 
sphII 
=II 
newII 
SqlParameterHelperII  2
(II2 3
ConnectionStringII3 C
.IIC D#
GetReadConnectionStringIID [
(II[ \
)II\ ]
,II] ^
$str	II_ Ü
,
IIÜ á
$num
IIà â
)
IIâ ä
;
IIä ã
sphJJ 
.JJ 
DefineSqlParameterJJ 
(JJ 
$strJJ #
,JJ# $
	SqlDbTypeJJ% .
.JJ. /
IntJJ/ 2
,JJ2 3
ParameterDirectionJJ4 F
.JJF G
InputJJG L
,JJL M
siteIdJJN T
)JJT U
;JJU V
sphKK 
.KK 
DefineSqlParameterKK 
(KK 
$strKK &
,KK& '
	SqlDbTypeKK( 1
.KK1 2
DateTimeKK2 :
,KK: ;
ParameterDirectionKK< N
.KKN O
InputKKO T
,KKT U
	beginDateKKV _
)KK_ `
;KK` a
sphLL 
.LL 
DefineSqlParameterLL 
(LL 
$strLL $
,LL$ %
	SqlDbTypeLL& /
.LL/ 0
DateTimeLL0 8
,LL8 9
ParameterDirectionLL: L
.LLL M
InputLLM R
,LLR S
endDateLLT [
)LL[ \
;LL\ ]
intMM 
countMM 
=MM 
ConvertMM 
.MM 
ToInt32MM 
(MM 
sphMM "
.MM" #
ExecuteScalarMM# 0
(MM0 1
)MM1 2
)MM2 3
;MM3 4
returnNN 	
countNN
 
;NN 
}OO 
publicQQ 
staticQQ	 
intQQ 
CountOnlineSinceQQ $
(QQ$ %
intQQ% (
siteIdQQ) /
,QQ/ 0
DateTimeQQ1 9
	sinceTimeQQ: C
)QQC D
{RR 
SqlParameterHelperSS 
sphSS 
=SS 
newSS 
SqlParameterHelperSS  2
(SS2 3
ConnectionStringSS3 C
.SSC D#
GetReadConnectionStringSSD [
(SS[ \
)SS\ ]
,SS] ^
$strSS_ ~
,SS~ 
$num
SSÄ Å
)
SSÅ Ç
;
SSÇ É
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT #
,TT# $
	SqlDbTypeTT% .
.TT. /
IntTT/ 2
,TT2 3
ParameterDirectionTT4 F
.TTF G
InputTTG L
,TTL M
siteIdTTN T
)TTT U
;TTU V
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU &
,UU& '
	SqlDbTypeUU( 1
.UU1 2
DateTimeUU2 :
,UU: ;
ParameterDirectionUU< N
.UUN O
InputUUO T
,UUT U
	sinceTimeUUV _
)UU_ `
;UU` a
intVV 
countVV 
=VV 
ConvertVV 
.VV 
ToInt32VV 
(VV 
sphVV "
.VV" #
ExecuteScalarVV# 0
(VV0 1
)VV1 2
)VV2 3
;VV3 4
returnWW 	
countWW
 
;WW 
}XX 
publicZZ 
staticZZ	 
IDataReaderZZ 
GetUsersOnlineSinceZZ /
(ZZ/ 0
intZZ0 3
siteIdZZ4 :
,ZZ: ;
DateTimeZZ< D
	sinceTimeZZE N
)ZZN O
{[[ 
SqlParameterHelper\\ 
sph\\ 
=\\ 
new\\ 
SqlParameterHelper\\  2
(\\2 3
ConnectionString\\3 C
.\\C D#
GetReadConnectionString\\D [
(\\[ \
)\\\ ]
,\\] ^
$str	\\_ Ñ
,
\\Ñ Ö
$num
\\Ü á
)
\\á à
;
\\à â
sph]] 
.]] 
DefineSqlParameter]] 
(]] 
$str]] #
,]]# $
	SqlDbType]]% .
.]]. /
Int]]/ 2
,]]2 3
ParameterDirection]]4 F
.]]F G
Input]]G L
,]]L M
siteId]]N T
)]]T U
;]]U V
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ &
,^^& '
	SqlDbType^^( 1
.^^1 2
DateTime^^2 :
,^^: ;
ParameterDirection^^< N
.^^N O
Input^^O T
,^^T U
	sinceTime^^V _
)^^_ `
;^^` a
return__ 	
sph__
 
.__ 
ExecuteReader__ 
(__ 
)__ 
;__ 
}`` 
publicbb 
staticbb	 
IDataReaderbb $
GetTop50UsersOnlineSincebb 4
(bb4 5
intbb5 8
siteIdbb9 ?
,bb? @
DateTimebbA I
	sinceTimebbJ S
)bbS T
{cc 
SqlParameterHelperdd 
sphdd 
=dd 
newdd 
SqlParameterHelperdd  2
(dd2 3
ConnectionStringdd3 C
.ddC D#
GetReadConnectionStringddD [
(dd[ \
)dd\ ]
,dd] ^
$str	dd_ â
,
ddâ ä
$num
ddã å
)
ddå ç
;
ddç é
sphee 
.ee 
DefineSqlParameteree 
(ee 
$stree #
,ee# $
	SqlDbTypeee% .
.ee. /
Intee/ 2
,ee2 3
ParameterDirectionee4 F
.eeF G
InputeeG L
,eeL M
siteIdeeN T
)eeT U
;eeU V
sphff 
.ff 
DefineSqlParameterff 
(ff 
$strff &
,ff& '
	SqlDbTypeff( 1
.ff1 2
DateTimeff2 :
,ff: ;
ParameterDirectionff< N
.ffN O
InputffO T
,ffT U
	sinceTimeffV _
)ff_ `
;ff` a
returngg 	
sphgg
 
.gg 
ExecuteReadergg 
(gg 
)gg 
;gg 
}hh 
publickk 
statickk	 
intkk 
GetNewestUserIdkk #
(kk# $
intkk$ '
siteIdkk( .
)kk. /
{ll 
SqlParameterHelpermm 
sphmm 
=mm 
newmm 
SqlParameterHelpermm  2
(mm2 3
ConnectionStringmm3 C
.mmC D#
GetReadConnectionStringmmD [
(mm[ \
)mm\ ]
,mm] ^
$strmm_ y
,mmy z
$nummm{ |
)mm| }
;mm} ~
sphnn 
.nn 
DefineSqlParameternn 
(nn 
$strnn #
,nn# $
	SqlDbTypenn% .
.nn. /
Intnn/ 2
,nn2 3
ParameterDirectionnn4 F
.nnF G
InputnnG L
,nnL M
siteIdnnN T
)nnT U
;nnU V
intoo 
countoo 
=oo 
Convertoo 
.oo 
ToInt32oo 
(oo 
sphoo "
.oo" #
ExecuteScalaroo# 0
(oo0 1
)oo1 2
)oo2 3
;oo3 4
returnpp 	
countpp
 
;pp 
}qq 
publicss 
staticss	 
IDataReaderss 
GetUserListPagess +
(ss+ ,
inttt 
siteIdtt 
,tt 
intuu 

pageNumberuu 
,uu 
intvv 
pageSizevv 
,vv 
stringww 	

beginsWithww
 
,ww 
intxx 
sortModexx 
,xx 
stringyy 	
nameFilterModeyy
 
,yy 
outzz 
intzz 


totalPageszz 
){{ 
{|| 

totalPages}} 
=}} 
$num}} 
;}} 
int~~ 
	totalRows~~ 
=~~ 
	UserCount~~ 
(~~ 
siteId~~ #
,~~# $

beginsWith~~% /
,~~/ 0
nameFilterMode~~1 ?
)~~? @
;~~@ A
if
ÄÄ 
(
ÄÄ 
pageSize
ÄÄ 
>
ÄÄ 
$num
ÄÄ 
)
ÄÄ 

totalPages
ÅÅ 
=
ÅÅ 
	totalRows
ÅÅ 
/
ÅÅ 
pageSize
ÅÅ %
;
ÅÅ% &
if
ÉÉ 
(
ÉÉ 
	totalRows
ÉÉ 
<=
ÉÉ 
pageSize
ÉÉ 
)
ÉÉ 
{
ÑÑ 

totalPages
ÖÖ 
=
ÖÖ 
$num
ÖÖ 
;
ÖÖ 
}
ÜÜ 
else
áá 
{
àà 
Math
ââ 
.
ââ 	
DivRem
ââ	 
(
ââ 
	totalRows
ââ 
,
ââ 
pageSize
ââ #
,
ââ# $
out
ââ% (
int
ââ) ,
	remainder
ââ- 6
)
ââ6 7
;
ââ7 8
if
ää 
(
ää 
	remainder
ää 
>
ää 
$num
ää 
)
ää 
{
ãã 

totalPages
åå 
+=
åå 
$num
åå 
;
åå 
}
çç 
}
éé  
SqlParameterHelper
§§ 
sph
§§ 
=
§§ 
new
§§  
SqlParameterHelper
§§  2
(
§§2 3
ConnectionString
§§3 C
.
§§C D%
GetReadConnectionString
§§D [
(
§§[ \
)
§§\ ]
,
§§] ^
$str
§§_ t
,
§§t u
$num
§§v w
)
§§w x
;
§§x y
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ 
(
¶¶ 
$str
¶¶ '
,
¶¶' (
	SqlDbType
¶¶) 2
.
¶¶2 3
Int
¶¶3 6
,
¶¶6 7 
ParameterDirection
¶¶8 J
.
¶¶J K
Input
¶¶K P
,
¶¶P Q

pageNumber
¶¶R \
)
¶¶\ ]
;
¶¶] ^
sph
ßß 
.
ßß  
DefineSqlParameter
ßß 
(
ßß 
$str
ßß %
,
ßß% &
	SqlDbType
ßß' 0
.
ßß0 1
Int
ßß1 4
,
ßß4 5 
ParameterDirection
ßß6 H
.
ßßH I
Input
ßßI N
,
ßßN O
pageSize
ßßP X
)
ßßX Y
;
ßßY Z
sph
®® 
.
®®  
DefineSqlParameter
®® 
(
®® 
$str
®® '
,
®®' (
	SqlDbType
®®) 2
.
®®2 3
NVarChar
®®3 ;
,
®®; <
$num
®®= ?
,
®®? @ 
ParameterDirection
®®A S
.
®®S T
Input
®®T Y
,
®®Y Z

beginsWith
®®[ e
)
®®e f
;
®®f g
sph
©© 
.
©©  
DefineSqlParameter
©© 
(
©© 
$str
©© #
,
©©# $
	SqlDbType
©©% .
.
©©. /
Int
©©/ 2
,
©©2 3 
ParameterDirection
©©4 F
.
©©F G
Input
©©G L
,
©©L M
siteId
©©N T
)
©©T U
;
©©U V
sph
™™ 
.
™™  
DefineSqlParameter
™™ 
(
™™ 
$str
™™ %
,
™™% &
	SqlDbType
™™' 0
.
™™0 1
Int
™™1 4
,
™™4 5 
ParameterDirection
™™6 H
.
™™H I
Input
™™I N
,
™™N O
sortMode
™™P X
)
™™X Y
;
™™Y Z
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ +
,
´´+ ,
	SqlDbType
´´- 6
.
´´6 7
NVarChar
´´7 ?
,
´´? @
$num
´´A C
,
´´C D 
ParameterDirection
´´E W
.
´´W X
Input
´´X ]
,
´´] ^
nameFilterMode
´´_ m
)
´´m n
;
´´n o
return
≠≠ 	
sph
≠≠
 
.
≠≠ 
ExecuteReader
≠≠ 
(
≠≠ 
)
≠≠ 
;
≠≠ 
}
ÆÆ 
private
∞∞ 	
static
∞∞
 
int
∞∞ 
CountForSearch
∞∞ #
(
∞∞# $
int
∞∞$ '
siteId
∞∞( .
,
∞∞. /
string
∞∞0 6
searchInput
∞∞7 B
)
∞∞B C
{
±±  
SqlParameterHelper
≤≤ 
sph
≤≤ 
=
≤≤ 
new
≤≤  
SqlParameterHelper
≤≤  2
(
≤≤2 3
ConnectionString
≤≤3 C
.
≤≤C D%
GetReadConnectionString
≤≤D [
(
≤≤[ \
)
≤≤\ ]
,
≤≤] ^
$str
≤≤_ x
,
≤≤x y
$num
≤≤z {
)
≤≤{ |
;
≤≤| }
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ 
(
≥≥ 
$str
≥≥ #
,
≥≥# $
	SqlDbType
≥≥% .
.
≥≥. /
Int
≥≥/ 2
,
≥≥2 3 
ParameterDirection
≥≥4 F
.
≥≥F G
Input
≥≥G L
,
≥≥L M
siteId
≥≥N T
)
≥≥T U
;
≥≥U V
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ 
(
¥¥ 
$str
¥¥ (
,
¥¥( )
	SqlDbType
¥¥* 3
.
¥¥3 4
NVarChar
¥¥4 <
,
¥¥< =
$num
¥¥> @
,
¥¥@ A 
ParameterDirection
¥¥B T
.
¥¥T U
Input
¥¥U Z
,
¥¥Z [
searchInput
¥¥\ g
)
¥¥g h
;
¥¥h i
int
µµ 
count
µµ 
=
µµ 
Convert
µµ 
.
µµ 
ToInt32
µµ 
(
µµ 
sph
µµ "
.
µµ" #
ExecuteScalar
µµ# 0
(
µµ0 1
)
µµ1 2
)
µµ2 3
;
µµ3 4
return
∂∂ 	
count
∂∂
 
;
∂∂ 
}
∑∑ 
public
ππ 
static
ππ	 
IDataReader
ππ 
GetUserSearchPage
ππ -
(
ππ- .
int
∫∫ 
siteId
∫∫ 
,
∫∫ 
int
ªª 

pageNumber
ªª 
,
ªª 
int
ºº 
pageSize
ºº 
,
ºº 
string
ΩΩ 	
searchInput
ΩΩ
 
,
ΩΩ 
int
ææ 
sortMode
ææ 
,
ææ 
out
øø 
int
øø 


totalPages
øø 
)
øø 
{
¿¿ 

totalPages
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
int
¬¬ 
	totalRows
¬¬ 
=
¬¬ 
CountForSearch
¬¬ !
(
¬¬! "
siteId
¬¬" (
,
¬¬( )
searchInput
¬¬* 5
)
¬¬5 6
;
¬¬6 7
if
ƒƒ 
(
ƒƒ 
pageSize
ƒƒ 
>
ƒƒ 
$num
ƒƒ 
)
ƒƒ 

totalPages
≈≈ 
=
≈≈ 
	totalRows
≈≈ 
/
≈≈ 
pageSize
≈≈ %
;
≈≈% &
if
«« 
(
«« 
	totalRows
«« 
<=
«« 
pageSize
«« 
)
«« 
{
»» 

totalPages
…… 
=
…… 
$num
…… 
;
…… 
}
   
else
ÀÀ 
{
ÃÃ 
int
ÕÕ 
	remainder
ÕÕ 
;
ÕÕ 
Math
ŒŒ 
.
ŒŒ 	
DivRem
ŒŒ	 
(
ŒŒ 
	totalRows
ŒŒ 
,
ŒŒ 
pageSize
ŒŒ #
,
ŒŒ# $
out
ŒŒ% (
	remainder
ŒŒ) 2
)
ŒŒ2 3
;
ŒŒ3 4
if
œœ 
(
œœ 
	remainder
œœ 
>
œœ 
$num
œœ 
)
œœ 
{
–– 

totalPages
—— 
+=
—— 
$num
—— 
;
—— 
}
““ 
}
””  
SqlParameterHelper
’’ 
sph
’’ 
;
’’ 
switch
◊◊ 	
(
◊◊
 
sortMode
◊◊ 
)
◊◊ 
{
ÿÿ 
case
ŸŸ 
$num
ŸŸ	 

:
ŸŸ
 
sph
⁄⁄ 
=
⁄⁄	 

new
⁄⁄  
SqlParameterHelper
⁄⁄ !
(
⁄⁄! "
ConnectionString
⁄⁄" 2
.
⁄⁄2 3%
GetReadConnectionString
⁄⁄3 J
(
⁄⁄J K
)
⁄⁄K L
,
⁄⁄L M
$str
⁄⁄N s
,
⁄⁄s t
$num
⁄⁄u v
)
⁄⁄v w
;
⁄⁄w x
break
€€ 

;
€€
 
case
›› 
$num
››	 

:
››
 
sph
ﬁﬁ 
=
ﬁﬁ	 

new
ﬁﬁ  
SqlParameterHelper
ﬁﬁ !
(
ﬁﬁ! "
ConnectionString
ﬁﬁ" 2
.
ﬁﬁ2 3%
GetReadConnectionString
ﬁﬁ3 J
(
ﬁﬁJ K
)
ﬁﬁK L
,
ﬁﬁL M
$str
ﬁﬁN m
,
ﬁﬁm n
$num
ﬁﬁo p
)
ﬁﬁp q
;
ﬁﬁq r
break
ﬂﬂ 

;
ﬂﬂ
 
case
·· 
$num
··	 

:
··
 
default
‚‚ 
:
‚‚ 
sph
„„ 
=
„„	 

new
„„  
SqlParameterHelper
„„ !
(
„„! "
ConnectionString
„„" 2
.
„„2 3%
GetReadConnectionString
„„3 J
(
„„J K
)
„„K L
,
„„L M
$str
„„N i
,
„„i j
$num
„„k l
)
„„l m
;
„„m n
break
‰‰ 

;
‰‰
 
}
ÂÂ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ 
(
ÈÈ 
$str
ÈÈ #
,
ÈÈ# $
	SqlDbType
ÈÈ% .
.
ÈÈ. /
Int
ÈÈ/ 2
,
ÈÈ2 3 
ParameterDirection
ÈÈ4 F
.
ÈÈF G
Input
ÈÈG L
,
ÈÈL M
siteId
ÈÈN T
)
ÈÈT U
;
ÈÈU V
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ 
(
ÍÍ 
$str
ÍÍ (
,
ÍÍ( )
	SqlDbType
ÍÍ* 3
.
ÍÍ3 4
NVarChar
ÍÍ4 <
,
ÍÍ< =
$num
ÍÍ> @
,
ÍÍ@ A 
ParameterDirection
ÍÍB T
.
ÍÍT U
Input
ÍÍU Z
,
ÍÍZ [
searchInput
ÍÍ\ g
)
ÍÍg h
;
ÍÍh i
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ 
(
ÎÎ 
$str
ÎÎ '
,
ÎÎ' (
	SqlDbType
ÎÎ) 2
.
ÎÎ2 3
Int
ÎÎ3 6
,
ÎÎ6 7 
ParameterDirection
ÎÎ8 J
.
ÎÎJ K
Input
ÎÎK P
,
ÎÎP Q

pageNumber
ÎÎR \
)
ÎÎ\ ]
;
ÎÎ] ^
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ 
(
ÏÏ 
$str
ÏÏ %
,
ÏÏ% &
	SqlDbType
ÏÏ' 0
.
ÏÏ0 1
Int
ÏÏ1 4
,
ÏÏ4 5 
ParameterDirection
ÏÏ6 H
.
ÏÏH I
Input
ÏÏI N
,
ÏÏN O
pageSize
ÏÏP X
)
ÏÏX Y
;
ÏÏY Z
return
ÌÌ 	
sph
ÌÌ
 
.
ÌÌ 
ExecuteReader
ÌÌ 
(
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÔÔ 
private
ÒÒ 	
static
ÒÒ
 
int
ÒÒ !
CountForAdminSearch
ÒÒ (
(
ÒÒ( )
int
ÒÒ) ,
siteId
ÒÒ- 3
,
ÒÒ3 4
string
ÒÒ5 ;
searchInput
ÒÒ< G
)
ÒÒG H
{
ÚÚ  
SqlParameterHelper
ÛÛ 
sph
ÛÛ 
=
ÛÛ 
new
ÛÛ  
SqlParameterHelper
ÛÛ  2
(
ÛÛ2 3
ConnectionString
ÛÛ3 C
.
ÛÛC D%
GetReadConnectionString
ÛÛD [
(
ÛÛ[ \
)
ÛÛ\ ]
,
ÛÛ] ^
$str
ÛÛ_ }
,
ÛÛ} ~
$numÛÛ Ä
)ÛÛÄ Å
;ÛÛÅ Ç
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ 
(
ÙÙ 
$str
ÙÙ #
,
ÙÙ# $
	SqlDbType
ÙÙ% .
.
ÙÙ. /
Int
ÙÙ/ 2
,
ÙÙ2 3 
ParameterDirection
ÙÙ4 F
.
ÙÙF G
Input
ÙÙG L
,
ÙÙL M
siteId
ÙÙN T
)
ÙÙT U
;
ÙÙU V
sph
ıı 
.
ıı  
DefineSqlParameter
ıı 
(
ıı 
$str
ıı (
,
ıı( )
	SqlDbType
ıı* 3
.
ıı3 4
NVarChar
ıı4 <
,
ıı< =
$num
ıı> @
,
ıı@ A 
ParameterDirection
ııB T
.
ııT U
Input
ııU Z
,
ııZ [
searchInput
ıı\ g
)
ııg h
;
ııh i
int
ˆˆ 
count
ˆˆ 
=
ˆˆ 
Convert
ˆˆ 
.
ˆˆ 
ToInt32
ˆˆ 
(
ˆˆ 
sph
ˆˆ "
.
ˆˆ" #
ExecuteScalar
ˆˆ# 0
(
ˆˆ0 1
)
ˆˆ1 2
)
ˆˆ2 3
;
ˆˆ3 4
return
˜˜ 	
count
˜˜
 
;
˜˜ 
}
¯¯ 
public
˙˙ 
static
˙˙	 
IDataReader
˙˙ $
GetUserAdminSearchPage
˙˙ 2
(
˙˙2 3
int
˚˚ 
siteId
˚˚ 
,
˚˚ 
int
¸¸ 

pageNumber
¸¸ 
,
¸¸ 
int
˝˝ 
pageSize
˝˝ 
,
˝˝ 
string
˛˛ 	
searchInput
˛˛
 
,
˛˛ 
int
ˇˇ 
sortMode
ˇˇ 
,
ˇˇ 
out
ÄÄ 
int
ÄÄ 


totalPages
ÄÄ 
)
ÄÄ 
{
ÅÅ 

totalPages
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
int
ÉÉ 
	totalRows
ÉÉ 
=
ÉÉ !
CountForAdminSearch
ÉÉ &
(
ÉÉ& '
siteId
ÉÉ' -
,
ÉÉ- .
searchInput
ÉÉ/ :
)
ÉÉ: ;
;
ÉÉ; <
if
ÖÖ 
(
ÖÖ 
pageSize
ÖÖ 
>
ÖÖ 
$num
ÖÖ 
)
ÖÖ 

totalPages
ÜÜ 
=
ÜÜ 
	totalRows
ÜÜ 
/
ÜÜ 
pageSize
ÜÜ %
;
ÜÜ% &
if
àà 
(
àà 
	totalRows
àà 
<=
àà 
pageSize
àà 
)
àà 
{
ââ 

totalPages
ää 
=
ää 
$num
ää 
;
ää 
}
ãã 
else
åå 
{
çç 
int
éé 
	remainder
éé 
;
éé 
Math
èè 
.
èè 	
DivRem
èè	 
(
èè 
	totalRows
èè 
,
èè 
pageSize
èè #
,
èè# $
out
èè% (
	remainder
èè) 2
)
èè2 3
;
èè3 4
if
êê 
(
êê 
	remainder
êê 
>
êê 
$num
êê 
)
êê 
{
ëë 

totalPages
íí 
+=
íí 
$num
íí 
;
íí 
}
ìì 
}
îî  
SqlParameterHelper
ññ 
sph
ññ 
;
ññ 
switch
òò 	
(
òò
 
sortMode
òò 
)
òò 
{
ôô 
case
öö 
$num
öö	 

:
öö
 
sph
õõ 
=
õõ	 

new
õõ  
SqlParameterHelper
õõ !
(
õõ! "
ConnectionString
õõ" 2
.
õõ2 3%
GetReadConnectionString
õõ3 J
(
õõJ K
)
õõK L
,
õõL M
$str
õõN x
,
õõx y
$num
õõz {
)
õõ{ |
;
õõ| }
break
úú 

;
úú
 
case
ûû 
$num
ûû	 

:
ûû
 
sph
üü 
=
üü	 

new
üü  
SqlParameterHelper
üü !
(
üü! "
ConnectionString
üü" 2
.
üü2 3%
GetReadConnectionString
üü3 J
(
üüJ K
)
üüK L
,
üüL M
$str
üüN r
,
üür s
$num
üüt u
)
üüu v
;
üüv w
break
†† 

;
††
 
case
¢¢ 
$num
¢¢	 

:
¢¢
 
default
££ 
:
££ 
sph
§§ 
=
§§	 

new
§§  
SqlParameterHelper
§§ !
(
§§! "
ConnectionString
§§" 2
.
§§2 3%
GetReadConnectionString
§§3 J
(
§§J K
)
§§K L
,
§§L M
$str
§§N n
,
§§n o
$num
§§p q
)
§§q r
;
§§r s
break
•• 

;
••
 
}
¶¶ 
sph
™™ 
.
™™  
DefineSqlParameter
™™ 
(
™™ 
$str
™™ #
,
™™# $
	SqlDbType
™™% .
.
™™. /
Int
™™/ 2
,
™™2 3 
ParameterDirection
™™4 F
.
™™F G
Input
™™G L
,
™™L M
siteId
™™N T
)
™™T U
;
™™U V
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ (
,
´´( )
	SqlDbType
´´* 3
.
´´3 4
NVarChar
´´4 <
,
´´< =
$num
´´> @
,
´´@ A 
ParameterDirection
´´B T
.
´´T U
Input
´´U Z
,
´´Z [
searchInput
´´\ g
)
´´g h
;
´´h i
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ 
(
¨¨ 
$str
¨¨ '
,
¨¨' (
	SqlDbType
¨¨) 2
.
¨¨2 3
Int
¨¨3 6
,
¨¨6 7 
ParameterDirection
¨¨8 J
.
¨¨J K
Input
¨¨K P
,
¨¨P Q

pageNumber
¨¨R \
)
¨¨\ ]
;
¨¨] ^
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ 
(
≠≠ 
$str
≠≠ %
,
≠≠% &
	SqlDbType
≠≠' 0
.
≠≠0 1
Int
≠≠1 4
,
≠≠4 5 
ParameterDirection
≠≠6 H
.
≠≠H I
Input
≠≠I N
,
≠≠N O
pageSize
≠≠P X
)
≠≠X Y
;
≠≠Y Z
return
ÆÆ 	
sph
ÆÆ
 
.
ÆÆ 
ExecuteReader
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
∞∞ 
public
≤≤ 
static
≤≤	 
int
≤≤ !
CountLockedOutUsers
≤≤ '
(
≤≤' (
int
≤≤( +
siteId
≤≤, 2
)
≤≤2 3
{
≥≥  
SqlParameterHelper
¥¥ 
sph
¥¥ 
=
¥¥ 
new
¥¥  
SqlParameterHelper
¥¥  2
(
¥¥2 3
ConnectionString
¥¥3 C
.
¥¥C D%
GetReadConnectionString
¥¥D [
(
¥¥[ \
)
¥¥\ ]
,
¥¥] ^
$str
¥¥_ u
,
¥¥u v
$num
¥¥w x
)
¥¥x y
;
¥¥y z
sph
µµ 
.
µµ  
DefineSqlParameter
µµ 
(
µµ 
$str
µµ #
,
µµ# $
	SqlDbType
µµ% .
.
µµ. /
Int
µµ/ 2
,
µµ2 3 
ParameterDirection
µµ4 F
.
µµF G
Input
µµG L
,
µµL M
siteId
µµN T
)
µµT U
;
µµU V
int
∑∑ 
count
∑∑ 
=
∑∑ 
Convert
∑∑ 
.
∑∑ 
ToInt32
∑∑ 
(
∑∑ 
sph
∑∑ "
.
∑∑" #
ExecuteScalar
∑∑# 0
(
∑∑0 1
)
∑∑1 2
)
∑∑2 3
;
∑∑3 4
return
∏∏ 	
count
∏∏
 
;
∏∏ 
}
ππ 
public
ªª 
static
ªª	 
IDataReader
ªª  
GetPageLockedUsers
ªª .
(
ªª. /
int
ºº 
siteId
ºº 
,
ºº 
int
ΩΩ 

pageNumber
ΩΩ 
,
ΩΩ 
int
ææ 
pageSize
ææ 
,
ææ 
out
øø 
int
øø 


totalPages
øø 
)
øø 
{
¿¿ 

totalPages
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
int
¬¬ 
	totalRows
¬¬ 
=
¬¬ !
CountLockedOutUsers
¬¬ &
(
¬¬& '
siteId
¬¬' -
)
¬¬- .
;
¬¬. /
if
ƒƒ 
(
ƒƒ 
pageSize
ƒƒ 
>
ƒƒ 
$num
ƒƒ 
)
ƒƒ 

totalPages
≈≈ 
=
≈≈ 
	totalRows
≈≈ 
/
≈≈ 
pageSize
≈≈ %
;
≈≈% &
if
«« 
(
«« 
	totalRows
«« 
<=
«« 
pageSize
«« 
)
«« 
{
»» 

totalPages
…… 
=
…… 
$num
…… 
;
…… 
}
   
else
ÀÀ 
{
ÃÃ 
int
ÕÕ 
	remainder
ÕÕ 
;
ÕÕ 
Math
ŒŒ 
.
ŒŒ 	
DivRem
ŒŒ	 
(
ŒŒ 
	totalRows
ŒŒ 
,
ŒŒ 
pageSize
ŒŒ #
,
ŒŒ# $
out
ŒŒ% (
	remainder
ŒŒ) 2
)
ŒŒ2 3
;
ŒŒ3 4
if
œœ 
(
œœ 
	remainder
œœ 
>
œœ 
$num
œœ 
)
œœ 
{
–– 

totalPages
—— 
+=
—— 
$num
—— 
;
—— 
}
““ 
}
””  
SqlParameterHelper
’’ 
sph
’’ 
=
’’ 
new
’’  
SqlParameterHelper
’’  2
(
’’2 3
ConnectionString
’’3 C
.
’’C D%
GetReadConnectionString
’’D [
(
’’[ \
)
’’\ ]
,
’’] ^
$str
’’_ z
,
’’z {
$num
’’| }
)
’’} ~
;
’’~ 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ 
(
÷÷ 
$str
÷÷ #
,
÷÷# $
	SqlDbType
÷÷% .
.
÷÷. /
Int
÷÷/ 2
,
÷÷2 3 
ParameterDirection
÷÷4 F
.
÷÷F G
Input
÷÷G L
,
÷÷L M
siteId
÷÷N T
)
÷÷T U
;
÷÷U V
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ 
(
◊◊ 
$str
◊◊ '
,
◊◊' (
	SqlDbType
◊◊) 2
.
◊◊2 3
Int
◊◊3 6
,
◊◊6 7 
ParameterDirection
◊◊8 J
.
◊◊J K
Input
◊◊K P
,
◊◊P Q

pageNumber
◊◊R \
)
◊◊\ ]
;
◊◊] ^
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ 
(
ÿÿ 
$str
ÿÿ %
,
ÿÿ% &
	SqlDbType
ÿÿ' 0
.
ÿÿ0 1
Int
ÿÿ1 4
,
ÿÿ4 5 
ParameterDirection
ÿÿ6 H
.
ÿÿH I
Input
ÿÿI N
,
ÿÿN O
pageSize
ÿÿP X
)
ÿÿX Y
;
ÿÿY Z
return
ŸŸ 	
sph
ŸŸ
 
.
ŸŸ 
ExecuteReader
ŸŸ 
(
ŸŸ 
)
ŸŸ 
;
ŸŸ 
}
€€ 
public
›› 
static
››	 
int
›› #
CountNotApprovedUsers
›› )
(
››) *
int
››* -
siteId
››. 4
)
››4 5
{
ﬁﬁ  
SqlParameterHelper
ﬂﬂ 
sph
ﬂﬂ 
=
ﬂﬂ 
new
ﬂﬂ  
SqlParameterHelper
ﬂﬂ  2
(
ﬂﬂ2 3
ConnectionString
ﬂﬂ3 C
.
ﬂﬂC D%
GetReadConnectionString
ﬂﬂD [
(
ﬂﬂ[ \
)
ﬂﬂ\ ]
,
ﬂﬂ] ^
$str
ﬂﬂ_ z
,
ﬂﬂz {
$num
ﬂﬂ| }
)
ﬂﬂ} ~
;
ﬂﬂ~ 
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ 
(
‡‡ 
$str
‡‡ #
,
‡‡# $
	SqlDbType
‡‡% .
.
‡‡. /
Int
‡‡/ 2
,
‡‡2 3 
ParameterDirection
‡‡4 F
.
‡‡F G
Input
‡‡G L
,
‡‡L M
siteId
‡‡N T
)
‡‡T U
;
‡‡U V
int
‚‚ 
count
‚‚ 
=
‚‚ 
Convert
‚‚ 
.
‚‚ 
ToInt32
‚‚ 
(
‚‚ 
sph
‚‚ "
.
‚‚" #
ExecuteScalar
‚‚# 0
(
‚‚0 1
)
‚‚1 2
)
‚‚2 3
;
‚‚3 4
return
„„ 	
count
„„
 
;
„„ 
}
‰‰ 
public
ÊÊ 
static
ÊÊ	 
IDataReader
ÊÊ %
GetPageNotApprovedUsers
ÊÊ 3
(
ÊÊ3 4
int
ÁÁ 
siteId
ÁÁ 
,
ÁÁ 
int
ËË 

pageNumber
ËË 
,
ËË 
int
ÈÈ 
pageSize
ÈÈ 
,
ÈÈ 
out
ÍÍ 
int
ÍÍ 


totalPages
ÍÍ 
)
ÍÍ 
{
ÎÎ 

totalPages
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
int
ÌÌ 
	totalRows
ÌÌ 
=
ÌÌ #
CountNotApprovedUsers
ÌÌ (
(
ÌÌ( )
siteId
ÌÌ) /
)
ÌÌ/ 0
;
ÌÌ0 1
if
ÔÔ 
(
ÔÔ 
pageSize
ÔÔ 
>
ÔÔ 
$num
ÔÔ 
)
ÔÔ 

totalPages
 
=
 
	totalRows
 
/
 
pageSize
 %
;
% &
if
ÚÚ 
(
ÚÚ 
	totalRows
ÚÚ 
<=
ÚÚ 
pageSize
ÚÚ 
)
ÚÚ 
{
ÛÛ 

totalPages
ÙÙ 
=
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
}
ıı 
else
ˆˆ 
{
˜˜ 
int
¯¯ 
	remainder
¯¯ 
;
¯¯ 
Math
˘˘ 
.
˘˘ 	
DivRem
˘˘	 
(
˘˘ 
	totalRows
˘˘ 
,
˘˘ 
pageSize
˘˘ #
,
˘˘# $
out
˘˘% (
	remainder
˘˘) 2
)
˘˘2 3
;
˘˘3 4
if
˙˙ 
(
˙˙ 
	remainder
˙˙ 
>
˙˙ 
$num
˙˙ 
)
˙˙ 
{
˚˚ 

totalPages
¸¸ 
+=
¸¸ 
$num
¸¸ 
;
¸¸ 
}
˝˝ 
}
˛˛  
SqlParameterHelper
ÄÄ 
sph
ÄÄ 
=
ÄÄ 
new
ÄÄ  
SqlParameterHelper
ÄÄ  2
(
ÄÄ2 3
ConnectionString
ÄÄ3 C
.
ÄÄC D%
GetReadConnectionString
ÄÄD [
(
ÄÄ[ \
)
ÄÄ\ ]
,
ÄÄ] ^
$str
ÄÄ_ 
,ÄÄ Ä
$numÄÄÅ Ç
)ÄÄÇ É
;ÄÄÉ Ñ
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ 
(
ÅÅ 
$str
ÅÅ #
,
ÅÅ# $
	SqlDbType
ÅÅ% .
.
ÅÅ. /
Int
ÅÅ/ 2
,
ÅÅ2 3 
ParameterDirection
ÅÅ4 F
.
ÅÅF G
Input
ÅÅG L
,
ÅÅL M
siteId
ÅÅN T
)
ÅÅT U
;
ÅÅU V
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ 
(
ÇÇ 
$str
ÇÇ '
,
ÇÇ' (
	SqlDbType
ÇÇ) 2
.
ÇÇ2 3
Int
ÇÇ3 6
,
ÇÇ6 7 
ParameterDirection
ÇÇ8 J
.
ÇÇJ K
Input
ÇÇK P
,
ÇÇP Q

pageNumber
ÇÇR \
)
ÇÇ\ ]
;
ÇÇ] ^
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ %
,
ÉÉ% &
	SqlDbType
ÉÉ' 0
.
ÉÉ0 1
Int
ÉÉ1 4
,
ÉÉ4 5 
ParameterDirection
ÉÉ6 H
.
ÉÉH I
Input
ÉÉI N
,
ÉÉN O
pageSize
ÉÉP X
)
ÉÉX Y
;
ÉÉY Z
return
ÑÑ 	
sph
ÑÑ
 
.
ÑÑ 
ExecuteReader
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÜÜ 
public
´´ 
static
´´	 
int
´´ 
AddUser
´´ 
(
´´ 
Guid
¨¨ 
siteGuid
¨¨ 
,
¨¨ 
int
≠≠ 
siteId
≠≠ 
,
≠≠ 
string
ÆÆ 	
fullName
ÆÆ
 
,
ÆÆ 
String
ØØ 	
	loginName
ØØ
 
,
ØØ 
string
∞∞ 	
email
∞∞
 
,
∞∞ 
string
±± 	
password
±±
 
,
±± 
string
≤≤ 	
passwordSalt
≤≤
 
,
≤≤ 
Guid
≥≥ 
userGuid
≥≥ 
,
≥≥ 
DateTime
¥¥ 
dateCreated
¥¥ 
,
¥¥ 
bool
µµ 
mustChangePwd
µµ 
,
µµ 
string
∂∂ 	
	firstName
∂∂
 
,
∂∂ 
string
∑∑ 	
lastName
∑∑
 
,
∑∑ 
string
∏∏ 	

timeZoneId
∏∏
 
,
∏∏ 
DateTime
ππ 
dateOfBirth
ππ 
,
ππ 
bool
∫∫ 
emailConfirmed
∫∫ 
,
∫∫ 
int
ªª 
	pwdFormat
ªª 
,
ªª 
string
ºº 	
passwordHash
ºº
 
,
ºº 
string
ΩΩ 	
securityStamp
ΩΩ
 
,
ΩΩ 
string
ææ 	
phoneNumber
ææ
 
,
ææ 
bool
øø "
phoneNumberConfirmed
øø 
,
øø 
bool
¿¿ 
twoFactorEnabled
¿¿ 
,
¿¿ 
DateTime
¡¡ 
?
¡¡ 
lockoutEndDateUtc
¡¡ 
)
¬¬ 
{
√√  
SqlParameterHelper
≈≈ 
sph
≈≈ 
=
≈≈ 
new
≈≈  
SqlParameterHelper
≈≈  2
(
≈≈2 3
ConnectionString
≈≈3 C
.
≈≈C D&
GetWriteConnectionString
≈≈D \
(
≈≈\ ]
)
≈≈] ^
,
≈≈^ _
$str
≈≈` q
,
≈≈q r
$num
≈≈s u
)
≈≈u v
;
≈≈v w
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ 
(
∆∆ 
$str
∆∆ %
,
∆∆% &
	SqlDbType
∆∆' 0
.
∆∆0 1
UniqueIdentifier
∆∆1 A
,
∆∆A B 
ParameterDirection
∆∆C U
.
∆∆U V
Input
∆∆V [
,
∆∆[ \
siteGuid
∆∆] e
)
∆∆e f
;
∆∆f g
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« #
,
««# $
	SqlDbType
««% .
.
««. /
Int
««/ 2
,
««2 3 
ParameterDirection
««4 F
.
««F G
Input
««G L
,
««L M
siteId
««N T
)
««T U
;
««U V
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»» !
,
»»! "
	SqlDbType
»»# ,
.
»», -
NVarChar
»»- 5
,
»»5 6
$num
»»7 :
,
»»: ; 
ParameterDirection
»»< N
.
»»N O
Input
»»O T
,
»»T U
fullName
»»V ^
)
»»^ _
;
»»_ `
sph
…… 
.
……  
DefineSqlParameter
…… 
(
…… 
$str
…… &
,
……& '
	SqlDbType
……( 1
.
……1 2
NVarChar
……2 :
,
……: ;
$num
……< >
,
……> ? 
ParameterDirection
……@ R
.
……R S
Input
……S X
,
……X Y
	loginName
……Z c
)
……c d
;
……d e
sph
   
.
    
DefineSqlParameter
   
(
   
$str
   "
,
  " #
	SqlDbType
  $ -
.
  - .
NVarChar
  . 6
,
  6 7
$num
  8 ;
,
  ; < 
ParameterDirection
  = O
.
  O P
Input
  P U
,
  U V
email
  W \
)
  \ ]
;
  ] ^
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ 
(
ÀÀ 
$str
ÀÀ %
,
ÀÀ% &
	SqlDbType
ÀÀ' 0
.
ÀÀ0 1
NVarChar
ÀÀ1 9
,
ÀÀ9 :
$num
ÀÀ; ?
,
ÀÀ? @ 
ParameterDirection
ÀÀA S
.
ÀÀS T
Input
ÀÀT Y
,
ÀÀY Z
password
ÀÀ[ c
)
ÀÀc d
;
ÀÀd e
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ 
(
ÃÃ 
$str
ÃÃ )
,
ÃÃ) *
	SqlDbType
ÃÃ+ 4
.
ÃÃ4 5
NVarChar
ÃÃ5 =
,
ÃÃ= >
$num
ÃÃ? B
,
ÃÃB C 
ParameterDirection
ÃÃD V
.
ÃÃV W
Input
ÃÃW \
,
ÃÃ\ ]
passwordSalt
ÃÃ^ j
)
ÃÃj k
;
ÃÃk l
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ 
(
ÕÕ 
$str
ÕÕ %
,
ÕÕ% &
	SqlDbType
ÕÕ' 0
.
ÕÕ0 1
UniqueIdentifier
ÕÕ1 A
,
ÕÕA B 
ParameterDirection
ÕÕC U
.
ÕÕU V
Input
ÕÕV [
,
ÕÕ[ \
userGuid
ÕÕ] e
)
ÕÕe f
;
ÕÕf g
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ 
(
ŒŒ 
$str
ŒŒ (
,
ŒŒ( )
	SqlDbType
ŒŒ* 3
.
ŒŒ3 4
DateTime
ŒŒ4 <
,
ŒŒ< = 
ParameterDirection
ŒŒ> P
.
ŒŒP Q
Input
ŒŒQ V
,
ŒŒV W
dateCreated
ŒŒX c
)
ŒŒc d
;
ŒŒd e
sph
œœ 
.
œœ  
DefineSqlParameter
œœ 
(
œœ 
$str
œœ *
,
œœ* +
	SqlDbType
œœ, 5
.
œœ5 6
Bit
œœ6 9
,
œœ9 : 
ParameterDirection
œœ; M
.
œœM N
Input
œœN S
,
œœS T
mustChangePwd
œœU b
)
œœb c
;
œœc d
sph
—— 
.
——  
DefineSqlParameter
—— 
(
—— 
$str
—— &
,
——& '
	SqlDbType
——( 1
.
——1 2
NVarChar
——2 :
,
——: ;
$num
——< ?
,
——? @ 
ParameterDirection
——A S
.
——S T
Input
——T Y
,
——Y Z
	firstName
——[ d
)
——d e
;
——e f
sph
““ 
.
““  
DefineSqlParameter
““ 
(
““ 
$str
““ %
,
““% &
	SqlDbType
““' 0
.
““0 1
NVarChar
““1 9
,
““9 :
$num
““; >
,
““> ? 
ParameterDirection
““@ R
.
““R S
Input
““S X
,
““X Y
lastName
““Z b
)
““b c
;
““c d
sph
”” 
.
””  
DefineSqlParameter
”” 
(
”” 
$str
”” '
,
””' (
	SqlDbType
””) 2
.
””2 3
NVarChar
””3 ;
,
””; <
$num
””= ?
,
””? @ 
ParameterDirection
””A S
.
””S T
Input
””T Y
,
””Y Z

timeZoneId
””[ e
)
””e f
;
””f g
sph
‘‘ 
.
‘‘  
DefineSqlParameter
‘‘ 
(
‘‘ 
$str
‘‘ ,
,
‘‘, -
	SqlDbType
‘‘. 7
.
‘‘7 8
UniqueIdentifier
‘‘8 H
,
‘‘H I 
ParameterDirection
‘‘J \
.
‘‘\ ]
Input
‘‘] b
,
‘‘b c
Guid
‘‘d h
.
‘‘h i
Empty
‘‘i n
)
‘‘n o
;
‘‘o p
if
÷÷ 
(
÷÷ 
dateOfBirth
÷÷ 
==
÷÷ 
DateTime
÷÷ 
.
÷÷ 
MinValue
÷÷ '
)
÷÷' (
{
◊◊ 
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ 
(
ÿÿ 
$str
ÿÿ )
,
ÿÿ) *
	SqlDbType
ÿÿ+ 4
.
ÿÿ4 5
DateTime
ÿÿ5 =
,
ÿÿ= > 
ParameterDirection
ÿÿ? Q
.
ÿÿQ R
Input
ÿÿR W
,
ÿÿW X
DBNull
ÿÿY _
.
ÿÿ_ `
Value
ÿÿ` e
)
ÿÿe f
;
ÿÿf g
}
ŸŸ 
else
⁄⁄ 
{
€€ 
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ 
(
‹‹ 
$str
‹‹ )
,
‹‹) *
	SqlDbType
‹‹+ 4
.
‹‹4 5
DateTime
‹‹5 =
,
‹‹= > 
ParameterDirection
‹‹? Q
.
‹‹Q R
Input
‹‹R W
,
‹‹W X
dateOfBirth
‹‹Y d
)
‹‹d e
;
‹‹e f
}
›› 
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ +
,
ﬂﬂ+ ,
	SqlDbType
ﬂﬂ- 6
.
ﬂﬂ6 7
Bit
ﬂﬂ7 :
,
ﬂﬂ: ; 
ParameterDirection
ﬂﬂ< N
.
ﬂﬂN O
Input
ﬂﬂO T
,
ﬂﬂT U
emailConfirmed
ﬂﬂV d
)
ﬂﬂd e
;
ﬂﬂe f
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ 
(
‡‡ 
$str
‡‡ &
,
‡‡& '
	SqlDbType
‡‡( 1
.
‡‡1 2
Int
‡‡2 5
,
‡‡5 6 
ParameterDirection
‡‡7 I
.
‡‡I J
Input
‡‡J O
,
‡‡O P
	pwdFormat
‡‡Q Z
)
‡‡Z [
;
‡‡[ \
sph
·· 
.
··  
DefineSqlParameter
·· 
(
·· 
$str
·· )
,
··) *
	SqlDbType
··+ 4
.
··4 5
NVarChar
··5 =
,
··= >
-
··? @
$num
··@ A
,
··A B 
ParameterDirection
··C U
.
··U V
Input
··V [
,
··[ \
passwordHash
··] i
)
··i j
;
··j k
sph
‚‚ 
.
‚‚  
DefineSqlParameter
‚‚ 
(
‚‚ 
$str
‚‚ *
,
‚‚* +
	SqlDbType
‚‚, 5
.
‚‚5 6
NVarChar
‚‚6 >
,
‚‚> ?
-
‚‚@ A
$num
‚‚A B
,
‚‚B C 
ParameterDirection
‚‚D V
.
‚‚V W
Input
‚‚W \
,
‚‚\ ]
securityStamp
‚‚^ k
)
‚‚k l
;
‚‚l m
sph
„„ 
.
„„  
DefineSqlParameter
„„ 
(
„„ 
$str
„„ (
,
„„( )
	SqlDbType
„„* 3
.
„„3 4
NVarChar
„„4 <
,
„„< =
$num
„„> @
,
„„@ A 
ParameterDirection
„„B T
.
„„T U
Input
„„U Z
,
„„Z [
phoneNumber
„„\ g
)
„„g h
;
„„h i
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ 
(
‰‰ 
$str
‰‰ 1
,
‰‰1 2
	SqlDbType
‰‰3 <
.
‰‰< =
Bit
‰‰= @
,
‰‰@ A 
ParameterDirection
‰‰B T
.
‰‰T U
Input
‰‰U Z
,
‰‰Z ["
phoneNumberConfirmed
‰‰\ p
)
‰‰p q
;
‰‰q r
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ 
(
ÂÂ 
$str
ÂÂ -
,
ÂÂ- .
	SqlDbType
ÂÂ/ 8
.
ÂÂ8 9
Bit
ÂÂ9 <
,
ÂÂ< = 
ParameterDirection
ÂÂ> P
.
ÂÂP Q
Input
ÂÂQ V
,
ÂÂV W
twoFactorEnabled
ÂÂX h
)
ÂÂh i
;
ÂÂi j
if
ÊÊ 
(
ÊÊ 
lockoutEndDateUtc
ÊÊ 
==
ÊÊ 
null
ÊÊ  
)
ÊÊ  !
{
ÁÁ 
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË /
,
ËË/ 0
	SqlDbType
ËË1 :
.
ËË: ;
DateTime
ËË; C
,
ËËC D 
ParameterDirection
ËËE W
.
ËËW X
Input
ËËX ]
,
ËË] ^
DBNull
ËË_ e
.
ËËe f
Value
ËËf k
)
ËËk l
;
ËËl m
}
ÈÈ 
else
ÍÍ 
{
ÎÎ 
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ 
(
ÏÏ 
$str
ÏÏ /
,
ÏÏ/ 0
	SqlDbType
ÏÏ1 :
.
ÏÏ: ;
DateTime
ÏÏ; C
,
ÏÏC D 
ParameterDirection
ÏÏE W
.
ÏÏW X
Input
ÏÏX ]
,
ÏÏ] ^
lockoutEndDateUtc
ÏÏ_ p
)
ÏÏp q
;
ÏÏq r
}
ÌÌ 
int
 
newID
 
=
 
Convert
 
.
 
ToInt32
 
(
 
sph
 "
.
" #
ExecuteScalar
# 0
(
0 1
)
1 2
)
2 3
;
3 4
return
ÒÒ 	
newID
ÒÒ
 
;
ÒÒ 
}
ÚÚ 
public
ÙÙ 
static
ÙÙ	 
bool
ÙÙ 

UpdateUser
ÙÙ 
(
ÙÙ  
int
ıı 
userId
ıı 
,
ıı 
string
ˆˆ 	
name
ˆˆ
 
,
ˆˆ 
string
˜˜ 	
	loginName
˜˜
 
,
˜˜ 
string
¯¯ 	
email
¯¯
 
,
¯¯ 
string
˘˘ 	
password
˘˘
 
,
˘˘ 
string
˙˙ 	
passwordSalt
˙˙
 
,
˙˙ 
string
˚˚ 	
gender
˚˚
 
,
˚˚ 
bool
¸¸ 
profileApproved
¸¸ 
,
¸¸ 
bool
˝˝ 
approvedForForums
˝˝ 
,
˝˝ 
bool
˛˛ 
trusted
˛˛ 
,
˛˛ 
bool
ˇˇ !
displayInMemberList
ˇˇ 
,
ˇˇ 
string
ÄÄ 	

webSiteUrl
ÄÄ
 
,
ÄÄ 
string
ÅÅ 	
country
ÅÅ
 
,
ÅÅ 
string
ÇÇ 	
state
ÇÇ
 
,
ÇÇ 
string
ÉÉ 	

occupation
ÉÉ
 
,
ÉÉ 
string
ÑÑ 	
	interests
ÑÑ
 
,
ÑÑ 
string
ÖÖ 	
msn
ÖÖ
 
,
ÖÖ 
string
ÜÜ 	
yahoo
ÜÜ
 
,
ÜÜ 
string
áá 	
aim
áá
 
,
áá 
string
àà 	
icq
àà
 
,
àà 
string
ââ 	
	avatarUrl
ââ
 
,
ââ 
string
ää 	
	signature
ää
 
,
ää 
string
ãã 	
skin
ãã
 
,
ãã 
string
åå 	
loweredEmail
åå
 
,
åå 
string
çç 	
passwordQuestion
çç
 
,
çç 
string
éé 	
passwordAnswer
éé
 
,
éé 
string
èè 	
comment
èè
 
,
èè 
int
êê 
timeOffsetHours
êê 
,
êê 
string
ëë 	
	openIdUri
ëë
 
,
ëë 
string
íí 	
windowsLiveId
íí
 
,
íí 
bool
ìì 
mustChangePwd
ìì 
,
ìì 
string
îî 	
	firstName
îî
 
,
îî 
string
ïï 	
lastName
ïï
 
,
ïï 
string
ññ 	

timeZoneId
ññ
 
,
ññ 
string
óó 	
editorPreference
óó
 
,
óó 
string
òò 	
newEmail
òò
 
,
òò 
Guid
ôô 
emailChangeGuid
ôô 
,
ôô 
Guid
öö 
passwordResetGuid
öö 
,
öö 
bool
õõ 
rolesChanged
õõ 
,
õõ 
string
úú 	
	authorBio
úú
 
,
úú 
DateTime
ùù 
dateOfBirth
ùù 
,
ùù 
bool
ûû 
emailConfirmed
ûû 
,
ûû 
int
üü 
	pwdFormat
üü 
,
üü 
string
†† 	
passwordHash
††
 
,
†† 
string
°° 	
securityStamp
°°
 
,
°° 
string
¢¢ 	
phoneNumber
¢¢
 
,
¢¢ 
bool
££ "
phoneNumberConfirmed
££ 
,
££ 
bool
§§ 
twoFactorEnabled
§§ 
,
§§ 
DateTime
•• 
?
•• 
lockoutEndDateUtc
•• 
)
¶¶ 
{
ßß  
SqlParameterHelper
®® 
sph
®® 
=
®® 
new
®®  
SqlParameterHelper
®®  2
(
®®2 3
ConnectionString
®®3 C
.
®®C D&
GetWriteConnectionString
®®D \
(
®®\ ]
)
®®] ^
,
®®^ _
$str
®®` q
,
®®q r
$num
®®s u
)
®®u v
;
®®v w
sph
©© 
.
©©  
DefineSqlParameter
©© 
(
©© 
$str
©© #
,
©©# $
	SqlDbType
©©% .
.
©©. /
Int
©©/ 2
,
©©2 3 
ParameterDirection
©©4 F
.
©©F G
Input
©©G L
,
©©L M
userId
©©N T
)
©©T U
;
©©U V
sph
™™ 
.
™™  
DefineSqlParameter
™™ 
(
™™ 
$str
™™ !
,
™™! "
	SqlDbType
™™# ,
.
™™, -
NVarChar
™™- 5
,
™™5 6
$num
™™7 :
,
™™: ; 
ParameterDirection
™™< N
.
™™N O
Input
™™O T
,
™™T U
name
™™V Z
)
™™Z [
;
™™[ \
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ &
,
´´& '
	SqlDbType
´´( 1
.
´´1 2
NVarChar
´´2 :
,
´´: ;
$num
´´< >
,
´´> ? 
ParameterDirection
´´@ R
.
´´R S
Input
´´S X
,
´´X Y
	loginName
´´Z c
)
´´c d
;
´´d e
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ 
(
¨¨ 
$str
¨¨ "
,
¨¨" #
	SqlDbType
¨¨$ -
.
¨¨- .
NVarChar
¨¨. 6
,
¨¨6 7
$num
¨¨8 ;
,
¨¨; < 
ParameterDirection
¨¨= O
.
¨¨O P
Input
¨¨P U
,
¨¨U V
email
¨¨W \
)
¨¨\ ]
;
¨¨] ^
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ 
(
≠≠ 
$str
≠≠ %
,
≠≠% &
	SqlDbType
≠≠' 0
.
≠≠0 1
NVarChar
≠≠1 9
,
≠≠9 :
$num
≠≠; ?
,
≠≠? @ 
ParameterDirection
≠≠A S
.
≠≠S T
Input
≠≠T Y
,
≠≠Y Z
password
≠≠[ c
)
≠≠c d
;
≠≠d e
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ 
(
ÆÆ 
$str
ÆÆ )
,
ÆÆ) *
	SqlDbType
ÆÆ+ 4
.
ÆÆ4 5
NVarChar
ÆÆ5 =
,
ÆÆ= >
$num
ÆÆ? B
,
ÆÆB C 
ParameterDirection
ÆÆD V
.
ÆÆV W
Input
ÆÆW \
,
ÆÆ\ ]
passwordSalt
ÆÆ^ j
)
ÆÆj k
;
ÆÆk l
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ 
(
ØØ 
$str
ØØ #
,
ØØ# $
	SqlDbType
ØØ% .
.
ØØ. /
NChar
ØØ/ 4
,
ØØ4 5
$num
ØØ6 7
,
ØØ7 8 
ParameterDirection
ØØ9 K
.
ØØK L
Input
ØØL Q
,
ØØQ R
gender
ØØS Y
)
ØØY Z
;
ØØZ [
sph
∞∞ 
.
∞∞  
DefineSqlParameter
∞∞ 
(
∞∞ 
$str
∞∞ ,
,
∞∞, -
	SqlDbType
∞∞. 7
.
∞∞7 8
Bit
∞∞8 ;
,
∞∞; < 
ParameterDirection
∞∞= O
.
∞∞O P
Input
∞∞P U
,
∞∞U V
profileApproved
∞∞W f
)
∞∞f g
;
∞∞g h
sph
±± 
.
±±  
DefineSqlParameter
±± 
(
±± 
$str
±± .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
Bit
±±: =
,
±±= > 
ParameterDirection
±±? Q
.
±±Q R
Input
±±R W
,
±±W X
approvedForForums
±±Y j
)
±±j k
;
±±k l
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ 
(
≤≤ 
$str
≤≤ $
,
≤≤$ %
	SqlDbType
≤≤& /
.
≤≤/ 0
Bit
≤≤0 3
,
≤≤3 4 
ParameterDirection
≤≤5 G
.
≤≤G H
Input
≤≤H M
,
≤≤M N
trusted
≤≤O V
)
≤≤V W
;
≤≤W X
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ 
(
≥≥ 
$str
≥≥ 0
,
≥≥0 1
	SqlDbType
≥≥2 ;
.
≥≥; <
Bit
≥≥< ?
,
≥≥? @ 
ParameterDirection
≥≥A S
.
≥≥S T
Input
≥≥T Y
,
≥≥Y Z!
displayInMemberList
≥≥[ n
)
≥≥n o
;
≥≥o p
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ 
(
¥¥ 
$str
¥¥ '
,
¥¥' (
	SqlDbType
¥¥) 2
.
¥¥2 3
NVarChar
¥¥3 ;
,
¥¥; <
$num
¥¥= @
,
¥¥@ A 
ParameterDirection
¥¥B T
.
¥¥T U
Input
¥¥U Z
,
¥¥Z [

webSiteUrl
¥¥\ f
)
¥¥f g
;
¥¥g h
sph
µµ 
.
µµ  
DefineSqlParameter
µµ 
(
µµ 
$str
µµ $
,
µµ$ %
	SqlDbType
µµ& /
.
µµ/ 0
NVarChar
µµ0 8
,
µµ8 9
$num
µµ: =
,
µµ= > 
ParameterDirection
µµ? Q
.
µµQ R
Input
µµR W
,
µµW X
country
µµY `
)
µµ` a
;
µµa b
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ 
(
∂∂ 
$str
∂∂ "
,
∂∂" #
	SqlDbType
∂∂$ -
.
∂∂- .
NVarChar
∂∂. 6
,
∂∂6 7
$num
∂∂8 ;
,
∂∂; < 
ParameterDirection
∂∂= O
.
∂∂O P
Input
∂∂P U
,
∂∂U V
state
∂∂W \
)
∂∂\ ]
;
∂∂] ^
sph
∑∑ 
.
∑∑  
DefineSqlParameter
∑∑ 
(
∑∑ 
$str
∑∑ '
,
∑∑' (
	SqlDbType
∑∑) 2
.
∑∑2 3
NVarChar
∑∑3 ;
,
∑∑; <
$num
∑∑= @
,
∑∑@ A 
ParameterDirection
∑∑B T
.
∑∑T U
Input
∑∑U Z
,
∑∑Z [

occupation
∑∑\ f
)
∑∑f g
;
∑∑g h
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ 
(
∏∏ 
$str
∏∏ &
,
∏∏& '
	SqlDbType
∏∏( 1
.
∏∏1 2
NVarChar
∏∏2 :
,
∏∏: ;
$num
∏∏< ?
,
∏∏? @ 
ParameterDirection
∏∏A S
.
∏∏S T
Input
∏∏T Y
,
∏∏Y Z
	interests
∏∏[ d
)
∏∏d e
;
∏∏e f
sph
ππ 
.
ππ  
DefineSqlParameter
ππ 
(
ππ 
$str
ππ  
,
ππ  !
	SqlDbType
ππ" +
.
ππ+ ,
NVarChar
ππ, 4
,
ππ4 5
$num
ππ6 8
,
ππ8 9 
ParameterDirection
ππ: L
.
ππL M
Input
ππM R
,
ππR S
msn
ππT W
)
ππW X
;
ππX Y
sph
∫∫ 
.
∫∫  
DefineSqlParameter
∫∫ 
(
∫∫ 
$str
∫∫ "
,
∫∫" #
	SqlDbType
∫∫$ -
.
∫∫- .
NVarChar
∫∫. 6
,
∫∫6 7
$num
∫∫8 :
,
∫∫: ; 
ParameterDirection
∫∫< N
.
∫∫N O
Input
∫∫O T
,
∫∫T U
yahoo
∫∫V [
)
∫∫[ \
;
∫∫\ ]
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª  
,
ªª  !
	SqlDbType
ªª" +
.
ªª+ ,
NVarChar
ªª, 4
,
ªª4 5
$num
ªª6 8
,
ªª8 9 
ParameterDirection
ªª: L
.
ªªL M
Input
ªªM R
,
ªªR S
aim
ªªT W
)
ªªW X
;
ªªX Y
sph
ºº 
.
ºº  
DefineSqlParameter
ºº 
(
ºº 
$str
ºº  
,
ºº  !
	SqlDbType
ºº" +
.
ºº+ ,
NVarChar
ºº, 4
,
ºº4 5
$num
ºº6 8
,
ºº8 9 
ParameterDirection
ºº: L
.
ººL M
Input
ººM R
,
ººR S
icq
ººT W
)
ººW X
;
ººX Y
sph
ΩΩ 
.
ΩΩ  
DefineSqlParameter
ΩΩ 
(
ΩΩ 
$str
ΩΩ &
,
ΩΩ& '
	SqlDbType
ΩΩ( 1
.
ΩΩ1 2
NVarChar
ΩΩ2 :
,
ΩΩ: ;
$num
ΩΩ< ?
,
ΩΩ? @ 
ParameterDirection
ΩΩA S
.
ΩΩS T
Input
ΩΩT Y
,
ΩΩY Z
	avatarUrl
ΩΩ[ d
)
ΩΩd e
;
ΩΩe f
sph
ææ 
.
ææ  
DefineSqlParameter
ææ 
(
ææ 
$str
ææ &
,
ææ& '
	SqlDbType
ææ( 1
.
ææ1 2
NVarChar
ææ2 :
,
ææ: ;
-
ææ< =
$num
ææ= >
,
ææ> ? 
ParameterDirection
ææ@ R
.
ææR S
Input
ææS X
,
ææX Y
	signature
ææZ c
)
ææc d
;
ææd e
sph
øø 
.
øø  
DefineSqlParameter
øø 
(
øø 
$str
øø !
,
øø! "
	SqlDbType
øø# ,
.
øø, -
NVarChar
øø- 5
,
øø5 6
$num
øø7 :
,
øø: ; 
ParameterDirection
øø< N
.
øøN O
Input
øøO T
,
øøT U
skin
øøV Z
)
øøZ [
;
øø[ \
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ 
(
¿¿ 
$str
¿¿ )
,
¿¿) *
	SqlDbType
¿¿+ 4
.
¿¿4 5
NVarChar
¿¿5 =
,
¿¿= >
$num
¿¿? B
,
¿¿B C 
ParameterDirection
¿¿D V
.
¿¿V W
Input
¿¿W \
,
¿¿\ ]
loweredEmail
¿¿^ j
)
¿¿j k
;
¿¿k l
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ 
(
¡¡ 
$str
¡¡ -
,
¡¡- .
	SqlDbType
¡¡/ 8
.
¡¡8 9
NVarChar
¡¡9 A
,
¡¡A B
$num
¡¡C F
,
¡¡F G 
ParameterDirection
¡¡H Z
.
¡¡Z [
Input
¡¡[ `
,
¡¡` a
passwordQuestion
¡¡b r
)
¡¡r s
;
¡¡s t
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ +
,
¬¬+ ,
	SqlDbType
¬¬- 6
.
¬¬6 7
NVarChar
¬¬7 ?
,
¬¬? @
$num
¬¬A D
,
¬¬D E 
ParameterDirection
¬¬F X
.
¬¬X Y
Input
¬¬Y ^
,
¬¬^ _
passwordAnswer
¬¬` n
)
¬¬n o
;
¬¬o p
sph
√√ 
.
√√  
DefineSqlParameter
√√ 
(
√√ 
$str
√√ $
,
√√$ %
	SqlDbType
√√& /
.
√√/ 0
NVarChar
√√0 8
,
√√8 9
-
√√: ;
$num
√√; <
,
√√< = 
ParameterDirection
√√> P
.
√√P Q
Input
√√Q V
,
√√V W
comment
√√X _
)
√√_ `
;
√√` a
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ 
(
ƒƒ 
$str
ƒƒ ,
,
ƒƒ, -
	SqlDbType
ƒƒ. 7
.
ƒƒ7 8
Int
ƒƒ8 ;
,
ƒƒ; < 
ParameterDirection
ƒƒ= O
.
ƒƒO P
Input
ƒƒP U
,
ƒƒU V
timeOffsetHours
ƒƒW f
)
ƒƒf g
;
ƒƒg h
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ 
(
≈≈ 
$str
≈≈ &
,
≈≈& '
	SqlDbType
≈≈( 1
.
≈≈1 2
NVarChar
≈≈2 :
,
≈≈: ;
$num
≈≈< ?
,
≈≈? @ 
ParameterDirection
≈≈A S
.
≈≈S T
Input
≈≈T Y
,
≈≈Y Z
	openIdUri
≈≈[ d
)
≈≈d e
;
≈≈e f
sph
∆∆ 
.
∆∆  
DefineSqlParameter
∆∆ 
(
∆∆ 
$str
∆∆ *
,
∆∆* +
	SqlDbType
∆∆, 5
.
∆∆5 6
NVarChar
∆∆6 >
,
∆∆> ?
$num
∆∆@ C
,
∆∆C D 
ParameterDirection
∆∆E W
.
∆∆W X
Input
∆∆X ]
,
∆∆] ^
windowsLiveId
∆∆_ l
)
∆∆l m
;
∆∆m n
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« *
,
««* +
	SqlDbType
««, 5
.
««5 6
Bit
««6 9
,
««9 : 
ParameterDirection
««; M
.
««M N
Input
««N S
,
««S T
mustChangePwd
««U b
)
««b c
;
««c d
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»» &
,
»»& '
	SqlDbType
»»( 1
.
»»1 2
NVarChar
»»2 :
,
»»: ;
$num
»»< ?
,
»»? @ 
ParameterDirection
»»A S
.
»»S T
Input
»»T Y
,
»»Y Z
	firstName
»»[ d
)
»»d e
;
»»e f
sph
…… 
.
……  
DefineSqlParameter
…… 
(
…… 
$str
…… %
,
……% &
	SqlDbType
……' 0
.
……0 1
NVarChar
……1 9
,
……9 :
$num
……; >
,
……> ? 
ParameterDirection
……@ R
.
……R S
Input
……S X
,
……X Y
lastName
……Z b
)
……b c
;
……c d
sph
   
.
    
DefineSqlParameter
   
(
   
$str
   '
,
  ' (
	SqlDbType
  ) 2
.
  2 3
NVarChar
  3 ;
,
  ; <
$num
  = ?
,
  ? @ 
ParameterDirection
  A S
.
  S T
Input
  T Y
,
  Y Z

timeZoneId
  [ e
)
  e f
;
  f g
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ 
(
ÀÀ 
$str
ÀÀ -
,
ÀÀ- .
	SqlDbType
ÀÀ/ 8
.
ÀÀ8 9
NVarChar
ÀÀ9 A
,
ÀÀA B
$num
ÀÀC F
,
ÀÀF G 
ParameterDirection
ÀÀH Z
.
ÀÀZ [
Input
ÀÀ[ `
,
ÀÀ` a
editorPreference
ÀÀb r
)
ÀÀr s
;
ÀÀs t
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ 
(
ÃÃ 
$str
ÃÃ %
,
ÃÃ% &
	SqlDbType
ÃÃ' 0
.
ÃÃ0 1
NVarChar
ÃÃ1 9
,
ÃÃ9 :
$num
ÃÃ; >
,
ÃÃ> ? 
ParameterDirection
ÃÃ@ R
.
ÃÃR S
Input
ÃÃS X
,
ÃÃX Y
newEmail
ÃÃZ b
)
ÃÃb c
;
ÃÃc d
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ 
(
ÕÕ 
$str
ÕÕ ,
,
ÕÕ, -
	SqlDbType
ÕÕ. 7
.
ÕÕ7 8
UniqueIdentifier
ÕÕ8 H
,
ÕÕH I 
ParameterDirection
ÕÕJ \
.
ÕÕ\ ]
Input
ÕÕ] b
,
ÕÕb c
emailChangeGuid
ÕÕd s
)
ÕÕs t
;
ÕÕt u
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ 
(
ŒŒ 
$str
ŒŒ .
,
ŒŒ. /
	SqlDbType
ŒŒ0 9
.
ŒŒ9 :
UniqueIdentifier
ŒŒ: J
,
ŒŒJ K 
ParameterDirection
ŒŒL ^
.
ŒŒ^ _
Input
ŒŒ_ d
,
ŒŒd e
passwordResetGuid
ŒŒf w
)
ŒŒw x
;
ŒŒx y
sph
œœ 
.
œœ  
DefineSqlParameter
œœ 
(
œœ 
$str
œœ )
,
œœ) *
	SqlDbType
œœ+ 4
.
œœ4 5
Bit
œœ5 8
,
œœ8 9 
ParameterDirection
œœ: L
.
œœL M
Input
œœM R
,
œœR S
rolesChanged
œœT `
)
œœ` a
;
œœa b
sph
–– 
.
––  
DefineSqlParameter
–– 
(
–– 
$str
–– &
,
––& '
	SqlDbType
––( 1
.
––1 2
NVarChar
––2 :
,
––: ;
-
––< =
$num
––= >
,
––> ? 
ParameterDirection
––@ R
.
––R S
Input
––S X
,
––X Y
	authorBio
––Z c
)
––c d
;
––d e
if
—— 
(
—— 
dateOfBirth
—— 
==
—— 
DateTime
—— 
.
—— 
MinValue
—— '
)
——' (
{
““ 
sph
”” 
.
””  
DefineSqlParameter
”” 
(
”” 
$str
”” )
,
””) *
	SqlDbType
””+ 4
.
””4 5
DateTime
””5 =
,
””= > 
ParameterDirection
””? Q
.
””Q R
Input
””R W
,
””W X
DBNull
””Y _
.
””_ `
Value
””` e
)
””e f
;
””f g
}
‘‘ 
else
’’ 
{
÷÷ 
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ 
(
◊◊ 
$str
◊◊ )
,
◊◊) *
	SqlDbType
◊◊+ 4
.
◊◊4 5
DateTime
◊◊5 =
,
◊◊= > 
ParameterDirection
◊◊? Q
.
◊◊Q R
Input
◊◊R W
,
◊◊W X
dateOfBirth
◊◊Y d
)
◊◊d e
;
◊◊e f
}
ÿÿ 
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ 
(
⁄⁄ 
$str
⁄⁄ &
,
⁄⁄& '
	SqlDbType
⁄⁄( 1
.
⁄⁄1 2
Int
⁄⁄2 5
,
⁄⁄5 6 
ParameterDirection
⁄⁄7 I
.
⁄⁄I J
Input
⁄⁄J O
,
⁄⁄O P
	pwdFormat
⁄⁄Q Z
)
⁄⁄Z [
;
⁄⁄[ \
sph
€€ 
.
€€  
DefineSqlParameter
€€ 
(
€€ 
$str
€€ +
,
€€+ ,
	SqlDbType
€€- 6
.
€€6 7
Bit
€€7 :
,
€€: ; 
ParameterDirection
€€< N
.
€€N O
Input
€€O T
,
€€T U
emailConfirmed
€€V d
)
€€d e
;
€€e f
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ 
(
‹‹ 
$str
‹‹ )
,
‹‹) *
	SqlDbType
‹‹+ 4
.
‹‹4 5
NVarChar
‹‹5 =
,
‹‹= >
-
‹‹? @
$num
‹‹@ A
,
‹‹A B 
ParameterDirection
‹‹C U
.
‹‹U V
Input
‹‹V [
,
‹‹[ \
passwordHash
‹‹] i
)
‹‹i j
;
‹‹j k
sph
›› 
.
››  
DefineSqlParameter
›› 
(
›› 
$str
›› *
,
››* +
	SqlDbType
››, 5
.
››5 6
NVarChar
››6 >
,
››> ?
-
››@ A
$num
››A B
,
››B C 
ParameterDirection
››D V
.
››V W
Input
››W \
,
››\ ]
securityStamp
››^ k
)
››k l
;
››l m
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ 
(
ﬁﬁ 
$str
ﬁﬁ (
,
ﬁﬁ( )
	SqlDbType
ﬁﬁ* 3
.
ﬁﬁ3 4
NVarChar
ﬁﬁ4 <
,
ﬁﬁ< =
$num
ﬁﬁ> @
,
ﬁﬁ@ A 
ParameterDirection
ﬁﬁB T
.
ﬁﬁT U
Input
ﬁﬁU Z
,
ﬁﬁZ [
phoneNumber
ﬁﬁ\ g
)
ﬁﬁg h
;
ﬁﬁh i
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ 1
,
ﬂﬂ1 2
	SqlDbType
ﬂﬂ3 <
.
ﬂﬂ< =
Bit
ﬂﬂ= @
,
ﬂﬂ@ A 
ParameterDirection
ﬂﬂB T
.
ﬂﬂT U
Input
ﬂﬂU Z
,
ﬂﬂZ ["
phoneNumberConfirmed
ﬂﬂ\ p
)
ﬂﬂp q
;
ﬂﬂq r
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ 
(
‡‡ 
$str
‡‡ -
,
‡‡- .
	SqlDbType
‡‡/ 8
.
‡‡8 9
Bit
‡‡9 <
,
‡‡< = 
ParameterDirection
‡‡> P
.
‡‡P Q
Input
‡‡Q V
,
‡‡V W
twoFactorEnabled
‡‡X h
)
‡‡h i
;
‡‡i j
if
·· 
(
·· 
lockoutEndDateUtc
·· 
==
·· 
null
··  
)
··  !
{
‚‚ 
sph
„„ 
.
„„  
DefineSqlParameter
„„ 
(
„„ 
$str
„„ /
,
„„/ 0
	SqlDbType
„„1 :
.
„„: ;
DateTime
„„; C
,
„„C D 
ParameterDirection
„„E W
.
„„W X
Input
„„X ]
,
„„] ^
DBNull
„„_ e
.
„„e f
Value
„„f k
)
„„k l
;
„„l m
}
‰‰ 
else
ÂÂ 
{
ÊÊ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ 
(
ÁÁ 
$str
ÁÁ /
,
ÁÁ/ 0
	SqlDbType
ÁÁ1 :
.
ÁÁ: ;
DateTime
ÁÁ; C
,
ÁÁC D 
ParameterDirection
ÁÁE W
.
ÁÁW X
Input
ÁÁX ]
,
ÁÁ] ^
lockoutEndDateUtc
ÁÁ_ p
)
ÁÁp q
;
ÁÁq r
}
ËË 
int
ÍÍ 
rowsAffected
ÍÍ 
=
ÍÍ 
sph
ÍÍ 
.
ÍÍ 
ExecuteNonQuery
ÍÍ )
(
ÍÍ) *
)
ÍÍ* +
;
ÍÍ+ ,
return
ÎÎ 	
(
ÎÎ
 
rowsAffected
ÎÎ 
>
ÎÎ 
-
ÎÎ 
$num
ÎÎ 
)
ÎÎ 
;
ÎÎ 
}
ÏÏ 
public
ÔÔ 
static
ÔÔ	 
bool
ÔÔ 

DeleteUser
ÔÔ 
(
ÔÔ  
int
ÔÔ  #
userId
ÔÔ$ *
)
ÔÔ* +
{
  
SqlParameterHelper
ÒÒ 
sph
ÒÒ 
=
ÒÒ 
new
ÒÒ  
SqlParameterHelper
ÒÒ  2
(
ÒÒ2 3
ConnectionString
ÒÒ3 C
.
ÒÒC D&
GetWriteConnectionString
ÒÒD \
(
ÒÒ\ ]
)
ÒÒ] ^
,
ÒÒ^ _
$str
ÒÒ` q
,
ÒÒq r
$num
ÒÒs t
)
ÒÒt u
;
ÒÒu v
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ 
(
ÚÚ 
$str
ÚÚ #
,
ÚÚ# $
	SqlDbType
ÚÚ% .
.
ÚÚ. /
Int
ÚÚ/ 2
,
ÚÚ2 3 
ParameterDirection
ÚÚ4 F
.
ÚÚF G
Input
ÚÚG L
,
ÚÚL M
userId
ÚÚN T
)
ÚÚT U
;
ÚÚU V
int
ÛÛ 
rowsAffected
ÛÛ 
=
ÛÛ 
sph
ÛÛ 
.
ÛÛ 
ExecuteNonQuery
ÛÛ )
(
ÛÛ) *
)
ÛÛ* +
;
ÛÛ+ ,
return
ÙÙ 	
(
ÙÙ
 
rowsAffected
ÙÙ 
>
ÙÙ 
-
ÙÙ 
$num
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ıı 
public
˜˜ 
static
˜˜	 
bool
˜˜ $
UpdateLastActivityTime
˜˜ +
(
˜˜+ ,
Guid
˜˜, 0
userGuid
˜˜1 9
,
˜˜9 :
DateTime
˜˜; C

lastUpdate
˜˜D N
)
˜˜N O
{
¯¯  
SqlParameterHelper
˘˘ 
sph
˘˘ 
=
˘˘ 
new
˘˘  
SqlParameterHelper
˘˘  2
(
˘˘2 3
ConnectionString
˘˘3 C
.
˘˘C D&
GetWriteConnectionString
˘˘D \
(
˘˘\ ]
)
˘˘] ^
,
˘˘^ _
$str˘˘` Å
,˘˘Å Ç
$num˘˘É Ñ
)˘˘Ñ Ö
;˘˘Ö Ü
sph
˙˙ 
.
˙˙  
DefineSqlParameter
˙˙ 
(
˙˙ 
$str
˙˙ #
,
˙˙# $
	SqlDbType
˙˙% .
.
˙˙. /
UniqueIdentifier
˙˙/ ?
,
˙˙? @ 
ParameterDirection
˙˙A S
.
˙˙S T
Input
˙˙T Y
,
˙˙Y Z
userGuid
˙˙[ c
)
˙˙c d
;
˙˙d e
sph
˚˚ 
.
˚˚  
DefineSqlParameter
˚˚ 
(
˚˚ 
$str
˚˚ '
,
˚˚' (
	SqlDbType
˚˚) 2
.
˚˚2 3
DateTime
˚˚3 ;
,
˚˚; < 
ParameterDirection
˚˚= O
.
˚˚O P
Input
˚˚P U
,
˚˚U V

lastUpdate
˚˚W a
)
˚˚a b
;
˚˚b c
int
¸¸ 
rowsAffected
¸¸ 
=
¸¸ 
sph
¸¸ 
.
¸¸ 
ExecuteNonQuery
¸¸ )
(
¸¸) *
)
¸¸* +
;
¸¸+ ,
return
˝˝ 	
(
˝˝
 
rowsAffected
˝˝ 
>
˝˝ 
-
˝˝ 
$num
˝˝ 
)
˝˝ 
;
˝˝ 
}
˛˛ 
public
ÄÄ 
static
ÄÄ	 
bool
ÄÄ !
UpdateLastLoginTime
ÄÄ (
(
ÄÄ( )
Guid
ÄÄ) -
userGuid
ÄÄ. 6
,
ÄÄ6 7
DateTime
ÄÄ8 @
lastLoginTime
ÄÄA N
)
ÄÄN O
{
ÅÅ  
SqlParameterHelper
ÇÇ 
sph
ÇÇ 
=
ÇÇ 
new
ÇÇ  
SqlParameterHelper
ÇÇ  2
(
ÇÇ2 3
ConnectionString
ÇÇ3 C
.
ÇÇC D&
GetWriteConnectionString
ÇÇD \
(
ÇÇ\ ]
)
ÇÇ] ^
,
ÇÇ^ _
$str
ÇÇ` ~
,
ÇÇ~ 
$numÇÇÄ Å
)ÇÇÅ Ç
;ÇÇÇ É
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ #
,
ÉÉ# $
	SqlDbType
ÉÉ% .
.
ÉÉ. /
UniqueIdentifier
ÉÉ/ ?
,
ÉÉ? @ 
ParameterDirection
ÉÉA S
.
ÉÉS T
Input
ÉÉT Y
,
ÉÉY Z
userGuid
ÉÉ[ c
)
ÉÉc d
;
ÉÉd e
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ 
(
ÑÑ 
$str
ÑÑ *
,
ÑÑ* +
	SqlDbType
ÑÑ, 5
.
ÑÑ5 6
DateTime
ÑÑ6 >
,
ÑÑ> ? 
ParameterDirection
ÑÑ@ R
.
ÑÑR S
Input
ÑÑS X
,
ÑÑX Y
lastLoginTime
ÑÑZ g
)
ÑÑg h
;
ÑÑh i
int
ÖÖ 
rowsAffected
ÖÖ 
=
ÖÖ 
sph
ÖÖ 
.
ÖÖ 
ExecuteNonQuery
ÖÖ )
(
ÖÖ) *
)
ÖÖ* +
;
ÖÖ+ ,
return
ÜÜ 	
(
ÜÜ
 
rowsAffected
ÜÜ 
>
ÜÜ 
-
ÜÜ 
$num
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
áá 
public
ââ 
static
ââ	 
bool
ââ *
UpdateLastPasswordChangeTime
ââ 1
(
ââ1 2
Guid
ââ2 6
userGuid
ââ7 ?
,
ââ? @
DateTime
ââA I$
lastPasswordChangeTime
ââJ `
)
ââ` a
{
ää  
SqlParameterHelper
ãã 
sph
ãã 
=
ãã 
new
ãã  
SqlParameterHelper
ãã  2
(
ãã2 3
ConnectionString
ãã3 C
.
ããC D&
GetWriteConnectionString
ããD \
(
ãã\ ]
)
ãã] ^
,
ãã^ _
$strãã` á
,ããá à
$numããâ ä
)ããä ã
;ããã å
sph
åå 
.
åå  
DefineSqlParameter
åå 
(
åå 
$str
åå #
,
åå# $
	SqlDbType
åå% .
.
åå. /
UniqueIdentifier
åå/ ?
,
åå? @ 
ParameterDirection
ååA S
.
ååS T
Input
ååT Y
,
ååY Z
userGuid
åå[ c
)
ååc d
;
ååd e
sph
çç 
.
çç  
DefineSqlParameter
çç 
(
çç 
$str
çç /
,
çç/ 0
	SqlDbType
çç1 :
.
çç: ;
DateTime
çç; C
,
ççC D 
ParameterDirection
ççE W
.
ççW X
Input
ççX ]
,
çç] ^$
lastPasswordChangeTime
çç_ u
)
ççu v
;
ççv w
int
éé 
rowsAffected
éé 
=
éé 
sph
éé 
.
éé 
ExecuteNonQuery
éé )
(
éé) *
)
éé* +
;
éé+ ,
return
èè 	
(
èè
 
rowsAffected
èè 
>
èè 
-
èè 
$num
èè 
)
èè 
;
èè 
}
êê 
public
íí 
static
íí	 
bool
íí 4
&UpdateFailedPasswordAttemptStartWindow
íí ;
(
íí; <
Guid
ìì 
userGuid
ìì 
,
ìì 
DateTime
îî 
windowStartTime
îî 
)
îî 
{
ïï  
SqlParameterHelper
ññ 
sph
ññ 
=
ññ 
new
ññ  
SqlParameterHelper
ññ  2
(
ññ2 3
ConnectionString
ññ3 C
.
ññC D&
GetWriteConnectionString
ññD \
(
ññ\ ]
)
ññ] ^
,
ññ^ _
$strññ` é
,ññé è
$numññê ë
)ññë í
;ññí ì
sph
óó 
.
óó  
DefineSqlParameter
óó 
(
óó 
$str
óó %
,
óó% &
	SqlDbType
óó' 0
.
óó0 1
UniqueIdentifier
óó1 A
,
óóA B 
ParameterDirection
óóC U
.
óóU V
Input
óóV [
,
óó[ \
userGuid
óó] e
)
óóe f
;
óóf g
sph
òò 
.
òò  
DefineSqlParameter
òò 
(
òò 
$str
òò ,
,
òò, -
	SqlDbType
òò. 7
.
òò7 8
DateTime
òò8 @
,
òò@ A 
ParameterDirection
òòB T
.
òòT U
Input
òòU Z
,
òòZ [
windowStartTime
òò\ k
)
òòk l
;
òòl m
int
ôô 
rowsAffected
ôô 
=
ôô 
sph
ôô 
.
ôô 
ExecuteNonQuery
ôô )
(
ôô) *
)
ôô* +
;
ôô+ ,
return
öö 	
(
öö
 
rowsAffected
öö 
>
öö 
-
öö 
$num
öö 
)
öö 
;
öö 
}
õõ 
public
ùù 
static
ùù	 
bool
ùù .
 UpdateFailedPasswordAttemptCount
ùù 5
(
ùù5 6
Guid
ûû 
userGuid
ûû 
,
ûû 
int
üü 
attemptCount
üü 
)
üü 
{
††  
SqlParameterHelper
°° 
sph
°° 
=
°° 
new
°°  
SqlParameterHelper
°°  2
(
°°2 3
ConnectionString
°°3 C
.
°°C D&
GetWriteConnectionString
°°D \
(
°°\ ]
)
°°] ^
,
°°^ _
$str°°` à
,°°à â
$num°°ä ã
)°°ã å
;°°å ç
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ 
(
¢¢ 
$str
¢¢ %
,
¢¢% &
	SqlDbType
¢¢' 0
.
¢¢0 1
UniqueIdentifier
¢¢1 A
,
¢¢A B 
ParameterDirection
¢¢C U
.
¢¢U V
Input
¢¢V [
,
¢¢[ \
userGuid
¢¢] e
)
¢¢e f
;
¢¢f g
sph
££ 
.
££  
DefineSqlParameter
££ 
(
££ 
$str
££ )
,
££) *
	SqlDbType
££+ 4
.
££4 5
Int
££5 8
,
££8 9 
ParameterDirection
££: L
.
££L M
Input
££M R
,
££R S
attemptCount
££T `
)
££` a
;
££a b
int
§§ 
rowsAffected
§§ 
=
§§ 
sph
§§ 
.
§§ 
ExecuteNonQuery
§§ )
(
§§) *
)
§§* +
;
§§+ ,
return
•• 	
(
••
 
rowsAffected
•• 
>
•• 
-
•• 
$num
•• 
)
•• 
;
•• 
}
¶¶ 
public
®® 
static
®®	 
bool
®® :
,UpdateFailedPasswordAnswerAttemptStartWindow
®® A
(
®®A B
Guid
©© 
userGuid
©© 
,
©© 
DateTime
™™ 
windowStartTime
™™ 
)
™™ 
{
´´  
SqlParameterHelper
¨¨ 
sph
¨¨ 
=
¨¨ 
new
¨¨  
SqlParameterHelper
¨¨  2
(
¨¨2 3
ConnectionString
¨¨3 C
.
¨¨C D&
GetWriteConnectionString
¨¨D \
(
¨¨\ ]
)
¨¨] ^
,
¨¨^ _
$str¨¨` î
,¨¨î ï
$num¨¨ñ ó
)¨¨ó ò
;¨¨ò ô
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ 
(
≠≠ 
$str
≠≠ %
,
≠≠% &
	SqlDbType
≠≠' 0
.
≠≠0 1
UniqueIdentifier
≠≠1 A
,
≠≠A B 
ParameterDirection
≠≠C U
.
≠≠U V
Input
≠≠V [
,
≠≠[ \
userGuid
≠≠] e
)
≠≠e f
;
≠≠f g
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ 
(
ÆÆ 
$str
ÆÆ ,
,
ÆÆ, -
	SqlDbType
ÆÆ. 7
.
ÆÆ7 8
DateTime
ÆÆ8 @
,
ÆÆ@ A 
ParameterDirection
ÆÆB T
.
ÆÆT U
Input
ÆÆU Z
,
ÆÆZ [
windowStartTime
ÆÆ\ k
)
ÆÆk l
;
ÆÆl m
int
ØØ 
rowsAffected
ØØ 
=
ØØ 
sph
ØØ 
.
ØØ 
ExecuteNonQuery
ØØ )
(
ØØ) *
)
ØØ* +
;
ØØ+ ,
return
∞∞ 	
(
∞∞
 
rowsAffected
∞∞ 
>
∞∞ 
-
∞∞ 
$num
∞∞ 
)
∞∞ 
;
∞∞ 
}
±± 
public
≥≥ 
static
≥≥	 
bool
≥≥ 4
&UpdateFailedPasswordAnswerAttemptCount
≥≥ ;
(
≥≥; <
Guid
¥¥ 
userGuid
¥¥ 
,
¥¥ 
int
µµ 
attemptCount
µµ 
)
µµ 
{
∂∂  
SqlParameterHelper
∑∑ 
sph
∑∑ 
=
∑∑ 
new
∑∑  
SqlParameterHelper
∑∑  2
(
∑∑2 3
ConnectionString
∑∑3 C
.
∑∑C D&
GetWriteConnectionString
∑∑D \
(
∑∑\ ]
)
∑∑] ^
,
∑∑^ _
$str∑∑` é
,∑∑é è
$num∑∑ê ë
)∑∑ë í
;∑∑í ì
sph
∏∏ 
.
∏∏  
DefineSqlParameter
∏∏ 
(
∏∏ 
$str
∏∏ %
,
∏∏% &
	SqlDbType
∏∏' 0
.
∏∏0 1
UniqueIdentifier
∏∏1 A
,
∏∏A B 
ParameterDirection
∏∏C U
.
∏∏U V
Input
∏∏V [
,
∏∏[ \
userGuid
∏∏] e
)
∏∏e f
;
∏∏f g
sph
ππ 
.
ππ  
DefineSqlParameter
ππ 
(
ππ 
$str
ππ )
,
ππ) *
	SqlDbType
ππ+ 4
.
ππ4 5
Int
ππ5 8
,
ππ8 9 
ParameterDirection
ππ: L
.
ππL M
Input
ππM R
,
ππR S
attemptCount
ππT `
)
ππ` a
;
ππa b
int
∫∫ 
rowsAffected
∫∫ 
=
∫∫ 
sph
∫∫ 
.
∫∫ 
ExecuteNonQuery
∫∫ )
(
∫∫) *
)
∫∫* +
;
∫∫+ ,
return
ªª 	
(
ªª
 
rowsAffected
ªª 
>
ªª 
-
ªª 
$num
ªª 
)
ªª 
;
ªª 
}
ºº 
public
ææ 
static
ææ	 
bool
ææ 
AccountLockout
ææ #
(
ææ# $
Guid
ææ$ (
userGuid
ææ) 1
,
ææ1 2
DateTime
ææ3 ;
lockoutTime
ææ< G
)
ææG H
{
øø  
SqlParameterHelper
¿¿ 
sph
¿¿ 
=
¿¿ 
new
¿¿  
SqlParameterHelper
¿¿  2
(
¿¿2 3
ConnectionString
¿¿3 C
.
¿¿C D&
GetWriteConnectionString
¿¿D \
(
¿¿\ ]
)
¿¿] ^
,
¿¿^ _
$str
¿¿` y
,
¿¿y z
$num
¿¿{ |
)
¿¿| }
;
¿¿} ~
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ 
(
¡¡ 
$str
¡¡ %
,
¡¡% &
	SqlDbType
¡¡' 0
.
¡¡0 1
UniqueIdentifier
¡¡1 A
,
¡¡A B 
ParameterDirection
¡¡C U
.
¡¡U V
Input
¡¡V [
,
¡¡[ \
userGuid
¡¡] e
)
¡¡e f
;
¡¡f g
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ (
,
¬¬( )
	SqlDbType
¬¬* 3
.
¬¬3 4
DateTime
¬¬4 <
,
¬¬< = 
ParameterDirection
¬¬> P
.
¬¬P Q
Input
¬¬Q V
,
¬¬V W
lockoutTime
¬¬X c
)
¬¬c d
;
¬¬d e
int
√√ 
rowsAffected
√√ 
=
√√ 
sph
√√ 
.
√√ 
ExecuteNonQuery
√√ )
(
√√) *
)
√√* +
;
√√+ ,
return
ƒƒ 	
(
ƒƒ
 
rowsAffected
ƒƒ 
>
ƒƒ 
-
ƒƒ 
$num
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
≈≈ 
public
«« 
static
««	 
bool
«« !
AccountClearLockout
«« (
(
««( )
Guid
««) -
userGuid
««. 6
)
««6 7
{
»»  
SqlParameterHelper
…… 
sph
…… 
=
…… 
new
……  
SqlParameterHelper
……  2
(
……2 3
ConnectionString
……3 C
.
……C D&
GetWriteConnectionString
……D \
(
……\ ]
)
……] ^
,
……^ _
$str
……` ~
,
……~ 
$num……Ä Å
)……Å Ç
;……Ç É
sph
   
.
    
DefineSqlParameter
   
(
   
$str
   %
,
  % &
	SqlDbType
  ' 0
.
  0 1
UniqueIdentifier
  1 A
,
  A B 
ParameterDirection
  C U
.
  U V
Input
  V [
,
  [ \
userGuid
  ] e
)
  e f
;
  f g
int
ÀÀ 
rowsAffected
ÀÀ 
=
ÀÀ 
sph
ÀÀ 
.
ÀÀ 
ExecuteNonQuery
ÀÀ )
(
ÀÀ) *
)
ÀÀ* +
;
ÀÀ+ ,
return
ÃÃ 	
(
ÃÃ
 
rowsAffected
ÃÃ 
>
ÃÃ 
-
ÃÃ 
$num
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 
public
œœ 
static
œœ	 
bool
œœ -
SetRegistrationConfirmationGuid
œœ 4
(
œœ4 5
Guid
œœ5 9
userGuid
œœ: B
,
œœB C
Guid
œœD H*
registrationConfirmationGuid
œœI e
)
œœe f
{
––  
SqlParameterHelper
—— 
sph
—— 
=
—— 
new
——  
SqlParameterHelper
——  2
(
——2 3
ConnectionString
——3 C
.
——C D&
GetWriteConnectionString
——D \
(
——\ ]
)
——] ^
,
——^ _
$str——` ä
,——ä ã
$num——å ç
)——ç é
;——é è
sph
““ 
.
““  
DefineSqlParameter
““ 
(
““ 
$str
““ %
,
““% &
	SqlDbType
““' 0
.
““0 1
UniqueIdentifier
““1 A
,
““A B 
ParameterDirection
““C U
.
““U V
Input
““V [
,
““[ \
userGuid
““] e
)
““e f
;
““f g
sph
”” 
.
””  
DefineSqlParameter
”” 
(
”” 
$str
”” 0
,
””0 1
	SqlDbType
””2 ;
.
””; <
UniqueIdentifier
””< L
,
””L M 
ParameterDirection
””N `
.
””` a
Input
””a f
,
””f g+
registrationConfirmationGuid””h Ñ
)””Ñ Ö
;””Ö Ü
int
‘‘ 
rowsAffected
‘‘ 
=
‘‘ 
sph
‘‘ 
.
‘‘ 
ExecuteNonQuery
‘‘ )
(
‘‘) *
)
‘‘* +
;
‘‘+ ,
return
’’ 	
(
’’
 
rowsAffected
’’ 
>
’’ 
-
’’ 
$num
’’ 
)
’’ 
;
’’ 
}
÷÷ 
public
ÿÿ 
static
ÿÿ	 
bool
ÿÿ !
ConfirmRegistration
ÿÿ (
(
ÿÿ( )
Guid
ÿÿ) -
	emptyGuid
ÿÿ. 7
,
ÿÿ7 8
Guid
ÿÿ9 =*
registrationConfirmationGuid
ÿÿ> Z
)
ÿÿZ [
{
ŸŸ  
SqlParameterHelper
⁄⁄ 
sph
⁄⁄ 
=
⁄⁄ 
new
⁄⁄  
SqlParameterHelper
⁄⁄  2
(
⁄⁄2 3
ConnectionString
⁄⁄3 C
.
⁄⁄C D&
GetWriteConnectionString
⁄⁄D \
(
⁄⁄\ ]
)
⁄⁄] ^
,
⁄⁄^ _
$str
⁄⁄` ~
,
⁄⁄~ 
$num⁄⁄Ä Å
)⁄⁄Å Ç
;⁄⁄Ç É
sph
€€ 
.
€€  
DefineSqlParameter
€€ 
(
€€ 
$str
€€ &
,
€€& '
	SqlDbType
€€( 1
.
€€1 2
UniqueIdentifier
€€2 B
,
€€B C 
ParameterDirection
€€D V
.
€€V W
Input
€€W \
,
€€\ ]
	emptyGuid
€€^ g
)
€€g h
;
€€h i
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ 
(
‹‹ 
$str
‹‹ 0
,
‹‹0 1
	SqlDbType
‹‹2 ;
.
‹‹; <
UniqueIdentifier
‹‹< L
,
‹‹L M 
ParameterDirection
‹‹N `
.
‹‹` a
Input
‹‹a f
,
‹‹f g+
registrationConfirmationGuid‹‹h Ñ
)‹‹Ñ Ö
;‹‹Ö Ü
int
›› 
rowsAffected
›› 
=
›› 
sph
›› 
.
›› 
ExecuteNonQuery
›› )
(
››) *
)
››* +
;
››+ ,
return
ﬁﬁ 	
(
ﬁﬁ
 
rowsAffected
ﬁﬁ 
>
ﬁﬁ 
-
ﬁﬁ 
$num
ﬁﬁ 
)
ﬁﬁ 
;
ﬁﬁ 
}
ﬂﬂ 
public
·· 
static
··	 
bool
·· #
UpdatePasswordAndSalt
·· *
(
··* +
int
‚‚ 
userId
‚‚ 
,
‚‚ 
int
„„ 
	pwdFormat
„„ 
,
„„ 
string
‰‰ 	
password
‰‰
 
,
‰‰ 
string
ÂÂ 	
passwordSalt
ÂÂ
 
)
ÂÂ 
{
ÊÊ  
SqlParameterHelper
ÁÁ 
sph
ÁÁ 
=
ÁÁ 
new
ÁÁ  
SqlParameterHelper
ÁÁ  2
(
ÁÁ2 3
ConnectionString
ÁÁ3 C
.
ÁÁC D&
GetWriteConnectionString
ÁÁD \
(
ÁÁ\ ]
)
ÁÁ] ^
,
ÁÁ^ _
$strÁÁ` Ä
,ÁÁÄ Å
$numÁÁÇ É
)ÁÁÉ Ñ
;ÁÁÑ Ö
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË #
,
ËË# $
	SqlDbType
ËË% .
.
ËË. /
Int
ËË/ 2
,
ËË2 3 
ParameterDirection
ËË4 F
.
ËËF G
Input
ËËG L
,
ËËL M
userId
ËËN T
)
ËËT U
;
ËËU V
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ 
(
ÈÈ 
$str
ÈÈ %
,
ÈÈ% &
	SqlDbType
ÈÈ' 0
.
ÈÈ0 1
NVarChar
ÈÈ1 9
,
ÈÈ9 :
$num
ÈÈ; ?
,
ÈÈ? @ 
ParameterDirection
ÈÈA S
.
ÈÈS T
Input
ÈÈT Y
,
ÈÈY Z
password
ÈÈ[ c
)
ÈÈc d
;
ÈÈd e
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ 
(
ÍÍ 
$str
ÍÍ )
,
ÍÍ) *
	SqlDbType
ÍÍ+ 4
.
ÍÍ4 5
NVarChar
ÍÍ5 =
,
ÍÍ= >
$num
ÍÍ? B
,
ÍÍB C 
ParameterDirection
ÍÍD V
.
ÍÍV W
Input
ÍÍW \
,
ÍÍ\ ]
passwordSalt
ÍÍ^ j
)
ÍÍj k
;
ÍÍk l
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ 
(
ÎÎ 
$str
ÎÎ &
,
ÎÎ& '
	SqlDbType
ÎÎ( 1
.
ÎÎ1 2
Int
ÎÎ2 5
,
ÎÎ5 6 
ParameterDirection
ÎÎ7 I
.
ÎÎI J
Input
ÎÎJ O
,
ÎÎO P
	pwdFormat
ÎÎQ Z
)
ÎÎZ [
;
ÎÎ[ \
int
ÏÏ 
rowsAffected
ÏÏ 
=
ÏÏ 
sph
ÏÏ 
.
ÏÏ 
ExecuteNonQuery
ÏÏ )
(
ÏÏ) *
)
ÏÏ* +
;
ÏÏ+ ,
return
ÌÌ 	
(
ÌÌ
 
rowsAffected
ÌÌ 
>
ÌÌ 
-
ÌÌ 
$num
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÓÓ 
public
 
static
	 
bool
 -
UpdatePasswordQuestionAndAnswer
 4
(
4 5
Guid
ÒÒ 
userGuid
ÒÒ 
,
ÒÒ 
String
ÚÚ 	
passwordQuestion
ÚÚ
 
,
ÚÚ 
String
ÛÛ 	
passwordAnswer
ÛÛ
 
)
ÛÛ 
{
ÙÙ  
SqlParameterHelper
ıı 
sph
ıı 
=
ıı 
new
ıı  
SqlParameterHelper
ıı  2
(
ıı2 3
ConnectionString
ıı3 C
.
ııC D&
GetWriteConnectionString
ııD \
(
ıı\ ]
)
ıı] ^
,
ıı^ _
$strıı` ä
,ııä ã
$numııå ç
)ııç é
;ııé è
sph
ˆˆ 
.
ˆˆ  
DefineSqlParameter
ˆˆ 
(
ˆˆ 
$str
ˆˆ %
,
ˆˆ% &
	SqlDbType
ˆˆ' 0
.
ˆˆ0 1
UniqueIdentifier
ˆˆ1 A
,
ˆˆA B 
ParameterDirection
ˆˆC U
.
ˆˆU V
Input
ˆˆV [
,
ˆˆ[ \
userGuid
ˆˆ] e
)
ˆˆe f
;
ˆˆf g
sph
˜˜ 
.
˜˜  
DefineSqlParameter
˜˜ 
(
˜˜ 
$str
˜˜ -
,
˜˜- .
	SqlDbType
˜˜/ 8
.
˜˜8 9
NVarChar
˜˜9 A
,
˜˜A B
$num
˜˜C F
,
˜˜F G 
ParameterDirection
˜˜H Z
.
˜˜Z [
Input
˜˜[ `
,
˜˜` a
passwordQuestion
˜˜b r
)
˜˜r s
;
˜˜s t
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ 
(
¯¯ 
$str
¯¯ +
,
¯¯+ ,
	SqlDbType
¯¯- 6
.
¯¯6 7
NVarChar
¯¯7 ?
,
¯¯? @
$num
¯¯A D
,
¯¯D E 
ParameterDirection
¯¯F X
.
¯¯X Y
Input
¯¯Y ^
,
¯¯^ _
passwordAnswer
¯¯` n
)
¯¯n o
;
¯¯o p
int
˘˘ 
rowsAffected
˘˘ 
=
˘˘ 
sph
˘˘ 
.
˘˘ 
ExecuteNonQuery
˘˘ )
(
˘˘) *
)
˘˘* +
;
˘˘+ ,
return
˙˙ 	
(
˙˙
 
rowsAffected
˙˙ 
>
˙˙ 
-
˙˙ 
$num
˙˙ 
)
˙˙ 
;
˙˙ 
}
˚˚ 
public
˝˝ 
static
˝˝	 
void
˝˝  
UpdateTotalRevenue
˝˝ '
(
˝˝' (
Guid
˝˝( ,
userGuid
˝˝- 5
)
˝˝5 6
{
˛˛  
SqlParameterHelper
ˇˇ 
sph
ˇˇ 
=
ˇˇ 
new
ˇˇ  
SqlParameterHelper
ˇˇ  2
(
ˇˇ2 3
ConnectionString
ˇˇ3 C
.
ˇˇC D&
GetWriteConnectionString
ˇˇD \
(
ˇˇ\ ]
)
ˇˇ] ^
,
ˇˇ^ _
$strˇˇ` É
,ˇˇÉ Ñ
$numˇˇÖ Ü
)ˇˇÜ á
;ˇˇá à
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ 
(
ÄÄ 
$str
ÄÄ %
,
ÄÄ% &
	SqlDbType
ÄÄ' 0
.
ÄÄ0 1
UniqueIdentifier
ÄÄ1 A
,
ÄÄA B 
ParameterDirection
ÄÄC U
.
ÄÄU V
Input
ÄÄV [
,
ÄÄ[ \
userGuid
ÄÄ] e
)
ÄÄe f
;
ÄÄf g
sph
ÅÅ 
.
ÅÅ 
ExecuteNonQuery
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÉÉ 
public
ÖÖ 
static
ÖÖ	 
void
ÖÖ  
UpdateTotalRevenue
ÖÖ '
(
ÖÖ' (
)
ÖÖ( )
{
ÜÜ 
	SqlHelper
áá 
.
áá 
ExecuteNonQuery
áá 
(
áá 
ConnectionString
àà 
.
àà &
GetWriteConnectionString
àà -
(
àà- .
)
àà. /
,
àà/ 0
CommandType
ââ 
.
ââ 
StoredProcedure
ââ 
,
ââ  
$str
ää !
,
ää! "
null
ãã 
)
ãã 	
;
ãã	 

}
åå 
public
èè 
static
èè	 
bool
èè 
FlagAsDeleted
èè "
(
èè" #
int
èè# &
userId
èè' -
)
èè- .
{
êê  
SqlParameterHelper
ëë 
sph
ëë 
=
ëë 
new
ëë  
SqlParameterHelper
ëë  2
(
ëë2 3
ConnectionString
ëë3 C
.
ëëC D&
GetWriteConnectionString
ëëD \
(
ëë\ ]
)
ëë] ^
,
ëë^ _
$str
ëë` x
,
ëëx y
$num
ëëz {
)
ëë{ |
;
ëë| }
sph
íí 
.
íí  
DefineSqlParameter
íí 
(
íí 
$str
íí #
,
íí# $
	SqlDbType
íí% .
.
íí. /
Int
íí/ 2
,
íí2 3 
ParameterDirection
íí4 F
.
ííF G
Input
ííG L
,
ííL M
userId
ííN T
)
ííT U
;
ííU V
int
ìì 
rowsAffected
ìì 
=
ìì 
sph
ìì 
.
ìì 
ExecuteNonQuery
ìì )
(
ìì) *
)
ìì* +
;
ìì+ ,
return
îî 	
(
îî
 
rowsAffected
îî 
>
îî 
-
îî 
$num
îî 
)
îî 
;
îî 
}
ïï 
public
óó 
static
óó	 
bool
óó 
FlagAsNotDeleted
óó %
(
óó% &
int
óó& )
userId
óó* 0
)
óó0 1
{
òò  
SqlParameterHelper
ôô 
sph
ôô 
=
ôô 
new
ôô  
SqlParameterHelper
ôô  2
(
ôô2 3
ConnectionString
ôô3 C
.
ôôC D&
GetWriteConnectionString
ôôD \
(
ôô\ ]
)
ôô] ^
,
ôô^ _
$str
ôô` {
,
ôô{ |
$num
ôô} ~
)
ôô~ 
;ôô Ä
sph
öö 
.
öö  
DefineSqlParameter
öö 
(
öö 
$str
öö #
,
öö# $
	SqlDbType
öö% .
.
öö. /
Int
öö/ 2
,
öö2 3 
ParameterDirection
öö4 F
.
ööF G
Input
ööG L
,
ööL M
userId
ööN T
)
ööT U
;
ööU V
int
õõ 
rowsAffected
õõ 
=
õõ 
sph
õõ 
.
õõ 
ExecuteNonQuery
õõ )
(
õõ) *
)
õõ* +
;
õõ+ ,
return
úú 	
(
úú
 
rowsAffected
úú 
>
úú 
-
úú 
$num
úú 
)
úú 
;
úú 
}
ùù 
public
üü 
static
üü	 
bool
üü !
IncrementTotalPosts
üü (
(
üü( )
int
üü) ,
userId
üü- 3
)
üü3 4
{
††  
SqlParameterHelper
°° 
sph
°° 
=
°° 
new
°°  
SqlParameterHelper
°°  2
(
°°2 3
ConnectionString
°°3 C
.
°°C D&
GetWriteConnectionString
°°D \
(
°°\ ]
)
°°] ^
,
°°^ _
$str
°°` ~
,
°°~ 
$num°°Ä Å
)°°Å Ç
;°°Ç É
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ 
(
¢¢ 
$str
¢¢ #
,
¢¢# $
	SqlDbType
¢¢% .
.
¢¢. /
Int
¢¢/ 2
,
¢¢2 3 
ParameterDirection
¢¢4 F
.
¢¢F G
Input
¢¢G L
,
¢¢L M
userId
¢¢N T
)
¢¢T U
;
¢¢U V
int
££ 
rowsAffected
££ 
=
££ 
sph
££ 
.
££ 
ExecuteNonQuery
££ )
(
££) *
)
££* +
;
££+ ,
return
§§ 	
(
§§
 
rowsAffected
§§ 
>
§§ 
-
§§ 
$num
§§ 
)
§§ 
;
§§ 
}
•• 
public
ßß 
static
ßß	 
bool
ßß !
DecrementTotalPosts
ßß (
(
ßß( )
int
ßß) ,
userId
ßß- 3
)
ßß3 4
{
®®  
SqlParameterHelper
©© 
sph
©© 
=
©© 
new
©©  
SqlParameterHelper
©©  2
(
©©2 3
ConnectionString
©©3 C
.
©©C D&
GetWriteConnectionString
©©D \
(
©©\ ]
)
©©] ^
,
©©^ _
$str
©©` ~
,
©©~ 
$num©©Ä Å
)©©Å Ç
;©©Ç É
sph
™™ 
.
™™  
DefineSqlParameter
™™ 
(
™™ 
$str
™™ #
,
™™# $
	SqlDbType
™™% .
.
™™. /
Int
™™/ 2
,
™™2 3 
ParameterDirection
™™4 F
.
™™F G
Input
™™G L
,
™™L M
userId
™™N T
)
™™T U
;
™™U V
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ 
.
´´ 
ExecuteNonQuery
´´ )
(
´´) *
)
´´* +
;
´´+ ,
return
¨¨ 	
(
¨¨
 
rowsAffected
¨¨ 
>
¨¨ 
-
¨¨ 
$num
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 
public
ØØ 
static
ØØ	 
IDataReader
ØØ 
GetRolesByUser
ØØ *
(
ØØ* +
int
ØØ+ .
siteId
ØØ/ 5
,
ØØ5 6
int
ØØ7 :
userId
ØØ; A
)
ØØA B
{
∞∞  
SqlParameterHelper
±± 
sph
±± 
=
±± 
new
±±  
SqlParameterHelper
±±  2
(
±±2 3
ConnectionString
±±3 C
.
±±C D%
GetReadConnectionString
±±D [
(
±±[ \
)
±±\ ]
,
±±] ^
$str
±±_ v
,
±±v w
$num
±±x y
)
±±y z
;
±±z {
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ 
(
≤≤ 
$str
≤≤ #
,
≤≤# $
	SqlDbType
≤≤% .
.
≤≤. /
Int
≤≤/ 2
,
≤≤2 3 
ParameterDirection
≤≤4 F
.
≤≤F G
Input
≤≤G L
,
≤≤L M
siteId
≤≤N T
)
≤≤T U
;
≤≤U V
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ 
(
≥≥ 
$str
≥≥ #
,
≥≥# $
	SqlDbType
≥≥% .
.
≥≥. /
Int
≥≥/ 2
,
≥≥2 3 
ParameterDirection
≥≥4 F
.
≥≥F G
Input
≥≥G L
,
≥≥L M
userId
≥≥N T
)
≥≥T U
;
≥≥U V
return
¥¥ 	
sph
¥¥
 
.
¥¥ 
ExecuteReader
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
}
µµ 
public
∏∏ 
static
∏∏	 
IDataReader
∏∏ '
GetUserByRegistrationGuid
∏∏ 5
(
∏∏5 6
int
∏∏6 9
siteId
∏∏: @
,
∏∏@ A
Guid
∏∏B F!
registerConfirmGuid
∏∏G Z
)
∏∏Z [
{
ππ  
SqlParameterHelper
∫∫ 
sph
∫∫ 
=
∫∫ 
new
∫∫  
SqlParameterHelper
∫∫  2
(
∫∫2 3
ConnectionString
∫∫3 C
.
∫∫C D%
GetReadConnectionString
∫∫D [
(
∫∫[ \
)
∫∫\ ]
,
∫∫] ^
$str
∫∫_ ~
,
∫∫~ 
$num∫∫Ä Å
)∫∫Å Ç
;∫∫Ç É
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª #
,
ªª# $
	SqlDbType
ªª% .
.
ªª. /
Int
ªª/ 2
,
ªª2 3 
ParameterDirection
ªª4 F
.
ªªF G
Input
ªªG L
,
ªªL M
siteId
ªªN T
)
ªªT U
;
ªªU V
sph
ºº 
.
ºº  
DefineSqlParameter
ºº 
(
ºº 
$str
ºº 0
,
ºº0 1
	SqlDbType
ºº2 ;
.
ºº; <
UniqueIdentifier
ºº< L
,
ººL M 
ParameterDirection
ººN `
.
ºº` a
Input
ººa f
,
ººf g!
registerConfirmGuid
ººh {
)
ºº{ |
;
ºº| }
return
ΩΩ 	
sph
ΩΩ
 
.
ΩΩ 
ExecuteReader
ΩΩ 
(
ΩΩ 
)
ΩΩ 
;
ΩΩ 
}
ææ 
public
¡¡ 
static
¡¡	 
IDataReader
¡¡ 
GetSingleUser
¡¡ )
(
¡¡) *
int
¡¡* -
siteId
¡¡. 4
,
¡¡4 5
string
¡¡6 <
email
¡¡= B
)
¡¡B C
{
¬¬  
SqlParameterHelper
√√ 
sph
√√ 
=
√√ 
new
√√  
SqlParameterHelper
√√  2
(
√√2 3
ConnectionString
√√3 C
.
√√C D%
GetReadConnectionString
√√D [
(
√√[ \
)
√√\ ]
,
√√] ^
$str
√√_ w
,
√√w x
$num
√√y z
)
√√z {
;
√√{ |
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ 
(
ƒƒ 
$str
ƒƒ #
,
ƒƒ# $
	SqlDbType
ƒƒ% .
.
ƒƒ. /
Int
ƒƒ/ 2
,
ƒƒ2 3 
ParameterDirection
ƒƒ4 F
.
ƒƒF G
Input
ƒƒG L
,
ƒƒL M
siteId
ƒƒN T
)
ƒƒT U
;
ƒƒU V
sph
≈≈ 
.
≈≈  
DefineSqlParameter
≈≈ 
(
≈≈ 
$str
≈≈ "
,
≈≈" #
	SqlDbType
≈≈$ -
.
≈≈- .
NVarChar
≈≈. 6
,
≈≈6 7
$num
≈≈8 ;
,
≈≈; < 
ParameterDirection
≈≈= O
.
≈≈O P
Input
≈≈P U
,
≈≈U V
email
≈≈W \
)
≈≈\ ]
;
≈≈] ^
return
∆∆ 	
sph
∆∆
 
.
∆∆ 
ExecuteReader
∆∆ 
(
∆∆ 
)
∆∆ 
;
∆∆ 
}
«« 
public
…… 
static
……	 
IDataReader
…… &
GetSingleUserByLoginName
…… 4
(
……4 5
int
……5 8
siteId
……9 ?
,
……? @
string
……A G
	loginName
……H Q
,
……Q R
bool
……S W 
allowEmailFallback
……X j
)
……j k
{
    
SqlParameterHelper
ÀÀ 
sph
ÀÀ 
=
ÀÀ 
new
ÀÀ  
SqlParameterHelper
ÀÀ  2
(
ÀÀ2 3
ConnectionString
ÀÀ3 C
.
ÀÀC D%
GetReadConnectionString
ÀÀD [
(
ÀÀ[ \
)
ÀÀ\ ]
,
ÀÀ] ^
$str
ÀÀ_ {
,
ÀÀ{ |
$num
ÀÀ} ~
)
ÀÀ~ 
;ÀÀ Ä
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ 
(
ÃÃ 
$str
ÃÃ #
,
ÃÃ# $
	SqlDbType
ÃÃ% .
.
ÃÃ. /
Int
ÃÃ/ 2
,
ÃÃ2 3 
ParameterDirection
ÃÃ4 F
.
ÃÃF G
Input
ÃÃG L
,
ÃÃL M
siteId
ÃÃN T
)
ÃÃT U
;
ÃÃU V
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ 
(
ÕÕ 
$str
ÕÕ &
,
ÕÕ& '
	SqlDbType
ÕÕ( 1
.
ÕÕ1 2
NVarChar
ÕÕ2 :
,
ÕÕ: ;
$num
ÕÕ< >
,
ÕÕ> ? 
ParameterDirection
ÕÕ@ R
.
ÕÕR S
Input
ÕÕS X
,
ÕÕX Y
	loginName
ÕÕZ c
)
ÕÕc d
;
ÕÕd e
sph
ŒŒ 
.
ŒŒ  
DefineSqlParameter
ŒŒ 
(
ŒŒ 
$str
ŒŒ /
,
ŒŒ/ 0
	SqlDbType
ŒŒ1 :
.
ŒŒ: ;
Bit
ŒŒ; >
,
ŒŒ> ? 
ParameterDirection
ŒŒ@ R
.
ŒŒR S
Input
ŒŒS X
,
ŒŒX Y 
allowEmailFallback
ŒŒZ l
)
ŒŒl m
;
ŒŒm n
return
œœ 	
sph
œœ
 
.
œœ 
ExecuteReader
œœ 
(
œœ 
)
œœ 
;
œœ 
}
–– 
public
““ 
static
““	 
IDataReader
““ 
GetSingleUser
““ )
(
““) *
int
““* -
userId
““. 4
,
““4 5
int
““6 9
siteId
““: @
)
““@ A
{
””  
SqlParameterHelper
‘‘ 
sph
‘‘ 
=
‘‘ 
new
‘‘  
SqlParameterHelper
‘‘  2
(
‘‘2 3
ConnectionString
‘‘3 C
.
‘‘C D%
GetReadConnectionString
‘‘D [
(
‘‘[ \
)
‘‘\ ]
,
‘‘] ^
$str
‘‘_ s
,
‘‘s t
$num
‘‘u v
)
‘‘v w
;
‘‘w x
sph
’’ 
.
’’  
DefineSqlParameter
’’ 
(
’’ 
$str
’’ #
,
’’# $
	SqlDbType
’’% .
.
’’. /
Int
’’/ 2
,
’’2 3 
ParameterDirection
’’4 F
.
’’F G
Input
’’G L
,
’’L M
userId
’’N T
)
’’T U
;
’’U V
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ 
(
÷÷ 
$str
÷÷ #
,
÷÷# $
	SqlDbType
÷÷% .
.
÷÷. /
Int
÷÷/ 2
,
÷÷2 3 
ParameterDirection
÷÷4 F
.
÷÷F G
Input
÷÷G L
,
÷÷L M
siteId
÷÷N T
)
÷÷T U
;
÷÷U V
return
◊◊ 	
sph
◊◊
 
.
◊◊ 
ExecuteReader
◊◊ 
(
◊◊ 
)
◊◊ 
;
◊◊ 
}
ÿÿ 
public
⁄⁄ 
static
⁄⁄	 
IDataReader
⁄⁄ 
GetSingleUser
⁄⁄ )
(
⁄⁄) *
Guid
⁄⁄* .
userGuid
⁄⁄/ 7
,
⁄⁄7 8
int
⁄⁄9 <
siteId
⁄⁄= C
)
⁄⁄C D
{
€€  
SqlParameterHelper
‹‹ 
sph
‹‹ 
=
‹‹ 
new
‹‹  
SqlParameterHelper
‹‹  2
(
‹‹2 3
ConnectionString
‹‹3 C
.
‹‹C D%
GetReadConnectionString
‹‹D [
(
‹‹[ \
)
‹‹\ ]
,
‹‹] ^
$str
‹‹_ v
,
‹‹v w
$num
‹‹x y
)
‹‹y z
;
‹‹z {
sph
›› 
.
››  
DefineSqlParameter
›› 
(
›› 
$str
›› %
,
››% &
	SqlDbType
››' 0
.
››0 1
UniqueIdentifier
››1 A
,
››A B 
ParameterDirection
››C U
.
››U V
Input
››V [
,
››[ \
userGuid
››] e
)
››e f
;
››f g
sph
ﬁﬁ 
.
ﬁﬁ  
DefineSqlParameter
ﬁﬁ 
(
ﬁﬁ 
$str
ﬁﬁ #
,
ﬁﬁ# $
	SqlDbType
ﬁﬁ% .
.
ﬁﬁ. /
Int
ﬁﬁ/ 2
,
ﬁﬁ2 3 
ParameterDirection
ﬁﬁ4 F
.
ﬁﬁF G
Input
ﬁﬁG L
,
ﬁﬁL M
siteId
ﬁﬁN T
)
ﬁﬁT U
;
ﬁﬁU V
return
ﬂﬂ 	
sph
ﬂﬂ
 
.
ﬂﬂ 
ExecuteReader
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 
public
‚‚ 
static
‚‚	 
Guid
‚‚ #
GetUserGuidFromOpenId
‚‚ *
(
‚‚* +
int
„„ 
siteId
„„ 
,
„„ 
string
‰‰ 	
	openIduri
‰‰
 
)
‰‰ 
{
ÂÂ  
SqlParameterHelper
ÊÊ 
sph
ÊÊ 
=
ÊÊ 
new
ÊÊ  
SqlParameterHelper
ÊÊ  2
(
ÊÊ2 3
ConnectionString
ÊÊ3 C
.
ÊÊC D%
GetReadConnectionString
ÊÊD [
(
ÊÊ[ \
)
ÊÊ\ ]
,
ÊÊ] ^
$str
ÊÊ_ 
,ÊÊ Ä
$numÊÊÅ Ç
)ÊÊÇ É
;ÊÊÉ Ñ
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ 
(
ÁÁ 
$str
ÁÁ #
,
ÁÁ# $
	SqlDbType
ÁÁ% .
.
ÁÁ. /
Int
ÁÁ/ 2
,
ÁÁ2 3 
ParameterDirection
ÁÁ4 F
.
ÁÁF G
Input
ÁÁG L
,
ÁÁL M
siteId
ÁÁN T
)
ÁÁT U
;
ÁÁU V
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË &
,
ËË& '
	SqlDbType
ËË( 1
.
ËË1 2
NVarChar
ËË2 :
,
ËË: ;
$num
ËË< ?
,
ËË? @ 
ParameterDirection
ËËA S
.
ËËS T
Input
ËËT Y
,
ËËY Z
	openIduri
ËË[ d
)
ËËd e
;
ËËe f
Guid
ÍÍ 
userGuid
ÍÍ 
=
ÍÍ 
Guid
ÍÍ 
.
ÍÍ 
Empty
ÍÍ 
;
ÍÍ 
using
ÏÏ 
(
ÏÏ	 

IDataReader
ÏÏ
 
reader
ÏÏ 
=
ÏÏ 
sph
ÏÏ "
.
ÏÏ" #
ExecuteReader
ÏÏ# 0
(
ÏÏ0 1
)
ÏÏ1 2
)
ÏÏ2 3
{
ÌÌ 
if
ÓÓ 
(
ÓÓ 
reader
ÓÓ 
.
ÓÓ 
Read
ÓÓ 
(
ÓÓ 
)
ÓÓ 
)
ÓÓ 
{
ÔÔ 
userGuid
 
=
 
new
 
Guid
 
(
 
reader
 
[
  
$str
  *
]
* +
.
+ ,
ToString
, 4
(
4 5
)
5 6
)
6 7
;
7 8
}
ÒÒ 
}
ÚÚ 
return
ÙÙ 	
userGuid
ÙÙ
 
;
ÙÙ 
}
ıı 
public
˜˜ 
static
˜˜	 
Guid
˜˜ *
GetUserGuidFromWindowsLiveId
˜˜ 1
(
˜˜1 2
int
¯¯ 
siteId
¯¯ 
,
¯¯ 
string
˘˘ 	
windowsLiveId
˘˘
 
)
˘˘ 
{
˙˙  
SqlParameterHelper
˚˚ 
sph
˚˚ 
=
˚˚ 
new
˚˚  
SqlParameterHelper
˚˚  2
(
˚˚2 3
ConnectionString
˚˚3 C
.
˚˚C D%
GetReadConnectionString
˚˚D [
(
˚˚[ \
)
˚˚\ ]
,
˚˚] ^
$str˚˚_ É
,˚˚É Ñ
$num˚˚Ö Ü
)˚˚Ü á
;˚˚á à
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ 
(
¸¸ 
$str
¸¸ #
,
¸¸# $
	SqlDbType
¸¸% .
.
¸¸. /
Int
¸¸/ 2
,
¸¸2 3 
ParameterDirection
¸¸4 F
.
¸¸F G
Input
¸¸G L
,
¸¸L M
siteId
¸¸N T
)
¸¸T U
;
¸¸U V
sph
˝˝ 
.
˝˝  
DefineSqlParameter
˝˝ 
(
˝˝ 
$str
˝˝ *
,
˝˝* +
	SqlDbType
˝˝, 5
.
˝˝5 6
NVarChar
˝˝6 >
,
˝˝> ?
$num
˝˝@ C
,
˝˝C D 
ParameterDirection
˝˝E W
.
˝˝W X
Input
˝˝X ]
,
˝˝] ^
windowsLiveId
˝˝_ l
)
˝˝l m
;
˝˝m n
Guid
ˇˇ 
userGuid
ˇˇ 
=
ˇˇ 
Guid
ˇˇ 
.
ˇˇ 
Empty
ˇˇ 
;
ˇˇ 
using
ÅÅ 
(
ÅÅ	 

IDataReader
ÅÅ
 
reader
ÅÅ 
=
ÅÅ 
sph
ÅÅ "
.
ÅÅ" #
ExecuteReader
ÅÅ# 0
(
ÅÅ0 1
)
ÅÅ1 2
)
ÅÅ2 3
{
ÇÇ 
if
ÉÉ 
(
ÉÉ 
reader
ÉÉ 
.
ÉÉ 
Read
ÉÉ 
(
ÉÉ 
)
ÉÉ 
)
ÉÉ 
{
ÑÑ 
userGuid
ÖÖ 
=
ÖÖ 
new
ÖÖ 
Guid
ÖÖ 
(
ÖÖ 
reader
ÖÖ 
[
ÖÖ  
$str
ÖÖ  *
]
ÖÖ* +
.
ÖÖ+ ,
ToString
ÖÖ, 4
(
ÖÖ4 5
)
ÖÖ5 6
)
ÖÖ6 7
;
ÖÖ7 8
}
ÜÜ 
}
áá 
return
ââ 	
userGuid
ââ
 
;
ââ 
}
ää 
public
åå 
static
åå	 
string
åå 
LoginByEmail
åå #
(
åå# $
int
åå$ '
siteId
åå( .
,
åå. /
string
åå0 6
email
åå7 <
,
åå< =
string
åå> D
password
ååE M
)
ååM N
{
çç  
SqlParameterHelper
éé 
sph
éé 
=
éé 
new
éé  
SqlParameterHelper
éé  2
(
éé2 3
ConnectionString
éé3 C
.
ééC D%
GetReadConnectionString
ééD [
(
éé[ \
)
éé\ ]
,
éé] ^
$str
éé_ v
,
éév w
$num
ééx y
)
ééy z
;
ééz {
sph
èè 
.
èè  
DefineSqlParameter
èè 
(
èè 
$str
èè #
,
èè# $
	SqlDbType
èè% .
.
èè. /
Int
èè/ 2
,
èè2 3 
ParameterDirection
èè4 F
.
èèF G
Input
èèG L
,
èèL M
siteId
èèN T
)
èèT U
;
èèU V
sph
êê 
.
êê  
DefineSqlParameter
êê 
(
êê 
$str
êê "
,
êê" #
	SqlDbType
êê$ -
.
êê- .
NVarChar
êê. 6
,
êê6 7
$num
êê8 ;
,
êê; < 
ParameterDirection
êê= O
.
êêO P
Input
êêP U
,
êêU V
email
êêW \
)
êê\ ]
;
êê] ^
sph
ëë 
.
ëë  
DefineSqlParameter
ëë 
(
ëë 
$str
ëë %
,
ëë% &
	SqlDbType
ëë' 0
.
ëë0 1
NVarChar
ëë1 9
,
ëë9 :
$num
ëë; ?
,
ëë? @ 
ParameterDirection
ëëA S
.
ëëS T
Input
ëëT Y
,
ëëY Z
password
ëë[ c
)
ëëc d
;
ëëd e
sph
íí 
.
íí  
DefineSqlParameter
íí 
(
íí 
$str
íí %
,
íí% &
	SqlDbType
íí' 0
.
íí0 1
NVarChar
íí1 9
,
íí9 :
$num
íí; >
,
íí> ? 
ParameterDirection
íí@ R
.
ííR S
InputOutput
ííS ^
,
íí^ _
null
íí` d
)
ííd e
;
ííe f
sph
ìì 
.
ìì 
ExecuteNonQuery
ìì 
(
ìì 
)
ìì 
;
ìì 
if
ññ 
(
ññ 
sph
ññ 

.
ññ
 

Parameters
ññ 
[
ññ 
$num
ññ 
]
ññ 
!=
ññ 
null
ññ  
)
ññ  !
{
óó 
return
òò 

sph
òò 
.
òò 

Parameters
òò 
[
òò 
$num
òò 
]
òò 
.
òò 
Value
òò "
.
òò" #
ToString
òò# +
(
òò+ ,
)
òò, -
;
òò- .
}
ôô 
else
öö 
{
õõ 
return
úú 

string
úú 
.
úú 
Empty
úú 
;
úú 
}
ùù 
}
üü 
public
°° 
static
°°	 
string
°° 
Login
°° 
(
°° 
int
°°  
siteId
°°! '
,
°°' (
string
°°) /
	loginName
°°0 9
,
°°9 :
string
°°; A
password
°°B J
)
°°J K
{
¢¢  
SqlParameterHelper
££ 
sph
££ 
=
££ 
new
££  
SqlParameterHelper
££  2
(
££2 3
ConnectionString
££3 C
.
££C D%
GetReadConnectionString
££D [
(
££[ \
)
££\ ]
,
££] ^
$str
££_ o
,
££o p
$num
££q r
)
££r s
;
££s t
sph
§§ 
.
§§  
DefineSqlParameter
§§ 
(
§§ 
$str
§§ #
,
§§# $
	SqlDbType
§§% .
.
§§. /
Int
§§/ 2
,
§§2 3 
ParameterDirection
§§4 F
.
§§F G
Input
§§G L
,
§§L M
siteId
§§N T
)
§§T U
;
§§U V
sph
•• 
.
••  
DefineSqlParameter
•• 
(
•• 
$str
•• &
,
••& '
	SqlDbType
••( 1
.
••1 2
NVarChar
••2 :
,
••: ;
$num
••< >
,
••> ? 
ParameterDirection
••@ R
.
••R S
Input
••S X
,
••X Y
	loginName
••Z c
)
••c d
;
••d e
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ 
(
¶¶ 
$str
¶¶ %
,
¶¶% &
	SqlDbType
¶¶' 0
.
¶¶0 1
NVarChar
¶¶1 9
,
¶¶9 :
$num
¶¶; ?
,
¶¶? @ 
ParameterDirection
¶¶A S
.
¶¶S T
Input
¶¶T Y
,
¶¶Y Z
password
¶¶[ c
)
¶¶c d
;
¶¶d e
sph
ßß 
.
ßß  
DefineSqlParameter
ßß 
(
ßß 
$str
ßß %
,
ßß% &
	SqlDbType
ßß' 0
.
ßß0 1
NVarChar
ßß1 9
,
ßß9 :
$num
ßß; >
,
ßß> ? 
ParameterDirection
ßß@ R
.
ßßR S
InputOutput
ßßS ^
,
ßß^ _
null
ßß` d
)
ßßd e
;
ßße f
sph
®® 
.
®® 
ExecuteNonQuery
®® 
(
®® 
)
®® 
;
®® 
if
´´ 
(
´´ 
sph
´´ 

.
´´
 

Parameters
´´ 
[
´´ 
$num
´´ 
]
´´ 
!=
´´ 
null
´´  
)
´´  !
{
¨¨ 
return
≠≠ 

sph
≠≠ 
.
≠≠ 

Parameters
≠≠ 
[
≠≠ 
$num
≠≠ 
]
≠≠ 
.
≠≠ 
Value
≠≠ "
.
≠≠" #
ToString
≠≠# +
(
≠≠+ ,
)
≠≠, -
;
≠≠- .
}
ÆÆ 
else
ØØ 
{
∞∞ 
return
±± 

string
±± 
.
±± 
Empty
±± 
;
±± 
}
≤≤ 
}
¥¥ 
public
∏∏ 
static
∏∏	 
	DataTable
∏∏ /
!GetNonLazyLoadedPropertiesForUser
∏∏ ;
(
∏∏; <
Guid
∏∏< @
userGuid
∏∏A I
)
∏∏I J
{
ππ  
SqlParameterHelper
∫∫ 
sph
∫∫ 
=
∫∫ 
new
∫∫  
SqlParameterHelper
∫∫  2
(
∫∫2 3
ConnectionString
∫∫3 C
.
∫∫C D%
GetReadConnectionString
∫∫D [
(
∫∫[ \
)
∫∫\ ]
,
∫∫] ^
$str
∫∫_ 
,∫∫ Ä
$num∫∫Å Ç
)∫∫Ç É
;∫∫É Ñ
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª %
,
ªª% &
	SqlDbType
ªª' 0
.
ªª0 1
UniqueIdentifier
ªª1 A
,
ªªA B 
ParameterDirection
ªªC U
.
ªªU V
Input
ªªV [
,
ªª[ \
userGuid
ªª] e
)
ªªe f
;
ªªf g
	DataTable
ΩΩ 
	dataTable
ΩΩ 
=
ΩΩ 
new
ΩΩ 
	DataTable
ΩΩ &
(
ΩΩ& '
)
ΩΩ' (
;
ΩΩ( )
	dataTable
ææ 
.
ææ 
Columns
ææ 
.
ææ 
Add
ææ 
(
ææ 
$str
ææ #
,
ææ# $
typeof
ææ% +
(
ææ+ ,
String
ææ, 2
)
ææ2 3
)
ææ3 4
;
ææ4 5
	dataTable
øø 
.
øø 
Columns
øø 
.
øø 
Add
øø 
(
øø 
$str
øø '
,
øø' (
typeof
øø) /
(
øø/ 0
String
øø0 6
)
øø6 7
)
øø7 8
;
øø8 9
	dataTable
¿¿ 
.
¿¿ 
Columns
¿¿ 
.
¿¿ 
Add
¿¿ 
(
¿¿ 
$str
¿¿ .
,
¿¿. /
typeof
¿¿0 6
(
¿¿6 7
String
¿¿7 =
)
¿¿= >
)
¿¿> ?
;
¿¿? @
using
√√ 
(
√√	 

IDataReader
√√
 
reader
√√ 
=
√√ 
sph
√√ "
.
√√" #
ExecuteReader
√√# 0
(
√√0 1
)
√√1 2
)
√√2 3
{
ƒƒ 
while
≈≈ 	
(
≈≈
 
reader
≈≈ 
.
≈≈ 
Read
≈≈ 
(
≈≈ 
)
≈≈ 
)
≈≈ 
{
∆∆ 
DataRow
«« 
row
«« 
=
«« 
	dataTable
«« 
.
«« 
NewRow
«« #
(
««# $
)
««$ %
;
««% &
row
»» 
[
»» 	
$str
»»	 
]
»» 
=
»» 
reader
»» 
[
»» 
$str
»» (
]
»»( )
.
»») *
ToString
»»* 2
(
»»2 3
)
»»3 4
;
»»4 5
row
…… 
[
…… 	
$str
……	 
]
…… 
=
…… 
reader
…… !
[
……! "
$str
……" 0
]
……0 1
.
……1 2
ToString
……2 :
(
……: ;
)
……; <
;
……< =
row
   
[
   	
$str
  	 
]
   
=
    !
reader
  " (
[
  ( )
$str
  ) >
]
  > ?
.
  ? @
ToString
  @ H
(
  H I
)
  I J
;
  J K
	dataTable
ÃÃ 
.
ÃÃ 
Rows
ÃÃ 
.
ÃÃ 
Add
ÃÃ 
(
ÃÃ 
row
ÃÃ 
)
ÃÃ 
;
ÃÃ 
}
ÕÕ 
}
œœ 
return
—— 	
	dataTable
——
 
;
—— 
}
““ 
public
‘‘ 
static
‘‘	 
IDataReader
‘‘ #
GetLazyLoadedProperty
‘‘ 1
(
‘‘1 2
Guid
‘‘2 6
userGuid
‘‘7 ?
,
‘‘? @
String
‘‘A G
propertyName
‘‘H T
)
‘‘T U
{
’’  
SqlParameterHelper
÷÷ 
sph
÷÷ 
=
÷÷ 
new
÷÷  
SqlParameterHelper
÷÷  2
(
÷÷2 3
ConnectionString
÷÷3 C
.
÷÷C D%
GetReadConnectionString
÷÷D [
(
÷÷[ \
)
÷÷\ ]
,
÷÷] ^
$str
÷÷_ |
,
÷÷| }
$num
÷÷~ 
)÷÷ Ä
;÷÷Ä Å
sph
◊◊ 
.
◊◊  
DefineSqlParameter
◊◊ 
(
◊◊ 
$str
◊◊ %
,
◊◊% &
	SqlDbType
◊◊' 0
.
◊◊0 1
UniqueIdentifier
◊◊1 A
,
◊◊A B 
ParameterDirection
◊◊C U
.
◊◊U V
Input
◊◊V [
,
◊◊[ \
userGuid
◊◊] e
)
◊◊e f
;
◊◊f g
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ 
(
ÿÿ 
$str
ÿÿ )
,
ÿÿ) *
	SqlDbType
ÿÿ+ 4
.
ÿÿ4 5
NVarChar
ÿÿ5 =
,
ÿÿ= >
$num
ÿÿ? B
,
ÿÿB C 
ParameterDirection
ÿÿD V
.
ÿÿV W
Input
ÿÿW \
,
ÿÿ\ ]
propertyName
ÿÿ^ j
)
ÿÿj k
;
ÿÿk l
return
ŸŸ 	
sph
ŸŸ
 
.
ŸŸ 
ExecuteReader
ŸŸ 
(
ŸŸ 
)
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
public
‹‹ 
static
‹‹	 
bool
‹‹ 
PropertyExists
‹‹ #
(
‹‹# $
Guid
‹‹$ (
userGuid
‹‹) 1
,
‹‹1 2
string
‹‹3 9
propertyName
‹‹: F
)
‹‹F G
{
››  
SqlParameterHelper
ﬁﬁ 
sph
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ  
SqlParameterHelper
ﬁﬁ  2
(
ﬁﬁ2 3
ConnectionString
ﬁﬁ3 C
.
ﬁﬁC D%
GetReadConnectionString
ﬁﬁD [
(
ﬁﬁ[ \
)
ﬁﬁ\ ]
,
ﬁﬁ] ^
$strﬁﬁ_ Å
,ﬁﬁÅ Ç
$numﬁﬁÉ Ñ
)ﬁﬁÑ Ö
;ﬁﬁÖ Ü
sph
ﬂﬂ 
.
ﬂﬂ  
DefineSqlParameter
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ %
,
ﬂﬂ% &
	SqlDbType
ﬂﬂ' 0
.
ﬂﬂ0 1
UniqueIdentifier
ﬂﬂ1 A
,
ﬂﬂA B 
ParameterDirection
ﬂﬂC U
.
ﬂﬂU V
Input
ﬂﬂV [
,
ﬂﬂ[ \
userGuid
ﬂﬂ] e
)
ﬂﬂe f
;
ﬂﬂf g
sph
‡‡ 
.
‡‡  
DefineSqlParameter
‡‡ 
(
‡‡ 
$str
‡‡ )
,
‡‡) *
	SqlDbType
‡‡+ 4
.
‡‡4 5
NVarChar
‡‡5 =
,
‡‡= >
$num
‡‡? B
,
‡‡B C 
ParameterDirection
‡‡D V
.
‡‡V W
Input
‡‡W \
,
‡‡\ ]
propertyName
‡‡^ j
)
‡‡j k
;
‡‡k l
int
·· 
count
·· 
=
·· 
Convert
·· 
.
·· 
ToInt32
·· 
(
·· 
sph
·· "
.
··" #
ExecuteScalar
··# 0
(
··0 1
)
··1 2
)
··2 3
;
··3 4
return
‚‚ 	
(
‚‚
 
count
‚‚ 
>
‚‚ 
$num
‚‚ 
)
‚‚ 
;
‚‚ 
}
„„ 
public
ÂÂ 
static
ÂÂ	 
void
ÂÂ 
CreateProperty
ÂÂ #
(
ÂÂ# $
Guid
ÊÊ 

propertyId
ÊÊ 
,
ÊÊ 
Guid
ÁÁ 
userGuid
ÁÁ 
,
ÁÁ 
String
ËË 	
propertyName
ËË
 
,
ËË 
String
ÈÈ 	
propertyValue
ÈÈ
 
,
ÈÈ 
byte
ÍÍ 
[
ÍÍ 
]
ÍÍ 	!
propertyValueBinary
ÍÍ
 
,
ÍÍ 
DateTime
ÎÎ 
lastUpdateDate
ÎÎ 
,
ÎÎ 
bool
ÏÏ 
isLazyLoaded
ÏÏ 
)
ÏÏ 
{
ÌÌ  
SqlParameterHelper
ÓÓ 
sph
ÓÓ 
=
ÓÓ 
new
ÓÓ  
SqlParameterHelper
ÓÓ  2
(
ÓÓ2 3
ConnectionString
ÓÓ3 C
.
ÓÓC D&
GetWriteConnectionString
ÓÓD \
(
ÓÓ\ ]
)
ÓÓ] ^
,
ÓÓ^ _
$str
ÓÓ` z
,
ÓÓz {
$num
ÓÓ| }
)
ÓÓ} ~
;
ÓÓ~ 
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ 
(
ÔÔ 
$str
ÔÔ '
,
ÔÔ' (
	SqlDbType
ÔÔ) 2
.
ÔÔ2 3
UniqueIdentifier
ÔÔ3 C
,
ÔÔC D 
ParameterDirection
ÔÔE W
.
ÔÔW X
Input
ÔÔX ]
,
ÔÔ] ^

propertyId
ÔÔ_ i
)
ÔÔi j
;
ÔÔj k
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
userGuid
] e
)
e f
;
f g
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ 
(
ÒÒ 
$str
ÒÒ )
,
ÒÒ) *
	SqlDbType
ÒÒ+ 4
.
ÒÒ4 5
NVarChar
ÒÒ5 =
,
ÒÒ= >
$num
ÒÒ? B
,
ÒÒB C 
ParameterDirection
ÒÒD V
.
ÒÒV W
Input
ÒÒW \
,
ÒÒ\ ]
propertyName
ÒÒ^ j
)
ÒÒj k
;
ÒÒk l
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ 
(
ÚÚ 
$str
ÚÚ 0
,
ÚÚ0 1
	SqlDbType
ÚÚ2 ;
.
ÚÚ; <
NVarChar
ÚÚ< D
,
ÚÚD E
-
ÚÚF G
$num
ÚÚG H
,
ÚÚH I 
ParameterDirection
ÚÚJ \
.
ÚÚ\ ]
Input
ÚÚ] b
,
ÚÚb c
propertyValue
ÚÚd q
)
ÚÚq r
;
ÚÚr s
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ 
(
ÛÛ 
$str
ÛÛ 0
,
ÛÛ0 1
	SqlDbType
ÛÛ2 ;
.
ÛÛ; <
	VarBinary
ÛÛ< E
,
ÛÛE F
-
ÛÛG H
$num
ÛÛH I
,
ÛÛI J 
ParameterDirection
ÛÛK ]
.
ÛÛ] ^
Input
ÛÛ^ c
,
ÛÛc d!
propertyValueBinary
ÛÛe x
)
ÛÛx y
;
ÛÛy z
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ 
(
ÙÙ 
$str
ÙÙ ,
,
ÙÙ, -
	SqlDbType
ÙÙ. 7
.
ÙÙ7 8
DateTime
ÙÙ8 @
,
ÙÙ@ A 
ParameterDirection
ÙÙB T
.
ÙÙT U
Input
ÙÙU Z
,
ÙÙZ [
lastUpdateDate
ÙÙ\ j
)
ÙÙj k
;
ÙÙk l
sph
ıı 
.
ıı  
DefineSqlParameter
ıı 
(
ıı 
$str
ıı )
,
ıı) *
	SqlDbType
ıı+ 4
.
ıı4 5
Bit
ıı5 8
,
ıı8 9 
ParameterDirection
ıı: L
.
ııL M
Input
ııM R
,
ııR S
isLazyLoaded
ııT `
)
ıı` a
;
ııa b
sph
ˆˆ 
.
ˆˆ 
ExecuteNonQuery
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
˜˜ 
public
˘˘ 
static
˘˘	 
void
˘˘ 
UpdateProperty
˘˘ #
(
˘˘# $
Guid
˙˙ 
userGuid
˙˙ 
,
˙˙ 
String
˚˚ 	
propertyName
˚˚
 
,
˚˚ 
String
¸¸ 	
propertyValue
¸¸
 
,
¸¸ 
byte
˝˝ 
[
˝˝ 
]
˝˝ 	!
propertyValueBinary
˝˝
 
,
˝˝ 
DateTime
˛˛ 
lastUpdateDate
˛˛ 
,
˛˛ 
bool
ˇˇ 
isLazyLoaded
ˇˇ 
)
ˇˇ 
{
ÄÄ  
SqlParameterHelper
ÅÅ 
sph
ÅÅ 
=
ÅÅ 
new
ÅÅ  
SqlParameterHelper
ÅÅ  2
(
ÅÅ2 3
ConnectionString
ÅÅ3 C
.
ÅÅC D&
GetWriteConnectionString
ÅÅD \
(
ÅÅ\ ]
)
ÅÅ] ^
,
ÅÅ^ _
$str
ÅÅ` z
,
ÅÅz {
$num
ÅÅ| }
)
ÅÅ} ~
;
ÅÅ~ 
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ 
(
ÇÇ 
$str
ÇÇ %
,
ÇÇ% &
	SqlDbType
ÇÇ' 0
.
ÇÇ0 1
UniqueIdentifier
ÇÇ1 A
,
ÇÇA B 
ParameterDirection
ÇÇC U
.
ÇÇU V
Input
ÇÇV [
,
ÇÇ[ \
userGuid
ÇÇ] e
)
ÇÇe f
;
ÇÇf g
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ )
,
ÉÉ) *
	SqlDbType
ÉÉ+ 4
.
ÉÉ4 5
NVarChar
ÉÉ5 =
,
ÉÉ= >
$num
ÉÉ? B
,
ÉÉB C 
ParameterDirection
ÉÉD V
.
ÉÉV W
Input
ÉÉW \
,
ÉÉ\ ]
propertyName
ÉÉ^ j
)
ÉÉj k
;
ÉÉk l
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ 
(
ÑÑ 
$str
ÑÑ 0
,
ÑÑ0 1
	SqlDbType
ÑÑ2 ;
.
ÑÑ; <
NVarChar
ÑÑ< D
,
ÑÑD E
-
ÑÑF G
$num
ÑÑG H
,
ÑÑH I 
ParameterDirection
ÑÑJ \
.
ÑÑ\ ]
Input
ÑÑ] b
,
ÑÑb c
propertyValue
ÑÑd q
)
ÑÑq r
;
ÑÑr s
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ 
(
ÖÖ 
$str
ÖÖ 0
,
ÖÖ0 1
	SqlDbType
ÖÖ2 ;
.
ÖÖ; <
	VarBinary
ÖÖ< E
,
ÖÖE F
-
ÖÖG H
$num
ÖÖH I
,
ÖÖI J 
ParameterDirection
ÖÖK ]
.
ÖÖ] ^
Input
ÖÖ^ c
,
ÖÖc d!
propertyValueBinary
ÖÖe x
)
ÖÖx y
;
ÖÖy z
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ 
(
ÜÜ 
$str
ÜÜ ,
,
ÜÜ, -
	SqlDbType
ÜÜ. 7
.
ÜÜ7 8
DateTime
ÜÜ8 @
,
ÜÜ@ A 
ParameterDirection
ÜÜB T
.
ÜÜT U
Input
ÜÜU Z
,
ÜÜZ [
lastUpdateDate
ÜÜ\ j
)
ÜÜj k
;
ÜÜk l
sph
áá 
.
áá  
DefineSqlParameter
áá 
(
áá 
$str
áá )
,
áá) *
	SqlDbType
áá+ 4
.
áá4 5
Bit
áá5 8
,
áá8 9 
ParameterDirection
áá: L
.
ááL M
Input
ááM R
,
ááR S
isLazyLoaded
ááT `
)
áá` a
;
ááa b
sph
àà 
.
àà 
ExecuteNonQuery
àà 
(
àà 
)
àà 
;
àà 
}
ââ 
public
ãã 
static
ãã	 
bool
ãã $
DeletePropertiesByUser
ãã +
(
ãã+ ,
Guid
ãã, 0
userGuid
ãã1 9
)
ãã9 :
{
åå  
SqlParameterHelper
çç 
sph
çç 
=
çç 
new
çç  
SqlParameterHelper
çç  2
(
çç2 3
ConnectionString
çç3 C
.
ççC D&
GetWriteConnectionString
ççD \
(
çç\ ]
)
çç] ^
,
çç^ _
$strçç` Ä
,ççÄ Å
$numççÇ É
)ççÉ Ñ
;ççÑ Ö
sph
éé 
.
éé  
DefineSqlParameter
éé 
(
éé 
$str
éé %
,
éé% &
	SqlDbType
éé' 0
.
éé0 1
UniqueIdentifier
éé1 A
,
ééA B 
ParameterDirection
ééC U
.
ééU V
Input
ééV [
,
éé[ \
userGuid
éé] e
)
éée f
;
ééf g
int
èè 
rowsAffected
èè 
=
èè 
sph
èè 
.
èè 
ExecuteNonQuery
èè )
(
èè) *
)
èè* +
;
èè+ ,
return
êê 	
(
êê
 
rowsAffected
êê 
>
êê 
-
êê 
$num
êê 
)
êê 
;
êê 
}
ëë 
}
óó 
}òò ‘
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaskQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBTaskQueue #
{ 
public,, 
static,, 
int,, 
Create,,  
(,,  !
Guid-- 
guid-- 
,-- 
Guid.. 
siteGuid.. 
,.. 
Guid// 
queuedBy// 
,// 
string00 
taskName00 
,00 
bool11 
notifyOnCompletion11 #
,11# $
string22 
notificationToEmail22 &
,22& '
string33 !
notificationFromEmail33 (
,33( )
string44 
notificationSubject44 &
,44& '
string55 
taskCompleteMessage55 &
,55& '
bool66 
canStop66 
,66 
bool77 
	canResume77 
,77 
int88 
updateFrequency88 
,88  
DateTime99 
	queuedUTC99 
,99 
double:: 
completeRatio::  
,::  !
string;; 
status;; 
,;; 
string<<  
serializedTaskObject<< '
,<<' (
string== 
serializedTaskType== %
)==% &
{>> 	
SqlParameterHelper?? 
sph?? "
=??# $
new??% (
SqlParameterHelper??) ;
(??; <
ConnectionString??< L
.??L M$
GetWriteConnectionString??M e
(??e f
)??f g
,??g h
$str??i ~
,??~ 
$num
??Ä Ç
)
??Ç É
;
??É Ñ
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# *
,@@* +
	SqlDbType@@, 5
.@@5 6
UniqueIdentifier@@6 F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
guid@@b f
)@@f g
;@@g h
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
UniqueIdentifierAA: J
,AAJ K
ParameterDirectionAAL ^
.AA^ _
InputAA_ d
,AAd e
siteGuidAAf n
)AAn o
;AAo p
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# .
,BB. /
	SqlDbTypeBB0 9
.BB9 :
UniqueIdentifierBB: J
,BBJ K
ParameterDirectionBBL ^
.BB^ _
InputBB_ d
,BBd e
queuedByBBf n
)BBn o
;BBo p
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# .
,CC. /
	SqlDbTypeCC0 9
.CC9 :
NVarCharCC: B
,CCB C
$numCCD G
,CCG H
ParameterDirectionCCI [
.CC[ \
InputCC\ a
,CCa b
taskNameCCc k
)CCk l
;CCl m
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 8
,DD8 9
	SqlDbTypeDD: C
.DDC D
BitDDD G
,DDG H
ParameterDirectionDDI [
.DD[ \
InputDD\ a
,DDa b
notifyOnCompletionDDc u
)DDu v
;DDv w
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 9
,EE9 :
	SqlDbTypeEE; D
.EED E
NVarCharEEE M
,EEM N
$numEEO R
,EER S
ParameterDirectionEET f
.EEf g
InputEEg l
,EEl m 
notificationToEmail	EEn Å
)
EEÅ Ç
;
EEÇ É
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# ;
,FF; <
	SqlDbTypeFF= F
.FFF G
NVarCharFFG O
,FFO P
$numFFQ T
,FFT U
ParameterDirectionFFV h
.FFh i
InputFFi n
,FFn o"
notificationFromEmail	FFp Ö
)
FFÖ Ü
;
FFÜ á
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 9
,GG9 :
	SqlDbTypeGG; D
.GGD E
NVarCharGGE M
,GGM N
$numGGO R
,GGR S
ParameterDirectionGGT f
.GGf g
InputGGg l
,GGl m 
notificationSubject	GGn Å
)
GGÅ Ç
;
GGÇ É
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 9
,HH9 :
	SqlDbTypeHH; D
.HHD E
NVarCharHHE M
,HHM N
-HHO P
$numHHP Q
,HHQ R
ParameterDirectionHHS e
.HHe f
InputHHf k
,HHk l 
taskCompleteMessage	HHm Ä
)
HHÄ Å
;
HHÅ Ç
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# -
,II- .
	SqlDbTypeII/ 8
.II8 9
BitII9 <
,II< =
ParameterDirectionII> P
.IIP Q
InputIIQ V
,IIV W
canStopIIX _
)II_ `
;II` a
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# /
,JJ/ 0
	SqlDbTypeJJ1 :
.JJ: ;
BitJJ; >
,JJ> ?
ParameterDirectionJJ@ R
.JJR S
InputJJS X
,JJX Y
	canResumeJJZ c
)JJc d
;JJd e
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 5
,KK5 6
	SqlDbTypeKK7 @
.KK@ A
IntKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
updateFrequencyKK` o
)KKo p
;KKp q
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# /
,LL/ 0
	SqlDbTypeLL1 :
.LL: ;
DateTimeLL; C
,LLC D
ParameterDirectionLLE W
.LLW X
InputLLX ]
,LL] ^
	queuedUTCLL_ h
)LLh i
;LLi j
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 3
,MM3 4
	SqlDbTypeMM5 >
.MM> ?
FloatMM? D
,MMD E
ParameterDirectionMMF X
.MMX Y
InputMMY ^
,MM^ _
completeRatioMM` m
)MMm n
;MMn o
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# ,
,NN, -
	SqlDbTypeNN. 7
.NN7 8
NVarCharNN8 @
,NN@ A
$numNNB E
,NNE F
ParameterDirectionNNG Y
.NNY Z
InputNNZ _
,NN_ `
statusNNa g
)NNg h
;NNh i
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# :
,OO: ;
	SqlDbTypeOO< E
.OOE F
NVarCharOOF N
,OON O
-OOP Q
$numOOQ R
,OOR S
ParameterDirectionOOT f
.OOf g
InputOOg l
,OOl m!
serializedTaskObject	OOn Ç
)
OOÇ É
;
OOÉ Ñ
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 8
,PP8 9
	SqlDbTypePP: C
.PPC D
NVarCharPPD L
,PPL M
$numPPN Q
,PPQ R
ParameterDirectionPPS e
.PPe f
InputPPf k
,PPk l
serializedTaskTypePPm 
)	PP Ä
;
PPÄ Å
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}SS 	
public`` 
static`` 
bool`` 
Update`` !
(``! "
Guidaa 
guidaa 
,aa 
DateTimebb 
startUTCbb 
,bb 
DateTimecc 
completeUTCcc  
,cc  !
DateTimedd 
lastStatusUpdateUTCdd (
,dd( )
doubleee 
completeRatioee  
,ee  !
stringff 
statusff 
)ff 
{gg 	
ifhh 
(hh 
(hh 
startUTChh 
==hh 
DateTimehh %
.hh% &
MinValuehh& .
)hh. /
&&hh0 2
(hh3 4
completeUTChh4 ?
==hh@ B
DateTimehhC K
.hhK L
MinValuehhL T
)hhT U
)hhU V
{ii 
returnjj 
UpdateStatusjj #
(jj# $
guidjj$ (
,jj( )
lastStatusUpdateUTCjj* =
,jj= >
completeRatiojj? L
,jjL M
statusjjN T
)jjT U
;jjU V
}kk 
ifmm 
(mm 
completeUTCmm 
==mm 
DateTimemm '
.mm' (
MinValuemm( 0
)mm0 1
{nn 
returnoo 
UpdateStatusoo #
(oo# $
guidoo$ (
,oo( )
startUTCoo* 2
,oo2 3
lastStatusUpdateUTCoo4 G
,ooG H
completeRatioooI V
,ooV W
statusooX ^
)oo^ _
;oo_ `
}qq 
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$strssi ~
,ss~ 
$num
ssÄ Å
)
ssÅ Ç
;
ssÇ É
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# *
,tt* +
	SqlDbTypett, 5
.tt5 6
UniqueIdentifiertt6 F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
guidttb f
)ttf g
;ttg h
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
DateTimeuu: B
,uuB C
ParameterDirectionuuD V
.uuV W
InputuuW \
,uu\ ]
startUTCuu^ f
)uuf g
;uug h
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 1
,vv1 2
	SqlDbTypevv3 <
.vv< =
DateTimevv= E
,vvE F
ParameterDirectionvvG Y
.vvY Z
InputvvZ _
,vv_ `
completeUTCvva l
)vvl m
;vvm n
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 9
,ww9 :
	SqlDbTypeww; D
.wwD E
DateTimewwE M
,wwM N
ParameterDirectionwwO a
.wwa b
Inputwwb g
,wwg h
lastStatusUpdateUTCwwi |
)ww| }
;ww} ~
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 3
,xx3 4
	SqlDbTypexx5 >
.xx> ?
Floatxx? D
,xxD E
ParameterDirectionxxF X
.xxX Y
InputxxY ^
,xx^ _
completeRatioxx` m
)xxm n
;xxn o
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# ,
,yy, -
	SqlDbTypeyy. 7
.yy7 8
NVarCharyy8 @
,yy@ A
$numyyB E
,yyE F
ParameterDirectionyyG Y
.yyY Z
InputyyZ _
,yy_ `
statusyya g
)yyg h
;yyh i
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}}} 	
private 
static 
bool 
UpdateStatus (
(( )
Guid
ÄÄ 
guid
ÄÄ 
,
ÄÄ 
DateTime
ÅÅ 
startUTC
ÅÅ 
,
ÅÅ 
DateTime
ÇÇ !
lastStatusUpdateUTC
ÇÇ (
,
ÇÇ( )
double
ÉÉ 
completeRatio
ÉÉ  
,
ÉÉ  !
string
ÑÑ 
status
ÑÑ 
)
ÑÑ 
{
ÖÖ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M&
GetWriteConnectionString
ÜÜM e
(
ÜÜe f
)
ÜÜf g
,
ÜÜg h
$strÜÜi É
,ÜÜÉ Ñ
$numÜÜÖ Ü
)ÜÜÜ á
;ÜÜá à
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# *
,
áá* +
	SqlDbType
áá, 5
.
áá5 6
UniqueIdentifier
áá6 F
,
ááF G 
ParameterDirection
ááH Z
.
ááZ [
Input
áá[ `
,
áá` a
guid
ááb f
)
ááf g
;
áág h
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
DateTime
àà: B
,
ààB C 
ParameterDirection
ààD V
.
ààV W
Input
ààW \
,
àà\ ]
startUTC
àà^ f
)
ààf g
;
ààg h
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 9
,
ââ9 :
	SqlDbType
ââ; D
.
ââD E
DateTime
ââE M
,
ââM N 
ParameterDirection
ââO a
.
ââa b
Input
ââb g
,
ââg h!
lastStatusUpdateUTC
ââi |
)
ââ| }
;
ââ} ~
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 3
,
ää3 4
	SqlDbType
ää5 >
.
ää> ?
Float
ää? D
,
ääD E 
ParameterDirection
ääF X
.
ääX Y
Input
ääY ^
,
ää^ _
completeRatio
ää` m
)
ääm n
;
ään o
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# ,
,
ãã, -
	SqlDbType
ãã. 7
.
ãã7 8
NVarChar
ãã8 @
,
ãã@ A
$num
ããB E
,
ããE F 
ParameterDirection
ããG Y
.
ããY Z
Input
ããZ _
,
ãã_ `
status
ããa g
)
ããg h
;
ããh i
int
çç 
rowsAffected
çç 
=
çç 
sph
çç "
.
çç" #
ExecuteNonQuery
çç# 2
(
çç2 3
)
çç3 4
;
çç4 5
return
éé 
(
éé 
rowsAffected
éé  
>
éé! "
$num
éé# $
)
éé$ %
;
éé% &
}
ëë 	
private
ìì 
static
ìì 
bool
ìì 
UpdateStatus
ìì (
(
ìì( )
Guid
îî 
guid
îî 
,
îî 
DateTime
ïï !
lastStatusUpdateUTC
ïï (
,
ïï( )
double
ññ 
completeRatio
ññ  
,
ññ  !
string
óó 
status
óó 
)
óó 
{
òò 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M&
GetWriteConnectionString
ôôM e
(
ôôe f
)
ôôf g
,
ôôg h
$strôôi Ñ
,ôôÑ Ö
$numôôÜ á
)ôôá à
;ôôà â
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# *
,
öö* +
	SqlDbType
öö, 5
.
öö5 6
UniqueIdentifier
öö6 F
,
ööF G 
ParameterDirection
ööH Z
.
ööZ [
Input
öö[ `
,
öö` a
guid
ööb f
)
ööf g
;
öög h
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 9
,
õõ9 :
	SqlDbType
õõ; D
.
õõD E
DateTime
õõE M
,
õõM N 
ParameterDirection
õõO a
.
õõa b
Input
õõb g
,
õõg h!
lastStatusUpdateUTC
õõi |
)
õõ| }
;
õõ} ~
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 3
,
úú3 4
	SqlDbType
úú5 >
.
úú> ?
Float
úú? D
,
úúD E 
ParameterDirection
úúF X
.
úúX Y
Input
úúY ^
,
úú^ _
completeRatio
úú` m
)
úúm n
;
úún o
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# ,
,
ùù, -
	SqlDbType
ùù. 7
.
ùù7 8
NVarChar
ùù8 @
,
ùù@ A
$num
ùùB E
,
ùùE F 
ParameterDirection
ùùG Y
.
ùùY Z
Input
ùùZ _
,
ùù_ `
status
ùùa g
)
ùùg h
;
ùùh i
int
üü 
rowsAffected
üü 
=
üü 
sph
üü "
.
üü" #
ExecuteNonQuery
üü# 2
(
üü2 3
)
üü3 4
;
üü4 5
return
†† 
(
†† 
rowsAffected
††  
>
††! "
$num
††# $
)
††$ %
;
††% &
}
££ 	
public
•• 
static
•• 
bool
••  
UpdateNotification
•• -
(
••- .
Guid
¶¶ 
guid
¶¶ 
,
¶¶ 
DateTime
ßß !
notificationSentUtc
ßß (
)
ßß( )
{
®® 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i ä
,©©ä ã
$num©©å ç
)©©ç é
;©©é è
sph
™™ 
.
™™  
DefineSqlParameter
™™ "
(
™™" #
$str
™™# *
,
™™* +
	SqlDbType
™™, 5
.
™™5 6
UniqueIdentifier
™™6 F
,
™™F G 
ParameterDirection
™™H Z
.
™™Z [
Input
™™[ `
,
™™` a
guid
™™b f
)
™™f g
;
™™g h
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 9
,
´´9 :
	SqlDbType
´´; D
.
´´D E
DateTime
´´E M
,
´´M N 
ParameterDirection
´´O a
.
´´a b
Input
´´b g
,
´´g h!
notificationSentUtc
´´i |
)
´´| }
;
´´} ~
int
≠≠ 
rowsAffected
≠≠ 
=
≠≠ 
sph
≠≠ "
.
≠≠" #
ExecuteNonQuery
≠≠# 2
(
≠≠2 3
)
≠≠3 4
;
≠≠4 5
return
ÆÆ 
(
ÆÆ 
rowsAffected
ÆÆ  
>
ÆÆ! "
$num
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
}
±± 	
public
∏∏ 
static
∏∏ 
bool
∏∏ 
Delete
∏∏ !
(
∏∏! "
Guid
∏∏" &
guid
∏∏' +
)
∏∏+ ,
{
ππ 	 
SqlParameterHelper
∫∫ 
sph
∫∫ "
=
∫∫# $
new
∫∫% ( 
SqlParameterHelper
∫∫) ;
(
∫∫; <
ConnectionString
∫∫< L
.
∫∫L M&
GetWriteConnectionString
∫∫M e
(
∫∫e f
)
∫∫f g
,
∫∫g h
$str
∫∫i ~
,
∫∫~ 
$num∫∫Ä Å
)∫∫Å Ç
;∫∫Ç É
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# *
,
ªª* +
	SqlDbType
ªª, 5
.
ªª5 6
UniqueIdentifier
ªª6 F
,
ªªF G 
ParameterDirection
ªªH Z
.
ªªZ [
Input
ªª[ `
,
ªª` a
guid
ªªb f
)
ªªf g
;
ªªg h
int
ºº 
rowsAffected
ºº 
=
ºº 
sph
ºº "
.
ºº" #
ExecuteNonQuery
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
return
ΩΩ 
(
ΩΩ 
rowsAffected
ΩΩ  
>
ΩΩ! "
$num
ΩΩ# $
)
ΩΩ$ %
;
ΩΩ% &
}
øø 	
public
¡¡ 
static
¡¡ 
bool
¡¡ 
DeleteByType
¡¡ '
(
¡¡' (
string
¡¡( .
taskType
¡¡/ 7
)
¡¡7 8
{
¬¬ 	 
SqlParameterHelper
√√ 
sph
√√ "
=
√√# $
new
√√% ( 
SqlParameterHelper
√√) ;
(
√√; <
ConnectionString
√√< L
.
√√L M&
GetWriteConnectionString
√√M e
(
√√e f
)
√√f g
,
√√g h
$str√√i Ñ
,√√Ñ Ö
$num√√Ü á
)√√á à
;√√à â
sph
ƒƒ 
.
ƒƒ  
DefineSqlParameter
ƒƒ "
(
ƒƒ" #
$str
ƒƒ# .
,
ƒƒ. /
	SqlDbType
ƒƒ0 9
.
ƒƒ9 :
NVarChar
ƒƒ: B
,
ƒƒB C
$num
ƒƒD G
,
ƒƒG H 
ParameterDirection
ƒƒI [
.
ƒƒ[ \
Input
ƒƒ\ a
,
ƒƒa b
taskType
ƒƒc k
)
ƒƒk l
;
ƒƒl m
int
≈≈ 
rowsAffected
≈≈ 
=
≈≈ 
sph
≈≈ "
.
≈≈" #
ExecuteNonQuery
≈≈# 2
(
≈≈2 3
)
≈≈3 4
;
≈≈4 5
return
∆∆ 
(
∆∆ 
rowsAffected
∆∆  
>
∆∆! "
$num
∆∆# $
)
∆∆$ %
;
∆∆% &
}
»» 	
public
ŒŒ 
static
ŒŒ 
void
ŒŒ 
DeleteCompleted
ŒŒ *
(
ŒŒ* +
)
ŒŒ+ ,
{
œœ 	
	SqlHelper
—— 
.
—— 
ExecuteNonQuery
—— %
(
——% &
ConnectionString
““  
.
““  !&
GetWriteConnectionString
““! 9
(
““9 :
)
““: ;
,
““; <
CommandType
”” 
.
”” 
StoredProcedure
”” +
,
””+ ,
$str
‘‘ .
,
‘‘. /
null
’’ 
)
’’ 
;
’’ 
}
◊◊ 	
public
ÎÎ 
static
ÎÎ 
IDataReader
ÎÎ !
GetOne
ÎÎ" (
(
ÎÎ( )
Guid
ÎÎ) -
guid
ÎÎ. 2
)
ÎÎ2 3
{
ÏÏ 	 
SqlParameterHelper
ÌÌ 
sph
ÌÌ "
=
ÌÌ# $
new
ÌÌ% ( 
SqlParameterHelper
ÌÌ) ;
(
ÌÌ; <
ConnectionString
ÌÌ< L
.
ÌÌL M%
GetReadConnectionString
ÌÌM d
(
ÌÌd e
)
ÌÌe f
,
ÌÌf g
$strÌÌh Ä
,ÌÌÄ Å
$numÌÌÇ É
)ÌÌÉ Ñ
;ÌÌÑ Ö
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# *
,
ÓÓ* +
	SqlDbType
ÓÓ, 5
.
ÓÓ5 6
UniqueIdentifier
ÓÓ6 F
,
ÓÓF G 
ParameterDirection
ÓÓH Z
.
ÓÓZ [
Input
ÓÓ[ `
,
ÓÓ` a
guid
ÓÓb f
)
ÓÓf g
;
ÓÓg h
return
ÔÔ 
sph
ÔÔ 
.
ÔÔ 
ExecuteReader
ÔÔ $
(
ÔÔ$ %
)
ÔÔ% &
;
ÔÔ& '
}
 	
public
ˆˆ 
static
ˆˆ 
int
ˆˆ 
GetCount
ˆˆ "
(
ˆˆ" #
)
ˆˆ# $
{
˜˜ 	
return
˘˘ 
Convert
˘˘ 
.
˘˘ 
ToInt32
˘˘ "
(
˘˘" #
	SqlHelper
˘˘# ,
.
˘˘, -
ExecuteScalar
˘˘- :
(
˘˘: ;
ConnectionString
˙˙  
.
˙˙  !%
GetReadConnectionString
˙˙! 8
(
˙˙8 9
)
˙˙9 :
,
˙˙: ;
CommandType
˚˚ 
.
˚˚ 
StoredProcedure
˚˚ +
,
˚˚+ ,
$str
¸¸ '
,
¸¸' (
null
˝˝ 
)
˝˝ 
)
˝˝ 
;
˝˝ 
}
ˇˇ 	
public
ÖÖ 
static
ÖÖ 
int
ÖÖ 
GetCount
ÖÖ "
(
ÖÖ" #
Guid
ÖÖ# '
siteGuid
ÖÖ( 0
)
ÖÖ0 1
{
ÜÜ 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M%
GetReadConnectionString
ááM d
(
áád e
)
ááe f
,
ááf g
$strááh Ö
,ááÖ Ü
$numááá à
)ááà â
;ááâ ä
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
return
ää 
Convert
ää 
.
ää 
ToInt32
ää "
(
ää" #
sph
ää# &
.
ää& '
ExecuteScalar
ää' 4
(
ää4 5
)
ää5 6
)
ää6 7
;
ää7 8
}
çç 	
public
èè 
static
èè 
int
èè &
GetCountUnfinishedByType
èè 2
(
èè2 3
string
èè3 9
taskType
èè: B
)
èèB C
{
êê 	 
SqlParameterHelper
ëë 
sph
ëë "
=
ëë# $
new
ëë% ( 
SqlParameterHelper
ëë) ;
(
ëë; <
ConnectionString
ëë< L
.
ëëL M%
GetReadConnectionString
ëëM d
(
ëëd e
)
ëëe f
,
ëëf g
$strëëh å
,ëëå ç
$numëëé è
)ëëè ê
;ëëê ë
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# .
,
íí. /
	SqlDbType
íí0 9
.
íí9 :
NVarChar
íí: B
,
ííB C
$num
ííD G
,
ííG H 
ParameterDirection
ííI [
.
íí[ \
Input
íí\ a
,
íía b
taskType
ííc k
)
íík l
;
ííl m
return
îî 
Convert
îî 
.
îî 
ToInt32
îî "
(
îî" #
sph
îî# &
.
îî& '
ExecuteScalar
îî' 4
(
îî4 5
)
îî5 6
)
îî6 7
;
îî7 8
}
óó 	
public
úú 
static
úú 
int
úú  
GetCountUnfinished
úú ,
(
úú, -
)
úú- .
{
ùù 	
return
üü 
Convert
üü 
.
üü 
ToInt32
üü "
(
üü" #
	SqlHelper
üü# ,
.
üü, -
ExecuteScalar
üü- :
(
üü: ;
ConnectionString
††  
.
††  !%
GetReadConnectionString
††! 8
(
††8 9
)
††9 :
,
††: ;
CommandType
°° 
.
°° 
StoredProcedure
°° +
,
°°+ ,
$str
¢¢ 1
,
¢¢1 2
null
££ 
)
££ 
)
££ 
;
££ 
}
•• 	
public
´´ 
static
´´ 
int
´´  
GetCountUnfinished
´´ ,
(
´´, -
Guid
´´- 1
siteGuid
´´2 :
)
´´: ;
{
¨¨ 	 
SqlParameterHelper
≠≠ 
sph
≠≠ "
=
≠≠# $
new
≠≠% ( 
SqlParameterHelper
≠≠) ;
(
≠≠; <
ConnectionString
≠≠< L
.
≠≠L M%
GetReadConnectionString
≠≠M d
(
≠≠d e
)
≠≠e f
,
≠≠f g
$str≠≠h è
,≠≠è ê
$num≠≠ë í
)≠≠í ì
;≠≠ì î
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# .
,
ÆÆ. /
	SqlDbType
ÆÆ0 9
.
ÆÆ9 :
UniqueIdentifier
ÆÆ: J
,
ÆÆJ K 
ParameterDirection
ÆÆL ^
.
ÆÆ^ _
Input
ÆÆ_ d
,
ÆÆd e
siteGuid
ÆÆf n
)
ÆÆn o
;
ÆÆo p
return
∞∞ 
Convert
∞∞ 
.
∞∞ 
ToInt32
∞∞ "
(
∞∞" #
sph
∞∞# &
.
∞∞& '
ExecuteScalar
∞∞' 4
(
∞∞4 5
)
∞∞5 6
)
∞∞6 7
;
∞∞7 8
}
≥≥ 	
public
∏∏ 
static
∏∏ 
IDataReader
∏∏ ! 
GetTasksNotStarted
∏∏" 4
(
∏∏4 5
)
∏∏5 6
{
ππ 	
return
ªª 
	SqlHelper
ªª 
.
ªª 
ExecuteReader
ªª *
(
ªª* +
ConnectionString
ºº  
.
ºº  !%
GetReadConnectionString
ºº! 8
(
ºº8 9
)
ºº9 :
,
ºº: ;
CommandType
ΩΩ 
.
ΩΩ 
StoredProcedure
ΩΩ +
,
ΩΩ+ ,
$str
ææ 4
,
ææ4 5
null
øø 
)
øø 
;
øø 
}
¡¡ 	
public
«« 
static
«« 
IDataReader
«« !%
GetTasksForNotification
««" 9
(
««9 :
)
««: ;
{
»» 	
return
   
	SqlHelper
   
.
   
ExecuteReader
   *
(
  * +
ConnectionString
ÀÀ  
.
ÀÀ  !%
GetReadConnectionString
ÀÀ! 8
(
ÀÀ8 9
)
ÀÀ9 :
,
ÀÀ: ;
CommandType
ÃÃ 
.
ÃÃ 
StoredProcedure
ÃÃ +
,
ÃÃ+ ,
$str
ÕÕ 4
,
ÕÕ4 5
null
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
–– 	
public
÷÷ 
static
÷÷ 
IDataReader
÷÷ !
GetUnfinished
÷÷" /
(
÷÷/ 0
)
÷÷0 1
{
◊◊ 	
return
ŸŸ 
	SqlHelper
ŸŸ 
.
ŸŸ 
ExecuteReader
ŸŸ *
(
ŸŸ* +
ConnectionString
⁄⁄  
.
⁄⁄  !%
GetReadConnectionString
⁄⁄! 8
(
⁄⁄8 9
)
⁄⁄9 :
,
⁄⁄: ;
CommandType
€€ 
.
€€ 
StoredProcedure
€€ +
,
€€+ ,
$str
‹‹ /
,
‹‹/ 0
null
›› 
)
›› 
;
›› 
}
ﬂﬂ 	
public
ÊÊ 
static
ÊÊ 
IDataReader
ÊÊ !
GetUnfinished
ÊÊ" /
(
ÊÊ/ 0
Guid
ÊÊ0 4
siteGuid
ÊÊ5 =
)
ÊÊ= >
{
ÁÁ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh ç
,ËËç é
$numËËè ê
)ËËê ë
;ËËë í
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# .
,
ÈÈ. /
	SqlDbType
ÈÈ0 9
.
ÈÈ9 :
UniqueIdentifier
ÈÈ: J
,
ÈÈJ K 
ParameterDirection
ÈÈL ^
.
ÈÈ^ _
Input
ÈÈ_ d
,
ÈÈd e
siteGuid
ÈÈf n
)
ÈÈn o
;
ÈÈo p
return
ÍÍ 
sph
ÍÍ 
.
ÍÍ 
ExecuteReader
ÍÍ $
(
ÍÍ$ %
)
ÍÍ% &
;
ÍÍ& '
}
ÏÏ 	
public
ÛÛ 
static
ÛÛ 
IDataReader
ÛÛ !
GetPage
ÛÛ" )
(
ÛÛ) *
int
ÙÙ 

pageNumber
ÙÙ 
,
ÙÙ 
int
ıı 
pageSize
ıı 
,
ıı 
out
ˆˆ 
int
ˆˆ 

totalPages
ˆˆ 
)
ˆˆ 
{
˜˜ 	

totalPages
¯¯ 
=
¯¯ 
$num
¯¯ 
;
¯¯ 
int
˘˘ 
	totalRows
˘˘ 
=
˙˙ 
GetCount
˙˙ 
(
˙˙ 
)
˙˙ 
;
˙˙ 
if
¸¸ 
(
¸¸ 
pageSize
¸¸ 
>
¸¸ 
$num
¸¸ 
)
¸¸ 

totalPages
¸¸ (
=
¸¸) *
	totalRows
¸¸+ 4
/
¸¸5 6
pageSize
¸¸7 ?
;
¸¸? @
if
˛˛ 
(
˛˛ 
	totalRows
˛˛ 
<=
˛˛ 
pageSize
˛˛ %
)
˛˛% &
{
ˇˇ 

totalPages
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
}
ÅÅ 
else
ÇÇ 
{
ÉÉ 
int
ÑÑ 
	remainder
ÑÑ 
;
ÑÑ 
Math
ÖÖ 
.
ÖÖ 
DivRem
ÖÖ 
(
ÖÖ 
	totalRows
ÖÖ %
,
ÖÖ% &
pageSize
ÖÖ' /
,
ÖÖ/ 0
out
ÖÖ1 4
	remainder
ÖÖ5 >
)
ÖÖ> ?
;
ÖÖ? @
if
ÜÜ 
(
ÜÜ 
	remainder
ÜÜ 
>
ÜÜ 
$num
ÜÜ  !
)
ÜÜ! "
{
áá 

totalPages
àà 
+=
àà !
$num
àà" #
;
àà# $
}
ââ 
}
ää  
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M%
GetReadConnectionString
ååM d
(
ååd e
)
ååe f
,
ååf g
$strååh Å
,ååÅ Ç
$numååÉ Ñ
)ååÑ Ö
;ååÖ Ü
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
Int
çç< ?
,
çç? @ 
ParameterDirection
ççA S
.
ççS T
Input
ççT Y
,
ççY Z

pageNumber
çç[ e
)
ççe f
;
ççf g
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# .
,
éé. /
	SqlDbType
éé0 9
.
éé9 :
Int
éé: =
,
éé= > 
ParameterDirection
éé? Q
.
ééQ R
Input
ééR W
,
ééW X
pageSize
ééY a
)
ééa b
;
ééb c
return
èè 
sph
èè 
.
èè 
ExecuteReader
èè $
(
èè$ %
)
èè% &
;
èè& '
}
ëë 	
public
ôô 
static
ôô 
IDataReader
ôô !
GetPageBySite
ôô" /
(
ôô/ 0
Guid
öö 
siteGuid
öö 
,
öö 
int
õõ 

pageNumber
õõ 
,
õõ 
int
úú 
pageSize
úú 
,
úú 
out
ùù 
int
ùù 

totalPages
ùù 
)
ùù 
{
ûû 	

totalPages
üü 
=
üü 
$num
üü 
;
üü 
int
†† 
	totalRows
†† 
=
°° 
GetCount
°° 
(
°° 
siteGuid
°° #
)
°°# $
;
°°$ %
if
££ 
(
££ 
pageSize
££ 
>
££ 
$num
££ 
)
££ 

totalPages
££ (
=
££) *
	totalRows
££+ 4
/
££5 6
pageSize
££7 ?
;
££? @
if
•• 
(
•• 
	totalRows
•• 
<=
•• 
pageSize
•• %
)
••% &
{
¶¶ 

totalPages
ßß 
=
ßß 
$num
ßß 
;
ßß 
}
®® 
else
©© 
{
™™ 
int
´´ 
	remainder
´´ 
;
´´ 
Math
¨¨ 
.
¨¨ 
DivRem
¨¨ 
(
¨¨ 
	totalRows
¨¨ %
,
¨¨% &
pageSize
¨¨' /
,
¨¨/ 0
out
¨¨1 4
	remainder
¨¨5 >
)
¨¨> ?
;
¨¨? @
if
≠≠ 
(
≠≠ 
	remainder
≠≠ 
>
≠≠ 
$num
≠≠  !
)
≠≠! "
{
ÆÆ 

totalPages
ØØ 
+=
ØØ !
$num
ØØ" #
;
ØØ# $
}
∞∞ 
}
±±  
SqlParameterHelper
≥≥ 
sph
≥≥ "
=
≥≥# $
new
≥≥% ( 
SqlParameterHelper
≥≥) ;
(
≥≥; <
ConnectionString
≥≥< L
.
≥≥L M%
GetReadConnectionString
≥≥M d
(
≥≥d e
)
≥≥e f
,
≥≥f g
$str≥≥h á
,≥≥á à
$num≥≥â ä
)≥≥ä ã
;≥≥ã å
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
UniqueIdentifier
¥¥: J
,
¥¥J K 
ParameterDirection
¥¥L ^
.
¥¥^ _
Input
¥¥_ d
,
¥¥d e
siteGuid
¥¥f n
)
¥¥n o
;
¥¥o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 0
,
µµ0 1
	SqlDbType
µµ2 ;
.
µµ; <
Int
µµ< ?
,
µµ? @ 
ParameterDirection
µµA S
.
µµS T
Input
µµT Y
,
µµY Z

pageNumber
µµ[ e
)
µµe f
;
µµf g
sph
∂∂ 
.
∂∂  
DefineSqlParameter
∂∂ "
(
∂∂" #
$str
∂∂# .
,
∂∂. /
	SqlDbType
∂∂0 9
.
∂∂9 :
Int
∂∂: =
,
∂∂= > 
ParameterDirection
∂∂? Q
.
∂∂Q R
Input
∂∂R W
,
∂∂W X
pageSize
∂∂Y a
)
∂∂a b
;
∂∂b c
return
∑∑ 
sph
∑∑ 
.
∑∑ 
ExecuteReader
∑∑ $
(
∑∑$ %
)
∑∑% &
;
∑∑& '
}
ππ 	
public
¿¿ 
static
¿¿ 
IDataReader
¿¿ !
GetPageUnfinished
¿¿" 3
(
¿¿3 4
int
¡¡ 

pageNumber
¡¡ 
,
¡¡ 
int
¬¬ 
pageSize
¬¬ 
,
¬¬ 
out
√√ 
int
√√ 

totalPages
√√ 
)
√√ 
{
ƒƒ 	

totalPages
≈≈ 
=
≈≈ 
$num
≈≈ 
;
≈≈ 
int
∆∆ 
	totalRows
∆∆ 
=
««  
GetCountUnfinished
«« $
(
««$ %
)
««% &
;
««& '
if
…… 
(
…… 
pageSize
…… 
>
…… 
$num
…… 
)
…… 

totalPages
…… (
=
……) *
	totalRows
……+ 4
/
……5 6
pageSize
……7 ?
;
……? @
if
ÀÀ 
(
ÀÀ 
	totalRows
ÀÀ 
<=
ÀÀ 
pageSize
ÀÀ %
)
ÀÀ% &
{
ÃÃ 

totalPages
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
;
ÕÕ 
}
ŒŒ 
else
œœ 
{
–– 
int
—— 
	remainder
—— 
;
—— 
Math
““ 
.
““ 
DivRem
““ 
(
““ 
	totalRows
““ %
,
““% &
pageSize
““' /
,
““/ 0
out
““1 4
	remainder
““5 >
)
““> ?
;
““? @
if
”” 
(
”” 
	remainder
”” 
>
”” 
$num
””  !
)
””! "
{
‘‘ 

totalPages
’’ 
+=
’’ !
$num
’’" #
;
’’# $
}
÷÷ 
}
◊◊  
SqlParameterHelper
ŸŸ 
sph
ŸŸ "
=
ŸŸ# $
new
ŸŸ% ( 
SqlParameterHelper
ŸŸ) ;
(
ŸŸ; <
ConnectionString
ŸŸ< L
.
ŸŸL M%
GetReadConnectionString
ŸŸM d
(
ŸŸd e
)
ŸŸe f
,
ŸŸf g
$strŸŸh ã
,ŸŸã å
$numŸŸç é
)ŸŸé è
;ŸŸè ê
sph
⁄⁄ 
.
⁄⁄  
DefineSqlParameter
⁄⁄ "
(
⁄⁄" #
$str
⁄⁄# 0
,
⁄⁄0 1
	SqlDbType
⁄⁄2 ;
.
⁄⁄; <
Int
⁄⁄< ?
,
⁄⁄? @ 
ParameterDirection
⁄⁄A S
.
⁄⁄S T
Input
⁄⁄T Y
,
⁄⁄Y Z

pageNumber
⁄⁄[ e
)
⁄⁄e f
;
⁄⁄f g
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# .
,
€€. /
	SqlDbType
€€0 9
.
€€9 :
Int
€€: =
,
€€= > 
ParameterDirection
€€? Q
.
€€Q R
Input
€€R W
,
€€W X
pageSize
€€Y a
)
€€a b
;
€€b c
return
‹‹ 
sph
‹‹ 
.
‹‹ 
ExecuteReader
‹‹ $
(
‹‹$ %
)
‹‹% &
;
‹‹& '
}
ﬁﬁ 	
public
ÊÊ 
static
ÊÊ 
IDataReader
ÊÊ !%
GetPageUnfinishedBySite
ÊÊ" 9
(
ÊÊ9 :
Guid
ÁÁ 
siteGuid
ÁÁ 
,
ÁÁ 
int
ËË 

pageNumber
ËË 
,
ËË 
int
ÈÈ 
pageSize
ÈÈ 
,
ÈÈ 
out
ÍÍ 
int
ÍÍ 

totalPages
ÍÍ 
)
ÍÍ 
{
ÎÎ 	

totalPages
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
int
ÌÌ 
	totalRows
ÌÌ 
=
ÓÓ  
GetCountUnfinished
ÓÓ $
(
ÓÓ$ %
siteGuid
ÓÓ% -
)
ÓÓ- .
;
ÓÓ. /
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
ÚÚ 
(
ÚÚ 
	totalRows
ÚÚ 
<=
ÚÚ 
pageSize
ÚÚ %
)
ÚÚ% &
{
ÛÛ 

totalPages
ÙÙ 
=
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
}
ıı 
else
ˆˆ 
{
˜˜ 
int
¯¯ 
	remainder
¯¯ 
;
¯¯ 
Math
˘˘ 
.
˘˘ 
DivRem
˘˘ 
(
˘˘ 
	totalRows
˘˘ %
,
˘˘% &
pageSize
˘˘' /
,
˘˘/ 0
out
˘˘1 4
	remainder
˘˘5 >
)
˘˘> ?
;
˘˘? @
if
˙˙ 
(
˙˙ 
	remainder
˙˙ 
>
˙˙ 
$num
˙˙  !
)
˙˙! "
{
˚˚ 

totalPages
¸¸ 
+=
¸¸ !
$num
¸¸" #
;
¸¸# $
}
˝˝ 
}
˛˛  
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh ë
,ÄÄë í
$numÄÄì î
)ÄÄî ï
;ÄÄï ñ
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# .
,
ÅÅ. /
	SqlDbType
ÅÅ0 9
.
ÅÅ9 :
UniqueIdentifier
ÅÅ: J
,
ÅÅJ K 
ParameterDirection
ÅÅL ^
.
ÅÅ^ _
Input
ÅÅ_ d
,
ÅÅd e
siteGuid
ÅÅf n
)
ÅÅn o
;
ÅÅo p
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 0
,
ÇÇ0 1
	SqlDbType
ÇÇ2 ;
.
ÇÇ; <
Int
ÇÇ< ?
,
ÇÇ? @ 
ParameterDirection
ÇÇA S
.
ÇÇS T
Input
ÇÇT Y
,
ÇÇY Z

pageNumber
ÇÇ[ e
)
ÇÇe f
;
ÇÇf g
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
Int
ÉÉ: =
,
ÉÉ= > 
ParameterDirection
ÉÉ? Q
.
ÉÉQ R
Input
ÉÉR W
,
ÉÉW X
pageSize
ÉÉY a
)
ÉÉa b
;
ÉÉb c
return
ÑÑ 
sph
ÑÑ 
.
ÑÑ 
ExecuteReader
ÑÑ $
(
ÑÑ$ %
)
ÑÑ% &
;
ÑÑ& '
}
ÜÜ 	
}
àà 
}ää âh
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaxClass.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 

DBTaxClass "
{ 
public 
static 
int 
Create  
(  !
Guid 
guid 
, 
Guid 
siteGuid 
, 
string 
title 
, 
string   
description   
,   
DateTime!! 
lastModified!! !
,!!! "
DateTime"" 
created"" 
)"" 
{## 	
SqlParameterHelper%% 
sph%% "
=%%# $
new%%% (
SqlParameterHelper%%) ;
(%%; <
ConnectionString%%< L
.%%L M$
GetWriteConnectionString%%M e
(%%e f
)%%f g
,%%g h
$str%%i }
,%%} ~
$num	%% Ä
)
%%Ä Å
;
%%Å Ç
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# *
,&&* +
	SqlDbType&&, 5
.&&5 6
UniqueIdentifier&&6 F
,&&F G
ParameterDirection&&H Z
.&&Z [
Input&&[ `
,&&` a
guid&&b f
)&&f g
;&&g h
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# .
,''. /
	SqlDbType''0 9
.''9 :
UniqueIdentifier'': J
,''J K
ParameterDirection''L ^
.''^ _
Input''_ d
,''d e
siteGuid''f n
)''n o
;''o p
sph(( 
.(( 
DefineSqlParameter(( "
(((" #
$str((# +
,((+ ,
	SqlDbType((- 6
.((6 7
NVarChar((7 ?
,((? @
$num((A D
,((D E
ParameterDirection((F X
.((X Y
Input((Y ^
,((^ _
title((` e
)((e f
;((f g
sph)) 
.)) 
DefineSqlParameter)) "
())" #
$str))# 1
,))1 2
	SqlDbType))3 <
.))< =
NText))= B
,))B C
ParameterDirection))D V
.))V W
Input))W \
,))\ ]
description))^ i
)))i j
;))j k
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# 2
,**2 3
	SqlDbType**4 =
.**= >
DateTime**> F
,**F G
ParameterDirection**H Z
.**Z [
Input**[ `
,**` a
lastModified**b n
)**n o
;**o p
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# -
,++- .
	SqlDbType++/ 8
.++8 9
DateTime++9 A
,++A B
ParameterDirection++C U
.++U V
Input++V [
,++[ \
created++] d
)++d e
;++e f
int,, 
rowsAffected,, 
=,, 
sph,, "
.,," #
ExecuteNonQuery,,# 2
(,,2 3
),,3 4
;,,4 5
return-- 
rowsAffected-- 
;--  
}// 	
public11 
static11 
bool11 
Update11 !
(11! "
Guid22 
guid22 
,22 
string33 
title33 
,33 
string44 
description44 
,44 
DateTime55 
lastModified55 !
,55! "
DateTime66 
created66 
)66 
{77 	
SqlParameterHelper99 
sph99 "
=99# $
new99% (
SqlParameterHelper99) ;
(99; <
ConnectionString99< L
.99L M$
GetWriteConnectionString99M e
(99e f
)99f g
,99g h
$str99i }
,99} ~
$num	99 Ä
)
99Ä Å
;
99Å Ç
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# *
,::* +
	SqlDbType::, 5
.::5 6
UniqueIdentifier::6 F
,::F G
ParameterDirection::H Z
.::Z [
Input::[ `
,::` a
guid::b f
)::f g
;::g h
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# +
,;;+ ,
	SqlDbType;;- 6
.;;6 7
NVarChar;;7 ?
,;;? @
$num;;A D
,;;D E
ParameterDirection;;F X
.;;X Y
Input;;Y ^
,;;^ _
title;;` e
);;e f
;;;f g
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# 1
,<<1 2
	SqlDbType<<3 <
.<<< =
NText<<= B
,<<B C
ParameterDirection<<D V
.<<V W
Input<<W \
,<<\ ]
description<<^ i
)<<i j
;<<j k
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 2
,==2 3
	SqlDbType==4 =
.=== >
DateTime==> F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
lastModified==b n
)==n o
;==o p
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># -
,>>- .
	SqlDbType>>/ 8
.>>8 9
DateTime>>9 A
,>>A B
ParameterDirection>>C U
.>>U V
Input>>V [
,>>[ \
created>>] d
)>>d e
;>>e f
int?? 
rowsAffected?? 
=?? 
sph?? "
.??" #
ExecuteNonQuery??# 2
(??2 3
)??3 4
;??4 5
return@@ 
(@@ 
rowsAffected@@  
>@@! "
$num@@# $
)@@$ %
;@@% &
}CC 	
publicEE 
staticEE 
boolEE 
DeleteEE !
(EE! "
GuidEE" &
guidEE' +
)EE+ ,
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi }
,GG} ~
$num	GG Ä
)
GGÄ Å
;
GGÅ Ç
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
UniqueIdentifierHH6 F
,HHF G
ParameterDirectionHHH Z
.HHZ [
InputHH[ `
,HH` a
guidHHb f
)HHf g
;HHg h
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicNN 
staticNN 
IDataReaderNN !
GetOneNN" (
(NN( )
GuidNN) -
guidNN. 2
)NN2 3
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M#
GetReadConnectionStringPPM d
(PPd e
)PPe f
,PPf g
$strPPh 
,	PP Ä
$num
PPÅ Ç
)
PPÇ É
;
PPÉ Ñ
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
UniqueIdentifierQQ6 F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
guidQQb f
)QQf g
;QQg h
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}VV 	
publicXX 
staticXX 
IDataReaderXX !
	GetBySiteXX" +
(XX+ ,
GuidXX, 0
siteGuidXX1 9
)XX9 :
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh Ç
,
ZZÇ É
$num
ZZÑ Ö
)
ZZÖ Ü
;
ZZÜ á
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# .
,[[. /
	SqlDbType[[0 9
.[[9 :
UniqueIdentifier[[: J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
siteGuid[[f n
)[[n o
;[[o p
return\\ 
sph\\ 
.\\ 
ExecuteReader\\ $
(\\$ %
)\\% &
;\\& '
}`` 	
publicbb 
staticbb 
intbb 
GetCountBySitebb (
(bb( )
Guidbb) -
siteGuidbb. 6
)bb6 7
{cc 	
SqlParameterHelperdd 
sphdd "
=dd# $
newdd% (
SqlParameterHelperdd) ;
(dd; <
ConnectionStringdd< L
.ddL M#
GetReadConnectionStringddM d
(ddd e
)dde f
,ddf g
$str	ddh Å
,
ddÅ Ç
$num
ddÉ Ñ
)
ddÑ Ö
;
ddÖ Ü
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# .
,ee. /
	SqlDbTypeee0 9
.ee9 :
UniqueIdentifieree: J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e
siteGuideef n
)een o
;eeo p
returnff 
Convertff 
.ff 
ToInt32ff "
(ff" #
sphff# &
.ff& '
ExecuteScalarff' 4
(ff4 5
)ff5 6
)ff6 7
;ff7 8
}jj 	
publicll 
staticll 
IDataReaderll !
GetPagell" )
(ll) *
Guidmm 
siteGuidmm 
,mm 
intnn 

pageNumbernn 
,nn 
intoo 
pageSizeoo 
,oo 
outpp 
intpp 

totalPagespp 
)pp 
{qq 	

totalPagesss 
=ss 
$numss 
;ss 
inttt 
	totalRowstt 
=uu 
GetCountBySiteuu  
(uu  !
siteGuiduu! )
)uu) *
;uu* +
ifww 
(ww 
pageSizeww 
>ww 
$numww 
)ww 

totalPagesww (
=ww) *
	totalRowsww+ 4
/ww5 6
pageSizeww7 ?
;ww? @
ifyy 
(yy 
	totalRowsyy 
<=yy 
pageSizeyy %
)yy% &
{zz 

totalPages{{ 
={{ 
$num{{ 
;{{ 
}|| 
else}} 
{~~ 
int 
	remainder 
; 
Math
ÄÄ 
.
ÄÄ 
DivRem
ÄÄ 
(
ÄÄ 
	totalRows
ÄÄ %
,
ÄÄ% &
pageSize
ÄÄ' /
,
ÄÄ/ 0
out
ÄÄ1 4
	remainder
ÄÄ5 >
)
ÄÄ> ?
;
ÄÄ? @
if
ÅÅ 
(
ÅÅ 
	remainder
ÅÅ 
>
ÅÅ 
$num
ÅÅ  !
)
ÅÅ! "
{
ÇÇ 

totalPages
ÉÉ 
+=
ÉÉ !
$num
ÉÉ" #
;
ÉÉ# $
}
ÑÑ 
}
ÖÖ  
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M%
GetReadConnectionString
ááM d
(
áád e
)
ááe f
,
ááf g
$strááh Ä
,ááÄ Å
$numááÇ É
)ááÉ Ñ
;ááÑ Ö
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 0
,
ââ0 1
	SqlDbType
ââ2 ;
.
ââ; <
Int
ââ< ?
,
ââ? @ 
ParameterDirection
ââA S
.
ââS T
Input
ââT Y
,
ââY Z

pageNumber
ââ[ e
)
ââe f
;
ââf g
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
Int
ää: =
,
ää= > 
ParameterDirection
ää? Q
.
ääQ R
Input
ääR W
,
ääW X
pageSize
ääY a
)
ääa b
;
ääb c
return
ãã 
sph
ãã 
.
ãã 
ExecuteReader
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
}
éé 	
}
íí 
}ìì ìì
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaxRate.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 
	DBTaxRate !
{ 
public 
static 
int 
Create  
(  !
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid   
geoZoneGuid   
,   
Guid!! 
taxClassGuid!! 
,!! 
int"" 
priority"" 
,"" 
decimal## 
rate## 
,## 
string$$ 
description$$ 
,$$ 
DateTime%% 
created%% 
,%% 
Guid&& 
	createdBy&& 
,&& 
DateTime'' 
lastModified'' !
,''! "
Guid(( 

modifiedBy(( 
)(( 
{)) 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i |
,++| }
$num	++~ Ä
)
++Ä Å
;
++Å Ç
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# .
,--. /
	SqlDbType--0 9
.--9 :
UniqueIdentifier--: J
,--J K
ParameterDirection--L ^
.--^ _
Input--_ d
,--d e
siteGuid--f n
)--n o
;--o p
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# 1
,..1 2
	SqlDbType..3 <
...< =
UniqueIdentifier..= M
,..M N
ParameterDirection..O a
...a b
Input..b g
,..g h
geoZoneGuid..i t
)..t u
;..u v
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# 2
,//2 3
	SqlDbType//4 =
.//= >
UniqueIdentifier//> N
,//N O
ParameterDirection//P b
.//b c
Input//c h
,//h i
taxClassGuid//j v
)//v w
;//w x
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# .
,00. /
	SqlDbType000 9
.009 :
Int00: =
,00= >
ParameterDirection00? Q
.00Q R
Input00R W
,00W X
priority00Y a
)00a b
;00b c
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
Decimal116 =
,11= >
ParameterDirection11? Q
.11Q R
Input11R W
,11W X
rate11Y ]
)11] ^
;11^ _
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# 1
,221 2
	SqlDbType223 <
.22< =
NVarChar22= E
,22E F
$num22G J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
description22f q
)22q r
;22r s
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# -
,33- .
	SqlDbType33/ 8
.338 9
DateTime339 A
,33A B
ParameterDirection33C U
.33U V
Input33V [
,33[ \
created33] d
)33d e
;33e f
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# /
,44/ 0
	SqlDbType441 :
.44: ;
UniqueIdentifier44; K
,44K L
ParameterDirection44M _
.44_ `
Input44` e
,44e f
	createdBy44g p
)44p q
;44q r
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 2
,552 3
	SqlDbType554 =
.55= >
DateTime55> F
,55F G
ParameterDirection55H Z
.55Z [
Input55[ `
,55` a
lastModified55b n
)55n o
;55o p
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
UniqueIdentifier66< L
,66L M
ParameterDirection66N `
.66` a
Input66a f
,66f g

modifiedBy66h r
)66r s
;66s t
int77 
rowsAffected77 
=77 
sph77 "
.77" #
ExecuteNonQuery77# 2
(772 3
)773 4
;774 5
return88 
rowsAffected88 
;88  
};; 	
public== 
static== 
bool== 
Update== !
(==! "
Guid>> 
guid>> 
,>> 
Guid?? 
geoZoneGuid?? 
,?? 
Guid@@ 
taxClassGuid@@ 
,@@ 
intAA 
priorityAA 
,AA 
decimalBB 
rateBB 
,BB 
stringCC 
descriptionCC 
,CC 
DateTimeDD 
lastModifiedDD !
,DD! "
GuidEE 

modifiedByEE 
)EE 
{FF 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$strHHi |
,HH| }
$numHH~ 
)	HH Ä
;
HHÄ Å
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# 1
,JJ1 2
	SqlDbTypeJJ3 <
.JJ< =
UniqueIdentifierJJ= M
,JJM N
ParameterDirectionJJO a
.JJa b
InputJJb g
,JJg h
geoZoneGuidJJi t
)JJt u
;JJu v
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 2
,KK2 3
	SqlDbTypeKK4 =
.KK= >
UniqueIdentifierKK> N
,KKN O
ParameterDirectionKKP b
.KKb c
InputKKc h
,KKh i
taxClassGuidKKj v
)KKv w
;KKw x
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# .
,LL. /
	SqlDbTypeLL0 9
.LL9 :
IntLL: =
,LL= >
ParameterDirectionLL? Q
.LLQ R
InputLLR W
,LLW X
priorityLLY a
)LLa b
;LLb c
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# *
,MM* +
	SqlDbTypeMM, 5
.MM5 6
DecimalMM6 =
,MM= >
ParameterDirectionMM? Q
.MMQ R
InputMMR W
,MMW X
rateMMY ]
)MM] ^
;MM^ _
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 1
,NN1 2
	SqlDbTypeNN3 <
.NN< =
NVarCharNN= E
,NNE F
$numNNG J
,NNJ K
ParameterDirectionNNL ^
.NN^ _
InputNN_ d
,NNd e
descriptionNNf q
)NNq r
;NNr s
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
DateTimeOO> F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
lastModifiedOOb n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 0
,PP0 1
	SqlDbTypePP2 ;
.PP; <
UniqueIdentifierPP< L
,PPL M
ParameterDirectionPPN `
.PP` a
InputPPa f
,PPf g

modifiedByPPh r
)PPr s
;PPs t
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
(RR 
rowsAffectedRR  
>RR! "
$numRR# $
)RR$ %
;RR% &
}VV 	
publicXX 
staticXX 
boolXX 
DeleteXX !
(XX! "
GuidXX" &
guidXX' +
)XX+ ,
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M$
GetWriteConnectionStringZZM e
(ZZe f
)ZZf g
,ZZg h
$strZZi |
,ZZ| }
$numZZ~ 
)	ZZ Ä
;
ZZÄ Å
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# *
,[[* +
	SqlDbType[[, 5
.[[5 6
UniqueIdentifier[[6 F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
guid[[b f
)[[f g
;[[g h
int\\ 
rowsAffected\\ 
=\\ 
sph\\ "
.\\" #
ExecuteNonQuery\\# 2
(\\2 3
)\\3 4
;\\4 5
return]] 
(]] 
rowsAffected]]  
>]]! "
$num]]# $
)]]$ %
;]]% &
}__ 	
publicaa 
staticaa 
IDataReaderaa !
GetOneaa" (
(aa( )
Guidaa) -
guidaa. 2
)aa2 3
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M#
GetReadConnectionStringccM d
(ccd e
)cce f
,ccf g
$strcch ~
,cc~ 
$num
ccÄ Å
)
ccÅ Ç
;
ccÇ É
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# *
,dd* +
	SqlDbTypedd, 5
.dd5 6
UniqueIdentifierdd6 F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
guidddb f
)ddf g
;ddg h
returnee 
sphee 
.ee 
ExecuteReaderee $
(ee$ %
)ee% &
;ee& '
}ii 	
publickk 
statickk 
IDataReaderkk !
GetTaxRateskk" -
(kk- .
Guidll 
siteGuidll 
,ll 
Guidmm 
geoZoneGuidmm 
)mm 
{nn 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M#
GetReadConnectionStringppM d
(ppd e
)ppe f
,ppf g
$strpph ~
,pp~ 
$num
ppÄ Å
)
ppÅ Ç
;
ppÇ É
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# .
,qq. /
	SqlDbTypeqq0 9
.qq9 :
UniqueIdentifierqq: J
,qqJ K
ParameterDirectionqqL ^
.qq^ _
Inputqq_ d
,qqd e
siteGuidqqf n
)qqn o
;qqo p
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 1
,rr1 2
	SqlDbTyperr3 <
.rr< =
UniqueIdentifierrr= M
,rrM N
ParameterDirectionrrO a
.rra b
Inputrrb g
,rrg h
geoZoneGuidrri t
)rrt u
;rru v
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}vv 	
public
ââ 
static
ââ 
int
ââ 

AddHistory
ââ $
(
ââ$ %
Guid
ää 
guid
ää 
,
ää 
Guid
ãã 
taxRateGuid
ãã 
,
ãã 
Guid
åå 
siteGuid
åå 
,
åå 
Guid
çç 
geoZoneGuid
çç 
,
çç 
Guid
éé 
taxClassGuid
éé 
,
éé 
int
èè 
priority
èè 
,
èè 
decimal
êê 
rate
êê 
,
êê 
string
ëë 
description
ëë 
,
ëë 
DateTime
íí 
created
íí 
,
íí 
Guid
ìì 
	createdBy
ìì 
,
ìì 
DateTime
îî 
lastModified
îî !
,
îî! "
Guid
ïï 

modifiedBy
ïï 
,
ïï 
DateTime
ññ 
logTime
ññ 
)
ññ 
{
óó 	 
SqlParameterHelper
òò 
sph
òò "
=
òò# $
new
òò% ( 
SqlParameterHelper
òò) ;
(
òò; <
ConnectionString
òò< L
.
òòL M&
GetWriteConnectionString
òòM e
(
òòe f
)
òòf g
,
òòg h
$stròòi É
,òòÉ Ñ
$numòòÖ á
)òòá à
;òòà â
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# *
,
ôô* +
	SqlDbType
ôô, 5
.
ôô5 6
UniqueIdentifier
ôô6 F
,
ôôF G 
ParameterDirection
ôôH Z
.
ôôZ [
Input
ôô[ `
,
ôô` a
guid
ôôb f
)
ôôf g
;
ôôg h
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 1
,
öö1 2
	SqlDbType
öö3 <
.
öö< =
UniqueIdentifier
öö= M
,
ööM N 
ParameterDirection
ööO a
.
ööa b
Input
ööb g
,
öög h
taxRateGuid
ööi t
)
ööt u
;
ööu v
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# .
,
õõ. /
	SqlDbType
õõ0 9
.
õõ9 :
UniqueIdentifier
õõ: J
,
õõJ K 
ParameterDirection
õõL ^
.
õõ^ _
Input
õõ_ d
,
õõd e
siteGuid
õõf n
)
õõn o
;
õõo p
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 1
,
úú1 2
	SqlDbType
úú3 <
.
úú< =
UniqueIdentifier
úú= M
,
úúM N 
ParameterDirection
úúO a
.
úúa b
Input
úúb g
,
úúg h
geoZoneGuid
úúi t
)
úút u
;
úúu v
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# 2
,
ùù2 3
	SqlDbType
ùù4 =
.
ùù= >
UniqueIdentifier
ùù> N
,
ùùN O 
ParameterDirection
ùùP b
.
ùùb c
Input
ùùc h
,
ùùh i
taxClassGuid
ùùj v
)
ùùv w
;
ùùw x
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# .
,
ûû. /
	SqlDbType
ûû0 9
.
ûû9 :
Int
ûû: =
,
ûû= > 
ParameterDirection
ûû? Q
.
ûûQ R
Input
ûûR W
,
ûûW X
priority
ûûY a
)
ûûa b
;
ûûb c
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# *
,
üü* +
	SqlDbType
üü, 5
.
üü5 6
Decimal
üü6 =
,
üü= > 
ParameterDirection
üü? Q
.
üüQ R
Input
üüR W
,
üüW X
rate
üüY ]
)
üü] ^
;
üü^ _
sph
†† 
.
††  
DefineSqlParameter
†† "
(
††" #
$str
††# 1
,
††1 2
	SqlDbType
††3 <
.
††< =
NVarChar
††= E
,
††E F
$num
††G J
,
††J K 
ParameterDirection
††L ^
.
††^ _
Input
††_ d
,
††d e
description
††f q
)
††q r
;
††r s
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# -
,
°°- .
	SqlDbType
°°/ 8
.
°°8 9
DateTime
°°9 A
,
°°A B 
ParameterDirection
°°C U
.
°°U V
Input
°°V [
,
°°[ \
created
°°] d
)
°°d e
;
°°e f
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# /
,
¢¢/ 0
	SqlDbType
¢¢1 :
.
¢¢: ;
UniqueIdentifier
¢¢; K
,
¢¢K L 
ParameterDirection
¢¢M _
.
¢¢_ `
Input
¢¢` e
,
¢¢e f
	createdBy
¢¢g p
)
¢¢p q
;
¢¢q r
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 2
,
££2 3
	SqlDbType
££4 =
.
££= >
DateTime
££> F
,
££F G 
ParameterDirection
££H Z
.
££Z [
Input
££[ `
,
££` a
lastModified
££b n
)
££n o
;
££o p
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 0
,
§§0 1
	SqlDbType
§§2 ;
.
§§; <
UniqueIdentifier
§§< L
,
§§L M 
ParameterDirection
§§N `
.
§§` a
Input
§§a f
,
§§f g

modifiedBy
§§h r
)
§§r s
;
§§s t
sph
•• 
.
••  
DefineSqlParameter
•• "
(
••" #
$str
••# -
,
••- .
	SqlDbType
••/ 8
.
••8 9
DateTime
••9 A
,
••A B 
ParameterDirection
••C U
.
••U V
Input
••V [
,
••[ \
logTime
••] d
)
••d e
;
••e f
int
¶¶ 
rowsAffected
¶¶ 
=
¶¶ 
sph
¶¶ "
.
¶¶" #
ExecuteNonQuery
¶¶# 2
(
¶¶2 3
)
¶¶3 4
;
¶¶4 5
return
ßß 
rowsAffected
ßß 
;
ßß  
}
©© 	
}
¨¨ 
}≠≠ ¿É
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserLocation.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBUserLocation &
{ 
public00 
static00 
int00 
Create00  
(00  !
Guid11 
rowID11 
,11 
Guid22 
userGuid22 
,22 
Guid33 
siteGuid33 
,33 
string44 
	iPAddress44 
,44 
long55 
iPAddressLong55 
,55 
string66 
hostname66 
,66 
double77 
	longitude77 
,77 
double88 
latitude88 
,88 
string99 
iSP99 
,99 
string:: 
	continent:: 
,:: 
string;; 
country;; 
,;; 
string<< 
region<< 
,<< 
string== 
city== 
,== 
string>> 
timeZone>> 
,>> 
int?? 
captureCount?? 
,?? 
DateTime@@ 
firstCaptureUTC@@ $
,@@$ %
DateTimeAA 
lastCaptureUTCAA #
)AA# $
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$str	CCi Å
,
CCÅ Ç
$num
CCÉ Ö
)
CCÖ Ü
;
CCÜ á
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# +
,DD+ ,
	SqlDbTypeDD- 6
.DD6 7
UniqueIdentifierDD7 G
,DDG H
ParameterDirectionDDI [
.DD[ \
InputDD\ a
,DDa b
rowIDDDc h
)DDh i
;DDi j
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
UniqueIdentifierEE: J
,EEJ K
ParameterDirectionEEL ^
.EE^ _
InputEE_ d
,EEd e
userGuidEEf n
)EEn o
;EEo p
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# .
,FF. /
	SqlDbTypeFF0 9
.FF9 :
UniqueIdentifierFF: J
,FFJ K
ParameterDirectionFFL ^
.FF^ _
InputFF_ d
,FFd e
siteGuidFFf n
)FFn o
;FFo p
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# /
,GG/ 0
	SqlDbTypeGG1 :
.GG: ;
NVarCharGG; C
,GGC D
$numGGE G
,GGG H
ParameterDirectionGGI [
.GG[ \
InputGG\ a
,GGa b
	iPAddressGGc l
)GGl m
;GGm n
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 3
,HH3 4
	SqlDbTypeHH5 >
.HH> ?
BigIntHH? E
,HHE F
ParameterDirectionHHG Y
.HHY Z
InputHHZ _
,HH_ `
iPAddressLongHHa n
)HHn o
;HHo p
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# .
,II. /
	SqlDbTypeII0 9
.II9 :
NVarCharII: B
,IIB C
$numIID G
,IIG H
ParameterDirectionIII [
.II[ \
InputII\ a
,IIa b
hostnameIIc k
)IIk l
;IIl m
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# /
,JJ/ 0
	SqlDbTypeJJ1 :
.JJ: ;
FloatJJ; @
,JJ@ A
ParameterDirectionJJB T
.JJT U
InputJJU Z
,JJZ [
	longitudeJJ\ e
)JJe f
;JJf g
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
FloatKK: ?
,KK? @
ParameterDirectionKKA S
.KKS T
InputKKT Y
,KKY Z
latitudeKK[ c
)KKc d
;KKd e
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# )
,LL) *
	SqlDbTypeLL+ 4
.LL4 5
NVarCharLL5 =
,LL= >
$numLL? B
,LLB C
ParameterDirectionLLD V
.LLV W
InputLLW \
,LL\ ]
iSPLL^ a
)LLa b
;LLb c
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# /
,MM/ 0
	SqlDbTypeMM1 :
.MM: ;
NVarCharMM; C
,MMC D
$numMME H
,MMH I
ParameterDirectionMMJ \
.MM\ ]
InputMM] b
,MMb c
	continentMMd m
)MMm n
;MMn o
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
NVarCharNN9 A
,NNA B
$numNNC F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
countryNNb i
)NNi j
;NNj k
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# ,
,OO, -
	SqlDbTypeOO. 7
.OO7 8
NVarCharOO8 @
,OO@ A
$numOOB E
,OOE F
ParameterDirectionOOG Y
.OOY Z
InputOOZ _
,OO_ `
regionOOa g
)OOg h
;OOh i
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
cityPP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
NVarCharQQ: B
,QQB C
$numQQD G
,QQG H
ParameterDirectionQQI [
.QQ[ \
InputQQ\ a
,QQa b
timeZoneQQc k
)QQk l
;QQl m
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 2
,RR2 3
	SqlDbTypeRR4 =
.RR= >
IntRR> A
,RRA B
ParameterDirectionRRC U
.RRU V
InputRRV [
,RR[ \
captureCountRR] i
)RRi j
;RRj k
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 5
,SS5 6
	SqlDbTypeSS7 @
.SS@ A
DateTimeSSA I
,SSI J
ParameterDirectionSSK ]
.SS] ^
InputSS^ c
,SSc d
firstCaptureUTCSSe t
)SSt u
;SSu v
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 4
,TT4 5
	SqlDbTypeTT6 ?
.TT? @
DateTimeTT@ H
,TTH I
ParameterDirectionTTJ \
.TT\ ]
InputTT] b
,TTb c
lastCaptureUTCTTd r
)TTr s
;TTs t
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
rowsAffectedVV 
;VV  
}WW 	
publicnn 
staticnn 
boolnn 
Updatenn !
(nn! "
Guidoo 
rowIDoo 
,oo 
Guidpp 
userGuidpp 
,pp 
Guidqq 
siteGuidqq 
,qq 
stringrr 
	iPAddressrr 
,rr 
longss 
iPAddressLongss 
,ss 
stringtt 
hostnamett 
,tt 
doubleuu 
	longitudeuu 
,uu 
doublevv 
latitudevv 
,vv 
stringww 
iSPww 
,ww 
stringxx 
	continentxx 
,xx 
stringyy 
countryyy 
,yy 
stringzz 
regionzz 
,zz 
string{{ 
city{{ 
,{{ 
string|| 
timeZone|| 
,|| 
int}} 
captureCount}} 
,}} 
DateTime~~ 
lastCaptureUTC~~ #
)~~# $
{ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M&
GetWriteConnectionString
ÄÄM e
(
ÄÄe f
)
ÄÄf g
,
ÄÄg h
$strÄÄi Å
,ÄÄÅ Ç
$numÄÄÉ Ö
)ÄÄÖ Ü
;ÄÄÜ á
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# +
,
ÅÅ+ ,
	SqlDbType
ÅÅ- 6
.
ÅÅ6 7
UniqueIdentifier
ÅÅ7 G
,
ÅÅG H 
ParameterDirection
ÅÅI [
.
ÅÅ[ \
Input
ÅÅ\ a
,
ÅÅa b
rowID
ÅÅc h
)
ÅÅh i
;
ÅÅi j
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
UniqueIdentifier
ÇÇ: J
,
ÇÇJ K 
ParameterDirection
ÇÇL ^
.
ÇÇ^ _
Input
ÇÇ_ d
,
ÇÇd e
userGuid
ÇÇf n
)
ÇÇn o
;
ÇÇo p
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
UniqueIdentifier
ÉÉ: J
,
ÉÉJ K 
ParameterDirection
ÉÉL ^
.
ÉÉ^ _
Input
ÉÉ_ d
,
ÉÉd e
siteGuid
ÉÉf n
)
ÉÉn o
;
ÉÉo p
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# /
,
ÑÑ/ 0
	SqlDbType
ÑÑ1 :
.
ÑÑ: ;
NVarChar
ÑÑ; C
,
ÑÑC D
$num
ÑÑE G
,
ÑÑG H 
ParameterDirection
ÑÑI [
.
ÑÑ[ \
Input
ÑÑ\ a
,
ÑÑa b
	iPAddress
ÑÑc l
)
ÑÑl m
;
ÑÑm n
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 3
,
ÖÖ3 4
	SqlDbType
ÖÖ5 >
.
ÖÖ> ?
BigInt
ÖÖ? E
,
ÖÖE F 
ParameterDirection
ÖÖG Y
.
ÖÖY Z
Input
ÖÖZ _
,
ÖÖ_ `
iPAddressLong
ÖÖa n
)
ÖÖn o
;
ÖÖo p
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
NVarChar
ÜÜ: B
,
ÜÜB C
$num
ÜÜD G
,
ÜÜG H 
ParameterDirection
ÜÜI [
.
ÜÜ[ \
Input
ÜÜ\ a
,
ÜÜa b
hostname
ÜÜc k
)
ÜÜk l
;
ÜÜl m
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# /
,
áá/ 0
	SqlDbType
áá1 :
.
áá: ;
Float
áá; @
,
áá@ A 
ParameterDirection
ááB T
.
ááT U
Input
ááU Z
,
ááZ [
	longitude
áá\ e
)
ááe f
;
ááf g
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
Float
àà: ?
,
àà? @ 
ParameterDirection
ààA S
.
ààS T
Input
ààT Y
,
ààY Z
latitude
àà[ c
)
ààc d
;
ààd e
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# )
,
ââ) *
	SqlDbType
ââ+ 4
.
ââ4 5
NVarChar
ââ5 =
,
ââ= >
$num
ââ? B
,
ââB C 
ParameterDirection
ââD V
.
ââV W
Input
ââW \
,
ââ\ ]
iSP
ââ^ a
)
ââa b
;
ââb c
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# /
,
ää/ 0
	SqlDbType
ää1 :
.
ää: ;
NVarChar
ää; C
,
ääC D
$num
ääE H
,
ääH I 
ParameterDirection
ääJ \
.
ää\ ]
Input
ää] b
,
ääb c
	continent
ääd m
)
ääm n
;
ään o
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# -
,
ãã- .
	SqlDbType
ãã/ 8
.
ãã8 9
NVarChar
ãã9 A
,
ããA B
$num
ããC F
,
ããF G 
ParameterDirection
ããH Z
.
ããZ [
Input
ãã[ `
,
ãã` a
country
ããb i
)
ããi j
;
ããj k
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# ,
,
åå, -
	SqlDbType
åå. 7
.
åå7 8
NVarChar
åå8 @
,
åå@ A
$num
ååB E
,
ååE F 
ParameterDirection
ååG Y
.
ååY Z
Input
ååZ _
,
åå_ `
region
ååa g
)
ååg h
;
ååh i
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# *
,
çç* +
	SqlDbType
çç, 5
.
çç5 6
NVarChar
çç6 >
,
çç> ?
$num
çç@ C
,
ççC D 
ParameterDirection
ççE W
.
ççW X
Input
ççX ]
,
çç] ^
city
çç_ c
)
ççc d
;
ççd e
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# .
,
éé. /
	SqlDbType
éé0 9
.
éé9 :
NVarChar
éé: B
,
ééB C
$num
ééD G
,
ééG H 
ParameterDirection
ééI [
.
éé[ \
Input
éé\ a
,
ééa b
timeZone
ééc k
)
éék l
;
éél m
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# 2
,
èè2 3
	SqlDbType
èè4 =
.
èè= >
Int
èè> A
,
èèA B 
ParameterDirection
èèC U
.
èèU V
Input
èèV [
,
èè[ \
captureCount
èè] i
)
èèi j
;
èèj k
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 4
,
êê4 5
	SqlDbType
êê6 ?
.
êê? @
DateTime
êê@ H
,
êêH I 
ParameterDirection
êêJ \
.
êê\ ]
Input
êê] b
,
êêb c
lastCaptureUTC
êêd r
)
êêr s
;
êês t
int
ëë 
rowsAffected
ëë 
=
ëë 
sph
ëë "
.
ëë" #
ExecuteNonQuery
ëë# 2
(
ëë2 3
)
ëë3 4
;
ëë4 5
return
íí 
(
íí 
rowsAffected
íí  
>
íí! "
$num
íí# $
)
íí$ %
;
íí% &
}
ìì 	
public
öö 
static
öö 
bool
öö 
Delete
öö !
(
öö! "
Guid
öö" &
rowID
öö' ,
)
öö, -
{
õõ 	 
SqlParameterHelper
úú 
sph
úú "
=
úú# $
new
úú% ( 
SqlParameterHelper
úú) ;
(
úú; <
ConnectionString
úú< L
.
úúL M&
GetWriteConnectionString
úúM e
(
úúe f
)
úúf g
,
úúg h
$strúúi Å
,úúÅ Ç
$numúúÉ Ñ
)úúÑ Ö
;úúÖ Ü
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# +
,
ùù+ ,
	SqlDbType
ùù- 6
.
ùù6 7
UniqueIdentifier
ùù7 G
,
ùùG H 
ParameterDirection
ùùI [
.
ùù[ \
Input
ùù\ a
,
ùùa b
rowID
ùùc h
)
ùùh i
;
ùùi j
int
ûû 
rowsAffected
ûû 
=
ûû 
sph
ûû "
.
ûû" #
ExecuteNonQuery
ûû# 2
(
ûû2 3
)
ûû3 4
;
ûû4 5
return
üü 
(
üü 
rowsAffected
üü  
>
üü! "
$num
üü# $
)
üü$ %
;
üü% &
}
°° 	
public
££ 
static
££ 
bool
££ 
DeleteByUser
££ '
(
££' (
Guid
££( ,
userGuid
££- 5
)
££5 6
{
§§ 	 
SqlParameterHelper
•• 
sph
•• "
=
••# $
new
••% ( 
SqlParameterHelper
••) ;
(
••; <
ConnectionString
••< L
.
••L M&
GetWriteConnectionString
••M e
(
••e f
)
••f g
,
••g h
$str••i á
,••á à
$num••â ä
)••ä ã
;••ã å
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
UniqueIdentifier
¶¶: J
,
¶¶J K 
ParameterDirection
¶¶L ^
.
¶¶^ _
Input
¶¶_ d
,
¶¶d e
userGuid
¶¶f n
)
¶¶n o
;
¶¶o p
int
ßß 
rowsAffected
ßß 
=
ßß 
sph
ßß "
.
ßß" #
ExecuteNonQuery
ßß# 2
(
ßß2 3
)
ßß3 4
;
ßß4 5
return
®® 
(
®® 
rowsAffected
®®  
>
®®! "
$num
®®# $
)
®®$ %
;
®®% &
}
™™ 	
public
∞∞ 
static
∞∞ 
IDataReader
∞∞ !
GetOne
∞∞" (
(
∞∞( )
Guid
∞∞) -
rowID
∞∞. 3
)
∞∞3 4
{
±± 	 
SqlParameterHelper
≤≤ 
sph
≤≤ "
=
≤≤# $
new
≤≤% ( 
SqlParameterHelper
≤≤) ;
(
≤≤; <
ConnectionString
≤≤< L
.
≤≤L M%
GetReadConnectionString
≤≤M d
(
≤≤d e
)
≤≤e f
,
≤≤f g
$str≤≤h É
,≤≤É Ñ
$num≤≤Ö Ü
)≤≤Ü á
;≤≤á à
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# +
,
≥≥+ ,
	SqlDbType
≥≥- 6
.
≥≥6 7
UniqueIdentifier
≥≥7 G
,
≥≥G H 
ParameterDirection
≥≥I [
.
≥≥[ \
Input
≥≥\ a
,
≥≥a b
rowID
≥≥c h
)
≥≥h i
;
≥≥i j
return
¥¥ 
sph
¥¥ 
.
¥¥ 
ExecuteReader
¥¥ $
(
¥¥$ %
)
¥¥% &
;
¥¥& '
}
µµ 	
public
ºº 
static
ºº 
IDataReader
ºº !
GetOne
ºº" (
(
ºº( )
Guid
ºº) -
userGuid
ºº. 6
,
ºº6 7
long
ºº8 <
iPAddressLong
ºº= J
)
ººJ K
{
ΩΩ 	 
SqlParameterHelper
ææ 
sph
ææ "
=
ææ# $
new
ææ% ( 
SqlParameterHelper
ææ) ;
(
ææ; <
ConnectionString
ææ< L
.
ææL M%
GetReadConnectionString
ææM d
(
ææd e
)
ææe f
,
ææf g
$strææh é
,ææé è
$numææê ë
)ææë í
;ææí ì
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# .
,
øø. /
	SqlDbType
øø0 9
.
øø9 :
UniqueIdentifier
øø: J
,
øøJ K 
ParameterDirection
øøL ^
.
øø^ _
Input
øø_ d
,
øød e
userGuid
øøf n
)
øøn o
;
øøo p
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 3
,
¿¿3 4
	SqlDbType
¿¿5 >
.
¿¿> ?
BigInt
¿¿? E
,
¿¿E F 
ParameterDirection
¿¿G Y
.
¿¿Y Z
Input
¿¿Z _
,
¿¿_ `
iPAddressLong
¿¿a n
)
¿¿n o
;
¿¿o p
return
¡¡ 
sph
¡¡ 
.
¡¡ 
ExecuteReader
¡¡ $
(
¡¡$ %
)
¡¡% &
;
¡¡& '
}
¬¬ 	
public
»» 
static
»» 
IDataReader
»» !
	GetByUser
»»" +
(
»»+ ,
Guid
»», 0
userGuid
»»1 9
)
»»9 :
{
…… 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h Ü
,  Ü á
$num  à â
)  â ä
;  ä ã
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# .
,
ÀÀ. /
	SqlDbType
ÀÀ0 9
.
ÀÀ9 :
UniqueIdentifier
ÀÀ: J
,
ÀÀJ K 
ParameterDirection
ÀÀL ^
.
ÀÀ^ _
Input
ÀÀ_ d
,
ÀÀd e
userGuid
ÀÀf n
)
ÀÀn o
;
ÀÀo p
return
ÃÃ 
sph
ÃÃ 
.
ÃÃ 
ExecuteReader
ÃÃ $
(
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ÕÕ 	
public
’’ 
static
’’ 
IDataReader
’’ !
	GetBySite
’’" +
(
’’+ ,
Guid
’’, 0
siteGuid
’’1 9
)
’’9 :
{
÷÷ 	 
SqlParameterHelper
◊◊ 
sph
◊◊ "
=
◊◊# $
new
◊◊% ( 
SqlParameterHelper
◊◊) ;
(
◊◊; <
ConnectionString
◊◊< L
.
◊◊L M%
GetReadConnectionString
◊◊M d
(
◊◊d e
)
◊◊e f
,
◊◊f g
$str◊◊h Ü
,◊◊Ü á
$num◊◊à â
)◊◊â ä
;◊◊ä ã
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# .
,
ÿÿ. /
	SqlDbType
ÿÿ0 9
.
ÿÿ9 :
UniqueIdentifier
ÿÿ: J
,
ÿÿJ K 
ParameterDirection
ÿÿL ^
.
ÿÿ^ _
Input
ÿÿ_ d
,
ÿÿd e
siteGuid
ÿÿf n
)
ÿÿn o
;
ÿÿo p
return
ŸŸ 
sph
ŸŸ 
.
ŸŸ 
ExecuteReader
ŸŸ $
(
ŸŸ$ %
)
ŸŸ% &
;
ŸŸ& '
}
⁄⁄ 	
public
‡‡ 
static
‡‡ 
IDataReader
‡‡ !!
GetUsersByIPAddress
‡‡" 5
(
‡‡5 6
Guid
‡‡6 :
siteGuid
‡‡; C
,
‡‡C D
string
‡‡E K
ipv4Address
‡‡L W
)
‡‡W X
{
·· 	 
SqlParameterHelper
‚‚ 
sph
‚‚ "
=
‚‚# $
new
‚‚% ( 
SqlParameterHelper
‚‚) ;
(
‚‚; <
ConnectionString
‚‚< L
.
‚‚L M%
GetReadConnectionString
‚‚M d
(
‚‚d e
)
‚‚e f
,
‚‚f g
$str‚‚h â
,‚‚â ä
$num‚‚ã å
)‚‚å ç
;‚‚ç é
sph
„„ 
.
„„  
DefineSqlParameter
„„ "
(
„„" #
$str
„„# .
,
„„. /
	SqlDbType
„„0 9
.
„„9 :
UniqueIdentifier
„„: J
,
„„J K 
ParameterDirection
„„L ^
.
„„^ _
Input
„„_ d
,
„„d e
siteGuid
„„f n
)
„„n o
;
„„o p
sph
‰‰ 
.
‰‰  
DefineSqlParameter
‰‰ "
(
‰‰" #
$str
‰‰# /
,
‰‰/ 0
	SqlDbType
‰‰1 :
.
‰‰: ;
NVarChar
‰‰; C
,
‰‰C D
$num
‰‰E G
,
‰‰G H 
ParameterDirection
‰‰I [
.
‰‰[ \
Input
‰‰\ a
,
‰‰a b
ipv4Address
‰‰c n
)
‰‰n o
;
‰‰o p
return
ÂÂ 
sph
ÂÂ 
.
ÂÂ 
ExecuteReader
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÊÊ 	
public
ÏÏ 
static
ÏÏ 
int
ÏÏ 
GetCountByUser
ÏÏ (
(
ÏÏ( )
Guid
ÏÏ) -
userGuid
ÏÏ. 6
)
ÏÏ6 7
{
ÌÌ 	 
SqlParameterHelper
ÓÓ 
sph
ÓÓ "
=
ÓÓ# $
new
ÓÓ% ( 
SqlParameterHelper
ÓÓ) ;
(
ÓÓ; <
ConnectionString
ÓÓ< L
.
ÓÓL M%
GetReadConnectionString
ÓÓM d
(
ÓÓd e
)
ÓÓe f
,
ÓÓf g
$strÓÓh à
,ÓÓà â
$numÓÓä ã
)ÓÓã å
;ÓÓå ç
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# .
,
ÔÔ. /
	SqlDbType
ÔÔ0 9
.
ÔÔ9 :
UniqueIdentifier
ÔÔ: J
,
ÔÔJ K 
ParameterDirection
ÔÔL ^
.
ÔÔ^ _
Input
ÔÔ_ d
,
ÔÔd e
userGuid
ÔÔf n
)
ÔÔn o
;
ÔÔo p
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
ÛÛ 	
public
ÖÖ 
static
ÖÖ 
int
ÖÖ 
GetCountBySite
ÖÖ (
(
ÖÖ( )
Guid
ÖÖ) -
siteGuid
ÖÖ. 6
)
ÖÖ6 7
{
ÜÜ 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M%
GetReadConnectionString
ááM d
(
áád e
)
ááe f
,
ááf g
$strááh à
,ááà â
$numááä ã
)ááã å
;ááå ç
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
return
ââ 
Convert
ââ 
.
ââ 
ToInt32
ââ "
(
ââ" #
sph
ââ# &
.
ââ& '
ExecuteScalar
ââ' 4
(
ââ4 5
)
ââ5 6
)
ââ6 7
;
ââ7 8
}
åå 	
public
óó 
static
óó 
IDataReader
óó !
GetPageByUser
óó" /
(
óó/ 0
Guid
òò 
userGuid
òò 
,
òò 
int
ôô 

pageNumber
ôô 
,
ôô 
int
öö 
pageSize
öö 
,
öö 
out
õõ 
int
õõ 

totalPages
õõ 
)
õõ 
{
úú 	

totalPages
ùù 
=
ùù 
$num
ùù 
;
ùù 
int
ûû 
	totalRows
ûû 
=
üü 
GetCountByUser
üü  
(
üü  !
userGuid
üü! )
)
üü) *
;
üü* +
if
°° 
(
°° 
pageSize
°° 
>
°° 
$num
°° 
)
°° 

totalPages
°° (
=
°°) *
	totalRows
°°+ 4
/
°°5 6
pageSize
°°7 ?
;
°°? @
if
££ 
(
££ 
	totalRows
££ 
<=
££ 
pageSize
££ %
)
££% &
{
§§ 

totalPages
•• 
=
•• 
$num
•• 
;
•• 
}
¶¶ 
else
ßß 
{
®® 
int
©© 
	remainder
©© 
;
©© 
Math
™™ 
.
™™ 
DivRem
™™ 
(
™™ 
	totalRows
™™ %
,
™™% &
pageSize
™™' /
,
™™/ 0
out
™™1 4
	remainder
™™5 >
)
™™> ?
;
™™? @
if
´´ 
(
´´ 
	remainder
´´ 
>
´´ 
$num
´´  !
)
´´! "
{
¨¨ 

totalPages
≠≠ 
+=
≠≠ !
$num
≠≠" #
;
≠≠# $
}
ÆÆ 
}
ØØ  
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h ä
,±±ä ã
$num±±å ç
)±±ç é
;±±é è
sph
≤≤ 
.
≤≤  
DefineSqlParameter
≤≤ "
(
≤≤" #
$str
≤≤# .
,
≤≤. /
	SqlDbType
≤≤0 9
.
≤≤9 :
UniqueIdentifier
≤≤: J
,
≤≤J K 
ParameterDirection
≤≤L ^
.
≤≤^ _
Input
≤≤_ d
,
≤≤d e
userGuid
≤≤f n
)
≤≤n o
;
≤≤o p
sph
≥≥ 
.
≥≥  
DefineSqlParameter
≥≥ "
(
≥≥" #
$str
≥≥# 0
,
≥≥0 1
	SqlDbType
≥≥2 ;
.
≥≥; <
Int
≥≥< ?
,
≥≥? @ 
ParameterDirection
≥≥A S
.
≥≥S T
Input
≥≥T Y
,
≥≥Y Z

pageNumber
≥≥[ e
)
≥≥e f
;
≥≥f g
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
Int
¥¥: =
,
¥¥= > 
ParameterDirection
¥¥? Q
.
¥¥Q R
Input
¥¥R W
,
¥¥W X
pageSize
¥¥Y a
)
¥¥a b
;
¥¥b c
return
µµ 
sph
µµ 
.
µµ 
ExecuteReader
µµ $
(
µµ$ %
)
µµ% &
;
µµ& '
}
∑∑ 	
public
¿¿ 
static
¿¿ 
IDataReader
¿¿ !
GetPageBySite
¿¿" /
(
¿¿/ 0
Guid
¡¡ 
siteGuid
¡¡ 
,
¡¡ 
int
¬¬ 

pageNumber
¬¬ 
,
¬¬ 
int
√√ 
pageSize
√√ 
,
√√ 
out
ƒƒ 
int
ƒƒ 

totalPages
ƒƒ 
)
ƒƒ 
{
≈≈ 	

totalPages
∆∆ 
=
∆∆ 
$num
∆∆ 
;
∆∆ 
int
«« 
	totalRows
«« 
=
»» 
GetCountBySite
»»  
(
»»  !
siteGuid
»»! )
)
»») *
;
»»* +
if
   
(
   
pageSize
   
>
   
$num
   
)
   

totalPages
   (
=
  ) *
	totalRows
  + 4
/
  5 6
pageSize
  7 ?
;
  ? @
if
ÃÃ 
(
ÃÃ 
	totalRows
ÃÃ 
<=
ÃÃ 
pageSize
ÃÃ %
)
ÃÃ% &
{
ÕÕ 

totalPages
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
}
œœ 
else
–– 
{
—— 
int
““ 
	remainder
““ 
;
““ 
Math
”” 
.
”” 
DivRem
”” 
(
”” 
	totalRows
”” %
,
””% &
pageSize
””' /
,
””/ 0
out
””1 4
	remainder
””5 >
)
””> ?
;
””? @
if
‘‘ 
(
‘‘ 
	remainder
‘‘ 
>
‘‘ 
$num
‘‘  !
)
‘‘! "
{
’’ 

totalPages
÷÷ 
+=
÷÷ !
$num
÷÷" #
;
÷÷# $
}
◊◊ 
}
ÿÿ  
SqlParameterHelper
⁄⁄ 
sph
⁄⁄ "
=
⁄⁄# $
new
⁄⁄% ( 
SqlParameterHelper
⁄⁄) ;
(
⁄⁄; <
ConnectionString
⁄⁄< L
.
⁄⁄L M%
GetReadConnectionString
⁄⁄M d
(
⁄⁄d e
)
⁄⁄e f
,
⁄⁄f g
$str⁄⁄h ä
,⁄⁄ä ã
$num⁄⁄å ç
)⁄⁄ç é
;⁄⁄é è
sph
€€ 
.
€€  
DefineSqlParameter
€€ "
(
€€" #
$str
€€# .
,
€€. /
	SqlDbType
€€0 9
.
€€9 :
UniqueIdentifier
€€: J
,
€€J K 
ParameterDirection
€€L ^
.
€€^ _
Input
€€_ d
,
€€d e
siteGuid
€€f n
)
€€n o
;
€€o p
sph
‹‹ 
.
‹‹  
DefineSqlParameter
‹‹ "
(
‹‹" #
$str
‹‹# 0
,
‹‹0 1
	SqlDbType
‹‹2 ;
.
‹‹; <
Int
‹‹< ?
,
‹‹? @ 
ParameterDirection
‹‹A S
.
‹‹S T
Input
‹‹T Y
,
‹‹Y Z

pageNumber
‹‹[ e
)
‹‹e f
;
‹‹f g
sph
›› 
.
››  
DefineSqlParameter
›› "
(
››" #
$str
››# .
,
››. /
	SqlDbType
››0 9
.
››9 :
Int
››: =
,
››= > 
ParameterDirection
››? Q
.
››Q R
Input
››R W
,
››W X
pageSize
››Y a
)
››a b
;
››b c
return
ﬁﬁ 
sph
ﬁﬁ 
.
ﬁﬁ 
ExecuteReader
ﬁﬁ $
(
ﬁﬁ$ %
)
ﬁﬁ% &
;
ﬁﬁ& '
}
‡‡ 	
}
„„ 
}ÂÂ •b
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbUserPage.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBUserPage "
{ 
public 
static 
int 
AddUserPage %
(% &
Guid 

userPageId 
, 
Guid 
siteGuid 
, 
int 
siteId 
, 
Guid 
userGuid 
, 
string   
pageName   
,   
String!! 
pagePath!! 
,!! 
int"" 
	pageOrder"" 
)"" 
{## 	
SqlParameterHelper$$ 
sph$$ "
=$$# $
new$$% (
SqlParameterHelper$$) ;
($$; <
ConnectionString$$< L
.$$L M$
GetWriteConnectionString$$M e
($$e f
)$$f g
,$$g h
$str$$i ~
,$$~ 
$num
$$Ä Å
)
$$Å Ç
;
$$Ç É
sph%% 
.%% 
DefineSqlParameter%% "
(%%" #
$str%%# 0
,%%0 1
	SqlDbType%%2 ;
.%%; <
UniqueIdentifier%%< L
,%%L M
ParameterDirection%%N `
.%%` a
Input%%a f
,%%f g

userPageId%%h r
)%%r s
;%%s t
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# .
,&&. /
	SqlDbType&&0 9
.&&9 :
UniqueIdentifier&&: J
,&&J K
ParameterDirection&&L ^
.&&^ _
Input&&_ d
,&&d e
siteGuid&&f n
)&&n o
;&&o p
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# ,
,'', -
	SqlDbType''. 7
.''7 8
Int''8 ;
,''; <
ParameterDirection''= O
.''O P
Input''P U
,''U V
siteId''W ]
)''] ^
;''^ _
sph(( 
.(( 
DefineSqlParameter(( "
(((" #
$str((# .
,((. /
	SqlDbType((0 9
.((9 :
UniqueIdentifier((: J
,((J K
ParameterDirection((L ^
.((^ _
Input((_ d
,((d e
userGuid((f n
)((n o
;((o p
sph)) 
.)) 
DefineSqlParameter)) "
())" #
$str))# .
,)). /
	SqlDbType))0 9
.))9 :
NVarChar)): B
,))B C
ParameterDirection))D V
.))V W
Input))W \
,))\ ]
pageName))^ f
)))f g
;))g h
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# .
,**. /
	SqlDbType**0 9
.**9 :
NVarChar**: B
,**B C
ParameterDirection**D V
.**V W
Input**W \
,**\ ]
pagePath**^ f
)**f g
;**g h
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# /
,++/ 0
	SqlDbType++1 :
.++: ;
Int++; >
,++> ?
ParameterDirection++@ R
.++R S
Input++S X
,++X Y
	pageOrder++Z c
)++c d
;++d e
int,, 
rowsAffected,, 
=,, 
sph,, "
.,," #
ExecuteNonQuery,,# 2
(,,2 3
),,3 4
;,,4 5
return-- 
rowsAffected-- 
;--  
}.. 	
public00 
static00 
bool00 
UpdateUserPage00 )
(00) *
Guid11 

userPageId11 
,11 
string22 
pageName22 
,22 
int33 
	pageOrder33 
)33 
{44 	
SqlParameterHelper55 
sph55 "
=55# $
new55% (
SqlParameterHelper55) ;
(55; <
ConnectionString55< L
.55L M$
GetWriteConnectionString55M e
(55e f
)55f g
,55g h
$str55i ~
,55~ 
$num
55Ä Å
)
55Å Ç
;
55Ç É
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
UniqueIdentifier66< L
,66L M
ParameterDirection66N `
.66` a
Input66a f
,66f g

userPageId66h r
)66r s
;66s t
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
NVarChar77: B
,77B C
ParameterDirection77D V
.77V W
Input77W \
,77\ ]
pageName77^ f
)77f g
;77g h
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# /
,88/ 0
	SqlDbType881 :
.88: ;
Int88; >
,88> ?
ParameterDirection88@ R
.88R S
Input88S X
,88X Y
	pageOrder88Z c
)88c d
;88d e
int99 
rowsAffected99 
=99 
sph99 "
.99" #
ExecuteNonQuery99# 2
(992 3
)993 4
;994 5
return:: 
(:: 
rowsAffected::  
>::! "
-::# $
$num::$ %
)::% &
;::& '
};; 	
public>> 
static>> 
bool>> 
DeleteUserPage>> )
(>>) *
Guid>>* .

userPageId>>/ 9
)>>9 :
{?? 	
SqlParameterHelper@@ 
sph@@ "
=@@# $
new@@% (
SqlParameterHelper@@) ;
(@@; <
ConnectionString@@< L
.@@L M$
GetWriteConnectionString@@M e
(@@e f
)@@f g
,@@g h
$str@@i ~
,@@~ 
$num
@@Ä Å
)
@@Å Ç
;
@@Ç É
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 0
,AA0 1
	SqlDbTypeAA2 ;
.AA; <
UniqueIdentifierAA< L
,AAL M
ParameterDirectionAAN `
.AA` a
InputAAa f
,AAf g

userPageIdAAh r
)AAr s
;AAs t
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
(CC 
rowsAffectedCC  
>CC! "
-CC# $
$numCC$ %
)CC% &
;CC& '
}DD 	
publicFF 
staticFF 
boolFF 
DeleteByUserFF '
(FF' (
GuidFF( ,
userGuidFF- 5
)FF5 6
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi Ñ
,
HHÑ Ö
$num
HHÜ á
)
HHá à
;
HHà â
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# .
,II. /
	SqlDbTypeII0 9
.II9 :
UniqueIdentifierII: J
,IIJ K
ParameterDirectionIIL ^
.II^ _
InputII_ d
,IId e
userGuidIIf n
)IIn o
;IIo p
intJJ 
rowsAffectedJJ 
=JJ 
sphJJ "
.JJ" #
ExecuteNonQueryJJ# 2
(JJ2 3
)JJ3 4
;JJ4 5
returnKK 
(KK 
rowsAffectedKK  
>KK! "
-KK# $
$numKK$ %
)KK% &
;KK& '
}LL 	
publicNN 
staticNN 
IDataReaderNN !
GetUserPageNN" -
(NN- .
GuidNN. 2

userPageIdNN3 =
)NN= >
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M#
GetReadConnectionStringPPM d
(PPd e
)PPe f
,PPf g
$str	PPh Ä
,
PPÄ Å
$num
PPÇ É
)
PPÉ Ñ
;
PPÑ Ö
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 0
,QQ0 1
	SqlDbTypeQQ2 ;
.QQ; <
UniqueIdentifierQQ< L
,QQL M
ParameterDirectionQQN `
.QQ` a
InputQQa f
,QQf g

userPageIdQQh r
)QQr s
;QQs t
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}SS 	
publicUU 
staticUU 
IDataReaderUU !
SelectByUserUU" .
(UU. /
GuidUU/ 3
userGuidUU4 <
)UU< =
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M#
GetReadConnectionStringWWM d
(WWd e
)WWe f
,WWf g
$str	WWh É
,
WWÉ Ñ
$num
WWÖ Ü
)
WWÜ á
;
WWá à
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
userGuidXXf n
)XXn o
;XXo p
returnYY 
sphYY 
.YY 
ExecuteReaderYY $
(YY$ %
)YY% &
;YY& '
}ZZ 	
public\\ 
static\\ 
int\\ 
GetNextPageOrder\\ *
(\\* +
Guid\\+ /
userGuid\\0 8
)\\8 9
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M#
GetReadConnectionString^^M d
(^^d e
)^^e f
,^^f g
$str	^^h á
,
^^á à
$num
^^â ä
)
^^ä ã
;
^^ã å
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# .
,__. /
	SqlDbType__0 9
.__9 :
UniqueIdentifier__: J
,__J K
ParameterDirection__L ^
.__^ _
Input___ d
,__d e
userGuid__f n
)__n o
;__o p
int`` 
	pageOrder`` 
=`` 
Convert`` #
.``# $
ToInt32``$ +
(``+ ,
sph``, /
.``/ 0
ExecuteScalar``0 =
(``= >
)``> ?
)``? @
;``@ A
returnaa 
	pageOrderaa 
;aa 
}bb 	
publicdd 
staticdd 
booldd 
UpdatePageOrderdd *
(dd* +
Guiddd+ /

userPageIddd0 :
,dd: ;
intdd< ?
	pageOrderdd@ I
)ddI J
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M#
GetReadConnectionStringffM d
(ffd e
)ffe f
,fff g
$str	ffh Ü
,
ffÜ á
$num
ffà â
)
ffâ ä
;
ffä ã
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 0
,gg0 1
	SqlDbTypegg2 ;
.gg; <
UniqueIdentifiergg< L
,ggL M
ParameterDirectionggN `
.gg` a
Inputgga f
,ggf g

userPageIdggh r
)ggr s
;ggs t
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# /
,hh/ 0
	SqlDbTypehh1 :
.hh: ;
Inthh; >
,hh> ?
ParameterDirectionhh@ R
.hhR S
InputhhS X
,hhX Y
	pageOrderhhZ c
)hhc d
;hhd e
intii 
rowsAffectedii 
=ii 
sphii "
.ii" #
ExecuteNonQueryii# 2
(ii2 3
)ii3 4
;ii4 5
returnjj 
(jj 
rowsAffectedjj  
>jj! "
-jj# $
$numjj$ %
)jj% &
;jj& '
}kk 	
}qq 
}rr Ò∞
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbWebPartContent.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 
DBWebPartContent (
{ 
public 
static 
int 

AddWebPart $
($ %
Guid   
	webPartId   
,   
Guid!! 
siteGuid!! 
,!! 
int"" 
siteId"" 
,"" 
string## 
title## 
,## 
string$$ 
description$$ 
,$$ 
string%% 
imageUrl%% 
,%% 
string&& 
	className&& 
,&& 
string'' 
assemblyName'' 
,''  
bool(( 
availableForMyPage(( #
,((# $
bool)) *
allowMultipleInstancesOnMyPage)) /
,))/ 0
bool** %
availableForContentSystem** *
)*** +
{++ 	
SqlParameterHelper,, 
sph,, "
=,,# $
new,,% (
SqlParameterHelper,,) ;
(,,; <
ConnectionString,,< L
.,,L M$
GetWriteConnectionString,,M e
(,,e f
),,f g
,,,g h
$str,,i }
,,,} ~
$num	,, Å
)
,,Å Ç
;
,,Ç É
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# /
,--/ 0
	SqlDbType--1 :
.--: ;
UniqueIdentifier--; K
,--K L
ParameterDirection--M _
.--_ `
Input--` e
,--e f
	webPartId--g p
)--p q
;--q r
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# .
,... /
	SqlDbType..0 9
...9 :
UniqueIdentifier..: J
,..J K
ParameterDirection..L ^
...^ _
Input.._ d
,..d e
siteGuid..f n
)..n o
;..o p
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# ,
,//, -
	SqlDbType//. 7
.//7 8
Int//8 ;
,//; <
ParameterDirection//= O
.//O P
Input//P U
,//U V
siteId//W ]
)//] ^
;//^ _
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# +
,00+ ,
	SqlDbType00- 6
.006 7
NVarChar007 ?
,00? @
ParameterDirection00A S
.00S T
Input00T Y
,00Y Z
title00[ `
)00` a
;00a b
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 1
,111 2
	SqlDbType113 <
.11< =
NVarChar11= E
,11E F
ParameterDirection11G Y
.11Y Z
Input11Z _
,11_ `
description11a l
)11l m
;11m n
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
NVarChar22: B
,22B C
ParameterDirection22D V
.22V W
Input22W \
,22\ ]
imageUrl22^ f
)22f g
;22g h
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
NVarChar33; C
,33C D
ParameterDirection33E W
.33W X
Input33X ]
,33] ^
	className33_ h
)33h i
;33i j
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 2
,442 3
	SqlDbType444 =
.44= >
NVarChar44> F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
assemblyName44b n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 8
,558 9
	SqlDbType55: C
.55C D
Bit55D G
,55G H
ParameterDirection55I [
.55[ \
Input55\ a
,55a b
availableForMyPage55c u
)55u v
;55v w
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# D
,66D E
	SqlDbType66F O
.66O P
Bit66P S
,66S T
ParameterDirection66U g
.66g h
Input66h m
,66m n+
allowMultipleInstancesOnMyPage	66o ç
)
66ç é
;
66é è
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ?
,77? @
	SqlDbType77A J
.77J K
Bit77K N
,77N O
ParameterDirection77P b
.77b c
Input77c h
,77h i&
availableForContentSystem	77j É
)
77É Ñ
;
77Ñ Ö
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
rowsAffected99 
;99  
}:: 	
public<< 
static<< 
bool<< 
UpdateWebPart<< (
(<<( )
Guid== 
	webPartId== 
,== 
int>> 
siteId>> 
,>> 
string?? 
title?? 
,?? 
string@@ 
description@@ 
,@@ 
stringAA 
imageUrlAA 
,AA 
stringBB 
	classNameBB 
,BB 
stringCC 
assemblyNameCC 
,CC  
boolDD 
availableForMyPageDD #
,DD# $
boolEE *
allowMultipleInstancesOnMyPageEE /
,EE/ 0
boolFF %
availableForContentSystemFF *
)FF* +
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$strHHi }
,HH} ~
$num	HH Å
)
HHÅ Ç
;
HHÇ É
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# /
,II/ 0
	SqlDbTypeII1 :
.II: ;
UniqueIdentifierII; K
,IIK L
ParameterDirectionIIM _
.II_ `
InputII` e
,IIe f
	webPartIdIIg p
)IIp q
;IIq r
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# ,
,JJ, -
	SqlDbTypeJJ. 7
.JJ7 8
IntJJ8 ;
,JJ; <
ParameterDirectionJJ= O
.JJO P
InputJJP U
,JJU V
siteIdJJW ]
)JJ] ^
;JJ^ _
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
ParameterDirectionKKA S
.KKS T
InputKKT Y
,KKY Z
titleKK[ `
)KK` a
;KKa b
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
ParameterDirectionLLG Y
.LLY Z
InputLLZ _
,LL_ `
descriptionLLa l
)LLl m
;LLm n
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
NVarCharMM: B
,MMB C
ParameterDirectionMMD V
.MMV W
InputMMW \
,MM\ ]
imageUrlMM^ f
)MMf g
;MMg h
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# /
,NN/ 0
	SqlDbTypeNN1 :
.NN: ;
NVarCharNN; C
,NNC D
ParameterDirectionNNE W
.NNW X
InputNNX ]
,NN] ^
	classNameNN_ h
)NNh i
;NNi j
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
NVarCharOO> F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
assemblyNameOOb n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 8
,PP8 9
	SqlDbTypePP: C
.PPC D
BitPPD G
,PPG H
ParameterDirectionPPI [
.PP[ \
InputPP\ a
,PPa b
availableForMyPagePPc u
)PPu v
;PPv w
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# D
,QQD E
	SqlDbTypeQQF O
.QQO P
BitQQP S
,QQS T
ParameterDirectionQQU g
.QQg h
InputQQh m
,QQm n+
allowMultipleInstancesOnMyPage	QQo ç
)
QQç é
;
QQé è
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# ?
,RR? @
	SqlDbTypeRRA J
.RRJ K
BitRRK N
,RRN O
ParameterDirectionRRP b
.RRb c
InputRRc h
,RRh i&
availableForContentSystem	RRj É
)
RRÉ Ñ
;
RRÑ Ö
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
(TT 
rowsAffectedTT  
>TT! "
-TT# $
$numTT$ %
)TT% &
;TT& '
}UU 	
publicWW 
staticWW 
boolWW $
UpdateCountOfUseOnMyPageWW 3
(WW3 4
GuidWW4 8
	webPartIdWW9 B
,WWB C
intWWD G
	incrementWWH Q
)WWQ R
{XX 	
SqlParameterHelperYY 
sphYY "
=YY# $
newYY% (
SqlParameterHelperYY) ;
(YY; <
ConnectionStringYY< L
.YYL M$
GetWriteConnectionStringYYM e
(YYe f
)YYf g
,YYg h
$str	YYi è
,
YYè ê
$num
YYë í
)
YYí ì
;
YYì î
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# /
,ZZ/ 0
	SqlDbTypeZZ1 :
.ZZ: ;
UniqueIdentifierZZ; K
,ZZK L
ParameterDirectionZZM _
.ZZ_ `
InputZZ` e
,ZZe f
	webPartIdZZg p
)ZZp q
;ZZq r
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# /
,[[/ 0
	SqlDbType[[1 :
.[[: ;
Int[[; >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
	increment[[Z c
)[[c d
;[[d e
int\\ 
rowsAffected\\ 
=\\ 
sph\\ "
.\\" #
ExecuteNonQuery\\# 2
(\\2 3
)\\3 4
;\\4 5
return]] 
(]] 
rowsAffected]]  
>]]! "
-]]# $
$num]]$ %
)]]% &
;]]& '
}^^ 	
public`` 
static`` 
bool`` 
DeleteWebPart`` (
(``( )
Guid``) -
	webPartId``. 7
)``7 8
{aa 	
SqlParameterHelperbb 
sphbb "
=bb# $
newbb% (
SqlParameterHelperbb) ;
(bb; <
ConnectionStringbb< L
.bbL M$
GetWriteConnectionStringbbM e
(bbe f
)bbf g
,bbg h
$strbbi }
,bb} ~
$num	bb Ä
)
bbÄ Å
;
bbÅ Ç
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
Intcc; >
,cc> ?
ParameterDirectioncc@ R
.ccR S
InputccS X
,ccX Y
	webPartIdccZ c
)ccc d
;ccd e
intdd 
rowsAffecteddd 
=dd 
sphdd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
returnee 
(ee 
rowsAffectedee  
>ee! "
-ee# $
$numee$ %
)ee% &
;ee& '
}ff 	
publichh 
statichh 
IDataReaderhh !

GetWebParthh" ,
(hh, -
Guidhh- 1
	webPartIdhh2 ;
)hh; <
{ii 	
SqlParameterHelperjj 
sphjj "
=jj# $
newjj% (
SqlParameterHelperjj) ;
(jj; <
ConnectionStringjj< L
.jjL M#
GetReadConnectionStringjjM d
(jjd e
)jje f
,jjf g
$strjjh 
,	jj Ä
$num
jjÅ Ç
)
jjÇ É
;
jjÉ Ñ
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# /
,kk/ 0
	SqlDbTypekk1 :
.kk: ;
UniqueIdentifierkk; K
,kkK L
ParameterDirectionkkM _
.kk_ `
Inputkk` e
,kke f
	webPartIdkkg p
)kkp q
;kkq r
returnll 
sphll 
.ll 
ExecuteReaderll $
(ll$ %
)ll% &
;ll& '
}mm 	
publicoo 
staticoo 
IDataReaderoo !
SelectBySiteoo" .
(oo. /
intoo/ 2
siteIdoo3 9
)oo9 :
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M#
GetReadConnectionStringqqM d
(qqd e
)qqe f
,qqf g
$str	qqh Ç
,
qqÇ É
$num
qqÑ Ö
)
qqÖ Ü
;
qqÜ á
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# ,
,rr, -
	SqlDbTyperr. 7
.rr7 8
Intrr8 ;
,rr; <
ParameterDirectionrr= O
.rrO P
InputrrP U
,rrU V
siteIdrrW ]
)rr] ^
;rr^ _
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}tt 	
publicvv 
staticvv 
	DataTablevv 

SelectPagevv  *
(vv* +
intww 
siteIdww 
,ww 
intxx 

pageNumberxx 
,xx 
intyy 
pageSizeyy 
,yy 
boolzz 
sortByClassNamezz  
,zz  !
bool{{ 
sortByAssemblyName{{ #
){{# $
{|| 	
SqlParameterHelper}} 
sph}} "
=}}# $
new}}% (
SqlParameterHelper}}) ;
(}}; <
ConnectionString}}< L
.}}L M#
GetReadConnectionString}}M d
(}}d e
)}}e f
,}}f g
$str	}}h Ä
,
}}Ä Å
$num
}}Ç É
)
}}É Ñ
;
}}Ñ Ö
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# ,
,~~, -
	SqlDbType~~. 7
.~~7 8
Int~~8 ;
,~~; <
ParameterDirection~~= O
.~~O P
Input~~P U
,~~U V
siteId~~W ]
)~~] ^
;~~^ _
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
Int< ?
,? @
ParameterDirectionA S
.S T
InputT Y
,Y Z

pageNumber[ e
)e f
;f g
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
Int
ÄÄ: =
,
ÄÄ= > 
ParameterDirection
ÄÄ? Q
.
ÄÄQ R
Input
ÄÄR W
,
ÄÄW X
pageSize
ÄÄY a
)
ÄÄa b
;
ÄÄb c
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 5
,
ÅÅ5 6
	SqlDbType
ÅÅ7 @
.
ÅÅ@ A
Bit
ÅÅA D
,
ÅÅD E 
ParameterDirection
ÅÅF X
.
ÅÅX Y
Input
ÅÅY ^
,
ÅÅ^ _
sortByClassName
ÅÅ` o
)
ÅÅo p
;
ÅÅp q
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 8
,
ÇÇ8 9
	SqlDbType
ÇÇ: C
.
ÇÇC D
Bit
ÇÇD G
,
ÇÇG H 
ParameterDirection
ÇÇI [
.
ÇÇ[ \
Input
ÇÇ\ a
,
ÇÇa b 
sortByAssemblyName
ÇÇc u
)
ÇÇu v
;
ÇÇv w
	DataTable
ÑÑ 
dt
ÑÑ 
=
ÑÑ 
new
ÑÑ 
	DataTable
ÑÑ (
(
ÑÑ( )
)
ÑÑ) *
;
ÑÑ* +
dt
ÖÖ 
.
ÖÖ 
Columns
ÖÖ 
.
ÖÖ 
Add
ÖÖ 
(
ÖÖ 
$str
ÖÖ &
,
ÖÖ& '
typeof
ÖÖ( .
(
ÖÖ. /
String
ÖÖ/ 5
)
ÖÖ5 6
)
ÖÖ6 7
;
ÖÖ7 8
dt
ÜÜ 
.
ÜÜ 
Columns
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
$str
ÜÜ "
,
ÜÜ" #
typeof
ÜÜ$ *
(
ÜÜ* +
String
ÜÜ+ 1
)
ÜÜ1 2
)
ÜÜ2 3
;
ÜÜ3 4
dt
áá 
.
áá 
Columns
áá 
.
áá 
Add
áá 
(
áá 
$str
áá (
,
áá( )
typeof
áá* 0
(
áá0 1
String
áá1 7
)
áá7 8
)
áá8 9
;
áá9 :
dt
àà 
.
àà 
Columns
àà 
.
àà 
Add
àà 
(
àà 
$str
àà %
,
àà% &
typeof
àà' -
(
àà- .
String
àà. 4
)
àà4 5
)
àà5 6
;
àà6 7
dt
ââ 
.
ââ 
Columns
ââ 
.
ââ 
Add
ââ 
(
ââ 
$str
ââ &
,
ââ& '
typeof
ââ( .
(
ââ. /
String
ââ/ 5
)
ââ5 6
)
ââ6 7
;
ââ7 8
dt
ää 
.
ää 
Columns
ää 
.
ää 
Add
ää 
(
ää 
$str
ää )
,
ää) *
typeof
ää+ 1
(
ää1 2
String
ää2 8
)
ää8 9
)
ää9 :
;
ää: ;
dt
ãã 
.
ãã 
Columns
ãã 
.
ãã 
Add
ãã 
(
ãã 
$str
ãã /
,
ãã/ 0
typeof
ãã1 7
(
ãã7 8
bool
ãã8 <
)
ãã< =
)
ãã= >
;
ãã> ?
dt
åå 
.
åå 
Columns
åå 
.
åå 
Add
åå 
(
åå 
$str
åå ;
,
åå; <
typeof
åå= C
(
ååC D
bool
ååD H
)
ååH I
)
ååI J
;
ååJ K
dt
çç 
.
çç 
Columns
çç 
.
çç 
Add
çç 
(
çç 
$str
çç 6
,
çç6 7
typeof
çç8 >
(
çç> ?
bool
çç? C
)
ççC D
)
ççD E
;
ççE F
dt
éé 
.
éé 
Columns
éé 
.
éé 
Add
éé 
(
éé 
$str
éé '
,
éé' (
typeof
éé) /
(
éé/ 0
int
éé0 3
)
éé3 4
)
éé4 5
;
éé5 6
using
êê 
(
êê 
IDataReader
êê 
reader
êê %
=
êê& '
sph
êê( +
.
êê+ ,
ExecuteReader
êê, 9
(
êê9 :
)
êê: ;
)
êê; <
{
ëë 
while
íí 
(
íí 
reader
íí 
.
íí 
Read
íí "
(
íí" #
)
íí# $
)
íí$ %
{
ìì 
DataRow
îî 
row
îî 
=
îî  !
dt
îî" $
.
îî$ %
NewRow
îî% +
(
îî+ ,
)
îî, -
;
îî- .
row
ïï 
[
ïï 
$str
ïï #
]
ïï# $
=
ïï% &
reader
ïï' -
[
ïï- .
$str
ïï. 9
]
ïï9 :
.
ïï: ;
ToString
ïï; C
(
ïïC D
)
ïïD E
;
ïïE F
row
ññ 
[
ññ 
$str
ññ 
]
ññ  
=
ññ! "
reader
ññ# )
[
ññ) *
$str
ññ* 1
]
ññ1 2
;
ññ2 3
row
óó 
[
óó 
$str
óó %
]
óó% &
=
óó' (
reader
óó) /
[
óó/ 0
$str
óó0 =
]
óó= >
;
óó> ?
row
òò 
[
òò 
$str
òò "
]
òò" #
=
òò$ %
reader
òò& ,
[
òò, -
$str
òò- 7
]
òò7 8
;
òò8 9
row
ôô 
[
ôô 
$str
ôô #
]
ôô# $
=
ôô% &
reader
ôô' -
[
ôô- .
$str
ôô. 9
]
ôô9 :
;
ôô: ;
row
öö 
[
öö 
$str
öö &
]
öö& '
=
öö( )
reader
öö* 0
[
öö0 1
$str
öö1 ?
]
öö? @
;
öö@ A
row
õõ 
[
õõ 
$str
õõ ,
]
õõ, -
=
õõ. /
reader
õõ0 6
[
õõ6 7
$str
õõ7 K
]
õõK L
;
õõL M
row
úú 
[
úú 
$str
úú 8
]
úú8 9
=
úú: ;
reader
úú< B
[
úúB C
$str
úúC c
]
úúc d
;
úúd e
row
ùù 
[
ùù 
$str
ùù 3
]
ùù3 4
=
ùù5 6
reader
ùù7 =
[
ùù= >
$str
ùù> Y
]
ùùY Z
;
ùùZ [
row
ûû 
[
ûû 
$str
ûû $
]
ûû$ %
=
ûû& '
reader
ûû( .
[
ûû. /
$str
ûû/ ;
]
ûû; <
;
ûû< =
dt
†† 
.
†† 
Rows
†† 
.
†† 
Add
†† 
(
††  
row
††  #
)
††# $
;
††$ %
}
¢¢ 
}
§§ 
return
¶¶ 
dt
¶¶ 
;
¶¶ 
}
®® 	
public
™™ 
static
™™ 
bool
™™ 
Exists
™™ !
(
™™! "
Int32
™™" '
siteId
™™( .
,
™™. /
String
™™0 6
	className
™™7 @
,
™™@ A
String
™™B H
assemblyName
™™I U
)
™™U V
{
´´ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M%
GetReadConnectionString
¨¨M d
(
¨¨d e
)
¨¨e f
,
¨¨f g
$str¨¨h É
,¨¨É Ñ
$num¨¨Ö Ü
)¨¨Ü á
;¨¨á à
sph
≠≠ 
.
≠≠  
DefineSqlParameter
≠≠ "
(
≠≠" #
$str
≠≠# ,
,
≠≠, -
	SqlDbType
≠≠. 7
.
≠≠7 8
Int
≠≠8 ;
,
≠≠; < 
ParameterDirection
≠≠= O
.
≠≠O P
Input
≠≠P U
,
≠≠U V
siteId
≠≠W ]
)
≠≠] ^
;
≠≠^ _
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# /
,
ÆÆ/ 0
	SqlDbType
ÆÆ1 :
.
ÆÆ: ;
NVarChar
ÆÆ; C
,
ÆÆC D
$num
ÆÆE H
,
ÆÆH I 
ParameterDirection
ÆÆJ \
.
ÆÆ\ ]
Input
ÆÆ] b
,
ÆÆb c
	className
ÆÆd m
)
ÆÆm n
;
ÆÆn o
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 2
,
ØØ2 3
	SqlDbType
ØØ4 =
.
ØØ= >
NVarChar
ØØ> F
,
ØØF G
$num
ØØH K
,
ØØK L 
ParameterDirection
ØØM _
.
ØØ_ `
Input
ØØ` e
,
ØØe f
assemblyName
ØØg s
)
ØØs t
;
ØØt u
int
∞∞ 
count
∞∞ 
=
∞∞ 
Convert
∞∞ 
.
∞∞  
ToInt32
∞∞  '
(
∞∞' (
sph
∞∞( +
.
∞∞+ ,
ExecuteScalar
∞∞, 9
(
∞∞9 :
)
∞∞: ;
)
∞∞; <
;
∞∞< =
return
±± 
(
±± 
count
±± 
>
±± 
$num
±± 
)
±± 
;
±± 
}
≤≤ 	
public
¥¥ 
static
¥¥ 
IDataReader
¥¥ !"
GetWebPartsForMyPage
¥¥" 6
(
¥¥6 7
int
¥¥7 :
siteId
¥¥; A
)
¥¥A B
{
µµ 	
StringBuilder
∫∫ 

sqlCommand
∫∫ $
=
∫∫% &
new
∫∫' *
StringBuilder
∫∫+ 8
(
∫∫8 9
)
∫∫9 :
;
∫∫: ;

sqlCommand
ºº 
.
ºº 
Append
ºº 
(
ºº 
$str
ºº 3
)
ºº3 4
;
ºº4 5

sqlCommand
ΩΩ 
.
ΩΩ 
Append
ΩΩ 
(
ΩΩ 
$str
ΩΩ %
)
ΩΩ% &
;
ΩΩ& '

sqlCommand
ææ 
.
ææ 
Append
ææ 
(
ææ 
$str
ææ )
)
ææ) *
;
ææ* +

sqlCommand
øø 
.
øø 
Append
øø 
(
øø 
$str
øø ,
)
øø, -
;
øø- .

sqlCommand
¿¿ 
.
¿¿ 
Append
¿¿ 
(
¿¿ 
$str
¿¿ *
)
¿¿* +
;
¿¿+ ,

sqlCommand
¡¡ 
.
¡¡ 
Append
¡¡ 
(
¡¡ 
$str
¡¡ /
)
¡¡/ 0
;
¡¡0 1

sqlCommand
¬¬ 
.
¬¬ 
Append
¬¬ 
(
¬¬ 
$str
¬¬ /
)
¬¬/ 0
;
¬¬0 1

sqlCommand
√√ 
.
√√ 
Append
√√ 
(
√√ 
$str
√√ B
)
√√B C
;
√√C D

sqlCommand
ƒƒ 
.
ƒƒ 
Append
ƒƒ 
(
ƒƒ 
$str
ƒƒ 7
)
ƒƒ7 8
;
ƒƒ8 9

sqlCommand
≈≈ 
.
≈≈ 
Append
≈≈ 
(
≈≈ 
$str
≈≈ 6
)
≈≈6 7
;
≈≈7 8

sqlCommand
∆∆ 
.
∆∆ 
Append
∆∆ 
(
∆∆ 
$str
∆∆ 8
)
∆∆8 9
;
∆∆9 :

sqlCommand
«« 
.
«« 
Append
«« 
(
«« 
$str
«« 0
)
««0 1
;
««1 2

sqlCommand
»» 
.
»» 
Append
»» 
(
»» 
$str
»» 1
)
»»1 2
;
»»2 3

sqlCommand
…… 
.
…… 
Append
…… 
(
…… 
$str
…… 1
)
……1 2
;
……2 3

sqlCommand
   
.
   
Append
   
(
   
$str
   0
)
  0 1
;
  1 2

sqlCommand
ÃÃ 
.
ÃÃ 
Append
ÃÃ 
(
ÃÃ 
$str
ÃÃ 3
)
ÃÃ3 4
;
ÃÃ4 5

sqlCommand
ÕÕ 
.
ÕÕ 
Append
ÕÕ 
(
ÕÕ 
$str
ÕÕ >
)
ÕÕ> ?
;
ÕÕ? @

sqlCommand
ŒŒ 
.
ŒŒ 
Append
ŒŒ 
(
ŒŒ 
$str
ŒŒ B
)
ŒŒB C
;
ŒŒC D

sqlCommand
–– 
.
–– 
Append
–– 
(
–– 
$str
–– V
)
––V W
;
––W X

sqlCommand
”” 
.
”” 
Append
”” 
(
”” 
$str
”” '
)
””' (
;
””( )

sqlCommand
’’ 
.
’’ 
Append
’’ 
(
’’ 
$str
’’ )
)
’’) *
;
’’* +

sqlCommand
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
$str
÷÷ 0
)
÷÷0 1
;
÷÷1 2

sqlCommand
◊◊ 
.
◊◊ 
Append
◊◊ 
(
◊◊ 
$str
◊◊ *
)
◊◊* +
;
◊◊+ ,

sqlCommand
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
ÿÿ 2
)
ÿÿ2 3
;
ÿÿ3 4

sqlCommand
ŸŸ 
.
ŸŸ 
Append
ŸŸ 
(
ŸŸ 
$str
ŸŸ 8
)
ŸŸ8 9
;
ŸŸ9 :

sqlCommand
⁄⁄ 
.
⁄⁄ 
Append
⁄⁄ 
(
⁄⁄ 
$str
⁄⁄ B
)
⁄⁄B C
;
⁄⁄C D

sqlCommand
€€ 
.
€€ 
Append
€€ 
(
€€ 
$str
€€ 7
)
€€7 8
;
€€8 9

sqlCommand
‹‹ 
.
‹‹ 
Append
‹‹ 
(
‹‹ 
$str
‹‹ :
)
‹‹: ;
;
‹‹; <

sqlCommand
›› 
.
›› 
Append
›› 
(
›› 
$str
›› ;
)
››; <
;
››< =

sqlCommand
ﬁﬁ 
.
ﬁﬁ 
Append
ﬁﬁ 
(
ﬁﬁ 
$str
ﬁﬁ >
)
ﬁﬁ> ?
;
ﬁﬁ? @

sqlCommand
ﬂﬂ 
.
ﬂﬂ 
Append
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ <
)
ﬂﬂ< =
;
ﬂﬂ= >

sqlCommand
‡‡ 
.
‡‡ 
Append
‡‡ 
(
‡‡ 
$str
‡‡ 1
)
‡‡1 2
;
‡‡2 3

sqlCommand
·· 
.
·· 
Append
·· 
(
·· 
$str
·· N
)
··N O
;
··O P

sqlCommand
‚‚ 
.
‚‚ 
Append
‚‚ 
(
‚‚ 
$str
‚‚ 4
)
‚‚4 5
;
‚‚5 6

sqlCommand
„„ 
.
„„ 
Append
„„ 
(
„„ 
$str
„„ V
)
„„V W
;
„„W X

sqlCommand
‰‰ 
.
‰‰ 
Append
‰‰ 
(
‰‰ 
$str
‰‰ (
)
‰‰( )
;
‰‰) *

sqlCommand
ÂÂ 
.
ÂÂ 
Append
ÂÂ 
(
ÂÂ 
$str
ÂÂ 9
)
ÂÂ9 :
;
ÂÂ: ; 
SqlParameterHelper
ÁÁ 
sph
ÁÁ "
=
ÁÁ# $
new
ÁÁ% ( 
SqlParameterHelper
ÁÁ) ;
(
ÁÁ; <
ConnectionString
ÁÁ< L
.
ÁÁL M%
GetReadConnectionString
ÁÁM d
(
ÁÁd e
)
ÁÁe f
,
ÁÁf g

sqlCommand
ÁÁh r
.
ÁÁr s
ToString
ÁÁs {
(
ÁÁ{ |
)
ÁÁ| }
,
ÁÁ} ~
CommandTypeÁÁ ä
.ÁÁä ã
TextÁÁã è
,ÁÁè ê
$numÁÁë í
)ÁÁí ì
;ÁÁì î
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# ,
,
ËË, -
	SqlDbType
ËË. 7
.
ËË7 8
Int
ËË8 ;
,
ËË; < 
ParameterDirection
ËË= O
.
ËËO P
Input
ËËP U
,
ËËU V
siteId
ËËW ]
)
ËË] ^
;
ËË^ _
return
ÈÈ 
sph
ÈÈ 
.
ÈÈ 
ExecuteReader
ÈÈ $
(
ÈÈ$ %
)
ÈÈ% &
;
ÈÈ& '
}
ÎÎ 	
public
ÌÌ 
static
ÌÌ 
IDataReader
ÌÌ !
GetMostPopular
ÌÌ" 0
(
ÌÌ0 1
int
ÌÌ1 4
siteId
ÌÌ5 ;
,
ÌÌ; <
int
ÌÌ= @
numberToGet
ÌÌA L
)
ÌÌL M
{
ÓÓ 	
StringBuilder
ÔÔ 

sqlCommand
ÔÔ $
=
ÔÔ% &
new
ÔÔ' *
StringBuilder
ÔÔ+ 8
(
ÔÔ8 9
)
ÔÔ9 :
;
ÔÔ: ;

sqlCommand
ÒÒ 
.
ÒÒ 
Append
ÒÒ 
(
ÒÒ 
$str
ÒÒ +
+
ÒÒ, -
numberToGet
ÒÒ. 9
+
ÒÒ: ;
$str
ÒÒ< J
)
ÒÒJ K
;
ÒÒK L

sqlCommand
ÚÚ 
.
ÚÚ 
Append
ÚÚ 
(
ÚÚ 
$str
ÚÚ %
)
ÚÚ% &
;
ÚÚ& '

sqlCommand
ÛÛ 
.
ÛÛ 
Append
ÛÛ 
(
ÛÛ 
$str
ÛÛ )
)
ÛÛ) *
;
ÛÛ* +

sqlCommand
ÙÙ 
.
ÙÙ 
Append
ÙÙ 
(
ÙÙ 
$str
ÙÙ ,
)
ÙÙ, -
;
ÙÙ- .

sqlCommand
ıı 
.
ıı 
Append
ıı 
(
ıı 
$str
ıı *
)
ıı* +
;
ıı+ ,

sqlCommand
ˆˆ 
.
ˆˆ 
Append
ˆˆ 
(
ˆˆ 
$str
ˆˆ /
)
ˆˆ/ 0
;
ˆˆ0 1

sqlCommand
˜˜ 
.
˜˜ 
Append
˜˜ 
(
˜˜ 
$str
˜˜ /
)
˜˜/ 0
;
˜˜0 1

sqlCommand
¯¯ 
.
¯¯ 
Append
¯¯ 
(
¯¯ 
$str
¯¯ B
)
¯¯B C
;
¯¯C D

sqlCommand
˘˘ 
.
˘˘ 
Append
˘˘ 
(
˘˘ 
$str
˘˘ 7
)
˘˘7 8
;
˘˘8 9

sqlCommand
˙˙ 
.
˙˙ 
Append
˙˙ 
(
˙˙ 
$str
˙˙ 6
)
˙˙6 7
;
˙˙7 8

sqlCommand
˚˚ 
.
˚˚ 
Append
˚˚ 
(
˚˚ 
$str
˚˚ 8
)
˚˚8 9
;
˚˚9 :

sqlCommand
¸¸ 
.
¸¸ 
Append
¸¸ 
(
¸¸ 
$str
¸¸ 0
)
¸¸0 1
;
¸¸1 2

sqlCommand
˝˝ 
.
˝˝ 
Append
˝˝ 
(
˝˝ 
$str
˝˝ 1
)
˝˝1 2
;
˝˝2 3

sqlCommand
˛˛ 
.
˛˛ 
Append
˛˛ 
(
˛˛ 
$str
˛˛ 1
)
˛˛1 2
;
˛˛2 3

sqlCommand
ˇˇ 
.
ˇˇ 
Append
ˇˇ 
(
ˇˇ 
$str
ˇˇ 0
)
ˇˇ0 1
;
ˇˇ1 2

sqlCommand
ÅÅ 
.
ÅÅ 
Append
ÅÅ 
(
ÅÅ 
$str
ÅÅ 3
)
ÅÅ3 4
;
ÅÅ4 5

sqlCommand
ÇÇ 
.
ÇÇ 
Append
ÇÇ 
(
ÇÇ 
$str
ÇÇ >
)
ÇÇ> ?
;
ÇÇ? @

sqlCommand
ÉÉ 
.
ÉÉ 
Append
ÉÉ 
(
ÉÉ 
$str
ÉÉ B
)
ÉÉB C
;
ÉÉC D

sqlCommand
ÖÖ 
.
ÖÖ 
Append
ÖÖ 
(
ÖÖ 
$str
ÖÖ V
)
ÖÖV W
;
ÖÖW X

sqlCommand
àà 
.
àà 
Append
àà 
(
àà 
$str
àà '
)
àà' (
;
àà( )

sqlCommand
ää 
.
ää 
Append
ää 
(
ää 
$str
ää )
)
ää) *
;
ää* +

sqlCommand
ãã 
.
ãã 
Append
ãã 
(
ãã 
$str
ãã 0
)
ãã0 1
;
ãã1 2

sqlCommand
åå 
.
åå 
Append
åå 
(
åå 
$str
åå *
)
åå* +
;
åå+ ,

sqlCommand
çç 
.
çç 
Append
çç 
(
çç 
$str
çç 2
)
çç2 3
;
çç3 4

sqlCommand
éé 
.
éé 
Append
éé 
(
éé 
$str
éé 8
)
éé8 9
;
éé9 :

sqlCommand
èè 
.
èè 
Append
èè 
(
èè 
$str
èè B
)
èèB C
;
èèC D

sqlCommand
êê 
.
êê 
Append
êê 
(
êê 
$str
êê 7
)
êê7 8
;
êê8 9

sqlCommand
ëë 
.
ëë 
Append
ëë 
(
ëë 
$str
ëë :
)
ëë: ;
;
ëë; <

sqlCommand
íí 
.
íí 
Append
íí 
(
íí 
$str
íí ;
)
íí; <
;
íí< =

sqlCommand
ìì 
.
ìì 
Append
ìì 
(
ìì 
$str
ìì >
)
ìì> ?
;
ìì? @

sqlCommand
îî 
.
îî 
Append
îî 
(
îî 
$str
îî <
)
îî< =
;
îî= >

sqlCommand
ïï 
.
ïï 
Append
ïï 
(
ïï 
$str
ïï 1
)
ïï1 2
;
ïï2 3

sqlCommand
ññ 
.
ññ 
Append
ññ 
(
ññ 
$str
ññ N
)
ññN O
;
ññO P

sqlCommand
óó 
.
óó 
Append
óó 
(
óó 
$str
óó 4
)
óó4 5
;
óó5 6

sqlCommand
òò 
.
òò 
Append
òò 
(
òò 
$str
òò V
)
òòV W
;
òòW X

sqlCommand
ôô 
.
ôô 
Append
ôô 
(
ôô 
$str
ôô (
)
ôô( )
;
ôô) *

sqlCommand
öö 
.
öö 
Append
öö 
(
öö 
$str
öö T
)
ööT U
;
ööU V 
SqlParameterHelper
úú 
sph
úú "
=
úú# $
new
úú% ( 
SqlParameterHelper
úú) ;
(
úú; <
ConnectionString
úú< L
.
úúL M%
GetReadConnectionString
úúM d
(
úúd e
)
úúe f
,
úúf g

sqlCommand
úúh r
.
úúr s
ToString
úús {
(
úú{ |
)
úú| }
,
úú} ~
CommandTypeúú ä
.úúä ã
Textúúã è
,úúè ê
$numúúë í
)úúí ì
;úúì î
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# ,
,
ùù, -
	SqlDbType
ùù. 7
.
ùù7 8
Int
ùù8 ;
,
ùù; < 
ParameterDirection
ùù= O
.
ùùO P
Input
ùùP U
,
ùùU V
siteId
ùùW ]
)
ùù] ^
;
ùù^ _
return
ûû 
sph
ûû 
.
ûû 
ExecuteReader
ûû $
(
ûû$ %
)
ûû% &
;
ûû& '
}
°° 	
public
££ 
static
££ 
int
££ 
Count
££ 
(
££  
int
££  #
siteId
££$ *
)
££* +
{
§§ 	 
SqlParameterHelper
•• 
sph
•• "
=
••# $
new
••% ( 
SqlParameterHelper
••) ;
(
••; <
ConnectionString
••< L
.
••L M%
GetReadConnectionString
••M d
(
••d e
)
••e f
,
••f g
$str
••h ~
,
••~ 
$num••Ä Å
)••Å Ç
;••Ç É
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# ,
,
¶¶, -
	SqlDbType
¶¶. 7
.
¶¶7 8
Int
¶¶8 ;
,
¶¶; < 
ParameterDirection
¶¶= O
.
¶¶O P
Input
¶¶P U
,
¶¶U V
siteId
¶¶W ]
)
¶¶] ^
;
¶¶^ _
int
ßß 
count
ßß 
=
ßß 
Convert
ßß 
.
ßß  
ToInt32
ßß  '
(
ßß' (
sph
ßß( +
.
ßß+ ,
ExecuteScalar
ßß, 9
(
ßß9 :
)
ßß: ;
)
ßß; <
;
ßß< =
return
®® 
count
®® 
;
®® 
}
©© 	
}
∞∞ 
}±± –ü
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SqlHelper.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
	SqlHelper !
{ 
private 
static 
void 
PrepareCommand *
(* +

SqlCommand 
command 
, 
SqlConnection 

connection $
,$ %
SqlTransaction 
transaction &
,& '
CommandType 
commandType #
,# $
string   
commandText   
,   
SqlParameter!! 
[!! 
]!! 
commandParameters!! ,
)!!, -
{"" 	
if## 
(## 
command## 
==## 
null## 
)##  
throw##! &
new##' *!
ArgumentNullException##+ @
(##@ A
$str##A J
)##J K
;##K L
if$$ 
($$ 
string$$ 
.$$ 
IsNullOrEmpty$$ $
($$$ %
commandText$$% 0
)$$0 1
)$$1 2
throw$$3 8
new$$9 <!
ArgumentNullException$$= R
($$R S
$str$$S `
)$$` a
;$$a b
command&& 
.&& 
CommandType&& 
=&&  !
commandType&&" -
;&&- .
command'' 
.'' 
CommandText'' 
=''  !
commandText''" -
;''- .
command(( 
.(( 

Connection(( 
=((  

connection((! +
;((+ ,
if** 
(** 
transaction** 
!=** 
null** #
)**# $
{++ 
if,, 
(,, 
transaction,, 
.,,  

Connection,,  *
==,,+ -
null,,. 2
),,2 3
throw,,4 9
new,,: =
ArgumentException,,> O
(,,O P
$str	,,P °
,
,,° ¢
$str
,,£ ∞
)
,,∞ ±
;
,,± ≤
command-- 
.-- 
Transaction-- #
=--$ %
transaction--& 1
;--1 2
}.. 
if00 
(00 
commandParameters00 !
!=00" $
null00% )
)00) *
{00+ ,
AttachParameters00- =
(00= >
command00> E
,00E F
commandParameters00G X
)00X Y
;00Y Z
}00[ \
}11 	
private33 
static33 
void33 
AttachParameters33 ,
(33, -

SqlCommand33- 7
command338 ?
,33? @
SqlParameter33A M
[33M N
]33N O
commandParameters33P a
)33a b
{44 	
if55 
(55 
command55 
==55 
null55 
)55  
throw55! &
new55' *!
ArgumentNullException55+ @
(55@ A
$str55A J
)55J K
;55K L
if66 
(66 
commandParameters66 !
!=66" $
null66% )
)66) *
{77 
foreach88 
(88 
SqlParameter88 %
p88& '
in88( *
commandParameters88+ <
)88< =
{99 
if:: 
(:: 
p:: 
!=:: 
null:: !
)::! "
{;; 
if<< 
(<< 
(<< 
p<< 
.<< 
	Direction<< (
==<<) +
ParameterDirection<<, >
.<<> ?
InputOutput<<? J
||<<K M
p== 
.== 
	Direction== '
====( *
ParameterDirection==+ =
.=== >
Input==> C
)==C D
&&==E G
(>> 
p>> 
.>> 
Value>> $
==>>% '
null>>( ,
)>>, -
)>>- .
{?? 
p@@ 
.@@ 
Value@@ #
=@@$ %
DBNull@@& ,
.@@, -
Value@@- 2
;@@2 3
}AA 
commandBB 
.BB  

ParametersBB  *
.BB* +
AddBB+ .
(BB. /
pBB/ 0
)BB0 1
;BB1 2
}CC 
}DD 
}EE 
}FF 	
publicHH 
staticHH 
intHH 
ExecuteNonQueryHH )
(HH) *
stringHH* 0
connectionStringHH1 A
,HHA B
CommandTypeHHC N
commandTypeHHO Z
,HHZ [
stringHH\ b
commandTextHHc n
,HHn o
paramsHHp v
SqlParameter	HHw É
[
HHÉ Ñ
]
HHÑ Ö
commandParameters
HHÜ ó
)
HHó ò
{II 	
intJJ 
commandTimeoutJJ 
=JJ  
$numJJ! #
;JJ# $
returnLL 
ExecuteNonQueryLL "
(LL" #
connectionStringLL# 3
,LL3 4
commandTypeLL5 @
,LL@ A
commandTextLLB M
,LLM N
commandTimeoutLLO ]
,LL] ^
commandParametersLL_ p
)LLp q
;LLq r
}XX 	
publicZZ 
staticZZ 
intZZ 
ExecuteNonQueryZZ )
(ZZ) *
stringZZ* 0
connectionStringZZ1 A
,ZZA B
CommandTypeZZC N
commandTypeZZO Z
,ZZZ [
stringZZ\ b
commandTextZZc n
,ZZn o
intZZp s
commandTimeout	ZZt Ç
,
ZZÇ É
params
ZZÑ ä
SqlParameter
ZZã ó
[
ZZó ò
]
ZZò ô
commandParameters
ZZö ´
)
ZZ´ ¨
{[[ 	
if\\ 
(\\ 
connectionString\\  
==\\! #
null\\$ (
||\\) +
connectionString\\, <
.\\< =
Length\\= C
==\\D F
$num\\G H
)\\H I
throw\\J O
new\\P S!
ArgumentNullException\\T i
(\\i j
$str\\j |
)\\| }
;\\} ~
using]] 
(]] 
SqlConnection]]  

connection]]! +
=]], -
new]]. 1
SqlConnection]]2 ?
(]]? @
connectionString]]@ P
)]]P Q
)]]Q R
{^^ 

connection__ 
.__ 
Open__ 
(__  
)__  !
;__! "
using`` 
(`` 

SqlCommand`` !
command``" )
=``* +
new``, /

SqlCommand``0 :
(``: ;
)``; <
)``< =
{aa 
PrepareCommandbb "
(bb" #
commandbb# *
,bb* +

connectionbb, 6
,bb6 7
nullbb8 <
,bb< =
commandTypebb> I
,bbI J
commandTextbbK V
,bbV W
commandParametersbbX i
)bbi j
;bbj k
commandcc 
.cc 
CommandTimeoutcc *
=cc+ ,
commandTimeoutcc- ;
;cc; <
returndd 
commanddd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
}ee 
}ff 
}gg 	
publicii 
staticii 
intii 
ExecuteNonQueryii )
(ii) *
SqlTransactionjj 
transactionjj &
,jj& '
CommandTypekk 
commandTypekk #
,kk# $
stringll 
commandTextll 
,ll 
paramsmm 
SqlParametermm 
[mm  
]mm  !
commandParametersmm" 3
)mm3 4
{nn 	
intoo 
commandTimeoutoo 
=oo  
$numoo! #
;oo# $
returnqq 
ExecuteNonQueryqq "
(qq" #
transactionqq# .
,qq. /
commandTypeqq0 ;
,qq; <
commandTextqq= H
,qqH I
commandTimeoutqqJ X
,qqX Y
commandParametersqqZ k
)qqk l
;qql m
}
ÇÇ 	
public
ÑÑ 
static
ÑÑ 
int
ÑÑ 
ExecuteNonQuery
ÑÑ )
(
ÑÑ) *
SqlTransaction
ÖÖ 
transaction
ÖÖ &
,
ÖÖ& '
CommandType
ÜÜ 
commandType
ÜÜ #
,
ÜÜ# $
string
áá 
commandText
áá 
,
áá 
int
àà 
commandTimeout
àà 
,
àà 
params
ââ 
SqlParameter
ââ 
[
ââ  
]
ââ  !
commandParameters
ââ" 3
)
ââ3 4
{
ää 	
if
ãã 
(
ãã 
transaction
ãã 
==
ãã 
null
ãã #
)
ãã# $
throw
ãã% *
new
ãã+ .#
ArgumentNullException
ãã/ D
(
ããD E
$str
ããE R
)
ããR S
;
ããS T
if
åå 
(
åå 
transaction
åå 
!=
åå 
null
åå #
&&
åå$ &
transaction
åå' 2
.
åå2 3

Connection
åå3 =
==
åå> @
null
ååA E
)
ååE F
throw
ååG L
new
ååM P
ArgumentException
ååQ b
(
ååb c
$strååc ¥
,åå¥ µ
$stråå∂ √
)åå√ ƒ
;ååƒ ≈
using
éé 
(
éé 

SqlCommand
éé 
command
éé %
=
éé& '
new
éé( +

SqlCommand
éé, 6
(
éé6 7
)
éé7 8
)
éé8 9
{
èè 
PrepareCommand
êê 
(
êê 
command
ëë 
,
ëë 
transaction
íí 
.
íí  

Connection
íí  *
,
íí* +
transaction
ìì 
,
ìì  
commandType
îî 
,
îî  
commandText
ïï 
,
ïï  
commandParameters
ññ %
)
ññ% &
;
ññ& '
command
òò 
.
òò 
CommandTimeout
òò &
=
òò' (
commandTimeout
òò) 7
;
òò7 8
return
öö 
command
öö 
.
öö 
ExecuteNonQuery
öö .
(
öö. /
)
öö/ 0
;
öö0 1
}
õõ 
}
úú 	
public
ûû 
static
ûû 
SqlDataReader
ûû #
ExecuteReader
ûû$ 1
(
ûû1 2
string
ûû2 8
connectionString
ûû9 I
,
ûûI J
CommandType
ûûK V
commandType
ûûW b
,
ûûb c
string
ûûd j
commandText
ûûk v
,
ûûv w
params
ûûx ~
SqlParameterûû ã
[ûûã å
]ûûå ç!
commandParametersûûé ü
)ûûü †
{
üü 	
int
†† 
commandTimeout
†† 
=
††  
$num
††! #
;
††# $
return
°° 
ExecuteReader
°°  
(
°°  !
connectionString
°°! 1
,
°°1 2
commandType
°°3 >
,
°°> ?
commandText
°°@ K
,
°°K L
commandTimeout
°°M [
,
°°[ \
commandParameters
°°] n
)
°°n o
;
°°o p
}
ªª 	
public
ΩΩ 
static
ΩΩ 
SqlDataReader
ΩΩ #
ExecuteReader
ΩΩ$ 1
(
ΩΩ1 2
string
ΩΩ2 8
connectionString
ΩΩ9 I
,
ΩΩI J
CommandType
ΩΩK V
commandType
ΩΩW b
,
ΩΩb c
string
ΩΩd j
commandText
ΩΩk v
,
ΩΩv w
int
ΩΩx {
commandTimeoutΩΩ| ä
,ΩΩä ã
paramsΩΩå í
SqlParameterΩΩì ü
[ΩΩü †
]ΩΩ† °!
commandParametersΩΩ¢ ≥
)ΩΩ≥ ¥
{
ææ 	
if
øø 
(
øø 
connectionString
øø  
==
øø! #
null
øø$ (
||
øø) +
connectionString
øø, <
.
øø< =
Length
øø= C
==
øøD F
$num
øøG H
)
øøH I
throw
øøJ O
new
øøP S#
ArgumentNullException
øøT i
(
øøi j
$str
øøj |
)
øø| }
;
øø} ~
SqlConnection
¿¿ 

connection
¿¿ $
=
¿¿% &
null
¿¿' +
;
¿¿+ ,
try
¡¡ 
{
¬¬ 

connection
√√ 
=
√√ 
new
√√  
SqlConnection
√√! .
(
√√. /
connectionString
√√/ ?
)
√√? @
;
√√@ A

connection
ƒƒ 
.
ƒƒ 
Open
ƒƒ 
(
ƒƒ  
)
ƒƒ  !
;
ƒƒ! "
using
≈≈ 
(
≈≈ 

SqlCommand
≈≈ !
command
≈≈" )
=
≈≈* +
new
≈≈, /

SqlCommand
≈≈0 :
(
≈≈: ;
)
≈≈; <
)
≈≈< =
{
∆∆ 
PrepareCommand
«« "
(
««" #
command
»» 
,
»»  

connection
…… "
,
……" #
null
   
,
   
commandType
ÀÀ #
,
ÀÀ# $
commandText
ÃÃ #
,
ÃÃ# $
commandParameters
ÕÕ )
)
ÕÕ) *
;
ÕÕ* +
command
œœ 
.
œœ 
CommandTimeout
œœ *
=
œœ+ ,
commandTimeout
œœ- ;
;
œœ; <
return
—— 
command
—— "
.
——" #
ExecuteReader
——# 0
(
——0 1
CommandBehavior
——1 @
.
——@ A
CloseConnection
——A P
)
——P Q
;
——Q R
}
““ 
}
”” 
catch
‘‘ 
{
’’ 
if
÷÷ 
(
÷÷ 
(
÷÷ 

connection
÷÷ 
!=
÷÷  "
null
÷÷# '
)
÷÷' (
&&
÷÷) +
(
÷÷, -

connection
÷÷- 7
.
÷÷7 8
State
÷÷8 =
==
÷÷> @
ConnectionState
÷÷A P
.
÷÷P Q
Open
÷÷Q U
)
÷÷U V
)
÷÷V W
{
÷÷X Y

connection
÷÷Z d
.
÷÷d e
Close
÷÷e j
(
÷÷j k
)
÷÷k l
;
÷÷l m
}
÷÷n o
throw
◊◊ 
;
◊◊ 
}
ÿÿ 
}
ŸŸ 	
public
€€ 
static
€€ 
object
€€ 
ExecuteScalar
€€ *
(
€€* +
string
€€+ 1
connectionString
€€2 B
,
€€B C
CommandType
€€D O
commandType
€€P [
,
€€[ \
string
€€] c
commandText
€€d o
,
€€o p
params
€€q w
SqlParameter€€x Ñ
[€€Ñ Ö
]€€Ö Ü!
commandParameters€€á ò
)€€ò ô
{
‹‹ 	
int
›› 
commandTimeout
›› 
=
››  
$num
››! #
;
››# $
return
ﬁﬁ 
ExecuteScalar
ﬁﬁ  
(
ﬁﬁ  !
connectionString
ﬁﬁ! 1
,
ﬁﬁ1 2
commandType
ﬁﬁ3 >
,
ﬁﬁ> ?
commandText
ﬁﬁ@ K
,
ﬁﬁK L
commandTimeout
ﬁﬁM [
,
ﬁﬁ[ \
commandParameters
ﬁﬁ] n
)
ﬁﬁn o
;
ﬁﬁo p
}
ÍÍ 	
public
ÏÏ 
static
ÏÏ 
object
ÏÏ 
ExecuteScalar
ÏÏ *
(
ÏÏ* +
string
ÏÏ+ 1
connectionString
ÏÏ2 B
,
ÏÏB C
CommandType
ÏÏD O
commandType
ÏÏP [
,
ÏÏ[ \
string
ÏÏ] c
commandText
ÏÏd o
,
ÏÏo p
int
ÏÏq t
commandTimeoutÏÏu É
,ÏÏÉ Ñ
paramsÏÏÖ ã
SqlParameterÏÏå ò
[ÏÏò ô
]ÏÏô ö!
commandParametersÏÏõ ¨
)ÏÏ¨ ≠
{
ÌÌ 	
if
ÓÓ 
(
ÓÓ 
connectionString
ÓÓ  
==
ÓÓ! #
null
ÓÓ$ (
||
ÓÓ) +
connectionString
ÓÓ, <
.
ÓÓ< =
Length
ÓÓ= C
==
ÓÓD F
$num
ÓÓG H
)
ÓÓH I
throw
ÓÓJ O
new
ÓÓP S#
ArgumentNullException
ÓÓT i
(
ÓÓi j
$str
ÓÓj |
)
ÓÓ| }
;
ÓÓ} ~
using
ÔÔ 
(
ÔÔ 
SqlConnection
ÔÔ  

connection
ÔÔ! +
=
ÔÔ, -
new
ÔÔ. 1
SqlConnection
ÔÔ2 ?
(
ÔÔ? @
connectionString
ÔÔ@ P
)
ÔÔP Q
)
ÔÔQ R
{
 

connection
ÒÒ 
.
ÒÒ 
Open
ÒÒ 
(
ÒÒ  
)
ÒÒ  !
;
ÒÒ! "
using
ÚÚ 
(
ÚÚ 

SqlCommand
ÚÚ !
command
ÚÚ" )
=
ÚÚ* +
new
ÚÚ, /

SqlCommand
ÚÚ0 :
(
ÚÚ: ;
)
ÚÚ; <
)
ÚÚ< =
{
ÛÛ 
PrepareCommand
ÙÙ "
(
ÙÙ" #
command
ÙÙ# *
,
ÙÙ* +

connection
ÙÙ, 6
,
ÙÙ6 7
(
ÙÙ8 9
SqlTransaction
ÙÙ9 G
)
ÙÙG H
null
ÙÙH L
,
ÙÙL M
commandType
ÙÙN Y
,
ÙÙY Z
commandText
ÙÙ[ f
,
ÙÙf g
commandParameters
ÙÙh y
)
ÙÙy z
;
ÙÙz {
command
ıı 
.
ıı 
CommandTimeout
ıı *
=
ıı+ ,
commandTimeout
ıı- ;
;
ıı; <
return
˜˜ 
command
˜˜ "
.
˜˜" #
ExecuteScalar
˜˜# 0
(
˜˜0 1
)
˜˜1 2
;
˜˜2 3
}
¯¯ 
}
˘˘ 
}
˙˙ 	
public
¸¸ 
static
¸¸ 
DataSet
¸¸ 
ExecuteDataset
¸¸ ,
(
¸¸, -
string
¸¸- 3
connectionString
¸¸4 D
,
¸¸D E
CommandType
¸¸F Q
commandType
¸¸R ]
,
¸¸] ^
string
¸¸_ e
commandText
¸¸f q
)
¸¸q r
{
˝˝ 	
return
˛˛ 
ExecuteDataset
˛˛ !
(
˛˛! "
connectionString
˛˛" 2
,
˛˛2 3
commandType
˛˛4 ?
,
˛˛? @
commandText
˛˛A L
,
˛˛L M
(
˛˛N O
SqlParameter
˛˛O [
[
˛˛[ \
]
˛˛\ ]
)
˛˛] ^
null
˛˛^ b
)
˛˛b c
;
˛˛c d
}
ˇˇ 	
public
ÅÅ 
static
ÅÅ 
DataSet
ÅÅ 
ExecuteDataset
ÅÅ ,
(
ÅÅ, -
string
ÅÅ- 3
connectionString
ÅÅ4 D
,
ÅÅD E
CommandType
ÅÅF Q
commandType
ÅÅR ]
,
ÅÅ] ^
string
ÅÅ_ e
commandText
ÅÅf q
,
ÅÅq r
params
ÅÅs y
SqlParameterÅÅz Ü
[ÅÅÜ á
]ÅÅá à!
commandParametersÅÅâ ö
)ÅÅö õ
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
connectionString
ÉÉ  
==
ÉÉ! #
null
ÉÉ$ (
||
ÉÉ) +
connectionString
ÉÉ, <
.
ÉÉ< =
Length
ÉÉ= C
==
ÉÉD F
$num
ÉÉG H
)
ÉÉH I
throw
ÉÉJ O
new
ÉÉP S#
ArgumentNullException
ÉÉT i
(
ÉÉi j
$str
ÉÉj |
)
ÉÉ| }
;
ÉÉ} ~
using
ÖÖ 
(
ÖÖ 
SqlConnection
ÖÖ  

connection
ÖÖ! +
=
ÖÖ, -
new
ÖÖ. 1
SqlConnection
ÖÖ2 ?
(
ÖÖ? @
connectionString
ÖÖ@ P
)
ÖÖP Q
)
ÖÖQ R
{
ÜÜ 

connection
áá 
.
áá 
Open
áá 
(
áá  
)
áá  !
;
áá! "
using
àà 
(
àà 

SqlCommand
àà !
command
àà" )
=
àà* +
new
àà, /

SqlCommand
àà0 :
(
àà: ;
)
àà; <
)
àà< =
{
ââ 
PrepareCommand
ää "
(
ää" #
command
ää# *
,
ää* +

connection
ää, 6
,
ää6 7
(
ää8 9
SqlTransaction
ää9 G
)
ääG H
null
ääH L
,
ääL M
commandType
ääN Y
,
ääY Z
commandText
ää[ f
,
ääf g
commandParameters
ääh y
)
ääy z
;
ääz {
using
ãã 
(
ãã 
SqlDataAdapter
ãã )
adpater
ãã* 1
=
ãã2 3
new
ãã4 7
SqlDataAdapter
ãã8 F
(
ããF G
command
ããG N
)
ããN O
)
ããO P
{
åå 
DataSet
çç 
dataSet
çç  '
=
çç( )
new
çç* -
DataSet
çç. 5
(
çç5 6
)
çç6 7
;
çç7 8
adpater
éé 
.
éé  
Fill
éé  $
(
éé$ %
dataSet
éé% ,
)
éé, -
;
éé- .
return
èè 
dataSet
èè &
;
èè& '
}
êê 
}
ëë 
}
íí 
}
ìì 	
}
îî 
}ïï ËÌ
rD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SQLParameterHelper.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

class 
SqlParameterHelper #
{ 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
SqlParameterHelperG Y
)Y Z
)Z [
;[ \
private 
static 
bool 
debugLog $
=% &
log' *
.* +
IsDebugEnabled+ 9
;9 :
private 
SqlParameter 
[ 
] 
arParams '
;' (
private   
int   
index   
=   
$num   
;   
private!! 
int!! 
paramCnt!! 
;!! 
private"" 
string"" 
commandText"" "
;""" #
private## 
bool## 
parametersDefined## &
;##& '
private$$ 
string$$ 
connectionString$$ '
;$$' (
private%% 
CommandType%% 
cmdType%% #
;%%# $
public)) 
SqlParameterHelper)) !
())! "
string))" (
connectionString))) 9
,))9 :
string)); A
commandText))B M
,))M N
CommandType))O Z
cmdType))[ b
,))b c
int))d g
paramCnt))h p
)))p q
{** 	

Initialize++ 
(++ 
connectionString++ '
,++' (
commandText++) 4
,++4 5
cmdType++6 =
,++= >
paramCnt++? G
)++G H
;++H I
},, 	
public.. 
SqlParameterHelper.. !
(..! "
string.." (
connectionString..) 9
,..9 :
string..; A
commandText..B M
,..M N
int..O R
paramCnt..S [
)..[ \
{// 	

Initialize00 
(00 
connectionString00 '
,00' (
commandText00) 4
,004 5
CommandType006 A
.00A B
StoredProcedure00B Q
,00Q R
paramCnt00S [
)00[ \
;00\ ]
}11 	
private55 
void55 $
BeginDefineSqlParameters55 -
(55- .
)55. /
{66 	
index77 
=77 
$num77 
;77 
InitializeArray88 
(88 
)88 
;88 
}99 	
private;; 
void;; 
InitializeArray;; $
(;;$ %
);;% &
{<< 	
if== 
(== 
(>>  
ConfigurationManager>> %
.>>% &
AppSettings>>& 1
[>>1 2
$str>>2 H
]>>H I
!=>>J L
null>>M Q
)>>Q R
&&?? 
(?? 
string?? 
.?? 
Equals??  
(??  ! 
ConfigurationManager??! 5
.??5 6
AppSettings??6 A
[??A B
$str??B X
]??X Y
,??Y Z
$str??[ a
,??a b
StringComparison??c s
.??s t'
InvariantCultureIgnoreCase	??t é
)
??é è
)
??è ê
&&@@ 
(@@ 
cmdType@@ 
==@@ 
CommandType@@ *
.@@* +
StoredProcedure@@+ :
)@@: ;
)AA 
{BB 
arParamsCC 
=CC 
GetParametersCC (
(CC( )
connectionStringCC) 9
,CC9 :
commandTextCC; F
)CCF G
;CCG H
DebugDD 
.DD 
AssertDD 
(DD 
arParamsDD %
.DD% &
LengthDD& ,
==DD- /
paramCntDD0 8
,DD8 9
$strDD: h
)DDh i
;DDi j
parametersDefinedEE !
=EE" #
trueEE$ (
;EE( )
}FF 
elseGG 
{HH 
arParamsII 
=II 
newII 
SqlParameterII +
[II+ ,
paramCntII, 4
]II4 5
;II5 6
parametersDefinedJJ !
=JJ" #
falseJJ$ )
;JJ) *
}KK 
}LL 	
privateNN 
voidNN 

InitializeNN 
(NN  
stringNN  &
pConnectionInfoNN' 6
,NN6 7
stringNN8 >
pCommandTextNN? K
,NNK L
CommandTypeNNM X
pCmdTypeNNY a
,NNa b
intNNc f
	pParamCntNNg p
)NNp q
{OO 	
ifPP 
(PP 
pConnectionInfoPP 
==PP  "
nullPP# '
||PP( *
pConnectionInfoPP+ :
.PP: ;
LengthPP; A
==PPB D
$numPPE F
)PPF G
throwPPH M
newPPN Q!
ArgumentNullExceptionPPR g
(PPg h
$strPPh z
)PPz {
;PP{ |
ifQQ 
(QQ 
pCommandTextQQ 
==QQ 
nullQQ  $
||QQ% '
pCommandTextQQ( 4
.QQ4 5
LengthQQ5 ;
==QQ< >
$numQQ? @
)QQ@ A
throwQQB G
newQQH K!
ArgumentNullExceptionQQL a
(QQa b
$strQQb o
)QQo p
;QQp q
connectionStringRR 
=RR 
pConnectionInfoRR .
;RR. /
paramCntSS 
=SS 
	pParamCntSS  
;SS  !
commandTextTT 
=TT 
pCommandTextTT &
;TT& '
cmdTypeUU 
=UU 
pCmdTypeUU 
;UU $
BeginDefineSqlParametersWW $
(WW$ %
)WW% &
;WW& '
}XX 	
publicZZ 
voidZZ 
DefineSqlParameterZZ &
(ZZ& '
StringZZ' -
	paramNameZZ. 7
,ZZ7 8
	SqlDbTypeZZ9 B
typeZZC G
,ZZG H
ParameterDirectionZZI [
dirZZ\ _
,ZZ_ `
objectZZa g
valueZZh m
)ZZm n
{[[ 	
DefineSqlParameter\\ 
(\\ 
	paramName\\ (
,\\( )
type\\* .
,\\. /
string\\0 6
.\\6 7
Empty\\7 <
,\\< =
$num\\> ?
,\\? @
$num\\A B
,\\B C
dir\\D G
,\\G H
value\\I N
,\\N O
false\\P U
,\\U V
false\\W \
)\\\ ]
;\\] ^
}]] 	
public__ 
void__ 
DefineSqlParameter__ &
(__& '
String__' -
	paramName__. 7
,__7 8
	SqlDbType__9 B
type__C G
,__G H
int__I L
size__M Q
,__Q R
ParameterDirection__S e
dir__f i
,__i j
object__k q
value__r w
)__w x
{`` 	
DefineSqlParameteraa 
(aa 
	paramNameaa (
,aa( )
typeaa* .
,aa. /
stringaa0 6
.aa6 7
Emptyaa7 <
,aa< =
sizeaa> B
,aaB C
$numaaD E
,aaE F
diraaG J
,aaJ K
valueaaL Q
,aaQ R
trueaaS W
,aaW X
falseaaY ^
)aa^ _
;aa_ `
}bb 	
publicdd 
voiddd 
DefineSqlParameterdd &
(dd& '
Stringdd' -
	paramNamedd. 7
,dd7 8
	SqlDbTypedd9 B
typeddC G
,ddG H
intddI L
sizeddM Q
,ddQ R
byteddS W
	precisionddX a
,dda b
ParameterDirectionddc u
dirddv y
,ddy z
object	dd{ Å
value
ddÇ á
)
ddá à
{ee 	
DefineSqlParameterff 
(ff 
	paramNameff (
,ff( )
typeff* .
,ff. /
stringff0 6
.ff6 7
Emptyff7 <
,ff< =
sizeff> B
,ffB C
	precisionffD M
,ffM N
dirffO R
,ffR S
valueffT Y
,ffY Z
trueff[ _
,ff_ `
trueffa e
)ffe f
;fff g
}gg 	
publicii 
voidii 
DefineSqlParameterii &
(ii& '
Stringii' -
	paramNameii. 7
,ii7 8
	SqlDbTypeii9 B
typeiiC G
,iiG H
StringiiI O
typeNameiiP X
,iiX Y
ParameterDirectioniiZ l
diriim p
,iip q
objectiir x
valueiiy ~
)ii~ 
{jj 	
DefineSqlParameterkk 
(kk 
	paramNamekk (
,kk( )
typekk* .
,kk. /
typeNamekk0 8
,kk8 9
$numkk: ;
,kk; <
$numkk= >
,kk> ?
dirkk@ C
,kkC D
valuekkE J
,kkJ K
falsekkL Q
,kkQ R
falsekkS X
)kkX Y
;kkY Z
}ll 	
privatenn 
voidnn 
DefineSqlParameternn '
(nn' (
Stringoo 
	paramNameoo 
,oo 
	SqlDbTypepp 
typepp 
,pp 
Stringqq 
typeNameqq 
,qq 
intrr 
sizerr 
,rr 
bytess 
	precisionss 
,ss 
ParameterDirectiontt 
dirtt "
,tt" #
objectuu 
valueuu 
,uu 
boolvv 
sizeProvidedvv 
,vv 
boolww 
precisionProvidedww "
)ww" #
{xx 	
Debugyy 
.yy 
Assertyy 
(yy 
indexyy 
<yy  
arParamsyy! )
.yy) *
Lengthyy* 0
,yy0 1
$stryy2 N
)yyN O
;yyO P
Debugzz 
.zz 
Assertzz 
(zz 
indexzz 
<zz  
paramCntzz! )
,zz) *
$strzz+ `
)zz` a
;zza b
if|| 
(|| 
!|| 
parametersDefined|| "
)||" #
{}} 
if~~ 
(~~ 
sizeProvided~~  
)~~  !
arParams 
[ 
index "
]" #
=$ %
new& )
SqlParameter* 6
(6 7
	paramName7 @
,@ A
typeB F
,F G
sizeH L
)L M
;M N
else
ÄÄ 
arParams
ÅÅ 
[
ÅÅ 
index
ÅÅ "
]
ÅÅ" #
=
ÅÅ$ %
new
ÅÅ& )
SqlParameter
ÅÅ* 6
(
ÅÅ6 7
	paramName
ÅÅ7 @
,
ÅÅ@ A
type
ÅÅB F
)
ÅÅF G
;
ÅÅG H
if
ÉÉ 
(
ÉÉ 
precisionProvided
ÉÉ %
)
ÉÉ% &
{
ÉÉ' (
arParams
ÉÉ) 1
[
ÉÉ1 2
index
ÉÉ2 7
]
ÉÉ7 8
.
ÉÉ8 9
	Precision
ÉÉ9 B
=
ÉÉC D
	precision
ÉÉE N
;
ÉÉN O
}
ÉÉP Q
arParams
ÖÖ 
[
ÖÖ 
index
ÖÖ 
]
ÖÖ 
.
ÖÖ  
	Direction
ÖÖ  )
=
ÖÖ* +
dir
ÖÖ, /
;
ÖÖ/ 0
}
ÜÜ 
Debug
áá 
.
áá 
Assert
áá 
(
áá 
arParams
áá !
[
áá! "
index
áá" '
]
áá' (
.
áá( )
	Direction
áá) 2
==
áá3 5
dir
áá6 9
,
áá9 :
$str
áá; r
)
áár s
;
áás t
Debug
àà 
.
àà 
Assert
àà 
(
àà 
string
àà 
.
àà  
Equals
àà  &
(
àà& '
arParams
àà' /
[
àà/ 0
index
àà0 5
]
àà5 6
.
àà6 7
ParameterName
àà7 D
,
ààD E
	paramName
ààF O
,
ààO P
StringComparison
ààQ a
.
ààa b(
InvariantCultureIgnoreCase
ààb |
)
àà| }
,
àà} ~
$stràà ±
)àà± ≤
;àà≤ ≥
Debug
ââ 
.
ââ 
Assert
ââ 
(
ââ 
(
ää 
(
ää 
type
ää 
!=
ää 
	SqlDbType
ää #
.
ää# $
NText
ää$ )
)
ää) *
&&
ää+ -
(
ää. /
arParams
ää/ 7
[
ää7 8
index
ää8 =
]
ää= >
.
ää> ?
	SqlDbType
ää? H
==
ääI K
type
ääL P
)
ääP Q
)
ääQ R
||
ãã 
(
åå 
(
åå 
type
åå 
==
åå 
	SqlDbType
åå #
.
åå# $
NText
åå$ )
)
åå) *
&&
åå+ -
(
åå. /
arParams
åå/ 7
[
åå7 8
index
åå8 =
]
åå= >
.
åå> ?
	SqlDbType
åå? H
==
ååI K
	SqlDbType
ååL U
.
ååU V
NVarChar
ååV ^
)
åå^ _
)
åå_ `
||
çç 
(
éé 
(
éé 
type
éé 
==
éé 
	SqlDbType
éé #
.
éé# $
Image
éé$ )
)
éé) *
&&
éé+ -
(
éé. /
arParams
éé/ 7
[
éé7 8
index
éé8 =
]
éé= >
.
éé> ?
	SqlDbType
éé? H
==
ééI K
	SqlDbType
ééL U
.
ééU V
	VarBinary
ééV _
)
éé_ `
)
éé` a
,
èè 
$str
èè D
)
êê 
;
êê 
if
ìì 
(
ìì 
typeName
ìì 
.
ìì 
Length
ìì 
>
ìì  !
$num
ìì" #
)
ìì# $
arParams
îî 
[
îî 
index
îî 
]
îî 
.
îî  
TypeName
îî  (
=
îî) *"
ConfigurationManager
îî+ ?
.
îî? @
AppSettings
îî@ K
[
îîK L
$str
îîL ^
]
îî^ _
+
îî` a
typeName
îîb j
;
îîj k
arParams
óó 
[
óó 
index
óó 
]
óó 
.
óó 
Value
óó !
=
óó" #
value
óó$ )
;
óó) *
index
òò 
++
òò 
;
òò 
}
ôô 	
public
õõ 
IDataReader
õõ 
ExecuteReader
õõ (
(
õõ( )
)
õõ) *
{
úú 	
Debug
ùù 
.
ùù 
Assert
ùù 
(
ùù 
(
ùù 
arParams
ùù "
.
ùù" #
Length
ùù# )
==
ùù* ,
index
ùù- 2
)
ùù2 3
&&
ùù4 6
(
ùù7 8
paramCnt
ùù8 @
==
ùùA C
index
ùùD I
)
ùùI J
,
ùùJ K
$str
ùùL m
)
ùùm n
;
ùùn o
if
ûû 
(
ûû 
debugLog
ûû 
)
ûû 
{
ûû 
log
ûû 
.
ûû  
Debug
ûû  %
(
ûû% &
$str
ûû& 6
+
ûû7 8
commandText
ûû9 D
)
ûûD E
;
ûûE F
}
ûûG H
return
üü 
	SqlHelper
üü 
.
üü 
ExecuteReader
üü *
(
üü* +
connectionString
üü+ ;
,
üü; <
cmdType
üü= D
,
üüD E
commandText
üüF Q
,
üüQ R
arParams
üüS [
)
üü[ \
;
üü\ ]
}
†† 	
public
¢¢ 
IDataReader
¢¢ 
ExecuteReader
¢¢ (
(
¢¢( )
int
¢¢) ,
commandTimeout
¢¢- ;
)
¢¢; <
{
££ 	
Debug
§§ 
.
§§ 
Assert
§§ 
(
§§ 
(
§§ 
arParams
§§ "
.
§§" #
Length
§§# )
==
§§* ,
index
§§- 2
)
§§2 3
&&
§§4 6
(
§§7 8
paramCnt
§§8 @
==
§§A C
index
§§D I
)
§§I J
,
§§J K
$str
§§L m
)
§§m n
;
§§n o
if
•• 
(
•• 
debugLog
•• 
)
•• 
{
•• 
log
•• 
.
••  
Debug
••  %
(
••% &
$str
••& 6
+
••7 8
commandText
••9 D
)
••D E
;
••E F
}
••G H
return
¶¶ 
	SqlHelper
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ *
(
¶¶* +
connectionString
¶¶+ ;
,
¶¶; <
cmdType
¶¶= D
,
¶¶D E
commandText
¶¶F Q
,
¶¶Q R
commandTimeout
¶¶S a
,
¶¶a b
arParams
¶¶c k
)
¶¶k l
;
¶¶l m
}
ßß 	
public
©© 
int
©© 
ExecuteNonQuery
©© "
(
©©" #
)
©©# $
{
™™ 	
Debug
´´ 
.
´´ 
Assert
´´ 
(
´´ 
(
´´ 
arParams
´´ "
.
´´" #
Length
´´# )
==
´´* ,
index
´´- 2
)
´´2 3
&&
´´4 6
(
´´7 8
paramCnt
´´8 @
==
´´A C
index
´´D I
)
´´I J
,
´´J K
$str
´´L m
)
´´m n
;
´´n o
if
¨¨ 
(
¨¨ 
debugLog
¨¨ 
)
¨¨ 
{
¨¨ 
log
¨¨ 
.
¨¨  
Debug
¨¨  %
(
¨¨% &
$str
¨¨& 8
+
¨¨9 :
commandText
¨¨; F
)
¨¨F G
;
¨¨G H
}
¨¨I J
return
≠≠ 
	SqlHelper
≠≠ 
.
≠≠ 
ExecuteNonQuery
≠≠ ,
(
≠≠, -
connectionString
≠≠- =
,
≠≠= >
cmdType
≠≠? F
,
≠≠F G
commandText
≠≠H S
,
≠≠S T
arParams
≠≠U ]
)
≠≠] ^
;
≠≠^ _
}
ÆÆ 	
public
∞∞ 
int
∞∞ 
ExecuteNonQuery
∞∞ "
(
∞∞" #
int
∞∞# &
commandTimeout
∞∞' 5
)
∞∞5 6
{
±± 	
Debug
≤≤ 
.
≤≤ 
Assert
≤≤ 
(
≤≤ 
(
≤≤ 
arParams
≤≤ "
.
≤≤" #
Length
≤≤# )
==
≤≤* ,
index
≤≤- 2
)
≤≤2 3
&&
≤≤4 6
(
≤≤7 8
paramCnt
≤≤8 @
==
≤≤A C
index
≤≤D I
)
≤≤I J
,
≤≤J K
$str
≤≤L m
)
≤≤m n
;
≤≤n o
if
≥≥ 
(
≥≥ 
debugLog
≥≥ 
)
≥≥ 
{
≥≥ 
log
≥≥ 
.
≥≥  
Debug
≥≥  %
(
≥≥% &
$str
≥≥& 8
+
≥≥9 :
commandText
≥≥; F
)
≥≥F G
;
≥≥G H
}
≥≥I J
return
¥¥ 
	SqlHelper
¥¥ 
.
¥¥ 
ExecuteNonQuery
¥¥ ,
(
¥¥, -
connectionString
¥¥- =
,
¥¥= >
cmdType
¥¥? F
,
¥¥F G
commandText
¥¥H S
,
¥¥S T
commandTimeout
¥¥U c
,
¥¥c d
arParams
¥¥e m
)
¥¥m n
;
¥¥n o
}
µµ 	
public
ΩΩ 
object
ΩΩ 
ExecuteScalar
ΩΩ #
(
ΩΩ# $
)
ΩΩ$ %
{
ææ 	
Debug
øø 
.
øø 
Assert
øø 
(
øø 
(
øø 
arParams
øø "
.
øø" #
Length
øø# )
==
øø* ,
index
øø- 2
)
øø2 3
&&
øø4 6
(
øø7 8
paramCnt
øø8 @
==
øøA C
index
øøD I
)
øøI J
,
øøJ K
$str
øøL m
)
øøm n
;
øøn o
if
¿¿ 
(
¿¿ 
debugLog
¿¿ 
)
¿¿ 
{
¿¿ 
log
¿¿ 
.
¿¿  
Debug
¿¿  %
(
¿¿% &
$str
¿¿& 6
+
¿¿7 8
commandText
¿¿9 D
)
¿¿D E
;
¿¿E F
}
¿¿G H
return
¡¡ 
	SqlHelper
¡¡ 
.
¡¡ 
ExecuteScalar
¡¡ *
(
¡¡* +
connectionString
¡¡+ ;
,
¡¡; <
cmdType
¡¡= D
,
¡¡D E
commandText
¡¡F Q
,
¡¡Q R
arParams
¡¡S [
)
¡¡[ \
;
¡¡\ ]
}
¬¬ 	
public
ƒƒ 
object
ƒƒ 
ExecuteScalar
ƒƒ #
(
ƒƒ# $
int
ƒƒ$ '
commandTimeout
ƒƒ( 6
)
ƒƒ6 7
{
≈≈ 	
Debug
∆∆ 
.
∆∆ 
Assert
∆∆ 
(
∆∆ 
(
∆∆ 
arParams
∆∆ "
.
∆∆" #
Length
∆∆# )
==
∆∆* ,
index
∆∆- 2
)
∆∆2 3
&&
∆∆4 6
(
∆∆7 8
paramCnt
∆∆8 @
==
∆∆A C
index
∆∆D I
)
∆∆I J
,
∆∆J K
$str
∆∆L m
)
∆∆m n
;
∆∆n o
if
«« 
(
«« 
debugLog
«« 
)
«« 
{
«« 
log
«« 
.
««  
Debug
««  %
(
««% &
$str
««& 6
+
««7 8
commandText
««9 D
)
««D E
;
««E F
}
««G H
return
»» 
	SqlHelper
»» 
.
»» 
ExecuteScalar
»» *
(
»»* +
connectionString
»»+ ;
,
»»; <
cmdType
»»= D
,
»»D E
commandText
»»F Q
,
»»Q R
commandTimeout
»»S a
,
»»a b
arParams
»»c k
)
»»k l
;
»»l m
}
…… 	
public
—— 
DataSet
—— 
ExecuteDataset
—— %
(
——% &
)
——& '
{
““ 	
Debug
”” 
.
”” 
Assert
”” 
(
”” 
(
”” 
arParams
”” "
.
””" #
Length
””# )
==
””* ,
index
””- 2
)
””2 3
&&
””4 6
(
””7 8
paramCnt
””8 @
==
””A C
index
””D I
)
””I J
,
””J K
$str
””L m
)
””m n
;
””n o
if
‘‘ 
(
‘‘ 
debugLog
‘‘ 
)
‘‘ 
{
‘‘ 
log
‘‘ 
.
‘‘  
Debug
‘‘  %
(
‘‘% &
$str
‘‘& 7
+
‘‘8 9
commandText
‘‘: E
)
‘‘E F
;
‘‘F G
}
‘‘H I
return
’’ 
	SqlHelper
’’ 
.
’’ 
ExecuteDataset
’’ +
(
’’+ ,
connectionString
’’, <
,
’’< =
cmdType
’’> E
,
’’E F
commandText
’’G R
,
’’R S
arParams
’’T \
)
’’\ ]
;
’’] ^
}
÷÷ 	
public
ÿÿ 
SqlParameter
ÿÿ 
[
ÿÿ 
]
ÿÿ 

Parameters
ÿÿ (
{
ŸŸ 	
get
⁄⁄ 
{
⁄⁄ 
return
⁄⁄ 
arParams
⁄⁄ !
;
⁄⁄! "
}
⁄⁄# $
}
€€ 	
public
›› 
string
›› 
CommandText
›› !
{
ﬁﬁ 	
get
ﬂﬂ 
{
ﬂﬂ 
return
ﬂﬂ 
commandText
ﬂﬂ $
;
ﬂﬂ$ %
}
ﬂﬂ& '
}
‡‡ 	
public
‚‚ 
string
‚‚ 
ConnectionString
‚‚ &
{
„„ 	
get
‰‰ 
{
‰‰ 
return
‰‰ 
connectionString
‰‰ )
;
‰‰) *
}
‰‰+ ,
}
ÂÂ 	
public
˙˙ 
SqlParameter
˙˙ 
[
˙˙ 
]
˙˙ 
GetParameters
˙˙ +
(
˙˙+ ,
string
˙˙, 2
connectionString
˙˙3 C
,
˙˙C D
string
˙˙E K
procName
˙˙L T
)
˙˙T U
{
˚˚ 	
if
¸¸ 
(
¸¸ 
string
¸¸ 
.
¸¸ 
IsNullOrEmpty
¸¸ $
(
¸¸$ %
connectionString
¸¸% 5
)
¸¸5 6
)
¸¸6 7
throw
¸¸8 =
new
¸¸> A#
ArgumentNullException
¸¸B W
(
¸¸W X
$str
¸¸X j
)
¸¸j k
;
¸¸k l
if
˝˝ 
(
˝˝ 
string
˝˝ 
.
˝˝ 
IsNullOrEmpty
˝˝ $
(
˝˝$ %
procName
˝˝% -
)
˝˝- .
)
˝˝. /
throw
˝˝0 5
new
˝˝6 9#
ArgumentNullException
˝˝: O
(
˝˝O P
$str
˝˝P `
)
˝˝` a
;
˝˝a b
if
ÄÄ 
(
ÄÄ 
AlreadyCached
ÄÄ 
(
ÄÄ 
connectionString
ÄÄ .
,
ÄÄ. /
procName
ÄÄ0 8
)
ÄÄ8 9
)
ÄÄ9 :
{
ÅÅ 
return
ÇÇ $
GetParametersFromCache
ÇÇ -
(
ÇÇ- .
connectionString
ÇÇ. >
,
ÇÇ> ?
procName
ÇÇ@ H
)
ÇÇH I
;
ÇÇI J
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 
SqlParameter
ÜÜ 
[
ÜÜ 
]
ÜÜ 
copyOfParameters
ÜÜ /
=
ÜÜ0 1 
DiscoverParameters
ÜÜ2 D
(
ÜÜD E
connectionString
ÜÜE U
,
ÜÜU V
procName
ÜÜW _
)
ÜÜ_ `
;
ÜÜ` a
SqlParameterCache
ââ !
.
ââ! "$
AddParameterSetToCache
ââ" 8
(
ââ8 9
connectionString
ââ9 I
,
ââI J
procName
ââK S
,
ââS T
copyOfParameters
ââU e
)
ââe f
;
ââf g
return
ãã $
GetParametersFromCache
ãã -
(
ãã- .
connectionString
ãã. >
,
ãã> ?
procName
ãã@ H
)
ããH I
;
ããI J
}
åå 
}
çç 	
private
èè 
static
èè 
SqlParameter
èè #
[
èè# $
]
èè$ %!
CreateParameterCopy
èè& 9
(
èè9 :
	DbCommand
èè: C
command
èèD K
)
èèK L
{
êê 	&
IDataParameterCollection
ëë $

parameters
ëë% /
=
ëë0 1
command
ëë2 9
.
ëë9 :

Parameters
ëë: D
;
ëëD E
SqlParameter
íí 
[
íí 
]
íí 
parameterArray
íí )
=
íí* +
new
íí, /
SqlParameter
íí0 <
[
íí< =

parameters
íí= G
.
ííG H
Count
ííH M
]
ííM N
;
ííN O

parameters
ìì 
.
ìì 
CopyTo
ìì 
(
ìì 
parameterArray
ìì ,
,
ìì, -
$num
ìì. /
)
ìì/ 0
;
ìì0 1
return
ïï 
SqlParameterCache
ïï $
.
ïï$ %
CloneParameters
ïï% 4
(
ïï4 5
parameterArray
ïï5 C
)
ïïC D
;
ïïD E
}
ññ 	
	protected
òò 
SqlParameter
òò 
[
òò 
]
òò  $
GetParametersFromCache
òò! 7
(
òò7 8
string
òò8 >
connectionString
òò? O
,
òòO P
string
òòQ W
procName
òòX `
)
òò` a
{
ôô 	
return
öö 
SqlParameterCache
öö $
.
öö$ %#
GetCachedParameterSet
öö% :
(
öö: ;
connectionString
öö; K
,
ööK L
procName
ööM U
)
ööU V
;
ööV W
}
úú 	
private
ûû 
bool
ûû 
AlreadyCached
ûû "
(
ûû" #
string
ûû# )
connectionString
ûû* :
,
ûû: ;
string
ûû< B
procName
ûûC K
)
ûûK L
{
üü 	
return
†† 
SqlParameterCache
†† $
.
††$ %"
IsParameterSetCached
††% 9
(
††9 :
connectionString
††: J
,
††J K
procName
††L T
)
††T U
;
††U V
}
°° 	
public
££ 
SqlParameter
££ 
[
££ 
]
££  
DiscoverParameters
££ 0
(
££0 1
string
££1 7
connectionString
££8 H
,
££H I
string
££J P
procName
££Q Y
)
££Y Z
{
§§ 	
using
•• 
(
•• 
SqlConnection
••  

connection
••! +
=
••, -
new
••. 1
SqlConnection
••2 ?
(
••? @
connectionString
••@ P
)
••P Q
)
••Q R
{
¶¶ 
using
ßß 
(
ßß 

SqlCommand
ßß !
discoveryCommand
ßß" 2
=
ßß3 4
new
ßß5 8

SqlCommand
ßß9 C
(
ßßC D
)
ßßD E
)
ßßE F
{
®® 
discoveryCommand
©© $
.
©©$ %
CommandType
©©% 0
=
©©1 2
CommandType
©©3 >
.
©©> ?
StoredProcedure
©©? N
;
©©N O
discoveryCommand
™™ $
.
™™$ %
CommandText
™™% 0
=
™™1 2
procName
™™3 ;
;
™™; <
discoveryCommand
´´ $
.
´´$ %

Connection
´´% /
=
´´0 1

connection
´´2 <
;
´´< =

connection
¨¨ 
.
¨¨ 
Open
¨¨ #
(
¨¨# $
)
¨¨$ %
;
¨¨% &
SqlCommandBuilder
≠≠ %
.
≠≠% &
DeriveParameters
≠≠& 6
(
≠≠6 7
discoveryCommand
≠≠7 G
)
≠≠G H
;
≠≠H I
discoveryCommand
±± $
.
±±$ %

Parameters
±±% /
.
±±/ 0
RemoveAt
±±0 8
(
±±8 9
$num
±±9 :
)
±±: ;
;
±±; <
SqlParameter
≥≥  
[
≥≥  !
]
≥≥! "
result
≥≥# )
=
≥≥* +
new
≥≥, /
SqlParameter
≥≥0 <
[
≥≥< =
discoveryCommand
≥≥= M
.
≥≥M N

Parameters
≥≥N X
.
≥≥X Y
Count
≥≥Y ^
]
≥≥^ _
;
≥≥_ `
int
¥¥ 
i
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥ 
foreach
µµ 
(
µµ 
IDataParameter
µµ +
	parameter
µµ, 5
in
µµ6 8
discoveryCommand
µµ9 I
.
µµI J

Parameters
µµJ T
)
µµT U
{
∂∂ 
SqlParameter
∑∑ $
cloneParameter
∑∑% 3
=
∑∑4 5
(
∑∑6 7
SqlParameter
∑∑7 C
)
∑∑C D
(
∑∑D E
(
∑∑E F

ICloneable
∑∑F P
)
∑∑P Q
	parameter
∑∑Q Z
)
∑∑Z [
.
∑∑[ \
Clone
∑∑\ a
(
∑∑a b
)
∑∑b c
;
∑∑c d
result
∏∏ 
[
∏∏ 
i
∏∏  
]
∏∏  !
=
∏∏" #
cloneParameter
∏∏$ 2
;
∏∏2 3
i
ππ 
+=
ππ 
$num
ππ 
;
ππ 
}
∫∫ 
return
ºº 
result
ºº !
;
ºº! "
}
ΩΩ 
}
ææ 
}
øø 	
}
√√ 
}ƒƒ 