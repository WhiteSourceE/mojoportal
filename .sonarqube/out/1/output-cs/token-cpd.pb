°
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\AssemblyInfo.cs
[

 
assembly

 	
:

	 

CLSCompliant


 
(

 
true

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str E
)E F
]F G
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str $
)$ %
]% &
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str '
)' (
]( )
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyVersion 
( 
$str "
)" #
]# $
[:: 
assembly:: 	
:::	 

AssemblyDelaySign:: 
(:: 
false:: "
)::" #
]::# $
[;; 
assembly;; 	
:;;	 

AssemblyKeyFile;; 
(;; 
$str;; 
);; 
];; 
[<< 
assembly<< 	
:<<	 

AssemblyKeyName<< 
(<< 
$str<< 
)<< 
]<< à 
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\ConnectionString.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
ConnectionString %
{ 
private 	
const
 
string 
connectionString '
=( )
$str* A
;A B
private		 	
const		
 
string		 
writeString		 "
=		# $
$str		% A
;		A B
public 
static	 
string #
GetReadConnectionString .
(. /
)/ 0
{ 
if 
( &
UseConnectionStringSection !
(! "
)" #
)# $
{ 
return 
>
2GetReadConnectionStringFromConnectionStringSection =
(= >
)> ?
;? @
} 
return 	 
ConfigurationManager
 
. 
AppSettings *
[* +
connectionString+ ;
]; <
;< =
} 
public 
static	 
string $
GetWriteConnectionString /
(/ 0
)0 1
{ 
if 
( &
UseConnectionStringSection !
(! "
)" #
)# $
{ 
return 
?
3GetWriteConnectionStringFromConnectionStringSection >
(> ?
)? @
;@ A
} 
if!! 
(!!  
ConfigurationManager!! 
.!! 
AppSettings!! '
[!!' (
writeString!!( 3
]!!3 4
!=!!5 7
null!!8 <
)!!< =
{"" 
return## 
 
ConfigurationManager## 
.##  
AppSettings##  +
[##+ ,
writeString##, 7
]##7 8
;##8 9
}$$ 
return&& 	 
ConfigurationManager&&
 
.&& 
AppSettings&& *
[&&* +
connectionString&&+ ;
]&&; <
;&&< =
}'' 
private** 	
static**
 
string** ?
3GetWriteConnectionStringFromConnectionStringSection** K
(**K L
)**L M
{++ 
if,, 
(,,  
ConfigurationManager,, 
.,, 
ConnectionStrings,, -
[,,- .
writeString,,. 9
],,9 :
!=,,; =
null,,> B
),,B C
{-- 
return.. 
 
ConfigurationManager.. 
...  
ConnectionStrings..  1
[..1 2
writeString..2 =
]..= >
...> ?
ConnectionString..? O
;..O P
}// 
return11 	 
ConfigurationManager11
 
.11 
ConnectionStrings11 0
[110 1
connectionString111 A
]11A B
.11B C
ConnectionString11C S
;11S T
}22 
private55 	
static55
 
string55 >
2GetReadConnectionStringFromConnectionStringSection55 J
(55J K
)55K L
{66 
return77 	 
ConfigurationManager77
 
.77 
ConnectionStrings77 0
[770 1
connectionString771 A
]77A B
.77B C
ConnectionString77C S
;77S T
}88 
private;; 	
static;;
 
bool;; &
UseConnectionStringSection;; 0
(;;0 1
);;1 2
{<< 
var== #
connectionStringSection== 
===   
ConfigurationManager==! 5
.==5 6
AppSettings==6 A
[==A B
$str==B ^
]==^ _
;==_ `
if?? 
(?? #
connectionStringSection?? 
!=?? !
null??" &
&&??' )#
connectionStringSection??* A
==??B D
$str??E K
)??K L
{@@ 
returnAA 

trueAA 
;AA 
}BB 
returnDD 	
falseDD
 
;DD 
}EE 
}FF 
}GG Ú<
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\CSVSplitter.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
class 
CSV_splitter 
: 
IEnumerable (
<( )
SqlDataRecord) 6
>6 7
,7 8
IEnumerator9 D
<D E
SqlDataRecordE R
>R S
{ 
string 
input	 
; 
char 
delim 
; 
System 
. 	
Data	 
. 
	SqlDbType 
type 
; 
int 
start_ix 
; 
int 
end_ix 
; 
SqlDataRecord 
outrec 
; 
public 
CSV_splitter	 
( 
string 
str  
,  !
char" &
	delimiter' 0
,0 1
System2 8
.8 9
Data9 =
.= >
	SqlDbType> G
	sqlDbTypeH Q
)Q R
{ 
this 
. 
input 
= 
str 
; 
this 
. 
delim 
= 
	delimiter 
; 
this 
. 
type 
= 
	sqlDbType 
; 
this 
. 
outrec 
= 
new 
SqlDataRecord "
(" #
new 

SqlMetaData 
( 
$str 
, 
this #
.# $
type$ (
)( )
)) *
;* +
this"" 
."" 
Reset"" 
("" 
)"" 
;"" 
}## 
public%% 
CSV_splitter%%	 
(%% 
string%% 
str%%  
)%%  !
=>%%" $
new%%% (
CSV_splitter%%) 5
(%%5 6
str%%6 9
,%%9 :
$char%%; >
,%%> ?
System%%@ F
.%%F G
Data%%G K
.%%K L
	SqlDbType%%L U
.%%U V
BigInt%%V \
)%%\ ]
;%%] ^
System** 
.** 	
Collections**	 
.** 
IEnumerator**  
System**! '
.**' (
Collections**( 3
.**3 4
IEnumerable**4 ?
.**? @
GetEnumerator**@ M
(**M N
)**N O
{++ 
return,, 	
this,,
 
;,, 
}-- 
public// 
System//	 
.// 
Collections// 
.// 
Generic// #
.//# $
IEnumerator//$ /
</// 0
SqlDataRecord//0 =
>//= >
GetEnumerator00 
(00 
)00 
{11 
return22 	
this22
 
;22 
}33 
public88 
void88	 
Reset88 
(88 
)88 
{99 
this:: 
.:: 
start_ix:: 
=:: 
-:: 
$num:: 
;:: 
this;; 
.;; 
end_ix;; 
=;; 
-;; 
$num;; 
;;; 
}<< 
publicAA 
boolAA	 
MoveNextAA 
(AA 
)AA 
{BB 
thisCC 
.CC 
start_ixCC 
=CC 
thisCC 
.CC 
end_ixCC 
+CC  
$numCC! "
;CC" #
whileHH 
(HH	 

thisHH
 
.HH 
start_ixHH 
<HH 
thisHH 
.HH 
inputHH $
.HH$ %
LengthHH% +
&&HH, .
thisII 
.II 
inputII 
[II 
thisII 
.II 
start_ixII 
]II  
==II! #
thisII$ (
.II( )
delimII) .
)II. /
{JJ 
thisKK 
.KK 	
start_ixKK	 
++KK 
;KK 
}LL 
ifPP 
(PP 
thisPP 
.PP 
start_ixPP 
>=PP 
thisPP 
.PP 
inputPP "
.PP" #
LengthPP# )
)PP) *
{QQ 
returnRR 

falseRR 
;RR 
}SS 
thisWW 
.WW 
end_ixWW 
=WW 
thisWW 
.WW 
inputWW 
.WW 
IndexOfWW #
(WW# $
thisWW$ (
.WW( )
delimWW) .
,WW. /
thisWW0 4
.WW4 5
start_ixWW5 =
)WW= >
;WW> ?
ifXX 
(XX 
thisXX 
.XX 
end_ixXX 
==XX 
-XX 
$numXX 
)XX 
{YY 
thisZZ 
.ZZ 	
end_ixZZ	 
=ZZ 
thisZZ 
.ZZ 
inputZZ 
.ZZ 
LengthZZ #
;ZZ# $
}[[ 
return^^ 	
true^^
 
;^^ 
}__ 
publicdd 
SqlDataRecorddd	 
Currentdd 
{ee 
getff 
{gg 
stringhh 

strhh 
=hh 
thishh 
.hh 
inputhh 
.hh 
	Substringhh %
(hh% &
thishh& *
.hh* +
start_ixhh+ 3
,hh3 4
thisii 
.ii 
end_ixii 
-ii 
thisii  
.ii  !
start_ixii! )
)ii) *
;ii* +
switchjj 

(jj 
thisjj 
.jj 
typejj 
)jj 
{kk 
casell 	
Systemll
 
.ll 
Datall 
.ll 
	SqlDbTypell 
.ll  
BigIntll  &
:ll& '
thismm 

.mm
 
outrecmm 
.mm 
SetInt64mm 
(mm 
$nummm 
,mm 
Convertmm %
.mm% &
ToInt64mm& -
(mm- .
strmm. 1
)mm1 2
)mm2 3
;mm3 4
breaknn 
;nn 
caseoo 	
Systemoo
 
.oo 
Dataoo 
.oo 
	SqlDbTypeoo 
.oo  
UniqueIdentifieroo  0
:oo0 1
thispp 

.pp
 
outrecpp 
.pp 

SetSqlGuidpp 
(pp 
$numpp 
,pp 
Guidpp  $
.pp$ %
Parsepp% *
(pp* +
strpp+ .
)pp. /
)pp/ 0
;pp0 1
breakqq 
;qq 
}rr 
returntt 

thistt 
.tt 
outrectt 
;tt 
}uu 
}vv 
Objectyy 
Systemyy	 
.yy 
Collectionsyy 
.yy 
IEnumeratoryy '
.yy' (
Currentyy( /
{zz 
get{{ 
{|| 
return}} 

this}} 
.}} 
Current}} 
;}} 
}~~ 
} 
public
 
void
	 
Dispose
 
(
 
)
 
{
 
this
 
.
 
outrec
 
=
 
null
 
;
 
}
 
public
 
override
	 
string
 
ToString
 !
(
! "
)
" #
{
 
return
 	
$str

 
+
 
input
 "
;
" #
}
 
}
 
} Í^
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCategoryItem.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBCategoryItem &
{ 
public@@ 
static@@ 
int@@ 
Create@@  
(@@  !
GuidAA 
guidAA 
,AA 
GuidBB 
siteGuidBB 
,BB 
GuidCC 
featureGuidCC 
,CC 
GuidDD 

moduleGuidDD 
,DD 
GuidEE 
itemGuidEE 
,EE 
GuidFF 
categoryGuidFF 
,FF 
GuidGG 
	extraGuidGG 
)GG 
{HH 	
SqlParameterHelperII 
sphII "
=II# $
newII% (
SqlParameterHelperII) ;
(II; <
ConnectionStringII< L
.IIL M$
GetWriteConnectionStringIIM e
(IIe f
)IIf g
,IIg h
$str	IIi 
,
II 
$num
II 
)
II 
;
II 
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
UniqueIdentifierJJ6 F
,JJF G
ParameterDirectionJJH Z
.JJZ [
InputJJ[ `
,JJ` a
guidJJb f
)JJf g
;JJg h
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
UniqueIdentifierKK: J
,KKJ K
ParameterDirectionKKL ^
.KK^ _
InputKK_ d
,KKd e
siteGuidKKf n
)KKn o
;KKo p
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
UniqueIdentifierLL= M
,LLM N
ParameterDirectionLLO a
.LLa b
InputLLb g
,LLg h
featureGuidLLi t
)LLt u
;LLu v
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 0
,MM0 1
	SqlDbTypeMM2 ;
.MM; <
UniqueIdentifierMM< L
,MML M
ParameterDirectionMMN `
.MM` a
InputMMa f
,MMf g

moduleGuidMMh r
)MMr s
;MMs t
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# .
,NN. /
	SqlDbTypeNN0 9
.NN9 :
UniqueIdentifierNN: J
,NNJ K
ParameterDirectionNNL ^
.NN^ _
InputNN_ d
,NNd e
itemGuidNNf n
)NNn o
;NNo p
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
UniqueIdentifierOO> N
,OON O
ParameterDirectionOOP b
.OOb c
InputOOc h
,OOh i
categoryGuidOOj v
)OOv w
;OOw x
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
UniqueIdentifierPP; K
,PPK L
ParameterDirectionPPM _
.PP_ `
InputPP` e
,PPe f
	extraGuidPPg p
)PPp q
;PPq r
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}TT 	
public^^ 
static^^ 
bool^^ 
Delete^^ !
(^^! "
Guid^^" &
guid^^' +
)^^+ ,
{__ 	
SqlParameterHelper`` 
sph`` "
=``# $
new``% (
SqlParameterHelper``) ;
(``; <
ConnectionString``< L
.``L M$
GetWriteConnectionString``M e
(``e f
)``f g
,``g h
$str	``i 
,
`` 
$num
`` 
)
`` 
;
`` 
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
UniqueIdentifieraa6 F
,aaF G
ParameterDirectionaaH Z
.aaZ [
Inputaa[ `
,aa` a
guidaab f
)aaf g
;aag h
intbb 
rowsAffectedbb 
=bb 
sphbb "
.bb" #
ExecuteNonQuerybb# 2
(bb2 3
)bb3 4
;bb4 5
returncc 
(cc 
rowsAffectedcc  
>cc! "
$numcc# $
)cc$ %
;cc% &
}ee 	
publicgg 
staticgg 
boolgg 
DeleteByItemgg '
(gg' (
Guidgg( ,
itemGuidgg- 5
)gg5 6
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M$
GetWriteConnectionStringiiM e
(iie f
)iif g
,iig h
$str	iii 
,
ii 
$num
ii 
)
ii 
;
ii 
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
itemGuidjjf n
)jjn o
;jjo p
intkk 
rowsAffectedkk 
=kk 
sphkk "
.kk" #
ExecuteNonQuerykk# 2
(kk2 3
)kk3 4
;kk4 5
returnll 
(ll 
rowsAffectedll  
>ll! "
$numll# $
)ll$ %
;ll% &
}mm 	
publicoo 
staticoo 
booloo 
DeleteByExtraGuidoo ,
(oo, -
Guidoo- 1
	extraGuidoo2 ;
)oo; <
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M$
GetWriteConnectionStringqqM e
(qqe f
)qqf g
,qqg h
$str	qqi 
,
qq 
$num
qq 
)
qq 
;
qq 
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# /
,rr/ 0
	SqlDbTyperr1 :
.rr: ;
UniqueIdentifierrr; K
,rrK L
ParameterDirectionrrM _
.rr_ `
Inputrr` e
,rre f
	extraGuidrrg p
)rrp q
;rrq r
intss 
rowsAffectedss 
=ss 
sphss "
.ss" #
ExecuteNonQueryss# 2
(ss2 3
)ss3 4
;ss4 5
returntt 
(tt 
rowsAffectedtt  
>tt! "
$numtt# $
)tt$ %
;tt% &
}uu 	
publicww 
staticww 
boolww 
DeleteByCategoryww +
(ww+ ,
Guidww, 0
categoryGuidww1 =
)ww= >
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$str	yyi 
,
yy 
$num
yy 
)
yy 
;
yy 
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 2
,zz2 3
	SqlDbTypezz4 =
.zz= >
UniqueIdentifierzz> N
,zzN O
ParameterDirectionzzP b
.zzb c
Inputzzc h
,zzh i
categoryGuidzzj v
)zzv w
;zzw x
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}}} 	
public 
static 
bool 
DeleteByModule )
() *
Guid* .

moduleGuid/ 9
)9 :
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByFeature
 *
(
* +
Guid
+ /
featureGuid
0 ;
)
; <
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
}
 
} Û²
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPaymentLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPaymentLog $
{ 
public44 
static44 
int44 
Create44  
(44  !
Guid55 
rowGuid55 
,55 
DateTime66 

createdUtc66 
,66  
Guid77 
siteGuid77 
,77 
Guid88 
userGuid88 
,88 
Guid99 
	storeGuid99 
,99 
Guid:: 
cartGuid:: 
,:: 
string;; 
provider;; 
,;; 
string<< 
rawResponse<< 
,<< 
string== 
responseCode== 
,==  
string>> 
responseReasonCode>> %
,>>% &
string?? 
reason?? 
,?? 
string@@ 
avsCode@@ 
,@@ 
stringAA 
ccvCodeAA 
,AA 
stringBB 
cavCodeBB 
,BB 
stringCC 
transactionIdCC  
,CC  !
stringDD 
transactionTypeDD "
,DD" #
stringEE 
methodEE 
,EE 
stringFF 
authCodeFF 
,FF 
decimalGG 
amountGG 
,GG 
decimalHH 
taxHH 
,HH 
decimalII 
dutyII 
,II 
decimalJJ 
freightJJ 
)JJ 
{KK 	
SqlParameterHelperLL 
sphLL "
=LL# $
newLL% (
SqlParameterHelperLL) ;
(LL; <
ConnectionStringLL< L
.LLL M$
GetWriteConnectionStringLLM e
(LLe f
)LLf g
,LLg h
$strLLi 
,	LL 
$num
LL 
)
LL 
;
LL 
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# -
,MM- .
	SqlDbTypeMM/ 8
.MM8 9
UniqueIdentifierMM9 I
,MMI J
ParameterDirectionMMK ]
.MM] ^
InputMM^ c
,MMc d
rowGuidMMe l
)MMl m
;MMm n
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 0
,NN0 1
	SqlDbTypeNN2 ;
.NN; <
DateTimeNN< D
,NND E
ParameterDirectionNNF X
.NNX Y
InputNNY ^
,NN^ _

createdUtcNN` j
)NNj k
;NNk l
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
userGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# /
,QQ/ 0
	SqlDbTypeQQ1 :
.QQ: ;
UniqueIdentifierQQ; K
,QQK L
ParameterDirectionQQM _
.QQ_ `
InputQQ` e
,QQe f
	storeGuidQQg p
)QQp q
;QQq r
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
UniqueIdentifierRR: J
,RRJ K
ParameterDirectionRRL ^
.RR^ _
InputRR_ d
,RRd e
cartGuidRRf n
)RRn o
;RRo p
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
providerSSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
rawResponseTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NCharUU> C
,UUC D
$numUUE F
,UUF G
ParameterDirectionUUH Z
.UUZ [
InputUU[ `
,UU` a
responseCodeUUb n
)UUn o
;UUo p
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 8
,VV8 9
	SqlDbTypeVV: C
.VVC D
NVarCharVVD L
,VVL M
$numVVN P
,VVP Q
ParameterDirectionVVR d
.VVd e
InputVVe j
,VVj k
responseReasonCodeVVl ~
)VV~ 
;	VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# ,
,WW, -
	SqlDbTypeWW. 7
.WW7 8
NVarCharWW8 @
,WW@ A
-WWB C
$numWWC D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _
reasonWW` f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
NVarCharXX9 A
,XXA B
$numXXC E
,XXE F
ParameterDirectionXXG Y
.XXY Z
InputXXZ _
,XX_ `
avsCodeXXa h
)XXh i
;XXi j
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# -
,YY- .
	SqlDbTypeYY/ 8
.YY8 9
NCharYY9 >
,YY> ?
$numYY@ A
,YYA B
ParameterDirectionYYC U
.YYU V
InputYYV [
,YY[ \
ccvCodeYY] d
)YYd e
;YYe f
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# -
,ZZ- .
	SqlDbTypeZZ/ 8
.ZZ8 9
NCharZZ9 >
,ZZ> ?
$numZZ@ A
,ZZA B
ParameterDirectionZZC U
.ZZU V
InputZZV [
,ZZ[ \
cavCodeZZ] d
)ZZd e
;ZZe f
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 3
,[[3 4
	SqlDbType[[5 >
.[[> ?
NVarChar[[? G
,[[G H
$num[[I K
,[[K L
ParameterDirection[[M _
.[[_ `
Input[[` e
,[[e f
transactionId[[g t
)[[t u
;[[u v
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 5
,\\5 6
	SqlDbType\\7 @
.\\@ A
NVarChar\\A I
,\\I J
$num\\K M
,\\M N
ParameterDirection\\O a
.\\a b
Input\\b g
,\\g h
transactionType\\i x
)\\x y
;\\y z
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ,
,]], -
	SqlDbType]]. 7
.]]7 8
NVarChar]]8 @
,]]@ A
$num]]B D
,]]D E
ParameterDirection]]F X
.]]X Y
Input]]Y ^
,]]^ _
method]]` f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
NVarChar^^: B
,^^B C
$num^^D F
,^^F G
ParameterDirection^^H Z
.^^Z [
Input^^[ `
,^^` a
authCode^^b j
)^^j k
;^^k l
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Decimal__8 ?
,__? @
ParameterDirection__A S
.__S T
Input__T Y
,__Y Z
amount__[ a
)__a b
;__b c
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# )
,``) *
	SqlDbType``+ 4
.``4 5
Decimal``5 <
,``< =
ParameterDirection``> P
.``P Q
Input``Q V
,``V W
tax``X [
)``[ \
;``\ ]
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
Decimalaa6 =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
dutyaaY ]
)aa] ^
;aa^ _
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
Decimalbb9 @
,bb@ A
ParameterDirectionbbB T
.bbT U
InputbbU Z
,bbZ [
freightbb\ c
)bbc d
;bbd e
intcc 
rowsAffectedcc 
=cc 
sphcc "
.cc" #
ExecuteNonQuerycc# 2
(cc2 3
)cc3 4
;cc4 5
returndd 
rowsAffecteddd 
;dd  
}ff 	
public
 
static
 
bool
 
Update
 !
(
! "
Guid
 
rowGuid
 
,
 
Guid
 
siteGuid
 
,
 
Guid
 
userGuid
 
,
 
Guid
 
	storeGuid
 
,
 
Guid
 
cartGuid
 
,
 
string
 
rawResponse
 
,
 
string
 
responseCode
 
,
  
string
  
responseReasonCode
 %
,
% &
string
 
reason
 
,
 
string
 
avsCode
 
,
 
string
 
ccvCode
 
,
 
string
 
cavCode
 
,
 
string
 
transactionId
  
,
  !
string
 
transactionType
 "
,
" #
string
 
method
 
,
 
string
 
authCode
 
,
 
decimal
 
amount
 
,
 
decimal
 
tax
 
,
 
decimal
 
duty
 
,
 
decimal
 
freight
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$str
i 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
UniqueIdentifier
9 I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
rowGuid
e l
)
l m
;
m n
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	storeGuid
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
cartGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
-
G H
$num
H I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
rawResponse
e p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NChar
> C
,
C D
$num
E F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
responseCode
b n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 8
,
8 9
	SqlDbType
: C
.
C D
NVarChar
D L
,
L M
$num
N P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k 
responseReasonCode
l ~
)
~ 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
-
B C
$num
C D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
reason
` f
)
f g
;
g h
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # -
,
  - .
	SqlDbType
  / 8
.
  8 9
NVarChar
  9 A
,
  A B
$num
  C E
,
  E F 
ParameterDirection
  G Y
.
  Y Z
Input
  Z _
,
  _ `
avsCode
  a h
)
  h i
;
  i j
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# -
,
¡¡- .
	SqlDbType
¡¡/ 8
.
¡¡8 9
NChar
¡¡9 >
,
¡¡> ?
$num
¡¡@ A
,
¡¡A B 
ParameterDirection
¡¡C U
.
¡¡U V
Input
¡¡V [
,
¡¡[ \
ccvCode
¡¡] d
)
¡¡d e
;
¡¡e f
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# -
,
¢¢- .
	SqlDbType
¢¢/ 8
.
¢¢8 9
NChar
¢¢9 >
,
¢¢> ?
$num
¢¢@ A
,
¢¢A B 
ParameterDirection
¢¢C U
.
¢¢U V
Input
¢¢V [
,
¢¢[ \
cavCode
¢¢] d
)
¢¢d e
;
¢¢e f
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 3
,
££3 4
	SqlDbType
££5 >
.
££> ?
NVarChar
££? G
,
££G H
$num
££I K
,
££K L 
ParameterDirection
££M _
.
££_ `
Input
££` e
,
££e f
transactionId
££g t
)
££t u
;
££u v
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 5
,
¤¤5 6
	SqlDbType
¤¤7 @
.
¤¤@ A
NVarChar
¤¤A I
,
¤¤I J
$num
¤¤K M
,
¤¤M N 
ParameterDirection
¤¤O a
.
¤¤a b
Input
¤¤b g
,
¤¤g h
transactionType
¤¤i x
)
¤¤x y
;
¤¤y z
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# ,
,
¥¥, -
	SqlDbType
¥¥. 7
.
¥¥7 8
NVarChar
¥¥8 @
,
¥¥@ A
$num
¥¥B D
,
¥¥D E 
ParameterDirection
¥¥F X
.
¥¥X Y
Input
¥¥Y ^
,
¥¥^ _
method
¥¥` f
)
¥¥f g
;
¥¥g h
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# .
,
¦¦. /
	SqlDbType
¦¦0 9
.
¦¦9 :
NVarChar
¦¦: B
,
¦¦B C
$num
¦¦D F
,
¦¦F G 
ParameterDirection
¦¦H Z
.
¦¦Z [
Input
¦¦[ `
,
¦¦` a
authCode
¦¦b j
)
¦¦j k
;
¦¦k l
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# ,
,
§§, -
	SqlDbType
§§. 7
.
§§7 8
Decimal
§§8 ?
,
§§? @ 
ParameterDirection
§§A S
.
§§S T
Input
§§T Y
,
§§Y Z
amount
§§[ a
)
§§a b
;
§§b c
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# )
,
¨¨) *
	SqlDbType
¨¨+ 4
.
¨¨4 5
Decimal
¨¨5 <
,
¨¨< = 
ParameterDirection
¨¨> P
.
¨¨P Q
Input
¨¨Q V
,
¨¨V W
tax
¨¨X [
)
¨¨[ \
;
¨¨\ ]
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# *
,
©©* +
	SqlDbType
©©, 5
.
©©5 6
Decimal
©©6 =
,
©©= > 
ParameterDirection
©©? Q
.
©©Q R
Input
©©R W
,
©©W X
duty
©©Y ]
)
©©] ^
;
©©^ _
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# -
,
ªª- .
	SqlDbType
ªª/ 8
.
ªª8 9
Decimal
ªª9 @
,
ªª@ A 
ParameterDirection
ªªB T
.
ªªT U
Input
ªªU Z
,
ªªZ [
freight
ªª\ c
)
ªªc d
;
ªªd e
int
«« 
rowsAffected
«« 
=
«« 
sph
«« "
.
««" #
ExecuteNonQuery
««# 2
(
««2 3
)
««3 4
;
««4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
$num
¬¬# $
)
¬¬$ %
;
¬¬% &
}
®® 	
public
µµ 
static
µµ 
bool
µµ 
Delete
µµ !
(
µµ! "
Guid
µµ" &
rowGuid
µµ' .
)
µµ. /
{
¶¶ 	 
SqlParameterHelper
·· 
sph
·· "
=
··# $
new
··% ( 
SqlParameterHelper
··) ;
(
··; <
ConnectionString
··< L
.
··L M&
GetWriteConnectionString
··M e
(
··e f
)
··f g
,
··g h
$str
··i 
,·· 
$num·· 
)·· 
;·· 
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# -
,
¸¸- .
	SqlDbType
¸¸/ 8
.
¸¸8 9
UniqueIdentifier
¸¸9 I
,
¸¸I J 
ParameterDirection
¸¸K ]
.
¸¸] ^
Input
¸¸^ c
,
¸¸c d
rowGuid
¸¸e l
)
¸¸l m
;
¸¸m n
int
¹¹ 
rowsAffected
¹¹ 
=
¹¹ 
sph
¹¹ "
.
¹¹" #
ExecuteNonQuery
¹¹# 2
(
¹¹2 3
)
¹¹3 4
;
¹¹4 5
return
ºº 
(
ºº 
rowsAffected
ºº  
>
ºº! "
$num
ºº# $
)
ºº$ %
;
ºº% &
}
¼¼ 	
public
ÂÂ 
static
ÂÂ 
IDataReader
ÂÂ !
GetOne
ÂÂ" (
(
ÂÂ( )
Guid
ÂÂ) -
rowGuid
ÂÂ. 5
)
ÂÂ5 6
{
ÃÃ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh 
,ÄÄ 
$numÄÄ 
)ÄÄ 
;ÄÄ 
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# -
,
ÅÅ- .
	SqlDbType
ÅÅ/ 8
.
ÅÅ8 9
UniqueIdentifier
ÅÅ9 I
,
ÅÅI J 
ParameterDirection
ÅÅK ]
.
ÅÅ] ^
Input
ÅÅ^ c
,
ÅÅc d
rowGuid
ÅÅe l
)
ÅÅl m
;
ÅÅm n
return
ÆÆ 
sph
ÆÆ 
.
ÆÆ 
ExecuteReader
ÆÆ $
(
ÆÆ$ %
)
ÆÆ% &
;
ÆÆ& '
}
ÈÈ 	
public
ÎÎ 
static
ÎÎ 
IDataReader
ÎÎ !
	GetByCart
ÎÎ" +
(
ÎÎ+ ,
Guid
ÎÎ, 0
cartGuid
ÎÎ1 9
)
ÎÎ9 :
{
ÏÏ 	 
SqlParameterHelper
ÐÐ 
sph
ÐÐ "
=
ÐÐ# $
new
ÐÐ% ( 
SqlParameterHelper
ÐÐ) ;
(
ÐÐ; <
ConnectionString
ÐÐ< L
.
ÐÐL M%
GetReadConnectionString
ÐÐM d
(
ÐÐd e
)
ÐÐe f
,
ÐÐf g
$strÐÐh 
,ÐÐ 
$numÐÐ 
)ÐÐ 
;ÐÐ 
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# .
,
ÑÑ. /
	SqlDbType
ÑÑ0 9
.
ÑÑ9 :
UniqueIdentifier
ÑÑ: J
,
ÑÑJ K 
ParameterDirection
ÑÑL ^
.
ÑÑ^ _
Input
ÑÑ_ d
,
ÑÑd e
cartGuid
ÑÑf n
)
ÑÑn o
;
ÑÑo p
return
ÒÒ 
sph
ÒÒ 
.
ÒÒ 
ExecuteReader
ÒÒ $
(
ÒÒ$ %
)
ÒÒ% &
;
ÒÒ& '
}
ÔÔ 	
}
ÖÖ 
}×× õu
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSystemLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSystemLog #
{ 
public%% 
static%% 
int%% 
Create%%  
(%%  !
DateTime&& 
logDate&& 
,&& 
string'' 
	ipAddress'' 
,'' 
string(( 
culture(( 
,(( 
string)) 
url)) 
,)) 
string** 
shortUrl** 
,** 
string++ 
thread++ 
,++ 
string,, 
logLevel,, 
,,, 
string-- 
logger-- 
,-- 
string.. 
message.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str00i ~
,00~ 
$num
00 
)
00 
;
00 
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# -
,11- .
	SqlDbType11/ 8
.118 9
DateTime119 A
,11A B
ParameterDirection11C U
.11U V
Input11V [
,11[ \
logDate11] d
)11d e
;11e f
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# /
,22/ 0
	SqlDbType221 :
.22: ;
NVarChar22; C
,22C D
$num22E G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
	ipAddress22c l
)22l m
;22m n
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# -
,33- .
	SqlDbType33/ 8
.338 9
NVarChar339 A
,33A B
$num33C E
,33E F
ParameterDirection33G Y
.33Y Z
Input33Z _
,33_ `
culture33a h
)33h i
;33i j
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# )
,44) *
	SqlDbType44+ 4
.444 5
NVarChar445 =
,44= >
-44? @
$num44@ A
,44A B
ParameterDirection44C U
.44U V
Input44V [
,44[ \
url44] `
)44` a
;44a b
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
NVarChar55: B
,55B C
$num55D G
,55G H
ParameterDirection55I [
.55[ \
Input55\ a
,55a b
shortUrl55c k
)55k l
;55l m
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# ,
,66, -
	SqlDbType66. 7
.667 8
NVarChar668 @
,66@ A
$num66B E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
thread66a g
)66g h
;66h i
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
NVarChar77: B
,77B C
$num77D F
,77F G
ParameterDirection77H Z
.77Z [
Input77[ `
,77` a
logLevel77b j
)77j k
;77k l
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# ,
,88, -
	SqlDbType88. 7
.887 8
NVarChar888 @
,88@ A
$num88B E
,88E F
ParameterDirection88G Y
.88Y Z
Input88Z _
,88_ `
logger88a g
)88g h
;88h i
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# -
,99- .
	SqlDbType99/ 8
.998 9
NVarChar999 A
,99A B
-99C D
$num99D E
,99E F
ParameterDirection99G Y
.99Y Z
Input99Z _
,99_ `
message99a h
)99h i
;99i j
int:: 
newID:: 
=:: 
Convert:: 
.::  
ToInt32::  '
(::' (
sph::( +
.::+ ,
ExecuteScalar::, 9
(::9 :
)::: ;
)::; <
;::< =
return;; 
newID;; 
;;; 
}<< 	
publicAA 
staticAA 
voidAA 
	DeleteAllAA $
(AA$ %
)AA% &
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$str	CCi 
,
CC 
$num
CC 
)
CC 
;
CC 
sphEE 
.EE 
ExecuteNonQueryEE 
(EE  
)EE  !
;EE! "
}HH 	
publicOO 
staticOO 
boolOO 
DeleteOO !
(OO! "
intOO" %
idOO& (
)OO( )
{PP 	
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h
$strQQi ~
,QQ~ 
$num
QQ 
)
QQ 
;
QQ 
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# (
,RR( )
	SqlDbTypeRR* 3
.RR3 4
IntRR4 7
,RR7 8
ParameterDirectionRR9 K
.RRK L
InputRRL Q
,RRQ R
idRRS U
)RRU V
;RRV W
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
(TT 
rowsAffectedTT  
>TT! "
$numTT# $
)TT$ %
;TT% &
}VV 	
public]] 
static]] 
bool]] 
DeleteOlderThan]] *
(]]* +
DateTime]]+ 3

cutoffDate]]4 >
)]]> ?
{^^ 	
SqlParameterHelper__ 
sph__ "
=__# $
new__% (
SqlParameterHelper__) ;
(__; <
ConnectionString__< L
.__L M$
GetWriteConnectionString__M e
(__e f
)__f g
,__g h
$str	__i 
,
__ 
$num
__ 
)
__ 
;
__ 
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
DateTime``< D
,``D E
ParameterDirection``F X
.``X Y
Input``Y ^
,``^ _

cutoffDate``` j
)``j k
;``k l
intaa 
rowsAffectedaa 
=aa 
sphaa "
.aa" #
ExecuteNonQueryaa# 2
(aa2 3
)aa3 4
;aa4 5
returnbb 
(bb 
rowsAffectedbb  
>bb! "
$numbb# $
)bb$ %
;bb% &
}dd 	
publickk 
statickk 
boolkk 
DeleteByLevelkk (
(kk( )
stringkk) /
logLevelkk0 8
)kk8 9
{ll 	
SqlParameterHelpermm 
sphmm "
=mm# $
newmm% (
SqlParameterHelpermm) ;
(mm; <
ConnectionStringmm< L
.mmL M$
GetWriteConnectionStringmmM e
(mme f
)mmf g
,mmg h
$str	mmi 
,
mm 
$num
mm 
)
mm 
;
mm 
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# .
,nn. /
	SqlDbTypenn0 9
.nn9 :
NVarCharnn: B
,nnB C
$numnnD F
,nnF G
ParameterDirectionnnH Z
.nnZ [
Inputnn[ `
,nn` a
logLevelnnb j
)nnj k
;nnk l
intoo 
rowsAffectedoo 
=oo 
sphoo "
.oo" #
ExecuteNonQueryoo# 2
(oo2 3
)oo3 4
;oo4 5
returnpp 
(pp 
rowsAffectedpp  
>pp! "
$numpp# $
)pp$ %
;pp% &
}rr 	
publicww 
staticww 
intww 
GetCountww "
(ww" #
)ww# $
{xx 	
returnzz 
Convertzz 
.zz 
ToInt32zz "
(zz" #
	SqlHelperzz# ,
.zz, -
ExecuteScalarzz- :
(zz: ;
ConnectionString{{  
.{{  !#
GetReadConnectionString{{! 8
({{8 9
){{9 :
,{{: ;
CommandType|| 
.|| 
StoredProcedure|| +
,||+ ,
$str}} '
,}}' (
null~~ 
)~~ 
)~~ 
;~~ 
}
 	
public
 
static
 
IDataReader
 !
GetPageAscending
" 2
(
2 3
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 $
(
$ %
)
% &
;
& '
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h 
,   
$num   
)   
;   
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 0
,
¡¡0 1
	SqlDbType
¡¡2 ;
.
¡¡; <
Int
¡¡< ?
,
¡¡? @ 
ParameterDirection
¡¡A S
.
¡¡S T
Input
¡¡T Y
,
¡¡Y Z

pageNumber
¡¡[ e
)
¡¡e f
;
¡¡f g
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
Int
¢¢: =
,
¢¢= > 
ParameterDirection
¢¢? Q
.
¢¢Q R
Input
¢¢R W
,
¢¢W X
pageSize
¢¢Y a
)
¢¢a b
;
¢¢b c
return
££ 
sph
££ 
.
££ 
ExecuteReader
££ $
(
££$ %
)
££% &
;
££& '
}
¥¥ 	
public
­­ 
static
­­ 
IDataReader
­­ !
GetPageDescending
­­" 3
(
­­3 4
int
®® 

pageNumber
®® 
,
®® 
int
¯¯ 
pageSize
¯¯ 
,
¯¯ 
out
°° 
int
°° 

totalPages
°° 
)
°° 
{
±± 	

totalPages
²² 
=
²² 
$num
²² 
;
²² 
int
³³ 
	totalRows
³³ 
=
³³ 
GetCount
³³ $
(
³³$ %
)
³³% &
;
³³& '
if
µµ 
(
µµ 
pageSize
µµ 
>
µµ 
$num
µµ 
)
µµ 

totalPages
µµ (
=
µµ) *
	totalRows
µµ+ 4
/
µµ5 6
pageSize
µµ7 ?
;
µµ? @
if
·· 
(
·· 
	totalRows
·· 
<=
·· 
pageSize
·· %
)
··% &
{
¸¸ 

totalPages
¹¹ 
=
¹¹ 
$num
¹¹ 
;
¹¹ 
}
ºº 
else
»» 
{
¼¼ 
int
½½ 
	remainder
½½ 
;
½½ 
Math
¾¾ 
.
¾¾ 
DivRem
¾¾ 
(
¾¾ 
	totalRows
¾¾ %
,
¾¾% &
pageSize
¾¾' /
,
¾¾/ 0
out
¾¾1 4
	remainder
¾¾5 >
)
¾¾> ?
;
¾¾? @
if
¿¿ 
(
¿¿ 
	remainder
¿¿ 
>
¿¿ 
$num
¿¿  !
)
¿¿! "
{
ÀÀ 

totalPages
ÁÁ 
+=
ÁÁ !
$num
ÁÁ" #
;
ÁÁ# $
}
ÂÂ 
}
ÃÃ  
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M%
GetReadConnectionString
ÅÅM d
(
ÅÅd e
)
ÅÅe f
,
ÅÅf g
$strÅÅh 
,ÅÅ 
$numÅÅ 
)ÅÅ 
;ÅÅ 
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# 0
,
ÆÆ0 1
	SqlDbType
ÆÆ2 ;
.
ÆÆ; <
Int
ÆÆ< ?
,
ÆÆ? @ 
ParameterDirection
ÆÆA S
.
ÆÆS T
Input
ÆÆT Y
,
ÆÆY Z

pageNumber
ÆÆ[ e
)
ÆÆe f
;
ÆÆf g
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
Int
ÇÇ: =
,
ÇÇ= > 
ParameterDirection
ÇÇ? Q
.
ÇÇQ R
Input
ÇÇR W
,
ÇÇW X
pageSize
ÇÇY a
)
ÇÇa b
;
ÇÇb c
return
ÈÈ 
sph
ÈÈ 
.
ÈÈ 
ExecuteReader
ÈÈ $
(
ÈÈ$ %
)
ÈÈ% &
;
ÈÈ& '
}
ÊÊ 	
}
ÍÍ 
}ÎÎ ú®
eD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTag.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBTag 
{ 
public 
static	 
bool 
Create 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid 
featureGuid 
, 
Guid 

moduleGuid 
, 
string 	
tagText
 
, 
DateTime 

createdUtc 
, 
Guid 
	createdBy 
, 
Guid 
vocabularyGuid 
) 
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` o
,o p
$numq r
)r s
;s t
sph 
. 
DefineSqlParameter 
( 
$str !
,! "
	SqlDbType# ,
., -
UniqueIdentifier- =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
guidY ]
)] ^
;^ _
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
siteGuid] e
)e f
;f g
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
featureGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
UniqueIdentifier3 C
,C D
ParameterDirectionE W
.W X
InputX ]
,] ^

moduleGuid_ i
)i j
;j k
sph 
. 
DefineSqlParameter 
( 
$str  
,  !
	SqlDbType" +
.+ ,
NVarChar, 4
,4 5
$num6 9
,9 :
ParameterDirection; M
.M N
InputN S
,S T
tagTextU \
)\ ]
;] ^
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
DateTime3 ;
,; <
ParameterDirection= O
.O P
InputP U
,U V

createdUtcW a
)a b
;b c
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
UniqueIdentifier2 B
,B C
ParameterDirectionD V
.V W
InputW \
,\ ]
	createdBy^ g
)g h
;h i
sph 
. 
DefineSqlParameter 
( 
$str +
,+ ,
	SqlDbType- 6
.6 7
UniqueIdentifier7 G
,G H
ParameterDirectionI [
.[ \
Input\ a
,a b
vocabularyGuidc q
)q r
;r s
return!! 	
sph!!
 
.!! 
ExecuteNonQuery!! 
(!! 
)!! 
>!!  !
$num!!" #
;!!# $
}"" 
public$$ 
static$$	 
bool$$ 
Update$$ 
($$ 
Guid%% 
guid%% 
,%% 
string&& 	
tagText&&
 
,&& 
DateTime'' 
modifiedUtc'' 
,'' 
Guid(( 

modifiedBy(( 
,(( 
Guid)) 
vocabularyGuid)) 
)** 
{++ 
SqlParameterHelper,, 
sph,, 
=,, 
new,, 
SqlParameterHelper,,  2
(,,2 3
ConnectionString,,3 C
.,,C D$
GetWriteConnectionString,,D \
(,,\ ]
),,] ^
,,,^ _
$str,,` o
,,,o p
$num,,q r
),,r s
;,,s t
sph.. 
... 
DefineSqlParameter.. 
(.. 
$str.. !
,..! "
	SqlDbType..# ,
..., -
UniqueIdentifier..- =
,..= >
ParameterDirection..? Q
...Q R
Input..R W
,..W X
guid..Y ]
)..] ^
;..^ _
sph// 
.// 
DefineSqlParameter// 
(// 
$str//  
,//  !
	SqlDbType//" +
.//+ ,
NVarChar//, 4
,//4 5
$num//6 9
,//9 :
ParameterDirection//; M
.//M N
Input//N S
,//S T
tagText//U \
)//\ ]
;//] ^
sph00 
.00 
DefineSqlParameter00 
(00 
$str00 (
,00( )
	SqlDbType00* 3
.003 4
DateTime004 <
,00< =
ParameterDirection00> P
.00P Q
Input00Q V
,00V W
modifiedUtc00X c
)00c d
;00d e
sph11 
.11 
DefineSqlParameter11 
(11 
$str11 '
,11' (
	SqlDbType11) 2
.112 3
UniqueIdentifier113 C
,11C D
ParameterDirection11E W
.11W X
Input11X ]
,11] ^

modifiedBy11_ i
)11i j
;11j k
sph22 
.22 
DefineSqlParameter22 
(22 
$str22 +
,22+ ,
	SqlDbType22- 6
.226 7
UniqueIdentifier227 G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
vocabularyGuid22c q
)22q r
;22r s
return44 	
sph44
 
.44 
ExecuteNonQuery44 
(44 
)44 
>44  !
$num44" #
;44# $
}55 
public88 
static88	 
bool88 
UpdateItemCount88 $
(88$ %
Guid88% )
guid88* .
)88. /
{99 
SqlParameterHelper:: 
sph:: 
=:: 
new:: 
SqlParameterHelper::  2
(::2 3
ConnectionString::3 C
.::C D$
GetWriteConnectionString::D \
(::\ ]
)::] ^
,::^ _
$str::` x
,::x y
$num::z {
)::{ |
;::| }
sph<< 
.<< 
DefineSqlParameter<< 
(<< 
$str<< !
,<<! "
	SqlDbType<<# ,
.<<, -
UniqueIdentifier<<- =
,<<= >
ParameterDirection<<? Q
.<<Q R
Input<<R W
,<<W X
guid<<Y ]
)<<] ^
;<<^ _
return>> 	
sph>>
 
.>> 
ExecuteNonQuery>> 
(>> 
)>> 
>>>  !
$num>>" #
;>># $
}?? 
publicFF 
staticFF	 
boolFF 
DeleteBySiteFF !
(FF! "
GuidFF" &
siteGuidFF' /
)FF/ 0
{GG 
SqlParameterHelperHH 
sphHH 
=HH 
newHH 
SqlParameterHelperHH  2
(HH2 3
ConnectionStringHH3 C
.HHC D$
GetWriteConnectionStringHHD \
(HH\ ]
)HH] ^
,HH^ _
$strHH` u
,HHu v
$numHHw x
)HHx y
;HHy z
sphJJ 
.JJ 
DefineSqlParameterJJ 
(JJ 
$strJJ %
,JJ% &
	SqlDbTypeJJ' 0
.JJ0 1
UniqueIdentifierJJ1 A
,JJA B
ParameterDirectionJJC U
.JJU V
InputJJV [
,JJ[ \
siteGuidJJ] e
)JJe f
;JJf g
returnLL 	
sphLL
 
.LL 
ExecuteNonQueryLL 
(LL 
)LL 
>LL  !
$numLL" #
;LL# $
}MM 
publicPP 
staticPP	 
boolPP 
DeletePP 
(PP 
GuidPP  
guidPP! %
)PP% &
{QQ 
SqlParameterHelperRR 
sphRR 
=RR 
newRR 
SqlParameterHelperRR  2
(RR2 3
ConnectionStringRR3 C
.RRC D$
GetWriteConnectionStringRRD \
(RR\ ]
)RR] ^
,RR^ _
$strRR` o
,RRo p
$numRRq r
)RRr s
;RRs t
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT !
,TT! "
	SqlDbTypeTT# ,
.TT, -
UniqueIdentifierTT- =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
guidTTY ]
)TT] ^
;TT^ _
returnVV 	
sphVV
 
.VV 
ExecuteNonQueryVV 
(VV 
)VV 
>VV  !
$numVV" #
;VV# $
}WW 
publicZZ 
staticZZ	 
boolZZ 
DeleteByModuleZZ #
(ZZ# $
GuidZZ$ (

moduleGuidZZ) 3
)ZZ3 4
{[[ 
SqlParameterHelper\\ 
sph\\ 
=\\ 
new\\ 
SqlParameterHelper\\  2
(\\2 3
ConnectionString\\3 C
.\\C D$
GetWriteConnectionString\\D \
(\\\ ]
)\\] ^
,\\^ _
$str\\` w
,\\w x
$num\\y z
)\\z {
;\\{ |
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ '
,^^' (
	SqlDbType^^) 2
.^^2 3
UniqueIdentifier^^3 C
,^^C D
ParameterDirection^^E W
.^^W X
Input^^X ]
,^^] ^

moduleGuid^^_ i
)^^i j
;^^j k
return`` 	
sph``
 
.`` 
ExecuteNonQuery`` 
(`` 
)`` 
>``  !
$num``" #
;``# $
}aa 
publicdd 
staticdd	 
booldd 
DeleteByFeaturedd $
(dd$ %
Guiddd% )
featureGuiddd* 5
)dd5 6
{ee 
SqlParameterHelperff 
sphff 
=ff 
newff 
SqlParameterHelperff  2
(ff2 3
ConnectionStringff3 C
.ffC D$
GetWriteConnectionStringffD \
(ff\ ]
)ff] ^
,ff^ _
$strff` x
,ffx y
$numffz {
)ff{ |
;ff| }
sphhh 
.hh 
DefineSqlParameterhh 
(hh 
$strhh (
,hh( )
	SqlDbTypehh* 3
.hh3 4
UniqueIdentifierhh4 D
,hhD E
ParameterDirectionhhF X
.hhX Y
InputhhY ^
,hh^ _
featureGuidhh` k
)hhk l
;hhl m
returnjj 	
sphjj
 
.jj 
ExecuteNonQueryjj 
(jj 
)jj 
>jj  !
$numjj" #
;jj# $
}kk 
publicrr 
staticrr	 
IDataReaderrr 
	GetOneTagrr %
(rr% &
Guidrr& *
guidrr+ /
)rr/ 0
{ss 
SqlParameterHelpertt 
sphtt 
=tt 
newtt 
SqlParameterHelpertt  2
(tt2 3
ConnectionStringtt3 C
.ttC D#
GetReadConnectionStringttD [
(tt[ \
)tt\ ]
,tt] ^
$strtt_ q
,ttq r
$numtts t
)ttt u
;ttu v
sphvv 
.vv 
DefineSqlParametervv 
(vv 
$strvv !
,vv! "
	SqlDbTypevv# ,
.vv, -
UniqueIdentifiervv- =
,vv= >
ParameterDirectionvv? Q
.vvQ R
InputvvR W
,vvW X
guidvvY ]
)vv] ^
;vv^ _
returnxx 	
sphxx
 
.xx 
ExecuteReaderxx 
(xx 
)xx 
;xx 
}yy 
public|| 
static||	 
int|| 
GetCount|| 
(|| 
Guid|| !
guid||" &
,||& '
string||( .
type||/ 3
=||3 4
$str||4 :
)||: ;
{}} 
SqlParameterHelper~~ 
sph~~ 
=~~ 
null~~  
;~~  !
switch 	
(
 
type 
) 
{
 
case
 
$str
	 
:
 
sph
 
=
	 

new
  
SqlParameterHelper
 !
(
! "
ConnectionString
" 2
.
2 3%
GetReadConnectionString
3 J
(
J K
)
K L
,
L M
$str
N g
,
g h
$num
i j
)
j k
;
k l
sph
 
.
 	 
DefineSqlParameter
	 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
UniqueIdentifier
/ ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
guid
[ _
)
_ `
;
` a
break
 

;

 
case
 
$str
	 
:
 
default
 
:
 
sph
 
=
	 

new
  
SqlParameterHelper
 !
(
! "
ConnectionString
" 2
.
2 3%
GetReadConnectionString
3 J
(
J K
)
K L
,
L M
$str
N e
,
e f
$num
g h
)
h i
;
i j
sph
 
.
 	 
DefineSqlParameter
	 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
UniqueIdentifier
/ ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
guid
[ _
)
_ `
;
` a
break
 

;

 
case
 
$str
	 
:
 
sph
 
=
	 

new
  
SqlParameterHelper
 !
(
! "
ConnectionString
" 2
.
2 3%
GetReadConnectionString
3 J
(
J K
)
K L
,
L M
$str
N h
,
h i
$num
j k
)
k l
;
l m
sph
 
.
 	 
DefineSqlParameter
	 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
UniqueIdentifier
/ ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
guid
[ _
)
_ `
;
` a
break
 

;

 
}
 
return
 	
Convert

 
.
 
ToInt32
 
(
 
sph
 
.
 
ExecuteScalar
 +
(
+ ,
)
, -
)
- .
;
. /
}
 
public
 
static
	 
IDataReader
 
	GetBySite
 %
(
% &
Guid
& *
siteGuid
+ 3
)
3 4
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D%
GetReadConnectionString
D [
(
[ \
)
\ ]
,
] ^
$str
_ x
,
x y
$num
z {
)
{ |
;
| }
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 !
,
! "
	SqlDbType
# ,
.
, -
UniqueIdentifier
- =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
siteGuid
Y a
)
a b
;
b c
return
 	
sph

 
.
 
ExecuteReader
 
(
 
)
 
;
 
}
 
public
 
static
	 
IDataReader
 
	GetBySite
 %
(
% &
int
& )
siteId
* 0
)
0 1
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D%
GetReadConnectionString
D [
(
[ \
)
\ ]
,
] ^
$str
_ t
,
t u
$num
v w
)
w x
;
x y
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ 
(
¡¡ 
$str
¡¡ 
,
¡¡  
	SqlDbType
¡¡! *
.
¡¡* +
Int
¡¡+ .
,
¡¡. / 
ParameterDirection
¡¡0 B
.
¡¡B C
Input
¡¡C H
,
¡¡H I
siteId
¡¡J P
)
¡¡P Q
;
¡¡Q R
return
££ 	
sph
££
 
.
££ 
ExecuteReader
££ 
(
££ 
)
££ 
;
££ 
}
¤¤ 
public
§§ 
static
§§	 
IDataReader
§§ 
GetByModule
§§ '
(
§§' (
Guid
§§( ,
siteGuid
§§- 5
,
§§5 6
Guid
§§7 ;

moduleGuid
§§< F
)
§§F G
{
¨¨  
SqlParameterHelper
©© 
sph
©© 
=
©© 
new
©©  
SqlParameterHelper
©©  2
(
©©2 3
ConnectionString
©©3 C
.
©©C D%
GetReadConnectionString
©©D [
(
©©[ \
)
©©\ ]
,
©©] ^
$str
©©_ v
,
©©v w
$num
©©x y
)
©©y z
;
©©z {
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« !
,
««! "
	SqlDbType
««# ,
.
««, -
UniqueIdentifier
««- =
,
««= > 
ParameterDirection
««? Q
.
««Q R
Input
««R W
,
««W X

moduleGuid
««Y c
)
««c d
;
««d e
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ %
,
¬¬% &
	SqlDbType
¬¬' 0
.
¬¬0 1
UniqueIdentifier
¬¬1 A
,
¬¬A B 
ParameterDirection
¬¬C U
.
¬¬U V
Input
¬¬V [
,
¬¬[ \
siteGuid
¬¬] e
)
¬¬e f
;
¬¬f g
return
®® 	
sph
®®
 
.
®® 
ExecuteReader
®® 
(
®® 
)
®® 
;
®® 
}
¯¯ 
public
²² 
static
²²	 
IDataReader
²² 
GetByFeature
²² (
(
²²( )
Guid
²²) -
siteGuid
²². 6
,
²²6 7
Guid
²²8 <
featureGuid
²²= H
)
²²H I
{
³³  
SqlParameterHelper
´´ 
sph
´´ 
=
´´ 
new
´´  
SqlParameterHelper
´´  2
(
´´2 3
ConnectionString
´´3 C
.
´´C D%
GetReadConnectionString
´´D [
(
´´[ \
)
´´\ ]
,
´´] ^
$str
´´_ w
,
´´w x
$num
´´y z
)
´´z {
;
´´{ |
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ 
(
¶¶ 
$str
¶¶ !
,
¶¶! "
	SqlDbType
¶¶# ,
.
¶¶, -
UniqueIdentifier
¶¶- =
,
¶¶= > 
ParameterDirection
¶¶? Q
.
¶¶Q R
Input
¶¶R W
,
¶¶W X
featureGuid
¶¶Y d
)
¶¶d e
;
¶¶e f
sph
·· 
.
··  
DefineSqlParameter
·· 
(
·· 
$str
·· %
,
··% &
	SqlDbType
··' 0
.
··0 1
UniqueIdentifier
··1 A
,
··A B 
ParameterDirection
··C U
.
··U V
Input
··V [
,
··[ \
siteGuid
··] e
)
··e f
;
··f g
return
¹¹ 	
sph
¹¹
 
.
¹¹ 
ExecuteReader
¹¹ 
(
¹¹ 
)
¹¹ 
;
¹¹ 
}
ºº 
public
½½ 
static
½½	 
IDataReader
½½ 
GetByVocabulary
½½ +
(
½½+ ,
Guid
½½, 0
siteGuid
½½1 9
,
½½9 :
Guid
½½; ?
vocabularyGuid
½½@ N
)
½½N O
{
¾¾  
SqlParameterHelper
¿¿ 
sph
¿¿ 
=
¿¿ 
new
¿¿  
SqlParameterHelper
¿¿  2
(
¿¿2 3
ConnectionString
¿¿3 C
.
¿¿C D%
GetReadConnectionString
¿¿D [
(
¿¿[ \
)
¿¿\ ]
,
¿¿] ^
$str
¿¿_ z
,
¿¿z {
$num
¿¿| }
)
¿¿} ~
;
¿¿~ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ 
(
ÁÁ 
$str
ÁÁ !
,
ÁÁ! "
	SqlDbType
ÁÁ# ,
.
ÁÁ, -
UniqueIdentifier
ÁÁ- =
,
ÁÁ= > 
ParameterDirection
ÁÁ? Q
.
ÁÁQ R
Input
ÁÁR W
,
ÁÁW X
vocabularyGuid
ÁÁY g
)
ÁÁg h
;
ÁÁh i
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ 
(
ÂÂ 
$str
ÂÂ %
,
ÂÂ% &
	SqlDbType
ÂÂ' 0
.
ÂÂ0 1
UniqueIdentifier
ÂÂ1 A
,
ÂÂA B 
ParameterDirection
ÂÂC U
.
ÂÂU V
Input
ÂÂV [
,
ÂÂ[ \
siteGuid
ÂÂ] e
)
ÂÂe f
;
ÂÂf g
return
ÄÄ 	
sph
ÄÄ
 
.
ÄÄ 
ExecuteReader
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÈÈ 
}ÉÉ v
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTagItem.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
	DBTagItem 
{ 
public 
static	 
bool 
Create 
( 
Guid 
tagItemGuid 
, 
Guid 
siteGuid 
, 
Guid 
featureGuid 
, 
Guid 

moduleGuid 
, 
Guid 
relatedItemGuid 
, 
Guid 
tagGuid 
, 
Guid 
	extraGuid 
, 
Guid 
taggedBy 
) 
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` s
,s t
$numu v
)v w
;w x
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
tagItemGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
siteGuid] e
)e f
;f g
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
UniqueIdentifier4 D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _
featureGuid` k
)k l
;l m
sph 
. 
DefineSqlParameter 
( 
$str '
,' (
	SqlDbType) 2
.2 3
UniqueIdentifier3 C
,C D
ParameterDirectionE W
.W X
InputX ]
,] ^

moduleGuid_ i
)i j
;j k
sph 
. 
DefineSqlParameter 
( 
$str ,
,, -
	SqlDbType. 7
.7 8
UniqueIdentifier8 H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c
relatedItemGuidd s
)s t
;t u
sph 
. 
DefineSqlParameter 
( 
$str $
,$ %
	SqlDbType& /
./ 0
UniqueIdentifier0 @
,@ A
ParameterDirectionB T
.T U
InputU Z
,Z [
tagGuid\ c
)c d
;d e
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
UniqueIdentifier2 B
,B C
ParameterDirectionD V
.V W
InputW \
,\ ]
	extraGuid^ g
)g h
;h i
sph 
. 
DefineSqlParameter 
( 
$str %
,% &
	SqlDbType' 0
.0 1
UniqueIdentifier1 A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
taggedBy] e
)e f
;f g
return!! 	
sph!!
 
.!! 
ExecuteNonQuery!! 
(!! 
)!! 
>!!  !
$num!!" #
;!!# $
}"" 
public)) 
static))	 
bool)) 
DeleteBySite)) !
())! "
Guid))" &
siteGuid))' /
)))/ 0
{** 
SqlParameterHelper++ 
sph++ 
=++ 
new++ 
SqlParameterHelper++  2
(++2 3
ConnectionString++3 C
.++C D$
GetWriteConnectionString++D \
(++\ ]
)++] ^
,++^ _
$str++` y
,++y z
$num++{ |
)++| }
;++} ~
sph-- 
.-- 
DefineSqlParameter-- 
(-- 
$str-- %
,--% &
	SqlDbType--' 0
.--0 1
UniqueIdentifier--1 A
,--A B
ParameterDirection--C U
.--U V
Input--V [
,--[ \
siteGuid--] e
)--e f
;--f g
return// 	
sph//
 
.// 
ExecuteNonQuery// 
(// 
)// 
>//  !
$num//" #
;//# $
}00 
public33 
static33	 
bool33 
Delete33 
(33 
Guid33  
tagItemGuid33! ,
)33, -
{44 
SqlParameterHelper55 
sph55 
=55 
new55 
SqlParameterHelper55  2
(552 3
ConnectionString553 C
.55C D$
GetWriteConnectionString55D \
(55\ ]
)55] ^
,55^ _
$str55` s
,55s t
$num55u v
)55v w
;55w x
sph77 
.77 
DefineSqlParameter77 
(77 
$str77 (
,77( )
	SqlDbType77* 3
.773 4
UniqueIdentifier774 D
,77D E
ParameterDirection77F X
.77X Y
Input77Y ^
,77^ _
tagItemGuid77` k
)77k l
;77l m
return99 	
sph99
 
.99 
ExecuteNonQuery99 
(99 
)99 
>99  !
$num99" #
;99# $
}:: 
public== 
static==	 
bool== 
DeleteByTag==  
(==  !
Guid==! %
tagGuid==& -
)==- .
{>> 
SqlParameterHelper?? 
sph?? 
=?? 
new?? 
SqlParameterHelper??  2
(??2 3
ConnectionString??3 C
.??C D$
GetWriteConnectionString??D \
(??\ ]
)??] ^
,??^ _
$str??` x
,??x y
$num??z {
)??{ |
;??| }
sphAA 
.AA 
DefineSqlParameterAA 
(AA 
$strAA $
,AA$ %
	SqlDbTypeAA& /
.AA/ 0
UniqueIdentifierAA0 @
,AA@ A
ParameterDirectionAAB T
.AAT U
InputAAU Z
,AAZ [
tagGuidAA\ c
)AAc d
;AAd e
returnCC 	
sphCC
 
.CC 
ExecuteNonQueryCC 
(CC 
)CC 
>CC  !
$numCC" #
;CC# $
}DD 
publicGG 
staticGG	 
boolGG 
DeleteByModuleGG #
(GG# $
GuidGG$ (

moduleGuidGG) 3
)GG3 4
{HH 
SqlParameterHelperII 
sphII 
=II 
newII 
SqlParameterHelperII  2
(II2 3
ConnectionStringII3 C
.IIC D$
GetWriteConnectionStringIID \
(II\ ]
)II] ^
,II^ _
$strII` {
,II{ |
$numII} ~
)II~ 
;	II 
sphKK 
.KK 
DefineSqlParameterKK 
(KK 
$strKK '
,KK' (
	SqlDbTypeKK) 2
.KK2 3
UniqueIdentifierKK3 C
,KKC D
ParameterDirectionKKE W
.KKW X
InputKKX ]
,KK] ^

moduleGuidKK_ i
)KKi j
;KKj k
returnMM 	
sphMM
 
.MM 
ExecuteNonQueryMM 
(MM 
)MM 
>MM  !
$numMM" #
;MM# $
}NN 
publicQQ 
staticQQ	 
boolQQ 
DeleteByFeatureQQ $
(QQ$ %
GuidQQ% )
featureGuidQQ* 5
)QQ5 6
{RR 
SqlParameterHelperSS 
sphSS 
=SS 
newSS 
SqlParameterHelperSS  2
(SS2 3
ConnectionStringSS3 C
.SSC D$
GetWriteConnectionStringSSD \
(SS\ ]
)SS] ^
,SS^ _
$strSS` |
,SS| }
$numSS~ 
)	SS 
;
SS 
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU (
,UU( )
	SqlDbTypeUU* 3
.UU3 4
UniqueIdentifierUU4 D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _
featureGuidUU` k
)UUk l
;UUl m
returnWW 	
sphWW
 
.WW 
ExecuteNonQueryWW 
(WW 
)WW 
>WW  !
$numWW" #
;WW# $
}XX 
public[[ 
static[[	 
bool[[ 
DeleteByRelatedItem[[ (
([[( )
Guid[[) -
relatedItemGuid[[. =
)[[= >
{\\ 
SqlParameterHelper]] 
sph]] 
=]] 
new]] 
SqlParameterHelper]]  2
(]]2 3
ConnectionString]]3 C
.]]C D$
GetWriteConnectionString]]D \
(]]\ ]
)]]] ^
,]]^ _
$str	]]` 
,
]] 
$num
]] 
)
]] 
;
]] 
sph__ 
.__ 
DefineSqlParameter__ 
(__ 
$str__ ,
,__, -
	SqlDbType__. 7
.__7 8
UniqueIdentifier__8 H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
relatedItemGuid__d s
)__s t
;__t u
returnaa 	
sphaa
 
.aa 
ExecuteNonQueryaa 
(aa 
)aa 
>aa  !
$numaa" #
;aa# $
}bb 
publicee 
staticee	 
boolee 
DeleteByExtraGuidee &
(ee& '
Guidee' +
	extraGuidee, 5
)ee5 6
{ff 
SqlParameterHelpergg 
sphgg 
=gg 
newgg 
SqlParameterHelpergg  2
(gg2 3
ConnectionStringgg3 C
.ggC D$
GetWriteConnectionStringggD \
(gg\ ]
)gg] ^
,gg^ _
$strgg` ~
,gg~ 
$num
gg 
)
gg 
;
gg 
sphii 
.ii 
DefineSqlParameterii 
(ii 
$strii &
,ii& '
	SqlDbTypeii( 1
.ii1 2
UniqueIdentifierii2 B
,iiB C
ParameterDirectioniiD V
.iiV W
InputiiW \
,ii\ ]
	extraGuidii^ g
)iig h
;iih i
returnkk 	
sphkk
 
.kk 
ExecuteNonQuerykk 
(kk 
)kk 
>kk  !
$numkk" #
;kk# $
}ll 
publicss 
staticss	 
IDataReaderss 
GetByTagItemss (
(ss( )
Guidss) -
tagItemGuidss. 9
)ss9 :
{tt 
SqlParameterHelperuu 
sphuu 
=uu 
newuu 
SqlParameterHelperuu  2
(uu2 3
ConnectionStringuu3 C
.uuC D$
GetWriteConnectionStringuuD \
(uu\ ]
)uu] ^
,uu^ _
$struu` y
,uuy z
$numuu{ |
)uu| }
;uu} ~
sphww 
.ww 
DefineSqlParameterww 
(ww 
$strww (
,ww( )
	SqlDbTypeww* 3
.ww3 4
UniqueIdentifierww4 D
,wwD E
ParameterDirectionwwF X
.wwX Y
InputwwY ^
,ww^ _
tagItemGuidww` k
)wwk l
;wwl m
returnyy 	
sphyy
 
.yy 
ExecuteReaderyy 
(yy 
)yy 
;yy 
}zz 
public}} 
static}}	 
IDataReader}} 
GetByRelatedItem}} ,
(}}, -
Guid}}- 1
siteGuid}}2 :
,}}: ;
Guid}}< @
relatedItemGuid}}A P
)}}P Q
{~~ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D$
GetWriteConnectionStringD \
(\ ]
)] ^
,^ _
$str` }
,} ~
$num	 
)
 
;
 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 ,
,
, -
	SqlDbType
. 7
.
7 8
UniqueIdentifier
8 H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
relatedItemGuid
d s
)
s t
;
t u
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
siteGuid
] e
)
e f
;
f g
return
 	
sph

 
.
 
ExecuteReader
 
(
 
)
 
;
 
}
 
public
 
static
	 
IDataReader
 

GetByExtra
 &
(
& '
Guid
' +
siteGuid
, 4
,
4 5
Guid
6 :
	extraGuid
; D
)
D E
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` w
,
w x
$num
y z
)
z {
;
{ |
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 &
,
& '
	SqlDbType
( 1
.
1 2
UniqueIdentifier
2 B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
	extraGuid
^ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
siteGuid
] e
)
e f
;
f g
return
 	
sph

 
.
 
ExecuteReader
 
(
 
)
 
;
 
}
 
}
 
} §
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTagVocabulary.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
class 
DBTagVocabulary 
{ 
} 
} ©Q
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserClaims.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBUserClaims $
{ 
public 
static 
int 
Create  
(  !
string 
userId 
, 
string 
	claimType 
, 
string 

claimValue 
) 
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri 
,	 
$num
 
)
 
;
 
sph 
. 
DefineSqlParameter "
(" #
$str# ,
,, -
	SqlDbType. 7
.7 8
NVarChar8 @
,@ A
$numB E
,E F
ParameterDirectionG Y
.Y Z
InputZ _
,_ `
userIda g
)g h
;h i
sph 
. 
DefineSqlParameter "
(" #
$str# /
,/ 0
	SqlDbType1 :
.: ;
NVarChar; C
,C D
-E F
$numF G
,G H
ParameterDirectionI [
.[ \
Input\ a
,a b
	claimTypec l
)l m
;m n
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
NVarChar< D
,D E
-F G
$numG H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c

claimValued n
)n o
;o p
int   
newID   
=   
Convert   
.    
ToInt32    '
(  ' (
sph  ( +
.  + ,
ExecuteScalar  , 9
(  9 :
)  : ;
)  ; <
;  < =
return!! 
newID!! 
;!! 
}"" 	
public'' 
static'' 
bool'' 
Delete'' !
(''! "
int''" %
id''& (
)''( )
{(( 	
SqlParameterHelper)) 
sph)) "
=))# $
new))% (
SqlParameterHelper))) ;
()); <
ConnectionString))< L
.))L M$
GetWriteConnectionString))M e
())e f
)))f g
,))g h
$str))i 
,	)) 
$num
)) 
)
)) 
;
)) 
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# (
,**( )
	SqlDbType*** 3
.**3 4
Int**4 7
,**7 8
ParameterDirection**9 K
.**K L
Input**L Q
,**Q R
id**S U
)**U V
;**V W
int++ 
rowsAffected++ 
=++ 
sph++ "
.++" #
ExecuteNonQuery++# 2
(++2 3
)++3 4
;++4 5
return,, 
(,, 
rowsAffected,,  
>,,! "
$num,,# $
),,$ %
;,,% &
}.. 	
public00 
static00 
bool00 
DeleteByUser00 '
(00' (
string00( .
userId00/ 5
)005 6
{11 	
SqlParameterHelper22 
sph22 "
=22# $
new22% (
SqlParameterHelper22) ;
(22; <
ConnectionString22< L
.22L M$
GetWriteConnectionString22M e
(22e f
)22f g
,22g h
$str	22i 
,
22 
$num
22 
)
22 
;
22 
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# ,
,33, -
	SqlDbType33. 7
.337 8
NVarChar338 @
,33@ A
$num33B E
,33E F
ParameterDirection33G Y
.33Y Z
Input33Z _
,33_ `
userId33a g
)33g h
;33h i
int44 
rowsAffected44 
=44 
sph44 "
.44" #
ExecuteNonQuery44# 2
(442 3
)443 4
;444 5
return55 
(55 
rowsAffected55  
>55! "
$num55# $
)55$ %
;55% &
}77 	
public99 
static99 
bool99 
DeleteByUser99 '
(99' (
string99( .
userId99/ 5
,995 6
string997 =
	claimType99> G
)99G H
{:: 	
SqlParameterHelper;; 
sph;; "
=;;# $
new;;% (
SqlParameterHelper;;) ;
(;;; <
ConnectionString;;< L
.;;L M$
GetWriteConnectionString;;M e
(;;e f
);;f g
,;;g h
$str	;;i 
,
;; 
$num
;; 
)
;; 
;
;; 
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# ,
,<<, -
	SqlDbType<<. 7
.<<7 8
NVarChar<<8 @
,<<@ A
$num<<B E
,<<E F
ParameterDirection<<G Y
.<<Y Z
Input<<Z _
,<<_ `
userId<<a g
)<<g h
;<<h i
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# /
,==/ 0
	SqlDbType==1 :
.==: ;
NVarChar==; C
,==C D
-==E F
$num==F G
,==G H
ParameterDirection==I [
.==[ \
Input==\ a
,==a b
	claimType==c l
)==l m
;==m n
int>> 
rowsAffected>> 
=>> 
sph>> "
.>>" #
ExecuteNonQuery>># 2
(>>2 3
)>>3 4
;>>4 5
return?? 
(?? 
rowsAffected??  
>??! "
$num??# $
)??$ %
;??% &
}AA 	
publicCC 
staticCC 
boolCC 
DeleteByUserCC '
(CC' (
stringCC( .
userIdCC/ 5
,CC5 6
stringCC7 =
	claimTypeCC> G
,CCG H
stringCCI O

claimValueCCP Z
)CCZ [
{DD 	
SqlParameterHelperEE 
sphEE "
=EE# $
newEE% (
SqlParameterHelperEE) ;
(EE; <
ConnectionStringEE< L
.EEL M$
GetWriteConnectionStringEEM e
(EEe f
)EEf g
,EEg h
$str	EEi 
,
EE 
$num
EE 
)
EE 
;
EE 
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# ,
,FF, -
	SqlDbTypeFF. 7
.FF7 8
NVarCharFF8 @
,FF@ A
$numFFB E
,FFE F
ParameterDirectionFFG Y
.FFY Z
InputFFZ _
,FF_ `
userIdFFa g
)FFg h
;FFh i
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# /
,GG/ 0
	SqlDbTypeGG1 :
.GG: ;
NVarCharGG; C
,GGC D
-GGE F
$numGGF G
,GGG H
ParameterDirectionGGI [
.GG[ \
InputGG\ a
,GGa b
	claimTypeGGc l
)GGl m
;GGm n
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
NVarCharHH< D
,HHD E
-HHF G
$numHHG H
,HHH I
ParameterDirectionHHJ \
.HH\ ]
InputHH] b
,HHb c

claimValueHHd n
)HHn o
;HHo p
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicNN 
staticNN 
boolNN 
DeleteBySiteNN '
(NN' (
GuidNN( ,
siteGuidNN- 5
)NN5 6
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$str	PPi 
,
PP 
$num
PP 
)
PP 
;
PP 
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
UniqueIdentifierQQ: J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
siteGuidQQf n
)QQn o
;QQo p
intRR 
rowsAffectedRR 
=RR 
sphRR "
.RR" #
ExecuteNonQueryRR# 2
(RR2 3
)RR3 4
;RR4 5
returnSS 
(SS 
rowsAffectedSS  
>SS! "
$numSS# $
)SS$ %
;SS% &
}UU 	
publicXX 
staticXX 
IDataReaderXX !
	GetByUserXX" +
(XX+ ,
stringXX, 2
userIdXX3 9
)XX9 :
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh 
,
ZZ 
$num
ZZ 
)
ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# ,
,[[, -
	SqlDbType[[. 7
.[[7 8
NVarChar[[8 @
,[[@ A
$num[[B E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
userId[[a g
)[[g h
;[[h i
return\\ 
sph\\ 
.\\ 
ExecuteReader\\ $
(\\$ %
)\\% &
;\\& '
}^^ 	
}bb 
}dd êF
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserLogins.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBUserLogins !
{ 
public 
static 
bool 
Create !
(! "
string" (
loginProvider) 6
,6 7
string8 >
providerKey? J
,J K
stringL R
userIdS Y
)Y Z
{ 
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri 
,	 
$num
 
)
 
;
 
sph 
. 
DefineSqlParameter "
(" #
$str# 3
,3 4
	SqlDbType5 >
.> ?
NVarChar? G
,G H
$numI L
,L M
ParameterDirectionN `
.` a
Inputa f
,f g
loginProviderh u
)u v
;v w
sph 
. 
DefineSqlParameter 
( 
$str (
,( )
	SqlDbType* 3
.3 4
NVarChar4 <
,< =
$num> A
,A B
ParameterDirectionC U
.U V
InputV [
,[ \
providerKey] h
)h i
;i j
sph   
.   
DefineSqlParameter   
(   
$str   #
,  # $
	SqlDbType  % .
.  . /
NVarChar  / 7
,  7 8
$num  9 <
,  < =
ParameterDirection  > P
.  P Q
Input  Q V
,  V W
userId  X ^
)  ^ _
;  _ `
int$$ 
rowsAffected$$ 
=$$ 
sph$$ "
.$$" #
ExecuteNonQuery$$# 2
($$2 3
)$$3 4
;$$4 5
return%% 
(%% 
rowsAffected%%  
>%%! "
$num%%# $
)%%$ %
;%%% &
}&& 
public00 
static00	 
bool00 
Delete00 
(00 
string00 "
loginProvider00# 0
,000 1
string002 8
providerKey009 D
,00D E
string00F L
userId00M S
)00S T
{11 
SqlParameterHelper22 
sph22 
=22 
new22 
SqlParameterHelper22  2
(222 3
ConnectionString223 C
.22C D$
GetWriteConnectionString22D \
(22\ ]
)22] ^
,22^ _
$str22` v
,22v w
$num22x y
)22y z
;22z {
sph33 
.33 
DefineSqlParameter33 
(33 
$str33 *
,33* +
	SqlDbType33, 5
.335 6
NVarChar336 >
,33> ?
$num33@ C
,33C D
ParameterDirection33E W
.33W X
Input33X ]
,33] ^
loginProvider33_ l
)33l m
;33m n
sph44 
.44 
DefineSqlParameter44 
(44 
$str44 (
,44( )
	SqlDbType44* 3
.443 4
NVarChar444 <
,44< =
$num44> A
,44A B
ParameterDirection44C U
.44U V
Input44V [
,44[ \
providerKey44] h
)44h i
;44i j
sph55 
.55 
DefineSqlParameter55 
(55 
$str55 #
,55# $
	SqlDbType55% .
.55. /
NVarChar55/ 7
,557 8
$num559 <
,55< =
ParameterDirection55> P
.55P Q
Input55Q V
,55V W
userId55X ^
)55^ _
;55_ `
int66 
rowsAffected66 
=66 
sph66 
.66 
ExecuteNonQuery66 )
(66) *
)66* +
;66+ ,
return77 	
(77
 
rowsAffected77 
>77 
$num77 
)77 
;77 
}99 
public;; 
static;; 
bool;; 
DeleteByUser;; '
(;;' (
string;;( .
userId;;/ 5
);;5 6
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str	==i 
,
== 
$num
== 
)
== 
;
== 
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># ,
,>>, -
	SqlDbType>>. 7
.>>7 8
NVarChar>>8 @
,>>@ A
$num>>B E
,>>E F
ParameterDirection>>G Y
.>>Y Z
Input>>Z _
,>>_ `
userId>>a g
)>>g h
;>>h i
int?? 
rowsAffected?? 
=?? 
sph?? "
.??" #
ExecuteNonQuery??# 2
(??2 3
)??3 4
;??4 5
return@@ 
(@@ 
rowsAffected@@  
>@@! "
$num@@# $
)@@$ %
;@@% &
}BB 	
publicDD 
staticDD 
boolDD 
DeleteBySiteDD '
(DD' (
GuidDD( ,
siteGuidDD- 5
)DD5 6
{EE 	
SqlParameterHelperFF 
sphFF "
=FF# $
newFF% (
SqlParameterHelperFF) ;
(FF; <
ConnectionStringFF< L
.FFL M$
GetWriteConnectionStringFFM e
(FFe f
)FFf g
,FFg h
$str	FFi 
,
FF 
$num
FF 
)
FF 
;
FF 
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# .
,GG. /
	SqlDbTypeGG0 9
.GG9 :
UniqueIdentifierGG: J
,GGJ K
ParameterDirectionGGL ^
.GG^ _
InputGG_ d
,GGd e
siteGuidGGf n
)GGn o
;GGo p
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
(II 
rowsAffectedII  
>II! "
$numII# $
)II$ %
;II% &
}KK 	
publicMM 
staticMM 
IDataReaderMM !
FindMM" &
(MM& '
stringMM' -
loginProviderMM. ;
,MM; <
stringMM= C
providerKeyMMD O
)MMO P
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$strOOh |
,OO| }
$numOO~ 
)	OO 
;
OO 
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 3
,PP3 4
	SqlDbTypePP5 >
.PP> ?
NVarCharPP? G
,PPG H
$numPPI L
,PPL M
ParameterDirectionPPN `
.PP` a
InputPPa f
,PPf g
loginProviderPPh u
)PPu v
;PPv w
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
providerKeyQQf q
)QQq r
;QQr s
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}TT 	
publicWW 
staticWW	 
IDataReaderWW 
	GetByUserWW %
(WW% &
stringWW& ,
userIdWW. 4
)WW4 5
{XX 
SqlParameterHelperYY 
sphYY "
=YY# $
newYY% (
SqlParameterHelperYY) ;
(YY; <
ConnectionStringYY< L
.YYL M#
GetReadConnectionStringYYM d
(YYd e
)YYe f
,YYf g
$str	YYh 
,
YY 
$num
YY 
)
YY 
;
YY 
sphZZ 
.ZZ 
DefineSqlParameterZZ 
(ZZ 
$strZZ #
,ZZ# $
	SqlDbTypeZZ% .
.ZZ. /
NVarCharZZ/ 7
,ZZ7 8
$numZZ9 <
,ZZ< =
ParameterDirectionZZ> P
.ZZP Q
InputZZQ V
,ZZV W
userIdZZX ^
)ZZ^ _
;ZZ_ `
return[[ 	
sph[[
 
.[[ 
ExecuteReader[[ 
([[ 
)[[ 
;[[ 
}]] 
}aa 
}cc á$
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SqlParameterCache.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

sealed 
class 
SqlParameterCache )
{ 
private 
SqlParameterCache !
(! "
)" #
{$ %
}& '
private"" 
static"" 
	Hashtable""  

paramCache""! +
="", -
	Hashtable"". 7
.""7 8
Synchronized""8 D
(""D E
new""E H
	Hashtable""I R
(""R S
)""S T
)""T U
;""U V
public'' 
static'' 
SqlParameter'' "
[''" #
]''# $
CloneParameters''% 4
(''4 5
SqlParameter''5 A
[''A B
]''B C
originalParameters''D V
)''V W
{(( 	
SqlParameter)) 
[)) 
])) 
clonedParameters)) +
=)), -
new)). 1
SqlParameter))2 >
[))> ?
originalParameters))? Q
.))Q R
Length))R X
]))X Y
;))Y Z
for++ 
(++ 
int++ 
i++ 
=++ 
$num++ 
,++ 
j++ 
=++ 
originalParameters++  2
.++2 3
Length++3 9
;++9 :
i++; <
<++= >
j++? @
;++@ A
i++B C
++++C E
)++E F
{,, 
clonedParameters--  
[--  !
i--! "
]--" #
=--$ %
(--& '
SqlParameter--' 3
)--3 4
(--4 5
(--5 6

ICloneable--6 @
)--@ A
originalParameters--A S
[--S T
i--T U
]--U V
)--V W
.--W X
Clone--X ]
(--] ^
)--^ _
;--_ `
}.. 
return00 
clonedParameters00 #
;00# $
}11 	
public>> 
static>> 
void>> "
AddParameterSetToCache>> 1
(>>1 2
string>>2 8
connectionString>>9 I
,>>I J
string>>K Q
storedProcedure>>R a
,>>a b
SqlParameter>>c o
[>>o p
]>>p q

parameters>>r |
)>>| }
{?? 	
string@@ 
key@@ 
=@@ 
CreateHashKey@@ &
(@@& '
connectionString@@' 7
,@@7 8
storedProcedure@@9 H
)@@H I
;@@I J

paramCacheAA 
[AA 
keyAA 
]AA 
=AA 

parametersAA (
;AA( )
}BB 	
publicGG 
staticGG 
SqlParameterGG "
[GG" #
]GG# $!
GetCachedParameterSetGG% :
(GG: ;
stringGG; A
connectionStringGGB R
,GGR S
stringGGT Z
storedProcedureGG[ j
)GGj k
{HH 	
stringII 
keyII 
=II 
CreateHashKeyII &
(II& '
connectionStringII' 7
,II7 8
storedProcedureII9 H
)IIH I
;III J
SqlParameterJJ 
[JJ 
]JJ 
cachedParametersJJ +
=JJ, -
(JJ. /
SqlParameterJJ/ ;
[JJ; <
]JJ< =
)JJ= >
(JJ> ?

paramCacheJJ? I
[JJI J
keyJJJ M
]JJM N
)JJN O
;JJO P
returnKK 
CloneParametersKK "
(KK" #
cachedParametersKK# 3
)KK3 4
;KK4 5
}LL 	
publicQQ 
staticQQ 
boolQQ  
IsParameterSetCachedQQ /
(QQ/ 0
stringQQ0 6
connectionStringQQ7 G
,QQG H
stringQQI O
storedProcedureQQP _
)QQ_ `
{RR 	
stringSS 
hashKeySS 
=SS 
CreateHashKeySS *
(SS* +
connectionStringSS+ ;
,SS; <
storedProcedureSS= L
)SSL M
;SSM N
returnTT 

paramCacheTT 
[TT 
hashKeyTT %
]TT% &
!=TT' )
nullTT* .
;TT. /
}UU 	
privateWW 
staticWW 
stringWW 
CreateHashKeyWW +
(WW+ ,
stringWW, 2
connectionStringWW3 C
,WWC D
stringWWE K
storedProcedureWWL [
)WW[ \
{XX 	
returnYY 
connectionStringYY #
+YY$ %
$strYY& )
+YY* +
storedProcedureYY, ;
;YY; <
}ZZ 	
}[[ 
}\\ àÏ
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBAuthorizeNetLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBAuthorizeNetLog )
{ 
public>> 
static>> 
int>> 
Create>>  
(>>  !
Guid?? 
rowGuid?? 
,?? 
DateTime@@ 

createdUtc@@ 
,@@  
GuidAA 
siteGuidAA 
,AA 
GuidBB 
userGuidBB 
,BB 
GuidCC 
	storeGuidCC 
,CC 
GuidDD 
cartGuidDD 
,DD 
stringEE 
rawResponseEE 
,EE 
stringFF 
responseCodeFF 
,FF  
stringGG 
responseReasonCodeGG %
,GG% &
stringHH 
reasonHH 
,HH 
stringII 
avsCodeII 
,II 
stringJJ 
ccvCodeJJ 
,JJ 
stringKK 
cavCodeKK 
,KK 
stringLL 
transactionIdLL  
,LL  !
stringMM 
transactionTypeMM "
,MM" #
stringNN 
methodNN 
,NN 
stringOO 
authCodeOO 
,OO 
decimalPP 
amountPP 
,PP 
decimalQQ 
taxQQ 
,QQ 
decimalRR 
dutyRR 
,RR 
decimalSS 
freightSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$str	UUi 
,
UU 
$num
UU 
)
UU 
;
UU 
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# -
,VV- .
	SqlDbTypeVV/ 8
.VV8 9
UniqueIdentifierVV9 I
,VVI J
ParameterDirectionVVK ]
.VV] ^
InputVV^ c
,VVc d
rowGuidVVe l
)VVl m
;VVm n
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 0
,WW0 1
	SqlDbTypeWW2 ;
.WW; <
DateTimeWW< D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _

createdUtcWW` j
)WWj k
;WWk l
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
siteGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
UniqueIdentifierYY: J
,YYJ K
ParameterDirectionYYL ^
.YY^ _
InputYY_ d
,YYd e
userGuidYYf n
)YYn o
;YYo p
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# /
,ZZ/ 0
	SqlDbTypeZZ1 :
.ZZ: ;
UniqueIdentifierZZ; K
,ZZK L
ParameterDirectionZZM _
.ZZ_ `
InputZZ` e
,ZZe f
	storeGuidZZg p
)ZZp q
;ZZq r
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# .
,[[. /
	SqlDbType[[0 9
.[[9 :
UniqueIdentifier[[: J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
cartGuid[[f n
)[[n o
;[[o p
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 1
,\\1 2
	SqlDbType\\3 <
.\\< =
NVarChar\\= E
,\\E F
-\\G H
$num\\H I
,\\I J
ParameterDirection\\K ]
.\\] ^
Input\\^ c
,\\c d
rawResponse\\e p
)\\p q
;\\q r
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 2
,]]2 3
	SqlDbType]]4 =
.]]= >
NChar]]> C
,]]C D
$num]]E F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
responseCode]]b n
)]]n o
;]]o p
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 8
,^^8 9
	SqlDbType^^: C
.^^C D
NVarChar^^D L
,^^L M
$num^^N P
,^^P Q
ParameterDirection^^R d
.^^d e
Input^^e j
,^^j k
responseReasonCode^^l ~
)^^~ 
;	^^ 
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
NVarChar__8 @
,__@ A
-__B C
$num__C D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _
reason__` f
)__f g
;__g h
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# -
,``- .
	SqlDbType``/ 8
.``8 9
NVarChar``9 A
,``A B
$num``C E
,``E F
ParameterDirection``G Y
.``Y Z
Input``Z _
,``_ `
avsCode``a h
)``h i
;``i j
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# -
,aa- .
	SqlDbTypeaa/ 8
.aa8 9
NCharaa9 >
,aa> ?
$numaa@ A
,aaA B
ParameterDirectionaaC U
.aaU V
InputaaV [
,aa[ \
ccvCodeaa] d
)aad e
;aae f
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
NCharbb9 >
,bb> ?
$numbb@ A
,bbA B
ParameterDirectionbbC U
.bbU V
InputbbV [
,bb[ \
cavCodebb] d
)bbd e
;bbe f
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 3
,cc3 4
	SqlDbTypecc5 >
.cc> ?
NVarCharcc? G
,ccG H
$numccI K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
transactionIdccg t
)cct u
;ccu v
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 5
,dd5 6
	SqlDbTypedd7 @
.dd@ A
NVarCharddA I
,ddI J
$numddK M
,ddM N
ParameterDirectionddO a
.dda b
Inputddb g
,ddg h
transactionTypeddi x
)ddx y
;ddy z
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
NVarCharee8 @
,ee@ A
$numeeB D
,eeD E
ParameterDirectioneeF X
.eeX Y
InputeeY ^
,ee^ _
methodee` f
)eef g
;eeg h
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# .
,ff. /
	SqlDbTypeff0 9
.ff9 :
NVarCharff: B
,ffB C
$numffD F
,ffF G
ParameterDirectionffH Z
.ffZ [
Inputff[ `
,ff` a
authCodeffb j
)ffj k
;ffk l
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# ,
,gg, -
	SqlDbTypegg. 7
.gg7 8
Decimalgg8 ?
,gg? @
ParameterDirectionggA S
.ggS T
InputggT Y
,ggY Z
amountgg[ a
)gga b
;ggb c
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# )
,hh) *
	SqlDbTypehh+ 4
.hh4 5
Decimalhh5 <
,hh< =
ParameterDirectionhh> P
.hhP Q
InputhhQ V
,hhV W
taxhhX [
)hh[ \
;hh\ ]
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# *
,ii* +
	SqlDbTypeii, 5
.ii5 6
Decimalii6 =
,ii= >
ParameterDirectionii? Q
.iiQ R
InputiiR W
,iiW X
dutyiiY ]
)ii] ^
;ii^ _
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# -
,jj- .
	SqlDbTypejj/ 8
.jj8 9
Decimaljj9 @
,jj@ A
ParameterDirectionjjB T
.jjT U
InputjjU Z
,jjZ [
freightjj\ c
)jjc d
;jjd e
intkk 
rowsAffectedkk 
=kk 
sphkk "
.kk" #
ExecuteNonQuerykk# 2
(kk2 3
)kk3 4
;kk4 5
returnll 
rowsAffectedll 
;ll  
}nn 	
public
 
static
 
bool
 
Update
 !
(
! "
Guid
 
rowGuid
 
,
 
Guid
 
siteGuid
 
,
 
Guid
 
userGuid
 
,
 
Guid
 
	storeGuid
 
,
 
Guid
 
cartGuid
 
,
 
string
 
rawResponse
 
,
 
string
 
responseCode
 
,
  
string
  
responseReasonCode
 %
,
% &
string
 
reason
 
,
 
string
 
avsCode
 
,
 
string
 
ccvCode
 
,
 
string
 
cavCode
 
,
 
string
 
transactionId
  
,
  !
string
 
transactionType
 "
,
" #
string
 
method
 
,
 
string
 
authCode
 
,
 
decimal
 
amount
 
,
 
decimal
 
tax
 
,
 
decimal
 
duty
 
,
 
decimal
 
freight
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # -
,
  - .
	SqlDbType
  / 8
.
  8 9
UniqueIdentifier
  9 I
,
  I J 
ParameterDirection
  K ]
.
  ] ^
Input
  ^ c
,
  c d
rowGuid
  e l
)
  l m
;
  m n
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# .
,
¡¡. /
	SqlDbType
¡¡0 9
.
¡¡9 :
UniqueIdentifier
¡¡: J
,
¡¡J K 
ParameterDirection
¡¡L ^
.
¡¡^ _
Input
¡¡_ d
,
¡¡d e
siteGuid
¡¡f n
)
¡¡n o
;
¡¡o p
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
UniqueIdentifier
¢¢: J
,
¢¢J K 
ParameterDirection
¢¢L ^
.
¢¢^ _
Input
¢¢_ d
,
¢¢d e
userGuid
¢¢f n
)
¢¢n o
;
¢¢o p
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# /
,
££/ 0
	SqlDbType
££1 :
.
££: ;
UniqueIdentifier
££; K
,
££K L 
ParameterDirection
££M _
.
££_ `
Input
££` e
,
££e f
	storeGuid
££g p
)
££p q
;
££q r
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# .
,
¤¤. /
	SqlDbType
¤¤0 9
.
¤¤9 :
UniqueIdentifier
¤¤: J
,
¤¤J K 
ParameterDirection
¤¤L ^
.
¤¤^ _
Input
¤¤_ d
,
¤¤d e
cartGuid
¤¤f n
)
¤¤n o
;
¤¤o p
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 1
,
¥¥1 2
	SqlDbType
¥¥3 <
.
¥¥< =
NVarChar
¥¥= E
,
¥¥E F
-
¥¥G H
$num
¥¥H I
,
¥¥I J 
ParameterDirection
¥¥K ]
.
¥¥] ^
Input
¥¥^ c
,
¥¥c d
rawResponse
¥¥e p
)
¥¥p q
;
¥¥q r
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# 2
,
¦¦2 3
	SqlDbType
¦¦4 =
.
¦¦= >
NChar
¦¦> C
,
¦¦C D
$num
¦¦E F
,
¦¦F G 
ParameterDirection
¦¦H Z
.
¦¦Z [
Input
¦¦[ `
,
¦¦` a
responseCode
¦¦b n
)
¦¦n o
;
¦¦o p
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 8
,
§§8 9
	SqlDbType
§§: C
.
§§C D
NVarChar
§§D L
,
§§L M
$num
§§N P
,
§§P Q 
ParameterDirection
§§R d
.
§§d e
Input
§§e j
,
§§j k 
responseReasonCode
§§l ~
)
§§~ 
;§§ 
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# ,
,
¨¨, -
	SqlDbType
¨¨. 7
.
¨¨7 8
NVarChar
¨¨8 @
,
¨¨@ A
-
¨¨B C
$num
¨¨C D
,
¨¨D E 
ParameterDirection
¨¨F X
.
¨¨X Y
Input
¨¨Y ^
,
¨¨^ _
reason
¨¨` f
)
¨¨f g
;
¨¨g h
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# -
,
©©- .
	SqlDbType
©©/ 8
.
©©8 9
NVarChar
©©9 A
,
©©A B
$num
©©C E
,
©©E F 
ParameterDirection
©©G Y
.
©©Y Z
Input
©©Z _
,
©©_ `
avsCode
©©a h
)
©©h i
;
©©i j
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# -
,
ªª- .
	SqlDbType
ªª/ 8
.
ªª8 9
NChar
ªª9 >
,
ªª> ?
$num
ªª@ A
,
ªªA B 
ParameterDirection
ªªC U
.
ªªU V
Input
ªªV [
,
ªª[ \
ccvCode
ªª] d
)
ªªd e
;
ªªe f
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# -
,
««- .
	SqlDbType
««/ 8
.
««8 9
NChar
««9 >
,
««> ?
$num
««@ A
,
««A B 
ParameterDirection
««C U
.
««U V
Input
««V [
,
««[ \
cavCode
««] d
)
««d e
;
««e f
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 3
,
¬¬3 4
	SqlDbType
¬¬5 >
.
¬¬> ?
NVarChar
¬¬? G
,
¬¬G H
$num
¬¬I K
,
¬¬K L 
ParameterDirection
¬¬M _
.
¬¬_ `
Input
¬¬` e
,
¬¬e f
transactionId
¬¬g t
)
¬¬t u
;
¬¬u v
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# 5
,
­­5 6
	SqlDbType
­­7 @
.
­­@ A
NVarChar
­­A I
,
­­I J
$num
­­K M
,
­­M N 
ParameterDirection
­­O a
.
­­a b
Input
­­b g
,
­­g h
transactionType
­­i x
)
­­x y
;
­­y z
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# ,
,
®®, -
	SqlDbType
®®. 7
.
®®7 8
NVarChar
®®8 @
,
®®@ A
$num
®®B D
,
®®D E 
ParameterDirection
®®F X
.
®®X Y
Input
®®Y ^
,
®®^ _
method
®®` f
)
®®f g
;
®®g h
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
NVarChar
¯¯: B
,
¯¯B C
$num
¯¯D F
,
¯¯F G 
ParameterDirection
¯¯H Z
.
¯¯Z [
Input
¯¯[ `
,
¯¯` a
authCode
¯¯b j
)
¯¯j k
;
¯¯k l
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# ,
,
°°, -
	SqlDbType
°°. 7
.
°°7 8
Decimal
°°8 ?
,
°°? @ 
ParameterDirection
°°A S
.
°°S T
Input
°°T Y
,
°°Y Z
amount
°°[ a
)
°°a b
;
°°b c
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# )
,
±±) *
	SqlDbType
±±+ 4
.
±±4 5
Decimal
±±5 <
,
±±< = 
ParameterDirection
±±> P
.
±±P Q
Input
±±Q V
,
±±V W
tax
±±X [
)
±±[ \
;
±±\ ]
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# *
,
²²* +
	SqlDbType
²², 5
.
²²5 6
Decimal
²²6 =
,
²²= > 
ParameterDirection
²²? Q
.
²²Q R
Input
²²R W
,
²²W X
duty
²²Y ]
)
²²] ^
;
²²^ _
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# -
,
³³- .
	SqlDbType
³³/ 8
.
³³8 9
Decimal
³³9 @
,
³³@ A 
ParameterDirection
³³B T
.
³³T U
Input
³³U Z
,
³³Z [
freight
³³\ c
)
³³c d
;
³³d e
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ "
.
´´" #
ExecuteNonQuery
´´# 2
(
´´2 3
)
´´3 4
;
´´4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
$num
µµ# $
)
µµ$ %
;
µµ% &
}
·· 	
public
¾¾ 
static
¾¾ 
bool
¾¾ 
Delete
¾¾ !
(
¾¾! "
Guid
¾¾" &
rowGuid
¾¾' .
)
¾¾. /
{
¿¿ 	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M&
GetWriteConnectionString
ÀÀM e
(
ÀÀe f
)
ÀÀf g
,
ÀÀg h
$strÀÀi 
,ÀÀ 
$numÀÀ 
)ÀÀ 
;ÀÀ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# -
,
ÁÁ- .
	SqlDbType
ÁÁ/ 8
.
ÁÁ8 9
UniqueIdentifier
ÁÁ9 I
,
ÁÁI J 
ParameterDirection
ÁÁK ]
.
ÁÁ] ^
Input
ÁÁ^ c
,
ÁÁc d
rowGuid
ÁÁe l
)
ÁÁl m
;
ÁÁm n
int
ÂÂ 
rowsAffected
ÂÂ 
=
ÂÂ 
sph
ÂÂ "
.
ÂÂ" #
ExecuteNonQuery
ÂÂ# 2
(
ÂÂ2 3
)
ÂÂ3 4
;
ÂÂ4 5
return
ÃÃ 
(
ÃÃ 
rowsAffected
ÃÃ  
>
ÃÃ! "
$num
ÃÃ# $
)
ÃÃ$ %
;
ÃÃ% &
}
ÅÅ 	
public
ËË 
static
ËË 
IDataReader
ËË !
GetOne
ËË" (
(
ËË( )
Guid
ËË) -
rowGuid
ËË. 5
)
ËË5 6
{
ÌÌ 	 
SqlParameterHelper
ÍÍ 
sph
ÍÍ "
=
ÍÍ# $
new
ÍÍ% ( 
SqlParameterHelper
ÍÍ) ;
(
ÍÍ; <
ConnectionString
ÍÍ< L
.
ÍÍL M%
GetReadConnectionString
ÍÍM d
(
ÍÍd e
)
ÍÍe f
,
ÍÍf g
$strÍÍh 
,ÍÍ 
$numÍÍ 
)ÍÍ 
;ÍÍ 
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# -
,
ÎÎ- .
	SqlDbType
ÎÎ/ 8
.
ÎÎ8 9
UniqueIdentifier
ÎÎ9 I
,
ÎÎI J 
ParameterDirection
ÎÎK ]
.
ÎÎ] ^
Input
ÎÎ^ c
,
ÎÎc d
rowGuid
ÎÎe l
)
ÎÎl m
;
ÎÎm n
return
ÏÏ 
sph
ÏÏ 
.
ÏÏ 
ExecuteReader
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
;
ÏÏ& '
}
ÑÑ 	
public
×× 
static
×× 
IDataReader
×× !
	GetByCart
××" +
(
××+ ,
Guid
××, 0
cartGuid
××1 9
)
××9 :
{
ØØ 	 
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$strÙÙh 
,ÙÙ 
$numÙÙ 
)ÙÙ 
;ÙÙ 
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# .
,
ÚÚ. /
	SqlDbType
ÚÚ0 9
.
ÚÚ9 :
UniqueIdentifier
ÚÚ: J
,
ÚÚJ K 
ParameterDirection
ÚÚL ^
.
ÚÚ^ _
Input
ÚÚ_ d
,
ÚÚd e
cartGuid
ÚÚf n
)
ÚÚn o
;
ÚÚo p
return
ÛÛ 
sph
ÛÛ 
.
ÛÛ 
ExecuteReader
ÛÛ $
(
ÛÛ$ %
)
ÛÛ% &
;
ÛÛ& '
}
ÝÝ 	
public
ãã 
static
ãã 
int
ãã 
GetCount
ãã "
(
ãã" #
)
ãã# $
{
ää 	
return
ææ 
Convert
ææ 
.
ææ 
ToInt32
ææ "
(
ææ" #
	SqlHelper
ææ# ,
.
ææ, -
ExecuteScalar
ææ- :
(
ææ: ;
ConnectionString
çç  
.
çç  !%
GetReadConnectionString
çç! 8
(
çç8 9
)
çç9 :
,
çç: ;
CommandType
èè 
.
èè 
StoredProcedure
èè +
,
èè+ ,
$str
éé -
,
éé- .
null
êê 
)
êê 
)
êê 
;
êê 
}
ìì 	
public
ññ 
static
ññ 
IDataReader
ññ !
GetAll
ññ" (
(
ññ( )
)
ññ) *
{
òò 	
return
ôô 
	SqlHelper
ôô 
.
ôô 
ExecuteReader
ôô *
(
ôô* +
ConnectionString
õõ  
.
õõ  !%
GetReadConnectionString
õõ! 8
(
õõ8 9
)
õõ9 :
,
õõ: ;
CommandType
öö 
.
öö 
StoredProcedure
öö +
,
öö+ ,
$str
÷÷ .
,
÷÷. /
null
øø 
)
øø 
;
øø 
}
úú 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 
(
 
)
 
;
 
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
   	
}
¢¢ 
}¤¤ g
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbBannedIP.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBBannedIP "
{ 
public.. 
static.. 
int.. 
Add.. 
(.. 
string// 
bannedIP// 
,// 
DateTime00 
	bannedUtc00 
,00 
string11 
bannedReason11 
)11  
{22 	
SqlParameterHelper33 
sph33 "
=33# $
new33% (
SqlParameterHelper33) ;
(33; <
ConnectionString33< L
.33L M$
GetWriteConnectionString33M e
(33e f
)33f g
,33g h
$str	33i 
,
33 
$num
33 
)
33 
;
33 
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
NVarChar44: B
,44B C
$num44D F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
bannedIP44b j
)44j k
;44k l
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# /
,55/ 0
	SqlDbType551 :
.55: ;
DateTime55; C
,55C D
ParameterDirection55E W
.55W X
Input55X ]
,55] ^
	bannedUtc55_ h
)55h i
;55i j
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 2
,662 3
	SqlDbType664 =
.66= >
NVarChar66> F
,66F G
$num66H K
,66K L
ParameterDirection66M _
.66_ `
Input66` e
,66e f
bannedReason66g s
)66s t
;66t u
int77 
newID77 
=77 
Convert77 
.77  
ToInt3277  '
(77' (
sph77( +
.77+ ,
ExecuteScalar77, 9
(779 :
)77: ;
)77; <
;77< =
return88 
newID88 
;88 
}99 	
publicDD 
staticDD 
boolDD 
UpdateDD !
(DD! "
intEE 
rowIdEE 
,EE 
stringFF 
bannedIPFF 
,FF 
DateTimeGG 
	bannedUtcGG 
,GG 
stringHH 
bannedReasonHH 
)HH  
{II 	
SqlParameterHelperJJ 
sphJJ "
=JJ# $
newJJ% (
SqlParameterHelperJJ) ;
(JJ; <
ConnectionStringJJ< L
.JJL M$
GetWriteConnectionStringJJM e
(JJe f
)JJf g
,JJg h
$str	JJi 
,
JJ 
$num
JJ 
)
JJ 
;
JJ 
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
IntKK7 :
,KK: ;
ParameterDirectionKK< N
.KKN O
InputKKO T
,KKT U
rowIdKKV [
)KK[ \
;KK\ ]
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# .
,LL. /
	SqlDbTypeLL0 9
.LL9 :
NVarCharLL: B
,LLB C
$numLLD F
,LLF G
ParameterDirectionLLH Z
.LLZ [
InputLL[ `
,LL` a
bannedIPLLb j
)LLj k
;LLk l
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# /
,MM/ 0
	SqlDbTypeMM1 :
.MM: ;
DateTimeMM; C
,MMC D
ParameterDirectionMME W
.MMW X
InputMMX ]
,MM] ^
	bannedUtcMM_ h
)MMh i
;MMi j
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 2
,NN2 3
	SqlDbTypeNN4 =
.NN= >
NVarCharNN> F
,NNF G
$numNNH K
,NNK L
ParameterDirectionNNM _
.NN_ `
InputNN` e
,NNe f
bannedReasonNNg s
)NNs t
;NNt u
intOO 
rowsAffectedOO 
=OO 
sphOO "
.OO" #
ExecuteNonQueryOO# 2
(OO2 3
)OO3 4
;OO4 5
returnPP 
(PP 
rowsAffectedPP  
>PP! "
$numPP# $
)PP$ %
;PP% &
}QQ 	
publicXX 
staticXX 
boolXX 
DeleteXX !
(XX! "
intYY 
rowIdYY 
)YY 
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i 
,
[[ 
$num
[[ 
)
[[ 
;
[[ 
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
Int\\7 :
,\\: ;
ParameterDirection\\< N
.\\N O
Input\\O T
,\\T U
rowId\\V [
)\\[ \
;\\\ ]
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
$num^^# $
)^^$ %
;^^% &
}`` 	
publicff 
staticff 
IDataReaderff !
GetOneff" (
(ff( )
intgg 
rowIdgg 
)gg 
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M#
GetReadConnectionStringiiM d
(iid e
)iie f
,iif g
$str	iih 
,
ii 
$num
ii 
)
ii 
;
ii 
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# +
,jj+ ,
	SqlDbTypejj- 6
.jj6 7
Intjj7 :
,jj: ;
ParameterDirectionjj< N
.jjN O
InputjjO T
,jjT U
rowIdjjV [
)jj[ \
;jj\ ]
returnkk 
sphkk 
.kk 
ExecuteReaderkk $
(kk$ %
)kk% &
;kk& '
}ll 	
publicrr 
staticrr 
IDataReaderrr !
GeByIpAddressrr" /
(rr/ 0
stringrr0 6
	ipAddressrr7 @
)rr@ A
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M#
GetReadConnectionStringttM d
(ttd e
)tte f
,ttf g
$str	tth 
,
tt 
$num
tt 
)
tt 
;
tt 
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
NVarCharuu: B
,uuB C
$numuuD F
,uuF G
ParameterDirectionuuH Z
.uuZ [
Inputuu[ `
,uu` a
	ipAddressuub k
)uuk l
;uul m
returnvv 
sphvv 
.vv 
ExecuteReadervv $
(vv$ %
)vv% &
;vv& '
}ww 	
public~~ 
static~~ 
bool~~ 
IsBanned~~ #
(~~# $
string~~$ *
	ipAddress~~+ 4
)~~4 5
{ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
	ipAddress
b k
)
k l
;
l m
int
 
	foundRows
 
=
 
Convert
 #
.
# $
ToInt32
$ +
(
+ ,
sph
, /
.
/ 0
ExecuteScalar
0 =
(
= >
)
> ?
)
? @
;
@ A
return
 
(
 
	foundRows
 
>
 
$num
  !
)
! "
;
" #
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
)
# $
{
 	
return
 
Convert
 
.
 
ToInt32
 "
(
" #
	SqlHelper
# ,
.
, -
ExecuteScalar
- :
(
: ;
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 /
,
/ 0
null
 
)
 
)
 
;
 
}
 	
public
 
static
 
IDataReader
 !
GetAll
" (
(
( )
)
) *
{
 	
return
 
	SqlHelper
 
.
 
ExecuteReader
 *
(
* +
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 0
,
0 1
null
 
)
 
;
 
}
¡¡ 	
public
©© 
static
©© 
IDataReader
©© !
GetPage
©©" )
(
©©) *
int
ªª 

pageNumber
ªª 
,
ªª 
int
«« 
pageSize
«« 
,
«« 
out
¬¬ 
int
¬¬ 

totalPages
¬¬ 
)
¬¬ 
{
­­ 	

totalPages
®® 
=
®® 
$num
®® 
;
®® 
int
¯¯ 
	totalRows
¯¯ 
=
°° 
GetCount
°° 
(
°° 
)
°° 
;
°° 
if
²² 
(
²² 
pageSize
²² 
>
²² 
$num
²² 
)
²² 

totalPages
²² (
=
²²) *
	totalRows
²²+ 4
/
²²5 6
pageSize
²²7 ?
;
²²? @
if
´´ 
(
´´ 
	totalRows
´´ 
<=
´´ 
pageSize
´´ %
)
´´% &
{
µµ 

totalPages
¶¶ 
=
¶¶ 
$num
¶¶ 
;
¶¶ 
}
·· 
else
¸¸ 
{
¹¹ 
int
ºº 
	remainder
ºº 
;
ºº 
Math
»» 
.
»» 
DivRem
»» 
(
»» 
	totalRows
»» %
,
»»% &
pageSize
»»' /
,
»»/ 0
out
»»1 4
	remainder
»»5 >
)
»»> ?
;
»»? @
if
¼¼ 
(
¼¼ 
	remainder
¼¼ 
>
¼¼ 
$num
¼¼  !
)
¼¼! "
{
½½ 

totalPages
¾¾ 
+=
¾¾ !
$num
¾¾" #
;
¾¾# $
}
¿¿ 
}
ÀÀ  
SqlParameterHelper
ÂÂ 
sph
ÂÂ "
=
ÂÂ# $
new
ÂÂ% ( 
SqlParameterHelper
ÂÂ) ;
(
ÂÂ; <
ConnectionString
ÂÂ< L
.
ÂÂL M%
GetReadConnectionString
ÂÂM d
(
ÂÂd e
)
ÂÂe f
,
ÂÂf g
$strÂÂh 
,ÂÂ 
$numÂÂ 
)ÂÂ 
;ÂÂ 
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# 0
,
ÃÃ0 1
	SqlDbType
ÃÃ2 ;
.
ÃÃ; <
Int
ÃÃ< ?
,
ÃÃ? @ 
ParameterDirection
ÃÃA S
.
ÃÃS T
Input
ÃÃT Y
,
ÃÃY Z

pageNumber
ÃÃ[ e
)
ÃÃe f
;
ÃÃf g
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
Int
ÄÄ: =
,
ÄÄ= > 
ParameterDirection
ÄÄ? Q
.
ÄÄQ R
Input
ÄÄR W
,
ÄÄW X
pageSize
ÄÄY a
)
ÄÄa b
;
ÄÄb c
return
ÅÅ 
sph
ÅÅ 
.
ÅÅ 
ExecuteReader
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
;
ÅÅ& '
}
ÇÇ 	
}
ÏÏ 
}ÐÐ ï
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCategory.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBCategory "
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 

parentGuidDD 
,DD 
GuidEE 
siteGuidEE 
,EE 
GuidFF 
featureGuidFF 
,FF 
GuidGG 

moduleGuidGG 
,GG 
stringHH 
categoryHH 
,HH 
stringII 
descriptionII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
GuidKK 
	createdByKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$strMMi }
,MM} ~
$num	MM 
)
MM 
;
MM 
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
UniqueIdentifierOO< L
,OOL M
ParameterDirectionOON `
.OO` a
InputOOa f
,OOf g

parentGuidOOh r
)OOr s
;OOs t
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
featureGuidQQi t
)QQt u
;QQu v
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
UniqueIdentifierRR< L
,RRL M
ParameterDirectionRRN `
.RR` a
InputRRa f
,RRf g

moduleGuidRRh r
)RRr s
;RRs t
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
categorySSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
descriptionTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# /
,VV/ 0
	SqlDbTypeVV1 :
.VV: ;
UniqueIdentifierVV; K
,VVK L
ParameterDirectionVVM _
.VV_ `
InputVV` e
,VVe f
	createdByVVg p
)VVp q
;VVq r
intXX 
rowsAffectedXX 
=XX 
sphXX "
.XX" #
ExecuteNonQueryXX# 2
(XX2 3
)XX3 4
;XX4 5
returnYY 
rowsAffectedYY 
;YY  
}[[ 	
publichh 
statichh 
boolhh 
Updatehh !
(hh! "
Guidii 
guidii 
,ii 
Guidjj 

parentGuidjj 
,jj 
stringkk 
categorykk 
,kk 
stringll 
descriptionll 
,ll 
DateTimemm 
modifiedUtcmm  
,mm  !
Guidnn 

modifiedBynn 
)nn 
{oo 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M$
GetWriteConnectionStringppM e
(ppe f
)ppf g
,ppg h
$strppi }
,pp} ~
$num	pp 
)
pp 
;
pp 
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# *
,qq* +
	SqlDbTypeqq, 5
.qq5 6
UniqueIdentifierqq6 F
,qqF G
ParameterDirectionqqH Z
.qqZ [
Inputqq[ `
,qq` a
guidqqb f
)qqf g
;qqg h
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 0
,rr0 1
	SqlDbTyperr2 ;
.rr; <
UniqueIdentifierrr< L
,rrL M
ParameterDirectionrrN `
.rr` a
Inputrra f
,rrf g

parentGuidrrh r
)rrr s
;rrs t
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# .
,ss. /
	SqlDbTypess0 9
.ss9 :
NVarCharss: B
,ssB C
$numssD G
,ssG H
ParameterDirectionssI [
.ss[ \
Inputss\ a
,ssa b
categoryssc k
)ssk l
;ssl m
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 1
,tt1 2
	SqlDbTypett3 <
.tt< =
NVarChartt= E
,ttE F
-ttG H
$numttH I
,ttI J
ParameterDirectionttK ]
.tt] ^
Inputtt^ c
,ttc d
descriptiontte p
)ttp q
;ttq r
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# 1
,uu1 2
	SqlDbTypeuu3 <
.uu< =
DateTimeuu= E
,uuE F
ParameterDirectionuuG Y
.uuY Z
InputuuZ _
,uu_ `
modifiedUtcuua l
)uul m
;uum n
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 0
,vv0 1
	SqlDbTypevv2 ;
.vv; <
UniqueIdentifiervv< L
,vvL M
ParameterDirectionvvN `
.vv` a
Inputvva f
,vvf g

modifiedByvvh r
)vvr s
;vvs t
intww 
rowsAffectedww 
=ww 
sphww "
.ww" #
ExecuteNonQueryww# 2
(ww2 3
)ww3 4
;ww4 5
returnxx 
(xx 
rowsAffectedxx  
>xx! "
$numxx# $
)xx$ %
;xx% &
}zz 	
public|| 
static|| 
bool|| 
UpdateItemCount|| *
(||* +
Guid||+ /
guid||0 4
)||4 5
{}} 	
SqlParameterHelper~~ 
sph~~ "
=~~# $
new~~% (
SqlParameterHelper~~) ;
(~~; <
ConnectionString~~< L
.~~L M$
GetWriteConnectionString~~M e
(~~e f
)~~f g
,~~g h
$str	~~i 
,
~~ 
$num
~~ 
)
~~ 
;
~~ 
sph 
. 
DefineSqlParameter "
(" #
$str# *
,* +
	SqlDbType, 5
.5 6
UniqueIdentifier6 F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
guidb f
)f g
;g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$str
i }
,
} ~
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeletByModule
 (
(
( )
Guid
) -

moduleGuid
. 8
)
8 9
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
¥¥ 
static
¥¥ 
bool
¥¥ 
DeletByFeature
¥¥ )
(
¥¥) *
Guid
¥¥* .
featureGuid
¥¥/ :
)
¥¥: ;
{
¦¦ 	 
SqlParameterHelper
§§ 
sph
§§ "
=
§§# $
new
§§% ( 
SqlParameterHelper
§§) ;
(
§§; <
ConnectionString
§§< L
.
§§L M&
GetWriteConnectionString
§§M e
(
§§e f
)
§§f g
,
§§g h
$str§§i 
,§§ 
$num§§ 
)§§ 
;§§ 
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 1
,
¨¨1 2
	SqlDbType
¨¨3 <
.
¨¨< =
UniqueIdentifier
¨¨= M
,
¨¨M N 
ParameterDirection
¨¨O a
.
¨¨a b
Input
¨¨b g
,
¨¨g h
featureGuid
¨¨i t
)
¨¨t u
;
¨¨u v
int
©© 
rowsAffected
©© 
=
©© 
sph
©© "
.
©©" #
ExecuteNonQuery
©©# 2
(
©©2 3
)
©©3 4
;
©©4 5
return
ªª 
(
ªª 
rowsAffected
ªª  
>
ªª! "
$num
ªª# $
)
ªª$ %
;
ªª% &
}
«« 	
public
²² 
static
²² 
bool
²² 
DeletBySite
²² &
(
²²& '
Guid
²²' +
siteGuid
²², 4
)
²²4 5
{
³³ 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M&
GetWriteConnectionString
´´M e
(
´´e f
)
´´f g
,
´´g h
$str´´i 
,´´ 
$num´´ 
)´´ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
int
¶¶ 
rowsAffected
¶¶ 
=
¶¶ 
sph
¶¶ "
.
¶¶" #
ExecuteNonQuery
¶¶# 2
(
¶¶2 3
)
¶¶3 4
;
¶¶4 5
return
·· 
(
·· 
rowsAffected
··  
>
··! "
$num
··# $
)
··$ %
;
··% &
}
¸¸ 	
public
¾¾ 
static
¾¾ 
IDataReader
¾¾ !
GetOne
¾¾" (
(
¾¾( )
Guid
¾¾) -
guid
¾¾. 2
)
¾¾2 3
{
¿¿ 	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M%
GetReadConnectionString
ÀÀM d
(
ÀÀd e
)
ÀÀe f
,
ÀÀf g
$str
ÀÀh 
,ÀÀ 
$numÀÀ 
)ÀÀ 
;ÀÀ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# *
,
ÁÁ* +
	SqlDbType
ÁÁ, 5
.
ÁÁ5 6
UniqueIdentifier
ÁÁ6 F
,
ÁÁF G 
ParameterDirection
ÁÁH Z
.
ÁÁZ [
Input
ÁÁ[ `
,
ÁÁ` a
guid
ÁÁb f
)
ÁÁf g
;
ÁÁg h
return
ÂÂ 
sph
ÂÂ 
.
ÂÂ 
ExecuteReader
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÄÄ 	
public
ÆÆ 
static
ÆÆ 
IDataReader
ÆÆ !
GetByModule
ÆÆ" -
(
ÆÆ- .
Guid
ÆÆ. 2

moduleGuid
ÆÆ3 =
)
ÆÆ= >
{
ÇÇ 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh 
,ÈÈ 
$numÈÈ 
)ÈÈ 
;ÈÈ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 0
,
ÉÉ0 1
	SqlDbType
ÉÉ2 ;
.
ÉÉ; <
UniqueIdentifier
ÉÉ< L
,
ÉÉL M 
ParameterDirection
ÉÉN `
.
ÉÉ` a
Input
ÉÉa f
,
ÉÉf g

moduleGuid
ÉÉh r
)
ÉÉr s
;
ÉÉs t
return
ÊÊ 
sph
ÊÊ 
.
ÊÊ 
ExecuteReader
ÊÊ $
(
ÊÊ$ %
)
ÊÊ% &
;
ÊÊ& '
}
ÌÌ 	
public
ÑÑ 
static
ÑÑ 
int
ÑÑ 
GetCountByModule
ÑÑ *
(
ÑÑ* +
Guid
ÑÑ+ /

moduleGuid
ÑÑ0 :
)
ÑÑ: ;
{
ÒÒ 	 
SqlParameterHelper
ÓÓ 
sph
ÓÓ "
=
ÓÓ# $
new
ÓÓ% ( 
SqlParameterHelper
ÓÓ) ;
(
ÓÓ; <
ConnectionString
ÓÓ< L
.
ÓÓL M%
GetReadConnectionString
ÓÓM d
(
ÓÓd e
)
ÓÓe f
,
ÓÓf g
$strÓÓh 
,ÓÓ 
$numÓÓ 
)ÓÓ 
;ÓÓ 
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# 0
,
ÔÔ0 1
	SqlDbType
ÔÔ2 ;
.
ÔÔ; <
UniqueIdentifier
ÔÔ< L
,
ÔÔL M 
ParameterDirection
ÔÔN `
.
ÔÔ` a
Input
ÔÔa f
,
ÔÔf g

moduleGuid
ÔÔh r
)
ÔÔr s
;
ÔÔs t
return
ÕÕ 
Convert
ÕÕ 
.
ÕÕ 
ToInt32
ÕÕ "
(
ÕÕ" #
sph
ÕÕ# &
.
ÕÕ& '
ExecuteScalar
ÕÕ' 4
(
ÕÕ4 5
)
ÕÕ5 6
)
ÕÕ6 7
;
ÕÕ7 8
}
×× 	
}
ÙÙ 
}ÚÚ Þò
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBComment.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBComments "
{ 
public00 
static00 
int00 
Create00  
(00  !
Guid11 
guid11 
,11 
Guid22 

parentGuid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
featureGuid44 
,44 
Guid55 

moduleGuid55 
,55 
Guid66 
contentGuid66 
,66 
Guid77 
userGuid77 
,77 
string88 
title88 
,88 
string99 
userComment99 
,99 
string:: 
userName:: 
,:: 
string;; 
	userEmail;; 
,;; 
string<< 
userUrl<< 
,<< 
string== 
userIp== 
,== 
DateTime>> 

createdUtc>> 
,>>  
byte?? 
moderationStatus?? !
,??! "
Guid@@ 
moderatedBy@@ 
,@@ 
stringAA 
moderationReasonAA #
)AA# $
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$strCCi }
,CC} ~
$num	CC 
)
CC 
;
CC 
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# *
,DD* +
	SqlDbTypeDD, 5
.DD5 6
UniqueIdentifierDD6 F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
guidDDb f
)DDf g
;DDg h
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
UniqueIdentifierEE: J
,EEJ K
ParameterDirectionEEL ^
.EE^ _
InputEE_ d
,EEd e
siteGuidEEf n
)EEn o
;EEo p
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 0
,FF0 1
	SqlDbTypeFF2 ;
.FF; <
UniqueIdentifierFF< L
,FFL M
ParameterDirectionFFN `
.FF` a
InputFFa f
,FFf g

parentGuidFFh r
)FFr s
;FFs t
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 1
,GG1 2
	SqlDbTypeGG3 <
.GG< =
UniqueIdentifierGG= M
,GGM N
ParameterDirectionGGO a
.GGa b
InputGGb g
,GGg h
featureGuidGGi t
)GGt u
;GGu v
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
UniqueIdentifierHH< L
,HHL M
ParameterDirectionHHN `
.HH` a
InputHHa f
,HHf g

moduleGuidHHh r
)HHr s
;HHs t
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# 1
,II1 2
	SqlDbTypeII3 <
.II< =
UniqueIdentifierII= M
,IIM N
ParameterDirectionIIO a
.IIa b
InputIIb g
,IIg h
contentGuidIIi t
)IIt u
;IIu v
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
UniqueIdentifierJJ: J
,JJJ K
ParameterDirectionJJL ^
.JJ^ _
InputJJ_ d
,JJd e
userGuidJJf n
)JJn o
;JJo p
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
$numKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
titleKK` e
)KKe f
;KKf g
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
-LLG H
$numLLH I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
userCommentLLe p
)LLp q
;LLq r
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
NVarCharMM: B
,MMB C
$numMMD F
,MMF G
ParameterDirectionMMH Z
.MMZ [
InputMM[ `
,MM` a
userNameMMb j
)MMj k
;MMk l
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# /
,NN/ 0
	SqlDbTypeNN1 :
.NN: ;
NVarCharNN; C
,NNC D
$numNNE H
,NNH I
ParameterDirectionNNJ \
.NN\ ]
InputNN] b
,NNb c
	userEmailNNd m
)NNm n
;NNn o
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# -
,OO- .
	SqlDbTypeOO/ 8
.OO8 9
NVarCharOO9 A
,OOA B
$numOOC F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
userUrlOOb i
)OOi j
;OOj k
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
NVarCharPP8 @
,PP@ A
$numPPB D
,PPD E
ParameterDirectionPPF X
.PPX Y
InputPPY ^
,PP^ _
userIpPP` f
)PPf g
;PPg h
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 0
,QQ0 1
	SqlDbTypeQQ2 ;
.QQ; <
DateTimeQQ< D
,QQD E
ParameterDirectionQQF X
.QQX Y
InputQQY ^
,QQ^ _

createdUtcQQ` j
)QQj k
;QQk l
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 6
,RR6 7
	SqlDbTypeRR8 A
.RRA B
TinyIntRRB I
,RRI J
ParameterDirectionRRK ]
.RR] ^
InputRR^ c
,RRc d
moderationStatusRRe u
)RRu v
;RRv w
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 1
,SS1 2
	SqlDbTypeSS3 <
.SS< =
UniqueIdentifierSS= M
,SSM N
ParameterDirectionSSO a
.SSa b
InputSSb g
,SSg h
moderatedBySSi t
)SSt u
;SSu v
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 6
,TT6 7
	SqlDbTypeTT8 A
.TTA B
NVarCharTTB J
,TTJ K
$numTTL O
,TTO P
ParameterDirectionTTQ c
.TTc d
InputTTd i
,TTi j
moderationReasonTTk {
)TT{ |
;TT| }
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
rowsAffectedVV 
;VV  
}XX 	
publickk 
statickk 
boolkk 
Updatekk !
(kk! "
Guidll 
guidll 
,ll 
Guidmm 
userGuidmm 
,mm 
stringnn 
titlenn 
,nn 
stringoo 
userCommentoo 
,oo 
stringpp 
userNamepp 
,pp 
stringqq 
	userEmailqq 
,qq 
stringrr 
userUrlrr 
,rr 
stringss 
userIpss 
,ss 
DateTimett 

lastModUtctt 
,tt  
byteuu 
moderationStatusuu !
,uu! "
Guidvv 
moderatedByvv 
,vv 
stringww 
moderationReasonww #
)ww# $
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$stryyi }
,yy} ~
$num	yy 
)
yy 
;
yy 
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
UniqueIdentifierzz6 F
,zzF G
ParameterDirectionzzH Z
.zzZ [
Inputzz[ `
,zz` a
guidzzb f
)zzf g
;zzg h
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# .
,{{. /
	SqlDbType{{0 9
.{{9 :
UniqueIdentifier{{: J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
userGuid{{f n
){{n o
;{{o p
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# +
,||+ ,
	SqlDbType||- 6
.||6 7
NVarChar||7 ?
,||? @
$num||A D
,||D E
ParameterDirection||F X
.||X Y
Input||Y ^
,||^ _
title||` e
)||e f
;||f g
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 1
,}}1 2
	SqlDbType}}3 <
.}}< =
NVarChar}}= E
,}}E F
-}}G H
$num}}H I
,}}I J
ParameterDirection}}K ]
.}}] ^
Input}}^ c
,}}c d
userComment}}e p
)}}p q
;}}q r
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# .
,~~. /
	SqlDbType~~0 9
.~~9 :
NVarChar~~: B
,~~B C
$num~~D F
,~~F G
ParameterDirection~~H Z
.~~Z [
Input~~[ `
,~~` a
userName~~b j
)~~j k
;~~k l
sph 
. 
DefineSqlParameter "
(" #
$str# /
,/ 0
	SqlDbType1 :
.: ;
NVarChar; C
,C D
$numE H
,H I
ParameterDirectionJ \
.\ ]
Input] b
,b c
	userEmaild m
)m n
;n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
$num
C F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
userUrl
b i
)
i j
;
j k
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
userIp
` f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
DateTime
< D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _

lastModUtc
` j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
TinyInt
B I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
moderationStatus
e u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
moderatedBy
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
NVarChar
B J
,
J K
$num
L O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
moderationReason
k {
)
{ |
;
| }
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$str
i }
,
} ~
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByContent
 *
(
* +
Guid
+ /
contentGuid
0 ;
)
; <
{
 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M&
GetWriteConnectionString
  M e
(
  e f
)
  f g
,
  g h
$str  i 
,   
$num   
)   
;   
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 1
,
¡¡1 2
	SqlDbType
¡¡3 <
.
¡¡< =
UniqueIdentifier
¡¡= M
,
¡¡M N 
ParameterDirection
¡¡O a
.
¡¡a b
Input
¡¡b g
,
¡¡g h
contentGuid
¡¡i t
)
¡¡t u
;
¡¡u v
int
¢¢ 
rowsAffected
¢¢ 
=
¢¢ 
sph
¢¢ "
.
¢¢" #
ExecuteNonQuery
¢¢# 2
(
¢¢2 3
)
¢¢3 4
;
¢¢4 5
return
££ 
(
££ 
rowsAffected
££  
>
££! "
$num
££# $
)
££$ %
;
££% &
}
¥¥ 	
public
¬¬ 
static
¬¬ 
bool
¬¬ 
DeleteBySite
¬¬ '
(
¬¬' (
Guid
¬¬( ,
siteGuid
¬¬- 5
)
¬¬5 6
{
­­ 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M&
GetWriteConnectionString
®®M e
(
®®e f
)
®®f g
,
®®g h
$str®®i 
,®® 
$num®® 
)®® 
;®® 
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
UniqueIdentifier
¯¯: J
,
¯¯J K 
ParameterDirection
¯¯L ^
.
¯¯^ _
Input
¯¯_ d
,
¯¯d e
siteGuid
¯¯f n
)
¯¯n o
;
¯¯o p
int
°° 
rowsAffected
°° 
=
°° 
sph
°° "
.
°°" #
ExecuteNonQuery
°°# 2
(
°°2 3
)
°°3 4
;
°°4 5
return
±± 
(
±± 
rowsAffected
±±  
>
±±! "
$num
±±# $
)
±±$ %
;
±±% &
}
³³ 	
public
ºº 
static
ºº 
bool
ºº 
DeleteByFeature
ºº *
(
ºº* +
Guid
ºº+ /
featureGuid
ºº0 ;
)
ºº; <
{
»» 	 
SqlParameterHelper
¼¼ 
sph
¼¼ "
=
¼¼# $
new
¼¼% ( 
SqlParameterHelper
¼¼) ;
(
¼¼; <
ConnectionString
¼¼< L
.
¼¼L M&
GetWriteConnectionString
¼¼M e
(
¼¼e f
)
¼¼f g
,
¼¼g h
$str¼¼i 
,¼¼ 
$num¼¼ 
)¼¼ 
;¼¼ 
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# 1
,
½½1 2
	SqlDbType
½½3 <
.
½½< =
UniqueIdentifier
½½= M
,
½½M N 
ParameterDirection
½½O a
.
½½a b
Input
½½b g
,
½½g h
featureGuid
½½i t
)
½½t u
;
½½u v
int
¾¾ 
rowsAffected
¾¾ 
=
¾¾ 
sph
¾¾ "
.
¾¾" #
ExecuteNonQuery
¾¾# 2
(
¾¾2 3
)
¾¾3 4
;
¾¾4 5
return
¿¿ 
(
¿¿ 
rowsAffected
¿¿  
>
¿¿! "
$num
¿¿# $
)
¿¿$ %
;
¿¿% &
}
ÁÁ 	
public
ÈÈ 
static
ÈÈ 
bool
ÈÈ 
DeleteByModule
ÈÈ )
(
ÈÈ) *
Guid
ÈÈ* .

moduleGuid
ÈÈ/ 9
)
ÈÈ9 :
{
ÉÉ 	 
SqlParameterHelper
ÊÊ 
sph
ÊÊ "
=
ÊÊ# $
new
ÊÊ% ( 
SqlParameterHelper
ÊÊ) ;
(
ÊÊ; <
ConnectionString
ÊÊ< L
.
ÊÊL M&
GetWriteConnectionString
ÊÊM e
(
ÊÊe f
)
ÊÊf g
,
ÊÊg h
$strÊÊi 
,ÊÊ 
$numÊÊ 
)ÊÊ 
;ÊÊ 
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# 0
,
ËË0 1
	SqlDbType
ËË2 ;
.
ËË; <
UniqueIdentifier
ËË< L
,
ËËL M 
ParameterDirection
ËËN `
.
ËË` a
Input
ËËa f
,
ËËf g

moduleGuid
ËËh r
)
ËËr s
;
ËËs t
int
ÌÌ 
rowsAffected
ÌÌ 
=
ÌÌ 
sph
ÌÌ "
.
ÌÌ" #
ExecuteNonQuery
ÌÌ# 2
(
ÌÌ2 3
)
ÌÌ3 4
;
ÌÌ4 5
return
ÍÍ 
(
ÍÍ 
rowsAffected
ÍÍ  
>
ÍÍ! "
$num
ÍÍ# $
)
ÍÍ$ %
;
ÍÍ% &
}
ÏÏ 	
public
ÖÖ 
static
ÖÖ 
bool
ÖÖ 
DeleteByParent
ÖÖ )
(
ÖÖ) *
Guid
ÖÖ* .

parentGuid
ÖÖ/ 9
)
ÖÖ9 :
{
×× 	 
SqlParameterHelper
ØØ 
sph
ØØ "
=
ØØ# $
new
ØØ% ( 
SqlParameterHelper
ØØ) ;
(
ØØ; <
ConnectionString
ØØ< L
.
ØØL M&
GetWriteConnectionString
ØØM e
(
ØØe f
)
ØØf g
,
ØØg h
$strØØi 
,ØØ 
$numØØ 
)ØØ 
;ØØ 
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# 0
,
ÙÙ0 1
	SqlDbType
ÙÙ2 ;
.
ÙÙ; <
UniqueIdentifier
ÙÙ< L
,
ÙÙL M 
ParameterDirection
ÙÙN `
.
ÙÙ` a
Input
ÙÙa f
,
ÙÙf g

parentGuid
ÙÙh r
)
ÙÙr s
;
ÙÙs t
int
ÚÚ 
rowsAffected
ÚÚ 
=
ÚÚ 
sph
ÚÚ "
.
ÚÚ" #
ExecuteNonQuery
ÚÚ# 2
(
ÚÚ2 3
)
ÚÚ3 4
;
ÚÚ4 5
return
ÛÛ 
(
ÛÛ 
rowsAffected
ÛÛ  
>
ÛÛ! "
$num
ÛÛ# $
)
ÛÛ$ %
;
ÛÛ% &
}
ÝÝ 	
public
ãã 
static
ãã 
IDataReader
ãã !
GetOne
ãã" (
(
ãã( )
Guid
ãã) -
guid
ãã. 2
)
ãã2 3
{
ää 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M%
GetReadConnectionString
ååM d
(
ååd e
)
ååe f
,
ååf g
$str
ååh 
,åå 
$numåå 
)åå 
;åå 
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# *
,
ææ* +
	SqlDbType
ææ, 5
.
ææ5 6
UniqueIdentifier
ææ6 F
,
ææF G 
ParameterDirection
ææH Z
.
ææZ [
Input
ææ[ `
,
ææ` a
guid
ææb f
)
ææf g
;
ææg h
return
çç 
sph
çç 
.
çç 
ExecuteReader
çç $
(
çç$ %
)
çç% &
;
çç& '
}
éé 	
public
ïï 
static
ïï 
IDataReader
ïï !
GetByContentAsc
ïï" 1
(
ïï1 2
Guid
ïï2 6
contentGuid
ïï7 B
)
ïïB C
{
ðð 	 
SqlParameterHelper
ññ 
sph
ññ "
=
ññ# $
new
ññ% ( 
SqlParameterHelper
ññ) ;
(
ññ; <
ConnectionString
ññ< L
.
ññL M%
GetReadConnectionString
ññM d
(
ññd e
)
ññe f
,
ññf g
$strññh 
,ññ 
$numññ 
)ññ 
;ññ 
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 1
,
òò1 2
	SqlDbType
òò3 <
.
òò< =
UniqueIdentifier
òò= M
,
òòM N 
ParameterDirection
òòO a
.
òòa b
Input
òòb g
,
òòg h
contentGuid
òòi t
)
òòt u
;
òòu v
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
õõ 	
public
ûû 
static
ûû 
IDataReader
ûû !
GetByContentDesc
ûû" 2
(
ûû2 3
Guid
ûû3 7
contentGuid
ûû8 C
)
ûûC D
{
üü 	 
SqlParameterHelper
ýý 
sph
ýý "
=
ýý# $
new
ýý% ( 
SqlParameterHelper
ýý) ;
(
ýý; <
ConnectionString
ýý< L
.
ýýL M%
GetReadConnectionString
ýýM d
(
ýýd e
)
ýýe f
,
ýýf g
$strýýh 
,ýý 
$numýý 
)ýý 
;ýý 
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# 1
,
þþ1 2
	SqlDbType
þþ3 <
.
þþ< =
UniqueIdentifier
þþ= M
,
þþM N 
ParameterDirection
þþO a
.
þþa b
Input
þþb g
,
þþg h
contentGuid
þþi t
)
þþt u
;
þþu v
return
ÿÿ 
sph
ÿÿ 
.
ÿÿ 
ExecuteReader
ÿÿ $
(
ÿÿ$ %
)
ÿÿ% &
;
ÿÿ& '
}
 	
public
 
static
 
IDataReader
 !
GetByParentAsc
" 0
(
0 1
Guid
1 5

parentGuid
6 @
)
@ A
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

parentGuid
h r
)
r s
;
s t
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetByParentDesc
" 1
(
1 2
Guid
2 6

parentGuid
7 A
)
A B
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

parentGuid
h r
)
r s
;
s t
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
contentGuid
( 3
,
3 4
int
5 8
moderationStatus
9 I
)
I J
{
 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h 
,   
$num   
)   
;   
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 1
,
¡¡1 2
	SqlDbType
¡¡3 <
.
¡¡< =
UniqueIdentifier
¡¡= M
,
¡¡M N 
ParameterDirection
¡¡O a
.
¡¡a b
Input
¡¡b g
,
¡¡g h
contentGuid
¡¡i t
)
¡¡t u
;
¡¡u v
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 6
,
¢¢6 7
	SqlDbType
¢¢8 A
.
¢¢A B
TinyInt
¢¢B I
,
¢¢I J 
ParameterDirection
¢¢K ]
.
¢¢] ^
Input
¢¢^ c
,
¢¢c d
moderationStatus
¢¢e u
)
¢¢u v
;
¢¢v w
return
¤¤ 
Convert
¤¤ 
.
¤¤ 
ToInt32
¤¤ "
(
¤¤" #
sph
¤¤# &
.
¤¤& '
ExecuteScalar
¤¤' 4
(
¤¤4 5
)
¤¤5 6
)
¤¤6 7
;
¤¤7 8
}
¦¦ 	
public
¨¨ 
static
¨¨ 
int
¨¨ 
GetCountByModule
¨¨ *
(
¨¨* +
Guid
¨¨+ /

moduleGuid
¨¨0 :
,
¨¨: ;
int
¨¨< ?
moderationStatus
¨¨@ P
)
¨¨P Q
{
©© 	 
SqlParameterHelper
ªª 
sph
ªª "
=
ªª# $
new
ªª% ( 
SqlParameterHelper
ªª) ;
(
ªª; <
ConnectionString
ªª< L
.
ªªL M%
GetReadConnectionString
ªªM d
(
ªªd e
)
ªªe f
,
ªªf g
$strªªh 
,ªª 
$numªª 
)ªª 
;ªª 
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 0
,
««0 1
	SqlDbType
««2 ;
.
««; <
UniqueIdentifier
««< L
,
««L M 
ParameterDirection
««N `
.
««` a
Input
««a f
,
««f g

moduleGuid
««h r
)
««r s
;
««s t
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 6
,
¬¬6 7
	SqlDbType
¬¬8 A
.
¬¬A B
TinyInt
¬¬B I
,
¬¬I J 
ParameterDirection
¬¬K ]
.
¬¬] ^
Input
¬¬^ c
,
¬¬c d
moderationStatus
¬¬e u
)
¬¬u v
;
¬¬v w
return
®® 
Convert
®® 
.
®® 
ToInt32
®® "
(
®®" #
sph
®®# &
.
®®& '
ExecuteScalar
®®' 4
(
®®4 5
)
®®5 6
)
®®6 7
;
®®7 8
}
°° 	
public
²² 
static
²² 
int
²² 
GetCountBySite
²² (
(
²²( )
Guid
²²) -
siteGuid
²². 6
)
²²6 7
{
³³ 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M%
GetReadConnectionString
´´M d
(
´´d e
)
´´e f
,
´´f g
$str´´h 
,´´ 
$num´´ 
)´´ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
return
¸¸ 
Convert
¸¸ 
.
¸¸ 
ToInt32
¸¸ "
(
¸¸" #
sph
¸¸# &
.
¸¸& '
ExecuteScalar
¸¸' 4
(
¸¸4 5
)
¸¸5 6
)
¸¸6 7
;
¸¸7 8
}
ºº 	
}
ÀÀ 
}ÂÂ Û
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCommerceReport.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBCommerceReport (
{ 
public;; 
static;; 
int;; 
Create;;  
(;;  !
Guid<< 
rowGuid<< 
,<< 
Guid== 
siteGuid== 
,== 
Guid>> 
userGuid>> 
,>> 
Guid?? 
featureGuid?? 
,?? 
Guid@@ 

moduleGuid@@ 
,@@ 
stringAA 
moduleTitleAA 
,AA 
GuidBB 
	orderGuidBB 
,BB 
GuidCC 
itemGuidCC 
,CC 
stringDD 
itemNameDD 
,DD 
intEE 
quantityEE 
,EE 
decimalFF 
priceFF 
,FF 
decimalGG 
subTotalGG 
,GG 
DateTimeHH 
orderDateUtcHH !
,HH! "
stringII 
paymentMethodII  
,II  !
stringJJ 
	iPAddressJJ 
,JJ 
stringKK 
adminOrderLinkKK !
,KK! "
stringLL 
userOrderLinkLL  
,LL  !
DateTimeMM 
rowCreatedUtcMM "
,MM" #
boolNN 
includeInAggregateNN #
)NN# $
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$str	PPi 
,
PP 
$num
PP 
)
PP 
;
PP 
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
UniqueIdentifierQQ9 I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
rowGuidQQe l
)QQl m
;QQm n
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
UniqueIdentifierRR: J
,RRJ K
ParameterDirectionRRL ^
.RR^ _
InputRR_ d
,RRd e
siteGuidRRf n
)RRn o
;RRo p
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
userGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
UniqueIdentifierTT= M
,TTM N
ParameterDirectionTTO a
.TTa b
InputTTb g
,TTg h
featureGuidTTi t
)TTt u
;TTu v
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
UniqueIdentifierUU< L
,UUL M
ParameterDirectionUUN `
.UU` a
InputUUa f
,UUf g

moduleGuidUUh r
)UUr s
;UUs t
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 1
,VV1 2
	SqlDbTypeVV3 <
.VV< =
NVarCharVV= E
,VVE F
$numVVG J
,VVJ K
ParameterDirectionVVL ^
.VV^ _
InputVV_ d
,VVd e
moduleTitleVVf q
)VVq r
;VVr s
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
UniqueIdentifierWW; K
,WWK L
ParameterDirectionWWM _
.WW_ `
InputWW` e
,WWe f
	orderGuidWWg p
)WWp q
;WWq r
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
itemGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
NVarCharYY: B
,YYB C
$numYYD G
,YYG H
ParameterDirectionYYI [
.YY[ \
InputYY\ a
,YYa b
itemNameYYc k
)YYk l
;YYl m
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# .
,ZZ. /
	SqlDbTypeZZ0 9
.ZZ9 :
IntZZ: =
,ZZ= >
ParameterDirectionZZ? Q
.ZZQ R
InputZZR W
,ZZW X
quantityZZY a
)ZZa b
;ZZb c
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# +
,[[+ ,
	SqlDbType[[- 6
.[[6 7
Decimal[[7 >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
price[[Z _
)[[_ `
;[[` a
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
Decimal\\: A
,\\A B
ParameterDirection\\C U
.\\U V
Input\\V [
,\\[ \
subTotal\\] e
)\\e f
;\\f g
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 2
,]]2 3
	SqlDbType]]4 =
.]]= >
DateTime]]> F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
orderDateUtc]]b n
)]]n o
;]]o p
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 3
,^^3 4
	SqlDbType^^5 >
.^^> ?
NVarChar^^? G
,^^G H
$num^^I K
,^^K L
ParameterDirection^^M _
.^^_ `
Input^^` e
,^^e f
paymentMethod^^g t
)^^t u
;^^u v
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# /
,__/ 0
	SqlDbType__1 :
.__: ;
NVarChar__; C
,__C D
$num__E H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
	iPAddress__d m
)__m n
;__n o
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 4
,``4 5
	SqlDbType``6 ?
.``? @
NVarChar``@ H
,``H I
$num``J M
,``M N
ParameterDirection``O a
.``a b
Input``b g
,``g h
adminOrderLink``i w
)``w x
;``x y
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 3
,aa3 4
	SqlDbTypeaa5 >
.aa> ?
NVarCharaa? G
,aaG H
$numaaI L
,aaL M
ParameterDirectionaaN `
.aa` a
Inputaaa f
,aaf g
userOrderLinkaah u
)aau v
;aav w
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 3
,bb3 4
	SqlDbTypebb5 >
.bb> ?
DateTimebb? G
,bbG H
ParameterDirectionbbI [
.bb[ \
Inputbb\ a
,bba b
rowCreatedUtcbbc p
)bbp q
;bbq r
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 8
,cc8 9
	SqlDbTypecc: C
.ccC D
BitccD G
,ccG H
ParameterDirectionccI [
.cc[ \
Inputcc\ a
,cca b
includeInAggregateccc u
)ccu v
;ccv w
intdd 
rowsAffecteddd 
=dd 
sphdd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
returnee 
rowsAffectedee 
;ee  
}gg 	
publicnn 
staticnn 
boolnn 
Deletenn !
(nn! "
Guidnn" &
rowGuidnn' .
)nn. /
{oo 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M$
GetWriteConnectionStringppM e
(ppe f
)ppf g
,ppg h
$str	ppi 
,
pp 
$num
pp 
)
pp 
;
pp 
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# -
,qq- .
	SqlDbTypeqq/ 8
.qq8 9
UniqueIdentifierqq9 I
,qqI J
ParameterDirectionqqK ]
.qq] ^
Inputqq^ c
,qqc d
rowGuidqqe l
)qql m
;qqm n
intrr 
rowsAffectedrr 
=rr 
sphrr "
.rr" #
ExecuteNonQueryrr# 2
(rr2 3
)rr3 4
;rr4 5
returnss 
(ss 
rowsAffectedss  
>ss! "
$numss# $
)ss$ %
;ss% &
}uu 	
public|| 
static|| 
bool|| 
DeleteBySite|| '
(||' (
Guid||( ,
siteGuid||- 5
)||5 6
{}} 	
SqlParameterHelper~~ 
sph~~ "
=~~# $
new~~% (
SqlParameterHelper~~) ;
(~~; <
ConnectionString~~< L
.~~L M$
GetWriteConnectionString~~M e
(~~e f
)~~f g
,~~g h
$str	~~i 
,
~~ 
$num
~~ 
)
~~ 
;
~~ 
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
siteGuidf n
)n o
;o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByUser
 '
(
' (
Guid
( ,
userGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByFeature
 *
(
* +
Guid
+ /
featureGuid
0 ;
)
; <
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
¦¦ 
static
¦¦ 
bool
¦¦ 
DeleteByModule
¦¦ )
(
¦¦) *
Guid
¦¦* .

moduleGuid
¦¦/ 9
)
¦¦9 :
{
§§ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M&
GetWriteConnectionString
¨¨M e
(
¨¨e f
)
¨¨f g
,
¨¨g h
$str¨¨i 
,¨¨ 
$num¨¨ 
)¨¨ 
;¨¨ 
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# 0
,
©©0 1
	SqlDbType
©©2 ;
.
©©; <
UniqueIdentifier
©©< L
,
©©L M 
ParameterDirection
©©N `
.
©©` a
Input
©©a f
,
©©f g

moduleGuid
©©h r
)
©©r s
;
©©s t
int
ªª 
rowsAffected
ªª 
=
ªª 
sph
ªª "
.
ªª" #
ExecuteNonQuery
ªª# 2
(
ªª2 3
)
ªª3 4
;
ªª4 5
return
«« 
(
«« 
rowsAffected
««  
>
««! "
$num
««# $
)
««$ %
;
««% &
}
­­ 	
public
´´ 
static
´´ 
bool
´´ 
DeleteByOrder
´´ (
(
´´( )
Guid
´´) -
	orderGuid
´´. 7
)
´´7 8
{
µµ 	 
SqlParameterHelper
¶¶ 
sph
¶¶ "
=
¶¶# $
new
¶¶% ( 
SqlParameterHelper
¶¶) ;
(
¶¶; <
ConnectionString
¶¶< L
.
¶¶L M&
GetWriteConnectionString
¶¶M e
(
¶¶e f
)
¶¶f g
,
¶¶g h
$str¶¶i 
,¶¶ 
$num¶¶ 
)¶¶ 
;¶¶ 
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# /
,
··/ 0
	SqlDbType
··1 :
.
··: ;
UniqueIdentifier
··; K
,
··K L 
ParameterDirection
··M _
.
··_ `
Input
··` e
,
··e f
	orderGuid
··g p
)
··p q
;
··q r
int
¸¸ 
rowsAffected
¸¸ 
=
¸¸ 
sph
¸¸ "
.
¸¸" #
ExecuteNonQuery
¸¸# 2
(
¸¸2 3
)
¸¸3 4
;
¸¸4 5
return
¹¹ 
(
¹¹ 
rowsAffected
¹¹  
>
¹¹! "
$num
¹¹# $
)
¹¹$ %
;
¹¹% &
}
»» 	
public
½½ 
static
½½ 
IDataReader
½½ !$
GetSalesByYearByModule
½½" 8
(
½½8 9
Guid
½½9 =

moduleGuid
½½> H
)
½½H I
{
¾¾ 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M%
GetReadConnectionString
¿¿M d
(
¿¿d e
)
¿¿e f
,
¿¿f g
$str¿¿h 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 0
,
ÀÀ0 1
	SqlDbType
ÀÀ2 ;
.
ÀÀ; <
UniqueIdentifier
ÀÀ< L
,
ÀÀL M 
ParameterDirection
ÀÀN `
.
ÀÀ` a
Input
ÀÀa f
,
ÀÀf g

moduleGuid
ÀÀh r
)
ÀÀr s
;
ÀÀs t
return
ÁÁ 
sph
ÁÁ 
.
ÁÁ 
ExecuteReader
ÁÁ $
(
ÁÁ$ %
)
ÁÁ% &
;
ÁÁ& '
}
ÂÂ 	
public
ÄÄ 
static
ÄÄ 
IDataReader
ÄÄ !'
GetSalesByYearMonthBySite
ÄÄ" ;
(
ÄÄ; <
Guid
ÄÄ< @
siteGuid
ÄÄA I
)
ÄÄI J
{
ÅÅ 	 
SqlParameterHelper
ÆÆ 
sph
ÆÆ "
=
ÆÆ# $
new
ÆÆ% ( 
SqlParameterHelper
ÆÆ) ;
(
ÆÆ; <
ConnectionString
ÆÆ< L
.
ÆÆL M%
GetReadConnectionString
ÆÆM d
(
ÆÆd e
)
ÆÆe f
,
ÆÆf g
$strÆÆh 
,ÆÆ 
$numÆÆ 
)ÆÆ 
;ÆÆ 
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# .
,
ÇÇ. /
	SqlDbType
ÇÇ0 9
.
ÇÇ9 :
UniqueIdentifier
ÇÇ: J
,
ÇÇJ K 
ParameterDirection
ÇÇL ^
.
ÇÇ^ _
Input
ÇÇ_ d
,
ÇÇd e
siteGuid
ÇÇf n
)
ÇÇn o
;
ÇÇo p
return
ÈÈ 
sph
ÈÈ 
.
ÈÈ 
ExecuteReader
ÈÈ $
(
ÈÈ$ %
)
ÈÈ% &
;
ÈÈ& '
}
ÉÉ 	
public
ËË 
static
ËË 
IDataReader
ËË !)
GetSalesByYearMonthByModule
ËË" =
(
ËË= >
Guid
ËË> B

moduleGuid
ËËC M
)
ËËM N
{
ÌÌ 	 
SqlParameterHelper
ÍÍ 
sph
ÍÍ "
=
ÍÍ# $
new
ÍÍ% ( 
SqlParameterHelper
ÍÍ) ;
(
ÍÍ; <
ConnectionString
ÍÍ< L
.
ÍÍL M%
GetReadConnectionString
ÍÍM d
(
ÍÍd e
)
ÍÍe f
,
ÍÍf g
$strÍÍh 
,ÍÍ 
$numÍÍ 
)ÍÍ 
;ÍÍ 
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 0
,
ÎÎ0 1
	SqlDbType
ÎÎ2 ;
.
ÎÎ; <
UniqueIdentifier
ÎÎ< L
,
ÎÎL M 
ParameterDirection
ÎÎN `
.
ÎÎ` a
Input
ÎÎa f
,
ÎÎf g

moduleGuid
ÎÎh r
)
ÎÎr s
;
ÎÎs t
return
ÏÏ 
sph
ÏÏ 
.
ÏÏ 
ExecuteReader
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
;
ÏÏ& '
}
ÐÐ 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !'
GetSalesByYearMonthByItem
ÒÒ" ;
(
ÒÒ; <
Guid
ÒÒ< @
itemGuid
ÒÒA I
)
ÒÒI J
{
ÓÓ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh 
,ÔÔ 
$numÔÔ 
)ÔÔ 
;ÔÔ 
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
UniqueIdentifier
ÕÕ: J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
itemGuid
ÕÕf n
)
ÕÕn o
;
ÕÕo p
return
ÖÖ 
sph
ÖÖ 
.
ÖÖ 
ExecuteReader
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
}
×× 	
public
ÙÙ 
static
ÙÙ 
IDataReader
ÙÙ !'
GetSalesByYearMonthByUser
ÙÙ" ;
(
ÙÙ; <
Guid
ÙÙ< @
userGuid
ÙÙA I
)
ÙÙI J
{
ÚÚ 	 
SqlParameterHelper
ÛÛ 
sph
ÛÛ "
=
ÛÛ# $
new
ÛÛ% ( 
SqlParameterHelper
ÛÛ) ;
(
ÛÛ; <
ConnectionString
ÛÛ< L
.
ÛÛL M%
GetReadConnectionString
ÛÛM d
(
ÛÛd e
)
ÛÛe f
,
ÛÛf g
$strÛÛh 
,ÛÛ 
$numÛÛ 
)ÛÛ 
;ÛÛ 
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
UniqueIdentifier
ÜÜ: J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
userGuid
ÜÜf n
)
ÜÜn o
;
ÜÜo p
return
ÝÝ 
sph
ÝÝ 
.
ÝÝ 
ExecuteReader
ÝÝ $
(
ÝÝ$ %
)
ÝÝ% &
;
ÝÝ& '
}
ÞÞ 	
public
àà 
static
àà 
IDataReader
àà !%
GetSalesGroupedByModule
àà" 9
(
àà9 :
Guid
àà: >
siteGuid
àà? G
)
ààG H
{
áá 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M%
GetReadConnectionString
ââM d
(
ââd e
)
ââe f
,
ââf g
$strââh 
,ââ 
$numââ 
)ââ 
;ââ 
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# .
,
ãã. /
	SqlDbType
ãã0 9
.
ãã9 :
UniqueIdentifier
ãã: J
,
ããJ K 
ParameterDirection
ããL ^
.
ãã^ _
Input
ãã_ d
,
ããd e
siteGuid
ããf n
)
ããn o
;
ãão p
return
ää 
sph
ää 
.
ää 
ExecuteReader
ää $
(
ää$ %
)
ää% &
;
ää& '
}
åå 	
public
çç 
static
çç 
IDataReader
çç !#
GetSalesGroupedByUser
çç" 7
(
çç7 8
Guid
çç8 <
siteGuid
çç= E
)
ççE F
{
èè 	 
SqlParameterHelper
éé 
sph
éé "
=
éé# $
new
éé% ( 
SqlParameterHelper
éé) ;
(
éé; <
ConnectionString
éé< L
.
ééL M%
GetReadConnectionString
ééM d
(
ééd e
)
éée f
,
ééf g
$strééh 
,éé 
$numéé 
)éé 
;éé 
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
UniqueIdentifier
êê: J
,
êêJ K 
ParameterDirection
êêL ^
.
êê^ _
Input
êê_ d
,
êêd e
siteGuid
êêf n
)
êên o
;
êêo p
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
ìì 	
public
îî 
static
îî 
IDataReader
îî !
GetItemSummary
îî" 0
(
îî0 1
Guid
îî1 5
itemGuid
îî6 >
)
îî> ?
{
ïï 	 
SqlParameterHelper
ðð 
sph
ðð "
=
ðð# $
new
ðð% ( 
SqlParameterHelper
ðð) ;
(
ðð; <
ConnectionString
ðð< L
.
ððL M%
GetReadConnectionString
ððM d
(
ððd e
)
ððe f
,
ððf g
$strððh 
,ðð 
$numðð 
)ðð 
;ðð 
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
UniqueIdentifier
ññ: J
,
ññJ K 
ParameterDirection
ññL ^
.
ññ^ _
Input
ññ_ d
,
ññd e
itemGuid
ññf n
)
ññn o
;
ñño p
return
òò 
sph
òò 
.
òò 
ExecuteReader
òò $
(
òò$ %
)
òò% &
;
òò& '
}
óó 	
public
öö 
static
öö 
IDataReader
öö !"
GetItemRevenueBySite
öö" 6
(
öö6 7
Guid
öö7 ;
siteGuid
öö< D
)
ööD E
{
÷÷ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M%
GetReadConnectionString
øøM d
(
øød e
)
øøe f
,
øøf g
$strøøh 
,øø 
$numøø 
)øø 
;øø 
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
UniqueIdentifier
ùù: J
,
ùùJ K 
ParameterDirection
ùùL ^
.
ùù^ _
Input
ùù_ d
,
ùùd e
siteGuid
ùùf n
)
ùùn o
;
ùùo p
return
ûû 
sph
ûû 
.
ûû 
ExecuteReader
ûû $
(
ûû$ %
)
ûû% &
;
ûû& '
}
üü 	
public
þþ 
static
þþ 
IDataReader
þþ !$
GetItemRevenueByModule
þþ" 8
(
þþ8 9
Guid
þþ9 =

moduleGuid
þþ> H
)
þþH I
{
ÿÿ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !"
GetItemRevenueByUser
" 6
(
6 7
Guid
7 ;
userGuid
< D
)
D E
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
decimal
 %
GetAllTimeRevenueBySite
 5
(
5 6
Guid
6 :
siteGuid
; C
)
C D
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
decimal
 
result
 
=
 
$num
 
;
 
try
 
{
 
result
 
=
 
Convert
  
.
  !
	ToDecimal
! *
(
* +
sph
+ .
.
. /
ExecuteScalar
/ <
(
< =
)
= >
,
> ?
CultureInfo
? J
.
J K
InvariantCulture
K [
)
[ \
;
\ ]
}
 
catch
 
(
 "
InvalidCastException
 '
)
' (
{
) *
}
+ ,
return
 
result
 
;
 
}
 	
public
 
static
 
decimal
 '
GetAllTimeRevenueByModule
 7
(
7 8
Guid
8 <

moduleGuid
= G
)
G H
{
 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h 
,   
$num   
)   
;   
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 0
,
¡¡0 1
	SqlDbType
¡¡2 ;
.
¡¡; <
UniqueIdentifier
¡¡< L
,
¡¡L M 
ParameterDirection
¡¡N `
.
¡¡` a
Input
¡¡a f
,
¡¡f g

moduleGuid
¡¡h r
)
¡¡r s
;
¡¡s t
decimal
££ 
result
££ 
=
££ 
$num
££ 
;
££ 
try
¥¥ 
{
¦¦ 
result
§§ 
=
§§ 
Convert
§§  
.
§§  !
	ToDecimal
§§! *
(
§§* +
sph
§§+ .
.
§§. /
ExecuteScalar
§§/ <
(
§§< =
)
§§= >
,
§§> ?
CultureInfo
§§@ K
.
§§K L
InvariantCulture
§§L \
)
§§\ ]
;
§§] ^
}
¨¨ 
catch
©© 
(
©© "
InvalidCastException
©© '
)
©©' (
{
©©) *
}
©©+ ,
return
«« 
result
«« 
;
«« 
}
¬¬ 	
public
±± 
static
±± 
int
±±  
GetItemCountByUser
±± ,
(
±±, -
Guid
±±- 1
siteGuid
±±2 :
,
±±: ;
Guid
±±< @
userGuid
±±A I
)
±±I J
{
²² 	 
SqlParameterHelper
³³ 
sph
³³ "
=
³³# $
new
³³% ( 
SqlParameterHelper
³³) ;
(
³³; <
ConnectionString
³³< L
.
³³L M%
GetReadConnectionString
³³M d
(
³³d e
)
³³e f
,
³³f g
$str³³h 
,³³ 
$num³³ 
)³³ 
;³³ 
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
UniqueIdentifier
´´: J
,
´´J K 
ParameterDirection
´´L ^
.
´´^ _
Input
´´_ d
,
´´d e
siteGuid
´´f n
)
´´n o
;
´´o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
userGuid
µµf n
)
µµn o
;
µµo p
return
·· 
Convert
·· 
.
·· 
ToInt32
·· "
(
··" #
sph
··# &
.
··& '
ExecuteScalar
··' 4
(
··4 5
)
··5 6
)
··6 7
;
··7 8
}
¹¹ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !
GetUserItemsPage
ÁÁ" 2
(
ÁÁ2 3
Guid
ÂÂ 
siteGuid
ÂÂ 
,
ÂÂ 
Guid
ÃÃ 
userGuid
ÃÃ 
,
ÃÃ 
int
ÄÄ 

pageNumber
ÄÄ 
,
ÄÄ 
int
ÅÅ 
pageSize
ÅÅ 
,
ÅÅ 
out
ÆÆ 
int
ÆÆ 

totalPages
ÆÆ 
)
ÆÆ 
{
ÇÇ 	

totalPages
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
int
ÉÉ 
	totalRows
ÉÉ 
=
ÊÊ  
GetItemCountByUser
ÊÊ $
(
ÊÊ$ %
siteGuid
ÊÊ% -
,
ÊÊ- .
userGuid
ÊÊ/ 7
)
ÊÊ7 8
;
ÊÊ8 9
if
ÌÌ 
(
ÌÌ 
pageSize
ÌÌ 
>
ÌÌ 
$num
ÌÌ 
)
ÌÌ 

totalPages
ÌÌ (
=
ÌÌ) *
	totalRows
ÌÌ+ 4
/
ÌÌ5 6
pageSize
ÌÌ7 ?
;
ÌÌ? @
if
ÎÎ 
(
ÎÎ 
	totalRows
ÎÎ 
<=
ÎÎ 
pageSize
ÎÎ %
)
ÎÎ% &
{
ÏÏ 

totalPages
ÐÐ 
=
ÐÐ 
$num
ÐÐ 
;
ÐÐ 
}
ÑÑ 
else
ÒÒ 
{
ÓÓ 
int
ÔÔ 
	remainder
ÔÔ 
;
ÔÔ 
Math
ÕÕ 
.
ÕÕ 
DivRem
ÕÕ 
(
ÕÕ 
	totalRows
ÕÕ %
,
ÕÕ% &
pageSize
ÕÕ' /
,
ÕÕ/ 0
out
ÕÕ1 4
	remainder
ÕÕ5 >
)
ÕÕ> ?
;
ÕÕ? @
if
ÖÖ 
(
ÖÖ 
	remainder
ÖÖ 
>
ÖÖ 
$num
ÖÖ  !
)
ÖÖ! "
{
×× 

totalPages
ØØ 
+=
ØØ !
$num
ØØ" #
;
ØØ# $
}
ÙÙ 
}
ÚÚ  
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$strÜÜh 
,ÜÜ 
$numÜÜ 
)ÜÜ 
;ÜÜ 
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# .
,
ÝÝ. /
	SqlDbType
ÝÝ0 9
.
ÝÝ9 :
UniqueIdentifier
ÝÝ: J
,
ÝÝJ K 
ParameterDirection
ÝÝL ^
.
ÝÝ^ _
Input
ÝÝ_ d
,
ÝÝd e
siteGuid
ÝÝf n
)
ÝÝn o
;
ÝÝo p
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# .
,
ÞÞ. /
	SqlDbType
ÞÞ0 9
.
ÞÞ9 :
UniqueIdentifier
ÞÞ: J
,
ÞÞJ K 
ParameterDirection
ÞÞL ^
.
ÞÞ^ _
Input
ÞÞ_ d
,
ÞÞd e
userGuid
ÞÞf n
)
ÞÞn o
;
ÞÞo p
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 0
,
ßß0 1
	SqlDbType
ßß2 ;
.
ßß; <
Int
ßß< ?
,
ßß? @ 
ParameterDirection
ßßA S
.
ßßS T
Input
ßßT Y
,
ßßY Z

pageNumber
ßß[ e
)
ßße f
;
ßßf g
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
Int
àà: =
,
àà= > 
ParameterDirection
àà? Q
.
ààQ R
Input
ààR W
,
ààW X
pageSize
ààY a
)
ààa b
;
ààb c
return
áá 
sph
áá 
.
áá 
ExecuteReader
áá $
(
áá$ %
)
áá% &
;
áá& '
}
ãã 	
public
êê 
static
êê 
int
êê *
GetDistinctItemCountByModule
êê 6
(
êê6 7
Guid
êê7 ;

moduleGuid
êê< F
)
êêF G
{
ëë 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M%
GetReadConnectionString
ììM d
(
ììd e
)
ììe f
,
ììf g
$strììh 
,ìì 
$numìì 
)ìì 
;ìì 
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# 0
,
íí0 1
	SqlDbType
íí2 ;
.
íí; <
UniqueIdentifier
íí< L
,
ííL M 
ParameterDirection
ííN `
.
íí` a
Input
íía f
,
ííf g

moduleGuid
ííh r
)
íír s
;
íís t
return
ïï 
Convert
ïï 
.
ïï 
ToInt32
ïï "
(
ïï" #
sph
ïï# &
.
ïï& '
ExecuteScalar
ïï' 4
(
ïï4 5
)
ïï5 6
)
ïï6 7
;
ïï7 8
}
ññ 	
public
ùù 
static
ùù 
IDataReader
ùù !"
GetItemsPageByModule
ùù" 6
(
ùù6 7
Guid
úú 

moduleGuid
úú 
,
úú 
int
ûû 

pageNumber
ûû 
,
ûû 
int
üü 
pageSize
üü 
,
üü 
out
ýý 
int
ýý 

totalPages
ýý 
)
ýý 
{
þþ 	

totalPages
ÿÿ 
=
ÿÿ 
$num
ÿÿ 
;
ÿÿ 
int
 
	totalRows
 
=
 *
GetDistinctItemCountByModule
 .
(
. /

moduleGuid
/ 9
)
9 :
;
: ;
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 &
GetDistinctUserItemCount
 2
(
2 3
Guid
3 7
siteGuid
8 @
)
@ A
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# .
,
¢¢. /
	SqlDbType
¢¢0 9
.
¢¢9 :
UniqueIdentifier
¢¢: J
,
¢¢J K 
ParameterDirection
¢¢L ^
.
¢¢^ _
Input
¢¢_ d
,
¢¢d e
siteGuid
¢¢f n
)
¢¢n o
;
¢¢o p
return
¤¤ 
Convert
¤¤ 
.
¤¤ 
ToInt32
¤¤ "
(
¤¤" #
sph
¤¤# &
.
¤¤& '
ExecuteScalar
¤¤' 4
(
¤¤4 5
)
¤¤5 6
)
¤¤6 7
;
¤¤7 8
}
¦¦ 	
public
®® 
static
®® 
IDataReader
®® !#
GetUserItemPageBySite
®®" 7
(
®®7 8
Guid
¯¯ 
siteGuid
¯¯ 
,
¯¯ 
int
°° 

pageNumber
°° 
,
°° 
int
±± 
pageSize
±± 
,
±± 
out
²² 
int
²² 

totalPages
²² 
)
²² 
{
³³ 	

totalPages
´´ 
=
´´ 
$num
´´ 
;
´´ 
int
µµ 
	totalRows
µµ 
=
¶¶ &
GetDistinctUserItemCount
¶¶ *
(
¶¶* +
siteGuid
¶¶+ 3
)
¶¶3 4
;
¶¶4 5
if
¸¸ 
(
¸¸ 
pageSize
¸¸ 
>
¸¸ 
$num
¸¸ 
)
¸¸ 

totalPages
¸¸ (
=
¸¸) *
	totalRows
¸¸+ 4
/
¸¸5 6
pageSize
¸¸7 ?
;
¸¸? @
if
ºº 
(
ºº 
	totalRows
ºº 
<=
ºº 
pageSize
ºº %
)
ºº% &
{
»» 

totalPages
¼¼ 
=
¼¼ 
$num
¼¼ 
;
¼¼ 
}
½½ 
else
¾¾ 
{
¿¿ 
int
ÀÀ 
	remainder
ÀÀ 
;
ÀÀ 
Math
ÁÁ 
.
ÁÁ 
DivRem
ÁÁ 
(
ÁÁ 
	totalRows
ÁÁ %
,
ÁÁ% &
pageSize
ÁÁ' /
,
ÁÁ/ 0
out
ÁÁ1 4
	remainder
ÁÁ5 >
)
ÁÁ> ?
;
ÁÁ? @
if
ÂÂ 
(
ÂÂ 
	remainder
ÂÂ 
>
ÂÂ 
$num
ÂÂ  !
)
ÂÂ! "
{
ÃÃ 

totalPages
ÄÄ 
+=
ÄÄ !
$num
ÄÄ" #
;
ÄÄ# $
}
ÅÅ 
}
ÆÆ  
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh 
,ÈÈ 
$numÈÈ 
)ÈÈ 
;ÈÈ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
UniqueIdentifier
ÉÉ: J
,
ÉÉJ K 
ParameterDirection
ÉÉL ^
.
ÉÉ^ _
Input
ÉÉ_ d
,
ÉÉd e
siteGuid
ÉÉf n
)
ÉÉn o
;
ÉÉo p
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 0
,
ÊÊ0 1
	SqlDbType
ÊÊ2 ;
.
ÊÊ; <
Int
ÊÊ< ?
,
ÊÊ? @ 
ParameterDirection
ÊÊA S
.
ÊÊS T
Input
ÊÊT Y
,
ÊÊY Z

pageNumber
ÊÊ[ e
)
ÊÊe f
;
ÊÊf g
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# .
,
ËË. /
	SqlDbType
ËË0 9
.
ËË9 :
Int
ËË: =
,
ËË= > 
ParameterDirection
ËË? Q
.
ËËQ R
Input
ËËR W
,
ËËW X
pageSize
ËËY a
)
ËËa b
;
ËËb c
return
ÌÌ 
sph
ÌÌ 
.
ÌÌ 
ExecuteReader
ÌÌ $
(
ÌÌ$ %
)
ÌÌ% &
;
ÌÌ& '
}
ÎÎ 	
public
îî 
static
îî 
int
îî 
CreateOrder
îî %
(
îî% &
Guid
ïï 
rowGuid
ïï 
,
ïï 
Guid
ðð 
siteGuid
ðð 
,
ðð 
Guid
ññ 
featureGuid
ññ 
,
ññ 
Guid
òò 

moduleGuid
òò 
,
òò 
Guid
óó 
userGuid
óó 
,
óó 
Guid
ôô 
	orderGuid
ôô 
,
ôô 
string
õõ 
billingFirstName
õõ #
,
õõ# $
string
öö 
billingLastName
öö "
,
öö" #
string
÷÷ 
billingCompany
÷÷ !
,
÷÷! "
string
øø 
billingAddress1
øø "
,
øø" #
string
ùù 
billingAddress2
ùù "
,
ùù" #
string
úú 
billingSuburb
úú  
,
úú  !
string
ûû 
billingCity
ûû 
,
ûû 
string
üü 
billingPostalCode
üü $
,
üü$ %
string
ýý 
billingState
ýý 
,
ýý  
string
þþ 
billingCountry
þþ !
,
þþ! "
string
ÿÿ 
paymentMethod
ÿÿ  
,
ÿÿ  !
decimal
 
subTotal
 
,
 
decimal
 
taxTotal
 
,
 
decimal
 
shippingTotal
 !
,
! "
decimal
 

orderTotal
 
,
 
DateTime
 
orderDateUtc
 !
,
! "
string
 
adminOrderLink
 !
,
! "
string
 
userOrderLink
  
,
  !
DateTime
 
rowCreatedUtc
 "
,
" #
bool
  
includeInAggregate
 #
)
# $
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
UniqueIdentifier
9 I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
rowGuid
e l
)
l m
;
m n
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	orderGuid
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
NVarChar
B J
,
J K
$num
L O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
billingFirstName
k {
)
{ |
;
| }
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
NVarChar
A I
,
I J
$num
K M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
billingLastName
i x
)
x y
;
y z
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
NVarChar
@ H
,
H I
$num
J M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
billingCompany
i w
)
w x
;
x y
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
NVarChar
A I
,
I J
$num
K N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
billingAddress1
j y
)
y z
;
z {
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
NVarChar
A I
,
I J
$num
K N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
billingAddress2
j y
)
y z
;
z {
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
NVarChar
? G
,
G H
$num
I L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
billingSuburb
h u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
billingCity
f q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 7
,
7 8
	SqlDbType
9 B
.
B C
NVarChar
C K
,
K L
$num
M O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
billingPostalCode
k |
)
| }
;
} ~
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
billingState
g s
)
s t
;
t u
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
NVarChar
@ H
,
H I
$num
J M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
billingCountry
i w
)
w x
;
x y
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
NVarChar
? G
,
G H
$num
I K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
paymentMethod
g t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Decimal
: A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
subTotal
] e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Decimal
: A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
taxTotal
] e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
Decimal
? F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
shippingTotal
b o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Decimal
< C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^

orderTotal
_ i
)
i j
;
j k
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 2
,
  2 3
	SqlDbType
  4 =
.
  = >
DateTime
  > F
,
  F G 
ParameterDirection
  H Z
.
  Z [
Input
  [ `
,
  ` a
orderDateUtc
  b n
)
  n o
;
  o p
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# 4
,
¡¡4 5
	SqlDbType
¡¡6 ?
.
¡¡? @
NVarChar
¡¡@ H
,
¡¡H I
$num
¡¡J M
,
¡¡M N 
ParameterDirection
¡¡O a
.
¡¡a b
Input
¡¡b g
,
¡¡g h
adminOrderLink
¡¡i w
)
¡¡w x
;
¡¡x y
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 3
,
¢¢3 4
	SqlDbType
¢¢5 >
.
¢¢> ?
NVarChar
¢¢? G
,
¢¢G H
$num
¢¢I L
,
¢¢L M 
ParameterDirection
¢¢N `
.
¢¢` a
Input
¢¢a f
,
¢¢f g
userOrderLink
¢¢h u
)
¢¢u v
;
¢¢v w
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 3
,
££3 4
	SqlDbType
££5 >
.
££> ?
DateTime
££? G
,
££G H 
ParameterDirection
££I [
.
££[ \
Input
££\ a
,
££a b
rowCreatedUtc
££c p
)
££p q
;
££q r
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 8
,
¤¤8 9
	SqlDbType
¤¤: C
.
¤¤C D
Bit
¤¤D G
,
¤¤G H 
ParameterDirection
¤¤I [
.
¤¤[ \
Input
¤¤\ a
,
¤¤a b 
includeInAggregate
¤¤c u
)
¤¤u v
;
¤¤v w
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
sph
¥¥ "
.
¥¥" #
ExecuteNonQuery
¥¥# 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5
return
¦¦ 
rowsAffected
¦¦ 
;
¦¦  
}
¨¨ 	
public
¯¯ 
static
¯¯ 
bool
¯¯ 
DeleteOrder
¯¯ &
(
¯¯& '
Guid
¯¯' +
rowGuid
¯¯, 3
)
¯¯3 4
{
°° 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M&
GetWriteConnectionString
±±M e
(
±±e f
)
±±f g
,
±±g h
$str±±i 
,±± 
$num±± 
)±± 
;±± 
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# -
,
²²- .
	SqlDbType
²²/ 8
.
²²8 9
UniqueIdentifier
²²9 I
,
²²I J 
ParameterDirection
²²K ]
.
²²] ^
Input
²²^ c
,
²²c d
rowGuid
²²e l
)
²²l m
;
²²m n
int
³³ 
rowsAffected
³³ 
=
³³ 
sph
³³ "
.
³³" #
ExecuteNonQuery
³³# 2
(
³³2 3
)
³³3 4
;
³³4 5
return
´´ 
(
´´ 
rowsAffected
´´  
>
´´! "
$num
´´# $
)
´´$ %
;
´´% &
}
¶¶ 	
public
½½ 
static
½½ 
bool
½½  
DeleteOrdersBySite
½½ -
(
½½- .
Guid
½½. 2
siteGuid
½½3 ;
)
½½; <
{
¾¾ 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M&
GetWriteConnectionString
¿¿M e
(
¿¿e f
)
¿¿f g
,
¿¿g h
$str¿¿i 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# .
,
ÀÀ. /
	SqlDbType
ÀÀ0 9
.
ÀÀ9 :
UniqueIdentifier
ÀÀ: J
,
ÀÀJ K 
ParameterDirection
ÀÀL ^
.
ÀÀ^ _
Input
ÀÀ_ d
,
ÀÀd e
siteGuid
ÀÀf n
)
ÀÀn o
;
ÀÀo p
int
ÁÁ 
rowsAffected
ÁÁ 
=
ÁÁ 
sph
ÁÁ "
.
ÁÁ" #
ExecuteNonQuery
ÁÁ# 2
(
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
return
ÂÂ 
(
ÂÂ 
rowsAffected
ÂÂ  
>
ÂÂ! "
$num
ÂÂ# $
)
ÂÂ$ %
;
ÂÂ% &
}
ÄÄ 	
public
ÌÌ 
static
ÌÌ 
bool
ÌÌ "
DeleteOrdersByModule
ÌÌ /
(
ÌÌ/ 0
Guid
ÌÌ0 4

moduleGuid
ÌÌ5 ?
)
ÌÌ? @
{
ÍÍ 	 
SqlParameterHelper
ÎÎ 
sph
ÎÎ "
=
ÎÎ# $
new
ÎÎ% ( 
SqlParameterHelper
ÎÎ) ;
(
ÎÎ; <
ConnectionString
ÎÎ< L
.
ÎÎL M&
GetWriteConnectionString
ÎÎM e
(
ÎÎe f
)
ÎÎf g
,
ÎÎg h
$strÎÎi 
,ÎÎ 
$numÎÎ 
)ÎÎ 
;ÎÎ 
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# 0
,
ÏÏ0 1
	SqlDbType
ÏÏ2 ;
.
ÏÏ; <
UniqueIdentifier
ÏÏ< L
,
ÏÏL M 
ParameterDirection
ÏÏN `
.
ÏÏ` a
Input
ÏÏa f
,
ÏÏf g

moduleGuid
ÏÏh r
)
ÏÏr s
;
ÏÏs t
int
ÐÐ 
rowsAffected
ÐÐ 
=
ÐÐ 
sph
ÐÐ "
.
ÐÐ" #
ExecuteNonQuery
ÐÐ# 2
(
ÐÐ2 3
)
ÐÐ3 4
;
ÐÐ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
$num
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
}
ÓÓ 	
public
ÚÚ 
static
ÚÚ 
bool
ÚÚ !
DeleteOrdersByOrder
ÚÚ .
(
ÚÚ. /
Guid
ÚÚ/ 3
	orderGuid
ÚÚ4 =
)
ÚÚ= >
{
ÛÛ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M&
GetWriteConnectionString
ÜÜM e
(
ÜÜe f
)
ÜÜf g
,
ÜÜg h
$strÜÜi 
,ÜÜ 
$numÜÜ 
)ÜÜ 
;ÜÜ 
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# /
,
ÝÝ/ 0
	SqlDbType
ÝÝ1 :
.
ÝÝ: ;
UniqueIdentifier
ÝÝ; K
,
ÝÝK L 
ParameterDirection
ÝÝM _
.
ÝÝ_ `
Input
ÝÝ` e
,
ÝÝe f
	orderGuid
ÝÝg p
)
ÝÝp q
;
ÝÝq r
int
ÞÞ 
rowsAffected
ÞÞ 
=
ÞÞ 
sph
ÞÞ "
.
ÞÞ" #
ExecuteNonQuery
ÞÞ# 2
(
ÞÞ2 3
)
ÞÞ3 4
;
ÞÞ4 5
return
ßß 
(
ßß 
rowsAffected
ßß  
>
ßß! "
$num
ßß# $
)
ßß$ %
;
ßß% &
}
áá 	
public
èè 
static
èè 
bool
èè #
DeleteOrdersByFeature
èè 0
(
èè0 1
Guid
èè1 5
featureGuid
èè6 A
)
èèA B
{
éé 	 
SqlParameterHelper
êê 
sph
êê "
=
êê# $
new
êê% ( 
SqlParameterHelper
êê) ;
(
êê; <
ConnectionString
êê< L
.
êêL M&
GetWriteConnectionString
êêM e
(
êêe f
)
êêf g
,
êêg h
$strêêi 
,êê 
$numêê 
)êê 
;êê 
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 1
,
ëë1 2
	SqlDbType
ëë3 <
.
ëë< =
UniqueIdentifier
ëë= M
,
ëëM N 
ParameterDirection
ëëO a
.
ëëa b
Input
ëëb g
,
ëëg h
featureGuid
ëëi t
)
ëët u
;
ëëu v
int
ìì 
rowsAffected
ìì 
=
ìì 
sph
ìì "
.
ìì" #
ExecuteNonQuery
ìì# 2
(
ìì2 3
)
ìì3 4
;
ìì4 5
return
íí 
(
íí 
rowsAffected
íí  
>
íí! "
$num
íí# $
)
íí$ %
;
íí% &
}
ïï 	
public
öö 
static
öö 
bool
öö  
DeleteOrdersByUser
öö -
(
öö- .
Guid
öö. 2
userGuid
öö3 ;
)
öö; <
{
÷÷ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M&
GetWriteConnectionString
øøM e
(
øøe f
)
øøf g
,
øøg h
$strøøi 
,øø 
$numøø 
)øø 
;øø 
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
UniqueIdentifier
ùù: J
,
ùùJ K 
ParameterDirection
ùùL ^
.
ùù^ _
Input
ùù_ d
,
ùùd e
userGuid
ùùf n
)
ùùn o
;
ùùo p
int
úú 
rowsAffected
úú 
=
úú 
sph
úú "
.
úú" #
ExecuteNonQuery
úú# 2
(
úú2 3
)
úú3 4
;
úú4 5
return
ûû 
(
ûû 
rowsAffected
ûû  
>
ûû! "
$num
ûû# $
)
ûû$ %
;
ûû% &
}
ýý 	
public
ÿÿ 
static
ÿÿ 
bool
ÿÿ 
	MoveOrder
ÿÿ $
(
ÿÿ$ %
Guid
 
	orderGuid
 
,
 
Guid
 
newUserGuid
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	orderGuid
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
newUserGuid
f q
)
q r
;
r s
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
sph
 
=
 
new
  
SqlParameterHelper
 (
(
( )
ConnectionString
) 9
.
9 :&
GetWriteConnectionString
: R
(
R S
)
S T
,
T U
$str
V y
,
y z
$num
{ |
)
| }
;
} ~
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	orderGuid
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
newUserGuid
f q
)
q r
;
r s
sph
 
.
 
ExecuteNonQuery
 
(
  
)
  !
;
! "
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
}
 
} þj
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentHistory.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentHistory (
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 
siteGuidDD 
,DD 
GuidEE 
userGuidEE 
,EE 
GuidFF 
contentGuidFF 
,FF 
stringGG 
titleGG 
,GG 
stringHH 
contentTextHH 
,HH 
stringII 

customDataII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
DateTimeKK 

historyUtcKK 
)KK  
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi 
,
MM 
$num
MM 
)
MM 
;
MM 
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
userGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
contentGuidQQi t
)QQt u
;QQu v
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# +
,RR+ ,
	SqlDbTypeRR- 6
.RR6 7
NVarCharRR7 ?
,RR? @
$numRRA D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _
titleRR` e
)RRe f
;RRf g
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 1
,SS1 2
	SqlDbTypeSS3 <
.SS< =
NVarCharSS= E
,SSE F
-SSG H
$numSSH I
,SSI J
ParameterDirectionSSK ]
.SS] ^
InputSS^ c
,SSc d
contentTextSSe p
)SSp q
;SSq r
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 0
,TT0 1
	SqlDbTypeTT2 ;
.TT; <
NVarCharTT< D
,TTD E
-TTF G
$numTTG H
,TTH I
ParameterDirectionTTJ \
.TT\ ]
InputTT] b
,TTb c

customDataTTd n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

historyUtcVV` j
)VVj k
;VVk l
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
rowsAffectedXX 
;XX  
}ZZ 	
publicdd 
staticdd 
booldd 
Deletedd !
(dd! "
Guiddd" &
guiddd' +
)dd+ ,
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M$
GetWriteConnectionStringffM e
(ffe f
)fff g
,ffg h
$str	ffi 
,
ff 
$num
ff 
)
ff 
;
ff 
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# *
,gg* +
	SqlDbTypegg, 5
.gg5 6
UniqueIdentifiergg6 F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
guidggb f
)ggf g
;ggg h
inthh 
rowsAffectedhh 
=hh 
sphhh "
.hh" #
ExecuteNonQueryhh# 2
(hh2 3
)hh3 4
;hh4 5
returnii 
(ii 
rowsAffectedii  
>ii! "
$numii# $
)ii$ %
;ii% &
}kk 	
publicrr 
staticrr 
boolrr 
DeleteBySiterr '
(rr' (
Guidrr( ,
siteGuidrr- 5
)rr5 6
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M$
GetWriteConnectionStringttM e
(tte f
)ttf g
,ttg h
$str	tti 
,
tt 
$num
tt 
)
tt 
;
tt 
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
UniqueIdentifieruu: J
,uuJ K
ParameterDirectionuuL ^
.uu^ _
Inputuu_ d
,uud e
siteGuiduuf n
)uun o
;uuo p
intvv 
rowsAffectedvv 
=vv 
sphvv "
.vv" #
ExecuteNonQueryvv# 2
(vv2 3
)vv3 4
;vv4 5
returnww 
(ww 
rowsAffectedww  
>ww! "
$numww# $
)ww$ %
;ww% &
}yy 	
public
 
static
 
bool
 
DeleteByContent
 *
(
* +
Guid
+ /
contentGuid
0 ;
)
; <
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
contentGuid
i t
)
t u
;
u v
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
IDataReader
 !
GetOne
" (
(
( )
Guid
) -
guid
. 2
)
2 3
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
¤¤ 
static
¤¤ 
int
¤¤ 
GetCount
¤¤ "
(
¤¤" #
Guid
¤¤# '
contentGuid
¤¤( 3
)
¤¤3 4
{
¥¥ 	 
SqlParameterHelper
¦¦ 
sph
¦¦ "
=
¦¦# $
new
¦¦% ( 
SqlParameterHelper
¦¦) ;
(
¦¦; <
ConnectionString
¦¦< L
.
¦¦L M%
GetReadConnectionString
¦¦M d
(
¦¦d e
)
¦¦e f
,
¦¦f g
$str¦¦h 
,¦¦ 
$num¦¦ 
)¦¦ 
;¦¦ 
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 1
,
§§1 2
	SqlDbType
§§3 <
.
§§< =
UniqueIdentifier
§§= M
,
§§M N 
ParameterDirection
§§O a
.
§§a b
Input
§§b g
,
§§g h
contentGuid
§§i t
)
§§t u
;
§§u v
return
©© 
Convert
©© 
.
©© 
ToInt32
©© "
(
©©" #
sph
©©# &
.
©©& '
ExecuteScalar
©©' 4
(
©©4 5
)
©©5 6
)
©©6 7
;
©©7 8
}
«« 	
public
µµ 
static
µµ 
IDataReader
µµ !
GetPage
µµ" )
(
µµ) *
Guid
¶¶ 
contentGuid
¶¶ 
,
¶¶ 
int
·· 

pageNumber
·· 
,
·· 
int
¸¸ 
pageSize
¸¸ 
,
¸¸ 
out
¹¹ 
int
¹¹ 

totalPages
¹¹ 
)
¹¹ 
{
ºº 	

totalPages
»» 
=
»» 
$num
»» 
;
»» 
int
¼¼ 
	totalRows
¼¼ 
=
¼¼ 
GetCount
¼¼ $
(
¼¼$ %
contentGuid
¼¼% 0
)
¼¼0 1
;
¼¼1 2
if
¾¾ 
(
¾¾ 
pageSize
¾¾ 
>
¾¾ 
$num
¾¾ 
)
¾¾ 

totalPages
¾¾ (
=
¾¾) *
	totalRows
¾¾+ 4
/
¾¾5 6
pageSize
¾¾7 ?
;
¾¾? @
if
ÀÀ 
(
ÀÀ 
	totalRows
ÀÀ 
<=
ÀÀ 
pageSize
ÀÀ %
)
ÀÀ% &
{
ÁÁ 

totalPages
ÂÂ 
=
ÂÂ 
$num
ÂÂ 
;
ÂÂ 
}
ÃÃ 
else
ÄÄ 
{
ÅÅ 
int
ÆÆ 
	remainder
ÆÆ 
;
ÆÆ 
Math
ÇÇ 
.
ÇÇ 
DivRem
ÇÇ 
(
ÇÇ 
	totalRows
ÇÇ %
,
ÇÇ% &
pageSize
ÇÇ' /
,
ÇÇ/ 0
out
ÇÇ1 4
	remainder
ÇÇ5 >
)
ÇÇ> ?
;
ÇÇ? @
if
ÈÈ 
(
ÈÈ 
	remainder
ÈÈ 
>
ÈÈ 
$num
ÈÈ  !
)
ÈÈ! "
{
ÉÉ 

totalPages
ÊÊ 
+=
ÊÊ !
$num
ÊÊ" #
;
ÊÊ# $
}
ËË 
}
ÌÌ  
SqlParameterHelper
ÎÎ 
sph
ÎÎ "
=
ÎÎ# $
new
ÎÎ% ( 
SqlParameterHelper
ÎÎ) ;
(
ÎÎ; <
ConnectionString
ÎÎ< L
.
ÎÎL M%
GetReadConnectionString
ÎÎM d
(
ÎÎd e
)
ÎÎe f
,
ÎÎf g
$strÎÎh 
,ÎÎ 
$numÎÎ 
)ÎÎ 
;ÎÎ 
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# 1
,
ÏÏ1 2
	SqlDbType
ÏÏ3 <
.
ÏÏ< =
UniqueIdentifier
ÏÏ= M
,
ÏÏM N 
ParameterDirection
ÏÏO a
.
ÏÏa b
Input
ÏÏb g
,
ÏÏg h
contentGuid
ÏÏi t
)
ÏÏt u
;
ÏÏu v
sph
ÐÐ 
.
ÐÐ  
DefineSqlParameter
ÐÐ "
(
ÐÐ" #
$str
ÐÐ# 0
,
ÐÐ0 1
	SqlDbType
ÐÐ2 ;
.
ÐÐ; <
Int
ÐÐ< ?
,
ÐÐ? @ 
ParameterDirection
ÐÐA S
.
ÐÐS T
Input
ÐÐT Y
,
ÐÐY Z

pageNumber
ÐÐ[ e
)
ÐÐe f
;
ÐÐf g
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# .
,
ÑÑ. /
	SqlDbType
ÑÑ0 9
.
ÑÑ9 :
Int
ÑÑ: =
,
ÑÑ= > 
ParameterDirection
ÑÑ? Q
.
ÑÑQ R
Input
ÑÑR W
,
ÑÑW X
pageSize
ÑÑY a
)
ÑÑa b
;
ÑÑb c
return
ÒÒ 
sph
ÒÒ 
.
ÒÒ 
ExecuteReader
ÒÒ $
(
ÒÒ$ %
)
ÒÒ% &
;
ÒÒ& '
}
ÔÔ 	
}
ÖÖ 
}ØØ Ä¡
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentMeta.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 
DBContentMeta "
{ 
public 
static	 
int 
Create 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid 

moduleGuid 
, 
Guid 
contentGuid 
, 
string 	
name
 
, 
string 	
nameProperty
 
, 
string 	
scheme
 
, 
string   	
langCode  
 
,   
string!! 	
dir!!
 
,!! 
string"" 	
metaContent""
 
,"" 
string## 	
contentProperty##
 
,## 
int$$ 
sortRank$$ 
,$$ 
DateTime%% 

createdUtc%% 
,%% 
Guid&& 
	createdBy&& 
)&& 
{'' 
SqlParameterHelper(( 
sph(( 
=(( 
new(( 
SqlParameterHelper((  2
(((2 3
ConnectionString((3 C
.((C D$
GetWriteConnectionString((D \
(((\ ]
)((] ^
,((^ _
$str((` w
,((w x
$num((y {
)(({ |
;((| }
sph** 
.** 
DefineSqlParameter** 
(** 
$str** !
,**! "
	SqlDbType**# ,
.**, -
UniqueIdentifier**- =
,**= >
ParameterDirection**? Q
.**Q R
Input**R W
,**W X
guid**Y ]
)**] ^
;**^ _
sph++ 
.++ 
DefineSqlParameter++ 
(++ 
$str++ %
,++% &
	SqlDbType++' 0
.++0 1
UniqueIdentifier++1 A
,++A B
ParameterDirection++C U
.++U V
Input++V [
,++[ \
siteGuid++] e
)++e f
;++f g
sph,, 
.,, 
DefineSqlParameter,, 
(,, 
$str,, '
,,,' (
	SqlDbType,,) 2
.,,2 3
UniqueIdentifier,,3 C
,,,C D
ParameterDirection,,E W
.,,W X
Input,,X ]
,,,] ^

moduleGuid,,_ i
),,i j
;,,j k
sph-- 
.-- 
DefineSqlParameter-- 
(-- 
$str-- (
,--( )
	SqlDbType--* 3
.--3 4
UniqueIdentifier--4 D
,--D E
ParameterDirection--F X
.--X Y
Input--Y ^
,--^ _
contentGuid--` k
)--k l
;--l m
sph.. 
... 
DefineSqlParameter.. 
(.. 
$str.. !
,..! "
	SqlDbType..# ,
..., -
NVarChar..- 5
,..5 6
$num..7 :
,..: ;
ParameterDirection..< N
...N O
Input..O T
,..T U
name..V Z
)..Z [
;..[ \
sph// 
.// 
DefineSqlParameter// 
(// 
$str// )
,//) *
	SqlDbType//+ 4
.//4 5
NVarChar//5 =
,//= >
$num//? B
,//B C
ParameterDirection//D V
.//V W
Input//W \
,//\ ]
nameProperty//^ j
)//j k
;//k l
sph00 
.00 
DefineSqlParameter00 
(00 
$str00 #
,00# $
	SqlDbType00% .
.00. /
NVarChar00/ 7
,007 8
$num009 <
,00< =
ParameterDirection00> P
.00P Q
Input00Q V
,00V W
scheme00X ^
)00^ _
;00_ `
sph11 
.11 
DefineSqlParameter11 
(11 
$str11 %
,11% &
	SqlDbType11' 0
.110 1
NVarChar111 9
,119 :
$num11; =
,11= >
ParameterDirection11? Q
.11Q R
Input11R W
,11W X
langCode11Y a
)11a b
;11b c
sph22 
.22 
DefineSqlParameter22 
(22 
$str22  
,22  !
	SqlDbType22" +
.22+ ,
NVarChar22, 4
,224 5
$num226 7
,227 8
ParameterDirection229 K
.22K L
Input22L Q
,22Q R
dir22S V
)22V W
;22W X
sph33 
.33 
DefineSqlParameter33 
(33 
$str33 (
,33( )
	SqlDbType33* 3
.333 4
NVarChar334 <
,33< =
-33> ?
$num33? @
,33@ A
ParameterDirection33B T
.33T U
Input33U Z
,33Z [
metaContent33\ g
)33g h
;33h i
sph44 
.44 
DefineSqlParameter44 
(44 
$str44 ,
,44, -
	SqlDbType44. 7
.447 8
NVarChar448 @
,44@ A
$num44B E
,44E F
ParameterDirection44G Y
.44Y Z
Input44Z _
,44_ `
contentProperty44a p
)44p q
;44q r
sph55 
.55 
DefineSqlParameter55 
(55 
$str55 %
,55% &
	SqlDbType55' 0
.550 1
Int551 4
,554 5
ParameterDirection556 H
.55H I
Input55I N
,55N O
sortRank55P X
)55X Y
;55Y Z
sph66 
.66 
DefineSqlParameter66 
(66 
$str66 '
,66' (
	SqlDbType66) 2
.662 3
DateTime663 ;
,66; <
ParameterDirection66= O
.66O P
Input66P U
,66U V

createdUtc66W a
)66a b
;66b c
sph77 
.77 
DefineSqlParameter77 
(77 
$str77 &
,77& '
	SqlDbType77( 1
.771 2
UniqueIdentifier772 B
,77B C
ParameterDirection77D V
.77V W
Input77W \
,77\ ]
	createdBy77^ g
)77g h
;77h i
sph88 
.88 
DefineSqlParameter88 
(88 
$str88 '
,88' (
	SqlDbType88) 2
.882 3
DateTime883 ;
,88; <
ParameterDirection88= O
.88O P
Input88P U
,88U V

createdUtc88W a
)88a b
;88b c
sph99 
.99 
DefineSqlParameter99 
(99 
$str99 &
,99& '
	SqlDbType99( 1
.991 2
UniqueIdentifier992 B
,99B C
ParameterDirection99D V
.99V W
Input99W \
,99\ ]
	createdBy99^ g
)99g h
;99h i
int;; 
rowsAffected;; 
=;; 
sph;; 
.;; 
ExecuteNonQuery;; )
(;;) *
);;* +
;;;+ ,
return== 	
rowsAffected==
 
;== 
}>> 
publicEE 
staticEE	 
boolEE 
UpdateEE 
(EE 
GuidFF 
guidFF 
,FF 
stringGG 	
nameGG
 
,GG 
stringHH 	
namePropertyHH
 
,HH 
stringII 	
schemeII
 
,II 
stringJJ 	
langCodeJJ
 
,JJ 
stringKK 	
dirKK
 
,KK 
stringLL 	
metaContentLL
 
,LL 
stringMM 	
contentPropertyMM
 
,MM 
intNN 
sortRankNN 
,NN 
DateTimeOO 

lastModUtcOO 
,OO 
GuidPP 
	lastModByPP 
)PP 
{QQ 
SqlParameterHelperRR 
sphRR 
=RR 
newRR 
SqlParameterHelperRR  2
(RR2 3
ConnectionStringRR3 C
.RRC D$
GetWriteConnectionStringRRD \
(RR\ ]
)RR] ^
,RR^ _
$strRR` w
,RRw x
$numRRy {
)RR{ |
;RR| }
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT !
,TT! "
	SqlDbTypeTT# ,
.TT, -
UniqueIdentifierTT- =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
guidTTY ]
)TT] ^
;TT^ _
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU !
,UU! "
	SqlDbTypeUU# ,
.UU, -
NVarCharUU- 5
,UU5 6
$numUU7 :
,UU: ;
ParameterDirectionUU< N
.UUN O
InputUUO T
,UUT U
nameUUV Z
)UUZ [
;UU[ \
sphVV 
.VV 
DefineSqlParameterVV 
(VV 
$strVV )
,VV) *
	SqlDbTypeVV+ 4
.VV4 5
NVarCharVV5 =
,VV= >
$numVV? B
,VVB C
ParameterDirectionVVD V
.VVV W
InputVVW \
,VV\ ]
namePropertyVV^ j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW 
(WW 
$strWW #
,WW# $
	SqlDbTypeWW% .
.WW. /
NVarCharWW/ 7
,WW7 8
$numWW9 <
,WW< =
ParameterDirectionWW> P
.WWP Q
InputWWQ V
,WWV W
schemeWWX ^
)WW^ _
;WW_ `
sphXX 
.XX 
DefineSqlParameterXX 
(XX 
$strXX %
,XX% &
	SqlDbTypeXX' 0
.XX0 1
NVarCharXX1 9
,XX9 :
$numXX; =
,XX= >
ParameterDirectionXX? Q
.XXQ R
InputXXR W
,XXW X
langCodeXXY a
)XXa b
;XXb c
sphYY 
.YY 
DefineSqlParameterYY 
(YY 
$strYY  
,YY  !
	SqlDbTypeYY" +
.YY+ ,
NVarCharYY, 4
,YY4 5
$numYY6 7
,YY7 8
ParameterDirectionYY9 K
.YYK L
InputYYL Q
,YYQ R
dirYYS V
)YYV W
;YYW X
sphZZ 
.ZZ 
DefineSqlParameterZZ 
(ZZ 
$strZZ (
,ZZ( )
	SqlDbTypeZZ* 3
.ZZ3 4
NVarCharZZ4 <
,ZZ< =
-ZZ> ?
$numZZ? @
,ZZ@ A
ParameterDirectionZZB T
.ZZT U
InputZZU Z
,ZZZ [
metaContentZZ\ g
)ZZg h
;ZZh i
sph[[ 
.[[ 
DefineSqlParameter[[ 
([[ 
$str[[ ,
,[[, -
	SqlDbType[[. 7
.[[7 8
NVarChar[[8 @
,[[@ A
$num[[B E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
contentProperty[[a p
)[[p q
;[[q r
sph\\ 
.\\ 
DefineSqlParameter\\ 
(\\ 
$str\\ %
,\\% &
	SqlDbType\\' 0
.\\0 1
Int\\1 4
,\\4 5
ParameterDirection\\6 H
.\\H I
Input\\I N
,\\N O
sortRank\\P X
)\\X Y
;\\Y Z
sph]] 
.]] 
DefineSqlParameter]] 
(]] 
$str]] '
,]]' (
	SqlDbType]]) 2
.]]2 3
DateTime]]3 ;
,]]; <
ParameterDirection]]= O
.]]O P
Input]]P U
,]]U V

lastModUtc]]W a
)]]a b
;]]b c
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ &
,^^& '
	SqlDbType^^( 1
.^^1 2
UniqueIdentifier^^2 B
,^^B C
ParameterDirection^^D V
.^^V W
Input^^W \
,^^\ ]
	lastModBy^^^ g
)^^g h
;^^h i
int`` 
rowsAffected`` 
=`` 
sph`` 
.`` 
ExecuteNonQuery`` )
(``) *
)``* +
;``+ ,
returnbb 	
(bb
 
rowsAffectedbb 
>bb 
$numbb 
)bb 
;bb 
}cc 
publicjj 
staticjj	 
booljj 
Deletejj 
(jj 
Guidjj  
guidjj! %
)jj% &
{kk 
SqlParameterHelperll 
sphll 
=ll 
newll 
SqlParameterHelperll  2
(ll2 3
ConnectionStringll3 C
.llC D$
GetWriteConnectionStringllD \
(ll\ ]
)ll] ^
,ll^ _
$strll` w
,llw x
$numlly z
)llz {
;ll{ |
sphnn 
.nn 
DefineSqlParameternn 
(nn 
$strnn !
,nn! "
	SqlDbTypenn# ,
.nn, -
UniqueIdentifiernn- =
,nn= >
ParameterDirectionnn? Q
.nnQ R
InputnnR W
,nnW X
guidnnY ]
)nn] ^
;nn^ _
intpp 
rowsAffectedpp 
=pp 
sphpp 
.pp 
ExecuteNonQuerypp )
(pp) *
)pp* +
;pp+ ,
returnrr 	
(rr
 
rowsAffectedrr 
>rr 
$numrr 
)rr 
;rr 
}ss 
publiczz 
staticzz	 
boolzz 
DeleteBySitezz !
(zz! "
Guidzz" &
siteGuidzz' /
)zz/ 0
{{{ 
SqlParameterHelper|| 
sph|| 
=|| 
new|| 
SqlParameterHelper||  2
(||2 3
ConnectionString||3 C
.||C D$
GetWriteConnectionString||D \
(||\ ]
)||] ^
,||^ _
$str||` }
,||} ~
$num	|| 
)
|| 
;
|| 
sph~~ 
.~~ 
DefineSqlParameter~~ 
(~~ 
$str~~ %
,~~% &
	SqlDbType~~' 0
.~~0 1
UniqueIdentifier~~1 A
,~~A B
ParameterDirection~~C U
.~~U V
Input~~V [
,~~[ \
siteGuid~~] e
)~~e f
;~~f g
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 
DeleteByModule
 #
(
# $
Guid
$ (

moduleGuid
) 3
)
3 4
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 '
,
' (
	SqlDbType
) 2
.
2 3
UniqueIdentifier
3 C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^

moduleGuid
_ i
)
i j
;
j k
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 
DeleteByContent
 $
(
$ %
Guid
% )
contentGuid
* 5
)
5 6
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 (
,
( )
	SqlDbType
* 3
.
3 4
UniqueIdentifier
4 D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
contentGuid
` k
)
k l
;
l m
int
   
rowsAffected
   
=
   
sph
   
.
   
ExecuteNonQuery
   )
(
  ) *
)
  * +
;
  + ,
return
¢¢ 	
(
¢¢
 
rowsAffected
¢¢ 
>
¢¢ 
$num
¢¢ 
)
¢¢ 
;
¢¢ 
}
££ 
public
©© 
static
©©	 
IDataReader
©© 
GetOne
©© "
(
©©" #
Guid
©©# '
guid
©©( ,
)
©©, -
{
ªª  
SqlParameterHelper
«« 
sph
«« 
=
«« 
new
««  
SqlParameterHelper
««  2
(
««2 3
ConnectionString
««3 C
.
««C D%
GetReadConnectionString
««D [
(
««[ \
)
««\ ]
,
««] ^
$str
««_ y
,
««y z
$num
««{ |
)
««| }
;
««} ~
sph
­­ 
.
­­  
DefineSqlParameter
­­ 
(
­­ 
$str
­­ !
,
­­! "
	SqlDbType
­­# ,
.
­­, -
UniqueIdentifier
­­- =
,
­­= > 
ParameterDirection
­­? Q
.
­­Q R
Input
­­R W
,
­­W X
guid
­­Y ]
)
­­] ^
;
­­^ _
return
¯¯ 	
sph
¯¯
 
.
¯¯ 
ExecuteReader
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
}
°° 
public
¶¶ 
static
¶¶	 
IDataReader
¶¶ 
GetByContent
¶¶ (
(
¶¶( )
Guid
¶¶) -
contentGuid
¶¶. 9
)
¶¶9 :
{
··  
SqlParameterHelper
¸¸ 
sph
¸¸ 
=
¸¸ 
new
¸¸  
SqlParameterHelper
¸¸  2
(
¸¸2 3
ConnectionString
¸¸3 C
.
¸¸C D%
GetReadConnectionString
¸¸D [
(
¸¸[ \
)
¸¸\ ]
,
¸¸] ^
$str
¸¸_ 
,¸¸ 
$num¸¸ 
)¸¸ 
;¸¸ 
sph
ºº 
.
ºº  
DefineSqlParameter
ºº 
(
ºº 
$str
ºº (
,
ºº( )
	SqlDbType
ºº* 3
.
ºº3 4
UniqueIdentifier
ºº4 D
,
ººD E 
ParameterDirection
ººF X
.
ººX Y
Input
ººY ^
,
ºº^ _
contentGuid
ºº` k
)
ººk l
;
ººl m
return
¼¼ 	
sph
¼¼
 
.
¼¼ 
ExecuteReader
¼¼ 
(
¼¼ 
)
¼¼ 
;
¼¼ 
}
½½ 
public
ÄÄ 
static
ÄÄ	 
int
ÄÄ 
GetMaxSortRank
ÄÄ "
(
ÄÄ" #
Guid
ÄÄ# '
contentGuid
ÄÄ( 3
)
ÄÄ3 4
{
ÅÅ  
SqlParameterHelper
ÆÆ 
sph
ÆÆ 
=
ÆÆ 
new
ÆÆ  
SqlParameterHelper
ÆÆ  2
(
ÆÆ2 3
ConnectionString
ÆÆ3 C
.
ÆÆC D%
GetReadConnectionString
ÆÆD [
(
ÆÆ[ \
)
ÆÆ\ ]
,
ÆÆ] ^
$str
ÆÆ_ 
,ÆÆ 
$numÆÆ 
)ÆÆ 
;ÆÆ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ 
(
ÈÈ 
$str
ÈÈ (
,
ÈÈ( )
	SqlDbType
ÈÈ* 3
.
ÈÈ3 4
UniqueIdentifier
ÈÈ4 D
,
ÈÈD E 
ParameterDirection
ÈÈF X
.
ÈÈX Y
Input
ÈÈY ^
,
ÈÈ^ _
contentGuid
ÈÈ` k
)
ÈÈk l
;
ÈÈl m
int
ÊÊ 
	pageOrder
ÊÊ 
=
ÊÊ 
Convert
ÊÊ 
.
ÊÊ 
ToInt32
ÊÊ "
(
ÊÊ" #
sph
ÊÊ# &
.
ÊÊ& '
ExecuteScalar
ÊÊ' 4
(
ÊÊ4 5
)
ÊÊ5 6
)
ÊÊ6 7
;
ÊÊ7 8
return
ÌÌ 	
	pageOrder
ÌÌ
 
;
ÌÌ 
}
ÍÍ 
}
ÎÎ 
}ÏÏ ÿ
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentMetaLink.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentMetaLink )
{ 
publicGG 
staticGG 
intGG 
CreateGG  
(GG  !
GuidHH 
guidHH 
,HH 
GuidII 
siteGuidII 
,II 
GuidJJ 

moduleGuidJJ 
,JJ 
GuidKK 
contentGuidKK 
,KK 
stringLL 
relLL 
,LL 
stringMM 
hrefMM 
,MM 
stringNN 
hrefLangNN 
,NN 
stringOO 
revOO 
,OO 
stringPP 
typePP 
,PP 
stringQQ 
mediaQQ 
,QQ 
intRR 
sortRankRR 
,RR 
DateTimeSS 

createdUtcSS 
,SS  
GuidTT 
	createdByTT 
)TT 
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$str	VVi 
,
VV 
$num
VV 
)
VV 
;
VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# *
,WW* +
	SqlDbTypeWW, 5
.WW5 6
UniqueIdentifierWW6 F
,WWF G
ParameterDirectionWWH Z
.WWZ [
InputWW[ `
,WW` a
guidWWb f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
siteGuidXXf n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 0
,YY0 1
	SqlDbTypeYY2 ;
.YY; <
UniqueIdentifierYY< L
,YYL M
ParameterDirectionYYN `
.YY` a
InputYYa f
,YYf g

moduleGuidYYh r
)YYr s
;YYs t
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 1
,ZZ1 2
	SqlDbTypeZZ3 <
.ZZ< =
UniqueIdentifierZZ= M
,ZZM N
ParameterDirectionZZO a
.ZZa b
InputZZb g
,ZZg h
contentGuidZZi t
)ZZt u
;ZZu v
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# )
,[[) *
	SqlDbType[[+ 4
.[[4 5
NVarChar[[5 =
,[[= >
$num[[? B
,[[B C
ParameterDirection[[D V
.[[V W
Input[[W \
,[[\ ]
rel[[^ a
)[[a b
;[[b c
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# *
,\\* +
	SqlDbType\\, 5
.\\5 6
NVarChar\\6 >
,\\> ?
$num\\@ C
,\\C D
ParameterDirection\\E W
.\\W X
Input\\X ]
,\\] ^
href\\_ c
)\\c d
;\\d e
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# .
,]]. /
	SqlDbType]]0 9
.]]9 :
NVarChar]]: B
,]]B C
$num]]D F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
hrefLang]]b j
)]]j k
;]]k l
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# )
,^^) *
	SqlDbType^^+ 4
.^^4 5
NVarChar^^5 =
,^^= >
$num^^? A
,^^A B
ParameterDirection^^C U
.^^U V
Input^^V [
,^^[ \
rev^^] `
)^^` a
;^^a b
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# *
,__* +
	SqlDbType__, 5
.__5 6
NVarChar__6 >
,__> ?
$num__@ B
,__B C
ParameterDirection__D V
.__V W
Input__W \
,__\ ]
type__^ b
)__b c
;__c d
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# +
,``+ ,
	SqlDbType``- 6
.``6 7
NVarChar``7 ?
,``? @
$num``A C
,``C D
ParameterDirection``E W
.``W X
Input``X ]
,``] ^
media``_ d
)``d e
;``e f
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# .
,aa. /
	SqlDbTypeaa0 9
.aa9 :
Intaa: =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
sortRankaaY a
)aaa b
;aab c
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
DateTimebb< D
,bbD E
ParameterDirectionbbF X
.bbX Y
InputbbY ^
,bb^ _

createdUtcbb` j
)bbj k
;bbk l
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
UniqueIdentifiercc; K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
	createdByccg p
)ccp q
;ccq r
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
DateTimedd< D
,ddD E
ParameterDirectionddF X
.ddX Y
InputddY ^
,dd^ _

createdUtcdd` j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
UniqueIdentifieree; K
,eeK L
ParameterDirectioneeM _
.ee_ `
Inputee` e
,eee f
	createdByeeg p
)eep q
;eeq r
intff 
rowsAffectedff 
=ff 
sphff "
.ff" #
ExecuteNonQueryff# 2
(ff2 3
)ff3 4
;ff4 5
returngg 
rowsAffectedgg 
;gg  
}ii 	
publiczz 
staticzz 
boolzz 
Updatezz !
(zz! "
Guid{{ 
guid{{ 
,{{ 
string|| 
rel|| 
,|| 
string}} 
href}} 
,}} 
string~~ 
hrefLang~~ 
,~~ 
string 
rev 
, 
string
 
type
 
,
 
string
 
media
 
,
 
int
 
sortRank
 
,
 
DateTime
 

lastModUtc
 
,
  
Guid
 
	lastModBy
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# )
,
) *
	SqlDbType
+ 4
.
4 5
NVarChar
5 =
,
= >
$num
? B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
rel
^ a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
NVarChar
6 >
,
> ?
$num
@ C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
href
_ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
hrefLang
b j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# )
,
) *
	SqlDbType
+ 4
.
4 5
NVarChar
5 =
,
= >
$num
? A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
rev
] `
)
` a
;
a b
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
NVarChar
6 >
,
> ?
$num
@ B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
type
^ b
)
b c
;
c d
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
NVarChar
7 ?
,
? @
$num
A C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
media
_ d
)
d e
;
e f
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
sortRank
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
DateTime
< D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _

lastModUtc
` j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	lastModBy
g p
)
p q
;
q r
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
   
(
   
rowsAffected
    
>
  ! "
$num
  # $
)
  $ %
;
  % &
}
¢¢ 	
public
©© 
static
©© 
bool
©© 
DeleteBySite
©© '
(
©©' (
Guid
©©( ,
siteGuid
©©- 5
)
©©5 6
{
ªª 	 
SqlParameterHelper
«« 
sph
«« "
=
««# $
new
««% ( 
SqlParameterHelper
««) ;
(
««; <
ConnectionString
««< L
.
««L M&
GetWriteConnectionString
««M e
(
««e f
)
««f g
,
««g h
$str««i 
,«« 
$num«« 
)«« 
;«« 
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# .
,
¬¬. /
	SqlDbType
¬¬0 9
.
¬¬9 :
UniqueIdentifier
¬¬: J
,
¬¬J K 
ParameterDirection
¬¬L ^
.
¬¬^ _
Input
¬¬_ d
,
¬¬d e
siteGuid
¬¬f n
)
¬¬n o
;
¬¬o p
int
­­ 
rowsAffected
­­ 
=
­­ 
sph
­­ "
.
­­" #
ExecuteNonQuery
­­# 2
(
­­2 3
)
­­3 4
;
­­4 5
return
®® 
(
®® 
rowsAffected
®®  
>
®®! "
$num
®®# $
)
®®$ %
;
®®% &
}
°° 	
public
·· 
static
·· 
bool
·· 
DeleteByModule
·· )
(
··) *
Guid
··* .

moduleGuid
··/ 9
)
··9 :
{
¸¸ 	 
SqlParameterHelper
¹¹ 
sph
¹¹ "
=
¹¹# $
new
¹¹% ( 
SqlParameterHelper
¹¹) ;
(
¹¹; <
ConnectionString
¹¹< L
.
¹¹L M&
GetWriteConnectionString
¹¹M e
(
¹¹e f
)
¹¹f g
,
¹¹g h
$str¹¹i 
,¹¹ 
$num¹¹ 
)¹¹ 
;¹¹ 
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 0
,
ºº0 1
	SqlDbType
ºº2 ;
.
ºº; <
UniqueIdentifier
ºº< L
,
ººL M 
ParameterDirection
ººN `
.
ºº` a
Input
ººa f
,
ººf g

moduleGuid
ººh r
)
ººr s
;
ººs t
int
»» 
rowsAffected
»» 
=
»» 
sph
»» "
.
»»" #
ExecuteNonQuery
»»# 2
(
»»2 3
)
»»3 4
;
»»4 5
return
¼¼ 
(
¼¼ 
rowsAffected
¼¼  
>
¼¼! "
$num
¼¼# $
)
¼¼$ %
;
¼¼% &
}
¾¾ 	
public
ÅÅ 
static
ÅÅ 
bool
ÅÅ 
DeleteByContent
ÅÅ *
(
ÅÅ* +
Guid
ÅÅ+ /
contentGuid
ÅÅ0 ;
)
ÅÅ; <
{
ÆÆ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M&
GetWriteConnectionString
ÇÇM e
(
ÇÇe f
)
ÇÇf g
,
ÇÇg h
$strÇÇi 
,ÇÇ 
$numÇÇ 
)ÇÇ 
;ÇÇ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 1
,
ÈÈ1 2
	SqlDbType
ÈÈ3 <
.
ÈÈ< =
UniqueIdentifier
ÈÈ= M
,
ÈÈM N 
ParameterDirection
ÈÈO a
.
ÈÈa b
Input
ÈÈb g
,
ÈÈg h
contentGuid
ÈÈi t
)
ÈÈt u
;
ÈÈu v
int
ÉÉ 
rowsAffected
ÉÉ 
=
ÉÉ 
sph
ÉÉ "
.
ÉÉ" #
ExecuteNonQuery
ÉÉ# 2
(
ÉÉ2 3
)
ÉÉ3 4
;
ÉÉ4 5
return
ÊÊ 
(
ÊÊ 
rowsAffected
ÊÊ  
>
ÊÊ! "
$num
ÊÊ# $
)
ÊÊ$ %
;
ÊÊ% &
}
ÌÌ 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !
GetOne
ÒÒ" (
(
ÒÒ( )
Guid
ÒÒ) -
guid
ÒÒ. 2
)
ÒÒ2 3
{
ÓÓ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh 
,ÔÔ 
$numÔÔ 
)ÔÔ 
;ÔÔ 
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# *
,
ÕÕ* +
	SqlDbType
ÕÕ, 5
.
ÕÕ5 6
UniqueIdentifier
ÕÕ6 F
,
ÕÕF G 
ParameterDirection
ÕÕH Z
.
ÕÕZ [
Input
ÕÕ[ `
,
ÕÕ` a
guid
ÕÕb f
)
ÕÕf g
;
ÕÕg h
return
ÖÖ 
sph
ÖÖ 
.
ÖÖ 
ExecuteReader
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
}
ØØ 	
public
ÞÞ 
static
ÞÞ 
IDataReader
ÞÞ !
GetByContent
ÞÞ" .
(
ÞÞ. /
Guid
ÞÞ/ 3
contentGuid
ÞÞ4 ?
)
ÞÞ? @
{
ßß 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh 
,àà 
$numàà 
)àà 
;àà 
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 1
,
áá1 2
	SqlDbType
áá3 <
.
áá< =
UniqueIdentifier
áá= M
,
ááM N 
ParameterDirection
ááO a
.
ááa b
Input
ááb g
,
áág h
contentGuid
áái t
)
áát u
;
ááu v
return
ââ 
sph
ââ 
.
ââ 
ExecuteReader
ââ $
(
ââ$ %
)
ââ% &
;
ââ& '
}
ää 	
public
ææ 
static
ææ 
int
ææ 
GetMaxSortRank
ææ (
(
ææ( )
Guid
ææ) -
contentGuid
ææ. 9
)
ææ9 :
{
çç 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh 
,èè 
$numèè 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 1
,
éé1 2
	SqlDbType
éé3 <
.
éé< =
UniqueIdentifier
éé= M
,
ééM N 
ParameterDirection
ééO a
.
ééa b
Input
ééb g
,
éég h
contentGuid
ééi t
)
éét u
;
ééu v
return
êê 
Convert
êê 
.
êê 
ToInt32
êê "
(
êê" #
sph
êê# &
.
êê& '
ExecuteScalar
êê' 4
(
êê4 5
)
êê5 6
)
êê6 7
;
êê7 8
}
ìì 	
}
òò 
}ôô Â
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentRating.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentRating '
{ 
public22 
static22 
int22 
Create22  
(22  !
Guid33 
rowGuid33 
,33 
Guid44 
siteGuid44 
,44 
Guid55 
contentGuid55 
,55 
Guid66 
userGuid66 
,66 
string77 
emailAddress77 
,77  
int88 
rating88 
,88 
string99 
comments99 
,99 
string:: 
	ipAddress:: 
,:: 
DateTime;; 

createdUtc;; 
);;  
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str	==i 
,
== 
$num
== 
)
== 
;
== 
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># -
,>>- .
	SqlDbType>>/ 8
.>>8 9
UniqueIdentifier>>9 I
,>>I J
ParameterDirection>>K ]
.>>] ^
Input>>^ c
,>>c d
rowGuid>>e l
)>>l m
;>>m n
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# .
,??. /
	SqlDbType??0 9
.??9 :
UniqueIdentifier??: J
,??J K
ParameterDirection??L ^
.??^ _
Input??_ d
,??d e
siteGuid??f n
)??n o
;??o p
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 1
,@@1 2
	SqlDbType@@3 <
.@@< =
UniqueIdentifier@@= M
,@@M N
ParameterDirection@@O a
.@@a b
Input@@b g
,@@g h
contentGuid@@i t
)@@t u
;@@u v
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
UniqueIdentifierAA: J
,AAJ K
ParameterDirectionAAL ^
.AA^ _
InputAA_ d
,AAd e
userGuidAAf n
)AAn o
;AAo p
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 2
,BB2 3
	SqlDbTypeBB4 =
.BB= >
NVarCharBB> F
,BBF G
$numBBH K
,BBK L
ParameterDirectionBBM _
.BB_ `
InputBB` e
,BBe f
emailAddressBBg s
)BBs t
;BBt u
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# ,
,CC, -
	SqlDbTypeCC. 7
.CC7 8
IntCC8 ;
,CC; <
ParameterDirectionCC= O
.CCO P
InputCCP U
,CCU V
ratingCCW ]
)CC] ^
;CC^ _
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# .
,DD. /
	SqlDbTypeDD0 9
.DD9 :
NVarCharDD: B
,DDB C
-DDD E
$numDDE F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
commentsDDb j
)DDj k
;DDk l
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# /
,EE/ 0
	SqlDbTypeEE1 :
.EE: ;
NVarCharEE; C
,EEC D
$numEEE G
,EEG H
ParameterDirectionEEI [
.EE[ \
InputEE\ a
,EEa b
	ipAddressEEc l
)EEl m
;EEm n
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 0
,FF0 1
	SqlDbTypeFF2 ;
.FF; <
DateTimeFF< D
,FFD E
ParameterDirectionFFF X
.FFX Y
InputFFY ^
,FF^ _

createdUtcFF` j
)FFj k
;FFk l
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 0
,GG0 1
	SqlDbTypeGG2 ;
.GG; <
DateTimeGG< D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _

createdUtcGG` j
)GGj k
;GGk l
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
rowsAffectedII 
;II  
}KK 	
publicXX 
staticXX 
boolXX 
UpdateXX !
(XX! "
GuidYY 
rowGuidYY 
,YY 
stringZZ 
emailAddressZZ 
,ZZ  
int[[ 
rating[[ 
,[[ 
string\\ 
comments\\ 
,\\ 
string]] 
	ipAddress]] 
,]] 
DateTime^^ 

lastModUtc^^ 
)^^  
{__ 	
SqlParameterHelper`` 
sph`` "
=``# $
new``% (
SqlParameterHelper``) ;
(``; <
ConnectionString``< L
.``L M$
GetWriteConnectionString``M e
(``e f
)``f g
,``g h
$str	``i 
,
`` 
$num
`` 
)
`` 
;
`` 
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# -
,aa- .
	SqlDbTypeaa/ 8
.aa8 9
UniqueIdentifieraa9 I
,aaI J
ParameterDirectionaaK ]
.aa] ^
Inputaa^ c
,aac d
rowGuidaae l
)aal m
;aam n
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
NVarCharbb> F
,bbF G
$numbbH K
,bbK L
ParameterDirectionbbM _
.bb_ `
Inputbb` e
,bbe f
emailAddressbbg s
)bbs t
;bbt u
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# ,
,cc, -
	SqlDbTypecc. 7
.cc7 8
Intcc8 ;
,cc; <
ParameterDirectioncc= O
.ccO P
InputccP U
,ccU V
ratingccW ]
)cc] ^
;cc^ _
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# .
,dd. /
	SqlDbTypedd0 9
.dd9 :
NVarChardd: B
,ddB C
-ddD E
$numddE F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
commentsddb j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
NVarCharee; C
,eeC D
$numeeE G
,eeG H
ParameterDirectioneeI [
.ee[ \
Inputee\ a
,eea b
	ipAddresseec l
)eel m
;eem n
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 0
,ff0 1
	SqlDbTypeff2 ;
.ff; <
DateTimeff< D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _

lastModUtcff` j
)ffj k
;ffk l
intgg 
rowsAffectedgg 
=gg 
sphgg "
.gg" #
ExecuteNonQuerygg# 2
(gg2 3
)gg3 4
;gg4 5
returnhh 
(hh 
rowsAffectedhh  
>hh! "
$numhh# $
)hh$ %
;hh% &
}jj 	
publicqq 
staticqq 
boolqq 
Deleteqq !
(qq! "
Guidqq" &
rowGuidqq' .
)qq. /
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$str	ssi 
,
ss 
$num
ss 
)
ss 
;
ss 
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# -
,tt- .
	SqlDbTypett/ 8
.tt8 9
UniqueIdentifiertt9 I
,ttI J
ParameterDirectionttK ]
.tt] ^
Inputtt^ c
,ttc d
rowGuidtte l
)ttl m
;ttm n
intuu 
rowsAffecteduu 
=uu 
sphuu "
.uu" #
ExecuteNonQueryuu# 2
(uu2 3
)uu3 4
;uu4 5
returnvv 
(vv 
rowsAffectedvv  
>vv! "
$numvv# $
)vv$ %
;vv% &
}xx 	
public 
static 
bool 
DeleteByContent *
(* +
Guid+ /
contentGuid0 ;
); <
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
contentGuid
i t
)
t u
;
u v
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByUser
 '
(
' (
Guid
( ,
userGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
   
(
   
rowsAffected
    
>
  ! "
$num
  # $
)
  $ %
;
  % &
}
¢¢ 	
public
¨¨ 
static
¨¨ 
IDataReader
¨¨ !
GetOne
¨¨" (
(
¨¨( )
Guid
¨¨) -
rowGuid
¨¨. 5
)
¨¨5 6
{
©© 	 
SqlParameterHelper
ªª 
sph
ªª "
=
ªª# $
new
ªª% ( 
SqlParameterHelper
ªª) ;
(
ªª; <
ConnectionString
ªª< L
.
ªªL M%
GetReadConnectionString
ªªM d
(
ªªd e
)
ªªe f
,
ªªf g
$strªªh 
,ªª 
$numªª 
)ªª 
;ªª 
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# -
,
««- .
	SqlDbType
««/ 8
.
««8 9
UniqueIdentifier
««9 I
,
««I J 
ParameterDirection
««K ]
.
««] ^
Input
««^ c
,
««c d
rowGuid
««e l
)
««l m
;
««m n
return
¬¬ 
sph
¬¬ 
.
¬¬ 
ExecuteReader
¬¬ $
(
¬¬$ %
)
¬¬% &
;
¬¬& '
}
®® 	
public
µµ 
static
µµ 
IDataReader
µµ !$
GetOneByContentAndUser
µµ" 8
(
µµ8 9
Guid
µµ9 =
contentGuid
µµ> I
,
µµI J
Guid
µµK O
userGuid
µµP X
)
µµX Y
{
¶¶ 	 
SqlParameterHelper
·· 
sph
·· "
=
··# $
new
··% ( 
SqlParameterHelper
··) ;
(
··; <
ConnectionString
··< L
.
··L M%
GetReadConnectionString
··M d
(
··d e
)
··e f
,
··f g
$str··h 
,·· 
$num·· 
)·· 
;·· 
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 1
,
¸¸1 2
	SqlDbType
¸¸3 <
.
¸¸< =
UniqueIdentifier
¸¸= M
,
¸¸M N 
ParameterDirection
¸¸O a
.
¸¸a b
Input
¸¸b g
,
¸¸g h
contentGuid
¸¸i t
)
¸¸t u
;
¸¸u v
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# .
,
¹¹. /
	SqlDbType
¹¹0 9
.
¹¹9 :
UniqueIdentifier
¹¹: J
,
¹¹J K 
ParameterDirection
¹¹L ^
.
¹¹^ _
Input
¹¹_ d
,
¹¹d e
userGuid
¹¹f n
)
¹¹n o
;
¹¹o p
return
ºº 
sph
ºº 
.
ºº 
ExecuteReader
ºº $
(
ºº$ %
)
ºº% &
;
ºº& '
}
¼¼ 	
public
ÂÂ 
static
ÂÂ 
IDataReader
ÂÂ !
GetStatsByContent
ÂÂ" 3
(
ÂÂ3 4
Guid
ÂÂ4 8
contentGuid
ÂÂ9 D
)
ÂÂD E
{
ÃÃ 	 
SqlParameterHelper
ÄÄ 
sph
ÄÄ "
=
ÄÄ# $
new
ÄÄ% ( 
SqlParameterHelper
ÄÄ) ;
(
ÄÄ; <
ConnectionString
ÄÄ< L
.
ÄÄL M%
GetReadConnectionString
ÄÄM d
(
ÄÄd e
)
ÄÄe f
,
ÄÄf g
$strÄÄh 
,ÄÄ 
$numÄÄ 
)ÄÄ 
;ÄÄ 
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 1
,
ÅÅ1 2
	SqlDbType
ÅÅ3 <
.
ÅÅ< =
UniqueIdentifier
ÅÅ= M
,
ÅÅM N 
ParameterDirection
ÅÅO a
.
ÅÅa b
Input
ÅÅb g
,
ÅÅg h
contentGuid
ÅÅi t
)
ÅÅt u
;
ÅÅu v
return
ÆÆ 
sph
ÆÆ 
.
ÆÆ 
ExecuteReader
ÆÆ $
(
ÆÆ$ %
)
ÆÆ% &
;
ÆÆ& '
}
ÈÈ 	
public
ÏÏ 
static
ÏÏ 
int
ÏÏ 
GetCountByContent
ÏÏ +
(
ÏÏ+ ,
Guid
ÏÏ, 0
contentGuid
ÏÏ1 <
)
ÏÏ< =
{
ÐÐ 	 
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M%
GetReadConnectionString
ÑÑM d
(
ÑÑd e
)
ÑÑe f
,
ÑÑf g
$strÑÑh 
,ÑÑ 
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 1
,
ÒÒ1 2
	SqlDbType
ÒÒ3 <
.
ÒÒ< =
UniqueIdentifier
ÒÒ= M
,
ÒÒM N 
ParameterDirection
ÒÒO a
.
ÒÒa b
Input
ÒÒb g
,
ÒÒg h
contentGuid
ÒÒi t
)
ÒÒt u
;
ÒÒu v
return
ÓÓ 
Convert
ÓÓ 
.
ÓÓ 
ToInt32
ÓÓ "
(
ÓÓ" #
sph
ÓÓ# &
.
ÓÓ& '
ExecuteScalar
ÓÓ' 4
(
ÓÓ4 5
)
ÓÓ5 6
)
ÓÓ6 7
;
ÓÓ7 8
}
ÕÕ 	
public
ÚÚ 
static
ÚÚ 
int
ÚÚ &
GetCountByContentAndUser
ÚÚ 2
(
ÚÚ2 3
Guid
ÚÚ3 7
contentGuid
ÚÚ8 C
,
ÚÚC D
Guid
ÚÚE I
userGuid
ÚÚJ R
)
ÚÚR S
{
ÛÛ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$strÜÜh 
,ÜÜ 
$numÜÜ 
)ÜÜ 
;ÜÜ 
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# 1
,
ÝÝ1 2
	SqlDbType
ÝÝ3 <
.
ÝÝ< =
UniqueIdentifier
ÝÝ= M
,
ÝÝM N 
ParameterDirection
ÝÝO a
.
ÝÝa b
Input
ÝÝb g
,
ÝÝg h
contentGuid
ÝÝi t
)
ÝÝt u
;
ÝÝu v
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# .
,
ÞÞ. /
	SqlDbType
ÞÞ0 9
.
ÞÞ9 :
UniqueIdentifier
ÞÞ: J
,
ÞÞJ K 
ParameterDirection
ÞÞL ^
.
ÞÞ^ _
Input
ÞÞ_ d
,
ÞÞd e
userGuid
ÞÞf n
)
ÞÞn o
;
ÞÞo p
return
ßß 
Convert
ßß 
.
ßß 
ToInt32
ßß "
(
ßß" #
sph
ßß# &
.
ßß& '
ExecuteScalar
ßß' 4
(
ßß4 5
)
ßß5 6
)
ßß6 7
;
ßß7 8
}
áá 	
public
ææ 
static
ææ 
int
ææ $
GetCountOfRatingsSince
ææ 0
(
ææ0 1
Guid
ææ1 5
contentGuid
ææ6 A
,
ææA B
string
ææC I
	ipAddress
ææJ S
,
ææS T
DateTime
ææU ]
beginUtc
ææ^ f
)
ææf g
{
çç 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh 
,èè 
$numèè 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 1
,
éé1 2
	SqlDbType
éé3 <
.
éé< =
UniqueIdentifier
éé= M
,
ééM N 
ParameterDirection
ééO a
.
ééa b
Input
ééb g
,
éég h
contentGuid
ééi t
)
éét u
;
ééu v
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# /
,
êê/ 0
	SqlDbType
êê1 :
.
êê: ;
NVarChar
êê; C
,
êêC D
$num
êêE G
,
êêG H 
ParameterDirection
êêI [
.
êê[ \
Input
êê\ a
,
êêa b
	ipAddress
êêc l
)
êêl m
;
êêm n
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# .
,
ëë. /
	SqlDbType
ëë0 9
.
ëë9 :
DateTime
ëë: B
,
ëëB C 
ParameterDirection
ëëD V
.
ëëV W
Input
ëëW \
,
ëë\ ]
beginUtc
ëë^ f
)
ëëf g
;
ëëg h
return
ìì 
Convert
ìì 
.
ìì 
ToInt32
ìì "
(
ìì" #
sph
ìì# &
.
ìì& '
ExecuteScalar
ìì' 4
(
ìì4 5
)
ìì5 6
)
ìì6 7
;
ìì7 8
}
îî 	
public
ùù 
static
ùù 
IDataReader
ùù !
GetPage
ùù" )
(
ùù) *
Guid
úú 
contentGuid
úú 
,
úú 
int
ûû 

pageNumber
ûû 
,
ûû 
int
üü 
pageSize
üü 
,
üü 
out
ýý 
int
ýý 

totalPages
ýý 
)
ýý 
{
þþ 	

totalPages
ÿÿ 
=
ÿÿ 
$num
ÿÿ 
;
ÿÿ 
int
 
	totalRows
 
=
 
GetCountByContent
 #
(
# $
contentGuid
$ /
)
/ 0
;
0 1
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
contentGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
}
 
} þú
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentStyle.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentStyle &
{ 
publicBB 
staticBB 
intBB 
CreateBB  
(BB  !
GuidCC 
guidCC 
,CC 
GuidDD 
siteGuidDD 
,DD 
stringEE 
nameEE 
,EE 
stringFF 
elementFF 
,FF 
stringGG 
cssClassGG 
,GG 
stringHH 
skinNameHH 
,HH 
boolII 
isActiveII 
,II 
DateTimeJJ 

createdUtcJJ 
,JJ  
GuidKK 
	createdByKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi 
,
MM 
$num
MM 
)
MM 
;
MM 
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
UniqueIdentifierNN6 F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
guidNNb f
)NNf g
;NNg h
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
UniqueIdentifierOO: J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
siteGuidOOf n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
namePP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
NVarCharQQ9 A
,QQA B
$numQQC E
,QQE F
ParameterDirectionQQG Y
.QQY Z
InputQQZ _
,QQ_ `
elementQQa h
)QQh i
;QQi j
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
NVarCharRR: B
,RRB C
$numRRD F
,RRF G
ParameterDirectionRRH Z
.RRZ [
InputRR[ `
,RR` a
cssClassRRb j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
NVarCharSS: B
,SSB C
$numSSD G
,SSG H
ParameterDirectionSSI [
.SS[ \
InputSS\ a
,SSa b
skinNameSSc k
)SSk l
;SSl m
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
BitTT: =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
isActiveTTY a
)TTa b
;TTb c
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 0
,UU0 1
	SqlDbTypeUU2 ;
.UU; <
DateTimeUU< D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _

createdUtcUU` j
)UUj k
;UUk l
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

createdUtcVV` j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
UniqueIdentifierWW; K
,WWK L
ParameterDirectionWWM _
.WW_ `
InputWW` e
,WWe f
	createdByWWg p
)WWp q
;WWq r
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# /
,XX/ 0
	SqlDbTypeXX1 :
.XX: ;
UniqueIdentifierXX; K
,XXK L
ParameterDirectionXXM _
.XX_ `
InputXX` e
,XXe f
	createdByXXg p
)XXp q
;XXq r
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
rowsAffectedZZ 
;ZZ  
}\\ 	
publicll 
staticll 
boolll 
Updatell !
(ll! "
Guidmm 
guidmm 
,mm 
Guidnn 
siteGuidnn 
,nn 
stringoo 
nameoo 
,oo 
stringpp 
elementpp 
,pp 
stringqq 
cssClassqq 
,qq 
stringrr 
skinNamerr 
,rr 
boolss 
isActivess 
,ss 
DateTimett 

lastModUtctt 
,tt  
Guiduu 
	lastModByuu 
)uu 
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi 
,
ww 
$num
ww 
)
ww 
;
ww 
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
UniqueIdentifierxx6 F
,xxF G
ParameterDirectionxxH Z
.xxZ [
Inputxx[ `
,xx` a
guidxxb f
)xxf g
;xxg h
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# .
,yy. /
	SqlDbTypeyy0 9
.yy9 :
UniqueIdentifieryy: J
,yyJ K
ParameterDirectionyyL ^
.yy^ _
Inputyy_ d
,yyd e
siteGuidyyf n
)yyn o
;yyo p
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
NVarCharzz6 >
,zz> ?
$numzz@ C
,zzC D
ParameterDirectionzzE W
.zzW X
InputzzX ]
,zz] ^
namezz_ c
)zzc d
;zzd e
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# -
,{{- .
	SqlDbType{{/ 8
.{{8 9
NVarChar{{9 A
,{{A B
$num{{C E
,{{E F
ParameterDirection{{G Y
.{{Y Z
Input{{Z _
,{{_ `
element{{a h
){{h i
;{{i j
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# .
,||. /
	SqlDbType||0 9
.||9 :
NVarChar||: B
,||B C
$num||D F
,||F G
ParameterDirection||H Z
.||Z [
Input||[ `
,||` a
cssClass||b j
)||j k
;||k l
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# .
,}}. /
	SqlDbType}}0 9
.}}9 :
NVarChar}}: B
,}}B C
$num}}D G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
skinName}}c k
)}}k l
;}}l m
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# .
,~~. /
	SqlDbType~~0 9
.~~9 :
Bit~~: =
,~~= >
ParameterDirection~~? Q
.~~Q R
Input~~R W
,~~W X
isActive~~Y a
)~~a b
;~~b c
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
DateTime< D
,D E
ParameterDirectionF X
.X Y
InputY ^
,^ _

lastModUtc` j
)j k
;k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	lastModBy
g p
)
p q
;
q r
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
   	
public
§§ 
static
§§ 
bool
§§ 
DeleteBySkin
§§ '
(
§§' (
Guid
§§( ,
siteGuid
§§- 5
,
§§5 6
string
§§7 =
skinName
§§> F
)
§§F G
{
¨¨ 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i 
,©© 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
UniqueIdentifier
ªª: J
,
ªªJ K 
ParameterDirection
ªªL ^
.
ªª^ _
Input
ªª_ d
,
ªªd e
siteGuid
ªªf n
)
ªªn o
;
ªªo p
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# .
,
««. /
	SqlDbType
««0 9
.
««9 :
NVarChar
««: B
,
««B C
$num
««D G
,
««G H 
ParameterDirection
««I [
.
««[ \
Input
««\ a
,
««a b
skinName
««c k
)
««k l
;
««l m
int
¬¬ 
rowsAffected
¬¬ 
=
¬¬ 
sph
¬¬ "
.
¬¬" #
ExecuteNonQuery
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
return
­­ 
(
­­ 
rowsAffected
­­  
>
­­! "
$num
­­# $
)
­­$ %
;
­­% &
}
¯¯ 	
public
¶¶ 
static
¶¶ 
bool
¶¶ !
SetActivationBySkin
¶¶ .
(
¶¶. /
Guid
¶¶/ 3
siteGuid
¶¶4 <
,
¶¶< =
string
¶¶> D
skinName
¶¶E M
,
¶¶M N
bool
¶¶O S
isActive
¶¶T \
)
¶¶\ ]
{
·· 	 
SqlParameterHelper
¸¸ 
sph
¸¸ "
=
¸¸# $
new
¸¸% ( 
SqlParameterHelper
¸¸) ;
(
¸¸; <
ConnectionString
¸¸< L
.
¸¸L M&
GetWriteConnectionString
¸¸M e
(
¸¸e f
)
¸¸f g
,
¸¸g h
$str¸¸i 
,¸¸ 
$num¸¸ 
)¸¸ 
;¸¸ 
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# .
,
¹¹. /
	SqlDbType
¹¹0 9
.
¹¹9 :
UniqueIdentifier
¹¹: J
,
¹¹J K 
ParameterDirection
¹¹L ^
.
¹¹^ _
Input
¹¹_ d
,
¹¹d e
siteGuid
¹¹f n
)
¹¹n o
;
¹¹o p
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# .
,
ºº. /
	SqlDbType
ºº0 9
.
ºº9 :
NVarChar
ºº: B
,
ººB C
$num
ººD G
,
ººG H 
ParameterDirection
ººI [
.
ºº[ \
Input
ºº\ a
,
ººa b
skinName
ººc k
)
ººk l
;
ººl m
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# .
,
»». /
	SqlDbType
»»0 9
.
»»9 :
Bit
»»: =
,
»»= > 
ParameterDirection
»»? Q
.
»»Q R
Input
»»R W
,
»»W X
isActive
»»Y a
)
»»a b
;
»»b c
int
¼¼ 
rowsAffected
¼¼ 
=
¼¼ 
sph
¼¼ "
.
¼¼" #
ExecuteNonQuery
¼¼# 2
(
¼¼2 3
)
¼¼3 4
;
¼¼4 5
return
½½ 
(
½½ 
rowsAffected
½½  
>
½½! "
$num
½½# $
)
½½$ %
;
½½% &
}
¿¿ 	
public
ÅÅ 
static
ÅÅ 
IDataReader
ÅÅ !
GetOne
ÅÅ" (
(
ÅÅ( )
Guid
ÅÅ) -
guid
ÅÅ. 2
)
ÅÅ2 3
{
ÆÆ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M%
GetReadConnectionString
ÇÇM d
(
ÇÇd e
)
ÇÇe f
,
ÇÇf g
$strÇÇh 
,ÇÇ 
$numÇÇ 
)ÇÇ 
;ÇÇ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# *
,
ÈÈ* +
	SqlDbType
ÈÈ, 5
.
ÈÈ5 6
UniqueIdentifier
ÈÈ6 F
,
ÈÈF G 
ParameterDirection
ÈÈH Z
.
ÈÈZ [
Input
ÈÈ[ `
,
ÈÈ` a
guid
ÈÈb f
)
ÈÈf g
;
ÈÈg h
return
ÉÉ 
sph
ÉÉ 
.
ÉÉ 
ExecuteReader
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
}
ËË 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !
GetAll
ÒÒ" (
(
ÒÒ( )
Guid
ÒÒ) -
siteGuid
ÒÒ. 6
)
ÒÒ6 7
{
ÓÓ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh 
,ÔÔ 
$numÔÔ 
)ÔÔ 
;ÔÔ 
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
UniqueIdentifier
ÕÕ: J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
siteGuid
ÕÕf n
)
ÕÕn o
;
ÕÕo p
return
ÖÖ 
sph
ÖÖ 
.
ÖÖ 
ExecuteReader
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
}
ØØ 	
public
ÝÝ 
static
ÝÝ 
IDataReader
ÝÝ !
GetAll
ÝÝ" (
(
ÝÝ( )
Guid
ÝÝ) -
siteGuid
ÝÝ. 6
,
ÝÝ6 7
string
ÝÝ8 >
skinName
ÝÝ? G
)
ÝÝG H
{
ÞÞ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M%
GetReadConnectionString
ßßM d
(
ßßd e
)
ßße f
,
ßßf g
$strßßh 
,ßß 
$numßß 
)ßß 
;ßß 
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# .
,
áá. /
	SqlDbType
áá0 9
.
áá9 :
NVarChar
áá: B
,
ááB C
$num
ááD G
,
ááG H 
ParameterDirection
ááI [
.
áá[ \
Input
áá\ a
,
ááa b
skinName
áác k
)
áák l
;
áál m
return
ââ 
sph
ââ 
.
ââ 
ExecuteReader
ââ $
(
ââ$ %
)
ââ% &
;
ââ& '
}
ää 	
public
éé 
static
éé 
IDataReader
éé !
GetAllActive
éé" .
(
éé. /
Guid
éé/ 3
siteGuid
éé4 <
)
éé< =
{
êê 	 
SqlParameterHelper
ëë 
sph
ëë "
=
ëë# $
new
ëë% ( 
SqlParameterHelper
ëë) ;
(
ëë; <
ConnectionString
ëë< L
.
ëëL M%
GetReadConnectionString
ëëM d
(
ëëd e
)
ëëe f
,
ëëf g
$strëëh 
,ëë 
$numëë 
)ëë 
;ëë 
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# .
,
ìì. /
	SqlDbType
ìì0 9
.
ìì9 :
UniqueIdentifier
ìì: J
,
ììJ K 
ParameterDirection
ììL ^
.
ìì^ _
Input
ìì_ d
,
ììd e
siteGuid
ììf n
)
ììn o
;
ììo p
return
íí 
sph
íí 
.
íí 
ExecuteReader
íí $
(
íí$ %
)
íí% &
;
íí& '
}
ïï 	
public
ôô 
static
ôô 
IDataReader
ôô !
GetAllActive
ôô" .
(
ôô. /
Guid
ôô/ 3
siteGuid
ôô4 <
,
ôô< =
string
ôô> D
skinName
ôôE M
)
ôôM N
{
õõ 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M%
GetReadConnectionString
ööM d
(
ööd e
)
ööe f
,
ööf g
$strööh 
,öö 
$numöö 
)öö 
;öö 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# .
,
÷÷. /
	SqlDbType
÷÷0 9
.
÷÷9 :
UniqueIdentifier
÷÷: J
,
÷÷J K 
ParameterDirection
÷÷L ^
.
÷÷^ _
Input
÷÷_ d
,
÷÷d e
siteGuid
÷÷f n
)
÷÷n o
;
÷÷o p
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# .
,
øø. /
	SqlDbType
øø0 9
.
øø9 :
NVarChar
øø: B
,
øøB C
$num
øøD G
,
øøG H 
ParameterDirection
øøI [
.
øø[ \
Input
øø\ a
,
øøa b
skinName
øøc k
)
øøk l
;
øøl m
return
ùù 
sph
ùù 
.
ùù 
ExecuteReader
ùù $
(
ùù$ %
)
ùù% &
;
ùù& '
}
ûû 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
siteGuid
( 0
)
0 1
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
siteGuid
( 0
,
0 1
string
2 8
skinName
9 A
)
A B
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
skinName
c k
)
k l
;
l m
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
Guid
 
siteGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
   
=
   
$num
   
;
   
int
¡¡ 
	totalRows
¡¡ 
=
¡¡ 
GetCount
¡¡ $
(
¡¡$ %
siteGuid
¡¡% -
)
¡¡- .
;
¡¡. /
if
££ 
(
££ 
pageSize
££ 
>
££ 
$num
££ 
)
££ 

totalPages
££ (
=
££) *
	totalRows
££+ 4
/
££5 6
pageSize
££7 ?
;
££? @
if
¥¥ 
(
¥¥ 
	totalRows
¥¥ 
<=
¥¥ 
pageSize
¥¥ %
)
¥¥% &
{
¦¦ 

totalPages
§§ 
=
§§ 
$num
§§ 
;
§§ 
}
¨¨ 
else
©© 
{
ªª 
int
«« 
	remainder
«« 
;
«« 
Math
¬¬ 
.
¬¬ 
DivRem
¬¬ 
(
¬¬ 
	totalRows
¬¬ %
,
¬¬% &
pageSize
¬¬' /
,
¬¬/ 0
out
¬¬1 4
	remainder
¬¬5 >
)
¬¬> ?
;
¬¬? @
if
­­ 
(
­­ 
	remainder
­­ 
>
­­ 
$num
­­  !
)
­­! "
{
®® 

totalPages
¯¯ 
+=
¯¯ !
$num
¯¯" #
;
¯¯# $
}
°° 
}
±±  
SqlParameterHelper
³³ 
sph
³³ "
=
³³# $
new
³³% ( 
SqlParameterHelper
³³) ;
(
³³; <
ConnectionString
³³< L
.
³³L M%
GetReadConnectionString
³³M d
(
³³d e
)
³³e f
,
³³f g
$str³³h 
,³³ 
$num³³ 
)³³ 
;³³ 
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
UniqueIdentifier
´´: J
,
´´J K 
ParameterDirection
´´L ^
.
´´^ _
Input
´´_ d
,
´´d e
siteGuid
´´f n
)
´´n o
;
´´o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 0
,
µµ0 1
	SqlDbType
µµ2 ;
.
µµ; <
Int
µµ< ?
,
µµ? @ 
ParameterDirection
µµA S
.
µµS T
Input
µµT Y
,
µµY Z

pageNumber
µµ[ e
)
µµe f
;
µµf g
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
Int
¶¶: =
,
¶¶= > 
ParameterDirection
¶¶? Q
.
¶¶Q R
Input
¶¶R W
,
¶¶W X
pageSize
¶¶Y a
)
¶¶a b
;
¶¶b c
return
·· 
sph
·· 
.
·· 
ExecuteReader
·· $
(
··$ %
)
··% &
;
··& '
}
¹¹ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !
GetPage
ÁÁ" )
(
ÁÁ) *
Guid
ÂÂ 
siteGuid
ÂÂ 
,
ÂÂ 
string
ÃÃ 
skinName
ÃÃ 
,
ÃÃ 
int
ÄÄ 

pageNumber
ÄÄ 
,
ÄÄ 
int
ÅÅ 
pageSize
ÅÅ 
,
ÅÅ 
out
ÆÆ 
int
ÆÆ 

totalPages
ÆÆ 
)
ÆÆ 
{
ÇÇ 	

totalPages
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
int
ÉÉ 
	totalRows
ÉÉ 
=
ÉÉ 
GetCount
ÉÉ $
(
ÉÉ$ %
siteGuid
ÉÉ% -
,
ÉÉ- .
skinName
ÉÉ/ 7
)
ÉÉ7 8
;
ÉÉ8 9
if
ËË 
(
ËË 
pageSize
ËË 
>
ËË 
$num
ËË 
)
ËË 

totalPages
ËË (
=
ËË) *
	totalRows
ËË+ 4
/
ËË5 6
pageSize
ËË7 ?
;
ËË? @
if
ÍÍ 
(
ÍÍ 
	totalRows
ÍÍ 
<=
ÍÍ 
pageSize
ÍÍ %
)
ÍÍ% &
{
ÎÎ 

totalPages
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
}
ÐÐ 
else
ÑÑ 
{
ÒÒ 
int
ÓÓ 
	remainder
ÓÓ 
;
ÓÓ 
Math
ÔÔ 
.
ÔÔ 
DivRem
ÔÔ 
(
ÔÔ 
	totalRows
ÔÔ %
,
ÔÔ% &
pageSize
ÔÔ' /
,
ÔÔ/ 0
out
ÔÔ1 4
	remainder
ÔÔ5 >
)
ÔÔ> ?
;
ÔÔ? @
if
ÕÕ 
(
ÕÕ 
	remainder
ÕÕ 
>
ÕÕ 
$num
ÕÕ  !
)
ÕÕ! "
{
ÖÖ 

totalPages
×× 
+=
×× !
$num
××" #
;
××# $
}
ØØ 
}
ÙÙ  
SqlParameterHelper
ÛÛ 
sph
ÛÛ "
=
ÛÛ# $
new
ÛÛ% ( 
SqlParameterHelper
ÛÛ) ;
(
ÛÛ; <
ConnectionString
ÛÛ< L
.
ÛÛL M%
GetReadConnectionString
ÛÛM d
(
ÛÛd e
)
ÛÛe f
,
ÛÛf g
$strÛÛh 
,ÛÛ 
$numÛÛ 
)ÛÛ 
;ÛÛ 
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# .
,
ÜÜ. /
	SqlDbType
ÜÜ0 9
.
ÜÜ9 :
UniqueIdentifier
ÜÜ: J
,
ÜÜJ K 
ParameterDirection
ÜÜL ^
.
ÜÜ^ _
Input
ÜÜ_ d
,
ÜÜd e
siteGuid
ÜÜf n
)
ÜÜn o
;
ÜÜo p
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# .
,
ÝÝ. /
	SqlDbType
ÝÝ0 9
.
ÝÝ9 :
NVarChar
ÝÝ: B
,
ÝÝB C
$num
ÝÝD G
,
ÝÝG H 
ParameterDirection
ÝÝI [
.
ÝÝ[ \
Input
ÝÝ\ a
,
ÝÝa b
skinName
ÝÝc k
)
ÝÝk l
;
ÝÝl m
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# 0
,
ÞÞ0 1
	SqlDbType
ÞÞ2 ;
.
ÞÞ; <
Int
ÞÞ< ?
,
ÞÞ? @ 
ParameterDirection
ÞÞA S
.
ÞÞS T
Input
ÞÞT Y
,
ÞÞY Z

pageNumber
ÞÞ[ e
)
ÞÞe f
;
ÞÞf g
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# .
,
ßß. /
	SqlDbType
ßß0 9
.
ßß9 :
Int
ßß: =
,
ßß= > 
ParameterDirection
ßß? Q
.
ßßQ R
Input
ßßR W
,
ßßW X
pageSize
ßßY a
)
ßßa b
;
ßßb c
return
àà 
sph
àà 
.
àà 
ExecuteReader
àà $
(
àà$ %
)
àà% &
;
àà& '
}
ââ 	
}
ää 
}ææ ¶
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentTemplate )
{ 
public== 
static== 
int== 
Create==  
(==  !
Guid>> 
guid>> 
,>> 
Guid?? 
siteGuid?? 
,?? 
string@@ 
title@@ 
,@@ 
stringAA 
imageFileNameAA  
,AA  !
stringBB 
descriptionBB 
,BB 
stringCC 
bodyCC 
,CC 
stringDD 
allowedRolesDD 
,DD  
GuidEE 
createdByUserEE 
,EE 
DateTimeFF 

createdUtcFF 
)FF  
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi 
,
HH 
$num
HH 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
UniqueIdentifierJJ: J
,JJJ K
ParameterDirectionJJL ^
.JJ^ _
InputJJ_ d
,JJd e
siteGuidJJf n
)JJn o
;JJo p
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
$numKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
titleKK` e
)KKe f
;KKf g
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 3
,LL3 4
	SqlDbTypeLL5 >
.LL> ?
NVarCharLL? G
,LLG H
$numLLI L
,LLL M
ParameterDirectionLLN `
.LL` a
InputLLa f
,LLf g
imageFileNameLLh u
)LLu v
;LLv w
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 1
,MM1 2
	SqlDbTypeMM3 <
.MM< =
NVarCharMM= E
,MME F
-MMG H
$numMMH I
,MMI J
ParameterDirectionMMK ]
.MM] ^
InputMM^ c
,MMc d
descriptionMMe p
)MMp q
;MMq r
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# *
,NN* +
	SqlDbTypeNN, 5
.NN5 6
NVarCharNN6 >
,NN> ?
-NN@ A
$numNNA B
,NNB C
ParameterDirectionNND V
.NNV W
InputNNW \
,NN\ ]
bodyNN^ b
)NNb c
;NNc d
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
NVarCharOO> F
,OOF G
-OOH I
$numOOI J
,OOJ K
ParameterDirectionOOL ^
.OO^ _
InputOO_ d
,OOd e
allowedRolesOOf r
)OOr s
;OOs t
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 3
,PP3 4
	SqlDbTypePP5 >
.PP> ?
UniqueIdentifierPP? O
,PPO P
ParameterDirectionPPQ c
.PPc d
InputPPd i
,PPi j
createdByUserPPk x
)PPx y
;PPy z
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
UniqueIdentifierQQ= M
,QQM N
ParameterDirectionQQO a
.QQa b
InputQQb g
,QQg h
createdByUserQQi v
)QQv w
;QQw x
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
DateTimeRR< D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _

createdUtcRR` j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 0
,SS0 1
	SqlDbTypeSS2 ;
.SS; <
DateTimeSS< D
,SSD E
ParameterDirectionSSF X
.SSX Y
InputSSY ^
,SS^ _

createdUtcSS` j
)SSj k
;SSk l
intTT 
rowsAffectedTT 
=TT 
sphTT "
.TT" #
ExecuteNonQueryTT# 2
(TT2 3
)TT3 4
;TT4 5
returnUU 
rowsAffectedUU 
;UU  
}WW 	
publicgg 
staticgg 
boolgg 
Updategg !
(gg! "
Guidhh 
guidhh 
,hh 
Guidii 
siteGuidii 
,ii 
stringjj 
titlejj 
,jj 
stringkk 
imageFileNamekk  
,kk  !
stringll 
descriptionll 
,ll 
stringmm 
bodymm 
,mm 
stringnn 
allowedRolesnn 
,nn  
Guidoo 
lastModUseroo 
,oo 
DateTimepp 

lastModUtcpp 
)pp  
{qq 	
SqlParameterHelperrr 
sphrr "
=rr# $
newrr% (
SqlParameterHelperrr) ;
(rr; <
ConnectionStringrr< L
.rrL M$
GetWriteConnectionStringrrM e
(rre f
)rrf g
,rrg h
$str	rri 
,
rr 
$num
rr 
)
rr 
;
rr 
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# *
,ss* +
	SqlDbTypess, 5
.ss5 6
UniqueIdentifierss6 F
,ssF G
ParameterDirectionssH Z
.ssZ [
Inputss[ `
,ss` a
guidssb f
)ssf g
;ssg h
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# .
,tt. /
	SqlDbTypett0 9
.tt9 :
UniqueIdentifiertt: J
,ttJ K
ParameterDirectionttL ^
.tt^ _
Inputtt_ d
,ttd e
siteGuidttf n
)ttn o
;tto p
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# +
,uu+ ,
	SqlDbTypeuu- 6
.uu6 7
NVarCharuu7 ?
,uu? @
$numuuA D
,uuD E
ParameterDirectionuuF X
.uuX Y
InputuuY ^
,uu^ _
titleuu` e
)uue f
;uuf g
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 3
,vv3 4
	SqlDbTypevv5 >
.vv> ?
NVarCharvv? G
,vvG H
$numvvI L
,vvL M
ParameterDirectionvvN `
.vv` a
Inputvva f
,vvf g
imageFileNamevvh u
)vvu v
;vvv w
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 1
,ww1 2
	SqlDbTypeww3 <
.ww< =
NVarCharww= E
,wwE F
-wwG H
$numwwH I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d
descriptionwwe p
)wwp q
;wwq r
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
NVarCharxx6 >
,xx> ?
-xx@ A
$numxxA B
,xxB C
ParameterDirectionxxD V
.xxV W
InputxxW \
,xx\ ]
bodyxx^ b
)xxb c
;xxc d
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 2
,yy2 3
	SqlDbTypeyy4 =
.yy= >
NVarCharyy> F
,yyF G
-yyH I
$numyyI J
,yyJ K
ParameterDirectionyyL ^
.yy^ _
Inputyy_ d
,yyd e
allowedRolesyyf r
)yyr s
;yys t
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
UniqueIdentifierzz= M
,zzM N
ParameterDirectionzzO a
.zza b
Inputzzb g
,zzg h
lastModUserzzi t
)zzt u
;zzu v
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 0
,{{0 1
	SqlDbType{{2 ;
.{{; <
DateTime{{< D
,{{D E
ParameterDirection{{F X
.{{X Y
Input{{Y ^
,{{^ _

lastModUtc{{` j
){{j k
;{{k l
int|| 
rowsAffected|| 
=|| 
sph|| "
.||" #
ExecuteNonQuery||# 2
(||2 3
)||3 4
;||4 5
return}} 
(}} 
rowsAffected}}  
>}}! "
$num}}# $
)}}$ %
;}}% &
} 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
IDataReader
 !
GetOne
" (
(
( )
Guid
) -
guid
. 2
)
2 3
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
siteGuid
( 0
)
0 1
{
 	 
SqlParameterHelper
   
sph
   "
=
  # $
new
  % ( 
SqlParameterHelper
  ) ;
(
  ; <
ConnectionString
  < L
.
  L M%
GetReadConnectionString
  M d
(
  d e
)
  e f
,
  f g
$str  h 
,   
$num   
)   
;   
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# .
,
¡¡. /
	SqlDbType
¡¡0 9
.
¡¡9 :
UniqueIdentifier
¡¡: J
,
¡¡J K 
ParameterDirection
¡¡L ^
.
¡¡^ _
Input
¡¡_ d
,
¡¡d e
siteGuid
¡¡f n
)
¡¡n o
;
¡¡o p
return
¢¢ 
Convert
¢¢ 
.
¢¢ 
ToInt32
¢¢ "
(
¢¢" #
sph
¢¢# &
.
¢¢& '
ExecuteScalar
¢¢' 4
(
¢¢4 5
)
¢¢5 6
)
¢¢6 7
;
¢¢7 8
}
¥¥ 	
public
ªª 
static
ªª 
IDataReader
ªª !
GetAll
ªª" (
(
ªª( )
Guid
ªª) -
siteGuid
ªª. 6
)
ªª6 7
{
«« 	 
SqlParameterHelper
¬¬ 
sph
¬¬ "
=
¬¬# $
new
¬¬% ( 
SqlParameterHelper
¬¬) ;
(
¬¬; <
ConnectionString
¬¬< L
.
¬¬L M%
GetReadConnectionString
¬¬M d
(
¬¬d e
)
¬¬e f
,
¬¬f g
$str¬¬h 
,¬¬ 
$num¬¬ 
)¬¬ 
;¬¬ 
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# .
,
­­. /
	SqlDbType
­­0 9
.
­­9 :
UniqueIdentifier
­­: J
,
­­J K 
ParameterDirection
­­L ^
.
­­^ _
Input
­­_ d
,
­­d e
siteGuid
­­f n
)
­­n o
;
­­o p
return
®® 
sph
®® 
.
®® 
ExecuteReader
®® $
(
®®$ %
)
®®% &
;
®®& '
}
°° 	
public
¸¸ 
static
¸¸ 
IDataReader
¸¸ !
GetPage
¸¸" )
(
¸¸) *
Guid
¹¹ 
siteGuid
¹¹ 
,
¹¹ 
int
ºº 

pageNumber
ºº 
,
ºº 
int
»» 
pageSize
»» 
,
»» 
out
¼¼ 
int
¼¼ 

totalPages
¼¼ 
)
¼¼ 
{
½½ 	

totalPages
¾¾ 
=
¾¾ 
$num
¾¾ 
;
¾¾ 
int
¿¿ 
	totalRows
¿¿ 
=
¿¿ 
GetCount
¿¿ $
(
¿¿$ %
siteGuid
¿¿% -
)
¿¿- .
;
¿¿. /
if
ÁÁ 
(
ÁÁ 
pageSize
ÁÁ 
>
ÁÁ 
$num
ÁÁ 
)
ÁÁ 

totalPages
ÁÁ (
=
ÁÁ) *
	totalRows
ÁÁ+ 4
/
ÁÁ5 6
pageSize
ÁÁ7 ?
;
ÁÁ? @
if
ÃÃ 
(
ÃÃ 
	totalRows
ÃÃ 
<=
ÃÃ 
pageSize
ÃÃ %
)
ÃÃ% &
{
ÄÄ 

totalPages
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
}
ÆÆ 
else
ÇÇ 
{
ÈÈ 
int
ÉÉ 
	remainder
ÉÉ 
;
ÉÉ 
Math
ÊÊ 
.
ÊÊ 
DivRem
ÊÊ 
(
ÊÊ 
	totalRows
ÊÊ %
,
ÊÊ% &
pageSize
ÊÊ' /
,
ÊÊ/ 0
out
ÊÊ1 4
	remainder
ÊÊ5 >
)
ÊÊ> ?
;
ÊÊ? @
if
ËË 
(
ËË 
	remainder
ËË 
>
ËË 
$num
ËË  !
)
ËË! "
{
ÌÌ 

totalPages
ÍÍ 
+=
ÍÍ !
$num
ÍÍ" #
;
ÍÍ# $
}
ÎÎ 
}
ÏÏ  
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M%
GetReadConnectionString
ÑÑM d
(
ÑÑd e
)
ÑÑe f
,
ÑÑf g
$strÑÑh 
,ÑÑ 
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
UniqueIdentifier
ÒÒ: J
,
ÒÒJ K 
ParameterDirection
ÒÒL ^
.
ÒÒ^ _
Input
ÒÒ_ d
,
ÒÒd e
siteGuid
ÒÒf n
)
ÒÒn o
;
ÒÒo p
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# 0
,
ÓÓ0 1
	SqlDbType
ÓÓ2 ;
.
ÓÓ; <
Int
ÓÓ< ?
,
ÓÓ? @ 
ParameterDirection
ÓÓA S
.
ÓÓS T
Input
ÓÓT Y
,
ÓÓY Z

pageNumber
ÓÓ[ e
)
ÓÓe f
;
ÓÓf g
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# .
,
ÔÔ. /
	SqlDbType
ÔÔ0 9
.
ÔÔ9 :
Int
ÔÔ: =
,
ÔÔ= > 
ParameterDirection
ÔÔ? Q
.
ÔÔQ R
Input
ÔÔR W
,
ÔÔW X
pageSize
ÔÔY a
)
ÔÔa b
;
ÔÔb c
return
ÕÕ 
sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ $
(
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
×× 	
}
ÙÙ 
}ÛÛ ¡ì
qD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBContentWorkflow.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBContentWorkflow )
{ 
public&& 
static&& 
int&& 
Create&&  
(&&  !
Guid'' 
guid'' 
,'' 
Guid(( 
siteGuid(( 
,(( 
Guid)) 

moduleGuid)) 
,)) 
Guid** 
userGuid** 
,** 
DateTime++ 
createdDateUtc++ #
,++# $
string,, 
contentText,, 
,,, 
string-- 

customData-- 
,-- 
int.. !
customReferenceNumber.. %
,..% &
Guid// 
customReferenceGuid// $
,//$ %
string00 
status00 
)00 
{11 	
SqlParameterHelper22 
sph22 "
=22# $
new22% (
SqlParameterHelper22) ;
(22; <
ConnectionString22< L
.22L M$
GetWriteConnectionString22M e
(22e f
)22f g
,22g h
$str	22i 
,
22 
$num
22 
)
22 
;
22 
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# *
,33* +
	SqlDbType33, 5
.335 6
UniqueIdentifier336 F
,33F G
ParameterDirection33H Z
.33Z [
Input33[ `
,33` a
guid33b f
)33f g
;33g h
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
UniqueIdentifier44: J
,44J K
ParameterDirection44L ^
.44^ _
Input44_ d
,44d e
siteGuid44f n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 0
,550 1
	SqlDbType552 ;
.55; <
UniqueIdentifier55< L
,55L M
ParameterDirection55N `
.55` a
Input55a f
,55f g

moduleGuid55h r
)55r s
;55s t
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 4
,664 5
	SqlDbType666 ?
.66? @
DateTime66@ H
,66H I
ParameterDirection66J \
.66\ ]
Input66] b
,66b c
createdDateUtc66d r
)66r s
;66s t
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
UniqueIdentifier77: J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
userGuid77f n
)77n o
;77o p
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# ,
,88, -
	SqlDbType88. 7
.887 8
NVarChar888 @
,88@ A
$num88B D
,88D E
ParameterDirection88F X
.88X Y
Input88Y ^
,88^ _
status88` f
)88f g
;88g h
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# 1
,991 2
	SqlDbType993 <
.99< =
NVarChar99= E
,99E F
-99G H
$num99H I
,99I J
ParameterDirection99K ]
.99] ^
Input99^ c
,99c d
contentText99e p
)99p q
;99q r
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
NVarChar::< D
,::D E
-::F G
$num::G H
,::H I
ParameterDirection::J \
.::\ ]
Input::] b
,::b c

customData::d n
)::n o
;::o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# ;
,==; <
	SqlDbType=== F
.==F G
Int==G J
,==J K
ParameterDirection==L ^
.==^ _
Input==_ d
,==d e!
customReferenceNumber==f {
)=={ |
;==| }
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 9
,@@9 :
	SqlDbType@@; D
.@@D E
UniqueIdentifier@@E U
,@@U V
ParameterDirection@@W i
.@@i j
Input@@j o
,@@o p 
customReferenceGuid	@@q 
)
@@ 
;
@@ 
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
rowsAffectedCC 
;CC  
}DD 	
publicRR 
staticRR 
intRR 
UpdateRR  
(RR  !
GuidSS 
guidSS 
,SS 
GuidTT 
lastModUserGuidTT  
,TT  !
DateTimeUU 

lastModUtcUU 
,UU  
stringVV 
contentTextVV 
,VV 
stringWW 

customDataWW 
,WW 
intXX !
customReferenceNumberXX %
,XX% &
GuidYY 
customReferenceGuidYY $
,YY$ %
stringZZ 
statusZZ 
)ZZ 
{[[ 	
SqlParameterHelper\\ 
sph\\ "
=\\# $
new\\% (
SqlParameterHelper\\) ;
(\\; <
ConnectionString\\< L
.\\L M$
GetWriteConnectionString\\M e
(\\e f
)\\f g
,\\g h
$str	\\i 
,
\\ 
$num
\\ 
)
\\ 
;
\\ 
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
UniqueIdentifier]]6 F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
guid]]b f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 5
,^^5 6
	SqlDbType^^7 @
.^^@ A
UniqueIdentifier^^A Q
,^^Q R
ParameterDirection^^S e
.^^e f
Input^^f k
,^^k l
lastModUserGuid^^m |
)^^| }
;^^} ~
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 0
,__0 1
	SqlDbType__2 ;
.__; <
DateTime__< D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _

lastModUtc__` j
)__j k
;__k l
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# ,
,``, -
	SqlDbType``. 7
.``7 8
NVarChar``8 @
,``@ A
$num``B D
,``D E
ParameterDirection``F X
.``X Y
Input``Y ^
,``^ _
status``` f
)``f g
;``g h
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 1
,aa1 2
	SqlDbTypeaa3 <
.aa< =
NVarCharaa= E
,aaE F
-aaG H
$numaaH I
,aaI J
ParameterDirectionaaK ]
.aa] ^
Inputaa^ c
,aac d
contentTextaae p
)aap q
;aaq r
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
-bbF G
$numbbG H
,bbH I
ParameterDirectionbbJ \
.bb\ ]
Inputbb] b
,bbb c

customDatabbd n
)bbn o
;bbo p
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ;
,ee; <
	SqlDbTypeee= F
.eeF G
InteeG J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e!
customReferenceNumbereef {
)ee{ |
;ee| }
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 9
,hh9 :
	SqlDbTypehh; D
.hhD E
UniqueIdentifierhhE U
,hhU V
ParameterDirectionhhW i
.hhi j
Inputhhj o
,hho p 
customReferenceGuid	hhq 
)
hh 
;
hh 
intjj 
rowsAffectedjj 
=jj 
sphjj "
.jj" #
ExecuteNonQueryjj# 2
(jj2 3
)jj3 4
;jj4 5
returnkk 
rowsAffectedkk 
;kk  
}ll 	
publicuu 
staticuu 
booluu 
DeleteByModuleuu )
(uu) *
Guiduu* .

moduleGuiduu/ 9
)uu9 :
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi 
,
ww 
$num
ww 
)
ww 
;
ww 
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 0
,xx0 1
	SqlDbTypexx2 ;
.xx; <
UniqueIdentifierxx< L
,xxL M
ParameterDirectionxxN `
.xx` a
Inputxxa f
,xxf g

moduleGuidxxh r
)xxr s
;xxs t
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
IDataReader
 !
GetWorkInProgress
" 3
(
3 4
Guid
4 8

moduleGuid
9 C
)
C D
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetWorkInProgress
" 3
(
3 4
Guid
4 8

moduleGuid
9 C
,
C D
string
E K
status
L R
)
R S
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 0
,
¢¢0 1
	SqlDbType
¢¢2 ;
.
¢¢; <
UniqueIdentifier
¢¢< L
,
¢¢L M 
ParameterDirection
¢¢N `
.
¢¢` a
Input
¢¢a f
,
¢¢f g

moduleGuid
¢¢h r
)
¢¢r s
;
¢¢s t
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# ,
,
££, -
	SqlDbType
££. 7
.
££7 8
NVarChar
££8 @
,
££@ A
$num
££B D
,
££D E 
ParameterDirection
££F X
.
££X Y
Input
££Y ^
,
££^ _
status
££` f
)
££f g
;
££g h
return
¤¤ 
sph
¤¤ 
.
¤¤ 
ExecuteReader
¤¤ $
(
¤¤$ %
)
¤¤% &
;
¤¤& '
}
¥¥ 	
public
§§ 
static
§§ 
int
§§ *
GetWorkInProgressCountByPage
§§ 6
(
§§6 7
Guid
§§7 ;
pageGuid
§§< D
)
§§D E
{
¨¨ 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M%
GetReadConnectionString
©©M d
(
©©d e
)
©©e f
,
©©f g
$str©©h 
,©© 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
UniqueIdentifier
ªª: J
,
ªªJ K 
ParameterDirection
ªªL ^
.
ªª^ _
Input
ªª_ d
,
ªªd e
pageGuid
ªªf n
)
ªªn o
;
ªªo p
return
«« 
Convert
«« 
.
«« 
ToInt32
«« "
(
««" #
sph
««# &
.
««& '
ExecuteScalar
««' 4
(
««4 5
)
««5 6
)
««6 7
;
««7 8
}
¬¬ 	
public
®® 
static
®® 
int
®® 
GetCount
®® "
(
®®" #
Guid
®®# '
siteGuid
®®( 0
,
®®0 1
string
®®2 8
status
®®9 ?
)
®®? @
{
¯¯ 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h 
,°° 
$num°° 
)°° 
;°° 
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
UniqueIdentifier
±±: J
,
±±J K 
ParameterDirection
±±L ^
.
±±^ _
Input
±±_ d
,
±±d e
siteGuid
±±f n
)
±±n o
;
±±o p
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# ,
,
²², -
	SqlDbType
²². 7
.
²²7 8
NVarChar
²²8 @
,
²²@ A 
ParameterDirection
²²B T
.
²²T U
Input
²²U Z
,
²²Z [
status
²²\ b
)
²²b c
;
²²c d
return
³³ 
Convert
³³ 
.
³³ 
ToInt32
³³ "
(
³³" #
sph
³³# &
.
³³& '
ExecuteScalar
³³' 4
(
³³4 5
)
³³5 6
)
³³6 7
;
³³7 8
}
´´ 	
public
¶¶ 
static
¶¶ 
Guid
¶¶ 
GetDraftSubmitter
¶¶ ,
(
¶¶, -
Guid
¶¶- 1!
contentWorkflowGuid
¶¶2 E
)
¶¶E F
{
·· 	
Guid
¸¸ 
result
¸¸ 
=
¸¸ 
Guid
¸¸ 
.
¸¸ 
Empty
¸¸ $
;
¸¸$ % 
SqlParameterHelper
¹¹ 
sph
¹¹ "
=
¹¹# $
new
¹¹% ( 
SqlParameterHelper
¹¹) ;
(
¹¹; <
ConnectionString
¹¹< L
.
¹¹L M%
GetReadConnectionString
¹¹M d
(
¹¹d e
)
¹¹e f
,
¹¹f g
$str¹¹h 
,¹¹ 
$num¹¹ 
)¹¹ 
;¹¹ 
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 9
,
ºº9 :
	SqlDbType
ºº; D
.
ººD E
UniqueIdentifier
ººE U
,
ººU V 
ParameterDirection
ººW i
.
ººi j
Input
ººj o
,
ººo p"
contentWorkflowGuidººq 
)ºº 
;ºº 
using
»» 
(
»» 
IDataReader
»» 
reader
»» %
=
»»& '
sph
»»( +
.
»»+ ,
ExecuteReader
»», 9
(
»»9 :
)
»»: ;
)
»»; <
{
¼¼ 
if
½½ 
(
½½ 
reader
½½ 
.
½½ 
Read
½½ 
(
½½  
)
½½  !
)
½½! "
{
¾¾ 
result
¿¿ 
=
¿¿ 
new
¿¿  
Guid
¿¿! %
(
¿¿% &
reader
¿¿& ,
[
¿¿, -
$num
¿¿- .
]
¿¿. /
.
¿¿/ 0
ToString
¿¿0 8
(
¿¿8 9
)
¿¿9 :
)
¿¿: ;
;
¿¿; <
}
ÀÀ 
}
ÁÁ 
return
ÃÃ 
result
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
public
ÆÆ 
static
ÆÆ 
IDataReader
ÆÆ !
GetPage
ÆÆ" )
(
ÆÆ) *
Guid
ÇÇ 
siteGuid
ÇÇ 
,
ÇÇ 
string
ÈÈ 
status
ÈÈ 
,
ÈÈ 
int
ÉÉ 

pageNumber
ÉÉ 
,
ÉÉ 
int
ÊÊ 
pageSize
ÊÊ 
,
ÊÊ 
out
ËË 
int
ËË 

totalPages
ËË 
)
ËË 
{
ÌÌ 	

totalPages
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
int
ÎÎ 
	totalRows
ÎÎ 
=
ÎÎ 
GetCount
ÎÎ $
(
ÎÎ$ %
siteGuid
ÎÎ% -
,
ÎÎ- .
status
ÎÎ/ 5
)
ÎÎ5 6
;
ÎÎ6 7
if
ÐÐ 
(
ÐÐ 
pageSize
ÐÐ 
>
ÐÐ 
$num
ÐÐ 
)
ÐÐ 

totalPages
ÐÐ (
=
ÐÐ) *
	totalRows
ÐÐ+ 4
/
ÐÐ5 6
pageSize
ÐÐ7 ?
;
ÐÐ? @
if
ÒÒ 
(
ÒÒ 
	totalRows
ÒÒ 
<=
ÒÒ 
pageSize
ÒÒ %
)
ÒÒ% &
{
ÓÓ 

totalPages
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
;
ÔÔ 
}
ÕÕ 
else
ÖÖ 
{
×× 
int
ØØ 
	remainder
ØØ 
;
ØØ 
Math
ÙÙ 
.
ÙÙ 
DivRem
ÙÙ 
(
ÙÙ 
	totalRows
ÙÙ %
,
ÙÙ% &
pageSize
ÙÙ' /
,
ÙÙ/ 0
out
ÙÙ1 4
	remainder
ÙÙ5 >
)
ÙÙ> ?
;
ÙÙ? @
if
ÚÚ 
(
ÚÚ 
	remainder
ÚÚ 
>
ÚÚ 
$num
ÚÚ  !
)
ÚÚ! "
{
ÛÛ 

totalPages
ÜÜ 
+=
ÜÜ !
$num
ÜÜ" #
;
ÜÜ# $
}
ÝÝ 
}
ÞÞ  
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh 
,àà 
$numàà 
)àà 
;àà 
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# .
,
áá. /
	SqlDbType
áá0 9
.
áá9 :
UniqueIdentifier
áá: J
,
ááJ K 
ParameterDirection
ááL ^
.
áá^ _
Input
áá_ d
,
áád e
siteGuid
ááf n
)
áán o
;
ááo p
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# ,
,
ââ, -
	SqlDbType
ââ. 7
.
ââ7 8
NVarChar
ââ8 @
,
ââ@ A 
ParameterDirection
ââB T
.
ââT U
Input
ââU Z
,
ââZ [
status
ââ\ b
)
ââb c
;
ââc d
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 0
,
ãã0 1
	SqlDbType
ãã2 ;
.
ãã; <
Int
ãã< ?
,
ãã? @ 
ParameterDirection
ããA S
.
ããS T
Input
ããT Y
,
ããY Z

pageNumber
ãã[ e
)
ããe f
;
ããf g
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
Int
ää: =
,
ää= > 
ParameterDirection
ää? Q
.
ääQ R
Input
ääR W
,
ääW X
pageSize
ääY a
)
ääa b
;
ääb c
return
åå 
sph
åå 
.
åå 
ExecuteReader
åå $
(
åå$ %
)
åå% &
;
åå& '
}
ææ 	
public
èè 
static
èè 
IDataReader
èè ! 
GetPageInfoForPage
èè" 4
(
èè4 5
Guid
éé 
siteGuid
éé 
,
éé 
string
êê 
status
êê 
,
êê 
int
ëë 

pageNumber
ëë 
,
ëë 
int
ìì 
pageSize
ìì 
)
ìì 
{
íí 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M%
GetReadConnectionString
ïïM d
(
ïïd e
)
ïïe f
,
ïïf g
$strïïh 
,ïï 
$numïï 
)ïï 
;ïï 
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# .
,
ðð. /
	SqlDbType
ðð0 9
.
ðð9 :
UniqueIdentifier
ðð: J
,
ððJ K 
ParameterDirection
ððL ^
.
ðð^ _
Input
ðð_ d
,
ððd e
siteGuid
ððf n
)
ððn o
;
ððo p
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# ,
,
ññ, -
	SqlDbType
ññ. 7
.
ññ7 8
NVarChar
ññ8 @
,
ññ@ A 
ParameterDirection
ññB T
.
ññT U
Input
ññU Z
,
ññZ [
status
ññ\ b
)
ññb c
;
ññc d
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 0
,
òò0 1
	SqlDbType
òò2 ;
.
òò; <
Int
òò< ?
,
òò? @ 
ParameterDirection
òòA S
.
òòS T
Input
òòT Y
,
òòY Z

pageNumber
òò[ e
)
òòe f
;
òòf g
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# .
,
óó. /
	SqlDbType
óó0 9
.
óó9 :
Int
óó: =
,
óó= > 
ParameterDirection
óó? Q
.
óóQ R
Input
óóR W
,
óóW X
pageSize
óóY a
)
óóa b
;
óób c
return
ôô 
sph
ôô 
.
ôô 
ExecuteReader
ôô $
(
ôô$ %
)
ôô% &
;
ôô& '
}
õõ 	
public
øø 
static
øø 
int
øø  
CreateAuditHistory
øø ,
(
øø, -
Guid
ùù 
guid
ùù 
,
ùù 
Guid
úú 
workflowGuid
úú 
,
úú 
Guid
ûû 

moduleGuid
ûû 
,
ûû 
Guid
üü 
userGuid
üü 
,
üü 
DateTime
ýý 
createdDateUtc
ýý #
,
ýý# $
string
þþ 
status
þþ 
,
þþ 
string
ÿÿ 
notes
ÿÿ 
,
ÿÿ 
bool
 
active
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 9
,
9 :
	SqlDbType
; D
.
D E
UniqueIdentifier
E U
,
U V 
ParameterDirection
W i
.
i j
Input
j o
,
o p
workflowGuid
q }
)
} ~
;
~ 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
createdDateUtc
d r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
status
` f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
NVarChar
7 ?
,
? @
-
A B
$num
B C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
notes
_ d
)
d e
;
e f
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Bit
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
active
W ]
)
] ^
;
^ _
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
rowsAffected
 
;
  
}
 	
public
 
static
 
bool
 
DeactivateAudit
 *
(
* +
Guid
+ /

moduleGuid
0 :
)
: ;
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
}
 
} ëf
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBCurrency.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBCurrency "
{ 
public:: 
static:: 
int:: 
Create::  
(::  !
Guid;; 
guid;; 
,;; 
string<< 
title<< 
,<< 
string== 
code== 
,== 
string>> 

symbolLeft>> 
,>> 
string?? 
symbolRight?? 
,?? 
string@@ 
decimalPointChar@@ #
,@@# $
stringAA 
thousandsPointCharAA %
,AA% &
stringBB 
decimalPlacesBB  
,BB  !
decimalCC 
valueCC 
,CC 
DateTimeDD 
lastModifiedDD !
,DD! "
DateTimeEE 
createdEE 
)EE 
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi }
,GG} ~
$num	GG 
)
GG 
;
GG 
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
UniqueIdentifierHH6 F
,HHF G
ParameterDirectionHHH Z
.HHZ [
InputHH[ `
,HH` a
guidHHb f
)HHf g
;HHg h
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# +
,II+ ,
	SqlDbTypeII- 6
.II6 7
NVarCharII7 ?
,II? @
$numIIA C
,IIC D
ParameterDirectionIIE W
.IIW X
InputIIX ]
,II] ^
titleII_ d
)IId e
;IIe f
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
NCharJJ6 ;
,JJ; <
$numJJ= >
,JJ> ?
ParameterDirectionJJ@ R
.JJR S
InputJJS X
,JJX Y
codeJJZ ^
)JJ^ _
;JJ_ `
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 0
,KK0 1
	SqlDbTypeKK2 ;
.KK; <
NVarCharKK< D
,KKD E
$numKKF H
,KKH I
ParameterDirectionKKJ \
.KK\ ]
InputKK] b
,KKb c

symbolLeftKKd n
)KKn o
;KKo p
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
$numLLG I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
symbolRightLLe p
)LLp q
;LLq r
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 6
,MM6 7
	SqlDbTypeMM8 A
.MMA B
NCharMMB G
,MMG H
$numMMI J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
decimalPointCharMMf v
)MMv w
;MMw x
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 8
,NN8 9
	SqlDbTypeNN: C
.NNC D
NCharNND I
,NNI J
$numNNK L
,NNL M
ParameterDirectionNNN `
.NN` a
InputNNa f
,NNf g
thousandsPointCharNNh z
)NNz {
;NN{ |
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 3
,OO3 4
	SqlDbTypeOO5 >
.OO> ?
NCharOO? D
,OOD E
$numOOF G
,OOG H
ParameterDirectionOOI [
.OO[ \
InputOO\ a
,OOa b
decimalPlacesOOc p
)OOp q
;OOq r
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# +
,PP+ ,
	SqlDbTypePP- 6
.PP6 7
DecimalPP7 >
,PP> ?
ParameterDirectionPP@ R
.PPR S
InputPPS X
,PPX Y
valuePPZ _
)PP_ `
;PP` a
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 2
,QQ2 3
	SqlDbTypeQQ4 =
.QQ= >
DateTimeQQ> F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
lastModifiedQQb n
)QQn o
;QQo p
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# -
,RR- .
	SqlDbTypeRR/ 8
.RR8 9
DateTimeRR9 A
,RRA B
ParameterDirectionRRC U
.RRU V
InputRRV [
,RR[ \
createdRR] d
)RRd e
;RRe f
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
rowsAffectedTT 
;TT  
}VV 	
publicii 
staticii 
boolii 
Updateii !
(ii! "
Guidjj 
guidjj 
,jj 
stringkk 
titlekk 
,kk 
stringll 
codell 
,ll 
stringmm 

symbolLeftmm 
,mm 
stringnn 
symbolRightnn 
,nn 
stringoo 
decimalPointCharoo #
,oo# $
stringpp 
thousandsPointCharpp %
,pp% &
stringqq 
decimalPlacesqq  
,qq  !
decimalrr 
valuerr 
,rr 
DateTimess 
lastModifiedss !
)ss! "
{tt 	
SqlParameterHelperuu 
sphuu "
=uu# $
newuu% (
SqlParameterHelperuu) ;
(uu; <
ConnectionStringuu< L
.uuL M$
GetWriteConnectionStringuuM e
(uue f
)uuf g
,uug h
$struui }
,uu} ~
$num	uu 
)
uu 
;
uu 
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# *
,vv* +
	SqlDbTypevv, 5
.vv5 6
UniqueIdentifiervv6 F
,vvF G
ParameterDirectionvvH Z
.vvZ [
Inputvv[ `
,vv` a
guidvvb f
)vvf g
;vvg h
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# +
,ww+ ,
	SqlDbTypeww- 6
.ww6 7
NVarCharww7 ?
,ww? @
$numwwA C
,wwC D
ParameterDirectionwwE W
.wwW X
InputwwX ]
,ww] ^
titleww_ d
)wwd e
;wwe f
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
NCharxx6 ;
,xx; <
$numxx= >
,xx> ?
ParameterDirectionxx@ R
.xxR S
InputxxS X
,xxX Y
codexxZ ^
)xx^ _
;xx_ `
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 0
,yy0 1
	SqlDbTypeyy2 ;
.yy; <
NVarCharyy< D
,yyD E
$numyyF H
,yyH I
ParameterDirectionyyJ \
.yy\ ]
Inputyy] b
,yyb c

symbolLeftyyd n
)yyn o
;yyo p
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
NVarCharzz= E
,zzE F
$numzzG I
,zzI J
ParameterDirectionzzK ]
.zz] ^
Inputzz^ c
,zzc d
symbolRightzze p
)zzp q
;zzq r
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 6
,{{6 7
	SqlDbType{{8 A
.{{A B
NChar{{B G
,{{G H
$num{{I J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
decimalPointChar{{f v
){{v w
;{{w x
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 8
,||8 9
	SqlDbType||: C
.||C D
NChar||D I
,||I J
$num||K L
,||L M
ParameterDirection||N `
.||` a
Input||a f
,||f g
thousandsPointChar||h z
)||z {
;||{ |
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
NChar}}? D
,}}D E
$num}}F G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
decimalPlaces}}c p
)}}p q
;}}q r
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# +
,~~+ ,
	SqlDbType~~- 6
.~~6 7
Decimal~~7 >
,~~> ?
ParameterDirection~~@ R
.~~R S
Input~~S X
,~~X Y
value~~Z _
)~~_ `
;~~` a
sph 
. 
DefineSqlParameter "
(" #
$str# 2
,2 3
	SqlDbType4 =
.= >
DateTime> F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
lastModifiedb n
)n o
;o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$str
i }
,
} ~
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
IDataReader
 !
GetOne
" (
(
( )
Guid
) -
guid
. 2
)
2 3
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
¤¤ 
static
¤¤ 
IDataReader
¤¤ !
GetAll
¤¤" (
(
¤¤( )
)
¤¤) *
{
¥¥ 	
return
§§ 
	SqlHelper
§§ 
.
§§ 
ExecuteReader
§§ *
(
§§* +
ConnectionString
¨¨  
.
¨¨  !%
GetReadConnectionString
¨¨! 8
(
¨¨8 9
)
¨¨9 :
,
¨¨: ;
CommandType
©© 
.
©© 
StoredProcedure
©© +
,
©©+ ,
$str
ªª '
,
ªª' (
null
«« 
)
«« 
;
«« 
}
­­ 	
}
±± 
}²² ïU
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailSendLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailSendLog &
{ 
publicHH 
staticHH 
voidHH 
CreateHH !
(HH! "
GuidII 
guidII 
,II 
GuidJJ 
siteGuidJJ 
,JJ 
GuidKK 

moduleGuidKK 
,KK 
GuidLL 
specialGuid1LL 
,LL 
GuidMM 
specialGuid2MM 
,MM 
stringNN 
	toAddressNN 
,NN 
stringOO 
	ccAddressOO 
,OO 
stringPP 

bccAddressPP 
,PP 
stringQQ 
subjectQQ 
,QQ 
stringRR 
textBodyRR 
,RR 
stringSS 
htmlBodySS 
,SS 
stringTT 
typeTT 
,TT 
DateTimeUU 
sentUtcUU 
,UU 
stringVV 
fromAddressVV 
,VV 
stringWW 
replyToWW 
,WW 
GuidXX 
userGuidXX 
)XX 
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M$
GetWriteConnectionStringZZM e
(ZZe f
)ZZf g
,ZZg h
$str	ZZi 
,
ZZ 
$num
ZZ 
)
ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# *
,[[* +
	SqlDbType[[, 5
.[[5 6
UniqueIdentifier[[6 F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
guid[[b f
)[[f g
;[[g h
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
UniqueIdentifier\\: J
,\\J K
ParameterDirection\\L ^
.\\^ _
Input\\_ d
,\\d e
siteGuid\\f n
)\\n o
;\\o p
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 0
,]]0 1
	SqlDbType]]2 ;
.]]; <
UniqueIdentifier]]< L
,]]L M
ParameterDirection]]N `
.]]` a
Input]]a f
,]]f g

moduleGuid]]h r
)]]r s
;]]s t
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 2
,^^2 3
	SqlDbType^^4 =
.^^= >
UniqueIdentifier^^> N
,^^N O
ParameterDirection^^P b
.^^b c
Input^^c h
,^^h i
specialGuid1^^j v
)^^v w
;^^w x
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 2
,__2 3
	SqlDbType__4 =
.__= >
UniqueIdentifier__> N
,__N O
ParameterDirection__P b
.__b c
Input__c h
,__h i
specialGuid2__j v
)__v w
;__w x
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# /
,``/ 0
	SqlDbType``1 :
.``: ;
NVarChar``; C
,``C D
$num``E H
,``H I
ParameterDirection``J \
.``\ ]
Input``] b
,``b c
	toAddress``d m
)``m n
;``n o
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# /
,aa/ 0
	SqlDbTypeaa1 :
.aa: ;
NVarCharaa; C
,aaC D
$numaaE H
,aaH I
ParameterDirectionaaJ \
.aa\ ]
Inputaa] b
,aab c
	ccAddressaad m
)aam n
;aan o
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
$numbbF I
,bbI J
ParameterDirectionbbK ]
.bb] ^
Inputbb^ c
,bbc d

bccAddressbbe o
)bbo p
;bbp q
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# -
,cc- .
	SqlDbTypecc/ 8
.cc8 9
NVarCharcc9 A
,ccA B
$numccC F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
subjectccb i
)cci j
;ccj k
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# .
,dd. /
	SqlDbTypedd0 9
.dd9 :
NVarChardd: B
,ddB C
-ddD E
$numddE F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
textBodyddb j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# .
,ee. /
	SqlDbTypeee0 9
.ee9 :
NVarCharee: B
,eeB C
-eeD E
$numeeE F
,eeF G
ParameterDirectioneeH Z
.eeZ [
Inputee[ `
,ee` a
htmlBodyeeb j
)eej k
;eek l
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# *
,ff* +
	SqlDbTypeff, 5
.ff5 6
NVarCharff6 >
,ff> ?
$numff@ B
,ffB C
ParameterDirectionffD V
.ffV W
InputffW \
,ff\ ]
typeff^ b
)ffb c
;ffc d
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# -
,gg- .
	SqlDbTypegg/ 8
.gg8 9
DateTimegg9 A
,ggA B
ParameterDirectionggC U
.ggU V
InputggV [
,gg[ \
sentUtcgg] d
)ggd e
;gge f
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 1
,hh1 2
	SqlDbTypehh3 <
.hh< =
NVarCharhh= E
,hhE F
$numhhG J
,hhJ K
ParameterDirectionhhL ^
.hh^ _
Inputhh_ d
,hhd e
fromAddresshhf q
)hhq r
;hhr s
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# -
,ii- .
	SqlDbTypeii/ 8
.ii8 9
NVarCharii9 A
,iiA B
$numiiC F
,iiF G
ParameterDirectioniiH Z
.iiZ [
Inputii[ `
,ii` a
replyToiib i
)iii j
;iij k
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
userGuidjjf n
)jjn o
;jjo p
sphkk 
.kk 
ExecuteNonQuerykk 
(kk  
)kk  !
;kk! "
}nn 	
publicuu 
staticuu 
booluu 
Deleteuu !
(uu! "
Guiduu" &
guiduu' +
)uu+ ,
{vv 	
SqlParameterHelperww 
sphww "
=ww# $
newww% (
SqlParameterHelperww) ;
(ww; <
ConnectionStringww< L
.wwL M$
GetWriteConnectionStringwwM e
(wwe f
)wwf g
,wwg h
$str	wwi 
,
ww 
$num
ww 
)
ww 
;
ww 
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# *
,xx* +
	SqlDbTypexx, 5
.xx5 6
UniqueIdentifierxx6 F
,xxF G
ParameterDirectionxxH Z
.xxZ [
Inputxx[ `
,xx` a
guidxxb f
)xxf g
;xxg h
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByModule
 )
(
) *
Guid
* .

moduleGuid
/ 9
)
9 :
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
}
 
} ÊN
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailSendQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailSendQueue (
{ 
publicII 
staticII 
intII 
CreateII  
(II  !
GuidJJ 
guidJJ 
,JJ 
GuidKK 
siteGuidKK 
,KK 
GuidLL 

moduleGuidLL 
,LL 
GuidMM 
userGuidMM 
,MM 
GuidNN 
specialGuid1NN 
,NN 
GuidOO 
specialGuid2OO 
,OO 
stringPP 
fromAddressPP 
,PP 
stringQQ 
replyToQQ 
,QQ 
stringRR 
	toAddressRR 
,RR 
stringSS 
	ccAddressSS 
,SS 
stringTT 

bccAddressTT 
,TT 
stringUU 
subjectUU 
,UU 
stringVV 
textBodyVV 
,VV 
stringWW 
htmlBodyWW 
,WW 
stringXX 
typeXX 
,XX 
DateTimeYY 

dateToSendYY 
,YY  
DateTimeZZ 

createdUtcZZ 
)ZZ  
{[[ 	
SqlParameterHelper\\ 
sph\\ "
=\\# $
new\\% (
SqlParameterHelper\\) ;
(\\; <
ConnectionString\\< L
.\\L M$
GetWriteConnectionString\\M e
(\\e f
)\\f g
,\\g h
$str	\\i 
,
\\ 
$num
\\ 
)
\\ 
;
\\ 
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
UniqueIdentifier]]6 F
,]]F G
ParameterDirection]]H Z
.]]Z [
Input]][ `
,]]` a
guid]]b f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
UniqueIdentifier^^: J
,^^J K
ParameterDirection^^L ^
.^^^ _
Input^^_ d
,^^d e
siteGuid^^f n
)^^n o
;^^o p
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 0
,__0 1
	SqlDbType__2 ;
.__; <
UniqueIdentifier__< L
,__L M
ParameterDirection__N `
.__` a
Input__a f
,__f g

moduleGuid__h r
)__r s
;__s t
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# .
,``. /
	SqlDbType``0 9
.``9 :
UniqueIdentifier``: J
,``J K
ParameterDirection``L ^
.``^ _
Input``_ d
,``d e
userGuid``f n
)``n o
;``o p
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
UniqueIdentifieraa> N
,aaN O
ParameterDirectionaaP b
.aab c
Inputaac h
,aah i
specialGuid1aaj v
)aav w
;aaw x
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
UniqueIdentifierbb> N
,bbN O
ParameterDirectionbbP b
.bbb c
Inputbbc h
,bbh i
specialGuid2bbj v
)bbv w
;bbw x
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 1
,cc1 2
	SqlDbTypecc3 <
.cc< =
NVarCharcc= E
,ccE F
$numccG J
,ccJ K
ParameterDirectionccL ^
.cc^ _
Inputcc_ d
,ccd e
fromAddressccf q
)ccq r
;ccr s
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# -
,dd- .
	SqlDbTypedd/ 8
.dd8 9
NVarChardd9 A
,ddA B
$numddC F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
replyToddb i
)ddi j
;ddj k
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
NVarCharee; C
,eeC D
$numeeE H
,eeH I
ParameterDirectioneeJ \
.ee\ ]
Inputee] b
,eeb c
	toAddresseed m
)eem n
;een o
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# /
,ff/ 0
	SqlDbTypeff1 :
.ff: ;
NVarCharff; C
,ffC D
$numffE H
,ffH I
ParameterDirectionffJ \
.ff\ ]
Inputff] b
,ffb c
	ccAddressffd m
)ffm n
;ffn o
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 0
,gg0 1
	SqlDbTypegg2 ;
.gg; <
NVarChargg< D
,ggD E
$numggF I
,ggI J
ParameterDirectionggK ]
.gg] ^
Inputgg^ c
,ggc d

bccAddressgge o
)ggo p
;ggp q
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# -
,hh- .
	SqlDbTypehh/ 8
.hh8 9
NVarCharhh9 A
,hhA B
$numhhC F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
subjecthhb i
)hhi j
;hhj k
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# .
,ii. /
	SqlDbTypeii0 9
.ii9 :
NVarCharii: B
,iiB C
-iiD E
$numiiE F
,iiF G
ParameterDirectioniiH Z
.iiZ [
Inputii[ `
,ii` a
textBodyiib j
)iij k
;iik l
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
NVarCharjj: B
,jjB C
-jjD E
$numjjE F
,jjF G
ParameterDirectionjjH Z
.jjZ [
Inputjj[ `
,jj` a
htmlBodyjjb j
)jjj k
;jjk l
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# *
,kk* +
	SqlDbTypekk, 5
.kk5 6
NVarCharkk6 >
,kk> ?
$numkk@ B
,kkB C
ParameterDirectionkkD V
.kkV W
InputkkW \
,kk\ ]
typekk^ b
)kkb c
;kkc d
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
DateTimell< D
,llD E
ParameterDirectionllF X
.llX Y
InputllY ^
,ll^ _

dateToSendll` j
)llj k
;llk l
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 0
,mm0 1
	SqlDbTypemm2 ;
.mm; <
DateTimemm< D
,mmD E
ParameterDirectionmmF X
.mmX Y
InputmmY ^
,mm^ _

createdUtcmm` j
)mmj k
;mmk l
intnn 
rowsAffectednn 
=nn 
sphnn "
.nn" #
ExecuteNonQuerynn# 2
(nn2 3
)nn3 4
;nn4 5
returnoo 
rowsAffectedoo 
;oo  
}qq 	
publicxx 
staticxx 
boolxx 
Deletexx !
(xx! "
Guidxx" &
guidxx' +
)xx+ ,
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M$
GetWriteConnectionStringzzM e
(zze f
)zzf g
,zzg h
$str	zzi 
,
zz 
$num
zz 
)
zz 
;
zz 
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# *
,{{* +
	SqlDbType{{, 5
.{{5 6
UniqueIdentifier{{6 F
,{{F G
ParameterDirection{{H Z
.{{Z [
Input{{[ `
,{{` a
guid{{b f
){{f g
;{{g h
int|| 
rowsAffected|| 
=|| 
sph|| "
.||" #
ExecuteNonQuery||# 2
(||2 3
)||3 4
;||4 5
return}} 
(}} 
rowsAffected}}  
>}}! "
$num}}# $
)}}$ %
;}}% &
} 	
public
 
static
 
IDataReader
 !
GetEmailToSend
" 0
(
0 1
DateTime
1 9
currentTime
: E
)
E F
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
DateTime
= E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
currentTime
a l
)
l m
;
m n
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
}
 
} Ä¹
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBEmailTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBEmailTemplate '
{ 
public11 
static11 
int11 
Create11  
(11  !
Guid22 
guid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
featureGuid44 
,44 
Guid55 

moduleGuid55 
,55 
Guid66 
specialGuid166 
,66 
Guid77 
specialGuid277 
,77 
string88 
name88 
,88 
string99 
subject99 
,99 
string:: 
textBody:: 
,:: 
string;; 
htmlBody;; 
,;; 
bool<< 
hasHtml<< 
,<< 
bool== 

isEditable== 
,== 
DateTime>> 

createdUtc>> 
,>>  
Guid?? 
	lastModBy?? 
)?? 
{@@ 	
SqlParameterHelperAA 
sphAA "
=AA# $
newAA% (
SqlParameterHelperAA) ;
(AA; <
ConnectionStringAA< L
.AAL M$
GetWriteConnectionStringAAM e
(AAe f
)AAf g
,AAg h
$str	AAi 
,
AA 
$num
AA 
)
AA 
;
AA 
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# *
,BB* +
	SqlDbTypeBB, 5
.BB5 6
UniqueIdentifierBB6 F
,BBF G
ParameterDirectionBBH Z
.BBZ [
InputBB[ `
,BB` a
guidBBb f
)BBf g
;BBg h
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# .
,CC. /
	SqlDbTypeCC0 9
.CC9 :
UniqueIdentifierCC: J
,CCJ K
ParameterDirectionCCL ^
.CC^ _
InputCC_ d
,CCd e
siteGuidCCf n
)CCn o
;CCo p
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 1
,DD1 2
	SqlDbTypeDD3 <
.DD< =
UniqueIdentifierDD= M
,DDM N
ParameterDirectionDDO a
.DDa b
InputDDb g
,DDg h
featureGuidDDi t
)DDt u
;DDu v
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 0
,EE0 1
	SqlDbTypeEE2 ;
.EE; <
UniqueIdentifierEE< L
,EEL M
ParameterDirectionEEN `
.EE` a
InputEEa f
,EEf g

moduleGuidEEh r
)EEr s
;EEs t
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 2
,FF2 3
	SqlDbTypeFF4 =
.FF= >
UniqueIdentifierFF> N
,FFN O
ParameterDirectionFFP b
.FFb c
InputFFc h
,FFh i
specialGuid1FFj v
)FFv w
;FFw x
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 2
,GG2 3
	SqlDbTypeGG4 =
.GG= >
UniqueIdentifierGG> N
,GGN O
ParameterDirectionGGP b
.GGb c
InputGGc h
,GGh i
specialGuid2GGj v
)GGv w
;GGw x
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
NVarCharHH6 >
,HH> ?
$numHH@ C
,HHC D
ParameterDirectionHHE W
.HHW X
InputHHX ]
,HH] ^
nameHH_ c
)HHc d
;HHd e
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# -
,II- .
	SqlDbTypeII/ 8
.II8 9
NVarCharII9 A
,IIA B
$numIIC F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
subjectIIb i
)IIi j
;IIj k
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
NVarCharJJ: B
,JJB C
-JJD E
$numJJE F
,JJF G
ParameterDirectionJJH Z
.JJZ [
InputJJ[ `
,JJ` a
textBodyJJb j
)JJj k
;JJk l
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
NVarCharKK: B
,KKB C
-KKD E
$numKKE F
,KKF G
ParameterDirectionKKH Z
.KKZ [
InputKK[ `
,KK` a
htmlBodyKKb j
)KKj k
;KKk l
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# -
,LL- .
	SqlDbTypeLL/ 8
.LL8 9
BitLL9 <
,LL< =
ParameterDirectionLL> P
.LLP Q
InputLLQ V
,LLV W
hasHtmlLLX _
)LL_ `
;LL` a
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 0
,MM0 1
	SqlDbTypeMM2 ;
.MM; <
BitMM< ?
,MM? @
ParameterDirectionMMA S
.MMS T
InputMMT Y
,MMY Z

isEditableMM[ e
)MMe f
;MMf g
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 0
,NN0 1
	SqlDbTypeNN2 ;
.NN; <
DateTimeNN< D
,NND E
ParameterDirectionNNF X
.NNX Y
InputNNY ^
,NN^ _

createdUtcNN` j
)NNj k
;NNk l
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
DateTimeOO< D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _

createdUtcOO` j
)OOj k
;OOk l
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
UniqueIdentifierPP; K
,PPK L
ParameterDirectionPPM _
.PP_ `
InputPP` e
,PPe f
	lastModByPPg p
)PPp q
;PPq r
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}TT 	
publicdd 
staticdd 
booldd 
Updatedd !
(dd! "
Guidee 
guidee 
,ee 
stringff 
nameff 
,ff 
stringgg 
subjectgg 
,gg 
stringhh 
textBodyhh 
,hh 
stringii 
htmlBodyii 
,ii 
booljj 
hasHtmljj 
,jj 
boolkk 

isEditablekk 
,kk 
DateTimell 

lastModUtcll 
,ll  
Guidmm 
	lastModBymm 
)mm 
{nn 	
SqlParameterHelperoo 
sphoo "
=oo# $
newoo% (
SqlParameterHelperoo) ;
(oo; <
ConnectionStringoo< L
.ooL M$
GetWriteConnectionStringooM e
(ooe f
)oof g
,oog h
$str	ooi 
,
oo 
$num
oo 
)
oo 
;
oo 
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# *
,pp* +
	SqlDbTypepp, 5
.pp5 6
UniqueIdentifierpp6 F
,ppF G
ParameterDirectionppH Z
.ppZ [
Inputpp[ `
,pp` a
guidppb f
)ppf g
;ppg h
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# *
,qq* +
	SqlDbTypeqq, 5
.qq5 6
NVarCharqq6 >
,qq> ?
$numqq@ C
,qqC D
ParameterDirectionqqE W
.qqW X
InputqqX ]
,qq] ^
nameqq_ c
)qqc d
;qqd e
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# -
,rr- .
	SqlDbTyperr/ 8
.rr8 9
NVarCharrr9 A
,rrA B
$numrrC F
,rrF G
ParameterDirectionrrH Z
.rrZ [
Inputrr[ `
,rr` a
subjectrrb i
)rri j
;rrj k
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# .
,ss. /
	SqlDbTypess0 9
.ss9 :
NVarCharss: B
,ssB C
-ssD E
$numssE F
,ssF G
ParameterDirectionssH Z
.ssZ [
Inputss[ `
,ss` a
textBodyssb j
)ssj k
;ssk l
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# .
,tt. /
	SqlDbTypett0 9
.tt9 :
NVarChartt: B
,ttB C
-ttD E
$numttE F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
htmlBodyttb j
)ttj k
;ttk l
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# -
,uu- .
	SqlDbTypeuu/ 8
.uu8 9
Bituu9 <
,uu< =
ParameterDirectionuu> P
.uuP Q
InputuuQ V
,uuV W
hasHtmluuX _
)uu_ `
;uu` a
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 0
,vv0 1
	SqlDbTypevv2 ;
.vv; <
Bitvv< ?
,vv? @
ParameterDirectionvvA S
.vvS T
InputvvT Y
,vvY Z

isEditablevv[ e
)vve f
;vvf g
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
DateTimeww< D
,wwD E
ParameterDirectionwwF X
.wwX Y
InputwwY ^
,ww^ _

lastModUtcww` j
)wwj k
;wwk l
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# /
,xx/ 0
	SqlDbTypexx1 :
.xx: ;
UniqueIdentifierxx; K
,xxK L
ParameterDirectionxxM _
.xx_ `
Inputxx` e
,xxe f
	lastModByxxg p
)xxp q
;xxq r
intyy 
rowsAffectedyy 
=yy 
sphyy "
.yy" #
ExecuteNonQueryyy# 2
(yy2 3
)yy3 4
;yy4 5
returnzz 
(zz 
rowsAffectedzz  
>zz! "
$numzz# $
)zz$ %
;zz% &
}|| 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
guid
' +
)
+ ,
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByFeature
 *
(
* +
Guid
+ /
featureGuid
0 ;
)
; <
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M&
GetWriteConnectionString
¡¡M e
(
¡¡e f
)
¡¡f g
,
¡¡g h
$str¡¡i 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 1
,
¢¢1 2
	SqlDbType
¢¢3 <
.
¢¢< =
UniqueIdentifier
¢¢= M
,
¢¢M N 
ParameterDirection
¢¢O a
.
¢¢a b
Input
¢¢b g
,
¢¢g h
featureGuid
¢¢i t
)
¢¢t u
;
¢¢u v
int
££ 
rowsAffected
££ 
=
££ 
sph
££ "
.
££" #
ExecuteNonQuery
££# 2
(
££2 3
)
££3 4
;
££4 5
return
¤¤ 
(
¤¤ 
rowsAffected
¤¤  
>
¤¤! "
$num
¤¤# $
)
¤¤$ %
;
¤¤% &
}
¦¦ 	
public
­­ 
static
­­ 
bool
­­ 
DeleteByModule
­­ )
(
­­) *
Guid
­­* .

moduleGuid
­­/ 9
)
­­9 :
{
®® 	 
SqlParameterHelper
¯¯ 
sph
¯¯ "
=
¯¯# $
new
¯¯% ( 
SqlParameterHelper
¯¯) ;
(
¯¯; <
ConnectionString
¯¯< L
.
¯¯L M&
GetWriteConnectionString
¯¯M e
(
¯¯e f
)
¯¯f g
,
¯¯g h
$str¯¯i 
,¯¯ 
$num¯¯ 
)¯¯ 
;¯¯ 
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 0
,
°°0 1
	SqlDbType
°°2 ;
.
°°; <
UniqueIdentifier
°°< L
,
°°L M 
ParameterDirection
°°N `
.
°°` a
Input
°°a f
,
°°f g

moduleGuid
°°h r
)
°°r s
;
°°s t
int
±± 
rowsAffected
±± 
=
±± 
sph
±± "
.
±±" #
ExecuteNonQuery
±±# 2
(
±±2 3
)
±±3 4
;
±±4 5
return
²² 
(
²² 
rowsAffected
²²  
>
²²! "
$num
²²# $
)
²²$ %
;
²²% &
}
´´ 	
public
»» 
static
»» 
bool
»» 
DeleteBySpecial1
»» +
(
»»+ ,
Guid
»», 0
specialGuid1
»»1 =
)
»»= >
{
¼¼ 	
if
½½ 
(
½½ 
specialGuid1
½½ 
==
½½ 
Guid
½½  $
.
½½$ %
Empty
½½% *
)
½½* +
{
½½, -
return
½½. 4
false
½½5 :
;
½½: ;
}
½½< = 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M&
GetWriteConnectionString
¿¿M e
(
¿¿e f
)
¿¿f g
,
¿¿g h
$str¿¿i 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 2
,
ÀÀ2 3
	SqlDbType
ÀÀ4 =
.
ÀÀ= >
UniqueIdentifier
ÀÀ> N
,
ÀÀN O 
ParameterDirection
ÀÀP b
.
ÀÀb c
Input
ÀÀc h
,
ÀÀh i
specialGuid1
ÀÀj v
)
ÀÀv w
;
ÀÀw x
int
ÁÁ 
rowsAffected
ÁÁ 
=
ÁÁ 
sph
ÁÁ "
.
ÁÁ" #
ExecuteNonQuery
ÁÁ# 2
(
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
return
ÂÂ 
(
ÂÂ 
rowsAffected
ÂÂ  
>
ÂÂ! "
$num
ÂÂ# $
)
ÂÂ$ %
;
ÂÂ% &
}
ÄÄ 	
public
ËË 
static
ËË 
bool
ËË 
DeleteBySpecial2
ËË +
(
ËË+ ,
Guid
ËË, 0
specialGuid2
ËË1 =
)
ËË= >
{
ÌÌ 	
if
ÍÍ 
(
ÍÍ 
specialGuid2
ÍÍ 
==
ÍÍ 
Guid
ÍÍ  $
.
ÍÍ$ %
Empty
ÍÍ% *
)
ÍÍ* +
{
ÍÍ, -
return
ÍÍ. 4
false
ÍÍ5 :
;
ÍÍ: ;
}
ÍÍ< = 
SqlParameterHelper
ÏÏ 
sph
ÏÏ "
=
ÏÏ# $
new
ÏÏ% ( 
SqlParameterHelper
ÏÏ) ;
(
ÏÏ; <
ConnectionString
ÏÏ< L
.
ÏÏL M&
GetWriteConnectionString
ÏÏM e
(
ÏÏe f
)
ÏÏf g
,
ÏÏg h
$strÏÏi 
,ÏÏ 
$numÏÏ 
)ÏÏ 
;ÏÏ 
sph
ÐÐ 
.
ÐÐ  
DefineSqlParameter
ÐÐ "
(
ÐÐ" #
$str
ÐÐ# 2
,
ÐÐ2 3
	SqlDbType
ÐÐ4 =
.
ÐÐ= >
UniqueIdentifier
ÐÐ> N
,
ÐÐN O 
ParameterDirection
ÐÐP b
.
ÐÐb c
Input
ÐÐc h
,
ÐÐh i
specialGuid2
ÐÐj v
)
ÐÐv w
;
ÐÐw x
int
ÑÑ 
rowsAffected
ÑÑ 
=
ÑÑ 
sph
ÑÑ "
.
ÑÑ" #
ExecuteNonQuery
ÑÑ# 2
(
ÑÑ2 3
)
ÑÑ3 4
;
ÑÑ4 5
return
ÒÒ 
(
ÒÒ 
rowsAffected
ÒÒ  
>
ÒÒ! "
$num
ÒÒ# $
)
ÒÒ$ %
;
ÒÒ% &
}
ÔÔ 	
public
ÚÚ 
static
ÚÚ 
IDataReader
ÚÚ !
GetOne
ÚÚ" (
(
ÚÚ( )
Guid
ÚÚ) -
guid
ÚÚ. 2
)
ÚÚ2 3
{
ÛÛ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$strÜÜh 
,ÜÜ 
$numÜÜ 
)ÜÜ 
;ÜÜ 
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# *
,
ÝÝ* +
	SqlDbType
ÝÝ, 5
.
ÝÝ5 6
UniqueIdentifier
ÝÝ6 F
,
ÝÝF G 
ParameterDirection
ÝÝH Z
.
ÝÝZ [
Input
ÝÝ[ `
,
ÝÝ` a
guid
ÝÝb f
)
ÝÝf g
;
ÝÝg h
return
ÞÞ 
sph
ÞÞ 
.
ÞÞ 
ExecuteReader
ÞÞ $
(
ÞÞ$ %
)
ÞÞ% &
;
ÞÞ& '
}
àà 	
public
ââ 
static
ââ 
IDataReader
ââ !
Get
ââ" %
(
ââ% &
Guid
ââ& *
siteGuid
ââ+ 3
,
ââ3 4
Guid
ââ5 9
featureGuid
ââ: E
,
ââE F
Guid
ââG K

moduleGuid
ââL V
,
ââV W
Guid
ââX \
specialGuid1
ââ] i
,
ââi j
Guid
ââk o
specialGuid2
ââp |
)
ââ| }
{
ãã 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M%
GetReadConnectionString
ääM d
(
ääd e
)
ääe f
,
ääf g
$strääh 
,ää 
$numää 
)ää 
;ää 
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# .
,
åå. /
	SqlDbType
åå0 9
.
åå9 :
UniqueIdentifier
åå: J
,
ååJ K 
ParameterDirection
ååL ^
.
åå^ _
Input
åå_ d
,
ååd e
siteGuid
ååf n
)
åån o
;
ååo p
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 1
,
ææ1 2
	SqlDbType
ææ3 <
.
ææ< =
UniqueIdentifier
ææ= M
,
ææM N 
ParameterDirection
ææO a
.
ææa b
Input
ææb g
,
ææg h
featureGuid
ææi t
)
ææt u
;
ææu v
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 0
,
çç0 1
	SqlDbType
çç2 ;
.
çç; <
UniqueIdentifier
çç< L
,
ççL M 
ParameterDirection
ççN `
.
çç` a
Input
çça f
,
ççf g

moduleGuid
ççh r
)
ççr s
;
ççs t
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# 2
,
èè2 3
	SqlDbType
èè4 =
.
èè= >
UniqueIdentifier
èè> N
,
èèN O 
ParameterDirection
èèP b
.
èèb c
Input
èèc h
,
èèh i
specialGuid1
èèj v
)
èèv w
;
èèw x
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 2
,
éé2 3
	SqlDbType
éé4 =
.
éé= >
UniqueIdentifier
éé> N
,
ééN O 
ParameterDirection
ééP b
.
ééb c
Input
ééc h
,
ééh i
specialGuid2
ééj v
)
éév w
;
ééw x
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
íí 	
public
óó 
static
óó 
IDataReader
óó !
GetByModule
óó" -
(
óó- .
Guid
óó. 2

moduleGuid
óó3 =
)
óó= >
{
ôô 	 
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M%
GetReadConnectionString
õõM d
(
õõd e
)
õõe f
,
õõf g
$strõõh 
,õõ 
$numõõ 
)õõ 
;õõ 
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 0
,
öö0 1
	SqlDbType
öö2 ;
.
öö; <
UniqueIdentifier
öö< L
,
ööL M 
ParameterDirection
ööN `
.
öö` a
Input
ööa f
,
ööf g

moduleGuid
ööh r
)
öör s
;
öös t
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
ùù 	
public
ûû 
static
ûû 
IDataReader
ûû !
GetByFeature
ûû" .
(
ûû. /
Guid
ûû/ 3
siteGuid
ûû4 <
,
ûû< =
Guid
ûû> B
featureGuid
ûûC N
)
ûûN O
{
üü 	 
SqlParameterHelper
ýý 
sph
ýý "
=
ýý# $
new
ýý% ( 
SqlParameterHelper
ýý) ;
(
ýý; <
ConnectionString
ýý< L
.
ýýL M%
GetReadConnectionString
ýýM d
(
ýýd e
)
ýýe f
,
ýýf g
$strýýh 
,ýý 
$numýý 
)ýý 
;ýý 
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# .
,
þþ. /
	SqlDbType
þþ0 9
.
þþ9 :
UniqueIdentifier
þþ: J
,
þþJ K 
ParameterDirection
þþL ^
.
þþ^ _
Input
þþ_ d
,
þþd e
siteGuid
þþf n
)
þþn o
;
þþo p
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 1
,
ÿÿ1 2
	SqlDbType
ÿÿ3 <
.
ÿÿ< =
UniqueIdentifier
ÿÿ= M
,
ÿÿM N 
ParameterDirection
ÿÿO a
.
ÿÿa b
Input
ÿÿb g
,
ÿÿg h
featureGuid
ÿÿi t
)
ÿÿt u
;
ÿÿu v
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetByModule
" -
(
- .
Guid
. 2

moduleGuid
3 =
,
= >
Guid
? C
specialGuid1
D P
,
P Q
Guid
R V
specialGuid2
W c
)
c d
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
UniqueIdentifier
> N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
specialGuid1
j v
)
v w
;
w x
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
UniqueIdentifier
> N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
specialGuid2
j v
)
v w
;
w x
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
siteGuid
( 0
,
0 1
Guid
2 6
featureGuid
7 B
,
B C
Guid
D H

moduleGuid
I S
,
S T
Guid
U Y
specialGuid1
Z f
,
f g
Guid
h l
specialGuid2
m y
)
y z
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
UniqueIdentifier
> N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
specialGuid1
j v
)
v w
;
w x
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
UniqueIdentifier
> N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
specialGuid2
j v
)
v w
;
w x
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
¤¤ 
static
¤¤ 
int
¤¤ %
GetCountByModuleAndName
¤¤ 1
(
¤¤1 2
Guid
¤¤2 6

moduleGuid
¤¤7 A
,
¤¤A B
string
¤¤C I
name
¤¤J N
)
¤¤N O
{
¥¥ 	 
SqlParameterHelper
¦¦ 
sph
¦¦ "
=
¦¦# $
new
¦¦% ( 
SqlParameterHelper
¦¦) ;
(
¦¦; <
ConnectionString
¦¦< L
.
¦¦L M%
GetReadConnectionString
¦¦M d
(
¦¦d e
)
¦¦e f
,
¦¦f g
$str¦¦h 
,¦¦ 
$num¦¦ 
)¦¦ 
;¦¦ 
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 0
,
§§0 1
	SqlDbType
§§2 ;
.
§§; <
UniqueIdentifier
§§< L
,
§§L M 
ParameterDirection
§§N `
.
§§` a
Input
§§a f
,
§§f g

moduleGuid
§§h r
)
§§r s
;
§§s t
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# *
,
¨¨* +
	SqlDbType
¨¨, 5
.
¨¨5 6
NVarChar
¨¨6 >
,
¨¨> ?
$num
¨¨@ C
,
¨¨C D 
ParameterDirection
¨¨E W
.
¨¨W X
Input
¨¨X ]
,
¨¨] ^
name
¨¨_ c
)
¨¨c d
;
¨¨d e
return
ªª 
Convert
ªª 
.
ªª 
ToInt32
ªª "
(
ªª" #
sph
ªª# &
.
ªª& '
ExecuteScalar
ªª' 4
(
ªª4 5
)
ªª5 6
)
ªª6 7
;
ªª7 8
}
¬¬ 	
public
±± 
static
±± 
int
±± ,
GetCountByModuleSpecialAndName
±± 8
(
±±8 9
Guid
±±9 =

moduleGuid
±±> H
,
±±H I
Guid
±±J N
specialGuid1
±±O [
,
±±[ \
Guid
±±] a
specialGuid2
±±b n
,
±±n o
string
±±p v
name
±±w {
)
±±{ |
{
²² 	 
SqlParameterHelper
³³ 
sph
³³ "
=
³³# $
new
³³% ( 
SqlParameterHelper
³³) ;
(
³³; <
ConnectionString
³³< L
.
³³L M%
GetReadConnectionString
³³M d
(
³³d e
)
³³e f
,
³³f g
$str³³h 
,³³ 
$num³³ 
)³³ 
;³³ 
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 0
,
´´0 1
	SqlDbType
´´2 ;
.
´´; <
UniqueIdentifier
´´< L
,
´´L M 
ParameterDirection
´´N `
.
´´` a
Input
´´a f
,
´´f g

moduleGuid
´´h r
)
´´r s
;
´´s t
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 2
,
µµ2 3
	SqlDbType
µµ4 =
.
µµ= >
UniqueIdentifier
µµ> N
,
µµN O 
ParameterDirection
µµP b
.
µµb c
Input
µµc h
,
µµh i
specialGuid1
µµj v
)
µµv w
;
µµw x
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# 2
,
¶¶2 3
	SqlDbType
¶¶4 =
.
¶¶= >
UniqueIdentifier
¶¶> N
,
¶¶N O 
ParameterDirection
¶¶P b
.
¶¶b c
Input
¶¶c h
,
¶¶h i
specialGuid2
¶¶j v
)
¶¶v w
;
¶¶w x
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# *
,
··* +
	SqlDbType
··, 5
.
··5 6
NVarChar
··6 >
,
··> ?
$num
··@ C
,
··C D 
ParameterDirection
··E W
.
··W X
Input
··X ]
,
··] ^
name
··_ c
)
··c d
;
··d e
return
¹¹ 
Convert
¹¹ 
.
¹¹ 
ToInt32
¹¹ "
(
¹¹" #
sph
¹¹# &
.
¹¹& '
ExecuteScalar
¹¹' 4
(
¹¹4 5
)
¹¹5 6
)
¹¹6 7
;
¹¹7 8
}
»» 	
public
½½ 
static
½½ 
int
½½ 
GetCountByFeature
½½ +
(
½½+ ,
Guid
½½, 0
siteGuid
½½1 9
,
½½9 :
Guid
½½; ?
featureGuid
½½@ K
)
½½K L
{
¾¾ 	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M%
GetReadConnectionString
ÀÀM d
(
ÀÀd e
)
ÀÀe f
,
ÀÀf g
$strÀÀh 
,ÀÀ 
$numÀÀ 
)ÀÀ 
;ÀÀ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# .
,
ÁÁ. /
	SqlDbType
ÁÁ0 9
.
ÁÁ9 :
UniqueIdentifier
ÁÁ: J
,
ÁÁJ K 
ParameterDirection
ÁÁL ^
.
ÁÁ^ _
Input
ÁÁ_ d
,
ÁÁd e
siteGuid
ÁÁf n
)
ÁÁn o
;
ÁÁo p
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# 1
,
ÂÂ1 2
	SqlDbType
ÂÂ3 <
.
ÂÂ< =
UniqueIdentifier
ÂÂ= M
,
ÂÂM N 
ParameterDirection
ÂÂO a
.
ÂÂa b
Input
ÂÂb g
,
ÂÂg h
featureGuid
ÂÂi t
)
ÂÂt u
;
ÂÂu v
return
ÄÄ 
Convert
ÄÄ 
.
ÄÄ 
ToInt32
ÄÄ "
(
ÄÄ" #
sph
ÄÄ# &
.
ÄÄ& '
ExecuteScalar
ÄÄ' 4
(
ÄÄ4 5
)
ÄÄ5 6
)
ÄÄ6 7
;
ÄÄ7 8
}
ÇÇ 	
public
ÉÉ 
static
ÉÉ 
IDataReader
ÉÉ !
GetPageByFeature
ÉÉ" 2
(
ÉÉ2 3
Guid
ÊÊ 
siteGuid
ÊÊ 
,
ÊÊ 
Guid
ËË 
featureGuid
ËË 
,
ËË 
int
ÌÌ 

pageNumber
ÌÌ 
,
ÌÌ 
int
ÍÍ 
pageSize
ÍÍ 
,
ÍÍ 
out
ÎÎ 
int
ÎÎ 

totalPages
ÎÎ 
)
ÎÎ 
{
ÏÏ 	

totalPages
ÐÐ 
=
ÐÐ 
$num
ÐÐ 
;
ÐÐ 
int
ÑÑ 
	totalRows
ÑÑ 
=
ÑÑ 
GetCountByFeature
ÑÑ -
(
ÑÑ- .
siteGuid
ÑÑ. 6
,
ÑÑ6 7
featureGuid
ÑÑ8 C
)
ÑÑC D
;
ÑÑD E
if
ÓÓ 
(
ÓÓ 
pageSize
ÓÓ 
>
ÓÓ 
$num
ÓÓ 
)
ÓÓ 

totalPages
ÓÓ (
=
ÓÓ) *
	totalRows
ÓÓ+ 4
/
ÓÓ5 6
pageSize
ÓÓ7 ?
;
ÓÓ? @
if
ÕÕ 
(
ÕÕ 
	totalRows
ÕÕ 
<=
ÕÕ 
pageSize
ÕÕ %
)
ÕÕ% &
{
ÖÖ 

totalPages
×× 
=
×× 
$num
×× 
;
×× 
}
ØØ 
else
ÙÙ 
{
ÚÚ 
int
ÛÛ 
	remainder
ÛÛ 
;
ÛÛ 
Math
ÜÜ 
.
ÜÜ 
DivRem
ÜÜ 
(
ÜÜ 
	totalRows
ÜÜ %
,
ÜÜ% &
pageSize
ÜÜ' /
,
ÜÜ/ 0
out
ÜÜ1 4
	remainder
ÜÜ5 >
)
ÜÜ> ?
;
ÜÜ? @
if
ÝÝ 
(
ÝÝ 
	remainder
ÝÝ 
>
ÝÝ 
$num
ÝÝ  !
)
ÝÝ! "
{
ÞÞ 

totalPages
ßß 
+=
ßß !
$num
ßß" #
;
ßß# $
}
àà 
}
áá  
SqlParameterHelper
ãã 
sph
ãã "
=
ãã# $
new
ãã% ( 
SqlParameterHelper
ãã) ;
(
ãã; <
ConnectionString
ãã< L
.
ããL M%
GetReadConnectionString
ããM d
(
ããd e
)
ããe f
,
ããf g
$strããh 
,ãã 
$numãã 
)ãã 
;ãã 
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# .
,
ää. /
	SqlDbType
ää0 9
.
ää9 :
UniqueIdentifier
ää: J
,
ääJ K 
ParameterDirection
ääL ^
.
ää^ _
Input
ää_ d
,
ääd e
siteGuid
ääf n
)
ään o
;
ääo p
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# 1
,
åå1 2
	SqlDbType
åå3 <
.
åå< =
UniqueIdentifier
åå= M
,
ååM N 
ParameterDirection
ååO a
.
ååa b
Input
ååb g
,
ååg h
featureGuid
ååi t
)
ååt u
;
ååu v
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 0
,
ææ0 1
	SqlDbType
ææ2 ;
.
ææ; <
Int
ææ< ?
,
ææ? @ 
ParameterDirection
ææA S
.
ææS T
Input
ææT Y
,
ææY Z

pageNumber
ææ[ e
)
ææe f
;
ææf g
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# .
,
çç. /
	SqlDbType
çç0 9
.
çç9 :
Int
çç: =
,
çç= > 
ParameterDirection
çç? Q
.
ççQ R
Input
ççR W
,
ççW X
pageSize
ççY a
)
çça b
;
ççb c
return
èè 
sph
èè 
.
èè 
ExecuteReader
èè $
(
èè$ %
)
èè% &
;
èè& '
}
êê 	
}
ðð 
}òò ¸
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBFileAttachment.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBFileAttachment (
{ 
public++ 
static++ 
int++ 
Create++  
(++  !
Guid,, 
rowGuid,, 
,,, 
Guid-- 
siteGuid-- 
,-- 
Guid.. 

moduleGuid.. 
,.. 
Guid// 
itemGuid// 
,// 
Guid00 
specialGuid100 
,00 
Guid11 
specialGuid211 
,11 
string22 
serverFileName22 !
,22! "
string33 
fileName33 
,33 
string44 
contentTitle44 
,44  
long55 
contentLength55 
,55 
string66 
contentType66 
,66 
DateTime77 

createdUtc77 
,77  
Guid88 
	createdBy88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str	::i 
,
:: 
$num
:: 
)
:: 
;
:: 
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# -
,;;- .
	SqlDbType;;/ 8
.;;8 9
UniqueIdentifier;;9 I
,;;I J
ParameterDirection;;K ]
.;;] ^
Input;;^ c
,;;c d
rowGuid;;e l
);;l m
;;;m n
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# .
,<<. /
	SqlDbType<<0 9
.<<9 :
UniqueIdentifier<<: J
,<<J K
ParameterDirection<<L ^
.<<^ _
Input<<_ d
,<<d e
siteGuid<<f n
)<<n o
;<<o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 0
,==0 1
	SqlDbType==2 ;
.==; <
UniqueIdentifier==< L
,==L M
ParameterDirection==N `
.==` a
Input==a f
,==f g

moduleGuid==h r
)==r s
;==s t
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># .
,>>. /
	SqlDbType>>0 9
.>>9 :
UniqueIdentifier>>: J
,>>J K
ParameterDirection>>L ^
.>>^ _
Input>>_ d
,>>d e
itemGuid>>f n
)>>n o
;>>o p
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 2
,??2 3
	SqlDbType??4 =
.??= >
UniqueIdentifier??> N
,??N O
ParameterDirection??P b
.??b c
Input??c h
,??h i
specialGuid1??j v
)??v w
;??w x
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 2
,@@2 3
	SqlDbType@@4 =
.@@= >
UniqueIdentifier@@> N
,@@N O
ParameterDirection@@P b
.@@b c
Input@@c h
,@@h i
specialGuid2@@j v
)@@v w
;@@w x
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 4
,AA4 5
	SqlDbTypeAA6 ?
.AA? @
NVarCharAA@ H
,AAH I
$numAAJ M
,AAM N
ParameterDirectionAAO a
.AAa b
InputAAb g
,AAg h
serverFileNameAAi w
)AAw x
;AAx y
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# .
,BB. /
	SqlDbTypeBB0 9
.BB9 :
NVarCharBB: B
,BBB C
$numBBD G
,BBG H
ParameterDirectionBBI [
.BB[ \
InputBB\ a
,BBa b
fileNameBBc k
)BBk l
;BBl m
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 2
,CC2 3
	SqlDbTypeCC4 =
.CC= >
NVarCharCC> F
,CCF G
$numCCH K
,CCK L
ParameterDirectionCCM _
.CC_ `
InputCC` e
,CCe f
contentTitleCCg s
)CCs t
;CCt u
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 3
,DD3 4
	SqlDbTypeDD5 >
.DD> ?
BigIntDD? E
,DDE F
ParameterDirectionDDG Y
.DDY Z
InputDDZ _
,DD_ `
contentLengthDDa n
)DDn o
;DDo p
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 1
,EE1 2
	SqlDbTypeEE3 <
.EE< =
NVarCharEE= E
,EEE F
$numEEG I
,EEI J
ParameterDirectionEEK ]
.EE] ^
InputEE^ c
,EEc d
contentTypeEEe p
)EEp q
;EEq r
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 0
,GG0 1
	SqlDbTypeGG2 ;
.GG; <
DateTimeGG< D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _

createdUtcGG` j
)GGj k
;GGk l
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# /
,HH/ 0
	SqlDbTypeHH1 :
.HH: ;
UniqueIdentifierHH; K
,HHK L
ParameterDirectionHHM _
.HH_ `
InputHH` e
,HHe f
	createdByHHg p
)HHp q
;HHq r
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
rowsAffectedJJ 
;JJ  
}LL 	
public]] 
static]] 
bool]] 
Update]] !
(]]! "
Guid^^ 
rowGuid^^ 
,^^ 
string__ 
serverFileName__ !
,__! "
string`` 
fileName`` 
,`` 
stringaa 
contentTitleaa 
,aa  
longbb 
contentLengthbb 
,bb 
stringcc 
contentTypecc 
)cc 
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M$
GetWriteConnectionStringeeM e
(eee f
)eef g
,eeg h
$str	eei 
,
ee 
$num
ee 
)
ee 
;
ee 
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# -
,ff- .
	SqlDbTypeff/ 8
.ff8 9
UniqueIdentifierff9 I
,ffI J
ParameterDirectionffK ]
.ff] ^
Inputff^ c
,ffc d
rowGuidffe l
)ffl m
;ffm n
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 4
,gg4 5
	SqlDbTypegg6 ?
.gg? @
NVarChargg@ H
,ggH I
$numggJ M
,ggM N
ParameterDirectionggO a
.gga b
Inputggb g
,ggg h
serverFileNameggi w
)ggw x
;ggx y
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# .
,hh. /
	SqlDbTypehh0 9
.hh9 :
NVarCharhh: B
,hhB C
$numhhD G
,hhG H
ParameterDirectionhhI [
.hh[ \
Inputhh\ a
,hha b
fileNamehhc k
)hhk l
;hhl m
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 2
,ii2 3
	SqlDbTypeii4 =
.ii= >
NVarCharii> F
,iiF G
$numiiH K
,iiK L
ParameterDirectioniiM _
.ii_ `
Inputii` e
,iie f
contentTitleiig s
)iis t
;iit u
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 3
,jj3 4
	SqlDbTypejj5 >
.jj> ?
BigIntjj? E
,jjE F
ParameterDirectionjjG Y
.jjY Z
InputjjZ _
,jj_ `
contentLengthjja n
)jjn o
;jjo p
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 1
,kk1 2
	SqlDbTypekk3 <
.kk< =
NVarCharkk= E
,kkE F
$numkkG I
,kkI J
ParameterDirectionkkK ]
.kk] ^
Inputkk^ c
,kkc d
contentTypekke p
)kkp q
;kkq r
intmm 
rowsAffectedmm 
=mm 
sphmm "
.mm" #
ExecuteNonQuerymm# 2
(mm2 3
)mm3 4
;mm4 5
returnnn 
(nn 
rowsAffectednn  
>nn! "
$numnn# $
)nn$ %
;nn% &
}pp 	
publicww 
staticww 
boolww 
Deleteww !
(ww! "
Guidww" &
rowGuidww' .
)ww. /
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$str	yyi 
,
yy 
$num
yy 
)
yy 
;
yy 
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# -
,zz- .
	SqlDbTypezz/ 8
.zz8 9
UniqueIdentifierzz9 I
,zzI J
ParameterDirectionzzK ]
.zz] ^
Inputzz^ c
,zzc d
rowGuidzze l
)zzl m
;zzm n
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}~~ 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByModule
 )
(
) *
Guid
* .

moduleGuid
/ 9
)
9 :
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
¡¡ 
static
¡¡ 
bool
¡¡ 
DeleteByItem
¡¡ '
(
¡¡' (
Guid
¡¡( ,
itemGuid
¡¡- 5
)
¡¡5 6
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i 
,££ 
$num££ 
)££ 
;££ 
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# .
,
¤¤. /
	SqlDbType
¤¤0 9
.
¤¤9 :
UniqueIdentifier
¤¤: J
,
¤¤J K 
ParameterDirection
¤¤L ^
.
¤¤^ _
Input
¤¤_ d
,
¤¤d e
itemGuid
¤¤f n
)
¤¤n o
;
¤¤o p
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
sph
¥¥ "
.
¥¥" #
ExecuteNonQuery
¥¥# 2
(
¥¥2 3
)
¥¥3 4
;
¥¥4 5
return
¦¦ 
(
¦¦ 
rowsAffected
¦¦  
>
¦¦! "
$num
¦¦# $
)
¦¦$ %
;
¦¦% &
}
¨¨ 	
public
®® 
static
®® 
IDataReader
®® !
GetOne
®®" (
(
®®( )
Guid
®®) -
rowGuid
®®. 5
)
®®5 6
{
¯¯ 	 
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h 
,°° 
$num°° 
)°° 
;°° 
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# -
,
±±- .
	SqlDbType
±±/ 8
.
±±8 9
UniqueIdentifier
±±9 I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d
rowGuid
±±e l
)
±±l m
;
±±m n
return
²² 
sph
²² 
.
²² 
ExecuteReader
²² $
(
²²$ %
)
²²% &
;
²²& '
}
´´ 	
public
ºº 
static
ºº 
IDataReader
ºº !
SelectByModule
ºº" 0
(
ºº0 1
Guid
ºº1 5

moduleGuid
ºº6 @
)
ºº@ A
{
»» 	 
SqlParameterHelper
¼¼ 
sph
¼¼ "
=
¼¼# $
new
¼¼% ( 
SqlParameterHelper
¼¼) ;
(
¼¼; <
ConnectionString
¼¼< L
.
¼¼L M%
GetReadConnectionString
¼¼M d
(
¼¼d e
)
¼¼e f
,
¼¼f g
$str¼¼h 
,¼¼ 
$num¼¼ 
)¼¼ 
;¼¼ 
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# 0
,
½½0 1
	SqlDbType
½½2 ;
.
½½; <
UniqueIdentifier
½½< L
,
½½L M 
ParameterDirection
½½N `
.
½½` a
Input
½½a f
,
½½f g

moduleGuid
½½h r
)
½½r s
;
½½s t
return
¾¾ 
sph
¾¾ 
.
¾¾ 
ExecuteReader
¾¾ $
(
¾¾$ %
)
¾¾% &
;
¾¾& '
}
ÀÀ 	
public
ÆÆ 
static
ÆÆ 
IDataReader
ÆÆ !
SelectByItem
ÆÆ" .
(
ÆÆ. /
Guid
ÆÆ/ 3
itemGuid
ÆÆ4 <
)
ÆÆ< =
{
ÇÇ 	 
SqlParameterHelper
ÈÈ 
sph
ÈÈ "
=
ÈÈ# $
new
ÈÈ% ( 
SqlParameterHelper
ÈÈ) ;
(
ÈÈ; <
ConnectionString
ÈÈ< L
.
ÈÈL M%
GetReadConnectionString
ÈÈM d
(
ÈÈd e
)
ÈÈe f
,
ÈÈf g
$strÈÈh 
,ÈÈ 
$numÈÈ 
)ÈÈ 
;ÈÈ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
UniqueIdentifier
ÉÉ: J
,
ÉÉJ K 
ParameterDirection
ÉÉL ^
.
ÉÉ^ _
Input
ÉÉ_ d
,
ÉÉd e
itemGuid
ÉÉf n
)
ÉÉn o
;
ÉÉo p
return
ÊÊ 
sph
ÊÊ 
.
ÊÊ 
ExecuteReader
ÊÊ $
(
ÊÊ$ %
)
ÊÊ% &
;
ÊÊ& '
}
ÌÌ 	
public
ÒÒ 
static
ÒÒ 
IDataReader
ÒÒ !
SelectBySpecial1
ÒÒ" 2
(
ÒÒ2 3
Guid
ÒÒ3 7
specialGuid1
ÒÒ8 D
)
ÒÒD E
{
ÓÓ 	 
SqlParameterHelper
ÔÔ 
sph
ÔÔ "
=
ÔÔ# $
new
ÔÔ% ( 
SqlParameterHelper
ÔÔ) ;
(
ÔÔ; <
ConnectionString
ÔÔ< L
.
ÔÔL M%
GetReadConnectionString
ÔÔM d
(
ÔÔd e
)
ÔÔe f
,
ÔÔf g
$strÔÔh 
,ÔÔ 
$numÔÔ 
)ÔÔ 
;ÔÔ 
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# 2
,
ÕÕ2 3
	SqlDbType
ÕÕ4 =
.
ÕÕ= >
UniqueIdentifier
ÕÕ> N
,
ÕÕN O 
ParameterDirection
ÕÕP b
.
ÕÕb c
Input
ÕÕc h
,
ÕÕh i
specialGuid1
ÕÕj v
)
ÕÕv w
;
ÕÕw x
return
ÖÖ 
sph
ÖÖ 
.
ÖÖ 
ExecuteReader
ÖÖ $
(
ÖÖ$ %
)
ÖÖ% &
;
ÖÖ& '
}
ØØ 	
public
ÞÞ 
static
ÞÞ 
IDataReader
ÞÞ !
SelectBySpecial2
ÞÞ" 2
(
ÞÞ2 3
Guid
ÞÞ3 7
specialGuid2
ÞÞ8 D
)
ÞÞD E
{
ßß 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$strààh 
,àà 
$numàà 
)àà 
;àà 
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 2
,
áá2 3
	SqlDbType
áá4 =
.
áá= >
UniqueIdentifier
áá> N
,
ááN O 
ParameterDirection
ááP b
.
ááb c
Input
áác h
,
ááh i
specialGuid2
ááj v
)
ááv w
;
ááw x
return
ââ 
sph
ââ 
.
ââ 
ExecuteReader
ââ $
(
ââ$ %
)
ââ% &
;
ââ& '
}
ää 	
}
èè 
}éé Ê
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbFriendlyUrl.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBFriendlyUrl %
{ 
public11 
static11 
int11 
AddFriendlyUrl11 (
(11( )
Guid22 
itemGuid22 
,22 
Guid33 
siteGuid33 
,33 
Guid44 
pageGuid44 
,44 
int55 
siteId55 
,55 
string66 
friendlyUrl66 
,66 
string77 
realUrl77 
,77 
bool88 
	isPattern88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str	::i 
,
:: 
$num
:: 
)
:: 
;
:: 
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# .
,;;. /
	SqlDbType;;0 9
.;;9 :
UniqueIdentifier;;: J
,;;J K
ParameterDirection;;L ^
.;;^ _
Input;;_ d
,;;d e
itemGuid;;f n
);;n o
;;;o p
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# .
,<<. /
	SqlDbType<<0 9
.<<9 :
UniqueIdentifier<<: J
,<<J K
ParameterDirection<<L ^
.<<^ _
Input<<_ d
,<<d e
siteGuid<<f n
)<<n o
;<<o p
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# .
,==. /
	SqlDbType==0 9
.==9 :
UniqueIdentifier==: J
,==J K
ParameterDirection==L ^
.==^ _
Input==_ d
,==d e
pageGuid==f n
)==n o
;==o p
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># ,
,>>, -
	SqlDbType>>. 7
.>>7 8
Int>>8 ;
,>>; <
ParameterDirection>>= O
.>>O P
Input>>P U
,>>U V
siteId>>W ]
)>>] ^
;>>^ _
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 1
,??1 2
	SqlDbType??3 <
.??< =
NVarChar??= E
,??E F
$num??G J
,??J K
ParameterDirection??L ^
.??^ _
Input??_ d
,??d e
friendlyUrl??f q
)??q r
;??r s
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# -
,@@- .
	SqlDbType@@/ 8
.@@8 9
NVarChar@@9 A
,@@A B
$num@@C F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
realUrl@@b i
)@@i j
;@@j k
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# /
,AA/ 0
	SqlDbTypeAA1 :
.AA: ;
BitAA; >
,AA> ?
ParameterDirectionAA@ R
.AAR S
InputAAS X
,AAX Y
	isPatternAAZ c
)AAc d
;AAd e
intBB 
newIDBB 
=BB 
ConvertBB 
.BB  
ToInt32BB  '
(BB' (
sphBB( +
.BB+ ,
ExecuteScalarBB, 9
(BB9 :
)BB: ;
)BB; <
;BB< =
returnCC 
newIDCC 
;CC 
}DD 	
publicFF 
staticFF 
boolFF 
UpdateFriendlyUrlFF ,
(FF, -
intGG 
urlIdGG 
,GG 
intHH 
siteIdHH 
,HH 
GuidII 
pageGuidII 
,II 
stringJJ 
friendlyUrlJJ 
,JJ 
stringKK 
realUrlKK 
,KK 
boolLL 
	isPatternLL 
)LL 
{MM 	
SqlParameterHelperNN 
sphNN "
=NN# $
newNN% (
SqlParameterHelperNN) ;
(NN; <
ConnectionStringNN< L
.NNL M$
GetWriteConnectionStringNNM e
(NNe f
)NNf g
,NNg h
$str	NNi 
,
NN 
$num
NN 
)
NN 
;
NN 
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# +
,OO+ ,
	SqlDbTypeOO- 6
.OO6 7
IntOO7 :
,OO: ;
ParameterDirectionOO< N
.OON O
InputOOO T
,OOT U
urlIdOOV [
)OO[ \
;OO\ ]
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
IntPP8 ;
,PP; <
ParameterDirectionPP= O
.PPO P
InputPPP U
,PPU V
siteIdPPW ]
)PP] ^
;PP^ _
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
friendlyUrlQQf q
)QQq r
;QQr s
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# -
,RR- .
	SqlDbTypeRR/ 8
.RR8 9
NVarCharRR9 A
,RRA B
$numRRC F
,RRF G
ParameterDirectionRRH Z
.RRZ [
InputRR[ `
,RR` a
realUrlRRb i
)RRi j
;RRj k
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# /
,SS/ 0
	SqlDbTypeSS1 :
.SS: ;
BitSS; >
,SS> ?
ParameterDirectionSS@ R
.SSR S
InputSSS X
,SSX Y
	isPatternSSZ c
)SSc d
;SSd e
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
pageGuidTTf n
)TTn o
;TTo p
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
(VV 
rowsAffectedVV  
>VV! "
-VV# $
$numVV$ %
)VV% &
;VV& '
}WW 	
publicYY 
staticYY 
boolYY 
DeleteFriendlyUrlYY ,
(YY, -
intYY- 0
urlIdYY1 6
)YY6 7
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i 
,
[[ 
$num
[[ 
)
[[ 
;
[[ 
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
Int\\7 :
,\\: ;
ParameterDirection\\< N
.\\N O
Input\\O T
,\\T U
urlId\\V [
)\\[ \
;\\\ ]
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
-^^# $
$num^^$ %
)^^% &
;^^& '
}__ 	
publicaa 
staticaa 
boolaa 
DeleteByPageIdaa )
(aa) *
intaa* -
pageIdaa. 4
)aa4 5
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M$
GetWriteConnectionStringccM e
(cce f
)ccf g
,ccg h
$str	cci 
,
cc 
$num
cc 
)
cc 
;
cc 
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# ,
,dd, -
	SqlDbTypedd. 7
.dd7 8
Intdd8 ;
,dd; <
ParameterDirectiondd= O
.ddO P
InputddP U
,ddU V
pageIdddW ]
)dd] ^
;dd^ _
intee 
rowsAffectedee 
=ee 
sphee "
.ee" #
ExecuteNonQueryee# 2
(ee2 3
)ee3 4
;ee4 5
returnff 
(ff 
rowsAffectedff  
>ff! "
-ff# $
$numff$ %
)ff% &
;ff& '
}gg 	
publicii 
staticii 
boolii 
DeleteByPageGuidii +
(ii+ ,
Guidii, 0
pageGuidii1 9
)ii9 :
{jj 	
SqlParameterHelperkk 
sphkk "
=kk# $
newkk% (
SqlParameterHelperkk) ;
(kk; <
ConnectionStringkk< L
.kkL M$
GetWriteConnectionStringkkM e
(kke f
)kkf g
,kkg h
$str	kki 
,
kk 
$num
kk 
)
kk 
;
kk 
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# .
,ll. /
	SqlDbTypell0 9
.ll9 :
UniqueIdentifierll: J
,llJ K
ParameterDirectionllL ^
.ll^ _
Inputll_ d
,lld e
pageGuidllf n
)lln o
;llo p
intmm 
rowsAffectedmm 
=mm 
sphmm "
.mm" #
ExecuteNonQuerymm# 2
(mm2 3
)mm3 4
;mm4 5
returnnn 
(nn 
rowsAffectednn  
>nn! "
-nn# $
$numnn$ %
)nn% &
;nn& '
}oo 	
publicqq 
staticqq 
IDataReaderqq !
GetFriendlyUrlqq" 0
(qq0 1
intqq1 4
urlIdqq5 :
)qq: ;
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M#
GetReadConnectionStringssM d
(ssd e
)sse f
,ssf g
$str	ssh 
,
ss 
$num
ss 
)
ss 
;
ss 
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# +
,tt+ ,
	SqlDbTypett- 6
.tt6 7
Inttt7 :
,tt: ;
ParameterDirectiontt< N
.ttN O
InputttO T
,ttT U
urlIdttV [
)tt[ \
;tt\ ]
returnuu 
sphuu 
.uu 
ExecuteReaderuu $
(uu$ %
)uu% &
;uu& '
}vv 	
publicxx 
staticxx 
IDataReaderxx !
GetFriendlyUrlxx" 0
(xx0 1
intxx1 4
siteIdxx5 ;
,xx; <
Stringxx= C
friendlyUrlxxD O
)xxO P
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh 
,
zz 
$num
zz 
)
zz 
;
zz 
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# ,
,{{, -
	SqlDbType{{. 7
.{{7 8
Int{{8 ;
,{{; <
ParameterDirection{{= O
.{{O P
Input{{P U
,{{U V
siteId{{W ]
){{] ^
;{{^ _
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 1
,||1 2
	SqlDbType||3 <
.||< =
NVarChar||= E
,||E F
$num||G J
,||J K
ParameterDirection||L ^
.||^ _
Input||_ d
,||d e
friendlyUrl||f q
)||q r
;||r s
return}} 
sph}} 
.}} 
ExecuteReader}} $
(}}$ %
)}}% &
;}}& '
}~~ 	
public
¿¿ 
static
¿¿ 
IDataReader
¿¿ !
GetByUrl
¿¿" *
(
¿¿* +
string
¿¿+ 1
hostName
¿¿2 :
,
¿¿: ;
string
¿¿< B
friendlyUrl
¿¿C N
)
¿¿N O
{
ÀÀ 	 
SqlParameterHelper
ÁÁ 
sph
ÁÁ "
=
ÁÁ# $
new
ÁÁ% ( 
SqlParameterHelper
ÁÁ) ;
(
ÁÁ; <
ConnectionString
ÁÁ< L
.
ÁÁL M%
GetReadConnectionString
ÁÁM d
(
ÁÁd e
)
ÁÁe f
,
ÁÁf g
$strÁÁh 
,ÁÁ 
$numÁÁ 
)ÁÁ 
;ÁÁ 
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# .
,
ÂÂ. /
	SqlDbType
ÂÂ0 9
.
ÂÂ9 :
VarChar
ÂÂ: A
,
ÂÂA B
$num
ÂÂC F
,
ÂÂF G 
ParameterDirection
ÂÂH Z
.
ÂÂZ [
Input
ÂÂ[ `
,
ÂÂ` a
hostName
ÂÂb j
)
ÂÂj k
;
ÂÂk l
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# 1
,
ÃÃ1 2
	SqlDbType
ÃÃ3 <
.
ÃÃ< =
NVarChar
ÃÃ= E
,
ÃÃE F
$num
ÃÃG J
,
ÃÃJ K 
ParameterDirection
ÃÃL ^
.
ÃÃ^ _
Input
ÃÃ_ d
,
ÃÃd e
friendlyUrl
ÃÃf q
)
ÃÃq r
;
ÃÃr s
return
ÄÄ 
sph
ÄÄ 
.
ÄÄ 
ExecuteReader
ÄÄ $
(
ÄÄ$ %
)
ÄÄ% &
;
ÄÄ& '
}
ÅÅ 	
public
ÇÇ 
static
ÇÇ 
bool
ÇÇ 
Exists
ÇÇ !
(
ÇÇ! "
int
ÈÈ 
siteId
ÈÈ 
,
ÈÈ 
string
ÉÉ 
friendlyUrl
ÉÉ 
)
ÉÉ 
{
ÊÊ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh 
,ËË 
$numËË 
)ËË 
;ËË 
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# ,
,
ÌÌ, -
	SqlDbType
ÌÌ. 7
.
ÌÌ7 8
Int
ÌÌ8 ;
,
ÌÌ; < 
ParameterDirection
ÌÌ= O
.
ÌÌO P
Input
ÌÌP U
,
ÌÌU V
siteId
ÌÌW ]
)
ÌÌ] ^
;
ÌÌ^ _
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 1
,
ÍÍ1 2
	SqlDbType
ÍÍ3 <
.
ÍÍ< =
NVarChar
ÍÍ= E
,
ÍÍE F
$num
ÍÍG J
,
ÍÍJ K 
ParameterDirection
ÍÍL ^
.
ÍÍ^ _
Input
ÍÍ_ d
,
ÍÍd e
friendlyUrl
ÍÍf q
)
ÍÍq r
;
ÍÍr s
int
ÎÎ 
count
ÎÎ 
=
ÎÎ 
Convert
ÎÎ 
.
ÎÎ  
ToInt32
ÎÎ  '
(
ÎÎ' (
sph
ÎÎ( +
.
ÎÎ+ ,
ExecuteScalar
ÎÎ, 9
(
ÎÎ9 :
)
ÎÎ: ;
)
ÎÎ; <
;
ÎÎ< =
return
ÏÏ 
(
ÏÏ 
count
ÏÏ 
>
ÏÏ 
$num
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÐÐ 	
public
ÕÕ 
static
ÕÕ 
int
ÕÕ 
GetCount
ÕÕ "
(
ÕÕ" #
int
ÕÕ# &
siteId
ÕÕ' -
)
ÕÕ- .
{
ÖÖ 	 
SqlParameterHelper
×× 
sph
×× "
=
××# $
new
××% ( 
SqlParameterHelper
××) ;
(
××; <
ConnectionString
××< L
.
××L M%
GetReadConnectionString
××M d
(
××d e
)
××e f
,
××f g
$str××h 
,×× 
$num×× 
)×× 
;×× 
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# ,
,
ØØ, -
	SqlDbType
ØØ. 7
.
ØØ7 8
Int
ØØ8 ;
,
ØØ; < 
ParameterDirection
ØØ= O
.
ØØO P
Input
ØØP U
,
ØØU V
siteId
ØØW ]
)
ØØ] ^
;
ØØ^ _
return
ÙÙ 
Convert
ÙÙ 
.
ÙÙ 
ToInt32
ÙÙ "
(
ÙÙ" #
sph
ÙÙ# &
.
ÙÙ& '
ExecuteScalar
ÙÙ' 4
(
ÙÙ4 5
)
ÙÙ5 6
)
ÙÙ6 7
;
ÙÙ7 8
}
ÜÜ 	
public
áá 
static
áá 
int
áá 
GetCount
áá "
(
áá" #
int
áá# &
siteId
áá' -
,
áá- .
string
áá/ 5

searchTerm
áá6 @
)
áá@ A
{
ââ 	 
SqlParameterHelper
ãã 
sph
ãã "
=
ãã# $
new
ãã% ( 
SqlParameterHelper
ãã) ;
(
ãã; <
ConnectionString
ãã< L
.
ããL M%
GetReadConnectionString
ããM d
(
ããd e
)
ããe f
,
ããf g
$strããh 
,ãã 
$numãã 
)ãã 
;ãã 
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# ,
,
ää, -
	SqlDbType
ää. 7
.
ää7 8
Int
ää8 ;
,
ää; < 
ParameterDirection
ää= O
.
ääO P
Input
ääP U
,
ääU V
siteId
ääW ]
)
ää] ^
;
ää^ _
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# 0
,
åå0 1
	SqlDbType
åå2 ;
.
åå; <
NVarChar
åå< D
,
ååD E
$num
ååF I
,
ååI J 
ParameterDirection
ååK ]
.
åå] ^
Input
åå^ c
,
ååc d

searchTerm
ååe o
)
ååo p
;
ååp q
return
ææ 
Convert
ææ 
.
ææ 
ToInt32
ææ "
(
ææ" #
sph
ææ# &
.
ææ& '
ExecuteScalar
ææ' 4
(
ææ4 5
)
ææ5 6
)
ææ6 7
;
ææ7 8
}
éé 	
public
òò 
static
òò 
IDataReader
òò !
GetPage
òò" )
(
òò) *
int
óó 
siteId
óó 
,
óó 
int
ôô 

pageNumber
ôô 
,
ôô 
int
õõ 
pageSize
õõ 
,
õõ 
out
öö 
int
öö 

totalPages
öö 
)
öö 
{
÷÷ 	

totalPages
øø 
=
øø 
$num
øø 
;
øø 
int
ùù 
	totalRows
ùù 
=
úú 
GetCount
úú 
(
úú 
siteId
úú !
)
úú! "
;
úú" #
if
üü 
(
üü 
pageSize
üü 
>
üü 
$num
üü 
)
üü 

totalPages
üü (
=
üü) *
	totalRows
üü+ 4
/
üü5 6
pageSize
üü7 ?
;
üü? @
if
þþ 
(
þþ 
	totalRows
þþ 
<=
þþ 
pageSize
þþ %
)
þþ% &
{
ÿÿ 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
int
 
siteId
 
,
 
string
 

searchTerm
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
   
int
   

totalPages
   
)
   
{
¡¡ 	

totalPages
¢¢ 
=
¢¢ 
$num
¢¢ 
;
¢¢ 
int
££ 
	totalRows
££ 
=
££ 
GetCount
££ $
(
££$ %
siteId
££% +
,
££+ ,

searchTerm
££- 7
)
££7 8
;
££8 9
if
¥¥ 
(
¥¥ 
pageSize
¥¥ 
>
¥¥ 
$num
¥¥ 
)
¥¥ 

totalPages
¥¥ (
=
¥¥) *
	totalRows
¥¥+ 4
/
¥¥5 6
pageSize
¥¥7 ?
;
¥¥? @
if
§§ 
(
§§ 
	totalRows
§§ 
<=
§§ 
pageSize
§§ %
)
§§% &
{
¨¨ 

totalPages
©© 
=
©© 
$num
©© 
;
©© 
}
ªª 
else
«« 
{
¬¬ 
int
­­ 
	remainder
­­ 
;
­­ 
Math
®® 
.
®® 
DivRem
®® 
(
®® 
	totalRows
®® %
,
®®% &
pageSize
®®' /
,
®®/ 0
out
®®1 4
	remainder
®®5 >
)
®®> ?
;
®®? @
if
¯¯ 
(
¯¯ 
	remainder
¯¯ 
>
¯¯ 
$num
¯¯  !
)
¯¯! "
{
°° 

totalPages
±± 
+=
±± !
$num
±±" #
;
±±# $
}
²² 
}
³³  
SqlParameterHelper
µµ 
sph
µµ "
=
µµ# $
new
µµ% ( 
SqlParameterHelper
µµ) ;
(
µµ; <
ConnectionString
µµ< L
.
µµL M%
GetReadConnectionString
µµM d
(
µµd e
)
µµe f
,
µµf g
$strµµh 
,µµ 
$numµµ 
)µµ 
;µµ 
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# ,
,
¶¶, -
	SqlDbType
¶¶. 7
.
¶¶7 8
Int
¶¶8 ;
,
¶¶; < 
ParameterDirection
¶¶= O
.
¶¶O P
Input
¶¶P U
,
¶¶U V
siteId
¶¶W ]
)
¶¶] ^
;
¶¶^ _
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 0
,
··0 1
	SqlDbType
··2 ;
.
··; <
NVarChar
··< D
,
··D E
$num
··F I
,
··I J 
ParameterDirection
··K ]
.
··] ^
Input
··^ c
,
··c d

searchTerm
··e o
)
··o p
;
··p q
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 0
,
¸¸0 1
	SqlDbType
¸¸2 ;
.
¸¸; <
Int
¸¸< ?
,
¸¸? @ 
ParameterDirection
¸¸A S
.
¸¸S T
Input
¸¸T Y
,
¸¸Y Z

pageNumber
¸¸[ e
)
¸¸e f
;
¸¸f g
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# .
,
¹¹. /
	SqlDbType
¹¹0 9
.
¹¹9 :
Int
¹¹: =
,
¹¹= > 
ParameterDirection
¹¹? Q
.
¹¹Q R
Input
¹¹R W
,
¹¹W X
pageSize
¹¹Y a
)
¹¹a b
;
¹¹b c
return
ºº 
sph
ºº 
.
ºº 
ExecuteReader
ºº $
(
ºº$ %
)
ºº% &
;
ºº& '
}
¼¼ 	
}
¿¿ 
}ÀÀ `
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGeoCountry.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBGeoCountry $
{ 
public77 
static77 
int77 
Create77  
(77  !
Guid88 
guid88 
,88 
string99 
name99 
,99 
string:: 
iSOCode2:: 
,:: 
string;; 
iSOCode3;; 
);; 
{<< 	
SqlParameterHelper== 
sph== "
===# $
new==% (
SqlParameterHelper==) ;
(==; <
ConnectionString==< L
.==L M$
GetWriteConnectionString==M e
(==e f
)==f g
,==g h
$str==i 
,	== 
$num
== 
)
== 
;
== 
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># *
,>>* +
	SqlDbType>>, 5
.>>5 6
UniqueIdentifier>>6 F
,>>F G
ParameterDirection>>H Z
.>>Z [
Input>>[ `
,>>` a
guid>>b f
)>>f g
;>>g h
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ C
,??C D
ParameterDirection??E W
.??W X
Input??X ]
,??] ^
name??_ c
)??c d
;??d e
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# .
,@@. /
	SqlDbType@@0 9
.@@9 :
NChar@@: ?
,@@? @
$num@@A B
,@@B C
ParameterDirection@@D V
.@@V W
Input@@W \
,@@\ ]
iSOCode2@@^ f
)@@f g
;@@g h
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
NCharAA: ?
,AA? @
$numAAA B
,AAB C
ParameterDirectionAAD V
.AAV W
InputAAW \
,AA\ ]
iSOCode3AA^ f
)AAf g
;AAg h
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
rowsAffectedCC 
;CC  
}EE 	
publicPP 
staticPP 
boolPP 
UpdatePP !
(PP! "
GuidQQ 
guidQQ 
,QQ 
stringRR 
nameRR 
,RR 
stringSS 
iSOCode2SS 
,SS 
stringTT 
iSOCode3TT 
)TT 
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$strVVi 
,	VV 
$num
VV 
)
VV 
;
VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# *
,WW* +
	SqlDbTypeWW, 5
.WW5 6
UniqueIdentifierWW6 F
,WWF G
ParameterDirectionWWH Z
.WWZ [
InputWW[ `
,WW` a
guidWWb f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# *
,XX* +
	SqlDbTypeXX, 5
.XX5 6
NVarCharXX6 >
,XX> ?
$numXX@ C
,XXC D
ParameterDirectionXXE W
.XXW X
InputXXX ]
,XX] ^
nameXX_ c
)XXc d
;XXd e
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# .
,YY. /
	SqlDbTypeYY0 9
.YY9 :
NCharYY: ?
,YY? @
$numYYA B
,YYB C
ParameterDirectionYYD V
.YYV W
InputYYW \
,YY\ ]
iSOCode2YY^ f
)YYf g
;YYg h
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# .
,ZZ. /
	SqlDbTypeZZ0 9
.ZZ9 :
NCharZZ: ?
,ZZ? @
$numZZA B
,ZZB C
ParameterDirectionZZD V
.ZZV W
InputZZW \
,ZZ\ ]
iSOCode3ZZ^ f
)ZZf g
;ZZg h
int[[ 
rowsAffected[[ 
=[[ 
sph[[ "
.[[" #
ExecuteNonQuery[[# 2
([[2 3
)[[3 4
;[[4 5
return\\ 
(\\ 
rowsAffected\\  
>\\! "
$num\\# $
)\\$ %
;\\% &
}^^ 	
publicee 
staticee 
boolee 
Deleteee !
(ee! "
Guidee" &
guidee' +
)ee+ ,
{ff 	
SqlParameterHelpergg 
sphgg "
=gg# $
newgg% (
SqlParameterHelpergg) ;
(gg; <
ConnectionStringgg< L
.ggL M$
GetWriteConnectionStringggM e
(gge f
)ggf g
,ggg h
$strggi 
,	gg 
$num
gg 
)
gg 
;
gg 
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# *
,hh* +
	SqlDbTypehh, 5
.hh5 6
UniqueIdentifierhh6 F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
guidhhb f
)hhf g
;hhg h
intii 
rowsAffectedii 
=ii 
sphii "
.ii" #
ExecuteNonQueryii# 2
(ii2 3
)ii3 4
;ii4 5
returnjj 
(jj 
rowsAffectedjj  
>jj! "
$numjj# $
)jj$ %
;jj% &
}ll 	
publicrr 
staticrr 
IDataReaderrr !
GetOnerr" (
(rr( )
Guidrr) -
guidrr. 2
)rr2 3
{ss 	
SqlParameterHelpertt 
sphtt "
=tt# $
newtt% (
SqlParameterHelpertt) ;
(tt; <
ConnectionStringtt< L
.ttL M#
GetReadConnectionStringttM d
(ttd e
)tte f
,ttf g
$str	tth 
,
tt 
$num
tt 
)
tt 
;
tt 
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# *
,uu* +
	SqlDbTypeuu, 5
.uu5 6
UniqueIdentifieruu6 F
,uuF G
ParameterDirectionuuH Z
.uuZ [
Inputuu[ `
,uu` a
guiduub f
)uuf g
;uug h
returnvv 
sphvv 
.vv 
ExecuteReadervv $
(vv$ %
)vv% &
;vv& '
}xx 	
public~~ 
static~~ 
IDataReader~~ !
GetByISOCode2~~" /
(~~/ 0
string~~0 6
countryISOCode2~~7 F
)~~F G
{ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NChar
: ?
,
? @
$num
A B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
countryISOCode2
^ m
)
m n
;
n o
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
)
# $
{
 	
return
 
Convert
 
.
 
ToInt32
 "
(
" #
	SqlHelper
# ,
.
, -
ExecuteScalar
- :
(
: ;
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 (
,
( )
null
 
)
 
)
 
;
 
}
 	
public
 
static
 
IDataReader
 !
GetAll
" (
(
( )
)
) *
{
 	
return
 
	SqlHelper
 
.
 
ExecuteReader
 *
(
* +
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 )
,
) *
null
 
)
 
;
 
}
   	
public
¨¨ 
static
¨¨ 
IDataReader
¨¨ !
GetPage
¨¨" )
(
¨¨) *
int
©© 

pageNumber
©© 
,
©© 
int
ªª 
pageSize
ªª 
,
ªª 
out
«« 
int
«« 

totalPages
«« 
)
«« 
{
¬¬ 	

totalPages
­­ 
=
­­ 
$num
­­ 
;
­­ 
int
®® 
	totalRows
®® 
=
¯¯ 
GetCount
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
if
±± 
(
±± 
pageSize
±± 
>
±± 
$num
±± 
)
±± 

totalPages
±± (
=
±±) *
	totalRows
±±+ 4
/
±±5 6
pageSize
±±7 ?
;
±±? @
if
³³ 
(
³³ 
	totalRows
³³ 
<=
³³ 
pageSize
³³ %
)
³³% &
{
´´ 

totalPages
µµ 
=
µµ 
$num
µµ 
;
µµ 
}
¶¶ 
else
·· 
{
¸¸ 
int
¹¹ 
	remainder
¹¹ 
;
¹¹ 
Math
ºº 
.
ºº 
DivRem
ºº 
(
ºº 
	totalRows
ºº %
,
ºº% &
pageSize
ºº' /
,
ºº/ 0
out
ºº1 4
	remainder
ºº5 >
)
ºº> ?
;
ºº? @
if
»» 
(
»» 
	remainder
»» 
>
»» 
$num
»»  !
)
»»! "
{
¼¼ 

totalPages
½½ 
+=
½½ !
$num
½½" #
;
½½# $
}
¾¾ 
}
¿¿  
SqlParameterHelper
ÁÁ 
sph
ÁÁ "
=
ÁÁ# $
new
ÁÁ% ( 
SqlParameterHelper
ÁÁ) ;
(
ÁÁ; <
ConnectionString
ÁÁ< L
.
ÁÁL M%
GetReadConnectionString
ÁÁM d
(
ÁÁd e
)
ÁÁe f
,
ÁÁf g
$strÁÁh 
,ÁÁ 
$numÁÁ 
)ÁÁ 
;ÁÁ 
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# 0
,
ÂÂ0 1
	SqlDbType
ÂÂ2 ;
.
ÂÂ; <
Int
ÂÂ< ?
,
ÂÂ? @ 
ParameterDirection
ÂÂA S
.
ÂÂS T
Input
ÂÂT Y
,
ÂÂY Z

pageNumber
ÂÂ[ e
)
ÂÂe f
;
ÂÂf g
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# .
,
ÃÃ. /
	SqlDbType
ÃÃ0 9
.
ÃÃ9 :
Int
ÃÃ: =
,
ÃÃ= > 
ParameterDirection
ÃÃ? Q
.
ÃÃQ R
Input
ÃÃR W
,
ÃÃW X
pageSize
ÃÃY a
)
ÃÃa b
;
ÃÃb c
return
ÄÄ 
sph
ÄÄ 
.
ÄÄ 
ExecuteReader
ÄÄ $
(
ÄÄ$ %
)
ÄÄ% &
;
ÄÄ& '
}
ÆÆ 	
}
ÈÈ 
}ÊÊ Þm
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGeoZone.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
	DBGeoZone !
{ 
public66 
static66 
int66 
Create66  
(66  !
Guid77 
guid77 
,77 
Guid88 
countryGuid88 
,88 
string99 
name99 
,99 
string:: 
code:: 
):: 
{;; 	
SqlParameterHelper<< 
sph<< "
=<<# $
new<<% (
SqlParameterHelper<<) ;
(<<; <
ConnectionString<<< L
.<<L M$
GetWriteConnectionString<<M e
(<<e f
)<<f g
,<<g h
$str<<i |
,<<| }
$num<<~ 
)	<< 
;
<< 
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# *
,==* +
	SqlDbType==, 5
.==5 6
UniqueIdentifier==6 F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
guid==b f
)==f g
;==g h
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
UniqueIdentifier>>= M
,>>M N
ParameterDirection>>O a
.>>a b
Input>>b g
,>>g h
countryGuid>>i t
)>>t u
;>>u v
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ C
,??C D
ParameterDirection??E W
.??W X
Input??X ]
,??] ^
name??_ c
)??c d
;??d e
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# *
,@@* +
	SqlDbType@@, 5
.@@5 6
NVarChar@@6 >
,@@> ?
$num@@@ C
,@@C D
ParameterDirection@@E W
.@@W X
Input@@X ]
,@@] ^
code@@_ c
)@@c d
;@@d e
intAA 
rowsAffectedAA 
=AA 
sphAA "
.AA" #
ExecuteNonQueryAA# 2
(AA2 3
)AA3 4
;AA4 5
returnBB 
rowsAffectedBB 
;BB  
}DD 	
publicOO 
staticOO 
boolOO 
UpdateOO !
(OO! "
GuidPP 
guidPP 
,PP 
GuidQQ 
countryGuidQQ 
,QQ 
stringRR 
nameRR 
,RR 
stringSS 
codeSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$strUUi |
,UU| }
$numUU~ 
)	UU 
;
UU 
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 1
,WW1 2
	SqlDbTypeWW3 <
.WW< =
UniqueIdentifierWW= M
,WWM N
ParameterDirectionWWO a
.WWa b
InputWWb g
,WWg h
countryGuidWWi t
)WWt u
;WWu v
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# *
,XX* +
	SqlDbTypeXX, 5
.XX5 6
NVarCharXX6 >
,XX> ?
$numXX@ C
,XXC D
ParameterDirectionXXE W
.XXW X
InputXXX ]
,XX] ^
nameXX_ c
)XXc d
;XXd e
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# *
,YY* +
	SqlDbTypeYY, 5
.YY5 6
NVarCharYY6 >
,YY> ?
$numYY@ C
,YYC D
ParameterDirectionYYE W
.YYW X
InputYYX ]
,YY] ^
codeYY_ c
)YYc d
;YYd e
intZZ 
rowsAffectedZZ 
=ZZ 
sphZZ "
.ZZ" #
ExecuteNonQueryZZ# 2
(ZZ2 3
)ZZ3 4
;ZZ4 5
return[[ 
([[ 
rowsAffected[[  
>[[! "
$num[[# $
)[[$ %
;[[% &
}]] 	
publicdd 
staticdd 
booldd 
Deletedd !
(dd! "
Guiddd" &
guiddd' +
)dd+ ,
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M$
GetWriteConnectionStringffM e
(ffe f
)fff g
,ffg h
$strffi |
,ff| }
$numff~ 
)	ff 
;
ff 
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# *
,gg* +
	SqlDbTypegg, 5
.gg5 6
UniqueIdentifiergg6 F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
guidggb f
)ggf g
;ggg h
inthh 
rowsAffectedhh 
=hh 
sphhh "
.hh" #
ExecuteNonQueryhh# 2
(hh2 3
)hh3 4
;hh4 5
returnii 
(ii 
rowsAffectedii  
>ii! "
$numii# $
)ii$ %
;ii% &
}kk 	
publicqq 
staticqq 
IDataReaderqq !
GetOneqq" (
(qq( )
Guidqq) -
guidqq. 2
)qq2 3
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M#
GetReadConnectionStringssM d
(ssd e
)sse f
,ssf g
$strssh ~
,ss~ 
$num
ss 
)
ss 
;
ss 
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# *
,tt* +
	SqlDbTypett, 5
.tt5 6
UniqueIdentifiertt6 F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
guidttb f
)ttf g
;ttg h
returnuu 
sphuu 
.uu 
ExecuteReaderuu $
(uu$ %
)uu% &
;uu& '
}ww 	
public}} 
static}} 
IDataReader}} !
	GetByCode}}" +
(}}+ ,
Guid}}, 0
countryGuid}}1 <
,}}< =
string}}> D
code}}E I
)}}I J
{~~ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h 
,
 
$num
 
)
 
;
 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
countryGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
NVarChar
6 >
,
> ?
$num
@ C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
code
_ c
)
c d
;
d e
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
countryGuid
( 3
)
3 4
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
countryGuid
i t
)
t u
;
u v
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !
GetByCountry
" .
(
. /
Guid
/ 3
countryGuid
4 ?
)
? @
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
countryGuid
i t
)
t u
;
u v
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
¥¥ 
static
¥¥ 
IDataReader
¥¥ !
GetPage
¥¥" )
(
¥¥) *
Guid
¦¦ 
countryGuid
¦¦ 
,
¦¦ 
int
§§ 

pageNumber
§§ 
,
§§ 
int
¨¨ 
pageSize
¨¨ 
,
¨¨ 
out
©© 
int
©© 

totalPages
©© 
)
©© 
{
ªª 	

totalPages
«« 
=
«« 
$num
«« 
;
«« 
int
¬¬ 
	totalRows
¬¬ 
=
­­ 
GetCount
­­ 
(
­­ 
countryGuid
­­ &
)
­­& '
;
­­' (
if
¯¯ 
(
¯¯ 
pageSize
¯¯ 
>
¯¯ 
$num
¯¯ 
)
¯¯ 

totalPages
¯¯ (
=
¯¯) *
	totalRows
¯¯+ 4
/
¯¯5 6
pageSize
¯¯7 ?
;
¯¯? @
if
±± 
(
±± 
	totalRows
±± 
<=
±± 
pageSize
±± %
)
±±% &
{
²² 

totalPages
³³ 
=
³³ 
$num
³³ 
;
³³ 
}
´´ 
else
µµ 
{
¶¶ 
int
·· 
	remainder
·· 
;
·· 
Math
¸¸ 
.
¸¸ 
DivRem
¸¸ 
(
¸¸ 
	totalRows
¸¸ %
,
¸¸% &
pageSize
¸¸' /
,
¸¸/ 0
out
¸¸1 4
	remainder
¸¸5 >
)
¸¸> ?
;
¸¸? @
if
¹¹ 
(
¹¹ 
	remainder
¹¹ 
>
¹¹ 
$num
¹¹  !
)
¹¹! "
{
ºº 

totalPages
»» 
+=
»» !
$num
»»" #
;
»»# $
}
¼¼ 
}
½½  
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M%
GetReadConnectionString
¿¿M d
(
¿¿d e
)
¿¿e f
,
¿¿f g
$str¿¿h 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 1
,
ÀÀ1 2
	SqlDbType
ÀÀ3 <
.
ÀÀ< =
UniqueIdentifier
ÀÀ= M
,
ÀÀM N 
ParameterDirection
ÀÀO a
.
ÀÀa b
Input
ÀÀb g
,
ÀÀg h
countryGuid
ÀÀi t
)
ÀÀt u
;
ÀÀu v
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 0
,
ÁÁ0 1
	SqlDbType
ÁÁ2 ;
.
ÁÁ; <
Int
ÁÁ< ?
,
ÁÁ? @ 
ParameterDirection
ÁÁA S
.
ÁÁS T
Input
ÁÁT Y
,
ÁÁY Z

pageNumber
ÁÁ[ e
)
ÁÁe f
;
ÁÁf g
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# .
,
ÂÂ. /
	SqlDbType
ÂÂ0 9
.
ÂÂ9 :
Int
ÂÂ: =
,
ÂÂ= > 
ParameterDirection
ÂÂ? Q
.
ÂÂQ R
Input
ÂÂR W
,
ÂÂW X
pageSize
ÂÂY a
)
ÂÂa b
;
ÂÂb c
return
ÃÃ 
sph
ÃÃ 
.
ÃÃ 
ExecuteReader
ÃÃ $
(
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ÅÅ 	
}
ÇÇ 
}ÉÉ ÖÛ
sD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBGoogleCheckoutLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBGoogleCheckoutLog +
{ 
publicII 
staticII 
intII 
CreateII  
(II  !
GuidJJ 
rowGuidJJ 
,JJ 
DateTimeKK 

createdUtcKK 
,KK  
GuidLL 
siteGuidLL 
,LL 
GuidMM 
userGuidMM 
,MM 
GuidNN 
	storeGuidNN 
,NN 
GuidOO 
cartGuidOO 
,OO 
stringPP 
notificationTypePP #
,PP# $
stringQQ 
rawResponseQQ 
,QQ 
stringRR 
serialNumberRR 
,RR  
DateTimeSS 

gTimestampSS 
,SS  
stringTT 
orderNumberTT 
,TT 
stringUU 
buyerIdUU 
,UU 
stringVV 
fullfillStateVV  
,VV  !
stringWW 
financeStateWW 
,WW  
boolXX 
emailListOptInXX 
,XX  
stringYY 
avsResponseYY 
,YY 
stringZZ 
cvnResponseZZ 
,ZZ 
DateTime[[ 
authExpDate[[  
,[[  !
decimal\\ 
authAmt\\ 
,\\ 
decimal]] 
discountTotal]] !
,]]! "
decimal^^ 
shippingTotal^^ !
,^^! "
decimal__ 
taxTotal__ 
,__ 
decimal`` 

orderTotal`` 
,`` 
decimalaa 
latestChgAmtaa  
,aa  !
decimalbb 
totalChgAmtbb 
,bb  
decimalcc 
latestRefundAmtcc #
,cc# $
decimaldd 
totalRefundAmtdd "
,dd" #
decimalee 
latestChargebackee $
,ee$ %
decimalff 
totalChargebackff #
,ff# $
stringgg 
cartXmlgg 
,gg 
stringhh 
providerNamehh 
)hh  
{ii 	
SqlParameterHelperjj 
sphjj "
=jj# $
newjj% (
SqlParameterHelperjj) ;
(jj; <
ConnectionStringjj< L
.jjL M$
GetWriteConnectionStringjjM e
(jje f
)jjf g
,jjg h
$str	jji 
,
jj 
$num
jj 
)
jj 
;
jj 
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# -
,kk- .
	SqlDbTypekk/ 8
.kk8 9
UniqueIdentifierkk9 I
,kkI J
ParameterDirectionkkK ]
.kk] ^
Inputkk^ c
,kkc d
rowGuidkke l
)kkl m
;kkm n
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
DateTimell< D
,llD E
ParameterDirectionllF X
.llX Y
InputllY ^
,ll^ _

createdUtcll` j
)llj k
;llk l
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# .
,mm. /
	SqlDbTypemm0 9
.mm9 :
UniqueIdentifiermm: J
,mmJ K
ParameterDirectionmmL ^
.mm^ _
Inputmm_ d
,mmd e
siteGuidmmf n
)mmn o
;mmo p
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# .
,nn. /
	SqlDbTypenn0 9
.nn9 :
UniqueIdentifiernn: J
,nnJ K
ParameterDirectionnnL ^
.nn^ _
Inputnn_ d
,nnd e
userGuidnnf n
)nnn o
;nno p
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# /
,oo/ 0
	SqlDbTypeoo1 :
.oo: ;
UniqueIdentifieroo; K
,ooK L
ParameterDirectionooM _
.oo_ `
Inputoo` e
,ooe f
	storeGuidoog p
)oop q
;ooq r
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# .
,pp. /
	SqlDbTypepp0 9
.pp9 :
UniqueIdentifierpp: J
,ppJ K
ParameterDirectionppL ^
.pp^ _
Inputpp_ d
,ppd e
cartGuidppf n
)ppn o
;ppo p
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 6
,qq6 7
	SqlDbTypeqq8 A
.qqA B
NVarCharqqB J
,qqJ K
$numqqL O
,qqO P
ParameterDirectionqqQ c
.qqc d
Inputqqd i
,qqi j
notificationTypeqqk {
)qq{ |
;qq| }
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 1
,rr1 2
	SqlDbTyperr3 <
.rr< =
NVarCharrr= E
,rrE F
-rrG H
$numrrH I
,rrI J
ParameterDirectionrrK ]
.rr] ^
Inputrr^ c
,rrc d
rawResponserre p
)rrp q
;rrq r
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 2
,ss2 3
	SqlDbTypess4 =
.ss= >
NVarCharss> F
,ssF G
$numssH J
,ssJ K
ParameterDirectionssL ^
.ss^ _
Inputss_ d
,ssd e
serialNumberssf r
)ssr s
;sss t
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 0
,tt0 1
	SqlDbTypett2 ;
.tt; <
DateTimett< D
,ttD E
ParameterDirectionttF X
.ttX Y
InputttY ^
,tt^ _

gTimestamptt` j
)ttj k
;ttk l
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# 1
,uu1 2
	SqlDbTypeuu3 <
.uu< =
NVarCharuu= E
,uuE F
$numuuG I
,uuI J
ParameterDirectionuuK ]
.uu] ^
Inputuu^ c
,uuc d
orderNumberuue p
)uup q
;uuq r
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# -
,vv- .
	SqlDbTypevv/ 8
.vv8 9
NVarCharvv9 A
,vvA B
$numvvC E
,vvE F
ParameterDirectionvvG Y
.vvY Z
InputvvZ _
,vv_ `
buyerIdvva h
)vvh i
;vvi j
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 3
,ww3 4
	SqlDbTypeww5 >
.ww> ?
NVarCharww? G
,wwG H
$numwwI K
,wwK L
ParameterDirectionwwM _
.ww_ `
Inputww` e
,wwe f
fullfillStatewwg t
)wwt u
;wwu v
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 2
,xx2 3
	SqlDbTypexx4 =
.xx= >
NVarCharxx> F
,xxF G
$numxxH J
,xxJ K
ParameterDirectionxxL ^
.xx^ _
Inputxx_ d
,xxd e
financeStatexxf r
)xxr s
;xxs t
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 4
,yy4 5
	SqlDbTypeyy6 ?
.yy? @
Bityy@ C
,yyC D
ParameterDirectionyyE W
.yyW X
InputyyX ]
,yy] ^
emailListOptInyy_ m
)yym n
;yyn o
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 1
,zz1 2
	SqlDbTypezz3 <
.zz< =
NVarCharzz= E
,zzE F
$numzzG H
,zzH I
ParameterDirectionzzJ \
.zz\ ]
Inputzz] b
,zzb c
avsResponsezzd o
)zzo p
;zzp q
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 1
,{{1 2
	SqlDbType{{3 <
.{{< =
NVarChar{{= E
,{{E F
$num{{G H
,{{H I
ParameterDirection{{J \
.{{\ ]
Input{{] b
,{{b c
cvnResponse{{d o
){{o p
;{{p q
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 1
,||1 2
	SqlDbType||3 <
.||< =
DateTime||= E
,||E F
ParameterDirection||G Y
.||Y Z
Input||Z _
,||_ `
authExpDate||a l
)||l m
;||m n
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# -
,}}- .
	SqlDbType}}/ 8
.}}8 9
Decimal}}9 @
,}}@ A
ParameterDirection}}B T
.}}T U
Input}}U Z
,}}Z [
authAmt}}\ c
)}}c d
;}}d e
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 3
,~~3 4
	SqlDbType~~5 >
.~~> ?
Decimal~~? F
,~~F G
ParameterDirection~~H Z
.~~Z [
Input~~[ `
,~~` a
discountTotal~~b o
)~~o p
;~~p q
sph 
. 
DefineSqlParameter "
(" #
$str# 3
,3 4
	SqlDbType5 >
.> ?
Decimal? F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
shippingTotalb o
)o p
;p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Decimal
: A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
taxTotal
] e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Decimal
< C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^

orderTotal
_ i
)
i j
;
j k
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
Decimal
> E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
latestChgAmt
a m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Decimal
= D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
totalChgAmt
` k
)
k l
;
l m
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Decimal
A H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
latestRefundAmt
d s
)
s t
;
t u
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
Decimal
@ G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
totalRefundAmt
c q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
Decimal
B I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
latestChargeback
e u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Decimal
A H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
totalChargeback
d s
)
s t
;
t u
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
-
C D
$num
D E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
cartXml
a h
)
h i
;
i j
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
providerName
g s
)
s t
;
t u
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
rowsAffected
 
;
  
}
 	
public
²² 
static
²² 
bool
²² 
Update
²² !
(
²²! "
Guid
³³ 
rowGuid
³³ 
,
³³ 
DateTime
´´ 

createdUtc
´´ 
,
´´  
Guid
µµ 
siteGuid
µµ 
,
µµ 
Guid
¶¶ 
userGuid
¶¶ 
,
¶¶ 
Guid
·· 
	storeGuid
·· 
,
·· 
Guid
¸¸ 
cartGuid
¸¸ 
,
¸¸ 
string
¹¹ 
notificationType
¹¹ #
,
¹¹# $
string
ºº 
rawResponse
ºº 
,
ºº 
string
»» 
serialNumber
»» 
,
»»  
DateTime
¼¼ 

gTimestamp
¼¼ 
,
¼¼  
string
½½ 
orderNumber
½½ 
,
½½ 
string
¾¾ 
buyerId
¾¾ 
,
¾¾ 
string
¿¿ 
fullfillState
¿¿  
,
¿¿  !
string
ÀÀ 
financeState
ÀÀ 
,
ÀÀ  
bool
ÁÁ 
emailListOptIn
ÁÁ 
,
ÁÁ  
string
ÂÂ 
avsResponse
ÂÂ 
,
ÂÂ 
string
ÃÃ 
cvnResponse
ÃÃ 
,
ÃÃ 
DateTime
ÄÄ 
authExpDate
ÄÄ  
,
ÄÄ  !
decimal
ÅÅ 
authAmt
ÅÅ 
,
ÅÅ 
decimal
ÆÆ 
discountTotal
ÆÆ !
,
ÆÆ! "
decimal
ÇÇ 
shippingTotal
ÇÇ !
,
ÇÇ! "
decimal
ÈÈ 
taxTotal
ÈÈ 
,
ÈÈ 
decimal
ÉÉ 

orderTotal
ÉÉ 
,
ÉÉ 
decimal
ÊÊ 
latestChgAmt
ÊÊ  
,
ÊÊ  !
decimal
ËË 
totalChgAmt
ËË 
,
ËË  
decimal
ÌÌ 
latestRefundAmt
ÌÌ #
,
ÌÌ# $
decimal
ÍÍ 
totalRefundAmt
ÍÍ "
,
ÍÍ" #
decimal
ÎÎ 
latestChargeback
ÎÎ $
,
ÎÎ$ %
decimal
ÏÏ 
totalChargeback
ÏÏ #
,
ÏÏ# $
string
ÐÐ 
cartXml
ÐÐ 
)
ÐÐ 
{
ÑÑ 	 
SqlParameterHelper
ÒÒ 
sph
ÒÒ "
=
ÒÒ# $
new
ÒÒ% ( 
SqlParameterHelper
ÒÒ) ;
(
ÒÒ; <
ConnectionString
ÒÒ< L
.
ÒÒL M&
GetWriteConnectionString
ÒÒM e
(
ÒÒe f
)
ÒÒf g
,
ÒÒg h
$strÒÒi 
,ÒÒ 
$numÒÒ 
)ÒÒ 
;ÒÒ 
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# -
,
ÓÓ- .
	SqlDbType
ÓÓ/ 8
.
ÓÓ8 9
UniqueIdentifier
ÓÓ9 I
,
ÓÓI J 
ParameterDirection
ÓÓK ]
.
ÓÓ] ^
Input
ÓÓ^ c
,
ÓÓc d
rowGuid
ÓÓe l
)
ÓÓl m
;
ÓÓm n
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# 0
,
ÔÔ0 1
	SqlDbType
ÔÔ2 ;
.
ÔÔ; <
DateTime
ÔÔ< D
,
ÔÔD E 
ParameterDirection
ÔÔF X
.
ÔÔX Y
Input
ÔÔY ^
,
ÔÔ^ _

createdUtc
ÔÔ` j
)
ÔÔj k
;
ÔÔk l
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# .
,
ÕÕ. /
	SqlDbType
ÕÕ0 9
.
ÕÕ9 :
UniqueIdentifier
ÕÕ: J
,
ÕÕJ K 
ParameterDirection
ÕÕL ^
.
ÕÕ^ _
Input
ÕÕ_ d
,
ÕÕd e
siteGuid
ÕÕf n
)
ÕÕn o
;
ÕÕo p
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# .
,
ÖÖ. /
	SqlDbType
ÖÖ0 9
.
ÖÖ9 :
UniqueIdentifier
ÖÖ: J
,
ÖÖJ K 
ParameterDirection
ÖÖL ^
.
ÖÖ^ _
Input
ÖÖ_ d
,
ÖÖd e
userGuid
ÖÖf n
)
ÖÖn o
;
ÖÖo p
sph
×× 
.
××  
DefineSqlParameter
×× "
(
××" #
$str
××# /
,
××/ 0
	SqlDbType
××1 :
.
××: ;
UniqueIdentifier
××; K
,
××K L 
ParameterDirection
××M _
.
××_ `
Input
××` e
,
××e f
	storeGuid
××g p
)
××p q
;
××q r
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
UniqueIdentifier
ØØ: J
,
ØØJ K 
ParameterDirection
ØØL ^
.
ØØ^ _
Input
ØØ_ d
,
ØØd e
cartGuid
ØØf n
)
ØØn o
;
ØØo p
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# 6
,
ÙÙ6 7
	SqlDbType
ÙÙ8 A
.
ÙÙA B
NVarChar
ÙÙB J
,
ÙÙJ K
$num
ÙÙL O
,
ÙÙO P 
ParameterDirection
ÙÙQ c
.
ÙÙc d
Input
ÙÙd i
,
ÙÙi j
notificationType
ÙÙk {
)
ÙÙ{ |
;
ÙÙ| }
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 1
,
ÚÚ1 2
	SqlDbType
ÚÚ3 <
.
ÚÚ< =
NVarChar
ÚÚ= E
,
ÚÚE F
-
ÚÚG H
$num
ÚÚH I
,
ÚÚI J 
ParameterDirection
ÚÚK ]
.
ÚÚ] ^
Input
ÚÚ^ c
,
ÚÚc d
rawResponse
ÚÚe p
)
ÚÚp q
;
ÚÚq r
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# 2
,
ÛÛ2 3
	SqlDbType
ÛÛ4 =
.
ÛÛ= >
NVarChar
ÛÛ> F
,
ÛÛF G
$num
ÛÛH J
,
ÛÛJ K 
ParameterDirection
ÛÛL ^
.
ÛÛ^ _
Input
ÛÛ_ d
,
ÛÛd e
serialNumber
ÛÛf r
)
ÛÛr s
;
ÛÛs t
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 0
,
ÜÜ0 1
	SqlDbType
ÜÜ2 ;
.
ÜÜ; <
DateTime
ÜÜ< D
,
ÜÜD E 
ParameterDirection
ÜÜF X
.
ÜÜX Y
Input
ÜÜY ^
,
ÜÜ^ _

gTimestamp
ÜÜ` j
)
ÜÜj k
;
ÜÜk l
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# 1
,
ÝÝ1 2
	SqlDbType
ÝÝ3 <
.
ÝÝ< =
NVarChar
ÝÝ= E
,
ÝÝE F
$num
ÝÝG I
,
ÝÝI J 
ParameterDirection
ÝÝK ]
.
ÝÝ] ^
Input
ÝÝ^ c
,
ÝÝc d
orderNumber
ÝÝe p
)
ÝÝp q
;
ÝÝq r
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# -
,
ÞÞ- .
	SqlDbType
ÞÞ/ 8
.
ÞÞ8 9
NVarChar
ÞÞ9 A
,
ÞÞA B
$num
ÞÞC E
,
ÞÞE F 
ParameterDirection
ÞÞG Y
.
ÞÞY Z
Input
ÞÞZ _
,
ÞÞ_ `
buyerId
ÞÞa h
)
ÞÞh i
;
ÞÞi j
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 3
,
ßß3 4
	SqlDbType
ßß5 >
.
ßß> ?
NVarChar
ßß? G
,
ßßG H
$num
ßßI K
,
ßßK L 
ParameterDirection
ßßM _
.
ßß_ `
Input
ßß` e
,
ßße f
fullfillState
ßßg t
)
ßßt u
;
ßßu v
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
NVarChar
àà> F
,
ààF G
$num
ààH J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
financeState
ààf r
)
ààr s
;
ààs t
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 4
,
áá4 5
	SqlDbType
áá6 ?
.
áá? @
Bit
áá@ C
,
ááC D 
ParameterDirection
ááE W
.
ááW X
Input
ááX ]
,
áá] ^
emailListOptIn
áá_ m
)
áám n
;
áán o
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 1
,
ââ1 2
	SqlDbType
ââ3 <
.
ââ< =
NVarChar
ââ= E
,
ââE F
$num
ââG H
,
ââH I 
ParameterDirection
ââJ \
.
ââ\ ]
Input
ââ] b
,
ââb c
avsResponse
ââd o
)
ââo p
;
ââp q
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 1
,
ãã1 2
	SqlDbType
ãã3 <
.
ãã< =
NVarChar
ãã= E
,
ããE F
$num
ããG H
,
ããH I 
ParameterDirection
ããJ \
.
ãã\ ]
Input
ãã] b
,
ããb c
cvnResponse
ããd o
)
ãão p
;
ããp q
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 1
,
ää1 2
	SqlDbType
ää3 <
.
ää< =
DateTime
ää= E
,
ääE F 
ParameterDirection
ääG Y
.
ääY Z
Input
ääZ _
,
ää_ `
authExpDate
ääa l
)
ääl m
;
ääm n
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# -
,
åå- .
	SqlDbType
åå/ 8
.
åå8 9
Decimal
åå9 @
,
åå@ A 
ParameterDirection
ååB T
.
ååT U
Input
ååU Z
,
ååZ [
authAmt
åå\ c
)
ååc d
;
ååd e
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 3
,
ææ3 4
	SqlDbType
ææ5 >
.
ææ> ?
Decimal
ææ? F
,
ææF G 
ParameterDirection
ææH Z
.
ææZ [
Input
ææ[ `
,
ææ` a
discountTotal
ææb o
)
ææo p
;
ææp q
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 3
,
çç3 4
	SqlDbType
çç5 >
.
çç> ?
Decimal
çç? F
,
ççF G 
ParameterDirection
ççH Z
.
ççZ [
Input
çç[ `
,
çç` a
shippingTotal
ççb o
)
çço p
;
ççp q
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# .
,
èè. /
	SqlDbType
èè0 9
.
èè9 :
Decimal
èè: A
,
èèA B 
ParameterDirection
èèC U
.
èèU V
Input
èèV [
,
èè[ \
taxTotal
èè] e
)
èèe f
;
èèf g
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 0
,
éé0 1
	SqlDbType
éé2 ;
.
éé; <
Decimal
éé< C
,
ééC D 
ParameterDirection
ééE W
.
ééW X
Input
ééX ]
,
éé] ^

orderTotal
éé_ i
)
ééi j
;
ééj k
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 2
,
êê2 3
	SqlDbType
êê4 =
.
êê= >
Decimal
êê> E
,
êêE F 
ParameterDirection
êêG Y
.
êêY Z
Input
êêZ _
,
êê_ `
latestChgAmt
êêa m
)
êêm n
;
êên o
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 1
,
ëë1 2
	SqlDbType
ëë3 <
.
ëë< =
Decimal
ëë= D
,
ëëD E 
ParameterDirection
ëëF X
.
ëëX Y
Input
ëëY ^
,
ëë^ _
totalChgAmt
ëë` k
)
ëëk l
;
ëël m
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# 5
,
ìì5 6
	SqlDbType
ìì7 @
.
ìì@ A
Decimal
ììA H
,
ììH I 
ParameterDirection
ììJ \
.
ìì\ ]
Input
ìì] b
,
ììb c
latestRefundAmt
ììd s
)
ììs t
;
ììt u
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# 4
,
íí4 5
	SqlDbType
íí6 ?
.
íí? @
Decimal
íí@ G
,
ííG H 
ParameterDirection
ííI [
.
íí[ \
Input
íí\ a
,
íía b
totalRefundAmt
ííc q
)
ííq r
;
íír s
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 6
,
îî6 7
	SqlDbType
îî8 A
.
îîA B
Decimal
îîB I
,
îîI J 
ParameterDirection
îîK ]
.
îî] ^
Input
îî^ c
,
îîc d
latestChargeback
îîe u
)
îîu v
;
îîv w
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 5
,
ïï5 6
	SqlDbType
ïï7 @
.
ïï@ A
Decimal
ïïA H
,
ïïH I 
ParameterDirection
ïïJ \
.
ïï\ ]
Input
ïï] b
,
ïïb c
totalChargeback
ïïd s
)
ïïs t
;
ïït u
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# -
,
ðð- .
	SqlDbType
ðð/ 8
.
ðð8 9
NVarChar
ðð9 A
,
ððA B
-
ððC D
$num
ððD E
,
ððE F 
ParameterDirection
ððG Y
.
ððY Z
Input
ððZ _
,
ðð_ `
cartXml
ðða h
)
ððh i
;
ðði j
int
ññ 
rowsAffected
ññ 
=
ññ 
sph
ññ "
.
ññ" #
ExecuteNonQuery
ññ# 2
(
ññ2 3
)
ññ3 4
;
ññ4 5
return
òò 
(
òò 
rowsAffected
òò  
>
òò! "
$num
òò# $
)
òò$ %
;
òò% &
}
ôô 	
public
ûû 
static
ûû 
bool
ûû 
Delete
ûû !
(
ûû! "
Guid
ûû" &
rowGuid
ûû' .
)
ûû. /
{
üü 	 
SqlParameterHelper
ýý 
sph
ýý "
=
ýý# $
new
ýý% ( 
SqlParameterHelper
ýý) ;
(
ýý; <
ConnectionString
ýý< L
.
ýýL M&
GetWriteConnectionString
ýýM e
(
ýýe f
)
ýýf g
,
ýýg h
$strýýi 
,ýý 
$numýý 
)ýý 
;ýý 
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# -
,
þþ- .
	SqlDbType
þþ/ 8
.
þþ8 9
UniqueIdentifier
þþ9 I
,
þþI J 
ParameterDirection
þþK ]
.
þþ] ^
Input
þþ^ c
,
þþc d
rowGuid
þþe l
)
þþl m
;
þþm n
int
ÿÿ 
rowsAffected
ÿÿ 
=
ÿÿ 
sph
ÿÿ "
.
ÿÿ" #
ExecuteNonQuery
ÿÿ# 2
(
ÿÿ2 3
)
ÿÿ3 4
;
ÿÿ4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByCart
 '
(
' (
Guid
( ,
cartGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
cartGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByStore
 (
(
( )
Guid
) -
	storeGuid
. 7
)
7 8
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	storeGuid
g p
)
p q
;
q r
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
££ 
static
££ 
IDataReader
££ !
GetOne
££" (
(
££( )
Guid
££) -
rowGuid
££. 5
)
££5 6
{
¤¤ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M%
GetReadConnectionString
¥¥M d
(
¥¥d e
)
¥¥e f
,
¥¥f g
$str¥¥h 
,¥¥ 
$num¥¥ 
)¥¥ 
;¥¥ 
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# -
,
¦¦- .
	SqlDbType
¦¦/ 8
.
¦¦8 9
UniqueIdentifier
¦¦9 I
,
¦¦I J 
ParameterDirection
¦¦K ]
.
¦¦] ^
Input
¦¦^ c
,
¦¦c d
rowGuid
¦¦e l
)
¦¦l m
;
¦¦m n
return
§§ 
sph
§§ 
.
§§ 
ExecuteReader
§§ $
(
§§$ %
)
§§% &
;
§§& '
}
©© 	
public
¯¯ 
static
¯¯ 
IDataReader
¯¯ !"
GetMostRecentByOrder
¯¯" 6
(
¯¯6 7
string
¯¯7 =
googleOrderId
¯¯> K
)
¯¯K L
{
°° 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h 
,±± 
$num±± 
)±± 
;±± 
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# 1
,
²²1 2
	SqlDbType
²²3 <
.
²²< =
NVarChar
²²= E
,
²²E F
$num
²²G I
,
²²I J 
ParameterDirection
²²K ]
.
²²] ^
Input
²²^ c
,
²²c d
googleOrderId
²²e r
)
²²r s
;
²²s t
return
³³ 
sph
³³ 
.
³³ 
ExecuteReader
³³ $
(
³³$ %
)
³³% &
;
³³& '
}
´´ 	
public
¹¹ 
static
¹¹ 
int
¹¹ 
GetCountByCart
¹¹ (
(
¹¹( )
Guid
¹¹) -
cartGuid
¹¹. 6
)
¹¹6 7
{
ºº 	 
SqlParameterHelper
»» 
sph
»» "
=
»»# $
new
»»% ( 
SqlParameterHelper
»») ;
(
»»; <
ConnectionString
»»< L
.
»»L M%
GetReadConnectionString
»»M d
(
»»d e
)
»»e f
,
»»f g
$str»»h 
,»» 
$num»» 
)»» 
;»» 
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# .
,
¼¼. /
	SqlDbType
¼¼0 9
.
¼¼9 :
UniqueIdentifier
¼¼: J
,
¼¼J K 
ParameterDirection
¼¼L ^
.
¼¼^ _
Input
¼¼_ d
,
¼¼d e
cartGuid
¼¼f n
)
¼¼n o
;
¼¼o p
return
¾¾ 
Convert
¾¾ 
.
¾¾ 
ToInt32
¾¾ "
(
¾¾" #
sph
¾¾# &
.
¾¾& '
ExecuteScalar
¾¾' 4
(
¾¾4 5
)
¾¾5 6
)
¾¾6 7
;
¾¾7 8
}
ÀÀ 	
public
ÅÅ 
static
ÅÅ 
int
ÅÅ 
GetCountByStore
ÅÅ )
(
ÅÅ) *
Guid
ÅÅ* .
	storeGuid
ÅÅ/ 8
)
ÅÅ8 9
{
ÆÆ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M%
GetReadConnectionString
ÇÇM d
(
ÇÇd e
)
ÇÇe f
,
ÇÇf g
$strÇÇh 
,ÇÇ 
$numÇÇ 
)ÇÇ 
;ÇÇ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# /
,
ÈÈ/ 0
	SqlDbType
ÈÈ1 :
.
ÈÈ: ;
UniqueIdentifier
ÈÈ; K
,
ÈÈK L 
ParameterDirection
ÈÈM _
.
ÈÈ_ `
Input
ÈÈ` e
,
ÈÈe f
	storeGuid
ÈÈg p
)
ÈÈp q
;
ÈÈq r
return
ÊÊ 
Convert
ÊÊ 
.
ÊÊ 
ToInt32
ÊÊ "
(
ÊÊ" #
sph
ÊÊ# &
.
ÊÊ& '
ExecuteScalar
ÊÊ' 4
(
ÊÊ4 5
)
ÊÊ5 6
)
ÊÊ6 7
;
ÊÊ7 8
}
ÌÌ 	
public
ÑÑ 
static
ÑÑ 
IDataReader
ÑÑ !
GetAll
ÑÑ" (
(
ÑÑ( )
)
ÑÑ) *
{
ÒÒ 	
return
ÔÔ 
	SqlHelper
ÔÔ 
.
ÔÔ 
ExecuteReader
ÔÔ *
(
ÔÔ* +
ConnectionString
ÕÕ  
.
ÕÕ  !%
GetReadConnectionString
ÕÕ! 8
(
ÕÕ8 9
)
ÕÕ9 :
,
ÕÕ: ;
CommandType
ÖÖ 
.
ÖÖ 
StoredProcedure
ÖÖ +
,
ÖÖ+ ,
$str
×× 0
,
××0 1
null
ØØ 
)
ØØ 
;
ØØ 
}
ÚÚ 	
public
ãã 
static
ãã 
IDataReader
ãã !
GetPageByCart
ãã" /
(
ãã/ 0
Guid
ää 
cartGuid
ää 
,
ää 
int
åå 

pageNumber
åå 
,
åå 
int
ææ 
pageSize
ææ 
,
ææ 
out
çç 
int
çç 

totalPages
çç 
)
çç 
{
èè 	

totalPages
éé 
=
éé 
$num
éé 
;
éé 
int
êê 
	totalRows
êê 
=
ëë 
GetCountByCart
ëë  
(
ëë  !
cartGuid
ëë! )
)
ëë) *
;
ëë* +
if
íí 
(
íí 
pageSize
íí 
>
íí 
$num
íí 
)
íí 

totalPages
íí (
=
íí) *
	totalRows
íí+ 4
/
íí5 6
pageSize
íí7 ?
;
íí? @
if
ïï 
(
ïï 
	totalRows
ïï 
<=
ïï 
pageSize
ïï %
)
ïï% &
{
ðð 

totalPages
ññ 
=
ññ 
$num
ññ 
;
ññ 
}
òò 
else
óó 
{
ôô 
int
õõ 
	remainder
õõ 
;
õõ 
Math
öö 
.
öö 
DivRem
öö 
(
öö 
	totalRows
öö %
,
öö% &
pageSize
öö' /
,
öö/ 0
out
öö1 4
	remainder
öö5 >
)
öö> ?
;
öö? @
if
÷÷ 
(
÷÷ 
	remainder
÷÷ 
>
÷÷ 
$num
÷÷  !
)
÷÷! "
{
øø 

totalPages
ùù 
+=
ùù !
$num
ùù" #
;
ùù# $
}
úú 
}
ûû  
SqlParameterHelper
ýý 
sph
ýý "
=
ýý# $
new
ýý% ( 
SqlParameterHelper
ýý) ;
(
ýý; <
ConnectionString
ýý< L
.
ýýL M%
GetReadConnectionString
ýýM d
(
ýýd e
)
ýýe f
,
ýýf g
$strýýh 
,ýý 
$numýý 
)ýý 
;ýý 
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# .
,
þþ. /
	SqlDbType
þþ0 9
.
þþ9 :
UniqueIdentifier
þþ: J
,
þþJ K 
ParameterDirection
þþL ^
.
þþ^ _
Input
þþ_ d
,
þþd e
cartGuid
þþf n
)
þþn o
;
þþo p
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 0
,
ÿÿ0 1
	SqlDbType
ÿÿ2 ;
.
ÿÿ; <
Int
ÿÿ< ?
,
ÿÿ? @ 
ParameterDirection
ÿÿA S
.
ÿÿS T
Input
ÿÿT Y
,
ÿÿY Z

pageNumber
ÿÿ[ e
)
ÿÿe f
;
ÿÿf g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetPageByStore
" 0
(
0 1
Guid
 
	storeGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCountByStore
 !
(
! "
	storeGuid
" +
)
+ ,
;
, -
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
   
(
   
	remainder
   
>
   
$num
    !
)
  ! "
{
¡¡ 

totalPages
¢¢ 
+=
¢¢ !
$num
¢¢" #
;
¢¢# $
}
££ 
}
¤¤  
SqlParameterHelper
¦¦ 
sph
¦¦ "
=
¦¦# $
new
¦¦% ( 
SqlParameterHelper
¦¦) ;
(
¦¦; <
ConnectionString
¦¦< L
.
¦¦L M%
GetReadConnectionString
¦¦M d
(
¦¦d e
)
¦¦e f
,
¦¦f g
$str¦¦h 
,¦¦ 
$num¦¦ 
)¦¦ 
;¦¦ 
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# /
,
§§/ 0
	SqlDbType
§§1 :
.
§§: ;
UniqueIdentifier
§§; K
,
§§K L 
ParameterDirection
§§M _
.
§§_ `
Input
§§` e
,
§§e f
	storeGuid
§§g p
)
§§p q
;
§§q r
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 0
,
¨¨0 1
	SqlDbType
¨¨2 ;
.
¨¨; <
Int
¨¨< ?
,
¨¨? @ 
ParameterDirection
¨¨A S
.
¨¨S T
Input
¨¨T Y
,
¨¨Y Z

pageNumber
¨¨[ e
)
¨¨e f
;
¨¨f g
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# .
,
©©. /
	SqlDbType
©©0 9
.
©©9 :
Int
©©: =
,
©©= > 
ParameterDirection
©©? Q
.
©©Q R
Input
©©R W
,
©©W X
pageSize
©©Y a
)
©©a b
;
©©b c
return
ªª 
sph
ªª 
.
ªª 
ExecuteReader
ªª $
(
ªª$ %
)
ªª% &
;
ªª& '
}
¬¬ 	
}
®® 
}°° Ñ¢
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbHtmlContent.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBHtmlContent %
{ 
public 
static 
int 
AddHtmlContent (
(( )
Guid 
itemGuid 
, 
Guid 

moduleGuid 
, 
int 
moduleId 
, 
string 
title 
, 
string   
excerpt   
,   
string!! 
body!! 
,!! 
string"" 
moreLink"" 
,"" 
int## 
	sortOrder## 
,## 
DateTime$$ 
	beginDate$$ 
,$$ 
DateTime%% 
endDate%% 
,%% 
DateTime&& 
createdDate&&  
,&&  !
int'' 
userId'' 
,'' 
Guid(( 
userGuid(( 
,(( 
bool)) $
excludeFromRecentContent)) )
)))) *
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str	++i 
,
++ 
$num
++ 
)
++ 
;
++ 
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# .
,,,. /
	SqlDbType,,0 9
.,,9 :
UniqueIdentifier,,: J
,,,J K
ParameterDirection,,L ^
.,,^ _
Input,,_ d
,,,d e
itemGuid,,f n
),,n o
;,,o p
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# 0
,--0 1
	SqlDbType--2 ;
.--; <
UniqueIdentifier--< L
,--L M
ParameterDirection--N `
.--` a
Input--a f
,--f g

moduleGuid--h r
)--r s
;--s t
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# .
,... /
	SqlDbType..0 9
...9 :
Int..: =
,..= >
ParameterDirection..? Q
...Q R
Input..R W
,..W X
moduleId..Y a
)..a b
;..b c
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# +
,//+ ,
	SqlDbType//- 6
.//6 7
NVarChar//7 ?
,//? @
$num//A D
,//D E
ParameterDirection//F X
.//X Y
Input//Y ^
,//^ _
title//` e
)//e f
;//f g
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# -
,00- .
	SqlDbType00/ 8
.008 9
NVarChar009 A
,00A B
-00C D
$num00D E
,00E F
ParameterDirection00G Y
.00Y Z
Input00Z _
,00_ `
excerpt00a h
)00h i
;00i j
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
NVarChar116 >
,11> ?
-11@ A
$num11A B
,11B C
ParameterDirection11D V
.11V W
Input11W \
,11\ ]
body11^ b
)11b c
;11c d
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
NVarChar22: B
,22B C
$num22D G
,22G H
ParameterDirection22I [
.22[ \
Input22\ a
,22a b
moreLink22c k
)22k l
;22l m
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
Int33; >
,33> ?
ParameterDirection33@ R
.33R S
Input33S X
,33X Y
	sortOrder33Z c
)33c d
;33d e
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# /
,44/ 0
	SqlDbType441 :
.44: ;
DateTime44; C
,44C D
ParameterDirection44E W
.44W X
Input44X ]
,44] ^
	beginDate44_ h
)44h i
;44i j
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# -
,55- .
	SqlDbType55/ 8
.558 9
DateTime559 A
,55A B
ParameterDirection55C U
.55U V
Input55V [
,55[ \
endDate55] d
)55d e
;55e f
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 1
,661 2
	SqlDbType663 <
.66< =
DateTime66= E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
createdDate66a l
)66l m
;66m n
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ,
,77, -
	SqlDbType77. 7
.777 8
Int778 ;
,77; <
ParameterDirection77= O
.77O P
Input77P U
,77U V
userId77W ]
)77] ^
;77^ _
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# .
,88. /
	SqlDbType880 9
.889 :
UniqueIdentifier88: J
,88J K
ParameterDirection88L ^
.88^ _
Input88_ d
,88d e
userGuid88f n
)88n o
;88o p
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# >
,99> ?
	SqlDbType99@ I
.99I J
Bit99J M
,99M N
ParameterDirection99O a
.99a b
Input99b g
,99g h%
excludeFromRecentContent	99i 
)
99 
;
99 
int:: 
newID:: 
=:: 
Convert:: 
.::  
ToInt32::  '
(::' (
sph::( +
.::+ ,
ExecuteScalar::, 9
(::9 :
)::: ;
)::; <
;::< =
return;; 
newID;; 
;;; 
}<< 	
public>> 
static>> 
bool>> 
UpdateHtmlContent>> ,
(>>, -
int??
 
itemId?? 
,?? 
int@@
 
moduleId@@ 
,@@ 
stringAA
 
titleAA 
,AA 
stringBB
 
excerptBB 
,BB 
stringCC
 
bodyCC 
,CC 
stringDD
 
moreLinkDD 
,DD 
intEE
 
	sortOrderEE 
,EE 
DateTimeFF
 
	beginDateFF 
,FF 
DateTimeGG
 
endDateGG 
,GG 
DateTimeHH
 

lastModUtcHH 
,HH 
GuidII
 
lastModUserGuidII 
,II 
boolJJ
 $
excludeFromRecentContentJJ '
)JJ' (
{KK 	
SqlParameterHelperLL 
sphLL "
=LL# $
newLL% (
SqlParameterHelperLL) ;
(LL; <
ConnectionStringLL< L
.LLL M$
GetWriteConnectionStringLLM e
(LLe f
)LLf g
,LLg h
$str	LLi 
,
LL 
$num
LL 
)
LL 
;
LL 
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# ,
,MM, -
	SqlDbTypeMM. 7
.MM7 8
IntMM8 ;
,MM; <
ParameterDirectionMM= O
.MMO P
InputMMP U
,MMU V
itemIdMMW ]
)MM] ^
;MM^ _
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# .
,NN. /
	SqlDbTypeNN0 9
.NN9 :
IntNN: =
,NN= >
ParameterDirectionNN? Q
.NNQ R
InputNNR W
,NNW X
moduleIdNNY a
)NNa b
;NNb c
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# +
,OO+ ,
	SqlDbTypeOO- 6
.OO6 7
NVarCharOO7 ?
,OO? @
$numOOA D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _
titleOO` e
)OOe f
;OOf g
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# -
,PP- .
	SqlDbTypePP/ 8
.PP8 9
NVarCharPP9 A
,PPA B
-PPC D
$numPPD E
,PPE F
ParameterDirectionPPG Y
.PPY Z
InputPPZ _
,PP_ `
excerptPPa h
)PPh i
;PPi j
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
NVarCharQQ6 >
,QQ> ?
-QQ@ A
$numQQA B
,QQB C
ParameterDirectionQQD V
.QQV W
InputQQW \
,QQ\ ]
bodyQQ^ b
)QQb c
;QQc d
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# .
,RR. /
	SqlDbTypeRR0 9
.RR9 :
NVarCharRR: B
,RRB C
$numRRD G
,RRG H
ParameterDirectionRRI [
.RR[ \
InputRR\ a
,RRa b
moreLinkRRc k
)RRk l
;RRl m
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# /
,SS/ 0
	SqlDbTypeSS1 :
.SS: ;
IntSS; >
,SS> ?
ParameterDirectionSS@ R
.SSR S
InputSSS X
,SSX Y
	sortOrderSSZ c
)SSc d
;SSd e
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# /
,TT/ 0
	SqlDbTypeTT1 :
.TT: ;
DateTimeTT; C
,TTC D
ParameterDirectionTTE W
.TTW X
InputTTX ]
,TT] ^
	beginDateTT_ h
)TTh i
;TTi j
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# -
,UU- .
	SqlDbTypeUU/ 8
.UU8 9
DateTimeUU9 A
,UUA B
ParameterDirectionUUC U
.UUU V
InputUUV [
,UU[ \
endDateUU] d
)UUd e
;UUe f
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 0
,VV0 1
	SqlDbTypeVV2 ;
.VV; <
DateTimeVV< D
,VVD E
ParameterDirectionVVF X
.VVX Y
InputVVY ^
,VV^ _

lastModUtcVV` j
)VVj k
;VVk l
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 5
,WW5 6
	SqlDbTypeWW7 @
.WW@ A
UniqueIdentifierWWA Q
,WWQ R
ParameterDirectionWWS e
.WWe f
InputWWf k
,WWk l
lastModUserGuidWWm |
)WW| }
;WW} ~
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# >
,XX> ?
	SqlDbTypeXX@ I
.XXI J
BitXXJ M
,XXM N
ParameterDirectionXXO a
.XXa b
InputXXb g
,XXg h%
excludeFromRecentContent	XXi 
)
XX 
;
XX 
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
(ZZ 
rowsAffectedZZ  
>ZZ! "
-ZZ# $
$numZZ$ %
)ZZ% &
;ZZ& '
}[[ 	
publicqq 
staticqq 
boolqq 
DeleteHtmlContentqq ,
(qq, -
intqq- 0
itemIdqq1 7
)qq7 8
{rr 	
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$str	ssi 
,
ss 
$num
ss 
)
ss 
;
ss 
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# ,
,tt, -
	SqlDbTypett. 7
.tt7 8
Inttt8 ;
,tt; <
ParameterDirectiontt= O
.ttO P
InputttP U
,ttU V
itemIdttW ]
)tt] ^
;tt^ _
intuu 
rowsAffecteduu 
=uu 
sphuu "
.uu" #
ExecuteNonQueryuu# 2
(uu2 3
)uu3 4
;uu4 5
returnvv 
(vv 
rowsAffectedvv  
>vv! "
-vv# $
$numvv$ %
)vv% &
;vv& '
}ww 	
publicyy 
staticyy 
boolyy 
DeleteBySiteyy '
(yy' (
intyy( +
siteIdyy, 2
)yy2 3
{zz 	
SqlParameterHelper{{ 
sph{{ "
={{# $
new{{% (
SqlParameterHelper{{) ;
({{; <
ConnectionString{{< L
.{{L M$
GetWriteConnectionString{{M e
({{e f
){{f g
,{{g h
$str	{{i 
,
{{ 
$num
{{ 
)
{{ 
;
{{ 
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# ,
,||, -
	SqlDbType||. 7
.||7 8
Int||8 ;
,||; <
ParameterDirection||= O
.||O P
Input||P U
,||U V
siteId||W ]
)||] ^
;||^ _
int}} 
rowsAffected}} 
=}} 
sph}} "
.}}" #
ExecuteNonQuery}}# 2
(}}2 3
)}}3 4
;}}4 5
return~~ 
(~~ 
rowsAffected~~  
>~~! "
-~~# $
$num~~$ %
)~~% &
;~~& '
} 	
public
 
static
 
bool
 
DeleteByModule
 )
(
) *
int
* -
moduleId
. 6
)
6 7
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetHtmlContent
" 0
(
0 1
int
1 4
moduleId
5 =
,
= >
int
? B
itemId
C I
)
I J
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
itemId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !%
GetHtmlForMetaWeblogApi
" 9
(
9 :
int
: =
siteId
> D
)
D E
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetHtmlContent
" 0
(
0 1
int
 
moduleId
 
,
 
DateTime
 
	beginDate
 "
)
" #
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
DateTime
; C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
	beginDate
_ h
)
h i
;
i j
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
¡¡ 
static
¡¡ 
IDataReader
¡¡ !"
GetHtmlContentByPage
¡¡" 6
(
¡¡6 7
int
¡¡7 :
siteId
¡¡; A
,
¡¡A B
int
¡¡C F
pageId
¡¡G M
)
¡¡M N
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M%
GetReadConnectionString
££M d
(
££d e
)
££e f
,
££f g
$str££h 
,££ 
$num££ 
)££ 
;££ 
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# ,
,
¤¤, -
	SqlDbType
¤¤. 7
.
¤¤7 8
Int
¤¤8 ;
,
¤¤; < 
ParameterDirection
¤¤= O
.
¤¤O P
Input
¤¤P U
,
¤¤U V
siteId
¤¤W ]
)
¤¤] ^
;
¤¤^ _
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# ,
,
¥¥, -
	SqlDbType
¥¥. 7
.
¥¥7 8
Int
¥¥8 ;
,
¥¥; < 
ParameterDirection
¥¥= O
.
¥¥O P
Input
¥¥P U
,
¥¥U V
pageId
¥¥W ]
)
¥¥] ^
;
¥¥^ _
return
¦¦ 
sph
¦¦ 
.
¦¦ 
ExecuteReader
¦¦ $
(
¦¦$ %
)
¦¦% &
;
¦¦& '
}
§§ 	
}
«« 
}¬¬ ¶L
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBIndexingQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBIndexingQueue '
{ 
public"" 
static"" 
Int64"" 
Create"" "
(""" #
int## 
siteId## 
,## 
string$$ 
	indexPath$$ 
,$$ 
string%% 
serializedItem%% !
,%%! "
string&& 
itemKey&& 
,&& 
bool'' 

removeOnly'' 
)'' 
{(( 	
SqlParameterHelper)) 
sph)) "
=))# $
new))% (
SqlParameterHelper))) ;
()); <
ConnectionString))< L
.))L M$
GetWriteConnectionString))M e
())e f
)))f g
,))g h
$str	))i 
,
)) 
$num
)) 
)
)) 
;
)) 
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# ,
,**, -
	SqlDbType**. 7
.**7 8
Int**8 ;
,**; <
ParameterDirection**= O
.**O P
Input**P U
,**U V
siteId**W ]
)**] ^
;**^ _
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# /
,++/ 0
	SqlDbType++1 :
.++: ;
NVarChar++; C
,++C D
$num++E H
,++H I
ParameterDirection++J \
.++\ ]
Input++] b
,++b c
	indexPath++d m
)++m n
;++n o
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# 4
,,,4 5
	SqlDbType,,6 ?
.,,? @
NVarChar,,@ H
,,,H I
-,,J K
$num,,K L
,,,L M
ParameterDirection,,N `
.,,` a
Input,,a f
,,,f g
serializedItem,,h v
),,v w
;,,w x
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# -
,--- .
	SqlDbType--/ 8
.--8 9
NVarChar--9 A
,--A B
$num--C F
,--F G
ParameterDirection--H Z
.--Z [
Input--[ `
,--` a
itemKey--b i
)--i j
;--j k
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# 0
,..0 1
	SqlDbType..2 ;
...; <
Bit..< ?
,..? @
ParameterDirection..A S
...S T
Input..T Y
,..Y Z

removeOnly..[ e
)..e f
;..f g
Int64// 
newID// 
=// 
Convert// !
.//! "
ToInt64//" )
(//) *
sph//* -
.//- .
ExecuteScalar//. ;
(//; <
)//< =
)//= >
;//> ?
return00 
newID00 
;00 
}11 	
publicTT 
staticTT 
boolTT 
DeleteTT !
(TT! "
Int64TT" '
rowIdTT( -
)TT- .
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M$
GetWriteConnectionStringVVM e
(VVe f
)VVf g
,VVg h
$str	VVi 
,
VV 
$num
VV 
)
VV 
;
VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# +
,WW+ ,
	SqlDbTypeWW- 6
.WW6 7
BigIntWW7 =
,WW= >
ParameterDirectionWW? Q
.WWQ R
InputWWR W
,WWW X
rowIdWWY ^
)WW^ _
;WW_ `
intXX 
rowsAffectedXX 
=XX 
sphXX "
.XX" #
ExecuteNonQueryXX# 2
(XX2 3
)XX3 4
;XX4 5
returnYY 
(YY 
rowsAffectedYY  
>YY! "
$numYY# $
)YY$ %
;YY% &
}[[ 	
publicbb 
staticbb 
boolbb 
	DeleteAllbb $
(bb$ %
)bb% &
{cc 	
intdd 
rowsAffecteddd 
=dd 
	SqlHelperdd (
.dd( )
ExecuteNonQuerydd) 8
(dd8 9
ConnectionStringee  
.ee  !$
GetWriteConnectionStringee! 9
(ee9 :
)ee: ;
,ee; <
CommandTypeff 
.ff 
StoredProcedureff +
,ff+ ,
$strgg ,
,gg, -
nullhh 
)hh 
;hh 
returnjj 
(jj 
rowsAffectedjj  
>jj! "
$numjj# $
)jj$ %
;jj% &
}ll 	
publicqq 
staticqq 
intqq 
GetCountqq "
(qq" #
)qq# $
{rr 	
returntt 
Converttt 
.tt 
ToInt32tt "
(tt" #
	SqlHelpertt# ,
.tt, -
ExecuteScalartt- :
(tt: ;
ConnectionStringuu  
.uu  !#
GetReadConnectionStringuu! 8
(uu8 9
)uu9 :
,uu: ;
CommandTypevv 
.vv 
StoredProcedurevv +
,vv+ ,
$strww +
,ww+ ,
nullxx 
)xx 
)xx 
;xx 
}zz 	
public 
static 
	DataTable 
GetIndexPaths  -
(- .
). /
{
 	
IDataReader
 
reader
 
=
  
	SqlHelper
! *
.
* +
ExecuteReader
+ 8
(
8 9
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 6
,
6 7
null
 
)
 
;
 
return
 
DBPortal
 
.
 $
GetTableFromDataReader
 2
(
2 3
reader
3 9
)
9 :
;
: ;
}
 	
public
 
static
 
	DataTable
 

GetSiteIDs
  *
(
* +
)
+ ,
{
 	
IDataReader
 
reader
 
=
  
	SqlHelper
! *
.
* +
ExecuteReader
+ 8
(
8 9
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 7
,
7 8
null
 
)
 
;
 
return
 
DBPortal
 
.
 $
GetTableFromDataReader
 2
(
2 3
reader
3 9
)
9 :
;
: ;
}
 	
public
 
static
 
	DataTable
 
	GetByPath
  )
(
) *
string
* 0
	indexPath
1 :
)
: ;
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
NVarChar
; C
,
C D
$num
E H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
	indexPath
d m
)
m n
;
n o
IDataReader
   
reader
   
=
    
sph
  ! $
.
  $ %
ExecuteReader
  % 2
(
  2 3
)
  3 4
;
  4 5
return
¢¢ 
DBPortal
¢¢ 
.
¢¢ $
GetTableFromDataReader
¢¢ 2
(
¢¢2 3
reader
¢¢3 9
)
¢¢9 :
;
¢¢: ;
}
¤¤ 	
public
¦¦ 
static
¦¦ 
	DataTable
¦¦ 
	GetBySite
¦¦  )
(
¦¦) *
int
¦¦* -
siteId
¦¦. 4
)
¦¦4 5
{
§§ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M%
GetReadConnectionString
¨¨M d
(
¨¨d e
)
¨¨e f
,
¨¨f g
$str¨¨h 
,¨¨ 
$num¨¨ 
)¨¨ 
;¨¨ 
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
siteId
©©W ]
)
©©] ^
;
©©^ _
IDataReader
ªª 
reader
ªª 
=
ªª  
sph
ªª! $
.
ªª$ %
ExecuteReader
ªª% 2
(
ªª2 3
)
ªª3 4
;
ªª4 5
return
¬¬ 
DBPortal
¬¬ 
.
¬¬ $
GetTableFromDataReader
¬¬ 2
(
¬¬2 3
reader
¬¬3 9
)
¬¬9 :
;
¬¬: ;
}
®® 	
}
¶¶ 
}¸¸ ¾U
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLanguage.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBLanguage "
{ 
public%% 
static%% 
int%% 
Create%%  
(%%  !
Guid&& 
guid&& 
,&& 
string'' 
name'' 
,'' 
string(( 
code(( 
,(( 
int)) 
sort)) 
))) 
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i }
,++} ~
$num	++ 
)
++ 
;
++ 
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# *
,--* +
	SqlDbType--, 5
.--5 6
NVarChar--6 >
,--> ?
$num--@ C
,--C D
ParameterDirection--E W
.--W X
Input--X ]
,--] ^
name--_ c
)--c d
;--d e
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# *
,..* +
	SqlDbType.., 5
...5 6
NChar..6 ;
,..; <
$num..= >
,..> ?
ParameterDirection..@ R
...R S
Input..S X
,..X Y
code..Z ^
)..^ _
;.._ `
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
Int//6 9
,//9 :
ParameterDirection//; M
.//M N
Input//N S
,//S T
sort//U Y
)//Y Z
;//Z [
int00 
rowsAffected00 
=00 
sph00 "
.00" #
ExecuteNonQuery00# 2
(002 3
)003 4
;004 5
return11 
rowsAffected11 
;11  
}33 	
public>> 
static>> 
bool>> 
Update>> !
(>>! "
Guid?? 
guid?? 
,?? 
string@@ 
name@@ 
,@@ 
stringAA 
codeAA 
,AA 
intBB 
sortBB 
)BB 
{CC 	
SqlParameterHelperDD 
sphDD "
=DD# $
newDD% (
SqlParameterHelperDD) ;
(DD; <
ConnectionStringDD< L
.DDL M$
GetWriteConnectionStringDDM e
(DDe f
)DDf g
,DDg h
$strDDi }
,DD} ~
$num	DD 
)
DD 
;
DD 
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# *
,EE* +
	SqlDbTypeEE, 5
.EE5 6
UniqueIdentifierEE6 F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
guidEEb f
)EEf g
;EEg h
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# *
,FF* +
	SqlDbTypeFF, 5
.FF5 6
NVarCharFF6 >
,FF> ?
$numFF@ C
,FFC D
ParameterDirectionFFE W
.FFW X
InputFFX ]
,FF] ^
nameFF_ c
)FFc d
;FFd e
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# *
,GG* +
	SqlDbTypeGG, 5
.GG5 6
NCharGG6 ;
,GG; <
$numGG= >
,GG> ?
ParameterDirectionGG@ R
.GGR S
InputGGS X
,GGX Y
codeGGZ ^
)GG^ _
;GG_ `
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
IntHH6 9
,HH9 :
ParameterDirectionHH; M
.HHM N
InputHHN S
,HHS T
sortHHU Y
)HHY Z
;HHZ [
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicSS 
staticSS 
boolSS 
DeleteSS !
(SS! "
GuidSS" &
guidSS' +
)SS+ ,
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$strUUi }
,UU} ~
$num	UU 
)
UU 
;
UU 
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
(XX 
rowsAffectedXX  
>XX! "
$numXX# $
)XX$ %
;XX% &
}ZZ 	
public`` 
static`` 
IDataReader`` !
GetOne``" (
(``( )
Guid``) -
guid``. 2
)``2 3
{aa 	
SqlParameterHelperbb 
sphbb "
=bb# $
newbb% (
SqlParameterHelperbb) ;
(bb; <
ConnectionStringbb< L
.bbL M#
GetReadConnectionStringbbM d
(bbd e
)bbe f
,bbf g
$strbbh 
,	bb 
$num
bb 
)
bb 
;
bb 
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# *
,cc* +
	SqlDbTypecc, 5
.cc5 6
UniqueIdentifiercc6 F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
guidccb f
)ccf g
;ccg h
returndd 
sphdd 
.dd 
ExecuteReaderdd $
(dd$ %
)dd% &
;dd& '
}ff 	
publickk 
statickk 
intkk 
GetCountkk "
(kk" #
)kk# $
{ll 	
returnnn 
Convertnn 
.nn 
ToInt32nn "
(nn" #
	SqlHelpernn# ,
.nn, -
ExecuteScalarnn- :
(nn: ;
ConnectionStringoo  
.oo  !#
GetReadConnectionStringoo! 8
(oo8 9
)oo9 :
,oo: ;
CommandTypepp 
.pp 
StoredProcedurepp +
,pp+ ,
$strqq &
,qq& '
nullrr 
)rr 
)rr 
;rr 
}tt 	
publicyy 
staticyy 
IDataReaderyy !
GetAllyy" (
(yy( )
)yy) *
{zz 	
return|| 
	SqlHelper|| 
.|| 
ExecuteReader|| *
(||* +
ConnectionString}}  
.}}  !#
GetReadConnectionString}}! 8
(}}8 9
)}}9 :
,}}: ;
CommandType~~ 
.~~ 
StoredProcedure~~ +
,~~+ ,
$str '
,' (
null
 
)
 
;
 
}
 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 
(
 
)
 
;
 
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
   
}
¡¡  
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M%
GetReadConnectionString
££M d
(
££d e
)
££e f
,
££f g
$str££h 
,££ 
$num££ 
)££ 
;££ 
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 0
,
¤¤0 1
	SqlDbType
¤¤2 ;
.
¤¤; <
Int
¤¤< ?
,
¤¤? @ 
ParameterDirection
¤¤A S
.
¤¤S T
Input
¤¤T Y
,
¤¤Y Z

pageNumber
¤¤[ e
)
¤¤e f
;
¤¤f g
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
Int
¥¥: =
,
¥¥= > 
ParameterDirection
¥¥? Q
.
¥¥Q R
Input
¥¥R W
,
¥¥W X
pageSize
¥¥Y a
)
¥¥a b
;
¥¥b c
return
¦¦ 
sph
¦¦ 
.
¦¦ 
ExecuteReader
¦¦ $
(
¦¦$ %
)
¦¦% &
;
¦¦& '
}
¨¨ 	
}
ªª 
}¬¬ Öà
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetter.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetter  
{ 
public,, 
static,, 
int,, 
Create,,  
(,,  !
Guid-- 

letterGuid-- 
,-- 
Guid.. 
letterInfoGuid.. 
,..  
string// 
subject// 
,// 
string00 
htmlBody00 
,00 
string11 
textBody11 
,11 
Guid22 
	createdBy22 
,22 
DateTime33 

createdUtc33 
,33  
Guid44 
	lastModBy44 
,44 
DateTime55 

lastModUtc55 
,55  
bool66 

isApproved66 
,66 
Guid77 

approvedBy77 
)77 
{88 	
SqlParameterHelper99 
sph99 "
=99# $
new99% (
SqlParameterHelper99) ;
(99; <
ConnectionString99< L
.99L M$
GetWriteConnectionString99M e
(99e f
)99f g
,99g h
$str99i {
,99{ |
$num99} 
)	99 
;
99 
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
UniqueIdentifier::< L
,::L M
ParameterDirection::N `
.::` a
Input::a f
,::f g

letterGuid::h r
)::r s
;::s t
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# 4
,;;4 5
	SqlDbType;;6 ?
.;;? @
UniqueIdentifier;;@ P
,;;P Q
ParameterDirection;;R d
.;;d e
Input;;e j
,;;j k
letterInfoGuid;;l z
);;z {
;;;{ |
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# -
,<<- .
	SqlDbType<</ 8
.<<8 9
NVarChar<<9 A
,<<A B
$num<<C F
,<<F G
ParameterDirection<<H Z
.<<Z [
Input<<[ `
,<<` a
subject<<b i
)<<i j
;<<j k
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# .
,==. /
	SqlDbType==0 9
.==9 :
NVarChar==: B
,==B C
-==D E
$num==E F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
htmlBody==b j
)==j k
;==k l
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># .
,>>. /
	SqlDbType>>0 9
.>>9 :
NVarChar>>: B
,>>B C
->>D E
$num>>E F
,>>F G
ParameterDirection>>H Z
.>>Z [
Input>>[ `
,>>` a
textBody>>b j
)>>j k
;>>k l
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# /
,??/ 0
	SqlDbType??1 :
.??: ;
UniqueIdentifier??; K
,??K L
ParameterDirection??M _
.??_ `
Input??` e
,??e f
	createdBy??g p
)??p q
;??q r
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 0
,@@0 1
	SqlDbType@@2 ;
.@@; <
DateTime@@< D
,@@D E
ParameterDirection@@F X
.@@X Y
Input@@Y ^
,@@^ _

createdUtc@@` j
)@@j k
;@@k l
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# /
,AA/ 0
	SqlDbTypeAA1 :
.AA: ;
UniqueIdentifierAA; K
,AAK L
ParameterDirectionAAM _
.AA_ `
InputAA` e
,AAe f
	lastModByAAg p
)AAp q
;AAq r
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 0
,BB0 1
	SqlDbTypeBB2 ;
.BB; <
DateTimeBB< D
,BBD E
ParameterDirectionBBF X
.BBX Y
InputBBY ^
,BB^ _

lastModUtcBB` j
)BBj k
;BBk l
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 0
,CC0 1
	SqlDbTypeCC2 ;
.CC; <
BitCC< ?
,CC? @
ParameterDirectionCCA S
.CCS T
InputCCT Y
,CCY Z

isApprovedCC[ e
)CCe f
;CCf g
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 0
,DD0 1
	SqlDbTypeDD2 ;
.DD; <
UniqueIdentifierDD< L
,DDL M
ParameterDirectionDDN `
.DD` a
InputDDa f
,DDf g

approvedByDDh r
)DDr s
;DDs t
intFF 
rowsAffectedFF 
=FF 
sphFF "
.FF" #
ExecuteNonQueryFF# 2
(FF2 3
)FF3 4
;FF4 5
returnGG 
rowsAffectedGG 
;GG  
}HH 	
publicXX 
staticXX 
boolXX 
UpdateXX !
(XX! "
GuidYY 

letterGuidYY 
,YY 
GuidZZ 
letterInfoGuidZZ 
,ZZ  
string[[ 
subject[[ 
,[[ 
string\\ 
htmlBody\\ 
,\\ 
string]] 
textBody]] 
,]] 
Guid^^ 
	lastModBy^^ 
,^^ 
DateTime__ 

lastModUtc__ 
,__  
bool`` 

isApproved`` 
,`` 
Guidaa 

approvedByaa 
)aa 
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M$
GetWriteConnectionStringccM e
(cce f
)ccf g
,ccg h
$strcci {
,cc{ |
$numcc} ~
)cc~ 
;	cc 
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
UniqueIdentifierdd< L
,ddL M
ParameterDirectionddN `
.dd` a
Inputdda f
,ddf g

letterGuidddh r
)ddr s
;dds t
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# 4
,ee4 5
	SqlDbTypeee6 ?
.ee? @
UniqueIdentifieree@ P
,eeP Q
ParameterDirectioneeR d
.eed e
Inputeee j
,eej k
letterInfoGuideel z
)eez {
;ee{ |
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# -
,ff- .
	SqlDbTypeff/ 8
.ff8 9
NVarCharff9 A
,ffA B
$numffC F
,ffF G
ParameterDirectionffH Z
.ffZ [
Inputff[ `
,ff` a
subjectffb i
)ffi j
;ffj k
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# .
,gg. /
	SqlDbTypegg0 9
.gg9 :
NVarChargg: B
,ggB C
-ggD E
$numggE F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
htmlBodyggb j
)ggj k
;ggk l
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# .
,hh. /
	SqlDbTypehh0 9
.hh9 :
NVarCharhh: B
,hhB C
-hhD E
$numhhE F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
textBodyhhb j
)hhj k
;hhk l
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# /
,ii/ 0
	SqlDbTypeii1 :
.ii: ;
UniqueIdentifierii; K
,iiK L
ParameterDirectioniiM _
.ii_ `
Inputii` e
,iie f
	lastModByiig p
)iip q
;iiq r
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 0
,jj0 1
	SqlDbTypejj2 ;
.jj; <
DateTimejj< D
,jjD E
ParameterDirectionjjF X
.jjX Y
InputjjY ^
,jj^ _

lastModUtcjj` j
)jjj k
;jjk l
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 0
,kk0 1
	SqlDbTypekk2 ;
.kk; <
Bitkk< ?
,kk? @
ParameterDirectionkkA S
.kkS T
InputkkT Y
,kkY Z

isApprovedkk[ e
)kke f
;kkf g
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 0
,ll0 1
	SqlDbTypell2 ;
.ll; <
UniqueIdentifierll< L
,llL M
ParameterDirectionllN `
.ll` a
Inputlla f
,llf g

approvedByllh r
)llr s
;lls t
intnn 
rowsAffectednn 
=nn 
sphnn "
.nn" #
ExecuteNonQuerynn# 2
(nn2 3
)nn3 4
;nn4 5
returnoo 
(oo 
rowsAffectedoo  
>oo! "
$numoo# $
)oo$ %
;oo% &
}pp 	
publicww 
staticww 
boolww 
Deleteww !
(ww! "
Guidww" &

letterGuidww' 1
)ww1 2
{xx 	
SqlParameterHelperyy 
sphyy "
=yy# $
newyy% (
SqlParameterHelperyy) ;
(yy; <
ConnectionStringyy< L
.yyL M$
GetWriteConnectionStringyyM e
(yye f
)yyf g
,yyg h
$stryyi {
,yy{ |
$numyy} ~
)yy~ 
;	yy 
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 0
,zz0 1
	SqlDbTypezz2 ;
.zz; <
UniqueIdentifierzz< L
,zzL M
ParameterDirectionzzN `
.zz` a
Inputzza f
,zzf g

letterGuidzzh r
)zzr s
;zzs t
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}~~ 	
public
 
static
 
bool
  
DeleteByLetterInfo
 -
(
- .
Guid
. 2
letterInfoGuid
3 A
)
A B
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
SendClicked
 &
(
& '
Guid
 

letterGuid
 
,
 
DateTime
 
sendClickedUtc
 #
)
# $
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

letterGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
sendClickedUtc
d r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
   	
public
¨¨ 
static
¨¨ 
bool
¨¨ 
SendStarted
¨¨ &
(
¨¨& '
Guid
©© 

letterGuid
©© 
,
©© 
DateTime
ªª 
sendStartedUtc
ªª #
)
ªª# $
{
«« 	 
SqlParameterHelper
¬¬ 
sph
¬¬ "
=
¬¬# $
new
¬¬% ( 
SqlParameterHelper
¬¬) ;
(
¬¬; <
ConnectionString
¬¬< L
.
¬¬L M&
GetWriteConnectionString
¬¬M e
(
¬¬e f
)
¬¬f g
,
¬¬g h
$str¬¬i 
,¬¬ 
$num¬¬ 
)¬¬ 
;¬¬ 
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# 0
,
­­0 1
	SqlDbType
­­2 ;
.
­­; <
UniqueIdentifier
­­< L
,
­­L M 
ParameterDirection
­­N `
.
­­` a
Input
­­a f
,
­­f g

letterGuid
­­h r
)
­­r s
;
­­s t
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 4
,
®®4 5
	SqlDbType
®®6 ?
.
®®? @
DateTime
®®@ H
,
®®H I 
ParameterDirection
®®J \
.
®®\ ]
Input
®®] b
,
®®b c
sendStartedUtc
®®d r
)
®®r s
;
®®s t
int
°° 
rowsAffected
°° 
=
°° 
sph
°° "
.
°°" #
ExecuteNonQuery
°°# 2
(
°°2 3
)
°°3 4
;
°°4 5
return
±± 
(
±± 
rowsAffected
±±  
>
±±! "
$num
±±# $
)
±±$ %
;
±±% &
}
²² 	
public
ºº 
static
ºº 
bool
ºº 
SendComplete
ºº '
(
ºº' (
Guid
»» 

letterGuid
»» 
,
»» 
DateTime
¼¼ 
sendCompleteUtc
¼¼ $
,
¼¼$ %
int
½½ 
	sendCount
½½ 
)
½½ 
{
¾¾ 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M&
GetWriteConnectionString
¿¿M e
(
¿¿e f
)
¿¿f g
,
¿¿g h
$str¿¿i 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 0
,
ÀÀ0 1
	SqlDbType
ÀÀ2 ;
.
ÀÀ; <
UniqueIdentifier
ÀÀ< L
,
ÀÀL M 
ParameterDirection
ÀÀN `
.
ÀÀ` a
Input
ÀÀa f
,
ÀÀf g

letterGuid
ÀÀh r
)
ÀÀr s
;
ÀÀs t
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 5
,
ÁÁ5 6
	SqlDbType
ÁÁ7 @
.
ÁÁ@ A
DateTime
ÁÁA I
,
ÁÁI J 
ParameterDirection
ÁÁK ]
.
ÁÁ] ^
Input
ÁÁ^ c
,
ÁÁc d
sendCompleteUtc
ÁÁe t
)
ÁÁt u
;
ÁÁu v
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# /
,
ÂÂ/ 0
	SqlDbType
ÂÂ1 :
.
ÂÂ: ;
Int
ÂÂ; >
,
ÂÂ> ? 
ParameterDirection
ÂÂ@ R
.
ÂÂR S
Input
ÂÂS X
,
ÂÂX Y
	sendCount
ÂÂZ c
)
ÂÂc d
;
ÂÂd e
int
ÄÄ 
rowsAffected
ÄÄ 
=
ÄÄ 
sph
ÄÄ "
.
ÄÄ" #
ExecuteNonQuery
ÄÄ# 2
(
ÄÄ2 3
)
ÄÄ3 4
;
ÄÄ4 5
return
ÅÅ 
(
ÅÅ 
rowsAffected
ÅÅ  
>
ÅÅ! "
$num
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÆÆ 	
public
ÏÏ 
static
ÏÏ 
IDataReader
ÏÏ !
GetOne
ÏÏ" (
(
ÏÏ( )
Guid
ÏÏ) -

letterGuid
ÏÏ. 8
)
ÏÏ8 9
{
ÐÐ 	 
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M%
GetReadConnectionString
ÑÑM d
(
ÑÑd e
)
ÑÑe f
,
ÑÑf g
$str
ÑÑh }
,
ÑÑ} ~
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 0
,
ÒÒ0 1
	SqlDbType
ÒÒ2 ;
.
ÒÒ; <
UniqueIdentifier
ÒÒ< L
,
ÒÒL M 
ParameterDirection
ÒÒN `
.
ÒÒ` a
Input
ÒÒa f
,
ÒÒf g

letterGuid
ÒÒh r
)
ÒÒr s
;
ÒÒs t
return
ÓÓ 
sph
ÓÓ 
.
ÓÓ 
ExecuteReader
ÓÓ $
(
ÓÓ$ %
)
ÓÓ% &
;
ÓÓ& '
}
ÔÔ 	
public
ÙÙ 
static
ÙÙ 
int
ÙÙ 
GetCount
ÙÙ "
(
ÙÙ" #
Guid
ÙÙ# '
letterInfoGuid
ÙÙ( 6
)
ÙÙ6 7
{
ÚÚ 	 
SqlParameterHelper
ÜÜ 
sph
ÜÜ "
=
ÜÜ# $
new
ÜÜ% ( 
SqlParameterHelper
ÜÜ) ;
(
ÜÜ; <
ConnectionString
ÜÜ< L
.
ÜÜL M%
GetReadConnectionString
ÜÜM d
(
ÜÜd e
)
ÜÜe f
,
ÜÜf g
$str
ÜÜh |
,
ÜÜ| }
$num
ÜÜ~ 
)ÜÜ 
;ÜÜ 
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# 4
,
ÝÝ4 5
	SqlDbType
ÝÝ6 ?
.
ÝÝ? @
UniqueIdentifier
ÝÝ@ P
,
ÝÝP Q 
ParameterDirection
ÝÝR d
.
ÝÝd e
Input
ÝÝe j
,
ÝÝj k
letterInfoGuid
ÝÝl z
)
ÝÝz {
;
ÝÝ{ |
return
ÞÞ 
Convert
ÞÞ 
.
ÞÞ 
ToInt32
ÞÞ "
(
ÞÞ" #
sph
ÞÞ# &
.
ÞÞ& '
ExecuteScalar
ÞÞ' 4
(
ÞÞ4 5
)
ÞÞ5 6
)
ÞÞ6 7
;
ÞÞ7 8
}
áá 	
public
ææ 
static
ææ 
int
ææ 
GetCountOfDrafts
ææ *
(
ææ* +
Guid
ææ+ /
letterInfoGuid
ææ0 >
)
ææ> ?
{
çç 	 
SqlParameterHelper
éé 
sph
éé "
=
éé# $
new
éé% ( 
SqlParameterHelper
éé) ;
(
éé; <
ConnectionString
éé< L
.
ééL M%
GetReadConnectionString
ééM d
(
ééd e
)
éée f
,
ééf g
$strééh 
,éé 
$numéé 
)éé 
;éé 
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 4
,
êê4 5
	SqlDbType
êê6 ?
.
êê? @
UniqueIdentifier
êê@ P
,
êêP Q 
ParameterDirection
êêR d
.
êêd e
Input
êêe j
,
êêj k
letterInfoGuid
êêl z
)
êêz {
;
êê{ |
return
ëë 
Convert
ëë 
.
ëë 
ToInt32
ëë "
(
ëë" #
sph
ëë# &
.
ëë& '
ExecuteScalar
ëë' 4
(
ëë4 5
)
ëë5 6
)
ëë6 7
;
ëë7 8
}
îî 	
public
óó 
static
óó 
IDataReader
óó !
GetAll
óó" (
(
óó( )
Guid
óó) -
letterInfoGuid
óó. <
)
óó< =
{
ôô 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M%
GetReadConnectionString
ööM d
(
ööd e
)
ööe f
,
ööf g
$str
ööh }
,
öö} ~
$numöö 
)öö 
;öö 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# 4
,
÷÷4 5
	SqlDbType
÷÷6 ?
.
÷÷? @
UniqueIdentifier
÷÷@ P
,
÷÷P Q 
ParameterDirection
÷÷R d
.
÷÷d e
Input
÷÷e j
,
÷÷j k
letterInfoGuid
÷÷l z
)
÷÷z {
;
÷÷{ |
return
øø 
sph
øø 
.
øø 
ExecuteReader
øø $
(
øø$ %
)
øø% &
;
øø& '
}
üü 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
Guid
 
letterInfoGuid
 
,
  
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 
(
 
letterInfoGuid
 )
)
) *
;
* +
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h ~
,
~ 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 0
,
  0 1
	SqlDbType
  2 ;
.
  ; <
Int
  < ?
,
  ? @ 
ParameterDirection
  A S
.
  S T
Input
  T Y
,
  Y Z

pageNumber
  [ e
)
  e f
;
  f g
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# .
,
¡¡. /
	SqlDbType
¡¡0 9
.
¡¡9 :
Int
¡¡: =
,
¡¡= > 
ParameterDirection
¡¡? Q
.
¡¡Q R
Input
¡¡R W
,
¡¡W X
pageSize
¡¡Y a
)
¡¡a b
;
¡¡b c
return
¢¢ 
sph
¢¢ 
.
¢¢ 
ExecuteReader
¢¢ $
(
¢¢$ %
)
¢¢% &
;
¢¢& '
}
¤¤ 	
public
¬¬ 
static
¬¬ 
IDataReader
¬¬ !
	GetDrafts
¬¬" +
(
¬¬+ ,
Guid
­­ 
letterInfoGuid
­­ 
,
­­  
int
®® 

pageNumber
®® 
,
®® 
int
¯¯ 
pageSize
¯¯ 
,
¯¯ 
out
°° 
int
°° 

totalPages
°° 
)
°° 
{
±± 	

totalPages
²² 
=
²² 
$num
²² 
;
²² 
int
³³ 
	totalRows
³³ 
=
´´ 
GetCountOfDrafts
´´ "
(
´´" #
letterInfoGuid
´´# 1
)
´´1 2
;
´´2 3
if
¶¶ 
(
¶¶ 
pageSize
¶¶ 
>
¶¶ 
$num
¶¶ 
)
¶¶ 

totalPages
¶¶ (
=
¶¶) *
	totalRows
¶¶+ 4
/
¶¶5 6
pageSize
¶¶7 ?
;
¶¶? @
if
¸¸ 
(
¸¸ 
	totalRows
¸¸ 
<=
¸¸ 
pageSize
¸¸ %
)
¸¸% &
{
¹¹ 

totalPages
ºº 
=
ºº 
$num
ºº 
;
ºº 
}
»» 
else
¼¼ 
{
½½ 
int
¾¾ 
	remainder
¾¾ 
;
¾¾ 
Math
¿¿ 
.
¿¿ 
DivRem
¿¿ 
(
¿¿ 
	totalRows
¿¿ %
,
¿¿% &
pageSize
¿¿' /
,
¿¿/ 0
out
¿¿1 4
	remainder
¿¿5 >
)
¿¿> ?
;
¿¿? @
if
ÀÀ 
(
ÀÀ 
	remainder
ÀÀ 
>
ÀÀ 
$num
ÀÀ  !
)
ÀÀ! "
{
ÁÁ 

totalPages
ÂÂ 
+=
ÂÂ !
$num
ÂÂ" #
;
ÂÂ# $
}
ÃÃ 
}
ÄÄ  
SqlParameterHelper
ÆÆ 
sph
ÆÆ "
=
ÆÆ# $
new
ÆÆ% ( 
SqlParameterHelper
ÆÆ) ;
(
ÆÆ; <
ConnectionString
ÆÆ< L
.
ÆÆL M%
GetReadConnectionString
ÆÆM d
(
ÆÆd e
)
ÆÆe f
,
ÆÆf g
$strÆÆh 
,ÆÆ 
$numÆÆ 
)ÆÆ 
;ÆÆ 
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 4
,
ÇÇ4 5
	SqlDbType
ÇÇ6 ?
.
ÇÇ? @
UniqueIdentifier
ÇÇ@ P
,
ÇÇP Q 
ParameterDirection
ÇÇR d
.
ÇÇd e
Input
ÇÇe j
,
ÇÇj k
letterInfoGuid
ÇÇl z
)
ÇÇz {
;
ÇÇ{ |
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 0
,
ÈÈ0 1
	SqlDbType
ÈÈ2 ;
.
ÈÈ; <
Int
ÈÈ< ?
,
ÈÈ? @ 
ParameterDirection
ÈÈA S
.
ÈÈS T
Input
ÈÈT Y
,
ÈÈY Z

pageNumber
ÈÈ[ e
)
ÈÈe f
;
ÈÈf g
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# .
,
ÉÉ. /
	SqlDbType
ÉÉ0 9
.
ÉÉ9 :
Int
ÉÉ: =
,
ÉÉ= > 
ParameterDirection
ÉÉ? Q
.
ÉÉQ R
Input
ÉÉR W
,
ÉÉW X
pageSize
ÉÉY a
)
ÉÉa b
;
ÉÉb c
return
ÊÊ 
sph
ÊÊ 
.
ÊÊ 
ExecuteReader
ÊÊ $
(
ÊÊ$ %
)
ÊÊ% &
;
ÊÊ& '
}
ÌÌ 	
}
ÐÐ 
}ÑÑ æc
tD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterHtmlTemplate.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class  
DBLetterHtmlTemplate ,
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
guid%% 
,%% 
Guid&& 
siteGuid&& 
,&& 
string'' 
title'' 
,'' 
string(( 
html(( 
,(( 
DateTime)) 

lastModUTC)) 
)))  
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str	++i 
,
++ 
$num
++ 
)
++ 
;
++ 
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# .
,--. /
	SqlDbType--0 9
.--9 :
UniqueIdentifier--: J
,--J K
ParameterDirection--L ^
.--^ _
Input--_ d
,--d e
siteGuid--f n
)--n o
;--o p
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# +
,..+ ,
	SqlDbType..- 6
...6 7
NVarChar..7 ?
,..? @
$num..A D
,..D E
ParameterDirection..F X
...X Y
Input..Y ^
,..^ _
title..` e
)..e f
;..f g
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
NVarChar//6 >
,//> ?
-//@ A
$num//A B
,//B C
ParameterDirection//D V
.//V W
Input//W \
,//\ ]
html//^ b
)//b c
;//c d
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# 0
,000 1
	SqlDbType002 ;
.00; <
DateTime00< D
,00D E
ParameterDirection00F X
.00X Y
Input00Y ^
,00^ _

lastModUTC00` j
)00j k
;00k l
int11 
rowsAffected11 
=11 
sph11 "
.11" #
ExecuteNonQuery11# 2
(112 3
)113 4
;114 5
return22 
rowsAffected22 
;22  
}33 	
public>> 
static>> 
bool>> 
Update>> !
(>>! "
Guid?? 
guid?? 
,?? 
string@@ 
title@@ 
,@@ 
stringAA 
htmlAA 
,AA 
DateTimeBB 

lastModUTCBB 
)BB  
{CC 	
SqlParameterHelperDD 
sphDD "
=DD# $
newDD% (
SqlParameterHelperDD) ;
(DD; <
ConnectionStringDD< L
.DDL M$
GetWriteConnectionStringDDM e
(DDe f
)DDf g
,DDg h
$str	DDi 
,
DD 
$num
DD 
)
DD 
;
DD 
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# *
,EE* +
	SqlDbTypeEE, 5
.EE5 6
UniqueIdentifierEE6 F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
guidEEb f
)EEf g
;EEg h
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# +
,FF+ ,
	SqlDbTypeFF- 6
.FF6 7
NVarCharFF7 ?
,FF? @
$numFFA D
,FFD E
ParameterDirectionFFF X
.FFX Y
InputFFY ^
,FF^ _
titleFF` e
)FFe f
;FFf g
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# *
,GG* +
	SqlDbTypeGG, 5
.GG5 6
NVarCharGG6 >
,GG> ?
-GG@ A
$numGGA B
,GGB C
ParameterDirectionGGD V
.GGV W
InputGGW \
,GG\ ]
htmlGG^ b
)GGb c
;GGc d
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 0
,HH0 1
	SqlDbTypeHH2 ;
.HH; <
DateTimeHH< D
,HHD E
ParameterDirectionHHF X
.HHX Y
InputHHY ^
,HH^ _

lastModUTCHH` j
)HHj k
;HHk l
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}KK 	
publicRR 
staticRR 
boolRR 
DeleteRR !
(RR! "
GuidSS 
guidSS 
)SS 
{TT 	
SqlParameterHelperUU 
sphUU "
=UU# $
newUU% (
SqlParameterHelperUU) ;
(UU; <
ConnectionStringUU< L
.UUL M$
GetWriteConnectionStringUUM e
(UUe f
)UUf g
,UUg h
$str	UUi 
,
UU 
$num
UU 
)
UU 
;
UU 
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# *
,VV* +
	SqlDbTypeVV, 5
.VV5 6
UniqueIdentifierVV6 F
,VVF G
ParameterDirectionVVH Z
.VVZ [
InputVV[ `
,VV` a
guidVVb f
)VVf g
;VVg h
intWW 
rowsAffectedWW 
=WW 
sphWW "
.WW" #
ExecuteNonQueryWW# 2
(WW2 3
)WW3 4
;WW4 5
returnXX 
(XX 
rowsAffectedXX  
>XX! "
$numXX# $
)XX$ %
;XX% &
}ZZ 	
public`` 
static`` 
IDataReader`` !
GetOne``" (
(``( )
Guidaa 
guidaa 
)aa 
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M#
GetReadConnectionStringccM d
(ccd e
)cce f
,ccf g
$str	cch 
,
cc 
$num
cc 
)
cc 
;
cc 
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# *
,dd* +
	SqlDbTypedd, 5
.dd5 6
UniqueIdentifierdd6 F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
guidddb f
)ddf g
;ddg h
returnee 
sphee 
.ee 
ExecuteReaderee $
(ee$ %
)ee% &
;ee& '
}ff 	
publickk 
statickk 
intkk 
GetCountkk "
(kk" #
Guidkk# '
siteGuidkk( 0
)kk0 1
{ll 	
SqlParameterHelpernn 
sphnn "
=nn# $
newnn% (
SqlParameterHelpernn) ;
(nn; <
ConnectionStringnn< L
.nnL M#
GetReadConnectionStringnnM d
(nnd e
)nne f
,nnf g
$str	nnh 
,
nn 
$num
nn 
)
nn 
;
nn 
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# .
,oo. /
	SqlDbTypeoo0 9
.oo9 :
UniqueIdentifieroo: J
,ooJ K
ParameterDirectionooL ^
.oo^ _
Inputoo_ d
,ood e
siteGuidoof n
)oon o
;ooo p
returnpp 
Convertpp 
.pp 
ToInt32pp "
(pp" #
sphpp# &
.pp& '
ExecuteScalarpp' 4
(pp4 5
)pp5 6
)pp6 7
;pp7 8
}ss 	
publicxx 
staticxx 
IDataReaderxx !
GetAllxx" (
(xx( )
Guidxx) -
siteGuidxx. 6
)xx6 7
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh 
,
zz 
$num
zz 
)
zz 
;
zz 
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# .
,{{. /
	SqlDbType{{0 9
.{{9 :
UniqueIdentifier{{: J
,{{J K
ParameterDirection{{L ^
.{{^ _
Input{{_ d
,{{d e
siteGuid{{f n
){{n o
;{{o p
return|| 
sph|| 
.|| 
ExecuteReader|| $
(||$ %
)||% &
;||& '
}
 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
Guid
 
siteGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 
(
 
siteGuid
 #
)
# $
;
$ %
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
    
SqlParameterHelper
¢¢ 
sph
¢¢ "
=
¢¢# $
new
¢¢% ( 
SqlParameterHelper
¢¢) ;
(
¢¢; <
ConnectionString
¢¢< L
.
¢¢L M%
GetReadConnectionString
¢¢M d
(
¢¢d e
)
¢¢e f
,
¢¢f g
$str¢¢h 
,¢¢ 
$num¢¢ 
)¢¢ 
;¢¢ 
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# .
,
££. /
	SqlDbType
££0 9
.
££9 :
UniqueIdentifier
££: J
,
££J K 
ParameterDirection
££L ^
.
££^ _
Input
££_ d
,
££d e
siteGuid
££f n
)
££n o
;
££o p
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 0
,
¤¤0 1
	SqlDbType
¤¤2 ;
.
¤¤; <
Int
¤¤< ?
,
¤¤? @ 
ParameterDirection
¤¤A S
.
¤¤S T
Input
¤¤T Y
,
¤¤Y Z

pageNumber
¤¤[ e
)
¤¤e f
;
¤¤f g
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# .
,
¥¥. /
	SqlDbType
¥¥0 9
.
¥¥9 :
Int
¥¥: =
,
¥¥= > 
ParameterDirection
¥¥? Q
.
¥¥Q R
Input
¥¥R W
,
¥¥W X
pageSize
¥¥Y a
)
¥¥a b
;
¥¥b c
return
¦¦ 
sph
¦¦ 
.
¦¦ 
ExecuteReader
¦¦ $
(
¦¦$ %
)
¦¦% &
;
¦¦& '
}
¨¨ 	
}
ªª 
}¬¬ 
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterInfo.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetterInfo $
{ 
public55 
static55 
int55 
Create55  
(55  !
Guid66 
letterInfoGuid66 
,66  
Guid77 
siteGuid77 
,77 
string88 
title88 
,88 
string99 
description99 
,99 
string:: 
availableToRoles:: #
,::# $
bool;; 
enabled;; 
,;; 
bool<< 
allowUserFeedback<< "
,<<" #
bool== 
allowAnonFeedback== "
,==" #
string>> 
fromAddress>> 
,>> 
string?? 
fromName?? 
,?? 
string@@ 
replyToAddress@@ !
,@@! "
intAA 
sendModeAA 
,AA 
boolBB 
enableViewAsWebPageBB $
,BB$ %
boolCC 
enableSendLogCC 
,CC 
stringDD 
rolesThatCanEditDD #
,DD# $
stringEE 
rolesThatCanApproveEE &
,EE& '
stringFF 
rolesThatCanSendFF #
,FF# $
DateTimeGG 

createdUtcGG 
,GG  
GuidHH 
	createdByHH 
,HH 
DateTimeII 

lastModUtcII 
,II  
GuidJJ 
	lastModByJJ 
,JJ 
boolKK 
allowArchiveViewKK !
,KK! "
boolLL 
profileOptInLL 
,LL 
intMM 
sortRankMM 
,MM 
stringNN 
displayNameDefaultNN %
,NN% &
stringOO 
firstNameDefaultOO #
,OO# $
stringPP 
lastNameDefaultPP "
)PP" #
{QQ 	
SqlParameterHelperRR 
sphRR "
=RR# $
newRR% (
SqlParameterHelperRR) ;
(RR; <
ConnectionStringRR< L
.RRL M$
GetWriteConnectionStringRRM e
(RRe f
)RRf g
,RRg h
$strRRi 
,	RR 
$num
RR 
)
RR 
;
RR 
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 4
,SS4 5
	SqlDbTypeSS6 ?
.SS? @
UniqueIdentifierSS@ P
,SSP Q
ParameterDirectionSSR d
.SSd e
InputSSe j
,SSj k
letterInfoGuidSSl z
)SSz {
;SS{ |
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
siteGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# +
,UU+ ,
	SqlDbTypeUU- 6
.UU6 7
NVarCharUU7 ?
,UU? @
$numUUA D
,UUD E
ParameterDirectionUUF X
.UUX Y
InputUUY ^
,UU^ _
titleUU` e
)UUe f
;UUf g
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 1
,VV1 2
	SqlDbTypeVV3 <
.VV< =
NVarCharVV= E
,VVE F
-VVG H
$numVVH I
,VVI J
ParameterDirectionVVK ]
.VV] ^
InputVV^ c
,VVc d
descriptionVVe p
)VVp q
;VVq r
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 6
,WW6 7
	SqlDbTypeWW8 A
.WWA B
NVarCharWWB J
,WWJ K
-WWL M
$numWWM N
,WWN O
ParameterDirectionWWP b
.WWb c
InputWWc h
,WWh i
availableToRolesWWj z
)WWz {
;WW{ |
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
BitXX9 <
,XX< =
ParameterDirectionXX> P
.XXP Q
InputXXQ V
,XXV W
enabledXXX _
)XX_ `
;XX` a
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 7
,YY7 8
	SqlDbTypeYY9 B
.YYB C
BitYYC F
,YYF G
ParameterDirectionYYH Z
.YYZ [
InputYY[ `
,YY` a
allowUserFeedbackYYb s
)YYs t
;YYt u
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 7
,ZZ7 8
	SqlDbTypeZZ9 B
.ZZB C
BitZZC F
,ZZF G
ParameterDirectionZZH Z
.ZZZ [
InputZZ[ `
,ZZ` a
allowAnonFeedbackZZb s
)ZZs t
;ZZt u
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 1
,[[1 2
	SqlDbType[[3 <
.[[< =
NVarChar[[= E
,[[E F
$num[[G J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
fromAddress[[f q
)[[q r
;[[r s
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
NVarChar\\: B
,\\B C
$num\\D G
,\\G H
ParameterDirection\\I [
.\\[ \
Input\\\ a
,\\a b
fromName\\c k
)\\k l
;\\l m
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 4
,]]4 5
	SqlDbType]]6 ?
.]]? @
NVarChar]]@ H
,]]H I
$num]]J M
,]]M N
ParameterDirection]]O a
.]]a b
Input]]b g
,]]g h
replyToAddress]]i w
)]]w x
;]]x y
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
Int^^: =
,^^= >
ParameterDirection^^? Q
.^^Q R
Input^^R W
,^^W X
sendMode^^Y a
)^^a b
;^^b c
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 9
,__9 :
	SqlDbType__; D
.__D E
Bit__E H
,__H I
ParameterDirection__J \
.__\ ]
Input__] b
,__b c
enableViewAsWebPage__d w
)__w x
;__x y
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 3
,``3 4
	SqlDbType``5 >
.``> ?
Bit``? B
,``B C
ParameterDirection``D V
.``V W
Input``W \
,``\ ]
enableSendLog``^ k
)``k l
;``l m
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 6
,aa6 7
	SqlDbTypeaa8 A
.aaA B
NVarCharaaB J
,aaJ K
-aaL M
$numaaM N
,aaN O
ParameterDirectionaaP b
.aab c
Inputaac h
,aah i
rolesThatCanEditaaj z
)aaz {
;aa{ |
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 9
,bb9 :
	SqlDbTypebb; D
.bbD E
NVarCharbbE M
,bbM N
-bbO P
$numbbP Q
,bbQ R
ParameterDirectionbbS e
.bbe f
Inputbbf k
,bbk l 
rolesThatCanApprove	bbm 
)
bb 
;
bb 
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 6
,cc6 7
	SqlDbTypecc8 A
.ccA B
NVarCharccB J
,ccJ K
-ccL M
$numccM N
,ccN O
ParameterDirectionccP b
.ccb c
Inputccc h
,cch i
rolesThatCanSendccj z
)ccz {
;cc{ |
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 0
,dd0 1
	SqlDbTypedd2 ;
.dd; <
DateTimedd< D
,ddD E
ParameterDirectionddF X
.ddX Y
InputddY ^
,dd^ _

createdUtcdd` j
)ddj k
;ddk l
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# /
,ee/ 0
	SqlDbTypeee1 :
.ee: ;
UniqueIdentifieree; K
,eeK L
ParameterDirectioneeM _
.ee_ `
Inputee` e
,eee f
	createdByeeg p
)eep q
;eeq r
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 0
,ff0 1
	SqlDbTypeff2 ;
.ff; <
DateTimeff< D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _

lastModUtcff` j
)ffj k
;ffk l
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# /
,gg/ 0
	SqlDbTypegg1 :
.gg: ;
UniqueIdentifiergg; K
,ggK L
ParameterDirectionggM _
.gg_ `
Inputgg` e
,gge f
	lastModByggg p
)ggp q
;ggq r
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 6
,ii6 7
	SqlDbTypeii8 A
.iiA B
BitiiB E
,iiE F
ParameterDirectioniiG Y
.iiY Z
InputiiZ _
,ii_ `
allowArchiveViewiia q
)iiq r
;iir s
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 2
,jj2 3
	SqlDbTypejj4 =
.jj= >
Bitjj> A
,jjA B
ParameterDirectionjjC U
.jjU V
InputjjV [
,jj[ \
profileOptInjj] i
)jji j
;jjj k
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# .
,kk. /
	SqlDbTypekk0 9
.kk9 :
Intkk: =
,kk= >
ParameterDirectionkk? Q
.kkQ R
InputkkR W
,kkW X
sortRankkkY a
)kka b
;kkb c
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 8
,mm8 9
	SqlDbTypemm: C
.mmC D
NVarCharmmD L
,mmL M
$nummmN P
,mmP Q
ParameterDirectionmmR d
.mmd e
Inputmme j
,mmj k
displayNameDefaultmml ~
)mm~ 
;	mm 
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 6
,nn6 7
	SqlDbTypenn8 A
.nnA B
NVarCharnnB J
,nnJ K
$numnnL N
,nnN O
ParameterDirectionnnP b
.nnb c
Inputnnc h
,nnh i
firstNameDefaultnnj z
)nnz {
;nn{ |
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 5
,oo5 6
	SqlDbTypeoo7 @
.oo@ A
NVarCharooA I
,ooI J
$numooK M
,ooM N
ParameterDirectionooO a
.ooa b
Inputoob g
,oog h
lastNameDefaultooi x
)oox y
;ooy z
intrr 
rowsAffectedrr 
=rr 
sphrr "
.rr" #
ExecuteNonQueryrr# 2
(rr2 3
)rr3 4
;rr4 5
returnss 
rowsAffectedss 
;ss  
}tt 	
public
 
static
 
bool
 
Update
 !
(
! "
Guid
 
letterInfoGuid
 
,
  
Guid
 
siteGuid
 
,
 
string
 
title
 
,
 
string
 
description
 
,
 
string
 
availableToRoles
 #
,
# $
bool
 
enabled
 
,
 
bool
 
allowUserFeedback
 "
,
" #
bool
 
allowAnonFeedback
 "
,
" #
string
 
fromAddress
 
,
 
string
 
fromName
 
,
 
string
 
replyToAddress
 !
,
! "
int
 
sendMode
 
,
 
bool
 !
enableViewAsWebPage
 $
,
$ %
bool
 
enableSendLog
 
,
 
string
 
rolesThatCanEdit
 #
,
# $
string
   !
rolesThatCanApprove
   &
,
  & '
string
¡¡ 
rolesThatCanSend
¡¡ #
,
¡¡# $
DateTime
¢¢ 

createdUtc
¢¢ 
,
¢¢  
Guid
££ 
	createdBy
££ 
,
££ 
DateTime
¤¤ 

lastModUtc
¤¤ 
,
¤¤  
Guid
¥¥ 
	lastModBy
¥¥ 
,
¥¥ 
bool
¦¦ 
allowArchiveView
¦¦ !
,
¦¦! "
bool
§§ 
profileOptIn
§§ 
,
§§ 
int
¨¨ 
sortRank
¨¨ 
,
¨¨ 
string
©©  
displayNameDefault
©© %
,
©©% &
string
ªª 
firstNameDefault
ªª #
,
ªª# $
string
«« 
lastNameDefault
«« "
)
««" #
{
¬¬ 	 
SqlParameterHelper
­­ 
sph
­­ "
=
­­# $
new
­­% ( 
SqlParameterHelper
­­) ;
(
­­; <
ConnectionString
­­< L
.
­­L M&
GetWriteConnectionString
­­M e
(
­­e f
)
­­f g
,
­­g h
$str
­­i 
,­­ 
$num­­ 
)­­ 
;­­ 
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# 4
,
®®4 5
	SqlDbType
®®6 ?
.
®®? @
UniqueIdentifier
®®@ P
,
®®P Q 
ParameterDirection
®®R d
.
®®d e
Input
®®e j
,
®®j k
letterInfoGuid
®®l z
)
®®z {
;
®®{ |
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
UniqueIdentifier
¯¯: J
,
¯¯J K 
ParameterDirection
¯¯L ^
.
¯¯^ _
Input
¯¯_ d
,
¯¯d e
siteGuid
¯¯f n
)
¯¯n o
;
¯¯o p
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# +
,
°°+ ,
	SqlDbType
°°- 6
.
°°6 7
NVarChar
°°7 ?
,
°°? @
$num
°°A D
,
°°D E 
ParameterDirection
°°F X
.
°°X Y
Input
°°Y ^
,
°°^ _
title
°°` e
)
°°e f
;
°°f g
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# 1
,
±±1 2
	SqlDbType
±±3 <
.
±±< =
NVarChar
±±= E
,
±±E F
-
±±G H
$num
±±H I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d
description
±±e p
)
±±p q
;
±±q r
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# 6
,
²²6 7
	SqlDbType
²²8 A
.
²²A B
NVarChar
²²B J
,
²²J K
-
²²L M
$num
²²M N
,
²²N O 
ParameterDirection
²²P b
.
²²b c
Input
²²c h
,
²²h i
availableToRoles
²²j z
)
²²z {
;
²²{ |
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# -
,
³³- .
	SqlDbType
³³/ 8
.
³³8 9
Bit
³³9 <
,
³³< = 
ParameterDirection
³³> P
.
³³P Q
Input
³³Q V
,
³³V W
enabled
³³X _
)
³³_ `
;
³³` a
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 7
,
´´7 8
	SqlDbType
´´9 B
.
´´B C
Bit
´´C F
,
´´F G 
ParameterDirection
´´H Z
.
´´Z [
Input
´´[ `
,
´´` a
allowUserFeedback
´´b s
)
´´s t
;
´´t u
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 7
,
µµ7 8
	SqlDbType
µµ9 B
.
µµB C
Bit
µµC F
,
µµF G 
ParameterDirection
µµH Z
.
µµZ [
Input
µµ[ `
,
µµ` a
allowAnonFeedback
µµb s
)
µµs t
;
µµt u
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# 1
,
¶¶1 2
	SqlDbType
¶¶3 <
.
¶¶< =
NVarChar
¶¶= E
,
¶¶E F
$num
¶¶G J
,
¶¶J K 
ParameterDirection
¶¶L ^
.
¶¶^ _
Input
¶¶_ d
,
¶¶d e
fromAddress
¶¶f q
)
¶¶q r
;
¶¶r s
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# .
,
··. /
	SqlDbType
··0 9
.
··9 :
NVarChar
··: B
,
··B C
$num
··D G
,
··G H 
ParameterDirection
··I [
.
··[ \
Input
··\ a
,
··a b
fromName
··c k
)
··k l
;
··l m
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 4
,
¸¸4 5
	SqlDbType
¸¸6 ?
.
¸¸? @
NVarChar
¸¸@ H
,
¸¸H I
$num
¸¸J M
,
¸¸M N 
ParameterDirection
¸¸O a
.
¸¸a b
Input
¸¸b g
,
¸¸g h
replyToAddress
¸¸i w
)
¸¸w x
;
¸¸x y
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# .
,
¹¹. /
	SqlDbType
¹¹0 9
.
¹¹9 :
Int
¹¹: =
,
¹¹= > 
ParameterDirection
¹¹? Q
.
¹¹Q R
Input
¹¹R W
,
¹¹W X
sendMode
¹¹Y a
)
¹¹a b
;
¹¹b c
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 9
,
ºº9 :
	SqlDbType
ºº; D
.
ººD E
Bit
ººE H
,
ººH I 
ParameterDirection
ººJ \
.
ºº\ ]
Input
ºº] b
,
ººb c!
enableViewAsWebPage
ººd w
)
ººw x
;
ººx y
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 3
,
»»3 4
	SqlDbType
»»5 >
.
»»> ?
Bit
»»? B
,
»»B C 
ParameterDirection
»»D V
.
»»V W
Input
»»W \
,
»»\ ]
enableSendLog
»»^ k
)
»»k l
;
»»l m
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# 6
,
¼¼6 7
	SqlDbType
¼¼8 A
.
¼¼A B
NVarChar
¼¼B J
,
¼¼J K
-
¼¼L M
$num
¼¼M N
,
¼¼N O 
ParameterDirection
¼¼P b
.
¼¼b c
Input
¼¼c h
,
¼¼h i
rolesThatCanEdit
¼¼j z
)
¼¼z {
;
¼¼{ |
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# 9
,
½½9 :
	SqlDbType
½½; D
.
½½D E
NVarChar
½½E M
,
½½M N
-
½½O P
$num
½½P Q
,
½½Q R 
ParameterDirection
½½S e
.
½½e f
Input
½½f k
,
½½k l"
rolesThatCanApprove½½m 
)½½ 
;½½ 
sph
¾¾ 
.
¾¾  
DefineSqlParameter
¾¾ "
(
¾¾" #
$str
¾¾# 6
,
¾¾6 7
	SqlDbType
¾¾8 A
.
¾¾A B
NVarChar
¾¾B J
,
¾¾J K
-
¾¾L M
$num
¾¾M N
,
¾¾N O 
ParameterDirection
¾¾P b
.
¾¾b c
Input
¾¾c h
,
¾¾h i
rolesThatCanSend
¾¾j z
)
¾¾z {
;
¾¾{ |
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# 0
,
¿¿0 1
	SqlDbType
¿¿2 ;
.
¿¿; <
DateTime
¿¿< D
,
¿¿D E 
ParameterDirection
¿¿F X
.
¿¿X Y
Input
¿¿Y ^
,
¿¿^ _

createdUtc
¿¿` j
)
¿¿j k
;
¿¿k l
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# /
,
ÀÀ/ 0
	SqlDbType
ÀÀ1 :
.
ÀÀ: ;
UniqueIdentifier
ÀÀ; K
,
ÀÀK L 
ParameterDirection
ÀÀM _
.
ÀÀ_ `
Input
ÀÀ` e
,
ÀÀe f
	createdBy
ÀÀg p
)
ÀÀp q
;
ÀÀq r
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 0
,
ÁÁ0 1
	SqlDbType
ÁÁ2 ;
.
ÁÁ; <
DateTime
ÁÁ< D
,
ÁÁD E 
ParameterDirection
ÁÁF X
.
ÁÁX Y
Input
ÁÁY ^
,
ÁÁ^ _

lastModUtc
ÁÁ` j
)
ÁÁj k
;
ÁÁk l
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# /
,
ÂÂ/ 0
	SqlDbType
ÂÂ1 :
.
ÂÂ: ;
UniqueIdentifier
ÂÂ; K
,
ÂÂK L 
ParameterDirection
ÂÂM _
.
ÂÂ_ `
Input
ÂÂ` e
,
ÂÂe f
	lastModBy
ÂÂg p
)
ÂÂp q
;
ÂÂq r
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# 6
,
ÄÄ6 7
	SqlDbType
ÄÄ8 A
.
ÄÄA B
Bit
ÄÄB E
,
ÄÄE F 
ParameterDirection
ÄÄG Y
.
ÄÄY Z
Input
ÄÄZ _
,
ÄÄ_ `
allowArchiveView
ÄÄa q
)
ÄÄq r
;
ÄÄr s
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 2
,
ÅÅ2 3
	SqlDbType
ÅÅ4 =
.
ÅÅ= >
Bit
ÅÅ> A
,
ÅÅA B 
ParameterDirection
ÅÅC U
.
ÅÅU V
Input
ÅÅV [
,
ÅÅ[ \
profileOptIn
ÅÅ] i
)
ÅÅi j
;
ÅÅj k
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# .
,
ÆÆ. /
	SqlDbType
ÆÆ0 9
.
ÆÆ9 :
Int
ÆÆ: =
,
ÆÆ= > 
ParameterDirection
ÆÆ? Q
.
ÆÆQ R
Input
ÆÆR W
,
ÆÆW X
sortRank
ÆÆY a
)
ÆÆa b
;
ÆÆb c
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# 8
,
ÈÈ8 9
	SqlDbType
ÈÈ: C
.
ÈÈC D
NVarChar
ÈÈD L
,
ÈÈL M
$num
ÈÈN P
,
ÈÈP Q 
ParameterDirection
ÈÈR d
.
ÈÈd e
Input
ÈÈe j
,
ÈÈj k 
displayNameDefault
ÈÈl ~
)
ÈÈ~ 
;ÈÈ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 6
,
ÉÉ6 7
	SqlDbType
ÉÉ8 A
.
ÉÉA B
NVarChar
ÉÉB J
,
ÉÉJ K
$num
ÉÉL N
,
ÉÉN O 
ParameterDirection
ÉÉP b
.
ÉÉb c
Input
ÉÉc h
,
ÉÉh i
firstNameDefault
ÉÉj z
)
ÉÉz {
;
ÉÉ{ |
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 5
,
ÊÊ5 6
	SqlDbType
ÊÊ7 @
.
ÊÊ@ A
NVarChar
ÊÊA I
,
ÊÊI J
$num
ÊÊK M
,
ÊÊM N 
ParameterDirection
ÊÊO a
.
ÊÊa b
Input
ÊÊb g
,
ÊÊg h
lastNameDefault
ÊÊi x
)
ÊÊx y
;
ÊÊy z
int
ÌÌ 
rowsAffected
ÌÌ 
=
ÌÌ 
sph
ÌÌ "
.
ÌÌ" #
ExecuteNonQuery
ÌÌ# 2
(
ÌÌ2 3
)
ÌÌ3 4
;
ÌÌ4 5
return
ÍÍ 
(
ÍÍ 
rowsAffected
ÍÍ  
>
ÍÍ! "
$num
ÍÍ# $
)
ÍÍ$ %
;
ÍÍ% &
}
ÎÎ 	
public
ÕÕ 
static
ÕÕ 
bool
ÕÕ #
UpdateSubscriberCount
ÕÕ 0
(
ÕÕ0 1
Guid
ÕÕ1 5
letterInfoGuid
ÕÕ6 D
)
ÕÕD E
{
ÖÖ 	 
SqlParameterHelper
×× 
sph
×× "
=
××# $
new
××% ( 
SqlParameterHelper
××) ;
(
××; <
ConnectionString
××< L
.
××L M&
GetWriteConnectionString
××M e
(
××e f
)
××f g
,
××g h
$str××i 
,×× 
$num×× 
)×× 
;×× 
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 4
,
ØØ4 5
	SqlDbType
ØØ6 ?
.
ØØ? @
UniqueIdentifier
ØØ@ P
,
ØØP Q 
ParameterDirection
ØØR d
.
ØØd e
Input
ØØe j
,
ØØj k
letterInfoGuid
ØØl z
)
ØØz {
;
ØØ{ |
int
ÙÙ 
rowsAffected
ÙÙ 
=
ÙÙ 
sph
ÙÙ "
.
ÙÙ" #
ExecuteNonQuery
ÙÙ# 2
(
ÙÙ2 3
)
ÙÙ3 4
;
ÙÙ4 5
return
ÚÚ 
(
ÚÚ 
rowsAffected
ÚÚ  
>
ÚÚ! "
$num
ÚÚ# $
)
ÚÚ$ %
;
ÚÚ% &
}
ÛÛ 	
public
ââ 
static
ââ 
bool
ââ 
Delete
ââ !
(
ââ! "
Guid
ãã 
letterInfoGuid
ãã 
)
ãã  
{
ää 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M&
GetWriteConnectionString
ååM e
(
ååe f
)
ååf g
,
ååg h
$str
ååi 
,åå 
$numåå 
)åå 
;åå 
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 4
,
ææ4 5
	SqlDbType
ææ6 ?
.
ææ? @
UniqueIdentifier
ææ@ P
,
ææP Q 
ParameterDirection
ææR d
.
ææd e
Input
ææe j
,
ææj k
letterInfoGuid
ææl z
)
ææz {
;
ææ{ |
int
çç 
rowsAffected
çç 
=
çç 
sph
çç "
.
çç" #
ExecuteNonQuery
çç# 2
(
çç2 3
)
çç3 4
;
çç4 5
return
èè 
(
èè 
rowsAffected
èè  
>
èè! "
$num
èè# $
)
èè$ %
;
èè% &
}
êê 	
public
ññ 
static
ññ 
IDataReader
ññ !
GetOne
ññ" (
(
ññ( )
Guid
òò 
letterInfoGuid
òò 
)
òò  
{
óó 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M%
GetReadConnectionString
ôôM d
(
ôôd e
)
ôôe f
,
ôôf g
$strôôh 
,ôô 
$numôô 
)ôô 
;ôô 
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# 4
,
õõ4 5
	SqlDbType
õõ6 ?
.
õõ? @
UniqueIdentifier
õõ@ P
,
õõP Q 
ParameterDirection
õõR d
.
õõd e
Input
õõe j
,
õõj k
letterInfoGuid
õõl z
)
õõz {
;
õõ{ |
return
öö 
sph
öö 
.
öö 
ExecuteReader
öö $
(
öö$ %
)
öö% &
;
öö& '
}
÷÷ 	
public
üü 
static
üü 
int
üü 
GetCount
üü "
(
üü" #
Guid
üü# '
siteGuid
üü( 0
)
üü0 1
{
ýý 	 
SqlParameterHelper
þþ 
sph
þþ "
=
þþ# $
new
þþ% ( 
SqlParameterHelper
þþ) ;
(
þþ; <
ConnectionString
þþ< L
.
þþL M%
GetReadConnectionString
þþM d
(
þþd e
)
þþe f
,
þþf g
$strþþh 
,þþ 
$numþþ 
)þþ 
;þþ 
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# .
,
ÿÿ. /
	SqlDbType
ÿÿ0 9
.
ÿÿ9 :
UniqueIdentifier
ÿÿ: J
,
ÿÿJ K 
ParameterDirection
ÿÿL ^
.
ÿÿ^ _
Input
ÿÿ_ d
,
ÿÿd e
siteGuid
ÿÿf n
)
ÿÿn o
;
ÿÿo p
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !
GetAll
" (
(
( )
Guid
) -
siteGuid
. 6
)
6 7
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetPage
" )
(
) *
Guid
 
siteGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 
(
 
siteGuid
 #
)
# $
;
$ %
if
   
(
   
pageSize
   
>
   
$num
   
)
   

totalPages
   (
=
  ) *
	totalRows
  + 4
/
  5 6
pageSize
  7 ?
;
  ? @
if
¢¢ 
(
¢¢ 
	totalRows
¢¢ 
<=
¢¢ 
pageSize
¢¢ %
)
¢¢% &
{
££ 

totalPages
¤¤ 
=
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
else
¦¦ 
{
§§ 
int
¨¨ 
	remainder
¨¨ 
;
¨¨ 
Math
©© 
.
©© 
DivRem
©© 
(
©© 
	totalRows
©© %
,
©©% &
pageSize
©©' /
,
©©/ 0
out
©©1 4
	remainder
©©5 >
)
©©> ?
;
©©? @
if
ªª 
(
ªª 
	remainder
ªª 
>
ªª 
$num
ªª  !
)
ªª! "
{
«« 

totalPages
¬¬ 
+=
¬¬ !
$num
¬¬" #
;
¬¬# $
}
­­ 
}
®®  
SqlParameterHelper
°° 
sph
°° "
=
°°# $
new
°°% ( 
SqlParameterHelper
°°) ;
(
°°; <
ConnectionString
°°< L
.
°°L M%
GetReadConnectionString
°°M d
(
°°d e
)
°°e f
,
°°f g
$str°°h 
,°° 
$num°° 
)°° 
;°° 
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
UniqueIdentifier
±±: J
,
±±J K 
ParameterDirection
±±L ^
.
±±^ _
Input
±±_ d
,
±±d e
siteGuid
±±f n
)
±±n o
;
±±o p
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# 0
,
²²0 1
	SqlDbType
²²2 ;
.
²²; <
Int
²²< ?
,
²²? @ 
ParameterDirection
²²A S
.
²²S T
Input
²²T Y
,
²²Y Z

pageNumber
²²[ e
)
²²e f
;
²²f g
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# .
,
³³. /
	SqlDbType
³³0 9
.
³³9 :
Int
³³: =
,
³³= > 
ParameterDirection
³³? Q
.
³³Q R
Input
³³R W
,
³³W X
pageSize
³³Y a
)
³³a b
;
³³b c
return
´´ 
sph
´´ 
.
´´ 
ExecuteReader
´´ $
(
´´$ %
)
´´% &
;
´´& '
}
¶¶ 	
}
¹¹ 
}ºº û
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterSendLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBLetterSendLog '
{ 
public'' 
static'' 
int'' 
Create''  
(''  !
Guid(( 

letterGuid(( 
,(( 
Guid)) 
userGuid)) 
,)) 
Guid** 
subscribeGuid** 
,** 
string++ 
emailAddress++ 
,++  
DateTime,, 
uTC,, 
,,, 
bool-- 
errorOccurred-- 
,-- 
string.. 
errorMessage.. 
)..  
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i 
,
00 
$num
00 
)
00 
;
00 
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
UniqueIdentifier11< L
,11L M
ParameterDirection11N `
.11` a
Input11a f
,11f g

letterGuid11h r
)11r s
;11s t
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
userGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 3
,333 4
	SqlDbType335 >
.33> ?
UniqueIdentifier33? O
,33O P
ParameterDirection33Q c
.33c d
Input33d i
,33i j
subscribeGuid33k x
)33x y
;33y z
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 2
,442 3
	SqlDbType444 =
.44= >
NVarChar44> F
,44F G
$num44H K
,44K L
ParameterDirection44M _
.44_ `
Input44` e
,44e f
emailAddress44g s
)44s t
;44t u
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# )
,55) *
	SqlDbType55+ 4
.554 5
DateTime555 =
,55= >
ParameterDirection55? Q
.55Q R
Input55R W
,55W X
uTC55Y \
)55\ ]
;55] ^
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 3
,663 4
	SqlDbType665 >
.66> ?
Bit66? B
,66B C
ParameterDirection66D V
.66V W
Input66W \
,66\ ]
errorOccurred66^ k
)66k l
;66l m
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 2
,772 3
	SqlDbType774 =
.77= >
NVarChar77> F
,77F G
-77H I
$num77I J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
errorMessage77f r
)77r s
;77s t
int88 
newID88 
=88 
Convert88 
.88  
ToInt3288  '
(88' (
sph88( +
.88+ ,
ExecuteScalar88, 9
(889 :
)88: ;
)88; <
;88< =
return99 
newID99 
;99 
}:: 	
publicHH 
staticHH 
boolHH 
UpdateHH !
(HH! "
intII 
rowIdII 
,II 
GuidJJ 

letterGuidJJ 
,JJ 
GuidKK 
userGuidKK 
,KK 
stringLL 
emailAddressLL 
,LL  
DateTimeMM 
uTCMM 
,MM 
boolNN 
errorOccurredNN 
,NN 
stringOO 
errorMessageOO 
)OO  
{PP 	
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h
$str	QQi 
,
QQ 
$num
QQ 
)
QQ 
;
QQ 
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# +
,RR+ ,
	SqlDbTypeRR- 6
.RR6 7
IntRR7 :
,RR: ;
ParameterDirectionRR< N
.RRN O
InputRRO T
,RRT U
rowIdRRV [
)RR[ \
;RR\ ]
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 0
,SS0 1
	SqlDbTypeSS2 ;
.SS; <
UniqueIdentifierSS< L
,SSL M
ParameterDirectionSSN `
.SS` a
InputSSa f
,SSf g

letterGuidSSh r
)SSr s
;SSs t
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
userGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NVarCharUU> F
,UUF G
$numUUH K
,UUK L
ParameterDirectionUUM _
.UU_ `
InputUU` e
,UUe f
emailAddressUUg s
)UUs t
;UUt u
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# )
,VV) *
	SqlDbTypeVV+ 4
.VV4 5
DateTimeVV5 =
,VV= >
ParameterDirectionVV? Q
.VVQ R
InputVVR W
,VVW X
uTCVVY \
)VV\ ]
;VV] ^
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 3
,WW3 4
	SqlDbTypeWW5 >
.WW> ?
BitWW? B
,WWB C
ParameterDirectionWWD V
.WWV W
InputWWW \
,WW\ ]
errorOccurredWW^ k
)WWk l
;WWl m
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 2
,XX2 3
	SqlDbTypeXX4 =
.XX= >
NVarCharXX> F
,XXF G
-XXH I
$numXXI J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
errorMessageXXf r
)XXr s
;XXs t
intYY 
rowsAffectedYY 
=YY 
sphYY "
.YY" #
ExecuteNonQueryYY# 2
(YY2 3
)YY3 4
;YY4 5
returnZZ 
(ZZ 
rowsAffectedZZ  
>ZZ! "
$numZZ# $
)ZZ$ %
;ZZ% &
}[[ 	
publicbb 
staticbb 
boolbb 
Deletebb !
(bb! "
intbb" %
rowIdbb& +
)bb+ ,
{cc 	
SqlParameterHelperdd 
sphdd "
=dd# $
newdd% (
SqlParameterHelperdd) ;
(dd; <
ConnectionStringdd< L
.ddL M$
GetWriteConnectionStringddM e
(dde f
)ddf g
,ddg h
$str	ddi 
,
dd 
$num
dd 
)
dd 
;
dd 
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# +
,ee+ ,
	SqlDbTypeee- 6
.ee6 7
Intee7 :
,ee: ;
ParameterDirectionee< N
.eeN O
InputeeO T
,eeT U
rowIdeeV [
)ee[ \
;ee\ ]
intff 
rowsAffectedff 
=ff 
sphff "
.ff" #
ExecuteNonQueryff# 2
(ff2 3
)ff3 4
;ff4 5
returngg 
(gg 
rowsAffectedgg  
>gg! "
$numgg# $
)gg$ %
;gg% &
}ii 	
publicpp 
staticpp 
boolpp 
DeleteByLetterpp )
(pp) *
Guidpp* .

letterGuidpp/ 9
)pp9 :
{qq 	
SqlParameterHelperrr 
sphrr "
=rr# $
newrr% (
SqlParameterHelperrr) ;
(rr; <
ConnectionStringrr< L
.rrL M$
GetWriteConnectionStringrrM e
(rre f
)rrf g
,rrg h
$str	rri 
,
rr 
$num
rr 
)
rr 
;
rr 
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 0
,ss0 1
	SqlDbTypess2 ;
.ss; <
UniqueIdentifierss< L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g

letterGuidssh r
)ssr s
;sss t
inttt 
rowsAffectedtt 
=tt 
sphtt "
.tt" #
ExecuteNonQuerytt# 2
(tt2 3
)tt3 4
;tt4 5
returnuu 
(uu 
rowsAffecteduu  
>uu! "
$numuu# $
)uu$ %
;uu% &
}ww 	
publicyy 
staticyy 
boolyy 
DeleteByLetterInfoyy -
(yy- .
Guidyy. 2
letterInfoGuidyy3 A
)yyA B
{zz 	
SqlParameterHelper{{ 
sph{{ "
={{# $
new{{% (
SqlParameterHelper{{) ;
({{; <
ConnectionString{{< L
.{{L M$
GetWriteConnectionString{{M e
({{e f
){{f g
,{{g h
$str	{{i 
,
{{ 
$num
{{ 
)
{{ 
;
{{ 
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 4
,||4 5
	SqlDbType||6 ?
.||? @
UniqueIdentifier||@ P
,||P Q
ParameterDirection||R d
.||d e
Input||e j
,||j k
letterInfoGuid||l z
)||z {
;||{ |
int}} 
rowsAffected}} 
=}} 
sph}} "
.}}" #
ExecuteNonQuery}}# 2
(}}2 3
)}}3 4
;}}4 5
return~~ 
(~~ 
rowsAffected~~  
>~~! "
$num~~# $
)~~$ %
;~~% &
}
 	
public
 
static
 
bool
 
DeleteBySite
 '
(
' (
Guid
( ,
siteGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
IDataReader
 !
GetOne
" (
(
( )
int
) ,
rowId
- 2
)
2 3
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
Int
7 :
,
: ; 
ParameterDirection
< N
.
N O
Input
O T
,
T U
rowId
V [
)
[ \
;
\ ]
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '

letterGuid
( 2
)
2 3
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

letterGuid
h r
)
r s
;
s t
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
   	
public
¥¥ 
static
¥¥ 
IDataReader
¥¥ !
GetByLetter
¥¥" -
(
¥¥- .
Guid
¥¥. 2

letterGuid
¥¥3 =
)
¥¥= >
{
¦¦ 	 
SqlParameterHelper
§§ 
sph
§§ "
=
§§# $
new
§§% ( 
SqlParameterHelper
§§) ;
(
§§; <
ConnectionString
§§< L
.
§§L M%
GetReadConnectionString
§§M d
(
§§d e
)
§§e f
,
§§f g
$str§§h 
,§§ 
$num§§ 
)§§ 
;§§ 
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 0
,
¨¨0 1
	SqlDbType
¨¨2 ;
.
¨¨; <
UniqueIdentifier
¨¨< L
,
¨¨L M 
ParameterDirection
¨¨N `
.
¨¨` a
Input
¨¨a f
,
¨¨f g

letterGuid
¨¨h r
)
¨¨r s
;
¨¨s t
return
©© 
sph
©© 
.
©© 
ExecuteReader
©© $
(
©©$ %
)
©©% &
;
©©& '
}
­­ 	
public
µµ 
static
µµ 
IDataReader
µµ !
GetPage
µµ" )
(
µµ) *
Guid
¶¶ 

letterGuid
¶¶ 
,
¶¶ 
int
·· 

pageNumber
·· 
,
·· 
int
¸¸ 
pageSize
¸¸ 
,
¸¸ 
out
¹¹ 
int
¹¹ 

totalPages
¹¹ 
)
¹¹ 
{
ºº 	

totalPages
»» 
=
»» 
$num
»» 
;
»» 
int
¼¼ 
	totalRows
¼¼ 
=
½½ 
GetCount
½½ 
(
½½ 

letterGuid
½½ %
)
½½% &
;
½½& '
if
¿¿ 
(
¿¿ 
pageSize
¿¿ 
>
¿¿ 
$num
¿¿ 
)
¿¿ 

totalPages
¿¿ (
=
¿¿) *
	totalRows
¿¿+ 4
/
¿¿5 6
pageSize
¿¿7 ?
;
¿¿? @
if
ÁÁ 
(
ÁÁ 
	totalRows
ÁÁ 
<=
ÁÁ 
pageSize
ÁÁ %
)
ÁÁ% &
{
ÂÂ 

totalPages
ÃÃ 
=
ÃÃ 
$num
ÃÃ 
;
ÃÃ 
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 
int
ÇÇ 
	remainder
ÇÇ 
;
ÇÇ 
Math
ÈÈ 
.
ÈÈ 
DivRem
ÈÈ 
(
ÈÈ 
	totalRows
ÈÈ %
,
ÈÈ% &
pageSize
ÈÈ' /
,
ÈÈ/ 0
out
ÈÈ1 4
	remainder
ÈÈ5 >
)
ÈÈ> ?
;
ÈÈ? @
if
ÉÉ 
(
ÉÉ 
	remainder
ÉÉ 
>
ÉÉ 
$num
ÉÉ  !
)
ÉÉ! "
{
ÊÊ 

totalPages
ËË 
+=
ËË !
$num
ËË" #
;
ËË# $
}
ÌÌ 
}
ÍÍ  
SqlParameterHelper
ÏÏ 
sph
ÏÏ "
=
ÏÏ# $
new
ÏÏ% ( 
SqlParameterHelper
ÏÏ) ;
(
ÏÏ; <
ConnectionString
ÏÏ< L
.
ÏÏL M%
GetReadConnectionString
ÏÏM d
(
ÏÏd e
)
ÏÏe f
,
ÏÏf g
$strÏÏh 
,ÏÏ 
$numÏÏ 
)ÏÏ 
;ÏÏ 
sph
ÐÐ 
.
ÐÐ  
DefineSqlParameter
ÐÐ "
(
ÐÐ" #
$str
ÐÐ# 0
,
ÐÐ0 1
	SqlDbType
ÐÐ2 ;
.
ÐÐ; <
UniqueIdentifier
ÐÐ< L
,
ÐÐL M 
ParameterDirection
ÐÐN `
.
ÐÐ` a
Input
ÐÐa f
,
ÐÐf g

letterGuid
ÐÐh r
)
ÐÐr s
;
ÐÐs t
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 0
,
ÑÑ0 1
	SqlDbType
ÑÑ2 ;
.
ÑÑ; <
Int
ÑÑ< ?
,
ÑÑ? @ 
ParameterDirection
ÑÑA S
.
ÑÑS T
Input
ÑÑT Y
,
ÑÑY Z

pageNumber
ÑÑ[ e
)
ÑÑe f
;
ÑÑf g
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
Int
ÒÒ: =
,
ÒÒ= > 
ParameterDirection
ÒÒ? Q
.
ÒÒQ R
Input
ÒÒR W
,
ÒÒW X
pageSize
ÒÒY a
)
ÒÒa b
;
ÒÒb c
return
ÓÓ 
sph
ÓÓ 
.
ÓÓ 
ExecuteReader
ÓÓ $
(
ÓÓ$ %
)
ÓÓ% &
;
ÓÓ& '
}
ÕÕ 	
}
ÙÙ 
}ÚÚ ÚÖ
tD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBLetterSubscription.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class  
DBLetterSubscription ,
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
guid%% 
,%% 
Guid&& 
siteGuid&& 
,&& 
Guid'' 
letterInfoGuid'' 
,''  
Guid(( 
userGuid(( 
,(( 
string)) 
email)) 
,)) 
bool** 

isVerified** 
,** 
Guid++ 

verifyGuid++ 
,++ 
DateTime,, 
beginUtc,, 
,,, 
bool-- 
useHtml-- 
,-- 
string.. 
	ipAddress.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i 
,
00 
$num
00 
)
00 
;
00 
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
UniqueIdentifier116 F
,11F G
ParameterDirection11H Z
.11Z [
Input11[ `
,11` a
guid11b f
)11f g
;11g h
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
siteGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 4
,334 5
	SqlDbType336 ?
.33? @
UniqueIdentifier33@ P
,33P Q
ParameterDirection33R d
.33d e
Input33e j
,33j k
letterInfoGuid33l z
)33z {
;33{ |
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# .
,44. /
	SqlDbType440 9
.449 :
UniqueIdentifier44: J
,44J K
ParameterDirection44L ^
.44^ _
Input44_ d
,44d e
userGuid44f n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# +
,55+ ,
	SqlDbType55- 6
.556 7
NVarChar557 ?
,55? @
$num55A D
,55D E
ParameterDirection55F X
.55X Y
Input55Y ^
,55^ _
email55` e
)55e f
;55f g
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
Bit66< ?
,66? @
ParameterDirection66A S
.66S T
Input66T Y
,66Y Z

isVerified66[ e
)66e f
;66f g
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 0
,770 1
	SqlDbType772 ;
.77; <
UniqueIdentifier77< L
,77L M
ParameterDirection77N `
.77` a
Input77a f
,77f g

verifyGuid77h r
)77r s
;77s t
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# .
,88. /
	SqlDbType880 9
.889 :
DateTime88: B
,88B C
ParameterDirection88D V
.88V W
Input88W \
,88\ ]
beginUtc88^ f
)88f g
;88g h
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# -
,99- .
	SqlDbType99/ 8
.998 9
Bit999 <
,99< =
ParameterDirection99> P
.99P Q
Input99Q V
,99V W
useHtml99X _
)99_ `
;99` a
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# /
,::/ 0
	SqlDbType::1 :
.::: ;
NVarChar::; C
,::C D
$num::E H
,::H I
ParameterDirection::J \
.::\ ]
Input::] b
,::b c
	ipAddress::d m
)::m n
;::n o
int;; 
rowsAffected;; 
=;; 
sph;; "
.;;" #
ExecuteNonQuery;;# 2
(;;2 3
);;3 4
;;;4 5
return<< 
rowsAffected<< 
;<<  
}>> 	
publicFF 
staticFF 
boolFF 
UpdateFF !
(FF! "
GuidGG 
guidGG 
,GG 
GuidHH 
userGuidHH 
,HH 
boolII 
useHtmlII 
)II 
{JJ 	
SqlParameterHelperKK 
sphKK "
=KK# $
newKK% (
SqlParameterHelperKK) ;
(KK; <
ConnectionStringKK< L
.KKL M$
GetWriteConnectionStringKKM e
(KKe f
)KKf g
,KKg h
$str	KKi 
,
KK 
$num
KK 
)
KK 
;
KK 
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# *
,LL* +
	SqlDbTypeLL, 5
.LL5 6
UniqueIdentifierLL6 F
,LLF G
ParameterDirectionLLH Z
.LLZ [
InputLL[ `
,LL` a
guidLLb f
)LLf g
;LLg h
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
UniqueIdentifierMM: J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
userGuidMMf n
)MMn o
;MMo p
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
BitNN9 <
,NN< =
ParameterDirectionNN> P
.NNP Q
InputNNQ V
,NNV W
useHtmlNNX _
)NN_ `
;NN` a
intOO 
rowsAffectedOO 
=OO 
sphOO "
.OO" #
ExecuteNonQueryOO# 2
(OO2 3
)OO3 4
;OO4 5
returnPP 
(PP 
rowsAffectedPP  
>PP! "
$numPP# $
)PP$ %
;PP% &
}RR 	
publicXX 
staticXX 
boolXX 
ExistsXX !
(XX! "
GuidXX" &
letterInfoGuidXX' 5
,XX5 6
stringXX7 =
emailXX> C
)XXC D
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh 
,
ZZ 
$num
ZZ 
)
ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 4
,[[4 5
	SqlDbType[[6 ?
.[[? @
UniqueIdentifier[[@ P
,[[P Q
ParameterDirection[[R d
.[[d e
Input[[e j
,[[j k
letterInfoGuid[[l z
)[[z {
;[[{ |
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# +
,\\+ ,
	SqlDbType\\- 6
.\\6 7
NVarChar\\7 ?
,\\? @
$num\\A D
,\\D E
ParameterDirection\\F X
.\\X Y
Input\\Y ^
,\\^ _
email\\` e
)\\e f
;\\f g
int]] 
count]] 
=]] 
Convert]]  
.]]  !
ToInt32]]! (
(]]( )
sph]]) ,
.]], -
ExecuteScalar]]- :
(]]: ;
)]]; <
)]]< =
;]]= >
return^^ 
(^^ 
count^^ 
>^^ 
$num^^ 
)^^ 
;^^ 
}`` 	
publicbb 
staticbb 
boolbb 
Verifybb !
(bb! "
Guidcc 
guidcc 
,cc 
booldd 

isVerifieddd 
,dd 
Guidee 

verifyGuidee 
)ee 
{ff 	
SqlParameterHelpergg 
sphgg "
=gg# $
newgg% (
SqlParameterHelpergg) ;
(gg; <
ConnectionStringgg< L
.ggL M$
GetWriteConnectionStringggM e
(gge f
)ggf g
,ggg h
$str	ggi 
,
gg 
$num
gg 
)
gg 
;
gg 
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# *
,hh* +
	SqlDbTypehh, 5
.hh5 6
UniqueIdentifierhh6 F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
guidhhb f
)hhf g
;hhg h
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 0
,ii0 1
	SqlDbTypeii2 ;
.ii; <
Bitii< ?
,ii? @
ParameterDirectioniiA S
.iiS T
InputiiT Y
,iiY Z

isVerifiedii[ e
)iie f
;iif g
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 0
,jj0 1
	SqlDbTypejj2 ;
.jj; <
UniqueIdentifierjj< L
,jjL M
ParameterDirectionjjN `
.jj` a
Inputjja f
,jjf g

verifyGuidjjh r
)jjr s
;jjs t
intll 
rowsAffectedll 
=ll 
sphll "
.ll" #
ExecuteNonQueryll# 2
(ll2 3
)ll3 4
;ll4 5
returnmm 
(mm 
rowsAffectedmm  
>mm! "
$nummm# $
)mm$ %
;mm% &
}oo 	
publicvv 
staticvv 
boolvv 
Deletevv !
(vv! "
Guidvv" &
guidvv' +
)vv+ ,
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M$
GetWriteConnectionStringxxM e
(xxe f
)xxf g
,xxg h
$str	xxi 
,
xx 
$num
xx 
)
xx 
;
xx 
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# *
,yy* +
	SqlDbTypeyy, 5
.yy5 6
UniqueIdentifieryy6 F
,yyF G
ParameterDirectionyyH Z
.yyZ [
Inputyy[ `
,yy` a
guidyyb f
)yyf g
;yyg h
intzz 
rowsAffectedzz 
=zz 
sphzz "
.zz" #
ExecuteNonQueryzz# 2
(zz2 3
)zz3 4
;zz4 5
return{{ 
({{ 
rowsAffected{{  
>{{! "
$num{{# $
){{$ %
;{{% &
}}} 	
public
 
static
 
bool
 
DeleteByLetter
 )
(
) *
Guid
* .
letterInfoGuid
/ =
)
= >
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteUnverified
 +
(
+ ,
Guid
, 0
letterInfoGuid
1 ?
,
? @
DateTime
A I
olderThanUtc
J V
)
V W
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
DateTime
> F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
olderThanUtc
b n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
DeleteByUser
 '
(
' (
Guid
( ,
userGuid
- 5
)
5 6
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
¥¥ 
static
¥¥ 
bool
¥¥ 
DeleteBySite
¥¥ '
(
¥¥' (
Guid
¥¥( ,
siteGuid
¥¥- 5
)
¥¥5 6
{
¦¦ 	 
SqlParameterHelper
§§ 
sph
§§ "
=
§§# $
new
§§% ( 
SqlParameterHelper
§§) ;
(
§§; <
ConnectionString
§§< L
.
§§L M&
GetWriteConnectionString
§§M e
(
§§e f
)
§§f g
,
§§g h
$str§§i 
,§§ 
$num§§ 
)§§ 
;§§ 
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# .
,
¨¨. /
	SqlDbType
¨¨0 9
.
¨¨9 :
UniqueIdentifier
¨¨: J
,
¨¨J K 
ParameterDirection
¨¨L ^
.
¨¨^ _
Input
¨¨_ d
,
¨¨d e
siteGuid
¨¨f n
)
¨¨n o
;
¨¨o p
int
©© 
rowsAffected
©© 
=
©© 
sph
©© "
.
©©" #
ExecuteNonQuery
©©# 2
(
©©2 3
)
©©3 4
;
©©4 5
return
ªª 
(
ªª 
rowsAffected
ªª  
>
ªª! "
$num
ªª# $
)
ªª$ %
;
ªª% &
}
¬¬ 	
public
²² 
static
²² 
IDataReader
²² !
GetOne
²²" (
(
²²( )
Guid
²²) -
guid
²². 2
)
²²2 3
{
³³ 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M%
GetReadConnectionString
´´M d
(
´´d e
)
´´e f
,
´´f g
$str´´h 
,´´ 
$num´´ 
)´´ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# *
,
µµ* +
	SqlDbType
µµ, 5
.
µµ5 6
UniqueIdentifier
µµ6 F
,
µµF G 
ParameterDirection
µµH Z
.
µµZ [
Input
µµ[ `
,
µµ` a
guid
µµb f
)
µµf g
;
µµg h
return
¶¶ 
sph
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
¸¸ 	
public
¾¾ 
static
¾¾ 
IDataReader
¾¾ !
GetByLetter
¾¾" -
(
¾¾- .
Guid
¾¾. 2
letterInfoGuid
¾¾3 A
)
¾¾A B
{
¿¿ 	 
SqlParameterHelper
ÀÀ 
sph
ÀÀ "
=
ÀÀ# $
new
ÀÀ% ( 
SqlParameterHelper
ÀÀ) ;
(
ÀÀ; <
ConnectionString
ÀÀ< L
.
ÀÀL M%
GetReadConnectionString
ÀÀM d
(
ÀÀd e
)
ÀÀe f
,
ÀÀf g
$strÀÀh 
,ÀÀ 
$numÀÀ 
)ÀÀ 
;ÀÀ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# 4
,
ÁÁ4 5
	SqlDbType
ÁÁ6 ?
.
ÁÁ? @
UniqueIdentifier
ÁÁ@ P
,
ÁÁP Q 
ParameterDirection
ÁÁR d
.
ÁÁd e
Input
ÁÁe j
,
ÁÁj k
letterInfoGuid
ÁÁl z
)
ÁÁz {
;
ÁÁ{ |
return
ÂÂ 
sph
ÂÂ 
.
ÂÂ 
ExecuteReader
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÄÄ 	
public
ÊÊ 
static
ÊÊ 
IDataReader
ÊÊ !
	GetByUser
ÊÊ" +
(
ÊÊ+ ,
Guid
ÊÊ, 0
siteGuid
ÊÊ1 9
,
ÊÊ9 :
Guid
ÊÊ; ?
userGuid
ÊÊ@ H
)
ÊÊH I
{
ËË 	 
SqlParameterHelper
ÌÌ 
sph
ÌÌ "
=
ÌÌ# $
new
ÌÌ% ( 
SqlParameterHelper
ÌÌ) ;
(
ÌÌ; <
ConnectionString
ÌÌ< L
.
ÌÌL M%
GetReadConnectionString
ÌÌM d
(
ÌÌd e
)
ÌÌe f
,
ÌÌf g
$strÌÌh 
,ÌÌ 
$numÌÌ 
)ÌÌ 
;ÌÌ 
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# .
,
ÍÍ. /
	SqlDbType
ÍÍ0 9
.
ÍÍ9 :
UniqueIdentifier
ÍÍ: J
,
ÍÍJ K 
ParameterDirection
ÍÍL ^
.
ÍÍ^ _
Input
ÍÍ_ d
,
ÍÍd e
siteGuid
ÍÍf n
)
ÍÍn o
;
ÍÍo p
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# .
,
ÎÎ. /
	SqlDbType
ÎÎ0 9
.
ÎÎ9 :
UniqueIdentifier
ÎÎ: J
,
ÎÎJ K 
ParameterDirection
ÎÎL ^
.
ÎÎ^ _
Input
ÎÎ_ d
,
ÎÎd e
userGuid
ÎÎf n
)
ÎÎn o
;
ÎÎo p
return
ÏÏ 
sph
ÏÏ 
.
ÏÏ 
ExecuteReader
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
;
ÏÏ& '
}
ÑÑ 	
public
×× 
static
×× 
IDataReader
×× !

GetByEmail
××" ,
(
××, -
Guid
××- 1
siteGuid
××2 :
,
××: ;
string
××< B
email
××C H
)
××H I
{
ØØ 	 
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$strÙÙh 
,ÙÙ 
$numÙÙ 
)ÙÙ 
;ÙÙ 
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# .
,
ÚÚ. /
	SqlDbType
ÚÚ0 9
.
ÚÚ9 :
UniqueIdentifier
ÚÚ: J
,
ÚÚJ K 
ParameterDirection
ÚÚL ^
.
ÚÚ^ _
Input
ÚÚ_ d
,
ÚÚd e
siteGuid
ÚÚf n
)
ÚÚn o
;
ÚÚo p
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# +
,
ÛÛ+ ,
	SqlDbType
ÛÛ- 6
.
ÛÛ6 7
NVarChar
ÛÛ7 ?
,
ÛÛ? @
$num
ÛÛA D
,
ÛÛD E 
ParameterDirection
ÛÛF X
.
ÛÛX Y
Input
ÛÛY ^
,
ÛÛ^ _
email
ÛÛ` e
)
ÛÛe f
;
ÛÛf g
return
ÜÜ 
sph
ÜÜ 
.
ÜÜ 
ExecuteReader
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '
}
ÞÞ 	
public
àà 
static
àà 
IDataReader
àà !
Search
àà" (
(
àà( )
Guid
àà) -
letterInfoGuid
àà. <
,
àà< =
string
àà> D
emailOrIpAddress
ààE U
)
ààU V
{
áá 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M%
GetReadConnectionString
ââM d
(
ââd e
)
ââe f
,
ââf g
$strââh 
,ââ 
$numââ 
)ââ 
;ââ 
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 4
,
ãã4 5
	SqlDbType
ãã6 ?
.
ãã? @
UniqueIdentifier
ãã@ P
,
ããP Q 
ParameterDirection
ããR d
.
ããd e
Input
ããe j
,
ããj k
letterInfoGuid
ããl z
)
ããz {
;
ãã{ |
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# 6
,
ää6 7
	SqlDbType
ää8 A
.
ääA B
NVarChar
ääB J
,
ääJ K
$num
ääL O
,
ääO P 
ParameterDirection
ääQ c
.
ääc d
Input
ääd i
,
ääi j
emailOrIpAddress
ääk {
)
ää{ |
;
ää| }
return
åå 
sph
åå 
.
åå 
ExecuteReader
åå $
(
åå$ %
)
åå% &
;
åå& '
}
çç 	
public
íí 
static
íí 
IDataReader
íí !

GetByEmail
íí" ,
(
íí, -
Guid
íí- 1
siteGuid
íí2 :
,
íí: ;
Guid
íí< @
letterInfoGuid
ííA O
,
ííO P
string
ííQ W
email
ííX ]
)
íí] ^
{
îî 	 
SqlParameterHelper
ïï 
sph
ïï "
=
ïï# $
new
ïï% ( 
SqlParameterHelper
ïï) ;
(
ïï; <
ConnectionString
ïï< L
.
ïïL M%
GetReadConnectionString
ïïM d
(
ïïd e
)
ïïe f
,
ïïf g
$strïïh 
,ïï 
$numïï 
)ïï 
;ïï 
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# .
,
ðð. /
	SqlDbType
ðð0 9
.
ðð9 :
UniqueIdentifier
ðð: J
,
ððJ K 
ParameterDirection
ððL ^
.
ðð^ _
Input
ðð_ d
,
ððd e
siteGuid
ððf n
)
ððn o
;
ððo p
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 4
,
ññ4 5
	SqlDbType
ññ6 ?
.
ññ? @
UniqueIdentifier
ññ@ P
,
ññP Q 
ParameterDirection
ññR d
.
ññd e
Input
ññe j
,
ññj k
letterInfoGuid
ññl z
)
ññz {
;
ññ{ |
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# +
,
òò+ ,
	SqlDbType
òò- 6
.
òò6 7
NVarChar
òò7 ?
,
òò? @
$num
òòA D
,
òòD E 
ParameterDirection
òòF X
.
òòX Y
Input
òòY ^
,
òò^ _
email
òò` e
)
òòe f
;
òòf g
return
óó 
sph
óó 
.
óó 
ExecuteReader
óó $
(
óó$ %
)
óó% &
;
óó& '
}
õõ 	
public
÷÷ 
static
÷÷ 
IDataReader
÷÷ !*
GetTop1000UsersNotSubscribed
÷÷" >
(
÷÷> ?
Guid
÷÷? C
siteGuid
÷÷D L
,
÷÷L M
Guid
÷÷N R
letterInfoGuid
÷÷S a
,
÷÷a b
bool
÷÷c g(
excludeIfAnyUnsubscribeHx÷÷h 
)÷÷ 
{
øø 	 
SqlParameterHelper
ùù 
sph
ùù "
=
ùù# $
new
ùù% ( 
SqlParameterHelper
ùù) ;
(
ùù; <
ConnectionString
ùù< L
.
ùùL M%
GetReadConnectionString
ùùM d
(
ùùd e
)
ùùe f
,
ùùf g
$strùùh 
,ùù 
$numùù 
)ùù 
;ùù 
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# .
,
úú. /
	SqlDbType
úú0 9
.
úú9 :
UniqueIdentifier
úú: J
,
úúJ K 
ParameterDirection
úúL ^
.
úú^ _
Input
úú_ d
,
úúd e
siteGuid
úúf n
)
úún o
;
úúo p
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 4
,
ûû4 5
	SqlDbType
ûû6 ?
.
ûû? @
UniqueIdentifier
ûû@ P
,
ûûP Q 
ParameterDirection
ûûR d
.
ûûd e
Input
ûûe j
,
ûûj k
letterInfoGuid
ûûl z
)
ûûz {
;
ûû{ |
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# ?
,
üü? @
	SqlDbType
üüA J
.
üüJ K
Bit
üüK N
,
üüN O 
ParameterDirection
üüP b
.
üüb c
Input
üüc h
,
üüh i(
excludeIfAnyUnsubscribeHxüüj 
)üü 
;üü 
return
ýý 
sph
ýý 
.
ýý 
ExecuteReader
ýý $
(
ýý$ %
)
ýý% &
;
ýý& '
}
ÿÿ 	
public
 
static
 
int
 -
CountUsersNotSubscribedByLetter
 9
(
9 :
Guid
: >
siteGuid
? G
,
G H
Guid
I M
letterInfoGuid
N \
,
\ ]
bool
^ b'
excludeIfAnyUnsubscribeHx
c |
)
| }
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ?
,
? @
	SqlDbType
A J
.
J K
Bit
K N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i(
excludeIfAnyUnsubscribeHxj 
) 
; 
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !&
GetSubscribersNotSentYet
" :
(
: ;
Guid
 

letterGuid
 
,
 
Guid
 
letterInfoGuid
 
)
  
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

letterGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 
GetCountByLetter
 *
(
* +
Guid
+ /
letterInfoGuid
0 >
)
> ?
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 4
,
¢¢4 5
	SqlDbType
¢¢6 ?
.
¢¢? @
UniqueIdentifier
¢¢@ P
,
¢¢P Q 
ParameterDirection
¢¢R d
.
¢¢d e
Input
¢¢e j
,
¢¢j k
letterInfoGuid
¢¢l z
)
¢¢z {
;
¢¢{ |
return
¤¤ 
Convert
¤¤ 
.
¤¤ 
ToInt32
¤¤ "
(
¤¤" #
sph
¤¤# &
.
¤¤& '
ExecuteScalar
¤¤' 4
(
¤¤4 5
)
¤¤5 6
)
¤¤6 7
;
¤¤7 8
}
¦¦ 	
public
¯¯ 
static
¯¯ 
IDataReader
¯¯ !
GetPage
¯¯" )
(
¯¯) *
Guid
°° 
letterInfoGuid
°° 
,
°°  
int
±± 

pageNumber
±± 
,
±± 
int
²² 
pageSize
²² 
,
²² 
out
³³ 
int
³³ 

totalPages
³³ 
)
³³ 
{
´´ 	

totalPages
µµ 
=
µµ 
$num
µµ 
;
µµ 
int
¶¶ 
	totalRows
¶¶ 
=
·· 
GetCountByLetter
·· "
(
··" #
letterInfoGuid
··# 1
)
··1 2
;
··2 3
if
¹¹ 
(
¹¹ 
pageSize
¹¹ 
>
¹¹ 
$num
¹¹ 
)
¹¹ 

totalPages
¹¹ (
=
¹¹) *
	totalRows
¹¹+ 4
/
¹¹5 6
pageSize
¹¹7 ?
;
¹¹? @
if
»» 
(
»» 
	totalRows
»» 
<=
»» 
pageSize
»» %
)
»»% &
{
¼¼ 

totalPages
½½ 
=
½½ 
$num
½½ 
;
½½ 
}
¾¾ 
else
¿¿ 
{
ÀÀ 
int
ÁÁ 
	remainder
ÁÁ 
;
ÁÁ 
Math
ÂÂ 
.
ÂÂ 
DivRem
ÂÂ 
(
ÂÂ 
	totalRows
ÂÂ %
,
ÂÂ% &
pageSize
ÂÂ' /
,
ÂÂ/ 0
out
ÂÂ1 4
	remainder
ÂÂ5 >
)
ÂÂ> ?
;
ÂÂ? @
if
ÃÃ 
(
ÃÃ 
	remainder
ÃÃ 
>
ÃÃ 
$num
ÃÃ  !
)
ÃÃ! "
{
ÄÄ 

totalPages
ÅÅ 
+=
ÅÅ !
$num
ÅÅ" #
;
ÅÅ# $
}
ÆÆ 
}
ÇÇ  
SqlParameterHelper
ÉÉ 
sph
ÉÉ "
=
ÉÉ# $
new
ÉÉ% ( 
SqlParameterHelper
ÉÉ) ;
(
ÉÉ; <
ConnectionString
ÉÉ< L
.
ÉÉL M%
GetReadConnectionString
ÉÉM d
(
ÉÉd e
)
ÉÉe f
,
ÉÉf g
$strÉÉh 
,ÉÉ 
$numÉÉ 
)ÉÉ 
;ÉÉ 
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 4
,
ÊÊ4 5
	SqlDbType
ÊÊ6 ?
.
ÊÊ? @
UniqueIdentifier
ÊÊ@ P
,
ÊÊP Q 
ParameterDirection
ÊÊR d
.
ÊÊd e
Input
ÊÊe j
,
ÊÊj k
letterInfoGuid
ÊÊl z
)
ÊÊz {
;
ÊÊ{ |
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# 0
,
ËË0 1
	SqlDbType
ËË2 ;
.
ËË; <
Int
ËË< ?
,
ËË? @ 
ParameterDirection
ËËA S
.
ËËS T
Input
ËËT Y
,
ËËY Z

pageNumber
ËË[ e
)
ËËe f
;
ËËf g
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# .
,
ÌÌ. /
	SqlDbType
ÌÌ0 9
.
ÌÌ9 :
Int
ÌÌ: =
,
ÌÌ= > 
ParameterDirection
ÌÌ? Q
.
ÌÌQ R
Input
ÌÌR W
,
ÌÌW X
pageSize
ÌÌY a
)
ÌÌa b
;
ÌÌb c
return
ÍÍ 
sph
ÍÍ 
.
ÍÍ 
ExecuteReader
ÍÍ $
(
ÍÍ$ %
)
ÍÍ% &
;
ÍÍ& '
}
ÏÏ 	
public
àà 
static
àà 
int
àà 
CreateHistory
àà '
(
àà' (
Guid
áá 
rowGuid
áá 
,
áá 
Guid
ââ 
siteGuid
ââ 
,
ââ 
Guid
ãã 
subscribeGuid
ãã 
,
ãã 
Guid
ää 
letterInfoGuid
ää 
,
ää  
Guid
åå 
userGuid
åå 
,
åå 
string
ææ 
email
ææ 
,
ææ 
bool
çç 

isVerified
çç 
,
çç 
bool
èè 
useHtml
èè 
,
èè 
DateTime
éé 
beginUtc
éé 
,
éé 
DateTime
êê 
endUtc
êê 
,
êê 
string
ëë 
	ipAddress
ëë 
)
ëë 
{
ìì 	 
SqlParameterHelper
íí 
sph
íí "
=
íí# $
new
íí% ( 
SqlParameterHelper
íí) ;
(
íí; <
ConnectionString
íí< L
.
ííL M&
GetWriteConnectionString
ííM e
(
ííe f
)
ííf g
,
ííg h
$strííi 
,íí 
$numíí 
)íí 
;íí 
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# -
,
îî- .
	SqlDbType
îî/ 8
.
îî8 9
UniqueIdentifier
îî9 I
,
îîI J 
ParameterDirection
îîK ]
.
îî] ^
Input
îî^ c
,
îîc d
rowGuid
îîe l
)
îîl m
;
îîm n
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# .
,
ïï. /
	SqlDbType
ïï0 9
.
ïï9 :
UniqueIdentifier
ïï: J
,
ïïJ K 
ParameterDirection
ïïL ^
.
ïï^ _
Input
ïï_ d
,
ïïd e
siteGuid
ïïf n
)
ïïn o
;
ïïo p
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# 3
,
ðð3 4
	SqlDbType
ðð5 >
.
ðð> ?
UniqueIdentifier
ðð? O
,
ððO P 
ParameterDirection
ððQ c
.
ððc d
Input
ððd i
,
ðði j
subscribeGuid
ððk x
)
ððx y
;
ððy z
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 4
,
ññ4 5
	SqlDbType
ññ6 ?
.
ññ? @
UniqueIdentifier
ññ@ P
,
ññP Q 
ParameterDirection
ññR d
.
ññd e
Input
ññe j
,
ññj k
letterInfoGuid
ññl z
)
ññz {
;
ññ{ |
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# .
,
òò. /
	SqlDbType
òò0 9
.
òò9 :
UniqueIdentifier
òò: J
,
òòJ K 
ParameterDirection
òòL ^
.
òò^ _
Input
òò_ d
,
òòd e
userGuid
òòf n
)
òòn o
;
òòo p
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# +
,
óó+ ,
	SqlDbType
óó- 6
.
óó6 7
NVarChar
óó7 ?
,
óó? @
$num
óóA D
,
óóD E 
ParameterDirection
óóF X
.
óóX Y
Input
óóY ^
,
óó^ _
email
óó` e
)
óóe f
;
óóf g
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# 0
,
ôô0 1
	SqlDbType
ôô2 ;
.
ôô; <
Bit
ôô< ?
,
ôô? @ 
ParameterDirection
ôôA S
.
ôôS T
Input
ôôT Y
,
ôôY Z

isVerified
ôô[ e
)
ôôe f
;
ôôf g
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# -
,
õõ- .
	SqlDbType
õõ/ 8
.
õõ8 9
Bit
õõ9 <
,
õõ< = 
ParameterDirection
õõ> P
.
õõP Q
Input
õõQ V
,
õõV W
useHtml
õõX _
)
õõ_ `
;
õõ` a
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# .
,
öö. /
	SqlDbType
öö0 9
.
öö9 :
DateTime
öö: B
,
ööB C 
ParameterDirection
ööD V
.
ööV W
Input
ööW \
,
öö\ ]
beginUtc
öö^ f
)
ööf g
;
öög h
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# ,
,
÷÷, -
	SqlDbType
÷÷. 7
.
÷÷7 8
DateTime
÷÷8 @
,
÷÷@ A 
ParameterDirection
÷÷B T
.
÷÷T U
Input
÷÷U Z
,
÷÷Z [
endUtc
÷÷\ b
)
÷÷b c
;
÷÷c d
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# /
,
øø/ 0
	SqlDbType
øø1 :
.
øø: ;
NVarChar
øø; C
,
øøC D
$num
øøE H
,
øøH I 
ParameterDirection
øøJ \
.
øø\ ]
Input
øø] b
,
øøb c
	ipAddress
øød m
)
øøm n
;
øøn o
int
ùù 
rowsAffected
ùù 
=
ùù 
sph
ùù "
.
ùù" #
ExecuteNonQuery
ùù# 2
(
ùù2 3
)
ùù3 4
;
ùù4 5
return
úú 
rowsAffected
úú 
;
úú  
}
üü 	
public
ÿÿ 
static
ÿÿ 
bool
ÿÿ !
DeleteHistoryBySite
ÿÿ .
(
ÿÿ. /
Guid
ÿÿ/ 3
siteGuid
ÿÿ4 <
)
ÿÿ< =
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 '
DeleteHistoryByLetterInfo
 4
(
4 5
Guid
5 9
letterInfoGuid
: H
)
H I
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
UniqueIdentifier
@ P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
letterInfoGuid
l z
)
z {
;
{ |
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
}
 
} ÿó
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModule.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModule  
{ 
public   
static   
int   
	AddModule   #
(  # $
int!! 
pageId!! 
,!! 
int"" 
siteId"" 
,"" 
Guid## 
siteGuid## 
,## 
int$$ 
moduleDefId$$ 
,$$ 
int%% 
moduleOrder%% 
,%% 
string&& 
paneName&& 
,&& 
string'' 
moduleTitle'' 
,'' 
string(( 
	viewRoles(( 
,(( 
string)) 
authorizedEditRoles)) &
,))& '
string** 
draftEditRoles** !
,**! "
string++ 
draftApprovalRoles++ %
,++% &
int,, 
	cacheTime,, 
,,, 
bool-- 
	showTitle-- 
,-- 
bool.. 
availableForMyPage.. #
,..# $
bool// *
allowMultipleInstancesOnMyPage// /
,/// 0
String00 
icon00 
,00 
int11 
createdByUserId11 
,11  
DateTime22 
createdDate22  
,22  !
Guid33 
guid33 
,33 
Guid44 
featureGuid44 
,44 
bool55 !
hideFromAuthenticated55 &
,55& '
bool66 #
hideFromUnauthenticated66 (
,66( )
string77 
headElement77 
,77 
int88 
publishMode88 
)88 
{99 	
SqlParameterHelper:: 
sph:: "
=::# $
new::% (
SqlParameterHelper::) ;
(::; <
ConnectionString::< L
.::L M$
GetWriteConnectionString::M e
(::e f
)::f g
,::g h
$str::i |
,::| }
$num	::~ 
)
:: 
;
:: 
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# ,
,;;, -
	SqlDbType;;. 7
.;;7 8
Int;;8 ;
,;;; <
ParameterDirection;;= O
.;;O P
Input;;P U
,;;U V
pageId;;W ]
);;] ^
;;;^ _
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# ,
,<<, -
	SqlDbType<<. 7
.<<7 8
Int<<8 ;
,<<; <
ParameterDirection<<= O
.<<O P
Input<<P U
,<<U V
siteId<<W ]
)<<] ^
;<<^ _
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 1
,==1 2
	SqlDbType==3 <
.==< =
Int=== @
,==@ A
ParameterDirection==B T
.==T U
Input==U Z
,==Z [
moduleDefId==\ g
)==g h
;==h i
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
Int>>= @
,>>@ A
ParameterDirection>>B T
.>>T U
Input>>U Z
,>>Z [
moduleOrder>>\ g
)>>g h
;>>h i
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# .
,??. /
	SqlDbType??0 9
.??9 :
NVarChar??: B
,??B C
$num??D F
,??F G
ParameterDirection??H Z
.??Z [
Input??[ `
,??` a
paneName??b j
)??j k
;??k l
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# 1
,@@1 2
	SqlDbType@@3 <
.@@< =
NVarChar@@= E
,@@E F
$num@@G J
,@@J K
ParameterDirection@@L ^
.@@^ _
Input@@_ d
,@@d e
moduleTitle@@f q
)@@q r
;@@r s
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 9
,AA9 :
	SqlDbTypeAA; D
.AAD E
NVarCharAAE M
,AAM N
-AAO P
$numAAP Q
,AAQ R
ParameterDirectionAAS e
.AAe f
InputAAf k
,AAk l 
authorizedEditRoles	AAm 
)
AA 
;
AA 
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# 4
,BB4 5
	SqlDbTypeBB6 ?
.BB? @
NVarCharBB@ H
,BBH I
-BBJ K
$numBBK L
,BBL M
ParameterDirectionBBN `
.BB` a
InputBBa f
,BBf g
draftEditRolesBBh v
)BBv w
;BBw x
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# 8
,CC8 9
	SqlDbTypeCC: C
.CCC D
NVarCharCCD L
,CCL M
-CCN O
$numCCO P
,CCP Q
ParameterDirectionCCR d
.CCd e
InputCCe j
,CCj k
draftApprovalRolesCCl ~
)CC~ 
;	CC 
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# /
,DD/ 0
	SqlDbTypeDD1 :
.DD: ;
IntDD; >
,DD> ?
ParameterDirectionDD@ R
.DDR S
InputDDS X
,DDX Y
	cacheTimeDDZ c
)DDc d
;DDd e
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# /
,EE/ 0
	SqlDbTypeEE1 :
.EE: ;
BitEE; >
,EE> ?
ParameterDirectionEE@ R
.EER S
InputEES X
,EEX Y
	showTitleEEZ c
)EEc d
;EEd e
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# 8
,FF8 9
	SqlDbTypeFF: C
.FFC D
BitFFD G
,FFG H
ParameterDirectionFFI [
.FF[ \
InputFF\ a
,FFa b
availableForMyPageFFc u
)FFu v
;FFv w
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 5
,GG5 6
	SqlDbTypeGG7 @
.GG@ A
IntGGA D
,GGD E
ParameterDirectionGGF X
.GGX Y
InputGGY ^
,GG^ _
createdByUserIdGG` o
)GGo p
;GGp q
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 1
,HH1 2
	SqlDbTypeHH3 <
.HH< =
DateTimeHH= E
,HHE F
ParameterDirectionHHG Y
.HHY Z
InputHHZ _
,HH_ `
createdDateHHa l
)HHl m
;HHm n
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# D
,IID E
	SqlDbTypeIIF O
.IIO P
BitIIP S
,IIS T
ParameterDirectionIIU g
.IIg h
InputIIh m
,IIm n+
allowMultipleInstancesOnMyPage	IIo 
)
II 
;
II 
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# *
,JJ* +
	SqlDbTypeJJ, 5
.JJ5 6
NVarCharJJ6 >
,JJ> ?
$numJJ@ C
,JJC D
ParameterDirectionJJE W
.JJW X
InputJJX ]
,JJ] ^
iconJJ_ c
)JJc d
;JJd e
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# *
,KK* +
	SqlDbTypeKK, 5
.KK5 6
UniqueIdentifierKK6 F
,KKF G
ParameterDirectionKKH Z
.KKZ [
InputKK[ `
,KK` a
guidKKb f
)KKf g
;KKg h
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
UniqueIdentifierLL= M
,LLM N
ParameterDirectionLLO a
.LLa b
InputLLb g
,LLg h
featureGuidLLi t
)LLt u
;LLu v
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
UniqueIdentifierMM: J
,MMJ K
ParameterDirectionMML ^
.MM^ _
InputMM_ d
,MMd e
siteGuidMMf n
)MMn o
;MMo p
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 2
,NN2 3
	SqlDbTypeNN4 =
.NN= >
BitNN> A
,NNA B
ParameterDirectionNNC U
.NNU V
InputNNV [
,NN[ \!
hideFromAuthenticatedNN] r
)NNr s
;NNs t
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 4
,OO4 5
	SqlDbTypeOO6 ?
.OO? @
BitOO@ C
,OOC D
ParameterDirectionOOE W
.OOW X
InputOOX ]
,OO] ^#
hideFromUnauthenticatedOO_ v
)OOv w
;OOw x
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# /
,PP/ 0
	SqlDbTypePP1 :
.PP: ;
NVarCharPP; C
,PPC D
-PPE F
$numPPF G
,PPG H
ParameterDirectionPPI [
.PP[ \
InputPP\ a
,PPa b
	viewRolesPPc l
)PPl m
;PPm n
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 1
,QQ1 2
	SqlDbTypeQQ3 <
.QQ< =
NVarCharQQ= E
,QQE F
$numQQG I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
headElementQQe p
)QQp q
;QQq r
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 1
,RR1 2
	SqlDbTypeRR3 <
.RR< =
IntRR= @
,RR@ A
ParameterDirectionRRB T
.RRT U
InputRRU Z
,RRZ [
publishModeRR\ g
)RRg h
;RRh i
intTT 
newIDTT 
=TT 
ConvertTT 
.TT  
ToInt32TT  '
(TT' (
sphTT( +
.TT+ ,
ExecuteScalarTT, 9
(TT9 :
)TT: ;
)TT; <
;TT< =
returnVV 
newIDVV 
;VV 
}WW 	
publicYY 
staticYY 
boolYY 
UpdateModuleYY '
(YY' (
intZZ 
moduleIdZZ 
,ZZ 
int[[ 
moduleDefId[[ 
,[[ 
string\\ 
moduleTitle\\ 
,\\ 
string]] 
	viewRoles]] 
,]] 
string^^ 
authorizedEditRoles^^ &
,^^& '
string__ 
draftEditRoles__ !
,__! "
string`` 
draftApprovalRoles`` %
,``% &
intaa 
	cacheTimeaa 
,aa 
boolbb 
	showTitlebb 
,bb 
intcc 

editUserIdcc 
,cc 
booldd 
availableForMyPagedd #
,dd# $
boolee *
allowMultipleInstancesOnMyPageee /
,ee/ 0
Stringff 
iconff 
,ff 
boolgg !
hideFromAuthenticatedgg &
,gg& '
boolhh #
hideFromUnauthenticatedhh (
,hh( )
boolii 
includeInSearchii  
,ii  !
booljj 
isGlobaljj 
,jj 
stringkk 
headElementkk 
,kk 
intll 
publishModell 
)ll 
{mm 	
SqlParameterHelpernn 
sphnn "
=nn# $
newnn% (
SqlParameterHelpernn) ;
(nn; <
ConnectionStringnn< L
.nnL M$
GetWriteConnectionStringnnM e
(nne f
)nnf g
,nng h
$strnni |
,nn| }
$num	nn~ 
)
nn 
;
nn 
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# .
,oo. /
	SqlDbTypeoo0 9
.oo9 :
Intoo: =
,oo= >
ParameterDirectionoo? Q
.ooQ R
InputooR W
,ooW X
moduleIdooY a
)ooa b
;oob c
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 1
,pp1 2
	SqlDbTypepp3 <
.pp< =
Intpp= @
,pp@ A
ParameterDirectionppB T
.ppT U
InputppU Z
,ppZ [
moduleDefIdpp\ g
)ppg h
;pph i
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 1
,qq1 2
	SqlDbTypeqq3 <
.qq< =
NVarCharqq= E
,qqE F
ParameterDirectionqqG Y
.qqY Z
InputqqZ _
,qq_ `
moduleTitleqqa l
)qql m
;qqm n
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 9
,rr9 :
	SqlDbTyperr; D
.rrD E
NVarCharrrE M
,rrM N
-rrO P
$numrrP Q
,rrQ R
ParameterDirectionrrS e
.rre f
Inputrrf k
,rrk l 
authorizedEditRoles	rrm 
)
rr 
;
rr 
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 4
,ss4 5
	SqlDbTypess6 ?
.ss? @
NVarCharss@ H
,ssH I
-ssJ K
$numssK L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g
draftEditRolesssh v
)ssv w
;ssw x
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 8
,tt8 9
	SqlDbTypett: C
.ttC D
NVarCharttD L
,ttL M
-ttN O
$numttO P
,ttP Q
ParameterDirectionttR d
.ttd e
Inputtte j
,ttj k
draftApprovalRolesttl ~
)tt~ 
;	tt 
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# /
,uu/ 0
	SqlDbTypeuu1 :
.uu: ;
Intuu; >
,uu> ?
ParameterDirectionuu@ R
.uuR S
InputuuS X
,uuX Y
	cacheTimeuuZ c
)uuc d
;uud e
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# /
,vv/ 0
	SqlDbTypevv1 :
.vv: ;
Bitvv; >
,vv> ?
ParameterDirectionvv@ R
.vvR S
InputvvS X
,vvX Y
	showTitlevvZ c
)vvc d
;vvd e
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
Intww< ?
,ww? @
ParameterDirectionwwA S
.wwS T
InputwwT Y
,wwY Z

editUserIdww[ e
)wwe f
;wwf g
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 8
,xx8 9
	SqlDbTypexx: C
.xxC D
BitxxD G
,xxG H
ParameterDirectionxxI [
.xx[ \
Inputxx\ a
,xxa b
availableForMyPagexxc u
)xxu v
;xxv w
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# D
,yyD E
	SqlDbTypeyyF O
.yyO P
BityyP S
,yyS T
ParameterDirectionyyU g
.yyg h
Inputyyh m
,yym n+
allowMultipleInstancesOnMyPage	yyo 
)
yy 
;
yy 
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# *
,zz* +
	SqlDbTypezz, 5
.zz5 6
NVarCharzz6 >
,zz> ?
$numzz@ C
,zzC D
ParameterDirectionzzE W
.zzW X
InputzzX ]
,zz] ^
iconzz_ c
)zzc d
;zzd e
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 2
,{{2 3
	SqlDbType{{4 =
.{{= >
Bit{{> A
,{{A B
ParameterDirection{{C U
.{{U V
Input{{V [
,{{[ \!
hideFromAuthenticated{{] r
){{r s
;{{s t
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 4
,||4 5
	SqlDbType||6 ?
.||? @
Bit||@ C
,||C D
ParameterDirection||E W
.||W X
Input||X ]
,||] ^#
hideFromUnauthenticated||_ v
)||v w
;||w x
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# /
,}}/ 0
	SqlDbType}}1 :
.}}: ;
NVarChar}}; C
,}}C D
-}}E F
$num}}F G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
	viewRoles}}c l
)}}l m
;}}m n
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 5
,~~5 6
	SqlDbType~~7 @
.~~@ A
Bit~~A D
,~~D E
ParameterDirection~~F X
.~~X Y
Input~~Y ^
,~~^ _
includeInSearch~~` o
)~~o p
;~~p q
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
Bit: =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
isGlobalY a
)a b
;b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
headElement
e p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
publishMode
\ g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 
UpdateModuleOrder
 ,
(
, -
int
- 0
pageId
1 7
,
7 8
int
9 <
moduleId
= E
,
E F
int
G J
moduleOrder
K V
,
V W
string
X ^
paneName
_ g
)
g h
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
pageId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleOrder
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
paneName
b j
)
j k
;
k l
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 

UpdatePage
 %
(
% &
int
& )
	oldPageId
* 3
,
3 4
int
5 8
	newPageId
9 B
,
B C
int
D G
moduleId
H P
)
P Q
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
Int
; >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
	oldPageId
Z c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
Int
; >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
	newPageId
Z c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 
Publish
 "
(
" #
Guid
 
pageGuid
 
,
 
Guid
 

moduleGuid
 
,
 
int
 
moduleId
 
,
 
int
 
pageId
 
,
 
String
   
paneName
   
,
   
int
¡¡ 
moduleOrder
¡¡ 
,
¡¡ 
DateTime
¢¢ 
publishBeginDate
¢¢ %
,
¢¢% &
DateTime
££ 
publishEndDate
££ #
)
££# $
{
¤¤ 	
if
¥¥ 
(
¥¥ 
PageModuleExists
¥¥  
(
¥¥  !
moduleId
¥¥! )
,
¥¥) *
pageId
¥¥+ 1
)
¥¥1 2
)
¥¥2 3
{
¦¦ 
return
§§ 
PageModuleUpdate
§§ '
(
§§' (
moduleId
¨¨ 
,
¨¨ 
pageId
©© 
,
©© 
paneName
ªª 
,
ªª 
moduleOrder
«« 
,
««  
publishBeginDate
¬¬ $
,
¬¬$ %
publishEndDate
­­ "
)
­­" #
;
­­# $
}
®® 
else
¯¯ 
{
°° 
return
±± 
PageModuleInsert
±± '
(
±±' (
pageGuid
²² 
,
²² 

moduleGuid
³³ 
,
³³ 
moduleId
´´ 
,
´´ 
pageId
µµ 
,
µµ 
paneName
¶¶ 
,
¶¶ 
moduleOrder
·· 
,
··  
publishBeginDate
¸¸ $
,
¸¸$ %
publishEndDate
¹¹ "
)
¹¹" #
;
¹¹# $
}
»» 
}
½½ 	
public
¿¿ 
static
¿¿ 
bool
¿¿ 
PageModuleExists
¿¿ +
(
¿¿+ ,
int
¿¿, /
moduleId
¿¿0 8
,
¿¿8 9
int
¿¿: =
pageId
¿¿> D
)
¿¿D E
{
ÀÀ 	 
SqlParameterHelper
ÁÁ 
sph
ÁÁ "
=
ÁÁ# $
new
ÁÁ% ( 
SqlParameterHelper
ÁÁ) ;
(
ÁÁ; <
ConnectionString
ÁÁ< L
.
ÁÁL M%
GetReadConnectionString
ÁÁM d
(
ÁÁd e
)
ÁÁe f
,
ÁÁf g
$str
ÁÁh ~
,
ÁÁ~ 
$numÁÁ 
)ÁÁ 
;ÁÁ 
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# .
,
ÂÂ. /
	SqlDbType
ÂÂ0 9
.
ÂÂ9 :
Int
ÂÂ: =
,
ÂÂ= > 
ParameterDirection
ÂÂ? Q
.
ÂÂQ R
Input
ÂÂR W
,
ÂÂW X
moduleId
ÂÂY a
)
ÂÂa b
;
ÂÂb c
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# ,
,
ÃÃ, -
	SqlDbType
ÃÃ. 7
.
ÃÃ7 8
Int
ÃÃ8 ;
,
ÃÃ; < 
ParameterDirection
ÃÃ= O
.
ÃÃO P
Input
ÃÃP U
,
ÃÃU V
pageId
ÃÃW ]
)
ÃÃ] ^
;
ÃÃ^ _
int
ÄÄ 
count
ÄÄ 
=
ÄÄ 
Convert
ÄÄ 
.
ÄÄ  
ToInt32
ÄÄ  '
(
ÄÄ' (
sph
ÄÄ( +
.
ÄÄ+ ,
ExecuteScalar
ÄÄ, 9
(
ÄÄ9 :
)
ÄÄ: ;
)
ÄÄ; <
;
ÄÄ< =
return
ÅÅ 
(
ÅÅ 
count
ÅÅ 
>
ÅÅ 
$num
ÅÅ 
)
ÅÅ 
;
ÅÅ 
}
ÆÆ 	
public
ÈÈ 
static
ÈÈ 
	DataTable
ÈÈ #
PageModuleGetByModule
ÈÈ  5
(
ÈÈ5 6
int
ÈÈ6 9
moduleId
ÈÈ: B
)
ÈÈB C
{
ÉÉ 	
	DataTable
ÊÊ 
	dataTable
ÊÊ 
=
ÊÊ  !
new
ÊÊ" %
	DataTable
ÊÊ& /
(
ÊÊ/ 0
)
ÊÊ0 1
;
ÊÊ1 2
	dataTable
ËË 
.
ËË 
Columns
ËË 
.
ËË 
Add
ËË !
(
ËË! "
$str
ËË" *
,
ËË* +
typeof
ËË, 2
(
ËË2 3
int
ËË3 6
)
ËË6 7
)
ËË7 8
;
ËË8 9
	dataTable
ÌÌ 
.
ÌÌ 
Columns
ÌÌ 
.
ÌÌ 
Add
ÌÌ !
(
ÌÌ! "
$str
ÌÌ" ,
,
ÌÌ, -
typeof
ÌÌ. 4
(
ÌÌ4 5
int
ÌÌ5 8
)
ÌÌ8 9
)
ÌÌ9 :
;
ÌÌ: ;
	dataTable
ÍÍ 
.
ÍÍ 
Columns
ÍÍ 
.
ÍÍ 
Add
ÍÍ !
(
ÍÍ! "
$str
ÍÍ" ,
,
ÍÍ, -
typeof
ÍÍ. 4
(
ÍÍ4 5
string
ÍÍ5 ;
)
ÍÍ; <
)
ÍÍ< =
;
ÍÍ= >
	dataTable
ÎÎ 
.
ÎÎ 
Columns
ÎÎ 
.
ÎÎ 
Add
ÎÎ !
(
ÎÎ! "
$str
ÎÎ" /
,
ÎÎ/ 0
typeof
ÎÎ1 7
(
ÎÎ7 8
int
ÎÎ8 ;
)
ÎÎ; <
)
ÎÎ< =
;
ÎÎ= >
	dataTable
ÏÏ 
.
ÏÏ 
Columns
ÏÏ 
.
ÏÏ 
Add
ÏÏ !
(
ÏÏ! "
$str
ÏÏ" 4
,
ÏÏ4 5
typeof
ÏÏ6 <
(
ÏÏ< =
DateTime
ÏÏ= E
)
ÏÏE F
)
ÏÏF G
;
ÏÏG H
	dataTable
ÐÐ 
.
ÐÐ 
Columns
ÐÐ 
.
ÐÐ 
Add
ÐÐ !
(
ÐÐ! "
$str
ÐÐ" 2
,
ÐÐ2 3
typeof
ÐÐ4 :
(
ÐÐ: ;
DateTime
ÐÐ; C
)
ÐÐC D
)
ÐÐD E
;
ÐÐE F
using
ÒÒ 
(
ÒÒ 
IDataReader
ÒÒ 
reader
ÒÒ %
=
ÒÒ& ')
PageModuleGetReaderByModule
ÒÒ( C
(
ÒÒC D
moduleId
ÒÒD L
)
ÒÒL M
)
ÒÒM N
{
ÓÓ 
while
ÔÔ 
(
ÔÔ 
reader
ÔÔ 
.
ÔÔ 
Read
ÔÔ "
(
ÔÔ" #
)
ÔÔ# $
)
ÔÔ$ %
{
ÕÕ 
DataRow
ÖÖ 
row
ÖÖ 
=
ÖÖ  !
	dataTable
ÖÖ" +
.
ÖÖ+ ,
NewRow
ÖÖ, 2
(
ÖÖ2 3
)
ÖÖ3 4
;
ÖÖ4 5
row
×× 
[
×× 
$str
××  
]
××  !
=
××" #
reader
××$ *
[
××* +
$str
××+ 3
]
××3 4
;
××4 5
row
ØØ 
[
ØØ 
$str
ØØ "
]
ØØ" #
=
ØØ$ %
reader
ØØ& ,
[
ØØ, -
$str
ØØ- 7
]
ØØ7 8
;
ØØ8 9
row
ÙÙ 
[
ÙÙ 
$str
ÙÙ "
]
ÙÙ" #
=
ÙÙ$ %
reader
ÙÙ& ,
[
ÙÙ, -
$str
ÙÙ- 7
]
ÙÙ7 8
;
ÙÙ8 9
row
ÚÚ 
[
ÚÚ 
$str
ÚÚ %
]
ÚÚ% &
=
ÚÚ' (
reader
ÚÚ) /
[
ÚÚ/ 0
$str
ÚÚ0 =
]
ÚÚ= >
;
ÚÚ> ?
row
ÛÛ 
[
ÛÛ 
$str
ÛÛ *
]
ÛÛ* +
=
ÛÛ, -
reader
ÛÛ. 4
[
ÛÛ4 5
$str
ÛÛ5 G
]
ÛÛG H
;
ÛÛH I
row
ÜÜ 
[
ÜÜ 
$str
ÜÜ (
]
ÜÜ( )
=
ÜÜ* +
reader
ÜÜ, 2
[
ÜÜ2 3
$str
ÜÜ3 C
]
ÜÜC D
;
ÜÜD E
	dataTable
ÞÞ 
.
ÞÞ 
Rows
ÞÞ "
.
ÞÞ" #
Add
ÞÞ# &
(
ÞÞ& '
row
ÞÞ' *
)
ÞÞ* +
;
ÞÞ+ ,
}
ßß 
}
áá 
return
ãã 
	dataTable
ãã 
;
ãã 
}
åå 	
public
çç 
static
çç 
IDataReader
çç !)
PageModuleGetReaderByModule
çç" =
(
çç= >
int
çç> A
moduleId
ççB J
)
ççJ K
{
èè 	 
SqlParameterHelper
éé 
sph
éé "
=
éé# $
new
éé% ( 
SqlParameterHelper
éé) ;
(
éé; <
ConnectionString
éé< L
.
ééL M%
GetReadConnectionString
ééM d
(
ééd e
)
éée f
,
ééf g
$strééh 
,éé 
$numéé 
)éé 
;éé 
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
Int
êê: =
,
êê= > 
ParameterDirection
êê? Q
.
êêQ R
Input
êêR W
,
êêW X
moduleId
êêY a
)
êêa b
;
êêb c
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
ìì 	
public
îî 
static
îî 
IDataReader
îî !'
PageModuleGetReaderByPage
îî" ;
(
îî; <
int
îî< ?
pageId
îî@ F
)
îîF G
{
ïï 	 
SqlParameterHelper
ðð 
sph
ðð "
=
ðð# $
new
ðð% ( 
SqlParameterHelper
ðð) ;
(
ðð; <
ConnectionString
ðð< L
.
ððL M%
GetReadConnectionString
ððM d
(
ððd e
)
ððe f
,
ððf g
$strððh 
,ðð 
$numðð 
)ðð 
;ðð 
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# ,
,
ññ, -
	SqlDbType
ññ. 7
.
ññ7 8
Int
ññ8 ;
,
ññ; < 
ParameterDirection
ññ= O
.
ññO P
Input
ññP U
,
ññU V
pageId
ññW ]
)
ññ] ^
;
ññ^ _
return
òò 
sph
òò 
.
òò 
ExecuteReader
òò $
(
òò$ %
)
òò% &
;
òò& '
}
óó 	
public
õõ 
static
õõ 
bool
õõ 
PageModuleInsert
õõ +
(
õõ+ ,
Guid
öö 
pageGuid
öö 
,
öö 
Guid
÷÷ 

moduleGuid
÷÷ 
,
÷÷ 
int
øø 
moduleId
øø 
,
øø 
int
ùù 
pageId
ùù 
,
ùù 
String
úú 
paneName
úú 
,
úú 
int
ûû 
moduleOrder
ûû 
,
ûû 
DateTime
üü 
publishBeginDate
üü %
,
üü% &
DateTime
ýý 
publishEndDate
ýý #
)
ýý# $
{
þþ 	 
SqlParameterHelper
ÿÿ 
sph
ÿÿ "
=
ÿÿ# $
new
ÿÿ% ( 
SqlParameterHelper
ÿÿ) ;
(
ÿÿ; <
ConnectionString
ÿÿ< L
.
ÿÿL M%
GetReadConnectionString
ÿÿM d
(
ÿÿd e
)
ÿÿe f
,
ÿÿf g
$str
ÿÿh 
,ÿÿ 
$numÿÿ 
)ÿÿ 
;ÿÿ 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
pageGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g

moduleGuid
h r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
pageId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
paneName
b j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleOrder
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
DateTime
B J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
publishBeginDate
f v
)
v w
;
w x
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
(
d e
publishEndDate
e s
==
t v
DateTime
w 
. 
MinValue 
) 
? 
( 
object 
) 
DBNull 
. 
Value  
:¡ ¢
(£ ¤
object¤ ª
)ª «
publishEndDate« ¹
)¹ º
;º »
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 
PageModuleUpdate
 +
(
+ ,
int
 
moduleId
 
,
 
int
 
pageId
 
,
 
String
 
paneName
 
,
 
int
 
moduleOrder
 
,
 
DateTime
 
publishBeginDate
 %
,
% &
DateTime
 
publishEndDate
 #
)
# $
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
moduleId
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
pageId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
paneName
b j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleOrder
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
DateTime
B J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
publishBeginDate
f v
)
v w
;
w x
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
(
d e
publishEndDate
e s
==
t v
DateTime
w 
. 
MinValue 
) 
? 
( 
object 
) 
DBNull 
. 
Value  
:¡ ¢
(£ ¤
object¤ ª
)ª «
publishEndDate« ¹
)¹ º
;º »
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 $
PageModuleDeleteByPage
 1
(
1 2
int
2 5
pageId
6 <
)
< =
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M&
GetWriteConnectionString
¡¡M e
(
¡¡e f
)
¡¡f g
,
¡¡g h
$str¡¡i 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# ,
,
¢¢, -
	SqlDbType
¢¢. 7
.
¢¢7 8
Int
¢¢8 ;
,
¢¢; < 
ParameterDirection
¢¢= O
.
¢¢O P
Input
¢¢P U
,
¢¢U V
pageId
¢¢W ]
)
¢¢] ^
;
¢¢^ _
int
££ 
rowsAffected
££ 
=
££ 
sph
££ "
.
££" #
ExecuteNonQuery
££# 2
(
££2 3
)
££3 4
;
££4 5
return
¤¤ 
(
¤¤ 
rowsAffected
¤¤  
>
¤¤! "
-
¤¤# $
$num
¤¤$ %
)
¤¤% &
;
¤¤& '
}
¥¥ 	
public
§§ 
static
§§ 
bool
§§ &
UpdateCountOfUseOnMyPage
§§ 3
(
§§3 4
int
§§4 7
moduleId
§§8 @
,
§§@ A
int
§§B E
	increment
§§F O
)
§§O P
{
¨¨ 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i 
,©© 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
Int
ªª: =
,
ªª= > 
ParameterDirection
ªª? Q
.
ªªQ R
Input
ªªR W
,
ªªW X
moduleId
ªªY a
)
ªªa b
;
ªªb c
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# /
,
««/ 0
	SqlDbType
««1 :
.
««: ;
Int
««; >
,
««> ? 
ParameterDirection
««@ R
.
««R S
Input
««S X
,
««X Y
	increment
««Z c
)
««c d
;
««d e
int
¬¬ 
rowsAffected
¬¬ 
=
¬¬ 
sph
¬¬ "
.
¬¬" #
ExecuteNonQuery
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
return
­­ 
(
­­ 
rowsAffected
­­  
>
­­! "
-
­­# $
$num
­­$ %
)
­­% &
;
­­& '
}
®® 	
public
°° 
static
°° 
bool
°° 
DeleteModule
°° '
(
°°' (
int
°°( +
moduleId
°°, 4
)
°°4 5
{
±± 	 
SqlParameterHelper
²² 
sph
²² "
=
²²# $
new
²²% ( 
SqlParameterHelper
²²) ;
(
²²; <
ConnectionString
²²< L
.
²²L M&
GetWriteConnectionString
²²M e
(
²²e f
)
²²f g
,
²²g h
$str
²²i |
,
²²| }
$num
²²~ 
)²² 
;²² 
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# .
,
³³. /
	SqlDbType
³³0 9
.
³³9 :
Int
³³: =
,
³³= > 
ParameterDirection
³³? Q
.
³³Q R
Input
³³R W
,
³³W X
moduleId
³³Y a
)
³³a b
;
³³b c
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ "
.
´´" #
ExecuteNonQuery
´´# 2
(
´´2 3
)
´´3 4
;
´´4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
-
µµ# $
$num
µµ$ %
)
µµ% &
;
µµ& '
}
¶¶ 	
public
¸¸ 
static
¸¸ 
bool
¸¸ "
DeleteModuleInstance
¸¸ /
(
¸¸/ 0
int
¸¸0 3
moduleId
¸¸4 <
,
¸¸< =
int
¸¸> A
pageId
¸¸B H
)
¸¸H I
{
¹¹ 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M&
GetWriteConnectionString
ººM e
(
ººe f
)
ººf g
,
ººg h
$strººi 
,ºº 
$numºº 
)ºº 
;ºº 
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# .
,
»». /
	SqlDbType
»»0 9
.
»»9 :
Int
»»: =
,
»»= > 
ParameterDirection
»»? Q
.
»»Q R
Input
»»R W
,
»»W X
moduleId
»»Y a
)
»»a b
;
»»b c
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# ,
,
¼¼, -
	SqlDbType
¼¼. 7
.
¼¼7 8
Int
¼¼8 ;
,
¼¼; < 
ParameterDirection
¼¼= O
.
¼¼O P
Input
¼¼P U
,
¼¼U V
pageId
¼¼W ]
)
¼¼] ^
;
¼¼^ _
int
½½ 
rowsAffected
½½ 
=
½½ 
sph
½½ "
.
½½" #
ExecuteNonQuery
½½# 2
(
½½2 3
)
½½3 4
;
½½4 5
return
¾¾ 
(
¾¾ 
rowsAffected
¾¾  
>
¾¾! "
-
¾¾# $
$num
¾¾$ %
)
¾¾% &
;
¾¾& '
}
¿¿ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !
	GetModule
ÁÁ" +
(
ÁÁ+ ,
int
ÁÁ, /
moduleId
ÁÁ0 8
)
ÁÁ8 9
{
ÂÂ 	 
SqlParameterHelper
ÃÃ 
sph
ÃÃ "
=
ÃÃ# $
new
ÃÃ% ( 
SqlParameterHelper
ÃÃ) ;
(
ÃÃ; <
ConnectionString
ÃÃ< L
.
ÃÃL M%
GetReadConnectionString
ÃÃM d
(
ÃÃd e
)
ÃÃe f
,
ÃÃf g
$str
ÃÃh ~
,
ÃÃ~ 
$numÃÃ 
)ÃÃ 
;ÃÃ 
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
Int
ÄÄ: =
,
ÄÄ= > 
ParameterDirection
ÄÄ? Q
.
ÄÄQ R
Input
ÄÄR W
,
ÄÄW X
moduleId
ÄÄY a
)
ÄÄa b
;
ÄÄb c
return
ÅÅ 
sph
ÅÅ 
.
ÅÅ 
ExecuteReader
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
;
ÅÅ& '
}
ÆÆ 	
public
ÈÈ 
static
ÈÈ 
IDataReader
ÈÈ !
	GetModule
ÈÈ" +
(
ÈÈ+ ,
Guid
ÈÈ, 0

moduleGuid
ÈÈ1 ;
)
ÈÈ; <
{
ÉÉ 	 
SqlParameterHelper
ÊÊ 
sph
ÊÊ "
=
ÊÊ# $
new
ÊÊ% ( 
SqlParameterHelper
ÊÊ) ;
(
ÊÊ; <
ConnectionString
ÊÊ< L
.
ÊÊL M%
GetReadConnectionString
ÊÊM d
(
ÊÊd e
)
ÊÊe f
,
ÊÊf g
$strÊÊh 
,ÊÊ 
$numÊÊ 
)ÊÊ 
;ÊÊ 
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# *
,
ËË* +
	SqlDbType
ËË, 5
.
ËË5 6
UniqueIdentifier
ËË6 F
,
ËËF G 
ParameterDirection
ËËH Z
.
ËËZ [
Input
ËË[ `
,
ËË` a

moduleGuid
ËËb l
)
ËËl m
;
ËËm n
return
ÌÌ 
sph
ÌÌ 
.
ÌÌ 
ExecuteReader
ÌÌ $
(
ÌÌ$ %
)
ÌÌ% &
;
ÌÌ& '
}
ÍÍ 	
public
ÏÏ 
static
ÏÏ 
IDataReader
ÏÏ !
	GetModule
ÏÏ" +
(
ÏÏ+ ,
int
ÏÏ, /
moduleId
ÏÏ0 8
,
ÏÏ8 9
int
ÏÏ: =
pageId
ÏÏ> D
)
ÏÏD E
{
ÐÐ 	 
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M%
GetReadConnectionString
ÑÑM d
(
ÑÑd e
)
ÑÑe f
,
ÑÑf g
$strÑÑh 
,ÑÑ 
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
Int
ÒÒ: =
,
ÒÒ= > 
ParameterDirection
ÒÒ? Q
.
ÒÒQ R
Input
ÒÒR W
,
ÒÒW X
moduleId
ÒÒY a
)
ÒÒa b
;
ÒÒb c
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# ,
,
ÓÓ, -
	SqlDbType
ÓÓ. 7
.
ÓÓ7 8
Int
ÓÓ8 ;
,
ÓÓ; < 
ParameterDirection
ÓÓ= O
.
ÓÓO P
Input
ÓÓP U
,
ÓÓU V
pageId
ÓÓW ]
)
ÓÓ] ^
;
ÓÓ^ _
return
ÔÔ 
sph
ÔÔ 
.
ÔÔ 
ExecuteReader
ÔÔ $
(
ÔÔ$ %
)
ÔÔ% &
;
ÔÔ& '
}
ÕÕ 	
public
×× 
static
×× 
IDataReader
×× !
GetPageModules
××" 0
(
××0 1
int
××1 4
pageId
××5 ;
)
××; <
{
ØØ 	 
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$strÙÙh 
,ÙÙ 
$numÙÙ 
)ÙÙ 
;ÙÙ 
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# ,
,
ÚÚ, -
	SqlDbType
ÚÚ. 7
.
ÚÚ7 8
Int
ÚÚ8 ;
,
ÚÚ; < 
ParameterDirection
ÚÚ= O
.
ÚÚO P
Input
ÚÚP U
,
ÚÚU V
pageId
ÚÚW ]
)
ÚÚ] ^
;
ÚÚ^ _
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# 1
,
ÛÛ1 2
	SqlDbType
ÛÛ3 <
.
ÛÛ< =
DateTime
ÛÛ= E
,
ÛÛE F 
ParameterDirection
ÛÛG Y
.
ÛÛY Z
Input
ÛÛZ _
,
ÛÛ_ `
DateTime
ÛÛa i
.
ÛÛi j
UtcNow
ÛÛj p
)
ÛÛp q
;
ÛÛq r
return
ÜÜ 
sph
ÜÜ 
.
ÜÜ 
ExecuteReader
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '
}
ÝÝ 	
public
àà 
static
àà 
IDataReader
àà !
GetMyPageModules
àà" 2
(
àà2 3
int
àà3 6
siteId
àà7 =
)
àà= >
{
áá 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M%
GetReadConnectionString
ââM d
(
ââd e
)
ââe f
,
ââf g
$strââh 
,ââ 
$numââ 
)ââ 
;ââ 
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# ,
,
ãã, -
	SqlDbType
ãã. 7
.
ãã7 8
Int
ãã8 ;
,
ãã; < 
ParameterDirection
ãã= O
.
ããO P
Input
ããP U
,
ããU V
siteId
ããW ]
)
ãã] ^
;
ãã^ _
return
ää 
sph
ää 
.
ää 
ExecuteReader
ää $
(
ää$ %
)
ää% &
;
ää& '
}
åå 	
public
çç 
static
çç 
IDataReader
çç !
GetModulesForSite
çç" 3
(
çç3 4
int
çç4 7
siteId
çç8 >
,
çç> ?
Guid
çç@ D
featureGuid
ççE P
)
ççP Q
{
èè 	 
SqlParameterHelper
éé 
sph
éé "
=
éé# $
new
éé% ( 
SqlParameterHelper
éé) ;
(
éé; <
ConnectionString
éé< L
.
ééL M%
GetReadConnectionString
ééM d
(
ééd e
)
éée f
,
ééf g
$strééh 
,éé 
$numéé 
)éé 
;éé 
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# ,
,
êê, -
	SqlDbType
êê. 7
.
êê7 8
Int
êê8 ;
,
êê; < 
ParameterDirection
êê= O
.
êêO P
Input
êêP U
,
êêU V
siteId
êêW ]
)
êê] ^
;
êê^ _
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 1
,
ëë1 2
	SqlDbType
ëë3 <
.
ëë< =
UniqueIdentifier
ëë= M
,
ëëM N 
ParameterDirection
ëëO a
.
ëëa b
Input
ëëb g
,
ëëg h
featureGuid
ëëi t
)
ëët u
;
ëëu v
return
ìì 
sph
ìì 
.
ìì 
ExecuteReader
ìì $
(
ìì$ %
)
ìì% &
;
ìì& '
}
íí 	
public
òò 
static
òò 
int
òò 
GetCount
òò "
(
òò" #
int
òò# &
siteId
òò' -
,
òò- .
int
òò/ 2
moduleDefId
òò3 >
,
òò> ?
string
òò@ F
title
òòG L
)
òòL M
{
óó 	 
SqlParameterHelper
ôô 
sph
ôô "
=
ôô# $
new
ôô% ( 
SqlParameterHelper
ôô) ;
(
ôô; <
ConnectionString
ôô< L
.
ôôL M%
GetReadConnectionString
ôôM d
(
ôôd e
)
ôôe f
,
ôôf g
$str
ôôh }
,
ôô} ~
$numôô 
)ôô 
;ôô 
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# ,
,
õõ, -
	SqlDbType
õõ. 7
.
õõ7 8
Int
õõ8 ;
,
õõ; < 
ParameterDirection
õõ= O
.
õõO P
Input
õõP U
,
õõU V
siteId
õõW ]
)
õõ] ^
;
õõ^ _
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 1
,
öö1 2
	SqlDbType
öö3 <
.
öö< =
Int
öö= @
,
öö@ A 
ParameterDirection
ööB T
.
ööT U
Input
ööU Z
,
ööZ [
moduleDefId
öö\ g
)
öög h
;
ööh i
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# +
,
÷÷+ ,
	SqlDbType
÷÷- 6
.
÷÷6 7
NVarChar
÷÷7 ?
,
÷÷? @
$num
÷÷A D
,
÷÷D E 
ParameterDirection
÷÷F X
.
÷÷X Y
Input
÷÷Y ^
,
÷÷^ _
title
÷÷` e
)
÷÷e f
;
÷÷f g
return
øø 
Convert
øø 
.
øø 
ToInt32
øø "
(
øø" #
sph
øø# &
.
øø& '
ExecuteScalar
øø' 4
(
øø4 5
)
øø5 6
)
øø6 7
;
øø7 8
}
ùù 	
public
ûû 
static
ûû 
	DataTable
ûû 

SelectPage
ûû  *
(
ûû* +
int
üü 
siteId
üü 
,
üü 
int
ýý 
moduleDefId
ýý 
,
ýý 
string
þþ 
title
þþ 
,
þþ 
int
ÿÿ 

pageNumber
ÿÿ 
,
ÿÿ 
int
 
pageSize
 
,
 
bool
 
sortByModuleType
 !
,
! "
bool
 
sortByAuthor
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCount
 $
(
$ %
siteId
% +
,
+ ,
moduleDefId
- 8
,
8 9
title
: ?
)
? @
;
@ A
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 (
=
) *
	totalRows
+ 4
/
5 6
pageSize
7 ?
;
? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleDefId
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
NVarChar
7 ?
,
? @
$num
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
title
` e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 6
,
6 7
	SqlDbType
8 A
.
A B
Bit
B E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
sortByModuleType
a q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
Bit
> A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
sortByAuthor
] i
)
i j
;
j k
	DataTable
¢¢ 
dt
¢¢ 
=
¢¢ 
new
¢¢ 
	DataTable
¢¢ (
(
¢¢( )
)
¢¢) *
;
¢¢* +
dt
££ 
.
££ 
Columns
££ 
.
££ 
Add
££ 
(
££ 
$str
££ %
,
££% &
typeof
££' -
(
££- .
int
££. 1
)
££1 2
)
££2 3
;
££3 4
dt
¤¤ 
.
¤¤ 
Columns
¤¤ 
.
¤¤ 
Add
¤¤ 
(
¤¤ 
$str
¤¤ (
,
¤¤( )
typeof
¤¤* 0
(
¤¤0 1
String
¤¤1 7
)
¤¤7 8
)
¤¤8 9
;
¤¤9 :
dt
¥¥ 
.
¥¥ 
Columns
¥¥ 
.
¥¥ 
Add
¥¥ 
(
¥¥ 
$str
¥¥ (
,
¥¥( )
typeof
¥¥* 0
(
¥¥0 1
String
¥¥1 7
)
¥¥7 8
)
¥¥8 9
;
¥¥9 :
dt
¦¦ 
.
¦¦ 
Columns
¦¦ 
.
¦¦ 
Add
¦¦ 
(
¦¦ 
$str
¦¦ )
,
¦¦) *
typeof
¦¦+ 1
(
¦¦1 2
String
¦¦2 8
)
¦¦8 9
)
¦¦9 :
;
¦¦: ;
dt
§§ 
.
§§ 
Columns
§§ 
.
§§ 
Add
§§ 
(
§§ 
$str
§§ '
,
§§' (
typeof
§§) /
(
§§/ 0
String
§§0 6
)
§§6 7
)
§§7 8
;
§§8 9
dt
¨¨ 
.
¨¨ 
Columns
¨¨ 
.
¨¨ 
Add
¨¨ 
(
¨¨ 
$str
¨¨ 0
,
¨¨0 1
typeof
¨¨2 8
(
¨¨8 9
String
¨¨9 ?
)
¨¨? @
)
¨¨@ A
;
¨¨A B
dt
©© 
.
©© 
Columns
©© 
.
©© 
Add
©© 
(
©© 
$str
©© &
,
©©& '
typeof
©©( .
(
©©. /
String
©©/ 5
)
©©5 6
)
©©6 7
;
©©7 8
dt
ªª 
.
ªª 
Columns
ªª 
.
ªª 
Add
ªª 
(
ªª 
$str
ªª (
,
ªª( )
typeof
ªª* 0
(
ªª0 1
DateTime
ªª1 9
)
ªª9 :
)
ªª: ;
;
ªª; <
dt
«« 
.
«« 
Columns
«« 
.
«« 
Add
«« 
(
«« 
$str
«« %
,
««% &
typeof
««' -
(
««- .
int
««. 1
)
««1 2
)
««2 3
;
««3 4
using
­­ 
(
­­ 
IDataReader
­­ 
reader
­­ %
=
­­& '
sph
­­( +
.
­­+ ,
ExecuteReader
­­, 9
(
­­9 :
)
­­: ;
)
­­; <
{
®® 
while
¯¯ 
(
¯¯ 
reader
¯¯ 
.
¯¯ 
Read
¯¯ "
(
¯¯" #
)
¯¯# $
)
¯¯$ %
{
°° 
DataRow
±± 
row
±± 
=
±±  !
dt
±±" $
.
±±$ %
NewRow
±±% +
(
±±+ ,
)
±±, -
;
±±- .
row
²² 
[
²² 
$str
²² "
]
²²" #
=
²²$ %
reader
²²& ,
[
²², -
$str
²²- 7
]
²²7 8
;
²²8 9
row
³³ 
[
³³ 
$str
³³ %
]
³³% &
=
³³' (
reader
³³) /
[
³³/ 0
$str
³³0 =
]
³³= >
;
³³> ?
row
´´ 
[
´´ 
$str
´´ %
]
´´% &
=
´´' (
reader
´´) /
[
´´/ 0
$str
´´0 =
]
´´= >
;
´´> ?
row
µµ 
[
µµ 
$str
µµ &
]
µµ& '
=
µµ( )
reader
µµ* 0
[
µµ0 1
$str
µµ1 ?
]
µµ? @
;
µµ@ A
row
¶¶ 
[
¶¶ 
$str
¶¶ $
]
¶¶$ %
=
¶¶& '
reader
¶¶( .
[
¶¶. /
$str
¶¶/ ;
]
¶¶; <
;
¶¶< =
row
·· 
[
·· 
$str
·· -
]
··- .
=
··/ 0
reader
··1 7
[
··7 8
$str
··8 M
]
··M N
;
··N O
row
¸¸ 
[
¸¸ 
$str
¸¸ #
]
¸¸# $
=
¸¸% &
reader
¸¸' -
[
¸¸- .
$str
¸¸. 9
]
¸¸9 :
;
¸¸: ;
row
¹¹ 
[
¹¹ 
$str
¹¹ %
]
¹¹% &
=
¹¹' (
reader
¹¹) /
[
¹¹/ 0
$str
¹¹0 =
]
¹¹= >
;
¹¹> ?
row
ºº 
[
ºº 
$str
ºº "
]
ºº" #
=
ºº$ %
reader
ºº& ,
[
ºº, -
$str
ºº- 7
]
ºº7 8
;
ºº8 9
dt
¼¼ 
.
¼¼ 
Rows
¼¼ 
.
¼¼ 
Add
¼¼ 
(
¼¼  
row
¼¼  #
)
¼¼# $
;
¼¼$ %
}
¾¾ 
}
ÀÀ 
return
ÂÂ 
dt
ÂÂ 
;
ÂÂ 
}
ÄÄ 	
public
ÆÆ 
static
ÆÆ 
int
ÆÆ 
GetCountByFeature
ÆÆ +
(
ÆÆ+ ,
int
ÆÆ, /
moduleDefId
ÆÆ0 ;
)
ÆÆ; <
{
ÇÇ 	 
SqlParameterHelper
ÉÉ 
sph
ÉÉ "
=
ÉÉ# $
new
ÉÉ% ( 
SqlParameterHelper
ÉÉ) ;
(
ÉÉ; <
ConnectionString
ÉÉ< L
.
ÉÉL M%
GetReadConnectionString
ÉÉM d
(
ÉÉd e
)
ÉÉe f
,
ÉÉf g
$strÉÉh 
,ÉÉ 
$numÉÉ 
)ÉÉ 
;ÉÉ 
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 1
,
ÊÊ1 2
	SqlDbType
ÊÊ3 <
.
ÊÊ< =
Int
ÊÊ= @
,
ÊÊ@ A 
ParameterDirection
ÊÊB T
.
ÊÊT U
Input
ÊÊU Z
,
ÊÊZ [
moduleDefId
ÊÊ\ g
)
ÊÊg h
;
ÊÊh i
return
ÌÌ 
Convert
ÌÌ 
.
ÌÌ 
ToInt32
ÌÌ "
(
ÌÌ" #
sph
ÌÌ# &
.
ÌÌ& '
ExecuteScalar
ÌÌ' 4
(
ÌÌ4 5
)
ÌÌ5 6
)
ÌÌ6 7
;
ÌÌ7 8
}
ÎÎ 	
public
ÑÑ 
static
ÑÑ 
int
ÑÑ 
GetGlobalCount
ÑÑ (
(
ÑÑ( )
int
ÑÑ) ,
siteId
ÑÑ- 3
,
ÑÑ3 4
int
ÑÑ5 8
moduleDefId
ÑÑ9 D
,
ÑÑD E
int
ÑÑF I
pageId
ÑÑJ P
)
ÑÑP Q
{
ÒÒ 	 
SqlParameterHelper
ÓÓ 
sph
ÓÓ "
=
ÓÓ# $
new
ÓÓ% ( 
SqlParameterHelper
ÓÓ) ;
(
ÓÓ; <
ConnectionString
ÓÓ< L
.
ÓÓL M%
GetReadConnectionString
ÓÓM d
(
ÓÓd e
)
ÓÓe f
,
ÓÓf g
$strÓÓh 
,ÓÓ 
$numÓÓ 
)ÓÓ 
;ÓÓ 
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# ,
,
ÔÔ, -
	SqlDbType
ÔÔ. 7
.
ÔÔ7 8
Int
ÔÔ8 ;
,
ÔÔ; < 
ParameterDirection
ÔÔ= O
.
ÔÔO P
Input
ÔÔP U
,
ÔÔU V
siteId
ÔÔW ]
)
ÔÔ] ^
;
ÔÔ^ _
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# 1
,
ÕÕ1 2
	SqlDbType
ÕÕ3 <
.
ÕÕ< =
Int
ÕÕ= @
,
ÕÕ@ A 
ParameterDirection
ÕÕB T
.
ÕÕT U
Input
ÕÕU Z
,
ÕÕZ [
moduleDefId
ÕÕ\ g
)
ÕÕg h
;
ÕÕh i
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# ,
,
ÖÖ, -
	SqlDbType
ÖÖ. 7
.
ÖÖ7 8
Int
ÖÖ8 ;
,
ÖÖ; < 
ParameterDirection
ÖÖ= O
.
ÖÖO P
Input
ÖÖP U
,
ÖÖU V
pageId
ÖÖW ]
)
ÖÖ] ^
;
ÖÖ^ _
return
ØØ 
Convert
ØØ 
.
ØØ 
ToInt32
ØØ "
(
ØØ" #
sph
ØØ# &
.
ØØ& '
ExecuteScalar
ØØ' 4
(
ØØ4 5
)
ØØ5 6
)
ØØ6 7
;
ØØ7 8
}
ÙÙ 	
public
ÛÛ 
static
ÛÛ 
	DataTable
ÛÛ 
SelectGlobalPage
ÛÛ  0
(
ÛÛ0 1
int
ÜÜ 
siteId
ÜÜ 
,
ÜÜ 
int
ÝÝ 
moduleDefId
ÝÝ 
,
ÝÝ 
int
ÞÞ 
pageId
ÞÞ 
,
ÞÞ 
int
ßß 

pageNumber
ßß 
,
ßß 
int
àà 
pageSize
àà 
,
àà 
out
áá 
int
áá 

totalPages
áá 
)
áá 
{
ââ 	

totalPages
ãã 
=
ãã 
$num
ãã 
;
ãã 
int
ää 
	totalRows
ää 
=
ää 
GetGlobalCount
ää *
(
ää* +
siteId
ää+ 1
,
ää1 2
moduleDefId
ää3 >
,
ää> ?
pageId
ää@ F
)
ääF G
;
ääG H
if
ææ 
(
ææ 
pageSize
ææ 
>
ææ 
$num
ææ 
)
ææ 

totalPages
ææ (
=
ææ) *
	totalRows
ææ+ 4
/
ææ5 6
pageSize
ææ7 ?
;
ææ? @
if
èè 
(
èè 
	totalRows
èè 
<=
èè 
pageSize
èè %
)
èè% &
{
éé 

totalPages
êê 
=
êê 
$num
êê 
;
êê 
}
ëë 
else
ìì 
{
íí 
int
îî 
	remainder
îî 
;
îî 
Math
ïï 
.
ïï 
DivRem
ïï 
(
ïï 
	totalRows
ïï %
,
ïï% &
pageSize
ïï' /
,
ïï/ 0
out
ïï1 4
	remainder
ïï5 >
)
ïï> ?
;
ïï? @
if
ðð 
(
ðð 
	remainder
ðð 
>
ðð 
$num
ðð  !
)
ðð! "
{
ññ 

totalPages
òò 
+=
òò !
$num
òò" #
;
òò# $
}
óó 
}
ôô  
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M%
GetReadConnectionString
ööM d
(
ööd e
)
ööe f
,
ööf g
$strööh 
,öö 
$numöö 
)öö 
;öö 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# ,
,
÷÷, -
	SqlDbType
÷÷. 7
.
÷÷7 8
Int
÷÷8 ;
,
÷÷; < 
ParameterDirection
÷÷= O
.
÷÷O P
Input
÷÷P U
,
÷÷U V
siteId
÷÷W ]
)
÷÷] ^
;
÷÷^ _
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# 1
,
øø1 2
	SqlDbType
øø3 <
.
øø< =
Int
øø= @
,
øø@ A 
ParameterDirection
øøB T
.
øøT U
Input
øøU Z
,
øøZ [
moduleDefId
øø\ g
)
øøg h
;
øøh i
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# ,
,
ùù, -
	SqlDbType
ùù. 7
.
ùù7 8
Int
ùù8 ;
,
ùù; < 
ParameterDirection
ùù= O
.
ùùO P
Input
ùùP U
,
ùùU V
pageId
ùùW ]
)
ùù] ^
;
ùù^ _
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 0
,
úú0 1
	SqlDbType
úú2 ;
.
úú; <
Int
úú< ?
,
úú? @ 
ParameterDirection
úúA S
.
úúS T
Input
úúT Y
,
úúY Z

pageNumber
úú[ e
)
úúe f
;
úúf g
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# .
,
ûû. /
	SqlDbType
ûû0 9
.
ûû9 :
Int
ûû: =
,
ûû= > 
ParameterDirection
ûû? Q
.
ûûQ R
Input
ûûR W
,
ûûW X
pageSize
ûûY a
)
ûûa b
;
ûûb c
	DataTable
ÿÿ 
dt
ÿÿ 
=
ÿÿ 
new
ÿÿ 
	DataTable
ÿÿ (
(
ÿÿ( )
)
ÿÿ) *
;
ÿÿ* +
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 %
,
% &
typeof
' -
(
- .
int
. 1
)
1 2
)
2 3
;
3 4
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 (
,
( )
typeof
* 0
(
0 1
String
1 7
)
7 8
)
8 9
;
9 :
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 (
,
( )
typeof
* 0
(
0 1
String
1 7
)
7 8
)
8 9
;
9 :
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 )
,
) *
typeof
+ 1
(
1 2
String
2 8
)
8 9
)
9 :
;
: ;
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 '
,
' (
typeof
) /
(
/ 0
String
0 6
)
6 7
)
7 8
;
8 9
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 0
,
0 1
typeof
2 8
(
8 9
String
9 ?
)
? @
)
@ A
;
A B
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 &
,
& '
typeof
( .
(
. /
String
/ 5
)
5 6
)
6 7
;
7 8
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 (
,
( )
typeof
* 0
(
0 1
DateTime
1 9
)
9 :
)
: ;
;
; <
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 %
,
% &
typeof
' -
(
- .
int
. 1
)
1 2
)
2 3
;
3 4
using
 
(
 
IDataReader
 
reader
 %
=
& '
sph
( +
.
+ ,
ExecuteReader
, 9
(
9 :
)
: ;
)
; <
{
 
while
 
(
 
reader
 
.
 
Read
 "
(
" #
)
# $
)
$ %
{
 
DataRow
 
row
 
=
  !
dt
" $
.
$ %
NewRow
% +
(
+ ,
)
, -
;
- .
row
 
[
 
$str
 "
]
" #
=
$ %
reader
& ,
[
, -
$str
- 7
]
7 8
;
8 9
row
 
[
 
$str
 %
]
% &
=
' (
reader
) /
[
/ 0
$str
0 =
]
= >
;
> ?
row
 
[
 
$str
 %
]
% &
=
' (
reader
) /
[
/ 0
$str
0 =
]
= >
;
> ?
row
 
[
 
$str
 &
]
& '
=
( )
reader
* 0
[
0 1
$str
1 ?
]
? @
;
@ A
row
 
[
 
$str
 $
]
$ %
=
& '
reader
( .
[
. /
$str
/ ;
]
; <
;
< =
row
 
[
 
$str
 -
]
- .
=
/ 0
reader
1 7
[
7 8
$str
8 M
]
M N
;
N O
row
 
[
 
$str
 #
]
# $
=
% &
reader
' -
[
- .
$str
. 9
]
9 :
;
: ;
row
 
[
 
$str
 %
]
% &
=
' (
reader
) /
[
/ 0
$str
0 =
]
= >
;
> ?
row
 
[
 
$str
 "
]
" #
=
$ %
reader
& ,
[
, -
$str
- 7
]
7 8
;
8 9
dt
 
.
 
Rows
 
.
 
Add
 
(
  
row
  #
)
# $
;
$ %
}
 
}
 
return
 
dt
 
;
 
}
¡¡ 	
public
££ 
static
££	 
IDataReader
££ 
GetGlobalContent
££ ,
(
££, -
int
££- 0
siteId
££1 7
)
££7 8
{
¤¤  
SqlParameterHelper
¥¥ 
sph
¥¥ 
=
¥¥ 
new
¥¥  
SqlParameterHelper
¥¥  2
(
¥¥2 3
ConnectionString
¥¥3 C
.
¥¥C D%
GetReadConnectionString
¥¥D [
(
¥¥[ \
)
¥¥\ ]
,
¥¥] ^
$str
¥¥_ 
,¥¥ 
$num¥¥ 
)¥¥ 
;¥¥ 
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ 
(
¦¦ 
$str
¦¦ #
,
¦¦# $
	SqlDbType
¦¦% .
.
¦¦. /
Int
¦¦/ 2
,
¦¦2 3 
ParameterDirection
¦¦4 F
.
¦¦F G
Input
¦¦G L
,
¦¦L M
siteId
¦¦N T
)
¦¦T U
;
¦¦U V
return
§§ 	
sph
§§
 
.
§§ 
ExecuteReader
§§ 
(
§§ 
)
§§ 
;
§§ 
}
¨¨ 
}
©© 
}ªª ¾ø
rD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModuleDefinition.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModuleDefinition *
{ 
public 
static 
int 
AddModuleDefinition -
(- .
Guid 
featureGuid 
, 
int 
siteId 
, 
string   
featureName   
,   
string!! 

controlSrc!! 
,!! 
int"" 
	sortOrder"" 
,"" 
int## 
defaultCacheTime##  
,##  !
String$$ 
icon$$ 
,$$ 
bool%% 
isAdmin%% 
,%% 
string&& 
resourceFile&& 
,&&  
bool'' 
isCacheable'' 
,'' 
bool(( 
isSearchable(( 
,(( 
string)) 
searchListName)) !
,))! "
bool** 
supportsPageReuse** "
,**" #
string++ 
deleteProvider++ !
,++! "
string,, 
partialView,, 
,,, 
string-- 	
skinFileName--
 
)-- 
{.. 	
SqlParameterHelper// 
sph// "
=//# $
new//% (
SqlParameterHelper//) ;
(//; <
ConnectionString//< L
.//L M$
GetWriteConnectionString//M e
(//e f
)//f g
,//g h
$str	//i 
,
// 
$num
// 
)
// 
;
// 
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# ,
,00, -
	SqlDbType00. 7
.007 8
Int008 ;
,00; <
ParameterDirection00= O
.00O P
Input00P U
,00U V
siteId00W ]
)00] ^
;00^ _
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 1
,111 2
	SqlDbType113 <
.11< =
NVarChar11= E
,11E F
$num11G J
,11J K
ParameterDirection11L ^
.11^ _
Input11_ d
,11d e
featureName11f q
)11q r
;11r s
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# 0
,220 1
	SqlDbType222 ;
.22; <
NVarChar22< D
,22D E
$num22F I
,22I J
ParameterDirection22K ]
.22] ^
Input22^ c
,22c d

controlSrc22e o
)22o p
;22p q
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
Int33; >
,33> ?
ParameterDirection33@ R
.33R S
Input33S X
,33X Y
	sortOrder33Z c
)33c d
;33d e
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# -
,44- .
	SqlDbType44/ 8
.448 9
Bit449 <
,44< =
ParameterDirection44> P
.44P Q
Input44Q V
,44V W
isAdmin44X _
)44_ `
;44` a
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# *
,55* +
	SqlDbType55, 5
.555 6
NVarChar556 >
,55> ?
$num55@ C
,55C D
ParameterDirection55E W
.55W X
Input55X ]
,55] ^
icon55_ c
)55c d
;55d e
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 6
,666 7
	SqlDbType668 A
.66A B
Int66B E
,66E F
ParameterDirection66G Y
.66Y Z
Input66Z _
,66_ `
defaultCacheTime66a q
)66q r
;66r s
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 1
,771 2
	SqlDbType773 <
.77< =
UniqueIdentifier77= M
,77M N
ParameterDirection77O a
.77a b
Input77b g
,77g h
featureGuid77i t
)77t u
;77u v
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# 2
,882 3
	SqlDbType884 =
.88= >
NVarChar88> F
,88F G
$num88H K
,88K L
ParameterDirection88M _
.88_ `
Input88` e
,88e f
resourceFile88g s
)88s t
;88t u
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# 1
,991 2
	SqlDbType993 <
.99< =
Bit99= @
,99@ A
ParameterDirection99B T
.99T U
Input99U Z
,99Z [
isCacheable99\ g
)99g h
;99h i
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 2
,::2 3
	SqlDbType::4 =
.::= >
Bit::> A
,::A B
ParameterDirection::C U
.::U V
Input::V [
,::[ \
isSearchable::] i
)::i j
;::j k
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# 4
,;;4 5
	SqlDbType;;6 ?
.;;? @
NVarChar;;@ H
,;;H I
$num;;J M
,;;M N
ParameterDirection;;O a
.;;a b
Input;;b g
,;;g h
searchListName;;i w
);;w x
;;;x y
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# 7
,<<7 8
	SqlDbType<<9 B
.<<B C
Bit<<C F
,<<F G
ParameterDirection<<H Z
.<<Z [
Input<<[ `
,<<` a
supportsPageReuse<<b s
)<<s t
;<<t u
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 4
,==4 5
	SqlDbType==6 ?
.==? @
NVarChar==@ H
,==H I
$num==J M
,==M N
ParameterDirection==O a
.==a b
Input==b g
,==g h
deleteProvider==i w
)==w x
;==x y
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># 1
,>>1 2
	SqlDbType>>3 <
.>>< =
NVarChar>>= E
,>>E F
$num>>G J
,>>J K
ParameterDirection>>L ^
.>>^ _
Input>>_ d
,>>d e
partialView>>f q
)>>q r
;>>r s
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# 2
,??2 3
	SqlDbType??4 =
.??= >
NVarChar??> F
,??F G
$num??H K
,??K L
ParameterDirection??M _
.??_ `
Input??` e
,??e f
skinFileName??g s
)??s t
;??t u
intBB 
newIDBB 
=BB 
ConvertBB 
.BB 
ToInt32BB 
(BB 
sphBB "
.BB" #
ExecuteScalarBB# 0
(BB0 1
)BB1 2
)BB2 3
;BB3 4
returnCC 
newIDCC 
;CC 
}DD 	
publicFF 
staticFF 
boolFF "
UpdateModuleDefinitionFF 1
(FF1 2
intGG 
moduleDefIdGG 
,GG 
stringHH 
featureNameHH 
,HH 
stringII 

controlSrcII 
,II 
intJJ 
	sortOrderJJ 
,JJ 
intKK 
defaultCacheTimeKK  
,KK  !
stringLL 
iconLL 
,LL 
boolMM 
isAdminMM 
,MM 
stringNN 
resourceFileNN 
,NN  
boolOO 
isCacheableOO 
,OO 
boolPP 
isSearchablePP 
,PP 
stringQQ 
searchListNameQQ !
,QQ! "
boolRR 
supportsPageReuseRR "
,RR" #
stringSS 
deleteProviderSS !
,SS! "
stringTT 
partialViewTT 
,TT 
stringUU 	
skinFileNameUU
 
)UU 
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M$
GetWriteConnectionStringWWM e
(WWe f
)WWf g
,WWg h
$str	WWi 
,
WW 
$num
WW 
)
WW 
;
WW 
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 1
,XX1 2
	SqlDbTypeXX3 <
.XX< =
IntXX= @
,XX@ A
ParameterDirectionXXB T
.XXT U
InputXXU Z
,XXZ [
moduleDefIdXX\ g
)XXg h
;XXh i
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 1
,YY1 2
	SqlDbTypeYY3 <
.YY< =
NVarCharYY= E
,YYE F
$numYYG J
,YYJ K
ParameterDirectionYYL ^
.YY^ _
InputYY_ d
,YYd e
featureNameYYf q
)YYq r
;YYr s
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 0
,ZZ0 1
	SqlDbTypeZZ2 ;
.ZZ; <
NVarCharZZ< D
,ZZD E
$numZZF I
,ZZI J
ParameterDirectionZZK ]
.ZZ] ^
InputZZ^ c
,ZZc d

controlSrcZZe o
)ZZo p
;ZZp q
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# /
,[[/ 0
	SqlDbType[[1 :
.[[: ;
Int[[; >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
	sortOrder[[Z c
)[[c d
;[[d e
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# -
,\\- .
	SqlDbType\\/ 8
.\\8 9
Bit\\9 <
,\\< =
ParameterDirection\\> P
.\\P Q
Input\\Q V
,\\V W
isAdmin\\X _
)\\_ `
;\\` a
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
NVarChar]]6 >
,]]> ?
$num]]@ C
,]]C D
ParameterDirection]]E W
.]]W X
Input]]X ]
,]]] ^
icon]]_ c
)]]c d
;]]d e
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 6
,^^6 7
	SqlDbType^^8 A
.^^A B
Int^^B E
,^^E F
ParameterDirection^^G Y
.^^Y Z
Input^^Z _
,^^_ `
defaultCacheTime^^a q
)^^q r
;^^r s
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 2
,__2 3
	SqlDbType__4 =
.__= >
NVarChar__> F
,__F G
$num__H K
,__K L
ParameterDirection__M _
.___ `
Input__` e
,__e f
resourceFile__g s
)__s t
;__t u
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 1
,``1 2
	SqlDbType``3 <
.``< =
Bit``= @
,``@ A
ParameterDirection``B T
.``T U
Input``U Z
,``Z [
isCacheable``\ g
)``g h
;``h i
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
Bitaa> A
,aaA B
ParameterDirectionaaC U
.aaU V
InputaaV [
,aa[ \
isSearchableaa] i
)aai j
;aaj k
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 4
,bb4 5
	SqlDbTypebb6 ?
.bb? @
NVarCharbb@ H
,bbH I
$numbbJ M
,bbM N
ParameterDirectionbbO a
.bba b
Inputbbb g
,bbg h
searchListNamebbi w
)bbw x
;bbx y
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 7
,cc7 8
	SqlDbTypecc9 B
.ccB C
BitccC F
,ccF G
ParameterDirectionccH Z
.ccZ [
Inputcc[ `
,cc` a
supportsPageReuseccb s
)ccs t
;cct u
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 4
,dd4 5
	SqlDbTypedd6 ?
.dd? @
NVarChardd@ H
,ddH I
$numddJ M
,ddM N
ParameterDirectionddO a
.dda b
Inputddb g
,ddg h
deleteProviderddi w
)ddw x
;ddx y
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# 1
,ee1 2
	SqlDbTypeee3 <
.ee< =
NVarCharee= E
,eeE F
$numeeG J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e
partialVieweef q
)eeq r
;eer s
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 2
,ff2 3
	SqlDbTypeff4 =
.ff= >
NVarCharff> F
,ffF G
$numffH K
,ffK L
ParameterDirectionffM _
.ff_ `
Inputff` e
,ffe f
skinFileNameffg s
)ffs t
;fft u
intgg 
rowsAffectedgg 
=gg 
sphgg 
.gg 
ExecuteNonQuerygg )
(gg) *
)gg* +
;gg+ ,
returnhh 
(hh 
rowsAffectedhh  
>hh! "
-hh# $
$numhh$ %
)hh% &
;hh& '
}ii 	
publickk 
statickk 
boolkk '
UpdateSiteModulePermissionskk 6
(kk6 7
intkk7 :
siteIdkk; A
,kkA B
intkkC F
moduleDefIdkkG R
,kkR S
stringkkT Z
authorizedRoleskk[ j
)kkj k
{ll 	
SqlParameterHelpermm 
sphmm "
=mm# $
newmm% (
SqlParameterHelpermm) ;
(mm; <
ConnectionStringmm< L
.mmL M$
GetWriteConnectionStringmmM e
(mme f
)mmf g
,mmg h
$str	mmi 
,
mm 
$num
mm 
)
mm 
;
mm 
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# ,
,nn, -
	SqlDbTypenn. 7
.nn7 8
Intnn8 ;
,nn; <
ParameterDirectionnn= O
.nnO P
InputnnP U
,nnU V
siteIdnnW ]
)nn] ^
;nn^ _
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 1
,oo1 2
	SqlDbTypeoo3 <
.oo< =
Intoo= @
,oo@ A
ParameterDirectionooB T
.ooT U
InputooU Z
,ooZ [
moduleDefIdoo\ g
)oog h
;ooh i
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 5
,pp5 6
	SqlDbTypepp7 @
.pp@ A
NVarCharppA I
,ppI J
-ppK L
$numppL M
,ppM N
ParameterDirectionppO a
.ppa b
Inputppb g
,ppg h
authorizedRolesppi x
)ppx y
;ppy z
intqq 
rowsAffectedqq 
=qq 
sphqq "
.qq" #
ExecuteNonQueryqq# 2
(qq2 3
)qq3 4
;qq4 5
returnrr 
(rr 
rowsAffectedrr  
>rr! "
-rr# $
$numrr$ %
)rr% &
;rr& '
}tt 	
publicvv 
staticvv 
boolvv "
DeleteModuleDefinitionvv 1
(vv1 2
intvv2 5
moduleDefIdvv6 A
)vvA B
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M$
GetWriteConnectionStringxxM e
(xxe f
)xxf g
,xxg h
$str	xxi 
,
xx 
$num
xx 
)
xx 
;
xx 
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 1
,yy1 2
	SqlDbTypeyy3 <
.yy< =
Intyy= @
,yy@ A
ParameterDirectionyyB T
.yyT U
InputyyU Z
,yyZ [
moduleDefIdyy\ g
)yyg h
;yyh i
intzz 
rowsAffectedzz 
=zz 
sphzz "
.zz" #
ExecuteNonQueryzz# 2
(zz2 3
)zz3 4
;zz4 5
return{{ 
({{ 
rowsAffected{{  
>{{! "
-{{# $
$num{{$ %
){{% &
;{{& '
}|| 	
public~~ 
static~~ 
bool~~ +
DeleteModuleDefinitionFromSites~~ :
(~~: ;
int~~; >
moduleDefId~~? J
)~~J K
{ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleDefId
\ g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 
DeleteSettingById
 ,
(
, -
int
- 0
id
1 3
)
3 4
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# (
,
( )
	SqlDbType
* 3
.
3 4
Int
4 7
,
7 8 
ParameterDirection
9 K
.
K L
Input
L Q
,
Q R
id
S U
)
U V
;
V W
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 %
DeleteSettingsByFeature
 2
(
2 3
int
3 6
moduleDefId
7 B
)
B C
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleDefId
\ g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !!
GetModuleDefinition
" 5
(
5 6
int
 
moduleDefId
 
)
  
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleDefId
\ g
)
g h
;
h i
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !!
GetModuleDefinition
" 5
(
5 6
Guid
 
featureGuid
 
)
 
{
   	 
SqlParameterHelper
¡¡ 
sph
¡¡ "
=
¡¡# $
new
¡¡% ( 
SqlParameterHelper
¡¡) ;
(
¡¡; <
ConnectionString
¡¡< L
.
¡¡L M%
GetReadConnectionString
¡¡M d
(
¡¡d e
)
¡¡e f
,
¡¡f g
$str¡¡h 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# 1
,
¢¢1 2
	SqlDbType
¢¢3 <
.
¢¢< =
UniqueIdentifier
¢¢= M
,
¢¢M N 
ParameterDirection
¢¢O a
.
¢¢a b
Input
¢¢b g
,
¢¢g h
featureGuid
¢¢i t
)
¢¢t u
;
¢¢u v
return
££ 
sph
££ 
.
££ 
ExecuteReader
££ $
(
££$ %
)
££% &
;
££& '
}
¤¤ 	
public
¦¦ 
static
¦¦ 
void
¦¦ ,
EnsureInstallationInAdminSites
¦¦ 9
(
¦¦9 :
)
¦¦: ;
{
§§ 	
new
¨¨  
SqlParameterHelper
¨¨ "
(
¨¨" #
ConnectionString
¨¨# 3
.
¨¨3 4&
GetWriteConnectionString
¨¨4 L
(
¨¨L M
)
¨¨M N
,
¨¨N O
$str
¨¨P ~
,
¨¨~ 
$num¨¨ 
)¨¨ 
.¨¨ 
ExecuteNonQuery¨¨ 
(¨¨ 
)¨¨ 
;¨¨ 
}
©© 	
public
«« 
static
«« 
IDataReader
«« !"
GetModuleDefinitions
««" 6
(
««6 7
Guid
««7 ;
siteGuid
««< D
)
««D E
{
¬¬ 	 
SqlParameterHelper
­­ 
sph
­­ "
=
­­# $
new
­­% ( 
SqlParameterHelper
­­) ;
(
­­; <
ConnectionString
­­< L
.
­­L M%
GetReadConnectionString
­­M d
(
­­d e
)
­­e f
,
­­f g
$str­­h 
,­­ 
$num­­ 
)­­ 
;­­ 
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# .
,
®®. /
	SqlDbType
®®0 9
.
®®9 :
UniqueIdentifier
®®: J
,
®®J K 
ParameterDirection
®®L ^
.
®®^ _
Input
®®_ d
,
®®d e
siteGuid
®®f n
)
®®n o
;
®®o p
return
¯¯ 
sph
¯¯ 
.
¯¯ 
ExecuteReader
¯¯ $
(
¯¯$ %
)
¯¯% &
;
¯¯& '
}
°° 	
public
²² 
static
²² 
	DataTable
²² (
GetModuleDefinitionsBySite
²²  :
(
²²: ;
Guid
²²; ?
siteGuid
²²@ H
)
²²H I
{
³³ 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M%
GetReadConnectionString
´´M d
(
´´d e
)
´´e f
,
´´f g
$str´´h 
,´´ 
$num´´ 
)´´ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
UniqueIdentifier
µµ: J
,
µµJ K 
ParameterDirection
µµL ^
.
µµ^ _
Input
µµ_ d
,
µµd e
siteGuid
µµf n
)
µµn o
;
µµo p
	DataTable
·· 
dt
·· 
=
·· 
new
·· 
	DataTable
·· (
(
··( )
)
··) *
;
··* +
dt
¸¸ 
.
¸¸ 
Columns
¸¸ 
.
¸¸ 
Add
¸¸ 
(
¸¸ 
$str
¸¸ (
,
¸¸( )
typeof
¸¸* 0
(
¸¸0 1
int
¸¸1 4
)
¸¸4 5
)
¸¸5 6
;
¸¸6 7
dt
¹¹ 
.
¹¹ 
Columns
¹¹ 
.
¹¹ 
Add
¹¹ 
(
¹¹ 
$str
¹¹ (
,
¹¹( )
typeof
¹¹* 0
(
¹¹0 1
String
¹¹1 7
)
¹¹7 8
)
¹¹8 9
;
¹¹9 :
dt
ºº 
.
ºº 
Columns
ºº 
.
ºº 
Add
ºº 
(
ºº 
$str
ºº (
,
ºº( )
typeof
ºº* 0
(
ºº0 1
String
ºº1 7
)
ºº7 8
)
ºº8 9
;
ºº9 :
dt
»» 
.
»» 
Columns
»» 
.
»» 
Add
»» 
(
»» 
$str
»» '
,
»»' (
typeof
»») /
(
»»/ 0
String
»»0 6
)
»»6 7
)
»»7 8
;
»»8 9
dt
¼¼ 
.
¼¼ 
Columns
¼¼ 
.
¼¼ 
Add
¼¼ 
(
¼¼ 
$str
¼¼ ,
,
¼¼, -
typeof
¼¼. 4
(
¼¼4 5
String
¼¼5 ;
)
¼¼; <
)
¼¼< =
;
¼¼= >
using
¾¾ 
(
¾¾ 
IDataReader
¾¾ 
reader
¾¾ %
=
¾¾& '
sph
¾¾( +
.
¾¾+ ,
ExecuteReader
¾¾, 9
(
¾¾9 :
)
¾¾: ;
)
¾¾; <
{
¿¿ 
while
ÀÀ 
(
ÀÀ 
reader
ÀÀ 
.
ÀÀ 
Read
ÀÀ "
(
ÀÀ" #
)
ÀÀ# $
)
ÀÀ$ %
{
ÁÁ 
DataRow
ÂÂ 
row
ÂÂ 
=
ÂÂ  !
dt
ÂÂ" $
.
ÂÂ$ %
NewRow
ÂÂ% +
(
ÂÂ+ ,
)
ÂÂ, -
;
ÂÂ- .
row
ÃÃ 
[
ÃÃ 
$str
ÃÃ %
]
ÃÃ% &
=
ÃÃ' (
reader
ÃÃ) /
[
ÃÃ/ 0
$str
ÃÃ0 =
]
ÃÃ= >
;
ÃÃ> ?
row
ÄÄ 
[
ÄÄ 
$str
ÄÄ %
]
ÄÄ% &
=
ÄÄ' (
reader
ÄÄ) /
[
ÄÄ/ 0
$str
ÄÄ0 6
]
ÄÄ6 7
.
ÄÄ7 8
ToString
ÄÄ8 @
(
ÄÄ@ A
)
ÄÄA B
;
ÄÄB C
row
ÅÅ 
[
ÅÅ 
$str
ÅÅ %
]
ÅÅ% &
=
ÅÅ' (
reader
ÅÅ) /
[
ÅÅ/ 0
$str
ÅÅ0 =
]
ÅÅ= >
;
ÅÅ> ?
row
ÆÆ 
[
ÆÆ 
$str
ÆÆ $
]
ÆÆ$ %
=
ÆÆ& '
reader
ÆÆ( .
[
ÆÆ. /
$str
ÆÆ/ ;
]
ÆÆ; <
;
ÆÆ< =
row
ÇÇ 
[
ÇÇ 
$str
ÇÇ )
]
ÇÇ) *
=
ÇÇ+ ,
reader
ÇÇ- 3
[
ÇÇ3 4
$str
ÇÇ4 E
]
ÇÇE F
;
ÇÇF G
dt
ÈÈ 
.
ÈÈ 
Rows
ÈÈ 
.
ÈÈ 
Add
ÈÈ 
(
ÈÈ  
row
ÈÈ  #
)
ÈÈ# $
;
ÈÈ$ %
}
ÉÉ 
}
ÊÊ 
return
ËË 
dt
ËË 
;
ËË 
}
ÌÌ 	
public
ÎÎ 
static
ÎÎ	 
IDataReader
ÎÎ /
!GetModuleDefinitionBySkinFileName
ÎÎ =
(
ÎÎ= >
string
ÎÎ> D
skinFileName
ÎÎE Q
)
ÎÎQ R
{
ÏÏ  
SqlParameterHelper
ÐÐ 
sph
ÐÐ 
=
ÐÐ 
new
ÐÐ  
SqlParameterHelper
ÐÐ  2
(
ÐÐ2 3
ConnectionString
ÐÐ3 C
.
ÐÐC D%
GetReadConnectionString
ÐÐD [
(
ÐÐ[ \
)
ÐÐ\ ]
,
ÐÐ] ^
$strÐÐ_ 
,ÐÐ 
$numÐÐ 
)ÐÐ 
;ÐÐ 
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ 
(
ÑÑ 
$str
ÑÑ )
,
ÑÑ) *
	SqlDbType
ÑÑ+ 4
.
ÑÑ4 5
NVarChar
ÑÑ5 =
,
ÑÑ= > 
ParameterDirection
ÑÑ? Q
.
ÑÑQ R
Input
ÑÑR W
,
ÑÑW X
skinFileName
ÑÑY e
)
ÑÑe f
;
ÑÑf g
return
ÒÒ 	
sph
ÒÒ
 
.
ÒÒ 
ExecuteReader
ÒÒ 
(
ÒÒ 
)
ÒÒ 
;
ÒÒ 
}
ÓÓ 
public
ÕÕ 
static
ÕÕ	 
IDataReader
ÕÕ '
GetAllModuleSkinFileNames
ÕÕ 5
(
ÕÕ5 6
)
ÕÕ6 7
{
ÖÖ  
SqlParameterHelper
×× 
sph
×× 
=
×× 
new
××  
SqlParameterHelper
××  2
(
××2 3
ConnectionString
××3 C
.
××C D%
GetReadConnectionString
××D [
(
××[ \
)
××\ ]
,
××] ^
$str××_ 
,×× 
$num×× 
)×× 
;×× 
return
ØØ 	
sph
ØØ
 
.
ØØ 
ExecuteReader
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
}
ÙÙ 
public
ÛÛ 
static
ÛÛ	 
IDataReader
ÛÛ 
GetUserModules
ÛÛ *
(
ÛÛ* +
int
ÛÛ+ .
siteId
ÛÛ/ 5
)
ÛÛ5 6
{
ÜÜ 	 
SqlParameterHelper
ÝÝ 
sph
ÝÝ "
=
ÝÝ# $
new
ÝÝ% ( 
SqlParameterHelper
ÝÝ) ;
(
ÝÝ; <
ConnectionString
ÝÝ< L
.
ÝÝL M%
GetReadConnectionString
ÝÝM d
(
ÝÝd e
)
ÝÝe f
,
ÝÝf g
$strÝÝh 
,ÝÝ 
$numÝÝ 
)ÝÝ 
;ÝÝ 
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# ,
,
ÞÞ, -
	SqlDbType
ÞÞ. 7
.
ÞÞ7 8
Int
ÞÞ8 ;
,
ÞÞ; < 
ParameterDirection
ÞÞ= O
.
ÞÞO P
Input
ÞÞP U
,
ÞÞU V
siteId
ÞÞW ]
)
ÞÞ] ^
;
ÞÞ^ _
return
ßß 
sph
ßß 
.
ßß 
ExecuteReader
ßß $
(
ßß$ %
)
ßß% &
;
ßß& '
}
àà 	
public
ââ 
static
ââ 
IDataReader
ââ !"
GetSearchableModules
ââ" 6
(
ââ6 7
int
ââ7 :
siteId
ââ; A
)
ââA B
{
ãã 	 
SqlParameterHelper
ää 
sph
ää "
=
ää# $
new
ää% ( 
SqlParameterHelper
ää) ;
(
ää; <
ConnectionString
ää< L
.
ääL M%
GetReadConnectionString
ääM d
(
ääd e
)
ääe f
,
ääf g
$strääh 
,ää 
$numää 
)ää 
;ää 
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# ,
,
åå, -
	SqlDbType
åå. 7
.
åå7 8
Int
åå8 ;
,
åå; < 
ParameterDirection
åå= O
.
ååO P
Input
ååP U
,
ååU V
siteId
ååW ]
)
åå] ^
;
åå^ _
return
ææ 
sph
ææ 
.
ææ 
ExecuteReader
ææ $
(
ææ$ %
)
ææ% &
;
ææ& '
}
çç 	
public
òò 
static
òò 
bool
òò +
UpdateModuleDefinitionSetting
òò 8
(
òò8 9
Guid
óó 
featureGuid
óó 
,
óó 
int
ôô 
moduleDefId
ôô 
,
ôô 
string
õõ 
resourceFile
õõ 
,
õõ  
string
öö 
	groupName
öö 
,
öö 
string
÷÷ 
settingName
÷÷ 
,
÷÷ 
string
øø 
settingValue
øø 
,
øø  
string
ùù 
controlType
ùù 
,
ùù 
string
úú '
regexValidationExpression
úú ,
,
úú, -
string
ûû 

controlSrc
ûû 
,
ûû 
string
üü 
helpKey
üü 
,
üü 
int
ýý 
	sortOrder
ýý 
,
ýý 
string
þþ 	

attributes
þþ
 
,
þþ 
string
ÿÿ 	
options
ÿÿ
 
)
ÿÿ 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
moduleDefId
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
settingName
e p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
-
H I
$num
I J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
settingValue
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
controlType
e p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ?
,
? @
	SqlDbType
A J
.
J K
NVarChar
K S
,
S T
-
U V
$num
V W
,
W X 
ParameterDirection
Y k
.
k l
Input
l q
,
q r(
regexValidationExpressions 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
featureGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
resourceFile
g s
)
s t
;
t u
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
NVarChar
< D
,
D E
$num
F I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d

controlSrc
e o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
$num
C F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
helpKey
b i
)
i j
;
j k
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
Int
; >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
	sortOrder
Z c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
NVarChar
; C
,
C D
$num
E H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
	groupName
d m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
NText
< A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \

attributes
] g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NText
9 >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
options
Z a
)
a b
;
b c
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 /
!UpdateModuleDefinitionSettingById
 <
(
< =
int
 
id
 
,
 
int
 
moduleDefId
 
,
 
string
 
resourceFile
 
,
  
string
 
	groupName
 
,
 
string
 
settingName
 
,
 
string
 
settingValue
 
,
  
string
 
controlType
 
,
 
string
 '
regexValidationExpression
 ,
,
, -
string
 

controlSrc
 
,
 
string
 
helpKey
 
,
 
int
 
	sortOrder
 
,
 
string
   	

attributes
  
 
,
   
string
¡¡ 	
options
¡¡
 
)
¡¡ 
{
¢¢ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i 
,££ 
$num££ 
)££ 
;££ 
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# (
,
¤¤( )
	SqlDbType
¤¤* 3
.
¤¤3 4
Int
¤¤4 7
,
¤¤7 8 
ParameterDirection
¤¤9 K
.
¤¤K L
Input
¤¤L Q
,
¤¤Q R
id
¤¤S U
)
¤¤U V
;
¤¤V W
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 1
,
¥¥1 2
	SqlDbType
¥¥3 <
.
¥¥< =
Int
¥¥= @
,
¥¥@ A 
ParameterDirection
¥¥B T
.
¥¥T U
Input
¥¥U Z
,
¥¥Z [
moduleDefId
¥¥\ g
)
¥¥g h
;
¥¥h i
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# 1
,
¦¦1 2
	SqlDbType
¦¦3 <
.
¦¦< =
NVarChar
¦¦= E
,
¦¦E F
$num
¦¦G I
,
¦¦I J 
ParameterDirection
¦¦K ]
.
¦¦] ^
Input
¦¦^ c
,
¦¦c d
settingName
¦¦e p
)
¦¦p q
;
¦¦q r
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 2
,
§§2 3
	SqlDbType
§§4 =
.
§§= >
NVarChar
§§> F
,
§§F G
-
§§H I
$num
§§I J
,
§§J K 
ParameterDirection
§§L ^
.
§§^ _
Input
§§_ d
,
§§d e
settingValue
§§f r
)
§§r s
;
§§s t
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# 1
,
¨¨1 2
	SqlDbType
¨¨3 <
.
¨¨< =
NVarChar
¨¨= E
,
¨¨E F
$num
¨¨G I
,
¨¨I J 
ParameterDirection
¨¨K ]
.
¨¨] ^
Input
¨¨^ c
,
¨¨c d
controlType
¨¨e p
)
¨¨p q
;
¨¨q r
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ?
,
©©? @
	SqlDbType
©©A J
.
©©J K
NVarChar
©©K S
,
©©S T
-
©©U V
$num
©©V W
,
©©W X 
ParameterDirection
©©Y k
.
©©k l
Input
©©l q
,
©©q r(
regexValidationExpression©©s 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 2
,
ªª2 3
	SqlDbType
ªª4 =
.
ªª= >
NVarChar
ªª> F
,
ªªF G
$num
ªªH K
,
ªªK L 
ParameterDirection
ªªM _
.
ªª_ `
Input
ªª` e
,
ªªe f
resourceFile
ªªg s
)
ªªs t
;
ªªt u
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 0
,
««0 1
	SqlDbType
««2 ;
.
««; <
NVarChar
««< D
,
««D E
$num
««F I
,
««I J 
ParameterDirection
««K ]
.
««] ^
Input
««^ c
,
««c d

controlSrc
««e o
)
««o p
;
««p q
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# -
,
¬¬- .
	SqlDbType
¬¬/ 8
.
¬¬8 9
NVarChar
¬¬9 A
,
¬¬A B
$num
¬¬C F
,
¬¬F G 
ParameterDirection
¬¬H Z
.
¬¬Z [
Input
¬¬[ `
,
¬¬` a
helpKey
¬¬b i
)
¬¬i j
;
¬¬j k
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# /
,
­­/ 0
	SqlDbType
­­1 :
.
­­: ;
Int
­­; >
,
­­> ? 
ParameterDirection
­­@ R
.
­­R S
Input
­­S X
,
­­X Y
	sortOrder
­­Z c
)
­­c d
;
­­d e
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# /
,
®®/ 0
	SqlDbType
®®1 :
.
®®: ;
NVarChar
®®; C
,
®®C D
$num
®®E H
,
®®H I 
ParameterDirection
®®J \
.
®®\ ]
Input
®®] b
,
®®b c
	groupName
®®d m
)
®®m n
;
®®n o
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# 0
,
¯¯0 1
	SqlDbType
¯¯2 ;
.
¯¯; <
NText
¯¯< A
,
¯¯A B 
ParameterDirection
¯¯C U
.
¯¯U V
Input
¯¯V [
,
¯¯[ \

attributes
¯¯] g
)
¯¯g h
;
¯¯h i
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# -
,
°°- .
	SqlDbType
°°/ 8
.
°°8 9
NText
°°9 >
,
°°> ? 
ParameterDirection
°°@ R
.
°°R S
Input
°°S X
,
°°X Y
options
°°Z a
)
°°a b
;
°°b c
int
±± 
rowsAffected
±± 
=
±± 
sph
±± 
.
±± 
ExecuteNonQuery
±± )
(
±±) *
)
±±* +
;
±±+ ,
return
²² 
(
²² 
rowsAffected
²²  
>
²²! "
-
²²# $
$num
²²$ %
)
²²% &
;
²²& '
}
³³ 	
public
¶¶ 
static
¶¶ 
IDataReader
¶¶ !0
"ModuleDefinitionSettingsGetSetting
¶¶" D
(
¶¶D E
Guid
·· 
featureGuid
·· 
,
·· 
string
¸¸ 
settingName
¸¸ 
)
¸¸ 
{
¹¹ 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M%
GetReadConnectionString
ººM d
(
ººd e
)
ººe f
,
ººf g
$strººh 
,ºº 
$numºº 
)ºº 
;ºº 
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 1
,
»»1 2
	SqlDbType
»»3 <
.
»»< =
UniqueIdentifier
»»= M
,
»»M N 
ParameterDirection
»»O a
.
»»a b
Input
»»b g
,
»»g h
featureGuid
»»i t
)
»»t u
;
»»u v
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# 1
,
¼¼1 2
	SqlDbType
¼¼3 <
.
¼¼< =
NVarChar
¼¼= E
,
¼¼E F
$num
¼¼G I
,
¼¼I J 
ParameterDirection
¼¼K ]
.
¼¼] ^
Input
¼¼^ c
,
¼¼c d
settingName
¼¼e p
)
¼¼p q
;
¼¼q r
return
½½ 
sph
½½ 
.
½½ 
ExecuteReader
½½ $
(
½½$ %
)
½½% &
;
½½& '
}
¾¾ 	
}
ÂÂ 
}ÃÃ Û\
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbModuleSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBModuleSettings (
{ 
public 
static 
IDataReader !
GetModuleSettings" 3
(3 4
int4 7
moduleId8 @
)@ A
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h 
,
 
$num
 
)
 
;
 
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
Int: =
,= >
ParameterDirection? Q
.Q R
InputR W
,W X
moduleIdY a
)a b
;b c
return 
sph 
. 
ExecuteReader $
($ %
)% &
;& '
} 	
public 
static 
IDataReader !$
GetDefaultModuleSettings" :
(: ;
int; >
moduleDefId? J
)J K
{ 	
SqlParameterHelper   
sph   "
=  # $
new  % (
SqlParameterHelper  ) ;
(  ; <
ConnectionString  < L
.  L M#
GetReadConnectionString  M d
(  d e
)  e f
,  f g
$str	  h 
,
   
$num
   
)
   
;
   
sph!! 
.!! 
DefineSqlParameter!! "
(!!" #
$str!!# 1
,!!1 2
	SqlDbType!!3 <
.!!< =
Int!!= @
,!!@ A
ParameterDirection!!B T
.!!T U
Input!!U Z
,!!Z [
moduleDefId!!\ g
)!!g h
;!!h i
return"" 
sph"" 
."" 
ExecuteReader"" $
(""$ %
)""% &
;""& '
}## 	
public%% 
static%% 
bool%% 
CreateModuleSetting%% .
(%%. /
Guid&& 
settingGuid&& 
,&& 
Guid'' 

moduleGuid'' 
,'' 
int(( 
moduleId(( 
,(( 
string)) 
settingName)) 
,)) 
string** 
settingValue** 
,**  
string++ 
controlType++ 
,++ 
string,, %
regexValidationExpression,, ,
,,,, -
string-- 

controlSrc-- 
,-- 
string.. 
helpKey.. 
,.. 
int// 
	sortOrder// 
)// 
{00 	
SqlParameterHelper11 
sph11 "
=11# $
new11% (
SqlParameterHelper11) ;
(11; <
ConnectionString11< L
.11L M$
GetWriteConnectionString11M e
(11e f
)11f g
,11g h
$str	11i 
,
11 
$num
11 
)
11 
;
11 
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# 1
,331 2
	SqlDbType333 <
.33< =
UniqueIdentifier33= M
,33M N
ParameterDirection33O a
.33a b
Input33b g
,33g h
settingGuid33i t
)33t u
;33u v
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 0
,440 1
	SqlDbType442 ;
.44; <
UniqueIdentifier44< L
,44L M
ParameterDirection44N `
.44` a
Input44a f
,44f g

moduleGuid44h r
)44r s
;44s t
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
Int55: =
,55= >
ParameterDirection55? Q
.55Q R
Input55R W
,55W X
moduleId55Y a
)55a b
;55b c
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 1
,661 2
	SqlDbType663 <
.66< =
NVarChar66= E
,66E F
$num66G I
,66I J
ParameterDirection66K ]
.66] ^
Input66^ c
,66c d
settingName66e p
)66p q
;66q r
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# 2
,772 3
	SqlDbType774 =
.77= >
NVarChar77> F
,77F G
-77H I
$num77I J
,77J K
ParameterDirection77L ^
.77^ _
Input77_ d
,77d e
settingValue77f r
)77r s
;77s t
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# 1
,881 2
	SqlDbType883 <
.88< =
NVarChar88= E
,88E F
$num88G I
,88I J
ParameterDirection88K ]
.88] ^
Input88^ c
,88c d
controlType88e p
)88p q
;88q r
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# ?
,99? @
	SqlDbType99A J
.99J K
NVarChar99K S
,99S T
-99U V
$num99V W
,99W X
ParameterDirection99Y k
.99k l
Input99l q
,99q r&
regexValidationExpression	99s 
)
99 
;
99 
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# 0
,::0 1
	SqlDbType::2 ;
.::; <
NVarChar::< D
,::D E
$num::F I
,::I J
ParameterDirection::K ]
.::] ^
Input::^ c
,::c d

controlSrc::e o
)::o p
;::p q
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# -
,;;- .
	SqlDbType;;/ 8
.;;8 9
NVarChar;;9 A
,;;A B
$num;;C F
,;;F G
ParameterDirection;;H Z
.;;Z [
Input;;[ `
,;;` a
helpKey;;b i
);;i j
;;;j k
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# /
,<</ 0
	SqlDbType<<1 :
.<<: ;
Int<<; >
,<<> ?
ParameterDirection<<@ R
.<<R S
Input<<S X
,<<X Y
	sortOrder<<Z c
)<<c d
;<<d e
int>> 
rowsAffected>> 
=>> 
sph>> 
.>> 
ExecuteNonQuery>> )
(>>) *
)>>* +
;>>+ ,
return?? 
(?? 
rowsAffected??  
>??! "
-??# $
$num??$ %
)??% &
;??& '
}@@ 	
publicBB 
staticBB 
boolBB 
UpdateModuleSettingBB .
(BB. /
GuidCC 

moduleGuidCC 
,CC 
intDD 
moduleIdDD 
,DD 
stringEE 
settingNameEE 
,EE 
stringFF 
settingValueFF 
)FF  
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi 
,
HH 
$num
HH 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# 0
,II0 1
	SqlDbTypeII2 ;
.II; <
UniqueIdentifierII< L
,IIL M
ParameterDirectionIIN `
.II` a
InputIIa f
,IIf g

moduleGuidIIh r
)IIr s
;IIs t
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# .
,JJ. /
	SqlDbTypeJJ0 9
.JJ9 :
IntJJ: =
,JJ= >
ParameterDirectionJJ? Q
.JJQ R
InputJJR W
,JJW X
moduleIdJJY a
)JJa b
;JJb c
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 1
,KK1 2
	SqlDbTypeKK3 <
.KK< =
NVarCharKK= E
,KKE F
$numKKG I
,KKI J
ParameterDirectionKKK ]
.KK] ^
InputKK^ c
,KKc d
settingNameKKe p
)KKp q
;KKq r
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 2
,LL2 3
	SqlDbTypeLL4 =
.LL= >
NVarCharLL> F
,LLF G
-LLH I
$numLLI J
,LLJ K
ParameterDirectionLLL ^
.LL^ _
InputLL_ d
,LLd e
settingValueLLf r
)LLr s
;LLs t
intMM 
rowsAffectedMM 
=MM 
sphMM "
.MM" #
ExecuteNonQueryMM# 2
(MM2 3
)MM3 4
;MM4 5
returnNN 
(NN 
rowsAffectedNN  
>NN! "
-NN# $
$numNN$ %
)NN% &
;NN& '
}OO 	
publicQQ 
staticQQ 
boolQQ '
CreateDefaultModuleSettingsQQ 6
(QQ6 7
intQQ7 :
moduleIdQQ; C
)QQC D
{RR 	
SqlParameterHelperSS 
sphSS "
=SS# $
newSS% (
SqlParameterHelperSS) ;
(SS; <
ConnectionStringSS< L
.SSL M$
GetWriteConnectionStringSSM e
(SSe f
)SSf g
,SSg h
$str	SSi 
,
SS 
$num
SS 
)
SS 
;
SS 
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
IntTT: =
,TT= >
ParameterDirectionTT? Q
.TTQ R
InputTTR W
,TTW X
moduleIdTTY a
)TTa b
;TTb c
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
(VV 
rowsAffectedVV  
>VV! "
-VV# $
$numVV$ %
)VV% &
;VV& '
}WW 	
publicYY 
staticYY 
boolYY  
DeleteModuleSettingsYY /
(YY/ 0
intYY0 3
moduleIdYY4 <
)YY< =
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M$
GetWriteConnectionString[[M e
([[e f
)[[f g
,[[g h
$str	[[i 
,
[[ 
$num
[[ 
)
[[ 
;
[[ 
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# .
,\\. /
	SqlDbType\\0 9
.\\9 :
Int\\: =
,\\= >
ParameterDirection\\? Q
.\\Q R
Input\\R W
,\\W X
moduleId\\Y a
)\\a b
;\\b c
int]] 
rowsAffected]] 
=]] 
sph]] "
.]]" #
ExecuteNonQuery]]# 2
(]]2 3
)]]3 4
;]]4 5
return^^ 
(^^ 
rowsAffected^^  
>^^! "
-^^# $
$num^^$ %
)^^% &
;^^& '
}__ 	
}dd 
}ee ãä
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbPageSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPageSettings &
{ 
public 
static 
int 
Create  
(  !
int 
siteId 
, 
int 
parentId 
, 
string 
pageName 
, 
string 
	pageTitle 
, 
string 
skin 
, 
int 
	pageOrder 
, 
string   
authorizedRoles   "
,  " #
string!! 
	editRoles!! 
,!! 
string"" 
draftEditRoles"" !
,""! "
string## 
draftApprovalRoles## %
,##% &
string$$  
createChildPageRoles$$ '
,$$' (
string%% !
createChildDraftRoles%% (
,%%( )
bool&& 

requireSsl&& 
,&& 
bool'' 
allowBrowserCache'' "
,''" #
bool(( 
showBreadcrumbs((  
,((  !
bool)) $
showChildPageBreadcrumbs)) )
,))) *
string** 
pageKeyWords** 
,**  
string++ 
pageDescription++ "
,++" #
string,, 
pageEncoding,, 
,,,  
string-- 
additionalMetaTags-- %
,--% &
bool.. 
useUrl.. 
,.. 
string// 
url// 
,// 
bool00 
openInNewWindow00  
,00  !
bool11 
showChildPageMenu11 "
,11" #
bool22 
hideMainMenu22 
,22 
bool33 
includeInMenu33 
,33 
String44 
	menuImage44 
,44 
string55 
changeFrequency55 "
,55" #
string66 
siteMapPriority66 "
,66" #
Guid77 
pageGuid77 
,77 
Guid88 

parentGuid88 
,88 
bool99 
hideAfterLogin99 
,99  
Guid:: 
siteGuid:: 
,:: 
string;; 
compiledMeta;; 
,;;  
DateTime<< 
compiledMetaUtc<< $
,<<$ %
bool== 
includeInSiteMap== !
,==! "
bool>> 
isClickable>> 
,>> 
bool?? 
showHomeCrumb?? 
,?? 
bool@@ 
	isPending@@ 
,@@ 
stringAA 
canonicalOverrideAA $
,AA$ %
boolBB 
includeInSearchMapBB #
,BB# $
boolCC 
enableCommentsCC 
,CC  
boolDD !
includeInChildSiteMapDD &
,DD& '
boolEE 
expandOnSiteMapEE  
,EE  !
GuidFF 
	pubTeamIdFF 
,FF 
stringGG 
bodyCssClassGG 
,GG  
stringHH 
menuCssClassHH 
,HH  
intII 
publishModeII 
,II 
GuidJJ 
	createdByJJ 
,JJ 
stringKK 
createdFromIpKK  
,KK  !
stringLL 
menuDescriptionLL "
,LL" #
stringMM 
linkRelMM 
,MM 
stringNN 
pageHeadingNN 
,NN 
boolOO 
showPageHeadingOO  
,OO  !
DateTimePP 

pubDateUtcPP 
)PP  
{QQ 	
SqlParameterHelperSS 
sphSS "
=SS# $
newSS% (
SqlParameterHelperSS) ;
(SS; <
ConnectionStringSS< L
.SSL M$
GetWriteConnectionStringSSM e
(SSe f
)SSf g
,SSg h
$strSSi z
,SSz {
$numSS| ~
)SS~ 
;	SS 
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# ,
,TT, -
	SqlDbTypeTT. 7
.TT7 8
IntTT8 ;
,TT; <
ParameterDirectionTT= O
.TTO P
InputTTP U
,TTU V
siteIdTTW ]
)TT] ^
;TT^ _
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# .
,UU. /
	SqlDbTypeUU0 9
.UU9 :
IntUU: =
,UU= >
ParameterDirectionUU? Q
.UUQ R
InputUUR W
,UUW X
parentIdUUY a
)UUa b
;UUb c
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# .
,VV. /
	SqlDbTypeVV0 9
.VV9 :
NVarCharVV: B
,VVB C
$numVVD G
,VVG H
ParameterDirectionVVI [
.VV[ \
InputVV\ a
,VVa b
pageNameVVc k
)VVk l
;VVl m
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# /
,WW/ 0
	SqlDbTypeWW1 :
.WW: ;
IntWW; >
,WW> ?
ParameterDirectionWW@ R
.WWR S
InputWWS X
,WWX Y
	pageOrderWWZ c
)WWc d
;WWd e
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 5
,XX5 6
	SqlDbTypeXX7 @
.XX@ A
NVarCharXXA I
,XXI J
-XXK L
$numXXL M
,XXM N
ParameterDirectionXXO a
.XXa b
InputXXb g
,XXg h
authorizedRolesXXi x
)XXx y
;XXy z
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# /
,YY/ 0
	SqlDbTypeYY1 :
.YY: ;
NVarCharYY; C
,YYC D
-YYE F
$numYYF G
,YYG H
ParameterDirectionYYI [
.YY[ \
InputYY\ a
,YYa b
	editRolesYYc l
)YYl m
;YYm n
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# 4
,ZZ4 5
	SqlDbTypeZZ6 ?
.ZZ? @
NVarCharZZ@ H
,ZZH I
-ZZJ K
$numZZK L
,ZZL M
ParameterDirectionZZN `
.ZZ` a
InputZZa f
,ZZf g
draftEditRolesZZh v
)ZZv w
;ZZw x
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 8
,[[8 9
	SqlDbType[[: C
.[[C D
NVarChar[[D L
,[[L M
-[[N O
$num[[O P
,[[P Q
ParameterDirection[[R d
.[[d e
Input[[e j
,[[j k
draftApprovalRoles[[l ~
)[[~ 
;	[[ 
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# :
,\\: ;
	SqlDbType\\< E
.\\E F
NVarChar\\F N
,\\N O
-\\P Q
$num\\Q R
,\\R S
ParameterDirection\\T f
.\\f g
Input\\g l
,\\l m!
createChildPageRoles	\\n 
)
\\ 
;
\\ 
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ;
,]]; <
	SqlDbType]]= F
.]]F G
NVarChar]]G O
,]]O P
-]]Q R
$num]]R S
,]]S T
ParameterDirection]]U g
.]]g h
Input]]h m
,]]m n"
createChildDraftRoles	]]o 
)
]] 
;
]] 
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 0
,^^0 1
	SqlDbType^^2 ;
.^^; <
Bit^^< ?
,^^? @
ParameterDirection^^A S
.^^S T
Input^^T Y
,^^Y Z

requireSsl^^[ e
)^^e f
;^^f g
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 5
,__5 6
	SqlDbType__7 @
.__@ A
Bit__A D
,__D E
ParameterDirection__F X
.__X Y
Input__Y ^
,__^ _
showBreadcrumbs__` o
)__o p
;__p q
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# >
,``> ?
	SqlDbType``@ I
.``I J
Bit``J M
,``M N
ParameterDirection``O a
.``a b
Input``b g
,``g h%
showChildPageBreadcrumbs	``i 
)
`` 
;
`` 
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
NVarCharaa> F
,aaF G
$numaaH L
,aaL M
ParameterDirectionaaN `
.aa` a
Inputaaa f
,aaf g
pageKeyWordsaah t
)aat u
;aau v
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 5
,bb5 6
	SqlDbTypebb7 @
.bb@ A
NVarCharbbA I
,bbI J
$numbbK N
,bbN O
ParameterDirectionbbP b
.bbb c
Inputbbc h
,bbh i
pageDescriptionbbj y
)bby z
;bbz {
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 2
,cc2 3
	SqlDbTypecc4 =
.cc= >
NVarCharcc> F
,ccF G
$numccH K
,ccK L
ParameterDirectionccM _
.cc_ `
Inputcc` e
,cce f
pageEncodingccg s
)ccs t
;cct u
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 8
,dd8 9
	SqlDbTypedd: C
.ddC D
NVarCharddD L
,ddL M
$numddN Q
,ddQ R
ParameterDirectionddS e
.dde f
Inputddf k
,ddk l
additionalMetaTagsddm 
)	dd 
;
dd 
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
Bitee8 ;
,ee; <
ParameterDirectionee= O
.eeO P
InputeeP U
,eeU V
useUrleeW ]
)ee] ^
;ee^ _
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# )
,ff) *
	SqlDbTypeff+ 4
.ff4 5
NVarCharff5 =
,ff= >
$numff? B
,ffB C
ParameterDirectionffD V
.ffV W
InputffW \
,ff\ ]
urlff^ a
)ffa b
;ffb c
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 5
,gg5 6
	SqlDbTypegg7 @
.gg@ A
BitggA D
,ggD E
ParameterDirectionggF X
.ggX Y
InputggY ^
,gg^ _
openInNewWindowgg` o
)ggo p
;ggp q
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 7
,hh7 8
	SqlDbTypehh9 B
.hhB C
BithhC F
,hhF G
ParameterDirectionhhH Z
.hhZ [
Inputhh[ `
,hh` a
showChildPageMenuhhb s
)hhs t
;hht u
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# 2
,ii2 3
	SqlDbTypeii4 =
.ii= >
Bitii> A
,iiA B
ParameterDirectioniiC U
.iiU V
InputiiV [
,ii[ \
hideMainMenuii] i
)iii j
;iij k
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# *
,jj* +
	SqlDbTypejj, 5
.jj5 6
NVarCharjj6 >
,jj> ?
$numjj@ C
,jjC D
ParameterDirectionjjE W
.jjW X
InputjjX ]
,jj] ^
skinjj_ c
)jjc d
;jjd e
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 3
,kk3 4
	SqlDbTypekk5 >
.kk> ?
Bitkk? B
,kkB C
ParameterDirectionkkD V
.kkV W
InputkkW \
,kk\ ]
includeInMenukk^ k
)kkk l
;kkl m
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# /
,ll/ 0
	SqlDbTypell1 :
.ll: ;
NVarCharll; C
,llC D
$numllE H
,llH I
ParameterDirectionllJ \
.ll\ ]
Inputll] b
,llb c
	menuImagelld m
)llm n
;lln o
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# /
,mm/ 0
	SqlDbTypemm1 :
.mm: ;
NVarCharmm; C
,mmC D
$nummmE H
,mmH I
ParameterDirectionmmJ \
.mm\ ]
Inputmm] b
,mmb c
	pageTitlemmd m
)mmm n
;mmn o
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 7
,nn7 8
	SqlDbTypenn9 B
.nnB C
BitnnC F
,nnF G
ParameterDirectionnnH Z
.nnZ [
Inputnn[ `
,nn` a
allowBrowserCachennb s
)nns t
;nnt u
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 5
,oo5 6
	SqlDbTypeoo7 @
.oo@ A
NVarCharooA I
,ooI J
$numooK M
,ooM N
ParameterDirectionooO a
.ooa b
Inputoob g
,oog h
changeFrequencyooi x
)oox y
;ooy z
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 5
,pp5 6
	SqlDbTypepp7 @
.pp@ A
NVarCharppA I
,ppI J
$numppK M
,ppM N
ParameterDirectionppO a
.ppa b
Inputppb g
,ppg h
siteMapPriorityppi x
)ppx y
;ppy z
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 5
,qq5 6
	SqlDbTypeqq7 @
.qq@ A
DateTimeqqA I
,qqI J
ParameterDirectionqqK ]
.qq] ^
Inputqq^ c
,qqc d
DateTimeqqe m
.qqm n
UtcNowqqn t
)qqt u
;qqu v
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# .
,rr. /
	SqlDbTyperr0 9
.rr9 :
UniqueIdentifierrr: J
,rrJ K
ParameterDirectionrrL ^
.rr^ _
Inputrr_ d
,rrd e
pageGuidrrf n
)rrn o
;rro p
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 0
,ss0 1
	SqlDbTypess2 ;
.ss; <
UniqueIdentifierss< L
,ssL M
ParameterDirectionssN `
.ss` a
Inputssa f
,ssf g

parentGuidssh r
)ssr s
;sss t
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 4
,tt4 5
	SqlDbTypett6 ?
.tt? @
Bittt@ C
,ttC D
ParameterDirectionttE W
.ttW X
InputttX ]
,tt] ^
hideAfterLogintt_ m
)ttm n
;ttn o
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
UniqueIdentifieruu: J
,uuJ K
ParameterDirectionuuL ^
.uu^ _
Inputuu_ d
,uud e
siteGuiduuf n
)uun o
;uuo p
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 2
,vv2 3
	SqlDbTypevv4 =
.vv= >
NVarCharvv> F
,vvF G
-vvH I
$numvvI J
,vvJ K
ParameterDirectionvvL ^
.vv^ _
Inputvv_ d
,vvd e
compiledMetavvf r
)vvr s
;vvs t
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 5
,ww5 6
	SqlDbTypeww7 @
.ww@ A
DateTimewwA I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d
compiledMetaUtcwwe t
)wwt u
;wwu v
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 6
,xx6 7
	SqlDbTypexx8 A
.xxA B
BitxxB E
,xxE F
ParameterDirectionxxG Y
.xxY Z
InputxxZ _
,xx_ `
includeInSiteMapxxa q
)xxq r
;xxr s
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 1
,yy1 2
	SqlDbTypeyy3 <
.yy< =
Bityy= @
,yy@ A
ParameterDirectionyyB T
.yyT U
InputyyU Z
,yyZ [
isClickableyy\ g
)yyg h
;yyh i
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 3
,zz3 4
	SqlDbTypezz5 >
.zz> ?
Bitzz? B
,zzB C
ParameterDirectionzzD V
.zzV W
InputzzW \
,zz\ ]
showHomeCrumbzz^ k
)zzk l
;zzl m
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# /
,{{/ 0
	SqlDbType{{1 :
.{{: ;
Bit{{; >
,{{> ?
ParameterDirection{{@ R
.{{R S
Input{{S X
,{{X Y
	isPending{{Z c
){{c d
;{{d e
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 7
,||7 8
	SqlDbType||9 B
.||B C
NVarChar||C K
,||K L
$num||M P
,||P Q
ParameterDirection||R d
.||d e
Input||e j
,||j k
canonicalOverride||l }
)||} ~
;||~ 
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 8
,}}8 9
	SqlDbType}}: C
.}}C D
Bit}}D G
,}}G H
ParameterDirection}}I [
.}}[ \
Input}}\ a
,}}a b
includeInSearchMap}}c u
)}}u v
;}}v w
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# 4
,~~4 5
	SqlDbType~~6 ?
.~~? @
Bit~~@ C
,~~C D
ParameterDirection~~E W
.~~W X
Input~~X ]
,~~] ^
enableComments~~_ m
)~~m n
;~~n o
sph 
. 
DefineSqlParameter "
(" #
$str# ;
,; <
	SqlDbType= F
.F G
BitG J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e!
includeInChildSiteMapf {
){ |
;| }
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Bit
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
expandOnSiteMap
` o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	pubTeamId
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
bodyCssClass
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
menuCssClass
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
publishMode
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
DateTime
= E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
DateTime
a i
.
i j
UtcNow
j p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
	createdBy
h q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
NVarChar
@ H
,
H I
$num
J L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
createdFromIp
h u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
DateTime
= E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
DateTime
a i
.
i j
UtcNow
j p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
	createdBy
h q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
NVarChar
@ H
,
H I
$num
J L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
createdFromIp
h u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
-
D E
$num
E F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
menuDescription
b q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
$num
C E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
linkRel
a h
)
h i
;
i j
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
pageHeading
f q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Bit
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
showPageHeading
` o
)
o p
;
p q
if
 
(
 

pubDateUtc
 
==
 
DateTime
 &
.
& '
MaxValue
' /
)
/ 0
{
 
sph
 
.
  
DefineSqlParameter
 &
(
& '
$str
' 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
DBNull
d j
.
j k
Value
k p
)
p q
;
q r
}
 
else
 
{
 
sph
 
.
  
DefineSqlParameter
 &
(
& '
$str
' 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c

pubDateUtc
d n
)
n o
;
o p
}
 
int
 
newID
 
=
 
Convert
 
.
  
ToInt32
  '
(
' (
sph
( +
.
+ ,
ExecuteScalar
, 9
(
9 :
)
: ;
)
; <
;
< =
return
 
newID
 
;
 
}
 	
public
   
static
   
bool
   

UpdatePage
   %
(
  % &
int
¡¡ 
siteId
¡¡ 
,
¡¡ 
int
¢¢ 
pageId
¢¢ 
,
¢¢ 
int
££ 
parentId
££ 
,
££ 
string
¤¤ 
pageName
¤¤ 
,
¤¤ 
string
¥¥ 
	pageTitle
¥¥ 
,
¥¥ 
string
¦¦ 
skin
¦¦ 
,
¦¦ 
int
§§ 
	pageOrder
§§ 
,
§§ 
string
¨¨ 
authorizedRoles
¨¨ "
,
¨¨" #
string
©© 
	editRoles
©© 
,
©© 
string
ªª 
draftEditRoles
ªª !
,
ªª! "
string
««  
draftApprovalRoles
«« %
,
««% &
string
¬¬ "
createChildPageRoles
¬¬ '
,
¬¬' (
string
­­ #
createChildDraftRoles
­­ (
,
­­( )
bool
®® 

requireSsl
®® 
,
®® 
bool
¯¯ 
allowBrowserCache
¯¯ "
,
¯¯" #
bool
°° 
showBreadcrumbs
°°  
,
°°  !
bool
±± &
showChildPageBreadcrumbs
±± )
,
±±) *
string
²² 
pageKeyWords
²² 
,
²²  
string
³³ 
pageDescription
³³ "
,
³³" #
string
´´ 
pageEncoding
´´ 
,
´´  
string
µµ  
additionalMetaTags
µµ %
,
µµ% &
bool
¶¶ 
useUrl
¶¶ 
,
¶¶ 
string
·· 
url
·· 
,
·· 
bool
¸¸ 
openInNewWindow
¸¸  
,
¸¸  !
bool
¹¹ 
showChildPageMenu
¹¹ "
,
¹¹" #
bool
ºº 
hideMainMenu
ºº 
,
ºº 
bool
»» 
includeInMenu
»» 
,
»» 
String
¼¼ 
	menuImage
¼¼ 
,
¼¼ 
string
½½ 
changeFrequency
½½ "
,
½½" #
string
¾¾ 
siteMapPriority
¾¾ "
,
¾¾" #
Guid
¿¿ 

parentGuid
¿¿ 
,
¿¿ 
bool
ÀÀ 
hideAfterLogin
ÀÀ 
,
ÀÀ  
string
ÁÁ 
compiledMeta
ÁÁ 
,
ÁÁ  
DateTime
ÂÂ 
compiledMetaUtc
ÂÂ $
,
ÂÂ$ %
bool
ÃÃ 
includeInSiteMap
ÃÃ !
,
ÃÃ! "
bool
ÄÄ 
isClickable
ÄÄ 
,
ÄÄ 
bool
ÅÅ 
showHomeCrumb
ÅÅ 
,
ÅÅ 
bool
ÆÆ 
	isPending
ÆÆ 
,
ÆÆ 
string
ÇÇ 
canonicalOverride
ÇÇ $
,
ÇÇ$ %
bool
ÈÈ  
includeInSearchMap
ÈÈ #
,
ÈÈ# $
bool
ÉÉ 
enableComments
ÉÉ 
,
ÉÉ  
bool
ÊÊ #
includeInChildSiteMap
ÊÊ &
,
ÊÊ& '
bool
ËË 
expandOnSiteMap
ËË  
,
ËË  !
Guid
ÌÌ 
	pubTeamId
ÌÌ 
,
ÌÌ 
string
ÍÍ 
bodyCssClass
ÍÍ 
,
ÍÍ  
string
ÎÎ 
menuCssClass
ÎÎ 
,
ÎÎ  
int
ÏÏ 
publishMode
ÏÏ 
,
ÏÏ 
DateTime
ÐÐ 

createdUtc
ÐÐ 
,
ÐÐ  
Guid
ÑÑ 
	createdBy
ÑÑ 
,
ÑÑ 
Guid
ÒÒ 
	lastModBy
ÒÒ 
,
ÒÒ 
string
ÓÓ 
lastModFromIp
ÓÓ  
,
ÓÓ  !
string
ÔÔ 
menuDescription
ÔÔ "
,
ÔÔ" #
string
ÕÕ 
linkRel
ÕÕ 
,
ÕÕ 
string
ÖÖ 
pageHeading
ÖÖ 
,
ÖÖ 
bool
×× 
showPageHeading
××  
,
××  !
DateTime
ØØ 

pubDateUtc
ØØ 
)
ØØ  
{
ÙÙ 	 
SqlParameterHelper
ÚÚ 
sph
ÚÚ "
=
ÚÚ# $
new
ÚÚ% ( 
SqlParameterHelper
ÚÚ) ;
(
ÚÚ; <
ConnectionString
ÚÚ< L
.
ÚÚL M&
GetWriteConnectionString
ÚÚM e
(
ÚÚe f
)
ÚÚf g
,
ÚÚg h
$str
ÚÚi z
,
ÚÚz {
$num
ÚÚ| ~
)
ÚÚ~ 
;ÚÚ 
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# ,
,
ÛÛ, -
	SqlDbType
ÛÛ. 7
.
ÛÛ7 8
Int
ÛÛ8 ;
,
ÛÛ; < 
ParameterDirection
ÛÛ= O
.
ÛÛO P
Input
ÛÛP U
,
ÛÛU V
siteId
ÛÛW ]
)
ÛÛ] ^
;
ÛÛ^ _
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# ,
,
ÜÜ, -
	SqlDbType
ÜÜ. 7
.
ÜÜ7 8
Int
ÜÜ8 ;
,
ÜÜ; < 
ParameterDirection
ÜÜ= O
.
ÜÜO P
Input
ÜÜP U
,
ÜÜU V
pageId
ÜÜW ]
)
ÜÜ] ^
;
ÜÜ^ _
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# .
,
ÝÝ. /
	SqlDbType
ÝÝ0 9
.
ÝÝ9 :
Int
ÝÝ: =
,
ÝÝ= > 
ParameterDirection
ÝÝ? Q
.
ÝÝQ R
Input
ÝÝR W
,
ÝÝW X
parentId
ÝÝY a
)
ÝÝa b
;
ÝÝb c
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# /
,
ÞÞ/ 0
	SqlDbType
ÞÞ1 :
.
ÞÞ: ;
Int
ÞÞ; >
,
ÞÞ> ? 
ParameterDirection
ÞÞ@ R
.
ÞÞR S
Input
ÞÞS X
,
ÞÞX Y
	pageOrder
ÞÞZ c
)
ÞÞc d
;
ÞÞd e
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# .
,
ßß. /
	SqlDbType
ßß0 9
.
ßß9 :
NVarChar
ßß: B
,
ßßB C
$num
ßßD G
,
ßßG H 
ParameterDirection
ßßI [
.
ßß[ \
Input
ßß\ a
,
ßßa b
pageName
ßßc k
)
ßßk l
;
ßßl m
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 5
,
àà5 6
	SqlDbType
àà7 @
.
àà@ A
NVarChar
ààA I
,
ààI J
-
ààK L
$num
ààL M
,
ààM N 
ParameterDirection
ààO a
.
ààa b
Input
ààb g
,
ààg h
authorizedRoles
àài x
)
ààx y
;
àày z
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# /
,
áá/ 0
	SqlDbType
áá1 :
.
áá: ;
NVarChar
áá; C
,
ááC D
-
ááE F
$num
ááF G
,
ááG H 
ParameterDirection
ááI [
.
áá[ \
Input
áá\ a
,
ááa b
	editRoles
áác l
)
áál m
;
áám n
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 4
,
ââ4 5
	SqlDbType
ââ6 ?
.
ââ? @
NVarChar
ââ@ H
,
ââH I
-
ââJ K
$num
ââK L
,
ââL M 
ParameterDirection
ââN `
.
ââ` a
Input
ââa f
,
ââf g
draftEditRoles
ââh v
)
ââv w
;
ââw x
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# 8
,
ãã8 9
	SqlDbType
ãã: C
.
ããC D
NVarChar
ããD L
,
ããL M
-
ããN O
$num
ããO P
,
ããP Q 
ParameterDirection
ããR d
.
ããd e
Input
ããe j
,
ããj k 
draftApprovalRoles
ããl ~
)
ãã~ 
;ãã 
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# :
,
ää: ;
	SqlDbType
ää< E
.
ääE F
NVarChar
ääF N
,
ääN O
-
ääP Q
$num
ääQ R
,
ääR S 
ParameterDirection
ääT f
.
ääf g
Input
ääg l
,
ääl m#
createChildPageRolesään 
)ää 
;ää 
sph
åå 
.
åå  
DefineSqlParameter
åå "
(
åå" #
$str
åå# ;
,
åå; <
	SqlDbType
åå= F
.
ååF G
NVarChar
ååG O
,
ååO P
-
ååQ R
$num
ååR S
,
ååS T 
ParameterDirection
ååU g
.
ååg h
Input
ååh m
,
ååm n$
createChildDraftRolesååo 
)åå 
;åå 
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# 0
,
ææ0 1
	SqlDbType
ææ2 ;
.
ææ; <
Bit
ææ< ?
,
ææ? @ 
ParameterDirection
ææA S
.
ææS T
Input
ææT Y
,
ææY Z

requireSsl
ææ[ e
)
ææe f
;
ææf g
sph
çç 
.
çç  
DefineSqlParameter
çç "
(
çç" #
$str
çç# 5
,
çç5 6
	SqlDbType
çç7 @
.
çç@ A
Bit
ççA D
,
ççD E 
ParameterDirection
ççF X
.
ççX Y
Input
ççY ^
,
çç^ _
showBreadcrumbs
çç` o
)
çço p
;
ççp q
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# >
,
èè> ?
	SqlDbType
èè@ I
.
èèI J
Bit
èèJ M
,
èèM N 
ParameterDirection
èèO a
.
èèa b
Input
èèb g
,
èèg h'
showChildPageBreadcrumbsèèi 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# 2
,
éé2 3
	SqlDbType
éé4 =
.
éé= >
NVarChar
éé> F
,
ééF G
$num
ééH L
,
ééL M 
ParameterDirection
ééN `
.
éé` a
Input
ééa f
,
ééf g
pageKeyWords
ééh t
)
éét u
;
ééu v
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# 5
,
êê5 6
	SqlDbType
êê7 @
.
êê@ A
NVarChar
êêA I
,
êêI J
$num
êêK N
,
êêN O 
ParameterDirection
êêP b
.
êêb c
Input
êêc h
,
êêh i
pageDescription
êêj y
)
êêy z
;
êêz {
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 2
,
ëë2 3
	SqlDbType
ëë4 =
.
ëë= >
NVarChar
ëë> F
,
ëëF G
$num
ëëH K
,
ëëK L 
ParameterDirection
ëëM _
.
ëë_ `
Input
ëë` e
,
ëëe f
pageEncoding
ëëg s
)
ëës t
;
ëët u
sph
ìì 
.
ìì  
DefineSqlParameter
ìì "
(
ìì" #
$str
ìì# 8
,
ìì8 9
	SqlDbType
ìì: C
.
ììC D
NVarChar
ììD L
,
ììL M
$num
ììN Q
,
ììQ R 
ParameterDirection
ììS e
.
ììe f
Input
ììf k
,
ììk l 
additionalMetaTags
ììm 
)ìì 
;ìì 
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# ,
,
íí, -
	SqlDbType
íí. 7
.
íí7 8
Bit
íí8 ;
,
íí; < 
ParameterDirection
íí= O
.
ííO P
Input
ííP U
,
ííU V
useUrl
ííW ]
)
íí] ^
;
íí^ _
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# )
,
îî) *
	SqlDbType
îî+ 4
.
îî4 5
NVarChar
îî5 =
,
îî= >
$num
îî? B
,
îîB C 
ParameterDirection
îîD V
.
îîV W
Input
îîW \
,
îî\ ]
url
îî^ a
)
îîa b
;
îîb c
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# 5
,
ïï5 6
	SqlDbType
ïï7 @
.
ïï@ A
Bit
ïïA D
,
ïïD E 
ParameterDirection
ïïF X
.
ïïX Y
Input
ïïY ^
,
ïï^ _
openInNewWindow
ïï` o
)
ïïo p
;
ïïp q
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# 7
,
ðð7 8
	SqlDbType
ðð9 B
.
ððB C
Bit
ððC F
,
ððF G 
ParameterDirection
ððH Z
.
ððZ [
Input
ðð[ `
,
ðð` a
showChildPageMenu
ððb s
)
ððs t
;
ððt u
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 2
,
ññ2 3
	SqlDbType
ññ4 =
.
ññ= >
Bit
ññ> A
,
ññA B 
ParameterDirection
ññC U
.
ññU V
Input
ññV [
,
ññ[ \
hideMainMenu
ññ] i
)
ññi j
;
ññj k
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# *
,
òò* +
	SqlDbType
òò, 5
.
òò5 6
NVarChar
òò6 >
,
òò> ?
$num
òò@ C
,
òòC D 
ParameterDirection
òòE W
.
òòW X
Input
òòX ]
,
òò] ^
skin
òò_ c
)
òòc d
;
òòd e
sph
óó 
.
óó  
DefineSqlParameter
óó "
(
óó" #
$str
óó# 3
,
óó3 4
	SqlDbType
óó5 >
.
óó> ?
Bit
óó? B
,
óóB C 
ParameterDirection
óóD V
.
óóV W
Input
óóW \
,
óó\ ]
includeInMenu
óó^ k
)
óók l
;
óól m
sph
ôô 
.
ôô  
DefineSqlParameter
ôô "
(
ôô" #
$str
ôô# /
,
ôô/ 0
	SqlDbType
ôô1 :
.
ôô: ;
NVarChar
ôô; C
,
ôôC D
$num
ôôE H
,
ôôH I 
ParameterDirection
ôôJ \
.
ôô\ ]
Input
ôô] b
,
ôôb c
	menuImage
ôôd m
)
ôôm n
;
ôôn o
sph
õõ 
.
õõ  
DefineSqlParameter
õõ "
(
õõ" #
$str
õõ# /
,
õõ/ 0
	SqlDbType
õõ1 :
.
õõ: ;
NVarChar
õõ; C
,
õõC D
$num
õõE H
,
õõH I 
ParameterDirection
õõJ \
.
õõ\ ]
Input
õõ] b
,
õõb c
	pageTitle
õõd m
)
õõm n
;
õõn o
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# 7
,
öö7 8
	SqlDbType
öö9 B
.
ööB C
Bit
ööC F
,
ööF G 
ParameterDirection
ööH Z
.
ööZ [
Input
öö[ `
,
öö` a
allowBrowserCache
ööb s
)
öös t
;
ööt u
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# 5
,
÷÷5 6
	SqlDbType
÷÷7 @
.
÷÷@ A
NVarChar
÷÷A I
,
÷÷I J
$num
÷÷K M
,
÷÷M N 
ParameterDirection
÷÷O a
.
÷÷a b
Input
÷÷b g
,
÷÷g h
changeFrequency
÷÷i x
)
÷÷x y
;
÷÷y z
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# 5
,
øø5 6
	SqlDbType
øø7 @
.
øø@ A
NVarChar
øøA I
,
øøI J
$num
øøK M
,
øøM N 
ParameterDirection
øøO a
.
øøa b
Input
øøb g
,
øøg h
siteMapPriority
øøi x
)
øøx y
;
øøy z
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# 5
,
ùù5 6
	SqlDbType
ùù7 @
.
ùù@ A
DateTime
ùùA I
,
ùùI J 
ParameterDirection
ùùK ]
.
ùù] ^
Input
ùù^ c
,
ùùc d
DateTime
ùùe m
.
ùùm n
UtcNow
ùùn t
)
ùùt u
;
ùùu v
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 0
,
úú0 1
	SqlDbType
úú2 ;
.
úú; <
UniqueIdentifier
úú< L
,
úúL M 
ParameterDirection
úúN `
.
úú` a
Input
úúa f
,
úúf g

parentGuid
úúh r
)
úúr s
;
úús t
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# 4
,
ûû4 5
	SqlDbType
ûû6 ?
.
ûû? @
Bit
ûû@ C
,
ûûC D 
ParameterDirection
ûûE W
.
ûûW X
Input
ûûX ]
,
ûû] ^
hideAfterLogin
ûû_ m
)
ûûm n
;
ûûn o
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# 2
,
üü2 3
	SqlDbType
üü4 =
.
üü= >
NVarChar
üü> F
,
üüF G
-
üüH I
$num
üüI J
,
üüJ K 
ParameterDirection
üüL ^
.
üü^ _
Input
üü_ d
,
üüd e
compiledMeta
üüf r
)
üür s
;
üüs t
sph
ýý 
.
ýý  
DefineSqlParameter
ýý "
(
ýý" #
$str
ýý# 5
,
ýý5 6
	SqlDbType
ýý7 @
.
ýý@ A
DateTime
ýýA I
,
ýýI J 
ParameterDirection
ýýK ]
.
ýý] ^
Input
ýý^ c
,
ýýc d
compiledMetaUtc
ýýe t
)
ýýt u
;
ýýu v
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# 6
,
þþ6 7
	SqlDbType
þþ8 A
.
þþA B
Bit
þþB E
,
þþE F 
ParameterDirection
þþG Y
.
þþY Z
Input
þþZ _
,
þþ_ `
includeInSiteMap
þþa q
)
þþq r
;
þþr s
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# 1
,
ÿÿ1 2
	SqlDbType
ÿÿ3 <
.
ÿÿ< =
Bit
ÿÿ= @
,
ÿÿ@ A 
ParameterDirection
ÿÿB T
.
ÿÿT U
Input
ÿÿU Z
,
ÿÿZ [
isClickable
ÿÿ\ g
)
ÿÿg h
;
ÿÿh i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
Bit
? B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
showHomeCrumb
^ k
)
k l
;
l m
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
Bit
; >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
	isPending
Z c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 7
,
7 8
	SqlDbType
9 B
.
B C
NVarChar
C K
,
K L
$num
M P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k
canonicalOverride
l }
)
} ~
;
~ 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 8
,
8 9
	SqlDbType
: C
.
C D
Bit
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b 
includeInSearchMap
c u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
Bit
@ C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
enableComments
_ m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ;
,
; <
	SqlDbType
= F
.
F G
Bit
G J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e#
includeInChildSiteMap
f {
)
{ |
;
| }
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Bit
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
expandOnSiteMap
` o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	pubTeamId
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
bodyCssClass
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
menuCssClass
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
Int
= @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
publishMode
\ g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
DateTime
= E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `

createdUtc
a k
)
k l
;
l m
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
	createdBy
h q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
DateTime
= E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
DateTime
a i
.
i j
UtcNow
j p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
UniqueIdentifier
< L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
	lastModBy
h q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
NVarChar
@ H
,
H I
$num
J L
,
L M 
ParameterDirection
N `
.
` a
Input
a f
,
f g
lastModFromIp
h u
)
u v
;
v w
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
-
D E
$num
E F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
menuDescription
b q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
$num
C E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
linkRel
a h
)
h i
;
i j
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
pageHeading
f q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Bit
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
showPageHeading
` o
)
o p
;
p q
if
 
(
 

pubDateUtc
 
==
 
DateTime
 &
.
& '
MaxValue
' /
)
/ 0
{
 
sph
 
.
  
DefineSqlParameter
 &
(
& '
$str
' 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
DBNull
d j
.
j k
Value
k p
)
p q
;
q r
}
 
else
 
{
 
sph
 
.
  
DefineSqlParameter
 &
(
& '
$str
' 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c

pubDateUtc
d n
)
n o
;
o p
}
 
int
   
rowsAffected
   
=
   
sph
   "
.
  " #
ExecuteNonQuery
  # 2
(
  2 3
)
  3 4
;
  4 5
return
¡¡ 
(
¡¡ 
rowsAffected
¡¡  
>
¡¡! "
-
¡¡# $
$num
¡¡$ %
)
¡¡% &
;
¡¡& '
}
¢¢ 	
public
¤¤ 
static
¤¤ 
bool
¤¤ 
UpdateTimestamp
¤¤ *
(
¤¤* +
int
¥¥ 
pageId
¥¥ 
,
¥¥ 
DateTime
¦¦ 
lastModifiedUtc
¦¦ $
)
¦¦$ %
{
§§ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M&
GetWriteConnectionString
¨¨M e
(
¨¨e f
)
¨¨f g
,
¨¨g h
$str¨¨i 
,¨¨ 
$num¨¨ 
)¨¨ 
;¨¨ 
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
pageId
©©W ]
)
©©] ^
;
©©^ _
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 5
,
ªª5 6
	SqlDbType
ªª7 @
.
ªª@ A
DateTime
ªªA I
,
ªªI J 
ParameterDirection
ªªK ]
.
ªª] ^
Input
ªª^ c
,
ªªc d
lastModifiedUtc
ªªe t
)
ªªt u
;
ªªu v
int
«« 
rowsAffected
«« 
=
«« 
sph
«« "
.
««" #
ExecuteNonQuery
««# 2
(
««2 3
)
««3 4
;
««4 5
return
¬¬ 
(
¬¬ 
rowsAffected
¬¬  
>
¬¬! "
-
¬¬# $
$num
¬¬$ %
)
¬¬% &
;
¬¬& '
}
­­ 	
public
¯¯ 
static
¯¯ 
bool
¯¯ 
UpdatePageOrder
¯¯ *
(
¯¯* +
int
¯¯+ .
pageId
¯¯/ 5
,
¯¯5 6
int
¯¯7 :
	pageOrder
¯¯; D
)
¯¯D E
{
°° 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M&
GetWriteConnectionString
±±M e
(
±±e f
)
±±f g
,
±±g h
$str±±i 
,±± 
$num±± 
)±± 
;±± 
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# ,
,
²², -
	SqlDbType
²². 7
.
²²7 8
Int
²²8 ;
,
²²; < 
ParameterDirection
²²= O
.
²²O P
Input
²²P U
,
²²U V
pageId
²²W ]
)
²²] ^
;
²²^ _
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# /
,
³³/ 0
	SqlDbType
³³1 :
.
³³: ;
Int
³³; >
,
³³> ? 
ParameterDirection
³³@ R
.
³³R S
Input
³³S X
,
³³X Y
	pageOrder
³³Z c
)
³³c d
;
³³d e
int
´´ 
rowsAffected
´´ 
=
´´ 
sph
´´ "
.
´´" #
ExecuteNonQuery
´´# 2
(
´´2 3
)
´´3 4
;
´´4 5
return
µµ 
(
µµ 
rowsAffected
µµ  
>
µµ! "
-
µµ# $
$num
µµ$ %
)
µµ% &
;
µµ& '
}
¶¶ 	
public
¸¸ 
static
¸¸ 
bool
¸¸ 

DeletePage
¸¸ %
(
¸¸% &
int
¸¸& )
pageId
¸¸* 0
)
¸¸0 1
{
¹¹ 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M&
GetWriteConnectionString
ººM e
(
ººe f
)
ººf g
,
ººg h
$str
ººi z
,
ººz {
$num
ºº| }
)
ºº} ~
;
ºº~ 
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# ,
,
»», -
	SqlDbType
»». 7
.
»»7 8
Int
»»8 ;
,
»»; < 
ParameterDirection
»»= O
.
»»O P
Input
»»P U
,
»»U V
pageId
»»W ]
)
»»] ^
;
»»^ _
int
¼¼ 
rowsAffected
¼¼ 
=
¼¼ 
sph
¼¼ "
.
¼¼" #
ExecuteNonQuery
¼¼# 2
(
¼¼2 3
)
¼¼3 4
;
¼¼4 5
return
½½ 
(
½½ 
rowsAffected
½½  
>
½½! "
-
½½# $
$num
½½$ %
)
½½% &
;
½½& '
}
¾¾ 	
public
ÀÀ 
static
ÀÀ 
bool
ÀÀ 
CleanupOrphans
ÀÀ )
(
ÀÀ) *
)
ÀÀ* +
{
ÁÁ 	 
SqlParameterHelper
ÂÂ 
sph
ÂÂ "
=
ÂÂ# $
new
ÂÂ% ( 
SqlParameterHelper
ÂÂ) ;
(
ÂÂ; <
ConnectionString
ÂÂ< L
.
ÂÂL M&
GetWriteConnectionString
ÂÂM e
(
ÂÂe f
)
ÂÂf g
,
ÂÂg h
$strÂÂi 
,ÂÂ 
$numÂÂ 
)ÂÂ 
;ÂÂ 
int
ÃÃ 
rowsAffected
ÃÃ 
=
ÃÃ 
sph
ÃÃ "
.
ÃÃ" #
ExecuteNonQuery
ÃÃ# 2
(
ÃÃ2 3
)
ÃÃ3 4
;
ÃÃ4 5
return
ÄÄ 
(
ÄÄ 
rowsAffected
ÄÄ  
>
ÄÄ! "
-
ÄÄ# $
$num
ÄÄ$ %
)
ÄÄ% &
;
ÄÄ& '
}
ÅÅ 	
public
ÉÉ 
static
ÉÉ 
IDataReader
ÉÉ !
GetPage
ÉÉ" )
(
ÉÉ) *
Guid
ÉÉ* .
pageGuid
ÉÉ/ 7
)
ÉÉ7 8
{
ÊÊ 	 
SqlParameterHelper
ËË 
sph
ËË "
=
ËË# $
new
ËË% ( 
SqlParameterHelper
ËË) ;
(
ËË; <
ConnectionString
ËË< L
.
ËËL M%
GetReadConnectionString
ËËM d
(
ËËd e
)
ËËe f
,
ËËf g
$strËËh 
,ËË 
$numËË 
)ËË 
;ËË 
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# .
,
ÌÌ. /
	SqlDbType
ÌÌ0 9
.
ÌÌ9 :
UniqueIdentifier
ÌÌ: J
,
ÌÌJ K 
ParameterDirection
ÌÌL ^
.
ÌÌ^ _
Input
ÌÌ_ d
,
ÌÌd e
pageGuid
ÌÌf n
)
ÌÌn o
;
ÌÌo p
return
ÍÍ 
sph
ÍÍ 
.
ÍÍ 
ExecuteReader
ÍÍ $
(
ÍÍ$ %
)
ÍÍ% &
;
ÍÍ& '
}
ÎÎ 	
public
ÐÐ 
static
ÐÐ 
IDataReader
ÐÐ !
GetPage
ÐÐ" )
(
ÐÐ) *
int
ÐÐ* -
siteId
ÐÐ. 4
,
ÐÐ4 5
int
ÐÐ6 9
pageId
ÐÐ: @
)
ÐÐ@ A
{
ÑÑ 	 
SqlParameterHelper
ÒÒ 
sph
ÒÒ "
=
ÒÒ# $
new
ÒÒ% ( 
SqlParameterHelper
ÒÒ) ;
(
ÒÒ; <
ConnectionString
ÒÒ< L
.
ÒÒL M%
GetReadConnectionString
ÒÒM d
(
ÒÒd e
)
ÒÒe f
,
ÒÒf g
$str
ÒÒh |
,
ÒÒ| }
$num
ÒÒ~ 
)ÒÒ 
;ÒÒ 
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# ,
,
ÓÓ, -
	SqlDbType
ÓÓ. 7
.
ÓÓ7 8
Int
ÓÓ8 ;
,
ÓÓ; < 
ParameterDirection
ÓÓ= O
.
ÓÓO P
Input
ÓÓP U
,
ÓÓU V
siteId
ÓÓW ]
)
ÓÓ] ^
;
ÓÓ^ _
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# ,
,
ÔÔ, -
	SqlDbType
ÔÔ. 7
.
ÔÔ7 8
Int
ÔÔ8 ;
,
ÔÔ; < 
ParameterDirection
ÔÔ= O
.
ÔÔO P
Input
ÔÔP U
,
ÔÔU V
pageId
ÔÔW ]
)
ÔÔ] ^
;
ÔÔ^ _
return
ÕÕ 
sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ $
(
ÕÕ$ %
)
ÕÕ% &
;
ÕÕ& '
}
ÖÖ 	
public
ØØ 
static
ØØ 
IDataReader
ØØ !
GetPageList
ØØ" -
(
ØØ- .
int
ØØ. 1
siteId
ØØ2 8
)
ØØ8 9
{
ÙÙ 	 
SqlParameterHelper
ÚÚ 
sph
ÚÚ "
=
ÚÚ# $
new
ÚÚ% ( 
SqlParameterHelper
ÚÚ) ;
(
ÚÚ; <
ConnectionString
ÚÚ< L
.
ÚÚL M%
GetReadConnectionString
ÚÚM d
(
ÚÚd e
)
ÚÚe f
,
ÚÚf g
$strÚÚh 
,ÚÚ 
$numÚÚ 
)ÚÚ 
;ÚÚ 
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# ,
,
ÛÛ, -
	SqlDbType
ÛÛ. 7
.
ÛÛ7 8
Int
ÛÛ8 ;
,
ÛÛ; < 
ParameterDirection
ÛÛ= O
.
ÛÛO P
Input
ÛÛP U
,
ÛÛU V
siteId
ÛÛW ]
)
ÛÛ] ^
;
ÛÛ^ _
return
ÜÜ 
sph
ÜÜ 
.
ÜÜ 
ExecuteReader
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '
}
ÝÝ 	
public
ææ 
static
ææ 
IDataReader
ææ !+
GetChildPagesSortedAlphabetic
ææ" ?
(
ææ? @
int
ææ@ C
siteId
ææD J
,
ææJ K
int
ææL O
parentId
ææP X
)
ææX Y
{
çç 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh 
,èè 
$numèè 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# ,
,
éé, -
	SqlDbType
éé. 7
.
éé7 8
Int
éé8 ;
,
éé; < 
ParameterDirection
éé= O
.
ééO P
Input
ééP U
,
ééU V
siteId
ééW ]
)
éé] ^
;
éé^ _
sph
êê 
.
êê  
DefineSqlParameter
êê "
(
êê" #
$str
êê# .
,
êê. /
	SqlDbType
êê0 9
.
êê9 :
Int
êê: =
,
êê= > 
ParameterDirection
êê? Q
.
êêQ R
Input
êêR W
,
êêW X
parentId
êêY a
)
êêa b
;
êêb c
return
ëë 
sph
ëë 
.
ëë 
ExecuteReader
ëë $
(
ëë$ %
)
ëë% &
;
ëë& '
}
ìì 	
public
îî 
static
îî 
int
îî 
GetPendingCount
îî )
(
îî) *
Guid
îî* .
siteGuid
îî/ 7
)
îî7 8
{
ïï 	 
SqlParameterHelper
ðð 
sph
ðð "
=
ðð# $
new
ðð% ( 
SqlParameterHelper
ðð) ;
(
ðð; <
ConnectionString
ðð< L
.
ððL M%
GetReadConnectionString
ððM d
(
ððd e
)
ððe f
,
ððf g
$strððh 
,ðð 
$numðð 
)ðð 
;ðð 
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# .
,
ññ. /
	SqlDbType
ññ0 9
.
ññ9 :
UniqueIdentifier
ññ: J
,
ññJ K 
ParameterDirection
ññL ^
.
ññ^ _
Input
ññ_ d
,
ññd e
siteGuid
ññf n
)
ññn o
;
ñño p
return
òò 
Convert
òò 
.
òò 
ToInt32
òò "
(
òò" #
sph
òò# &
.
òò& '
ExecuteScalar
òò' 4
(
òò4 5
)
òò5 6
)
òò6 7
;
òò7 8
}
óó 	
public
õõ 
static
õõ 
IDataReader
õõ !$
GetPendingPageListPage
õõ" 8
(
õõ8 9
Guid
öö 
siteGuid
öö 
,
öö 
int
÷÷ 

pageNumber
÷÷ 
,
÷÷ 
int
øø 
pageSize
øø 
,
øø 
out
ùù 
int
ùù 

totalPages
ùù 
)
ùù 
{
úú 	

totalPages
ûû 
=
ûû 
$num
ûû 
;
ûû 
int
üü 
	totalRows
üü 
=
üü 
GetPendingCount
üü +
(
üü+ ,
siteGuid
üü, 4
)
üü4 5
;
üü5 6
if
þþ 
(
þþ 
pageSize
þþ 
>
þþ 
$num
þþ 
)
þþ 

totalPages
þþ (
=
þþ) *
	totalRows
þþ+ 4
/
þþ5 6
pageSize
þþ7 ?
;
þþ? @
if
 
(
 
	totalRows
 
<=
 
pageSize
 %
)
% &
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetChildPages
" /
(
/ 0
int
0 3
siteId
4 :
,
: ;
int
< ?
parentPageId
@ L
)
L M
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
parentPageId
Y e
)
e f
;
f g
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
¤¤ 
static
¤¤ 
int
¤¤ 
GetNextPageOrder
¤¤ *
(
¤¤* +
int
¥¥ 
siteId
¥¥ 
,
¥¥ 
int
¦¦ 
parentId
¦¦ 
)
¦¦ 
{
§§ 	 
SqlParameterHelper
¨¨ 
sph
¨¨ "
=
¨¨# $
new
¨¨% ( 
SqlParameterHelper
¨¨) ;
(
¨¨; <
ConnectionString
¨¨< L
.
¨¨L M%
GetReadConnectionString
¨¨M d
(
¨¨d e
)
¨¨e f
,
¨¨f g
$str¨¨h 
,¨¨ 
$num¨¨ 
)¨¨ 
;¨¨ 
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# ,
,
©©, -
	SqlDbType
©©. 7
.
©©7 8
Int
©©8 ;
,
©©; < 
ParameterDirection
©©= O
.
©©O P
Input
©©P U
,
©©U V
siteId
©©W ]
)
©©] ^
;
©©^ _
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# .
,
ªª. /
	SqlDbType
ªª0 9
.
ªª9 :
Int
ªª: =
,
ªª= > 
ParameterDirection
ªª? Q
.
ªªQ R
Input
ªªR W
,
ªªW X
parentId
ªªY a
)
ªªa b
;
ªªb c
int
«« 
	pageOrder
«« 
=
«« 
Convert
«« #
.
««# $
ToInt32
««$ +
(
««+ ,
sph
««, /
.
««/ 0
ExecuteScalar
««0 =
(
««= >
)
««> ?
)
««? @
;
««@ A
return
¬¬ 
	pageOrder
¬¬ 
;
¬¬ 
}
­­ 	
public
¯¯ 
static
¯¯ 
int
¯¯ 
GetCount
¯¯ "
(
¯¯" #
int
¯¯# &
siteId
¯¯' -
,
¯¯- .
bool
¯¯/ 3
includePending
¯¯4 B
)
¯¯B C
{
°° 	 
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str
±±h ~
,
±±~ 
$num±± 
)±± 
;±± 
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# ,
,
³³, -
	SqlDbType
³³. 7
.
³³7 8
Int
³³8 ;
,
³³; < 
ParameterDirection
³³= O
.
³³O P
Input
³³P U
,
³³U V
siteId
³³W ]
)
³³] ^
;
³³^ _
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 4
,
´´4 5
	SqlDbType
´´6 ?
.
´´? @
Bit
´´@ C
,
´´C D 
ParameterDirection
´´E W
.
´´W X
Input
´´X ]
,
´´] ^
includePending
´´_ m
)
´´m n
;
´´n o
return
µµ 
Convert
µµ 
.
µµ 
ToInt32
µµ "
(
µµ" #
sph
µµ# &
.
µµ& '
ExecuteScalar
µµ' 4
(
µµ4 5
)
µµ5 6
)
µµ6 7
;
µµ7 8
}
¶¶ 	
public
¸¸ 
static
¸¸ 
int
¸¸  
GetCountChildPages
¸¸ ,
(
¸¸, -
int
¸¸- 0
pageId
¸¸1 7
,
¸¸7 8
bool
¸¸9 =
includePending
¸¸> L
)
¸¸L M
{
¹¹ 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M%
GetReadConnectionString
ººM d
(
ººd e
)
ººe f
,
ººf g
$strººh 
,ºº 
$numºº 
)ºº 
;ºº 
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# ,
,
¼¼, -
	SqlDbType
¼¼. 7
.
¼¼7 8
Int
¼¼8 ;
,
¼¼; < 
ParameterDirection
¼¼= O
.
¼¼O P
Input
¼¼P U
,
¼¼U V
pageId
¼¼W ]
)
¼¼] ^
;
¼¼^ _
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# 4
,
½½4 5
	SqlDbType
½½6 ?
.
½½? @
Bit
½½@ C
,
½½C D 
ParameterDirection
½½E W
.
½½W X
Input
½½X ]
,
½½] ^
includePending
½½_ m
)
½½m n
;
½½n o
return
¾¾ 
Convert
¾¾ 
.
¾¾ 
ToInt32
¾¾ "
(
¾¾" #
sph
¾¾# &
.
¾¾& '
ExecuteScalar
¾¾' 4
(
¾¾4 5
)
¾¾5 6
)
¾¾6 7
;
¾¾7 8
}
¿¿ 	
public
ÁÁ 
static
ÁÁ 
IDataReader
ÁÁ !
GetPageOfPages
ÁÁ" 0
(
ÁÁ0 1
int
ÂÂ 
siteId
ÂÂ 
,
ÂÂ 
bool
ÃÃ 
includePending
ÃÃ 
,
ÃÃ  
int
ÄÄ 

pageNumber
ÄÄ 
,
ÄÄ 
int
ÅÅ 
pageSize
ÅÅ 
,
ÅÅ 
out
ÆÆ 
int
ÆÆ 

totalPages
ÆÆ 
)
ÆÆ 
{
ÇÇ 	

totalPages
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
int
ÉÉ 
	totalRows
ÉÉ 
=
ÉÉ 
GetCount
ÉÉ $
(
ÉÉ$ %
siteId
ÉÉ% +
,
ÉÉ+ ,
includePending
ÉÉ- ;
)
ÉÉ; <
;
ÉÉ< =
if
ËË 
(
ËË 
pageSize
ËË 
>
ËË 
$num
ËË 
)
ËË 

totalPages
ËË (
=
ËË) *
	totalRows
ËË+ 4
/
ËË5 6
pageSize
ËË7 ?
;
ËË? @
if
ÍÍ 
(
ÍÍ 
	totalRows
ÍÍ 
<=
ÍÍ 
pageSize
ÍÍ %
)
ÍÍ% &
{
ÎÎ 

totalPages
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
}
ÐÐ 
else
ÑÑ 
{
ÒÒ 
int
ÓÓ 
	remainder
ÓÓ 
;
ÓÓ 
Math
ÔÔ 
.
ÔÔ 
DivRem
ÔÔ 
(
ÔÔ 
	totalRows
ÔÔ %
,
ÔÔ% &
pageSize
ÔÔ' /
,
ÔÔ/ 0
out
ÔÔ1 4
	remainder
ÔÔ5 >
)
ÔÔ> ?
;
ÔÔ? @
if
ÕÕ 
(
ÕÕ 
	remainder
ÕÕ 
>
ÕÕ 
$num
ÕÕ  !
)
ÕÕ! "
{
ÖÖ 

totalPages
×× 
+=
×× !
$num
××" #
;
××# $
}
ØØ 
}
ÙÙ  
SqlParameterHelper
ÛÛ 
sph
ÛÛ "
=
ÛÛ# $
new
ÛÛ% ( 
SqlParameterHelper
ÛÛ) ;
(
ÛÛ; <
ConnectionString
ÛÛ< L
.
ÛÛL M%
GetReadConnectionString
ÛÛM d
(
ÛÛd e
)
ÛÛe f
,
ÛÛf g
$str
ÛÛh }
,
ÛÛ} ~
$numÛÛ 
)ÛÛ 
;ÛÛ 
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# ,
,
ÜÜ, -
	SqlDbType
ÜÜ. 7
.
ÜÜ7 8
Int
ÜÜ8 ;
,
ÜÜ; < 
ParameterDirection
ÜÜ= O
.
ÜÜO P
Input
ÜÜP U
,
ÜÜU V
siteId
ÜÜW ]
)
ÜÜ] ^
;
ÜÜ^ _
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# 4
,
ÝÝ4 5
	SqlDbType
ÝÝ6 ?
.
ÝÝ? @
Bit
ÝÝ@ C
,
ÝÝC D 
ParameterDirection
ÝÝE W
.
ÝÝW X
Input
ÝÝX ]
,
ÝÝ] ^
includePending
ÝÝ_ m
)
ÝÝm n
;
ÝÝn o
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# 0
,
ÞÞ0 1
	SqlDbType
ÞÞ2 ;
.
ÞÞ; <
Int
ÞÞ< ?
,
ÞÞ? @ 
ParameterDirection
ÞÞA S
.
ÞÞS T
Input
ÞÞT Y
,
ÞÞY Z

pageNumber
ÞÞ[ e
)
ÞÞe f
;
ÞÞf g
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# .
,
ßß. /
	SqlDbType
ßß0 9
.
ßß9 :
Int
ßß: =
,
ßß= > 
ParameterDirection
ßß? Q
.
ßßQ R
Input
ßßR W
,
ßßW X
pageSize
ßßY a
)
ßßa b
;
ßßb c
return
àà 
sph
àà 
.
àà 
ExecuteReader
àà $
(
àà$ %
)
àà% &
;
àà& '
}
ââ 	
}
åå 
}ææ 
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPayPalLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPayPalLog #
{ 
public11 
static11 
int11 
Create11  
(11  !
Guid22 
rowGuid22 
,22 
DateTime33 

createdUtc33 
,33  
Guid44 
siteGuid44 
,44 
Guid55 
userGuid55 
,55 
Guid66 
	storeGuid66 
,66 
Guid77 
cartGuid77 
,77 
string88 
requestType88 
,88 
string99 

apiVersion99 
,99 
string:: 
rawResponse:: 
,:: 
string;; 
token;; 
,;; 
string<< 
payerId<< 
,<< 
string== 
transactionId==  
,==  !
string>> 
paymentType>> 
,>> 
string?? 
paymentStatus??  
,??  !
string@@ 
pendingReason@@  
,@@  !
stringAA 

reasonCodeAA 
,AA 
stringBB 
currencyCodeBB 
,BB  
decimalCC 
exchangeRateCC  
,CC  !
decimalDD 
	cartTotalDD 
,DD 
decimalEE 
	payPalAmtEE 
,EE 
decimalFF 
taxAmtFF 
,FF 
decimalGG 
feeAmtGG 
,GG 
decimalHH 
	settleAmtHH 
,HH 
stringII 
providerNameII 
,II  
stringJJ 
	returnUrlJJ 
,JJ 
stringKK 
serializedObjectKK #
,KK# $
stringLL 
pdtProviderNameLL "
,LL" #
stringMM 
ipnProviderNameMM "
,MM" #
stringNN 
responseNN 
)NN 
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M$
GetWriteConnectionStringPPM e
(PPe f
)PPf g
,PPg h
$strPPi ~
,PP~ 
$num
PP 
)
PP 
;
PP 
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# -
,QQ- .
	SqlDbTypeQQ/ 8
.QQ8 9
UniqueIdentifierQQ9 I
,QQI J
ParameterDirectionQQK ]
.QQ] ^
InputQQ^ c
,QQc d
rowGuidQQe l
)QQl m
;QQm n
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 0
,RR0 1
	SqlDbTypeRR2 ;
.RR; <
DateTimeRR< D
,RRD E
ParameterDirectionRRF X
.RRX Y
InputRRY ^
,RR^ _

createdUtcRR` j
)RRj k
;RRk l
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
siteGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# .
,TT. /
	SqlDbTypeTT0 9
.TT9 :
UniqueIdentifierTT: J
,TTJ K
ParameterDirectionTTL ^
.TT^ _
InputTT_ d
,TTd e
userGuidTTf n
)TTn o
;TTo p
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# /
,UU/ 0
	SqlDbTypeUU1 :
.UU: ;
UniqueIdentifierUU; K
,UUK L
ParameterDirectionUUM _
.UU_ `
InputUU` e
,UUe f
	storeGuidUUg p
)UUp q
;UUq r
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# .
,VV. /
	SqlDbTypeVV0 9
.VV9 :
UniqueIdentifierVV: J
,VVJ K
ParameterDirectionVVL ^
.VV^ _
InputVV_ d
,VVd e
cartGuidVVf n
)VVn o
;VVo p
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 1
,WW1 2
	SqlDbTypeWW3 <
.WW< =
NVarCharWW= E
,WWE F
$numWWG J
,WWJ K
ParameterDirectionWWL ^
.WW^ _
InputWW_ d
,WWd e
requestTypeWWf q
)WWq r
;WWr s
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# 0
,XX0 1
	SqlDbTypeXX2 ;
.XX; <
NVarCharXX< D
,XXD E
$numXXF H
,XXH I
ParameterDirectionXXJ \
.XX\ ]
InputXX] b
,XXb c

apiVersionXXd n
)XXn o
;XXo p
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 1
,YY1 2
	SqlDbTypeYY3 <
.YY< =
NVarCharYY= E
,YYE F
-YYG H
$numYYH I
,YYI J
ParameterDirectionYYK ]
.YY] ^
InputYY^ c
,YYc d
rawResponseYYe p
)YYp q
;YYq r
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# +
,ZZ+ ,
	SqlDbTypeZZ- 6
.ZZ6 7
NVarCharZZ7 ?
,ZZ? @
$numZZA C
,ZZC D
ParameterDirectionZZE W
.ZZW X
InputZZX ]
,ZZ] ^
tokenZZ_ d
)ZZd e
;ZZe f
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# -
,[[- .
	SqlDbType[[/ 8
.[[8 9
NVarChar[[9 A
,[[A B
$num[[C E
,[[E F
ParameterDirection[[G Y
.[[Y Z
Input[[Z _
,[[_ `
payerId[[a h
)[[h i
;[[i j
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 3
,\\3 4
	SqlDbType\\5 >
.\\> ?
NVarChar\\? G
,\\G H
$num\\I K
,\\K L
ParameterDirection\\M _
.\\_ `
Input\\` e
,\\e f
transactionId\\g t
)\\t u
;\\u v
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# 1
,]]1 2
	SqlDbType]]3 <
.]]< =
NVarChar]]= E
,]]E F
$num]]G I
,]]I J
ParameterDirection]]K ]
.]]] ^
Input]]^ c
,]]c d
paymentType]]e p
)]]p q
;]]q r
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 3
,^^3 4
	SqlDbType^^5 >
.^^> ?
NVarChar^^? G
,^^G H
$num^^I K
,^^K L
ParameterDirection^^M _
.^^_ `
Input^^` e
,^^e f
paymentStatus^^g t
)^^t u
;^^u v
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# 3
,__3 4
	SqlDbType__5 >
.__> ?
NVarChar__? G
,__G H
$num__I L
,__L M
ParameterDirection__N `
.__` a
Input__a f
,__f g
pendingReason__h u
)__u v
;__v w
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
NVarChar``< D
,``D E
$num``F H
,``H I
ParameterDirection``J \
.``\ ]
Input``] b
,``b c

reasonCode``d n
)``n o
;``o p
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# 2
,aa2 3
	SqlDbTypeaa4 =
.aa= >
NVarCharaa> F
,aaF G
$numaaH J
,aaJ K
ParameterDirectionaaL ^
.aa^ _
Inputaa_ d
,aad e
currencyCodeaaf r
)aar s
;aas t
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 2
,bb2 3
	SqlDbTypebb4 =
.bb= >
Decimalbb> E
,bbE F
ParameterDirectionbbG Y
.bbY Z
InputbbZ _
,bb_ `
exchangeRatebba m
)bbm n
;bbn o
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
Decimalcc; B
,ccB C
ParameterDirectionccD V
.ccV W
InputccW \
,cc\ ]
	cartTotalcc^ g
)ccg h
;cch i
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# /
,dd/ 0
	SqlDbTypedd1 :
.dd: ;
Decimaldd; B
,ddB C
ParameterDirectionddD V
.ddV W
InputddW \
,dd\ ]
	payPalAmtdd^ g
)ddg h
;ddh i
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# ,
,ee, -
	SqlDbTypeee. 7
.ee7 8
Decimalee8 ?
,ee? @
ParameterDirectioneeA S
.eeS T
InputeeT Y
,eeY Z
taxAmtee[ a
)eea b
;eeb c
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# ,
,ff, -
	SqlDbTypeff. 7
.ff7 8
Decimalff8 ?
,ff? @
ParameterDirectionffA S
.ffS T
InputffT Y
,ffY Z
feeAmtff[ a
)ffa b
;ffb c
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# /
,gg/ 0
	SqlDbTypegg1 :
.gg: ;
Decimalgg; B
,ggB C
ParameterDirectionggD V
.ggV W
InputggW \
,gg\ ]
	settleAmtgg^ g
)ggg h
;ggh i
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 2
,hh2 3
	SqlDbTypehh4 =
.hh= >
NVarCharhh> F
,hhF G
$numhhH K
,hhK L
ParameterDirectionhhM _
.hh_ `
Inputhh` e
,hhe f
providerNamehhg s
)hhs t
;hht u
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# /
,ii/ 0
	SqlDbTypeii1 :
.ii: ;
NVarCharii; C
,iiC D
$numiiE H
,iiH I
ParameterDirectioniiJ \
.ii\ ]
Inputii] b
,iib c
	returnUrliid m
)iim n
;iin o
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# 6
,jj6 7
	SqlDbTypejj8 A
.jjA B
NVarCharjjB J
,jjJ K
-jjL M
$numjjM N
,jjN O
ParameterDirectionjjP b
.jjb c
Inputjjc h
,jjh i
serializedObjectjjj z
)jjz {
;jj{ |
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 5
,kk5 6
	SqlDbTypekk7 @
.kk@ A
NVarCharkkA I
,kkI J
$numkkK N
,kkN O
ParameterDirectionkkP b
.kkb c
Inputkkc h
,kkh i
pdtProviderNamekkj y
)kky z
;kkz {
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 5
,ll5 6
	SqlDbTypell7 @
.ll@ A
NVarCharllA I
,llI J
$numllK N
,llN O
ParameterDirectionllP b
.llb c
Inputllc h
,llh i
ipnProviderNamellj y
)lly z
;llz {
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# .
,mm. /
	SqlDbTypemm0 9
.mm9 :
NVarCharmm: B
,mmB C
$nummmD G
,mmG H
ParameterDirectionmmI [
.mm[ \
Inputmm\ a
,mma b
responsemmc k
)mmk l
;mml m
intoo 
rowsAffectedoo 
=oo 
sphoo "
.oo" #
ExecuteNonQueryoo# 2
(oo2 3
)oo3 4
;oo4 5
returnpp 
rowsAffectedpp 
;pp  
}rr 	
public
 
static
 
bool
 
Update
 !
(
! "
Guid
 
rowGuid
 
,
 
DateTime
 

createdUtc
 
,
  
Guid
 
siteGuid
 
,
 
Guid
 
userGuid
 
,
 
Guid
 
	storeGuid
 
,
 
Guid
 
cartGuid
 
,
 
string
 
requestType
 
,
 
string
 

apiVersion
 
,
 
string
 
rawResponse
 
,
 
string
 
token
 
,
 
string
 
payerId
 
,
 
string
 
transactionId
  
,
  !
string
 
paymentType
 
,
 
string
 
paymentStatus
  
,
  !
string
 
pendingReason
  
,
  !
string
   

reasonCode
   
,
   
string
¡¡ 
currencyCode
¡¡ 
,
¡¡  
decimal
¢¢ 
exchangeRate
¢¢  
,
¢¢  !
decimal
££ 
	cartTotal
££ 
,
££ 
decimal
¤¤ 
	payPalAmt
¤¤ 
,
¤¤ 
decimal
¥¥ 
taxAmt
¥¥ 
,
¥¥ 
decimal
¦¦ 
feeAmt
¦¦ 
,
¦¦ 
decimal
§§ 
	settleAmt
§§ 
)
§§ 
{
¨¨ 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str
©©i ~
,
©©~ 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# -
,
ªª- .
	SqlDbType
ªª/ 8
.
ªª8 9
UniqueIdentifier
ªª9 I
,
ªªI J 
ParameterDirection
ªªK ]
.
ªª] ^
Input
ªª^ c
,
ªªc d
rowGuid
ªªe l
)
ªªl m
;
ªªm n
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 0
,
««0 1
	SqlDbType
««2 ;
.
««; <
DateTime
««< D
,
««D E 
ParameterDirection
««F X
.
««X Y
Input
««Y ^
,
««^ _

createdUtc
««` j
)
««j k
;
««k l
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# .
,
¬¬. /
	SqlDbType
¬¬0 9
.
¬¬9 :
UniqueIdentifier
¬¬: J
,
¬¬J K 
ParameterDirection
¬¬L ^
.
¬¬^ _
Input
¬¬_ d
,
¬¬d e
siteGuid
¬¬f n
)
¬¬n o
;
¬¬o p
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# .
,
­­. /
	SqlDbType
­­0 9
.
­­9 :
UniqueIdentifier
­­: J
,
­­J K 
ParameterDirection
­­L ^
.
­­^ _
Input
­­_ d
,
­­d e
userGuid
­­f n
)
­­n o
;
­­o p
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# /
,
®®/ 0
	SqlDbType
®®1 :
.
®®: ;
UniqueIdentifier
®®; K
,
®®K L 
ParameterDirection
®®M _
.
®®_ `
Input
®®` e
,
®®e f
	storeGuid
®®g p
)
®®p q
;
®®q r
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# .
,
¯¯. /
	SqlDbType
¯¯0 9
.
¯¯9 :
UniqueIdentifier
¯¯: J
,
¯¯J K 
ParameterDirection
¯¯L ^
.
¯¯^ _
Input
¯¯_ d
,
¯¯d e
cartGuid
¯¯f n
)
¯¯n o
;
¯¯o p
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 1
,
°°1 2
	SqlDbType
°°3 <
.
°°< =
NVarChar
°°= E
,
°°E F
$num
°°G J
,
°°J K 
ParameterDirection
°°L ^
.
°°^ _
Input
°°_ d
,
°°d e
requestType
°°f q
)
°°q r
;
°°r s
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# 0
,
±±0 1
	SqlDbType
±±2 ;
.
±±; <
NVarChar
±±< D
,
±±D E
$num
±±F H
,
±±H I 
ParameterDirection
±±J \
.
±±\ ]
Input
±±] b
,
±±b c

apiVersion
±±d n
)
±±n o
;
±±o p
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# 1
,
²²1 2
	SqlDbType
²²3 <
.
²²< =
NVarChar
²²= E
,
²²E F
-
²²G H
$num
²²H I
,
²²I J 
ParameterDirection
²²K ]
.
²²] ^
Input
²²^ c
,
²²c d
rawResponse
²²e p
)
²²p q
;
²²q r
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# +
,
³³+ ,
	SqlDbType
³³- 6
.
³³6 7
NVarChar
³³7 ?
,
³³? @
$num
³³A C
,
³³C D 
ParameterDirection
³³E W
.
³³W X
Input
³³X ]
,
³³] ^
token
³³_ d
)
³³d e
;
³³e f
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# -
,
´´- .
	SqlDbType
´´/ 8
.
´´8 9
NVarChar
´´9 A
,
´´A B
$num
´´C E
,
´´E F 
ParameterDirection
´´G Y
.
´´Y Z
Input
´´Z _
,
´´_ `
payerId
´´a h
)
´´h i
;
´´i j
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 3
,
µµ3 4
	SqlDbType
µµ5 >
.
µµ> ?
NVarChar
µµ? G
,
µµG H
$num
µµI K
,
µµK L 
ParameterDirection
µµM _
.
µµ_ `
Input
µµ` e
,
µµe f
transactionId
µµg t
)
µµt u
;
µµu v
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# 1
,
¶¶1 2
	SqlDbType
¶¶3 <
.
¶¶< =
NVarChar
¶¶= E
,
¶¶E F
$num
¶¶G I
,
¶¶I J 
ParameterDirection
¶¶K ]
.
¶¶] ^
Input
¶¶^ c
,
¶¶c d
paymentType
¶¶e p
)
¶¶p q
;
¶¶q r
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 3
,
··3 4
	SqlDbType
··5 >
.
··> ?
NVarChar
··? G
,
··G H
$num
··I K
,
··K L 
ParameterDirection
··M _
.
··_ `
Input
··` e
,
··e f
paymentStatus
··g t
)
··t u
;
··u v
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 3
,
¸¸3 4
	SqlDbType
¸¸5 >
.
¸¸> ?
NVarChar
¸¸? G
,
¸¸G H
$num
¸¸I L
,
¸¸L M 
ParameterDirection
¸¸N `
.
¸¸` a
Input
¸¸a f
,
¸¸f g
pendingReason
¸¸h u
)
¸¸u v
;
¸¸v w
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# 0
,
¹¹0 1
	SqlDbType
¹¹2 ;
.
¹¹; <
NVarChar
¹¹< D
,
¹¹D E
$num
¹¹F H
,
¹¹H I 
ParameterDirection
¹¹J \
.
¹¹\ ]
Input
¹¹] b
,
¹¹b c

reasonCode
¹¹d n
)
¹¹n o
;
¹¹o p
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 2
,
ºº2 3
	SqlDbType
ºº4 =
.
ºº= >
NVarChar
ºº> F
,
ººF G
$num
ººH J
,
ººJ K 
ParameterDirection
ººL ^
.
ºº^ _
Input
ºº_ d
,
ººd e
currencyCode
ººf r
)
ººr s
;
ººs t
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 2
,
»»2 3
	SqlDbType
»»4 =
.
»»= >
Decimal
»»> E
,
»»E F 
ParameterDirection
»»G Y
.
»»Y Z
Input
»»Z _
,
»»_ `
exchangeRate
»»a m
)
»»m n
;
»»n o
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# /
,
¼¼/ 0
	SqlDbType
¼¼1 :
.
¼¼: ;
Decimal
¼¼; B
,
¼¼B C 
ParameterDirection
¼¼D V
.
¼¼V W
Input
¼¼W \
,
¼¼\ ]
	cartTotal
¼¼^ g
)
¼¼g h
;
¼¼h i
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# /
,
½½/ 0
	SqlDbType
½½1 :
.
½½: ;
Decimal
½½; B
,
½½B C 
ParameterDirection
½½D V
.
½½V W
Input
½½W \
,
½½\ ]
	payPalAmt
½½^ g
)
½½g h
;
½½h i
sph
¾¾ 
.
¾¾  
DefineSqlParameter
¾¾ "
(
¾¾" #
$str
¾¾# ,
,
¾¾, -
	SqlDbType
¾¾. 7
.
¾¾7 8
Decimal
¾¾8 ?
,
¾¾? @ 
ParameterDirection
¾¾A S
.
¾¾S T
Input
¾¾T Y
,
¾¾Y Z
taxAmt
¾¾[ a
)
¾¾a b
;
¾¾b c
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# ,
,
¿¿, -
	SqlDbType
¿¿. 7
.
¿¿7 8
Decimal
¿¿8 ?
,
¿¿? @ 
ParameterDirection
¿¿A S
.
¿¿S T
Input
¿¿T Y
,
¿¿Y Z
feeAmt
¿¿[ a
)
¿¿a b
;
¿¿b c
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# /
,
ÀÀ/ 0
	SqlDbType
ÀÀ1 :
.
ÀÀ: ;
Decimal
ÀÀ; B
,
ÀÀB C 
ParameterDirection
ÀÀD V
.
ÀÀV W
Input
ÀÀW \
,
ÀÀ\ ]
	settleAmt
ÀÀ^ g
)
ÀÀg h
;
ÀÀh i
int
ÁÁ 
rowsAffected
ÁÁ 
=
ÁÁ 
sph
ÁÁ "
.
ÁÁ" #
ExecuteNonQuery
ÁÁ# 2
(
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
return
ÂÂ 
(
ÂÂ 
rowsAffected
ÂÂ  
>
ÂÂ! "
$num
ÂÂ# $
)
ÂÂ$ %
;
ÂÂ% &
}
ÄÄ 	
public
ËË 
static
ËË 
bool
ËË 
Delete
ËË !
(
ËË! "
Guid
ËË" &
rowGuid
ËË' .
)
ËË. /
{
ÌÌ 	 
SqlParameterHelper
ÍÍ 
sph
ÍÍ "
=
ÍÍ# $
new
ÍÍ% ( 
SqlParameterHelper
ÍÍ) ;
(
ÍÍ; <
ConnectionString
ÍÍ< L
.
ÍÍL M&
GetWriteConnectionString
ÍÍM e
(
ÍÍe f
)
ÍÍf g
,
ÍÍg h
$str
ÍÍi ~
,
ÍÍ~ 
$numÍÍ 
)ÍÍ 
;ÍÍ 
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# -
,
ÎÎ- .
	SqlDbType
ÎÎ/ 8
.
ÎÎ8 9
UniqueIdentifier
ÎÎ9 I
,
ÎÎI J 
ParameterDirection
ÎÎK ]
.
ÎÎ] ^
Input
ÎÎ^ c
,
ÎÎc d
rowGuid
ÎÎe l
)
ÎÎl m
;
ÎÎm n
int
ÏÏ 
rowsAffected
ÏÏ 
=
ÏÏ 
sph
ÏÏ "
.
ÏÏ" #
ExecuteNonQuery
ÏÏ# 2
(
ÏÏ2 3
)
ÏÏ3 4
;
ÏÏ4 5
return
ÐÐ 
(
ÐÐ 
rowsAffected
ÐÐ  
>
ÐÐ! "
$num
ÐÐ# $
)
ÐÐ$ %
;
ÐÐ% &
}
ÒÒ 	
public
ÔÔ 
static
ÔÔ 
bool
ÔÔ 
DeleteByCart
ÔÔ '
(
ÔÔ' (
Guid
ÔÔ( ,
cartGuid
ÔÔ- 5
)
ÔÔ5 6
{
ÕÕ 	 
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M&
GetWriteConnectionString
ÖÖM e
(
ÖÖe f
)
ÖÖf g
,
ÖÖg h
$strÖÖi 
,ÖÖ 
$numÖÖ 
)ÖÖ 
;ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× "
(
××" #
$str
××# .
,
××. /
	SqlDbType
××0 9
.
××9 :
UniqueIdentifier
××: J
,
××J K 
ParameterDirection
××L ^
.
××^ _
Input
××_ d
,
××d e
cartGuid
××f n
)
××n o
;
××o p
int
ØØ 
rowsAffected
ØØ 
=
ØØ 
sph
ØØ "
.
ØØ" #
ExecuteNonQuery
ØØ# 2
(
ØØ2 3
)
ØØ3 4
;
ØØ4 5
return
ÙÙ 
(
ÙÙ 
rowsAffected
ÙÙ  
>
ÙÙ! "
$num
ÙÙ# $
)
ÙÙ$ %
;
ÙÙ% &
}
ÛÛ 	
public
ÝÝ 
static
ÝÝ 
bool
ÝÝ 
DeleteBySite
ÝÝ '
(
ÝÝ' (
Guid
ÝÝ( ,
siteGuid
ÝÝ- 5
)
ÝÝ5 6
{
ÞÞ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M&
GetWriteConnectionString
ßßM e
(
ßße f
)
ßßf g
,
ßßg h
$strßßi 
,ßß 
$numßß 
)ßß 
;ßß 
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# .
,
àà. /
	SqlDbType
àà0 9
.
àà9 :
UniqueIdentifier
àà: J
,
ààJ K 
ParameterDirection
ààL ^
.
àà^ _
Input
àà_ d
,
ààd e
siteGuid
ààf n
)
ààn o
;
àào p
int
áá 
rowsAffected
áá 
=
áá 
sph
áá "
.
áá" #
ExecuteNonQuery
áá# 2
(
áá2 3
)
áá3 4
;
áá4 5
return
ââ 
(
ââ 
rowsAffected
ââ  
>
ââ! "
$num
ââ# $
)
ââ$ %
;
ââ% &
}
ää 	
public
ææ 
static
ææ 
bool
ææ 
DeleteByStore
ææ (
(
ææ( )
Guid
ææ) -
	storeGuid
ææ. 7
)
ææ7 8
{
çç 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M&
GetWriteConnectionString
èèM e
(
èèe f
)
èèf g
,
èèg h
$strèèi 
,èè 
$numèè 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# /
,
éé/ 0
	SqlDbType
éé1 :
.
éé: ;
UniqueIdentifier
éé; K
,
ééK L 
ParameterDirection
ééM _
.
éé_ `
Input
éé` e
,
éée f
	storeGuid
éég p
)
éép q
;
ééq r
int
êê 
rowsAffected
êê 
=
êê 
sph
êê "
.
êê" #
ExecuteNonQuery
êê# 2
(
êê2 3
)
êê3 4
;
êê4 5
return
ëë 
(
ëë 
rowsAffected
ëë  
>
ëë! "
$num
ëë# $
)
ëë$ %
;
ëë% &
}
íí 	
public
óó 
static
óó 
IDataReader
óó !
GetOne
óó" (
(
óó( )
Guid
óó) -
rowGuid
óó. 5
)
óó5 6
{
ôô 	 
SqlParameterHelper
õõ 
sph
õõ "
=
õõ# $
new
õõ% ( 
SqlParameterHelper
õõ) ;
(
õõ; <
ConnectionString
õõ< L
.
õõL M%
GetReadConnectionString
õõM d
(
õõd e
)
õõe f
,
õõf g
$strõõh 
,õõ 
$numõõ 
)õõ 
;õõ 
sph
öö 
.
öö  
DefineSqlParameter
öö "
(
öö" #
$str
öö# -
,
öö- .
	SqlDbType
öö/ 8
.
öö8 9
UniqueIdentifier
öö9 I
,
ööI J 
ParameterDirection
ööK ]
.
öö] ^
Input
öö^ c
,
ööc d
rowGuid
ööe l
)
ööl m
;
ööm n
return
÷÷ 
sph
÷÷ 
.
÷÷ 
ExecuteReader
÷÷ $
(
÷÷$ %
)
÷÷% &
;
÷÷& '
}
ùù 	
public
ÿÿ 
static
ÿÿ 
IDataReader
ÿÿ !
	GetByCart
ÿÿ" +
(
ÿÿ+ ,
Guid
ÿÿ, 0
cartGuid
ÿÿ1 9
)
ÿÿ9 :
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
cartGuid
f n
)
n o
;
o p
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !#
GetSetExpressCheckout
" 7
(
7 8
string
8 >
token
? D
)
D E
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
NVarChar
7 ?
,
? @
$num
A C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
token
_ d
)
d e
;
e f
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetMostRecentLog
" 2
(
2 3
Guid
3 7
cartGuid
8 @
,
@ A
string
B H
requestType
I T
)
T U
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
cartGuid
g o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
$num
G J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
requestType
f q
)
q r
;
r s
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
}
àà 
}ââ Û¯
mD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBPlugNPayLog.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBPlugNPayLog %
{ 
public66 
static66 
int66 
Create66  
(66  !
Guid77 
rowGuid77 
,77 
DateTime88 

createdUtc88 
,88  
Guid99 
siteGuid99 
,99 
Guid:: 
userGuid:: 
,:: 
Guid;; 
	storeGuid;; 
,;; 
Guid<< 
cartGuid<< 
,<< 
string== 
rawResponse== 
,== 
string>> 
responseCode>> 
,>>  
string?? 
responseReasonCode?? %
,??% &
string@@ 
reason@@ 
,@@ 
stringAA 
avsCodeAA 
,AA 
stringBB 
ccvCodeBB 
,BB 
stringCC 
cavCodeCC 
,CC 
stringDD 
transactionIdDD  
,DD  !
stringEE 
transactionTypeEE "
,EE" #
stringFF 
methodFF 
,FF 
stringGG 
authCodeGG 
,GG 
decimalHH 
amountHH 
,HH 
decimalII 
taxII 
,II 
decimalJJ 
dutyJJ 
,JJ 
decimalKK 
freightKK 
)KK 
{LL 	
SqlParameterHelperMM 
sphMM "
=MM# $
newMM% (
SqlParameterHelperMM) ;
(MM; <
ConnectionStringMM< L
.MML M$
GetWriteConnectionStringMMM e
(MMe f
)MMf g
,MMg h
$str	MMi 
,
MM 
$num
MM 
)
MM 
;
MM 
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
UniqueIdentifierNN9 I
,NNI J
ParameterDirectionNNK ]
.NN] ^
InputNN^ c
,NNc d
rowGuidNNe l
)NNl m
;NNm n
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 0
,OO0 1
	SqlDbTypeOO2 ;
.OO; <
DateTimeOO< D
,OOD E
ParameterDirectionOOF X
.OOX Y
InputOOY ^
,OO^ _

createdUtcOO` j
)OOj k
;OOk l
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
UniqueIdentifierQQ: J
,QQJ K
ParameterDirectionQQL ^
.QQ^ _
InputQQ_ d
,QQd e
userGuidQQf n
)QQn o
;QQo p
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# /
,RR/ 0
	SqlDbTypeRR1 :
.RR: ;
UniqueIdentifierRR; K
,RRK L
ParameterDirectionRRM _
.RR_ `
InputRR` e
,RRe f
	storeGuidRRg p
)RRp q
;RRq r
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# .
,SS. /
	SqlDbTypeSS0 9
.SS9 :
UniqueIdentifierSS: J
,SSJ K
ParameterDirectionSSL ^
.SS^ _
InputSS_ d
,SSd e
cartGuidSSf n
)SSn o
;SSo p
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 1
,TT1 2
	SqlDbTypeTT3 <
.TT< =
NVarCharTT= E
,TTE F
-TTG H
$numTTH I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d
rawResponseTTe p
)TTp q
;TTq r
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# 2
,UU2 3
	SqlDbTypeUU4 =
.UU= >
NVarCharUU> F
,UUF G
$numUUH J
,UUJ K
ParameterDirectionUUL ^
.UU^ _
InputUU_ d
,UUd e
responseCodeUUf r
)UUr s
;UUs t
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 8
,VV8 9
	SqlDbTypeVV: C
.VVC D
NVarCharVVD L
,VVL M
$numVVN P
,VVP Q
ParameterDirectionVVR d
.VVd e
InputVVe j
,VVj k
responseReasonCodeVVl ~
)VV~ 
;	VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# ,
,WW, -
	SqlDbTypeWW. 7
.WW7 8
NVarCharWW8 @
,WW@ A
-WWB C
$numWWC D
,WWD E
ParameterDirectionWWF X
.WWX Y
InputWWY ^
,WW^ _
reasonWW` f
)WWf g
;WWg h
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# -
,XX- .
	SqlDbTypeXX/ 8
.XX8 9
NVarCharXX9 A
,XXA B
$numXXC E
,XXE F
ParameterDirectionXXG Y
.XXY Z
InputXXZ _
,XX_ `
avsCodeXXa h
)XXh i
;XXi j
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# -
,YY- .
	SqlDbTypeYY/ 8
.YY8 9
NVarCharYY9 A
,YYA B
$numYYC E
,YYE F
ParameterDirectionYYG Y
.YYY Z
InputYYZ _
,YY_ `
ccvCodeYYa h
)YYh i
;YYi j
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# -
,ZZ- .
	SqlDbTypeZZ/ 8
.ZZ8 9
NVarCharZZ9 A
,ZZA B
$numZZC E
,ZZE F
ParameterDirectionZZG Y
.ZZY Z
InputZZZ _
,ZZ_ `
cavCodeZZa h
)ZZh i
;ZZi j
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 3
,[[3 4
	SqlDbType[[5 >
.[[> ?
NVarChar[[? G
,[[G H
$num[[I K
,[[K L
ParameterDirection[[M _
.[[_ `
Input[[` e
,[[e f
transactionId[[g t
)[[t u
;[[u v
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 5
,\\5 6
	SqlDbType\\7 @
.\\@ A
NVarChar\\A I
,\\I J
$num\\K M
,\\M N
ParameterDirection\\O a
.\\a b
Input\\b g
,\\g h
transactionType\\i x
)\\x y
;\\y z
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# ,
,]], -
	SqlDbType]]. 7
.]]7 8
NVarChar]]8 @
,]]@ A
$num]]B D
,]]D E
ParameterDirection]]F X
.]]X Y
Input]]Y ^
,]]^ _
method]]` f
)]]f g
;]]g h
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# .
,^^. /
	SqlDbType^^0 9
.^^9 :
NVarChar^^: B
,^^B C
$num^^D F
,^^F G
ParameterDirection^^H Z
.^^Z [
Input^^[ `
,^^` a
authCode^^b j
)^^j k
;^^k l
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Decimal__8 ?
,__? @
ParameterDirection__A S
.__S T
Input__T Y
,__Y Z
amount__[ a
)__a b
;__b c
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# )
,``) *
	SqlDbType``+ 4
.``4 5
Decimal``5 <
,``< =
ParameterDirection``> P
.``P Q
Input``Q V
,``V W
tax``X [
)``[ \
;``\ ]
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# *
,aa* +
	SqlDbTypeaa, 5
.aa5 6
Decimalaa6 =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
dutyaaY ]
)aa] ^
;aa^ _
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# -
,bb- .
	SqlDbTypebb/ 8
.bb8 9
Decimalbb9 @
,bb@ A
ParameterDirectionbbB T
.bbT U
InputbbU Z
,bbZ [
freightbb\ c
)bbc d
;bbd e
intcc 
rowsAffectedcc 
=cc 
sphcc "
.cc" #
ExecuteNonQuerycc# 2
(cc2 3
)cc3 4
;cc4 5
returndd 
rowsAffecteddd 
;dd  
}ff 	
public
 
static
 
bool
 
Update
 !
(
! "
Guid
 
rowGuid
 
,
 
Guid
 
siteGuid
 
,
 
Guid
 
userGuid
 
,
 
Guid
 
	storeGuid
 
,
 
Guid
 
cartGuid
 
,
 
string
 
rawResponse
 
,
 
string
 
responseCode
 
,
  
string
  
responseReasonCode
 %
,
% &
string
 
reason
 
,
 
string
 
avsCode
 
,
 
string
 
ccvCode
 
,
 
string
 
cavCode
 
,
 
string
 
transactionId
  
,
  !
string
 
transactionType
 "
,
" #
string
 
method
 
,
 
string
 
authCode
 
,
 
decimal
 
amount
 
,
 
decimal
 
tax
 
,
 
decimal
 
duty
 
,
 
decimal
 
freight
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
UniqueIdentifier
9 I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
rowGuid
e l
)
l m
;
m n
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
UniqueIdentifier
; K
,
K L 
ParameterDirection
M _
.
_ `
Input
` e
,
e f
	storeGuid
g p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
cartGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
NVarChar
= E
,
E F
-
G H
$num
H I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d
rawResponse
e p
)
p q
;
q r
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
NVarChar
> F
,
F G
$num
H J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
responseCode
f r
)
r s
;
s t
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 8
,
8 9
	SqlDbType
: C
.
C D
NVarChar
D L
,
L M
$num
N P
,
P Q 
ParameterDirection
R d
.
d e
Input
e j
,
j k 
responseReasonCode
l ~
)
~ 
; 
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # ,
,
  , -
	SqlDbType
  . 7
.
  7 8
NVarChar
  8 @
,
  @ A
-
  B C
$num
  C D
,
  D E 
ParameterDirection
  F X
.
  X Y
Input
  Y ^
,
  ^ _
reason
  ` f
)
  f g
;
  g h
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# -
,
¡¡- .
	SqlDbType
¡¡/ 8
.
¡¡8 9
NVarChar
¡¡9 A
,
¡¡A B
$num
¡¡C E
,
¡¡E F 
ParameterDirection
¡¡G Y
.
¡¡Y Z
Input
¡¡Z _
,
¡¡_ `
avsCode
¡¡a h
)
¡¡h i
;
¡¡i j
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# -
,
¢¢- .
	SqlDbType
¢¢/ 8
.
¢¢8 9
NVarChar
¢¢9 A
,
¢¢A B
$num
¢¢C E
,
¢¢E F 
ParameterDirection
¢¢G Y
.
¢¢Y Z
Input
¢¢Z _
,
¢¢_ `
ccvCode
¢¢a h
)
¢¢h i
;
¢¢i j
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# -
,
££- .
	SqlDbType
££/ 8
.
££8 9
NVarChar
££9 A
,
££A B
$num
££C E
,
££E F 
ParameterDirection
££G Y
.
££Y Z
Input
££Z _
,
££_ `
cavCode
££a h
)
££h i
;
££i j
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 3
,
¤¤3 4
	SqlDbType
¤¤5 >
.
¤¤> ?
NVarChar
¤¤? G
,
¤¤G H
$num
¤¤I K
,
¤¤K L 
ParameterDirection
¤¤M _
.
¤¤_ `
Input
¤¤` e
,
¤¤e f
transactionId
¤¤g t
)
¤¤t u
;
¤¤u v
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# 5
,
¥¥5 6
	SqlDbType
¥¥7 @
.
¥¥@ A
NVarChar
¥¥A I
,
¥¥I J
$num
¥¥K M
,
¥¥M N 
ParameterDirection
¥¥O a
.
¥¥a b
Input
¥¥b g
,
¥¥g h
transactionType
¥¥i x
)
¥¥x y
;
¥¥y z
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# ,
,
¦¦, -
	SqlDbType
¦¦. 7
.
¦¦7 8
NVarChar
¦¦8 @
,
¦¦@ A
$num
¦¦B D
,
¦¦D E 
ParameterDirection
¦¦F X
.
¦¦X Y
Input
¦¦Y ^
,
¦¦^ _
method
¦¦` f
)
¦¦f g
;
¦¦g h
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# .
,
§§. /
	SqlDbType
§§0 9
.
§§9 :
NVarChar
§§: B
,
§§B C
$num
§§D F
,
§§F G 
ParameterDirection
§§H Z
.
§§Z [
Input
§§[ `
,
§§` a
authCode
§§b j
)
§§j k
;
§§k l
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# ,
,
¨¨, -
	SqlDbType
¨¨. 7
.
¨¨7 8
Decimal
¨¨8 ?
,
¨¨? @ 
ParameterDirection
¨¨A S
.
¨¨S T
Input
¨¨T Y
,
¨¨Y Z
amount
¨¨[ a
)
¨¨a b
;
¨¨b c
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# )
,
©©) *
	SqlDbType
©©+ 4
.
©©4 5
Decimal
©©5 <
,
©©< = 
ParameterDirection
©©> P
.
©©P Q
Input
©©Q V
,
©©V W
tax
©©X [
)
©©[ \
;
©©\ ]
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# *
,
ªª* +
	SqlDbType
ªª, 5
.
ªª5 6
Decimal
ªª6 =
,
ªª= > 
ParameterDirection
ªª? Q
.
ªªQ R
Input
ªªR W
,
ªªW X
duty
ªªY ]
)
ªª] ^
;
ªª^ _
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# -
,
««- .
	SqlDbType
««/ 8
.
««8 9
Decimal
««9 @
,
««@ A 
ParameterDirection
««B T
.
««T U
Input
««U Z
,
««Z [
freight
««\ c
)
««c d
;
««d e
int
¬¬ 
rowsAffected
¬¬ 
=
¬¬ 
sph
¬¬ "
.
¬¬" #
ExecuteNonQuery
¬¬# 2
(
¬¬2 3
)
¬¬3 4
;
¬¬4 5
return
­­ 
(
­­ 
rowsAffected
­­  
>
­­! "
$num
­­# $
)
­­$ %
;
­­% &
}
¯¯ 	
public
¶¶ 
static
¶¶ 
bool
¶¶ 
Delete
¶¶ !
(
¶¶! "
Guid
¶¶" &
rowGuid
¶¶' .
)
¶¶. /
{
·· 	 
SqlParameterHelper
¸¸ 
sph
¸¸ "
=
¸¸# $
new
¸¸% ( 
SqlParameterHelper
¸¸) ;
(
¸¸; <
ConnectionString
¸¸< L
.
¸¸L M&
GetWriteConnectionString
¸¸M e
(
¸¸e f
)
¸¸f g
,
¸¸g h
$str¸¸i 
,¸¸ 
$num¸¸ 
)¸¸ 
;¸¸ 
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# -
,
¹¹- .
	SqlDbType
¹¹/ 8
.
¹¹8 9
UniqueIdentifier
¹¹9 I
,
¹¹I J 
ParameterDirection
¹¹K ]
.
¹¹] ^
Input
¹¹^ c
,
¹¹c d
rowGuid
¹¹e l
)
¹¹l m
;
¹¹m n
int
ºº 
rowsAffected
ºº 
=
ºº 
sph
ºº "
.
ºº" #
ExecuteNonQuery
ºº# 2
(
ºº2 3
)
ºº3 4
;
ºº4 5
return
»» 
(
»» 
rowsAffected
»»  
>
»»! "
$num
»»# $
)
»»$ %
;
»»% &
}
½½ 	
public
ÃÃ 
static
ÃÃ 
IDataReader
ÃÃ !
GetOne
ÃÃ" (
(
ÃÃ( )
Guid
ÃÃ) -
rowGuid
ÃÃ. 5
)
ÃÃ5 6
{
ÄÄ 	 
SqlParameterHelper
ÅÅ 
sph
ÅÅ "
=
ÅÅ# $
new
ÅÅ% ( 
SqlParameterHelper
ÅÅ) ;
(
ÅÅ; <
ConnectionString
ÅÅ< L
.
ÅÅL M%
GetReadConnectionString
ÅÅM d
(
ÅÅd e
)
ÅÅe f
,
ÅÅf g
$strÅÅh 
,ÅÅ 
$numÅÅ 
)ÅÅ 
;ÅÅ 
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# -
,
ÆÆ- .
	SqlDbType
ÆÆ/ 8
.
ÆÆ8 9
UniqueIdentifier
ÆÆ9 I
,
ÆÆI J 
ParameterDirection
ÆÆK ]
.
ÆÆ] ^
Input
ÆÆ^ c
,
ÆÆc d
rowGuid
ÆÆe l
)
ÆÆl m
;
ÆÆm n
return
ÇÇ 
sph
ÇÇ 
.
ÇÇ 
ExecuteReader
ÇÇ $
(
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
}
ÉÉ 	
public
ÏÏ 
static
ÏÏ 
IDataReader
ÏÏ !
	GetByCart
ÏÏ" +
(
ÏÏ+ ,
Guid
ÏÏ, 0
cartGuid
ÏÏ1 9
)
ÏÏ9 :
{
ÐÐ 	 
SqlParameterHelper
ÑÑ 
sph
ÑÑ "
=
ÑÑ# $
new
ÑÑ% ( 
SqlParameterHelper
ÑÑ) ;
(
ÑÑ; <
ConnectionString
ÑÑ< L
.
ÑÑL M%
GetReadConnectionString
ÑÑM d
(
ÑÑd e
)
ÑÑe f
,
ÑÑf g
$strÑÑh 
,ÑÑ 
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# .
,
ÒÒ. /
	SqlDbType
ÒÒ0 9
.
ÒÒ9 :
UniqueIdentifier
ÒÒ: J
,
ÒÒJ K 
ParameterDirection
ÒÒL ^
.
ÒÒ^ _
Input
ÒÒ_ d
,
ÒÒd e
cartGuid
ÒÒf n
)
ÒÒn o
;
ÒÒo p
return
ÓÓ 
sph
ÓÓ 
.
ÓÓ 
ExecuteReader
ÓÓ $
(
ÓÓ$ %
)
ÓÓ% &
;
ÓÓ& '
}
ÕÕ 	
}
ÜÜ 
}ÞÞ ³
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbPortal.cs
	namespace!! 	

mojoPortal!!
 
.!! 
Data!! 
{"" 
public'' 

static'' 
class'' 
DBPortal''  
{(( 
private** 
static** 
readonly** 
ILog**  $
log**% (
=**) *

LogManager**+ 5
.**5 6
	GetLogger**6 ?
(**? @
typeof**@ F
(**F G
DBPortal**G O
)**O P
)**P Q
;**Q R
private;; 
static;; 
string;; 
GetdbOwnerPrefix;; .
(;;. /
);;/ 0
{<< 	
string== 
ownerPrefix== 
===  
$str==! )
;==) *
if>> 
(>>  
ConfigurationManager>> $
.>>$ %
AppSettings>>% 0
[>>0 1
$str>>1 C
]>>C D
!=>>E G
null>>H L
)>>L M
{?? 
ownerPrefix@@ 
=@@  
ConfigurationManager@@ 2
.@@2 3
AppSettings@@3 >
[@@> ?
$str@@? Q
]@@Q R
;@@R S
}BB 
returnDD 
ownerPrefixDD 
;DD 
}EE 	
publicGG 
staticGG 
voidGG 
EnsureDatabaseGG )
(GG) *
)GG* +
{HH 	
SqlConnectionMM 

connectionMM $
=MM% &
newMM' *
SqlConnectionMM+ 8
(MM8 9
ConnectionStringMM9 I
.MMI J$
GetWriteConnectionStringMMJ b
(MMb c
)MMc d
)MMd e
;MMe f
SqlConnectionNN 
MasterConnectionNN *
=NN+ ,
newNN- 0
SqlConnectionNN1 >
(NN> ?
)NN? @
;NN@ A
tryPP 
{QQ &
SqlConnectionStringBuilderRR *
masterRR+ 1
=RR2 3
newRR4 7&
SqlConnectionStringBuilderRR8 R
(RRR S
)RRS T
;RRT U
masterSS 
.SS 
ConnectionStringSS '
=SS( )

connectionSS* 4
.SS4 5
ConnectionStringSS5 E
;SSE F
masterTT 
[TT 
$strTT 
]TT  
=TT! "

connectionTT# -
.TT- .

DataSourceTT. 8
;TT8 9
masterUU 
[UU 
$strUU !
]UU! "
=UU# $
$strUU% -
;UU- .
MasterConnectionWW  
=WW! "
newWW# &
SqlConnectionWW' 4
(WW4 5
masterWW5 ;
.WW; <
ConnectionStringWW< L
)WWL M
;WWM N
StringBuilderYY 
sqlYY !
=YY" #
newYY$ '
StringBuilderYY( 5
(YY5 6
)YY6 7
;YY7 8
sqlZZ 
.ZZ 
AppendZZ 
(ZZ 
$strZZ o
)ZZo p
;ZZp q
sql[[ 
.[[ 
Append[[ 
([[ 

connection[[ %
.[[% &
Database[[& .
)[[. /
;[[/ 0
sql\\ 
.\\ 
Append\\ 
(\\ 
$str\\ +
)\\+ ,
;\\, -

SqlCommand^^ 
command^^ "
=^^# $
new^^% (

SqlCommand^^) 3
(^^3 4
sql^^4 7
.^^7 8
ToString^^8 @
(^^@ A
)^^A B
,^^B C
MasterConnection^^D T
)^^T U
;^^U V
command__ 
.__ 

Parameters__ "
.__" #
AddWithValue__# /
(__/ 0
$str__0 7
,__7 8

connection__9 C
.__C D
Database__D L
)__L M
;__M N
MasterConnection``  
.``  !
Open``! %
(``% &
)``& '
;``' (
intaa 
resaa 
=aa 
commandaa !
.aa! "
ExecuteNonQueryaa" 1
(aa1 2
)aa2 3
;aa3 4
ifcc 
(cc 
rescc 
==cc 
-cc 
$numcc 
)cc 
{dd 
logdd 
.dd 
Infodd 
(dd 
$strdd A
)ddA B
;ddB C
}ddD E
elseee 
{ff 
logff 
.ff 
Infoff 
(ff 
$strff =
)ff= >
;ff> ?
}ff@ A
}hh 
catchii 
(ii 
	Exceptionii 
exii 
)ii 
{jj 
logkk 
.kk 
Errorkk 
(kk 
$strkk <
,kk< =
exkk> @
)kk@ A
;kkA B
}ll 
finallymm 
{nn 
ifoo 
(oo 
MasterConnectionoo $
.oo$ %
Stateoo% *
==oo+ -
ConnectionStateoo. =
.oo= >
Openoo> B
)ooB C
MasterConnectionpp $
.pp$ %
Closepp% *
(pp* +
)pp+ ,
;pp, -
}qq 
}ss 	
publicyy 
staticyy 
Stringyy 

DBPlatformyy '
(yy' (
)yy( )
{zz 	
return{{ 
$str{{ 
;{{ 
}|| 	
public
 
static
 
IDataReader
 !,
DatabaseHelperGetApplicationId
" @
(
@ A
string
A G
applicationName
H W
)
W X
{
 	
return
 %
DatabaseHelperGetReader
 *
(
* +
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
$str
 "
,
" #
$str
 3
+
4 5
applicationName
6 E
.
E F
ToLower
F M
(
M N
)
N O
+
P Q
$str
R U
)
U V
;
V W
}
 	
public
 
static
 
bool
 +
SchemaVersionAddSchemaVersion
 8
(
8 9
Guid

 
applicationId
 
,
 
string

 
applicationName
  
,
  !
int

 
major
 
,
 
int

 
minor
 
,
 
int

 
build
 
,
 
int

 
revision
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
UniqueIdentifier
? O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
applicationId
k x
)
x y
;
y z
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 5
,
  5 6
	SqlDbType
  7 @
.
  @ A
NVarChar
  A I
,
  I J 
ParameterDirection
  K ]
.
  ] ^
Input
  ^ c
,
  c d
applicationName
  e t
)
  t u
;
  u v
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# +
,
¡¡+ ,
	SqlDbType
¡¡- 6
.
¡¡6 7
Int
¡¡7 :
,
¡¡: ; 
ParameterDirection
¡¡< N
.
¡¡N O
Input
¡¡O T
,
¡¡T U
major
¡¡V [
)
¡¡[ \
;
¡¡\ ]
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# +
,
¢¢+ ,
	SqlDbType
¢¢- 6
.
¢¢6 7
Int
¢¢7 :
,
¢¢: ; 
ParameterDirection
¢¢< N
.
¢¢N O
Input
¢¢O T
,
¢¢T U
minor
¢¢V [
)
¢¢[ \
;
¢¢\ ]
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# +
,
££+ ,
	SqlDbType
££- 6
.
££6 7
Int
££7 :
,
££: ; 
ParameterDirection
££< N
.
££N O
Input
££O T
,
££T U
build
££V [
)
££[ \
;
££\ ]
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# .
,
¤¤. /
	SqlDbType
¤¤0 9
.
¤¤9 :
Int
¤¤: =
,
¤¤= > 
ParameterDirection
¤¤? Q
.
¤¤Q R
Input
¤¤R W
,
¤¤W X
revision
¤¤Y a
)
¤¤a b
;
¤¤b c
int
¥¥ 
rowsAffected
¥¥ 
=
¥¥ 
Convert
¥¥ &
.
¥¥& '
ToInt32
¥¥' .
(
¥¥. /
sph
¥¥/ 2
.
¥¥2 3
ExecuteNonQuery
¥¥3 B
(
¥¥B C
)
¥¥C D
)
¥¥D E
;
¥¥E F
return
¦¦ 
(
¦¦ 
rowsAffected
¦¦  
>
¦¦! "
$num
¦¦# $
)
¦¦$ %
;
¦¦% &
}
§§ 	
public
ªª 
static
ªª 
bool
ªª .
 SchemaVersionUpdateSchemaVersion
ªª ;
(
ªª; <
Guid
«« 
applicationId
«« 
,
«« 
string
¬¬ 
applicationName
¬¬ "
,
¬¬" #
int
­­ 
major
­­ 
,
­­ 
int
®® 
minor
®® 
,
®® 
int
¯¯ 
build
¯¯ 
,
¯¯ 
int
°° 
revision
°° 
)
°° 
{
±± 	 
SqlParameterHelper
²² 
sph
²² "
=
²²# $
new
²²% ( 
SqlParameterHelper
²²) ;
(
²²; <
ConnectionString
²²< L
.
²²L M&
GetWriteConnectionString
²²M e
(
²²e f
)
²²f g
,
²²g h
$str²²i 
,²² 
$num²² 
)²² 
;²² 
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# 3
,
³³3 4
	SqlDbType
³³5 >
.
³³> ?
UniqueIdentifier
³³? O
,
³³O P 
ParameterDirection
³³Q c
.
³³c d
Input
³³d i
,
³³i j
applicationId
³³k x
)
³³x y
;
³³y z
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 5
,
´´5 6
	SqlDbType
´´7 @
.
´´@ A
NVarChar
´´A I
,
´´I J 
ParameterDirection
´´K ]
.
´´] ^
Input
´´^ c
,
´´c d
applicationName
´´e t
)
´´t u
;
´´u v
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# +
,
µµ+ ,
	SqlDbType
µµ- 6
.
µµ6 7
Int
µµ7 :
,
µµ: ; 
ParameterDirection
µµ< N
.
µµN O
Input
µµO T
,
µµT U
major
µµV [
)
µµ[ \
;
µµ\ ]
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# +
,
¶¶+ ,
	SqlDbType
¶¶- 6
.
¶¶6 7
Int
¶¶7 :
,
¶¶: ; 
ParameterDirection
¶¶< N
.
¶¶N O
Input
¶¶O T
,
¶¶T U
minor
¶¶V [
)
¶¶[ \
;
¶¶\ ]
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# +
,
··+ ,
	SqlDbType
··- 6
.
··6 7
Int
··7 :
,
··: ; 
ParameterDirection
··< N
.
··N O
Input
··O T
,
··T U
build
··V [
)
··[ \
;
··\ ]
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# .
,
¸¸. /
	SqlDbType
¸¸0 9
.
¸¸9 :
Int
¸¸: =
,
¸¸= > 
ParameterDirection
¸¸? Q
.
¸¸Q R
Input
¸¸R W
,
¸¸W X
revision
¸¸Y a
)
¸¸a b
;
¸¸b c
int
¹¹ 
rowsAffected
¹¹ 
=
¹¹ 
sph
¹¹ "
.
¹¹" #
ExecuteNonQuery
¹¹# 2
(
¹¹2 3
)
¹¹3 4
;
¹¹4 5
return
ºº 
(
ºº 
rowsAffected
ºº  
>
ºº! "
-
ºº# $
$num
ºº$ %
)
ºº% &
;
ºº& '
}
»» 	
public
½½ 
static
½½ 
bool
½½ .
 SchemaVersionDeleteSchemaVersion
½½ ;
(
½½; <
Guid
½½< @
applicationId
½½A N
)
½½N O
{
¾¾ 	 
SqlParameterHelper
¿¿ 
sph
¿¿ "
=
¿¿# $
new
¿¿% ( 
SqlParameterHelper
¿¿) ;
(
¿¿; <
ConnectionString
¿¿< L
.
¿¿L M&
GetWriteConnectionString
¿¿M e
(
¿¿e f
)
¿¿f g
,
¿¿g h
$str¿¿i 
,¿¿ 
$num¿¿ 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 3
,
ÀÀ3 4
	SqlDbType
ÀÀ5 >
.
ÀÀ> ?
UniqueIdentifier
ÀÀ? O
,
ÀÀO P 
ParameterDirection
ÀÀQ c
.
ÀÀc d
Input
ÀÀd i
,
ÀÀi j
applicationId
ÀÀk x
)
ÀÀx y
;
ÀÀy z
int
ÁÁ 
rowsAffected
ÁÁ 
=
ÁÁ 
sph
ÁÁ "
.
ÁÁ" #
ExecuteNonQuery
ÁÁ# 2
(
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
return
ÂÂ 
(
ÂÂ 
rowsAffected
ÂÂ  
>
ÂÂ! "
-
ÂÂ# $
$num
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
}
ÃÃ 	
public
ÅÅ 
static
ÅÅ 
bool
ÅÅ !
SchemaVersionExists
ÅÅ .
(
ÅÅ. /
Guid
ÅÅ/ 3
applicationId
ÅÅ4 A
)
ÅÅA B
{
ÆÆ 	
bool
ÇÇ 
result
ÇÇ 
=
ÇÇ 
false
ÇÇ 
;
ÇÇ  
using
ÉÉ 
(
ÉÉ 
IDataReader
ÉÉ 
reader
ÉÉ %
=
ÉÉ& '+
SchemaVersionGetSchemaVersion
ÉÉ( E
(
ÉÉE F
applicationId
ÉÉF S
)
ÉÉS T
)
ÉÉT U
{
ÊÊ 
if
ËË 
(
ËË 
reader
ËË 
.
ËË 
Read
ËË 
(
ËË  
)
ËË  !
)
ËË! "
{
ÌÌ 
result
ÍÍ 
=
ÍÍ 
true
ÍÍ !
;
ÍÍ! "
}
ÎÎ 
}
ÏÏ 
return
ÑÑ 
result
ÑÑ 
;
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
static
ÖÖ 
IDataReader
ÖÖ !+
SchemaVersionGetSchemaVersion
ÖÖ" ?
(
ÖÖ? @
Guid
ÖÖ@ D
applicationId
ÖÖE R
)
ÖÖR S
{
×× 	 
SqlParameterHelper
ØØ 
sph
ØØ "
=
ØØ# $
new
ØØ% ( 
SqlParameterHelper
ØØ) ;
(
ØØ; <
ConnectionString
ØØ< L
.
ØØL M%
GetReadConnectionString
ØØM d
(
ØØd e
)
ØØe f
,
ØØf g
$strØØh 
,ØØ 
$numØØ 
)ØØ 
;ØØ 
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# 3
,
ÙÙ3 4
	SqlDbType
ÙÙ5 >
.
ÙÙ> ?
UniqueIdentifier
ÙÙ? O
,
ÙÙO P 
ParameterDirection
ÙÙQ c
.
ÙÙc d
Input
ÙÙd i
,
ÙÙi j
applicationId
ÙÙk x
)
ÙÙx y
;
ÙÙy z
return
ÚÚ 
sph
ÚÚ 
.
ÚÚ 
ExecuteReader
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 	
public
ÝÝ 
static
ÝÝ 
IDataReader
ÝÝ !%
SchemaVersionGetNonCore
ÝÝ" 9
(
ÝÝ9 :
)
ÝÝ: ;
{
ÞÞ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M%
GetReadConnectionString
ßßM d
(
ßßd e
)
ßße f
,
ßßf g
$strßßh 
,ßß 
$numßß 
)ßß 
;ßß 
return
àà 
sph
àà 
.
àà 
ExecuteReader
àà $
(
àà$ %
)
àà% &
;
àà& '
}
áá 	
public
ãã 
static
ãã 
int
ãã 7
)SchemaScriptHistoryAddSchemaScriptHistory
ãã C
(
ããC D
Guid
ää 
applicationId
ää 
,
ää 
string
åå 

scriptFile
åå 
,
åå 
DateTime
ææ 
runTime
ææ 
,
ææ 
bool
çç 
errorOccurred
çç 
,
çç 
string
èè 
errorMessage
èè 
,
èè  
string
éé 

scriptBody
éé 
)
éé 
{
êê 	 
SqlParameterHelper
ìì 
sph
ìì "
=
ìì# $
new
ìì% ( 
SqlParameterHelper
ìì) ;
(
ìì; <
ConnectionString
ìì< L
.
ììL M&
GetWriteConnectionString
ììM e
(
ììe f
)
ììf g
,
ììg h
$strììi 
,ìì 
$numìì 
)ìì 
;ìì 
sph
íí 
.
íí  
DefineSqlParameter
íí "
(
íí" #
$str
íí# 3
,
íí3 4
	SqlDbType
íí5 >
.
íí> ?
UniqueIdentifier
íí? O
,
ííO P 
ParameterDirection
ííQ c
.
ííc d
Input
ííd i
,
ííi j
applicationId
íík x
)
ííx y
;
ííy z
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# 0
,
îî0 1
	SqlDbType
îî2 ;
.
îî; <
NVarChar
îî< D
,
îîD E
$num
îîF I
,
îîI J 
ParameterDirection
îîK ]
.
îî] ^
Input
îî^ c
,
îîc d

scriptFile
îîe o
)
îîo p
;
îîp q
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# -
,
ïï- .
	SqlDbType
ïï/ 8
.
ïï8 9
DateTime
ïï9 A
,
ïïA B 
ParameterDirection
ïïC U
.
ïïU V
Input
ïïV [
,
ïï[ \
runTime
ïï] d
)
ïïd e
;
ïïe f
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# 3
,
ðð3 4
	SqlDbType
ðð5 >
.
ðð> ?
Bit
ðð? B
,
ððB C 
ParameterDirection
ððD V
.
ððV W
Input
ððW \
,
ðð\ ]
errorOccurred
ðð^ k
)
ððk l
;
ððl m
sph
ññ 
.
ññ  
DefineSqlParameter
ññ "
(
ññ" #
$str
ññ# 2
,
ññ2 3
	SqlDbType
ññ4 =
.
ññ= >
NVarChar
ññ> F
,
ññF G
-
ññH I
$num
ññI J
,
ññJ K 
ParameterDirection
ññL ^
.
ññ^ _
Input
ññ_ d
,
ññd e
errorMessage
ññf r
)
ññr s
;
ññs t
sph
òò 
.
òò  
DefineSqlParameter
òò "
(
òò" #
$str
òò# 0
,
òò0 1
	SqlDbType
òò2 ;
.
òò; <
NVarChar
òò< D
,
òòD E
-
òòF G
$num
òòG H
,
òòH I 
ParameterDirection
òòJ \
.
òò\ ]
Input
òò] b
,
òòb c

scriptBody
òòd n
)
òòn o
;
òòo p
int
óó 
newID
óó 
=
óó 
Convert
óó 
.
óó  
ToInt32
óó  '
(
óó' (
sph
óó( +
.
óó+ ,
ExecuteScalar
óó, 9
(
óó9 :
)
óó: ;
)
óó; <
;
óó< =
return
ôô 
newID
ôô 
;
ôô 
}
õõ 	
public
÷÷ 
static
÷÷ 
bool
÷÷ :
,SchemaScriptHistoryDeleteSchemaScriptHistory
÷÷ G
(
÷÷G H
int
÷÷H K
id
÷÷L N
)
÷÷N O
{
øø 	 
SqlParameterHelper
ùù 
sph
ùù "
=
ùù# $
new
ùù% ( 
SqlParameterHelper
ùù) ;
(
ùù; <
ConnectionString
ùù< L
.
ùùL M&
GetWriteConnectionString
ùùM e
(
ùùe f
)
ùùf g
,
ùùg h
$strùùi 
,ùù 
$numùù 
)ùù 
;ùù 
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# (
,
úú( )
	SqlDbType
úú* 3
.
úú3 4
Int
úú4 7
,
úú7 8 
ParameterDirection
úú9 K
.
úúK L
Input
úúL Q
,
úúQ R
id
úúS U
)
úúU V
;
úúV W
int
ûû 
rowsAffected
ûû 
=
ûû 
sph
ûû "
.
ûû" #
ExecuteNonQuery
ûû# 2
(
ûû2 3
)
ûû3 4
;
ûû4 5
return
üü 
(
üü 
rowsAffected
üü  
>
üü! "
-
üü# $
$num
üü$ %
)
üü% &
;
üü& '
}
ýý 	
public
ÿÿ 
static
ÿÿ 
IDataReader
ÿÿ !7
)SchemaScriptHistoryGetSchemaScriptHistory
ÿÿ" K
(
ÿÿK L
int
ÿÿL O
id
ÿÿP R
)
ÿÿR S
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# (
,
( )
	SqlDbType
* 3
.
3 4
Int
4 7
,
7 8 
ParameterDirection
9 K
.
K L
Input
L Q
,
Q R
id
S U
)
U V
;
V W
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !7
)SchemaScriptHistoryGetSchemaScriptHistory
" K
(
K L
Guid
L P
applicationId
Q ^
)
^ _
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
UniqueIdentifier
? O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
applicationId
k x
)
x y
;
y z
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !<
.SchemaScriptHistoryGetSchemaScriptErrorHistory
" P
(
P Q
Guid
Q U
applicationId
V c
)
c d
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# (
,
( )
	SqlDbType
* 3
.
3 4
UniqueIdentifier
4 D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
applicationId
` m
)
m n
;
n o
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
 '
SchemaScriptHistoryExists
 4
(
4 5
Guid
5 9
applicationId
: G
,
G H
String
I O

scriptFile
P Z
)
Z [
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
UniqueIdentifier
? O
,
O P 
ParameterDirection
Q c
.
c d
Input
d i
,
i j
applicationId
k x
)
x y
;
y z
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
NVarChar
< D
,
D E
$num
F I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d

scriptFile
e o
)
o p
;
p q
int
 
count
 
=
 
Convert
 
.
  
ToInt32
  '
(
' (
sph
( +
.
+ ,
ExecuteScalar
, 9
(
9 :
)
: ;
)
; <
;
< =
return
 
(
 
count
 
>
 
$num
 
)
 
;
 
}
 	
public
¤¤ 
static
¤¤ 
	DataTable
¤¤ $
GetTableFromDataReader
¤¤  6
(
¤¤6 7
IDataReader
¤¤7 B
reader
¤¤C I
)
¤¤I J
{
¥¥ 	
	DataTable
¦¦ 
	dataTable
¦¦ 
=
¦¦  !
new
¦¦" %
	DataTable
¦¦& /
(
¦¦/ 0
)
¦¦0 1
;
¦¦1 2

DataColumn
§§ 
column
§§ 
;
§§ 
DataRow
¨¨ 
row
¨¨ 
;
¨¨ 
	ArrayList
©© 
	arrayList
©© 
=
©©  !
new
©©" %
	ArrayList
©©& /
(
©©/ 0
)
©©0 1
;
©©1 2
try
«« 
{
¬¬ 
	DataTable
­­ 
schemaTable
­­ %
=
­­& '
reader
­­( .
.
­­. /
GetSchemaTable
­­/ =
(
­­= >
)
­­> ?
;
­­? @
for
¯¯ 
(
¯¯ 
int
¯¯ 
i
¯¯ 
=
¯¯ 
$num
¯¯ 
;
¯¯ 
i
¯¯  !
<
¯¯" #
schemaTable
¯¯$ /
.
¯¯/ 0
Rows
¯¯0 4
.
¯¯4 5
Count
¯¯5 :
;
¯¯: ;
i
¯¯< =
++
¯¯= ?
)
¯¯? @
{
°° 
column
²² 
=
²² 
new
²²  

DataColumn
²²! +
(
²²+ ,
)
²², -
;
²²- .
if
´´ 
(
´´ 
!
´´ 
	dataTable
´´ "
.
´´" #
Columns
´´# *
.
´´* +
Contains
´´+ 3
(
´´3 4
schemaTable
´´4 ?
.
´´? @
Rows
´´@ D
[
´´D E
i
´´E F
]
´´F G
[
´´G H
$str
´´H T
]
´´T U
.
´´U V
ToString
´´V ^
(
´´^ _
)
´´_ `
)
´´` a
)
´´a b
{
µµ 
column
·· 
.
·· 

ColumnName
·· )
=
··* +
schemaTable
··, 7
.
··7 8
Rows
··8 <
[
··< =
i
··= >
]
··> ?
[
··? @
$str
··@ L
]
··L M
.
··M N
ToString
··N V
(
··V W
)
··W X
;
··X Y
column
ºº 
.
ºº 
AllowDBNull
ºº *
=
ºº+ ,
Convert
ºº- 4
.
ºº4 5
	ToBoolean
ºº5 >
(
ºº> ?
schemaTable
ºº? J
.
ººJ K
Rows
ººK O
[
ººO P
i
ººP Q
]
ººQ R
[
ººR S
$str
ººS `
]
ºº` a
)
ººa b
;
ººb c
column
»» 
.
»» 
ReadOnly
»» '
=
»»( )
Convert
»»* 1
.
»»1 2
	ToBoolean
»»2 ;
(
»»; <
schemaTable
»»< G
.
»»G H
Rows
»»H L
[
»»L M
i
»»M N
]
»»N O
[
»»O P
$str
»»P \
]
»»\ ]
)
»»] ^
;
»»^ _
	arrayList
¼¼ !
.
¼¼! "
Add
¼¼" %
(
¼¼% &
column
¼¼& ,
.
¼¼, -

ColumnName
¼¼- 7
)
¼¼7 8
;
¼¼8 9
	dataTable
½½ !
.
½½! "
Columns
½½" )
.
½½) *
Add
½½* -
(
½½- .
column
½½. 4
)
½½4 5
;
½½5 6
}
¿¿ 
}
ÁÁ 
while
ÃÃ 
(
ÃÃ 
reader
ÃÃ 
.
ÃÃ 
Read
ÃÃ "
(
ÃÃ" #
)
ÃÃ# $
)
ÃÃ$ %
{
ÄÄ 
row
ÆÆ 
=
ÆÆ 
	dataTable
ÆÆ #
.
ÆÆ# $
NewRow
ÆÆ$ *
(
ÆÆ* +
)
ÆÆ+ ,
;
ÆÆ, -
for
ÈÈ 
(
ÈÈ 
int
ÈÈ 
i
ÈÈ 
=
ÈÈ  
$num
ÈÈ! "
;
ÈÈ" #
i
ÈÈ$ %
<
ÈÈ& '
	arrayList
ÈÈ( 1
.
ÈÈ1 2
Count
ÈÈ2 7
;
ÈÈ7 8
i
ÈÈ9 :
++
ÈÈ: <
)
ÈÈ< =
{
ÉÉ 
row
ËË 
[
ËË 
(
ËË 
(
ËË 
System
ËË $
.
ËË$ %
String
ËË% +
)
ËË+ ,
	arrayList
ËË, 5
[
ËË5 6
i
ËË6 7
]
ËË7 8
)
ËË8 9
]
ËË9 :
=
ËË; <
reader
ËË= C
[
ËËC D
(
ËËD E
System
ËËE K
.
ËËK L
String
ËËL R
)
ËËR S
	arrayList
ËËS \
[
ËË\ ]
i
ËË] ^
]
ËË^ _
]
ËË_ `
;
ËË` a
}
ÍÍ 
	dataTable
ÏÏ 
.
ÏÏ 
Rows
ÏÏ "
.
ÏÏ" #
Add
ÏÏ# &
(
ÏÏ& '
row
ÏÏ' *
)
ÏÏ* +
;
ÏÏ+ ,
}
ÑÑ 
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
reader
ÖÖ 
.
ÖÖ 
Close
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
×× 
return
ÙÙ 
	dataTable
ÙÙ 
;
ÙÙ 
}
ÛÛ 	
public
ÝÝ 
static
ÝÝ 
bool
ÝÝ -
DatabaseHelperCanAccessDatabase
ÝÝ :
(
ÝÝ: ;
String
ÝÝ; A$
overrideConnectionInfo
ÝÝB X
)
ÝÝX Y
{
ÞÞ 	
bool
ää 
result
ää 
=
ää 
false
ää 
;
ää  
SqlConnection
ææ 

connection
ææ $
;
ææ$ %
if
èè 
(
èè 
(
éé $
overrideConnectionInfo
éé '
!=
éé( *
null
éé+ /
)
éé/ 0
&&
êê 
(
êê $
overrideConnectionInfo
êê *
.
êê* +
Length
êê+ 1
>
êê2 3
$num
êê4 5
)
êê5 6
)
ëë 
{
ìì 

connection
íí 
=
íí 
new
íí  
SqlConnection
íí! .
(
íí. /$
overrideConnectionInfo
íí/ E
)
ííE F
;
ííF G
}
îî 
else
ïï 
{
ðð 

connection
ññ 
=
ññ 
new
ññ  
SqlConnection
ññ! .
(
ññ. /
ConnectionString
ññ/ ?
.
ññ? @%
GetReadConnectionString
ññ@ W
(
ññW X
)
ññX Y
)
ññY Z
;
ññZ [
}
òò 
try
ôô 
{
õõ 

connection
öö 
.
öö 
Open
öö 
(
öö  
)
öö  !
;
öö! "
result
÷÷ 
=
÷÷ 
(
÷÷ 

connection
÷÷ $
.
÷÷$ %
State
÷÷% *
==
÷÷+ -
ConnectionState
÷÷. =
.
÷÷= >
Open
÷÷> B
)
÷÷B C
;
÷÷C D
}
ùù 
catch
úú 
{
úú 
}
úú 
finally
ûû 
{
üü 
if
ýý 
(
ýý 

connection
ýý 
.
ýý 
State
ýý $
==
ýý% '
ConnectionState
ýý( 7
.
ýý7 8
Open
ýý8 <
)
ýý< =

connection
þþ 
.
þþ 
Close
þþ $
(
þþ$ %
)
þþ% &
;
þþ& '
}
ÿÿ 
return
 
result
 
;
 
}
 	
public
 
static
 
DbException
 !.
 DatabaseHelperGetConnectionError
" B
(
B C
String
C I$
overrideConnectionInfo
J `
)
` a
{
 	
DbException
 
	exception
 !
=
" #
null
$ (
;
( )
SqlConnection
 

connection
 $
;
$ %
if
 
(
 
(
 $
overrideConnectionInfo
 '
!=
( *
null
+ /
)
/ 0
&&
 
(
 $
overrideConnectionInfo
 *
.
* +
Length
+ 1
>
2 3
$num
4 5
)
5 6
)
 
{
 

connection
 
=
 
new
  
SqlConnection
! .
(
. /$
overrideConnectionInfo
/ E
)
E F
;
F G
}
 
else
 
{
 

connection
 
=
 
new
  
SqlConnection
! .
(
. /
ConnectionString
/ ?
.
? @%
GetReadConnectionString
@ W
(
W X
)
X Y
)
Y Z
;
Z [
}
 
try
 
{
 

connection
 
.
 
Open
 
(
  
)
  !
;
! "
}
 
catch
 
(
 
DbException
 
ex
 !
)
! "
{
 
	exception
   
=
   
ex
   
;
   
}
¡¡ 
finally
¢¢ 
{
££ 
if
¤¤ 
(
¤¤ 

connection
¤¤ 
.
¤¤ 
State
¤¤ $
==
¤¤% '
ConnectionState
¤¤( 7
.
¤¤7 8
Open
¤¤8 <
)
¤¤< =

connection
¥¥ 
.
¥¥ 
Close
¥¥ $
(
¥¥$ %
)
¥¥% &
;
¥¥& '
}
¦¦ 
return
©© 
	exception
©© 
;
©© 
}
«« 	
public
­­ 
static
­­ 
bool
­­ -
DatabaseHelperCanAccessDatabase
­­ :
(
­­: ;
)
­­; <
{
®® 	
return
¯¯ -
DatabaseHelperCanAccessDatabase
¯¯ 2
(
¯¯2 3
null
¯¯3 7
)
¯¯7 8
;
¯¯8 9
}
°° 	
public
²² 
static
²² 
bool
²² *
DatabaseHelperCanAlterSchema
²² 7
(
²²7 8
string
²²8 >$
overrideConnectionInfo
²²? U
)
²²U V
{
³³ 	
bool
µµ 
result
µµ 
=
µµ 
true
µµ 
;
µµ 
StringBuilder
¸¸ 

sqlCommand
¸¸ $
=
¸¸% &
new
¸¸' *
StringBuilder
¸¸+ 8
(
¸¸8 9
)
¸¸9 :
;
¸¸: ;

sqlCommand
ÝÝ 
.
ÝÝ 
Append
ÝÝ 
(
ÝÝ 
$str
Þé 
)
éé 
;
éé 
try
ëë 
{
ìì %
DatabaseHelperRunScript
íí '
(
íí' (

sqlCommand
îî 
.
îî 
ToString
îî '
(
îî' (
)
îî( )
,
îî) *$
overrideConnectionInfo
ïï *
)
ïï* +
;
ïï+ ,
}
ðð 
catch
ññ 
(
ññ 
DbException
ññ 
)
ññ 
{
òò 
result
óó 
=
óó 
false
óó 
;
óó 
}
ôô 
catch
õõ 
(
õõ 
ArgumentException
õõ $
)
õõ$ %
{
öö 
result
÷÷ 
=
÷÷ 
false
÷÷ 
;
÷÷ 
}
øø 

sqlCommand
úú 
=
úú 
new
úú 
StringBuilder
úú *
(
úú* +
)
úú+ ,
;
úú, -

sqlCommand
ûû 
.
ûû 
Append
ûû 
(
ûû 
$str
üÿ 
)
ÿÿ 
;
ÿÿ 
try
 
{
 %
DatabaseHelperRunScript
 '
(
' (

sqlCommand
 
.
 
ToString
 '
(
' (
)
( )
,
) *$
overrideConnectionInfo
 *
)
* +
;
+ ,
}
 
catch
 
(
 
DbException
 
)
 
{
 
result
 
=
 
false
 
;
 
}
 
catch
 
(
 
ArgumentException
 $
)
$ %
{
 
result
 
=
 
false
 
;
 
}
 

sqlCommand
 
=
 
new
 
StringBuilder
 *
(
* +
)
+ ,
;
, -

sqlCommand
 
.
 
Append
 
(
 
$str
 
)
 
;
 
try
 
{
 %
DatabaseHelperRunScript
 '
(
' (

sqlCommand
( 2
.
2 3
ToString
3 ;
(
; <
)
< =
,
= >$
overrideConnectionInfo
? U
)
U V
;
V W
}
 
catch
 
(
 
DbException
 
)
 
{
 
result
 
=
 
false
 
;
 
}
 
catch
 
(
 
ArgumentException
 $
)
$ %
{
 
result
   
=
   
false
   
;
   
}
¡¡ 
return
©© 
result
©© 
;
©© 
}
«« 	
private
­­ 
static
­­ 
bool
­­ B
4DatabaseHelperCanAlterSchemaHackForMissingServicePak
­­ P
(
­­P Q
string
­­Q W$
overrideConnectionInfo
­­X n
)
­­n o
{
®® 	
bool
°° 
result
°° 
=
°° 
true
°° 
;
°° 
StringBuilder
³³ 

sqlCommand
³³ $
=
³³% &
new
³³' *
StringBuilder
³³+ 8
(
³³8 9
)
³³9 :
;
³³: ;

sqlCommand
´´ 
.
´´ 
Append
´´ 
(
´´ 
$str
µÅ 
)
ÅÅ 
;
ÅÅ 
try
ÈÈ 
{
ÉÉ %
DatabaseHelperRunScript
ÊÊ '
(
ÊÊ' (

sqlCommand
ËË 
.
ËË 
ToString
ËË '
(
ËË' (
)
ËË( )
,
ËË) *$
overrideConnectionInfo
ÌÌ *
)
ÌÌ* +
;
ÌÌ+ ,
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
DbException
ÎÎ 
)
ÎÎ 
{
ÏÏ 
result
ÐÐ 
=
ÐÐ 
false
ÐÐ 
;
ÐÐ 
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
ArgumentException
ÒÒ $
)
ÒÒ$ %
{
ÓÓ 
result
ÔÔ 
=
ÔÔ 
false
ÔÔ 
;
ÔÔ 
}
ÕÕ 

sqlCommand
×× 
=
×× 
new
×× 
StringBuilder
×× *
(
××* +
)
××+ ,
;
××, -

sqlCommand
ØØ 
.
ØØ 
Append
ØØ 
(
ØØ 
$str
ÙÜ 
)
ÜÜ 
;
ÜÜ 
try
ÞÞ 
{
ßß %
DatabaseHelperRunScript
àà '
(
àà' (

sqlCommand
áá 
.
áá 
ToString
áá '
(
áá' (
)
áá( )
,
áá) *$
overrideConnectionInfo
ââ *
)
ââ* +
;
ââ+ ,
}
ãã 
catch
ää 
(
ää 
DbException
ää 
)
ää 
{
åå 
result
ææ 
=
ææ 
false
ææ 
;
ææ 
}
çç 
catch
èè 
(
èè 
ArgumentException
èè $
)
èè$ %
{
éé 
result
êê 
=
êê 
false
êê 
;
êê 
}
ëë 

sqlCommand
íí 
=
íí 
new
íí 
StringBuilder
íí *
(
íí* +
)
íí+ ,
;
íí, -

sqlCommand
îî 
.
îî 
Append
îî 
(
îî 
$str
ïñ 
)
ññ 
;
ññ 
try
óó 
{
ôô %
DatabaseHelperRunScript
õõ '
(
õõ' (

sqlCommand
õõ( 2
.
õõ2 3
ToString
õõ3 ;
(
õõ; <
)
õõ< =
,
õõ= >$
overrideConnectionInfo
õõ? U
)
õõU V
;
õõV W
}
öö 
catch
÷÷ 
(
÷÷ 
DbException
÷÷ 
)
÷÷ 
{
øø 
result
ùù 
=
ùù 
false
ùù 
;
ùù 
}
úú 
catch
ûû 
(
ûû 
ArgumentException
ûû $
)
ûû$ %
{
üü 
result
ýý 
=
ýý 
false
ýý 
;
ýý 
}
þþ 
return
 
result
 
;
 
}
 	
public
 
static
 
bool
 4
&DatabaseHelperCanCreateTemporaryTables
 A
(
A B
)
B C
{
 	
bool
 
result
 
=
 
false
 
;
  
StringBuilder
 

sqlCommand
 $
=
% &
new
' *
StringBuilder
+ 8
(
8 9
)
9 :
;
: ;

sqlCommand
 
.
 
Append
 
(
 
$str
 
)
 
;
 
try
 
{
 %
DatabaseHelperRunScript
 '
(
' (

sqlCommand
( 2
.
2 3
ToString
3 ;
(
; <
)
< =
,
= >
ConnectionString
? O
.
O P&
GetWriteConnectionString
P h
(
h i
)
i j
)
j k
;
k l
result
 
=
 
true
 
;
 
}
 
catch
   
{
¡¡ 
result
¢¢ 
=
¢¢ 
false
¢¢ 
;
¢¢ 
}
££ 
return
¦¦ 
result
¦¦ 
;
¦¦ 
}
¨¨ 	
public
ªª 
static
ªª 
bool
ªª %
DatabaseHelperRunScript
ªª 2
(
ªª2 3
FileInfo
«« 

scriptFile
«« 
,
««  
String
¬¬ $
overrideConnectionInfo
¬¬ )
)
¬¬) *
{
­­ 	
if
®® 
(
®® 

scriptFile
®® 
==
®® 
null
®® "
)
®®" #
return
®®$ *
false
®®+ 0
;
®®0 1
string
°° 
script
°° 
=
°° 
File
°°  
.
°°  !
ReadAllText
°°! ,
(
°°, -

scriptFile
°°- 7
.
°°7 8
FullName
°°8 @
)
°°@ A
;
°°A B
if
²² 
(
²² 
(
²² 
script
²² 
==
²² 
null
²² 
)
²²  
||
²²! #
(
²²$ %
script
²²% +
.
²²+ ,
Length
²², 2
==
²²3 5
$num
²²6 7
)
²²7 8
)
²²8 9
return
²²: @
true
²²A E
;
²²E F
return
´´ %
DatabaseHelperRunScript
´´ *
(
´´* +
script
´´+ 1
,
´´1 2$
overrideConnectionInfo
´´3 I
)
´´I J
;
´´J K
}
¶¶ 	
public
¹¹ 
static
¹¹ 
bool
¹¹ %
DatabaseHelperRunScript
¹¹ 2
(
¹¹2 3
string
¹¹3 9
script
¹¹: @
,
¹¹@ A
string
¹¹B H$
overrideConnectionInfo
¹¹I _
)
¹¹_ `
{
ºº 	
if
»» 
(
»» 
(
»» 
script
»» 
==
»» 
null
»» 
)
»»  
||
»»! #
(
»»$ %
script
»»% +
.
»»+ ,
Length
»», 2
==
»»3 5
$num
»»6 7
)
»»7 8
)
»»8 9
return
»»: @
true
»»A E
;
»»E F
string
½½ 
ownerPrefix
½½ 
=
½½  
GetdbOwnerPrefix
½½! 1
(
½½1 2
)
½½2 3
;
½½3 4
if
¾¾ 
(
¾¾ 
ownerPrefix
¾¾ 
!=
¾¾ 
$str
¾¾ '
)
¾¾' (
{
¿¿ 
script
ÀÀ 
=
ÀÀ 
script
ÀÀ 
.
ÀÀ  
Replace
ÀÀ  '
(
ÀÀ' (
$str
ÀÀ( 0
,
ÀÀ0 1
ownerPrefix
ÀÀ2 =
)
ÀÀ= >
;
ÀÀ> ?
}
ÁÁ 
bool
ÃÃ 
result
ÃÃ 
=
ÃÃ 
false
ÃÃ 
;
ÃÃ  
SqlConnection
ÄÄ 

connection
ÄÄ $
;
ÄÄ$ %
if
ÆÆ 
(
ÆÆ 
(
ÇÇ $
overrideConnectionInfo
ÇÇ '
!=
ÇÇ( *
null
ÇÇ+ /
)
ÇÇ/ 0
&&
ÈÈ 
(
ÈÈ $
overrideConnectionInfo
ÈÈ *
.
ÈÈ* +
Length
ÈÈ+ 1
>
ÈÈ2 3
$num
ÈÈ4 5
)
ÈÈ5 6
)
ÉÉ 
{
ÊÊ 

connection
ËË 
=
ËË 
new
ËË  
SqlConnection
ËË! .
(
ËË. /$
overrideConnectionInfo
ËË/ E
)
ËËE F
;
ËËF G
}
ÌÌ 
else
ÍÍ 
{
ÎÎ 

connection
ÏÏ 
=
ÏÏ 
new
ÏÏ  
SqlConnection
ÏÏ! .
(
ÏÏ. /
ConnectionString
ÏÏ/ ?
.
ÏÏ? @&
GetWriteConnectionString
ÏÏ@ X
(
ÏÏX Y
)
ÏÏY Z
)
ÏÏZ [
;
ÏÏ[ \
}
ÐÐ 
string
ÒÒ 
[
ÒÒ 
]
ÒÒ 
	delimiter
ÒÒ 
=
ÒÒ  
new
ÒÒ! $
string
ÒÒ% +
[
ÒÒ+ ,
]
ÒÒ, -
{
ÒÒ. /
$str
ÒÒ0 8
}
ÒÒ9 :
;
ÒÒ: ;
script
ÔÔ 
=
ÔÔ 
script
ÔÔ 
.
ÔÔ 
Replace
ÔÔ #
(
ÔÔ# $
$str
ÔÔ$ (
,
ÔÔ( )
$str
ÔÔ* 2
)
ÔÔ2 3
;
ÔÔ3 4
string
ÖÖ 
[
ÖÖ 
]
ÖÖ 
arrSqlStatements
ÖÖ %
=
ÖÖ& '
script
ÖÖ( .
.
ÖÖ. /
Split
ÖÖ/ 4
(
ÖÖ4 5
	delimiter
ÖÖ5 >
,
ÖÖ> ? 
StringSplitOptions
ÖÖ@ R
.
ÖÖR S 
RemoveEmptyEntries
ÖÖS e
)
ÖÖe f
;
ÖÖf g

connection
ØØ 
.
ØØ 
Open
ØØ 
(
ØØ 
)
ØØ 
;
ØØ 
SqlTransaction
ÚÚ 
transaction
ÚÚ &
=
ÚÚ' (

connection
ÚÚ) 3
.
ÚÚ3 4
BeginTransaction
ÚÚ4 D
(
ÚÚD E
)
ÚÚE F
;
ÚÚF G
string
ÛÛ 
currentStatement
ÛÛ #
=
ÛÛ$ %
string
ÛÛ& ,
.
ÛÛ, -
Empty
ÛÛ- 2
;
ÛÛ2 3
try
ÝÝ 
{
ÞÞ 
foreach
ßß 
(
ßß 
String
ßß 
sqlStatement
ßß  ,
in
ßß- /
arrSqlStatements
ßß0 @
)
ßß@ A
{
àà 
if
áá 
(
áá 
sqlStatement
áá $
.
áá$ %
Trim
áá% )
(
áá) *
)
áá* +
.
áá+ ,
Length
áá, 2
>
áá3 4
$num
áá5 6
)
áá6 7
{
ââ 
currentStatement
ãã (
=
ãã) *
sqlStatement
ãã+ 7
;
ãã7 8
	SqlHelper
ää !
.
ää! "
ExecuteNonQuery
ää" 1
(
ää1 2
transaction
åå '
,
åå' (
CommandType
ææ '
.
ææ' (
Text
ææ( ,
,
ææ, -
sqlStatement
çç (
,
çç( )
null
èè  
)
èè  !
;
èè! "
}
êê 
}
ëë 
transaction
îî 
.
îî 
Commit
îî "
(
îî" #
)
îî# $
;
îî$ %
result
ïï 
=
ïï 
true
ïï 
;
ïï 
}
ññ 
catch
òò 
(
òò 
SqlException
òò 
ex
òò  "
)
òò" #
{
óó 
transaction
ôô 
.
ôô 
Rollback
ôô $
(
ôô$ %
)
ôô% &
;
ôô& '
log
õõ 
.
õõ 
Error
õõ 
(
õõ 
$str
õõ 5
,
õõ5 6
ex
õõ7 9
)
õõ9 :
;
õõ: ;
log
öö 
.
öö 
Info
öö 
(
öö 
$str
öö 5
+
öö6 7
currentStatement
öö8 H
)
ööH I
;
ööI J
throw
÷÷ 
;
÷÷ 
}
øø 
finally
ùù 
{
úú 

connection
ûû 
.
ûû 
Close
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
}
ýý 
return
ÿÿ 
result
ÿÿ 
;
ÿÿ 
}
 	
public
§§ 
static
§§ 
bool
§§ ,
DatabaseHelperUpdateTableField
§§ 9
(
§§9 :
String
¨¨ 
connectionString
¨¨ #
,
¨¨# $
String
©© 
	tableName
©© 
,
©© 
String
ªª 
keyFieldName
ªª 
,
ªª  
String
«« 
keyFieldValue
««  
,
««  !
String
¬¬ 
dataFieldName
¬¬  
,
¬¬  !
String
­­ 
dataFieldValue
­­ !
,
­­! "
String
®® 
additionalWhere
®® "
)
®®" #
{
¯¯ 	
bool
°° 
result
°° 
=
°° 
false
°° 
;
°°  
StringBuilder
²² 

sqlCommand
²² $
=
²²% &
new
²²' *
StringBuilder
²²+ 8
(
²²8 9
)
²²9 :
;
²²: ;

sqlCommand
³³ 
.
³³ 
Append
³³ 
(
³³ 
$str
³³ '
+
³³( )
	tableName
³³* 3
+
³³4 5
$str
³³6 9
)
³³9 :
;
³³: ;

sqlCommand
´´ 
.
´´ 
Append
´´ 
(
´´ 
$str
´´ %
+
´´& '
dataFieldName
´´( 5
+
´´6 7
$str
´´8 I
)
´´I J
;
´´J K

sqlCommand
µµ 
.
µµ 
Append
µµ 
(
µµ 
$str
µµ '
+
µµ( )
keyFieldName
µµ* 6
+
µµ7 8
$str
µµ9 >
+
µµ? @
keyFieldValue
µµA N
)
µµN O
;
µµO P

sqlCommand
¶¶ 
.
¶¶ 
Append
¶¶ 
(
¶¶ 
$str
¶¶ !
+
¶¶" #
additionalWhere
¶¶$ 3
+
¶¶4 5
$str
¶¶6 9
)
¶¶9 :
;
¶¶: ;

sqlCommand
·· 
.
·· 
Append
·· 
(
·· 
$str
·· "
)
··" #
;
··# $
SqlParameter
¹¹ 
[
¹¹ 
]
¹¹ 
arParams
¹¹ #
=
¹¹$ %
new
¹¹& )
SqlParameter
¹¹* 6
[
¹¹6 7
$num
¹¹7 8
]
¹¹8 9
;
¹¹9 :
arParams
»» 
[
»» 
$num
»» 
]
»» 
=
»» 
new
»» 
SqlParameter
»» *
(
»»* +
$str
»»+ 8
,
»»8 9
	SqlDbType
»»: C
.
»»C D
Text
»»D H
)
»»H I
;
»»I J
arParams
¼¼ 
[
¼¼ 
$num
¼¼ 
]
¼¼ 
.
¼¼ 
	Direction
¼¼ !
=
¼¼" # 
ParameterDirection
¼¼$ 6
.
¼¼6 7
Input
¼¼7 <
;
¼¼< =
arParams
½½ 
[
½½ 
$num
½½ 
]
½½ 
.
½½ 
Value
½½ 
=
½½ 
dataFieldValue
½½  .
;
½½. /
int
ÃÃ 
rowsAffected
ÃÃ  
=
ÃÃ! "
	SqlHelper
ÃÃ# ,
.
ÃÃ, -
ExecuteNonQuery
ÃÃ- <
(
ÃÃ< =
connectionString
ÄÄ $
,
ÄÄ$ %
CommandType
ÅÅ 
.
ÅÅ  
Text
ÅÅ  $
,
ÅÅ$ %

sqlCommand
ÆÆ 
.
ÆÆ 
ToString
ÆÆ '
(
ÆÆ' (
)
ÆÆ( )
,
ÆÆ) *
arParams
ÆÆ+ 3
)
ÆÆ3 4
;
ÆÆ4 5
result
ÈÈ 
=
ÈÈ 
(
ÈÈ 
rowsAffected
ÈÈ &
>
ÈÈ' (
$num
ÈÈ) *
)
ÈÈ* +
;
ÈÈ+ ,
return
ÐÐ 
result
ÐÐ 
;
ÐÐ 
}
ÒÒ 	
public
êê 
static
êê 
bool
êê ,
DatabaseHelperUpdateTableField
êê 9
(
êê9 :
String
ëë 
	tableName
ëë 
,
ëë 
String
ìì 
keyFieldName
ìì 
,
ìì  
String
íí 
keyFieldValue
íí  
,
íí  !
String
îî 
dataFieldName
îî  
,
îî  !
String
ïï 
dataFieldValue
ïï !
,
ïï! "
String
ðð 
additionalWhere
ðð "
)
ðð" #
{
ññ 	
bool
òò 
result
òò 
=
òò 
false
òò 
;
òò  
StringBuilder
ôô 

sqlCommand
ôô $
=
ôô% &
new
ôô' *
StringBuilder
ôô+ 8
(
ôô8 9
)
ôô9 :
;
ôô: ;

sqlCommand
õõ 
.
õõ 
Append
õõ 
(
õõ 
$str
õõ '
+
õõ( )
	tableName
õõ* 3
+
õõ4 5
$str
õõ6 9
)
õõ9 :
;
õõ: ;

sqlCommand
öö 
.
öö 
Append
öö 
(
öö 
$str
öö %
+
öö& '
dataFieldName
öö( 5
+
öö6 7
$str
öö8 I
)
ööI J
;
ööJ K

sqlCommand
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
$str
÷÷ '
+
÷÷( )
keyFieldName
÷÷* 6
+
÷÷7 8
$str
÷÷9 >
+
÷÷? @
keyFieldValue
÷÷A N
)
÷÷N O
;
÷÷O P

sqlCommand
øø 
.
øø 
Append
øø 
(
øø 
$str
øø !
+
øø" #
additionalWhere
øø$ 3
+
øø4 5
$str
øø6 9
)
øø9 :
;
øø: ;

sqlCommand
ùù 
.
ùù 
Append
ùù 
(
ùù 
$str
ùù "
)
ùù" #
;
ùù# $
SqlParameter
ûû 
[
ûû 
]
ûû 
arParams
ûû #
=
ûû$ %
new
ûû& )
SqlParameter
ûû* 6
[
ûû6 7
$num
ûû7 8
]
ûû8 9
;
ûû9 :
arParams
ýý 
[
ýý 
$num
ýý 
]
ýý 
=
ýý 
new
ýý 
SqlParameter
ýý *
(
ýý* +
$str
ýý+ 8
,
ýý8 9
	SqlDbType
ýý: C
.
ýýC D
Text
ýýD H
)
ýýH I
;
ýýI J
arParams
þþ 
[
þþ 
$num
þþ 
]
þþ 
.
þþ 
	Direction
þþ !
=
þþ" # 
ParameterDirection
þþ$ 6
.
þþ6 7
Input
þþ7 <
;
þþ< =
arParams
ÿÿ 
[
ÿÿ 
$num
ÿÿ 
]
ÿÿ 
.
ÿÿ 
Value
ÿÿ 
=
ÿÿ 
dataFieldValue
ÿÿ  .
;
ÿÿ. /
int
 
rowsAffected
  
=
! "
	SqlHelper
# ,
.
, -
ExecuteNonQuery
- <
(
< =
ConnectionString
 $
.
$ %&
GetWriteConnectionString
% =
(
= >
)
> ?
,
? @
CommandType
 
.
  
Text
  $
,
$ %

sqlCommand
 
.
 
ToString
 '
(
' (
)
( )
,
) *
arParams
+ 3
)
3 4
;
4 5
result
 
=
 
(
 
rowsAffected
 &
>
' (
$num
) *
)
* +
;
+ ,
return
 
result
 
;
 
}
 	
public
µµ 
static
µµ 
IDataReader
µµ !%
DatabaseHelperGetReader
µµ" 9
(
µµ9 :
String
¶¶ 
connectionString
¶¶ #
,
¶¶# $
String
·· 
	tableName
·· 
,
·· 
String
¸¸ 
whereClause
¸¸ 
)
¸¸ 
{
¹¹ 	
StringBuilder
ºº 

sqlCommand
ºº $
=
ºº% &
new
ºº' *
StringBuilder
ºº+ 8
(
ºº8 9
)
ºº9 :
;
ºº: ;

sqlCommand
»» 
.
»» 
Append
»» 
(
»» 
$str
»» )
)
»») *
;
»»* +

sqlCommand
¼¼ 
.
¼¼ 
Append
¼¼ 
(
¼¼ 
$str
¼¼ %
+
¼¼& '
	tableName
¼¼( 1
+
¼¼2 3
$str
¼¼4 7
)
¼¼7 8
;
¼¼8 9

sqlCommand
½½ 
.
½½ 
Append
½½ 
(
½½ 
whereClause
½½ )
)
½½) *
;
½½* +

sqlCommand
¾¾ 
.
¾¾ 
Append
¾¾ 
(
¾¾ 
$str
¾¾ "
)
¾¾" #
;
¾¾# $
return
ÀÀ 
	SqlHelper
ÀÀ 
.
ÀÀ 
ExecuteReader
ÀÀ *
(
ÀÀ* +
connectionString
ÁÁ  
,
ÁÁ  !
CommandType
ÂÂ 
.
ÂÂ 
Text
ÂÂ  
,
ÂÂ  !

sqlCommand
ÃÃ 
.
ÃÃ 
ToString
ÃÃ #
(
ÃÃ# $
)
ÃÃ$ %
)
ÃÃ% &
;
ÃÃ& '
}
ÅÅ 	
public
ÇÇ 
static
ÇÇ 
IDataReader
ÇÇ !%
DatabaseHelperGetReader
ÇÇ" 9
(
ÇÇ9 :
string
ÈÈ 
connectionString
ÈÈ #
,
ÈÈ# $
string
ÉÉ 
query
ÉÉ 
)
ÊÊ 
{
ËË 	
if
ÌÌ 
(
ÌÌ 
string
ÌÌ 
.
ÌÌ 
IsNullOrEmpty
ÌÌ $
(
ÌÌ$ %
connectionString
ÌÌ% 5
)
ÌÌ5 6
)
ÌÌ6 7
{
ÌÌ8 9
connectionString
ÌÌ: J
=
ÌÌK L
ConnectionString
ÌÌM ]
.
ÌÌ] ^%
GetReadConnectionString
ÌÌ^ u
(
ÌÌu v
)
ÌÌv w
;
ÌÌw x
}
ÌÌy z
return
ÎÎ 
	SqlHelper
ÎÎ 
.
ÎÎ 
ExecuteReader
ÎÎ *
(
ÎÎ* +
connectionString
ÏÏ  
,
ÏÏ  !
CommandType
ÐÐ 
.
ÐÐ 
Text
ÐÐ  
,
ÐÐ  !
query
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÓÓ 	
public
ÕÕ 
static
ÕÕ 
int
ÕÕ *
DatabaseHelperExecteNonQuery
ÕÕ 6
(
ÕÕ6 7
string
ÖÖ 
connectionString
ÖÖ #
,
ÖÖ# $
string
×× 
query
×× 
)
ØØ 
{
ÙÙ 	
if
ÚÚ 
(
ÚÚ 
string
ÚÚ 
.
ÚÚ 
IsNullOrEmpty
ÚÚ $
(
ÚÚ$ %
connectionString
ÚÚ% 5
)
ÚÚ5 6
)
ÚÚ6 7
{
ÚÚ8 9
connectionString
ÚÚ: J
=
ÚÚK L
ConnectionString
ÚÚM ]
.
ÚÚ] ^&
GetWriteConnectionString
ÚÚ^ v
(
ÚÚv w
)
ÚÚw x
;
ÚÚx y
}
ÚÚz {
int
ÜÜ 
rowsAffected
ÜÜ 
=
ÜÜ 
	SqlHelper
ÜÜ  )
.
ÜÜ) *
ExecuteNonQuery
ÜÜ* 9
(
ÜÜ9 :
connectionString
ÝÝ  
,
ÝÝ  !
CommandType
ÞÞ 
.
ÞÞ 
Text
ÞÞ  
,
ÞÞ  !
query
ßß 
)
ßß 
;
ßß 
return
áá 
rowsAffected
áá 
;
áá  
}
ãã 	
public
åå 
static
åå 
	DataTable
åå $
DatabaseHelperGetTable
åå  6
(
åå6 7
String
ææ 
connectionString
ææ #
,
ææ# $
String
çç 
	tableName
çç 
,
çç 
String
èè 
whereClause
èè 
)
èè 
{
éé 	
StringBuilder
êê 

sqlCommand
êê $
=
êê% &
new
êê' *
StringBuilder
êê+ 8
(
êê8 9
)
êê9 :
;
êê: ;

sqlCommand
ëë 
.
ëë 
Append
ëë 
(
ëë 
$str
ëë )
)
ëë) *
;
ëë* +

sqlCommand
ìì 
.
ìì 
Append
ìì 
(
ìì 
$str
ìì %
+
ìì& '
	tableName
ìì( 1
+
ìì2 3
$str
ìì4 7
)
ìì7 8
;
ìì8 9

sqlCommand
íí 
.
íí 
Append
íí 
(
íí 
whereClause
íí )
)
íí) *
;
íí* +

sqlCommand
îî 
.
îî 
Append
îî 
(
îî 
$str
îî "
)
îî" #
;
îî# $
DataSet
ðð 
ds
ðð 
=
ðð 
	SqlHelper
ðð "
.
ðð" #
ExecuteDataset
ðð# 1
(
ðð1 2
connectionString
ññ  
,
ññ  !
CommandType
òò 
.
òò 
Text
òò  
,
òò  !

sqlCommand
óó 
.
óó 
ToString
óó #
(
óó# $
)
óó$ %
)
óó% &
;
óó& '
return
õõ 
ds
õõ 
.
õõ 
Tables
õõ 
[
õõ 
$num
õõ 
]
õõ 
;
õõ  
}
÷÷ 	
public
ùù 
static
ùù 
void
ùù >
0DatabaseHelperDoForumVersion2202PostUpgradeTasks
ùù K
(
ùùK L
String
úú $
overrideConnectionInfo
úú )
)
úú) *
{
ûû 	
}
þþ 	
public
 
static
 
void
 >
0DatabaseHelperDoForumVersion2203PostUpgradeTasks
 K
(
K L
String
 $
overrideConnectionInfo
 )
)
) *
{
 	
}
 	
public
 
static
 
void
 9
+DatabaseHelperDoVersion2320PostUpgradeTasks
 F
(
F G
String
 $
overrideConnectionInfo
 )
)
) *
{
 	
}
 	
public
 
static
 
void
 9
+DatabaseHelperDoVersion2230PostUpgradeTasks
 F
(
F G
String
G M$
overrideConnectionInfo
N d
)
d e
{
 	
}
 	
public
 
static
 
void
 9
+DatabaseHelperDoVersion2234PostUpgradeTasks
 F
(
F G
String
G M$
overrideConnectionInfo
N d
)
d e
{
 	
}
 	
public
 
static
 
void
 9
+DatabaseHelperDoVersion2247PostUpgradeTasks
 F
(
F G
String
G M$
overrideConnectionInfo
N d
)
d e
{
 	
}
 	
public
 
static
 
void
 9
+DatabaseHelperDoVersion2253PostUpgradeTasks
 F
(
F G
String
 $
overrideConnectionInfo
 )
)
) *
{
 	
}
 	
public
¡¡ 
static
¡¡ 
bool
¡¡ ,
DatabaseHelperSitesTableExists
¡¡ 9
(
¡¡9 :
)
¡¡: ;
{
¢¢ 	
return
££ '
DatabaseHelperTableExists
££ ,
(
££, -
$str
££- 7
)
££7 8
;
££8 9
}
¤¤ 	
public
¦¦ 
static
¦¦ 
bool
¦¦ '
DatabaseHelperTableExists
¦¦ 4
(
¦¦4 5
string
¦¦5 ;
	tableName
¦¦< E
)
¦¦E F
{
§§ 	
using
ªª 
(
ªª 
SqlConnection
ªª  

connection
ªª! +
=
ªª, -
new
ªª. 1
SqlConnection
ªª2 ?
(
ªª? @
ConnectionString
ªª@ P
.
ªªP Q%
GetReadConnectionString
ªªQ h
(
ªªh i
)
ªªi j
)
ªªj k
)
ªªk l
{
«« 
string
¬¬ 
[
¬¬ 
]
¬¬ 
restrictions
¬¬ %
=
¬¬& '
new
¬¬( +
string
¬¬, 2
[
¬¬2 3
$num
¬¬3 4
]
¬¬4 5
;
¬¬5 6
restrictions
­­ 
[
­­ 
$num
­­ 
]
­­ 
=
­­  !
	tableName
­­" +
;
­­+ ,

connection
®® 
.
®® 
Open
®® 
(
®®  
)
®®  !
;
®®! "
	DataTable
¯¯ 
table
¯¯ 
=
¯¯  !

connection
¯¯" ,
.
¯¯, -
	GetSchema
¯¯- 6
(
¯¯6 7
$str
¯¯7 ?
,
¯¯? @
restrictions
¯¯A M
)
¯¯M N
;
¯¯N O
if
°° 
(
°° 
table
°° 
!=
°° 
null
°° !
)
°°! "
{
±± 
return
²² 
(
²² 
table
²² !
.
²²! "
Rows
²²" &
.
²²& '
Count
²²' ,
>
²²- .
$num
²²/ 0
)
²²0 1
;
²²1 2
}
³³ 
}
´´ 
return
¶¶ 
false
¶¶ 
;
¶¶ 
}
·· 	
}
¸	¸	 
}¹	¹	 Õ
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBRedirectList.cs
	namespace

 	

mojoPortal


 
.

 
Data

 
{ 
public 

static 
class 
DBRedirectList &
{ 
public'' 
static'' 
int'' 
Create''  
(''  !
Guid(( 
rowGuid(( 
,(( 
Guid)) 
siteGuid)) 
,)) 
int** 
siteID** 
,** 
string++ 
oldUrl++ 
,++ 
string,, 
newUrl,, 
,,, 
DateTime-- 

createdUtc-- 
,--  
DateTime.. 
	expireUtc.. 
).. 
{// 	
SqlParameterHelper00 
sph00 "
=00# $
new00% (
SqlParameterHelper00) ;
(00; <
ConnectionString00< L
.00L M$
GetWriteConnectionString00M e
(00e f
)00f g
,00g h
$str	00i 
,
00 
$num
00 
)
00 
;
00 
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# -
,11- .
	SqlDbType11/ 8
.118 9
UniqueIdentifier119 I
,11I J
ParameterDirection11K ]
.11] ^
Input11^ c
,11c d
rowGuid11e l
)11l m
;11m n
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
UniqueIdentifier22: J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
siteGuid22f n
)22n o
;22o p
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# ,
,33, -
	SqlDbType33. 7
.337 8
Int338 ;
,33; <
ParameterDirection33= O
.33O P
Input33P U
,33U V
siteID33W ]
)33] ^
;33^ _
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# ,
,44, -
	SqlDbType44. 7
.447 8
NVarChar448 @
,44@ A
$num44B E
,44E F
ParameterDirection44G Y
.44Y Z
Input44Z _
,44_ `
oldUrl44a g
)44g h
;44h i
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# ,
,55, -
	SqlDbType55. 7
.557 8
NVarChar558 @
,55@ A
$num55B E
,55E F
ParameterDirection55G Y
.55Y Z
Input55Z _
,55_ `
newUrl55a g
)55g h
;55h i
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
DateTime66< D
,66D E
ParameterDirection66F X
.66X Y
Input66Y ^
,66^ _

createdUtc66` j
)66j k
;66k l
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# /
,77/ 0
	SqlDbType771 :
.77: ;
DateTime77; C
,77C D
ParameterDirection77E W
.77W X
Input77X ]
,77] ^
	expireUtc77_ h
)77h i
;77i j
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
rowsAffected99 
;99  
};; 	
publicEE 
staticEE 
boolEE 
UpdateEE !
(EE! "
GuidFF 
rowGuidFF 
,FF 
stringGG 
oldUrlGG 
,GG 
stringHH 
newUrlHH 
,HH 
DateTimeII 
	expireUtcII 
)II 
{JJ 	
SqlParameterHelperKK 
sphKK "
=KK# $
newKK% (
SqlParameterHelperKK) ;
(KK; <
ConnectionStringKK< L
.KKL M$
GetWriteConnectionStringKKM e
(KKe f
)KKf g
,KKg h
$str	KKi 
,
KK 
$num
KK 
)
KK 
;
KK 
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# -
,LL- .
	SqlDbTypeLL/ 8
.LL8 9
UniqueIdentifierLL9 I
,LLI J
ParameterDirectionLLK ]
.LL] ^
InputLL^ c
,LLc d
rowGuidLLe l
)LLl m
;LLm n
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# ,
,MM, -
	SqlDbTypeMM. 7
.MM7 8
NVarCharMM8 @
,MM@ A
$numMMB E
,MME F
ParameterDirectionMMG Y
.MMY Z
InputMMZ _
,MM_ `
oldUrlMMa g
)MMg h
;MMh i
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# ,
,NN, -
	SqlDbTypeNN. 7
.NN7 8
NVarCharNN8 @
,NN@ A
$numNNB E
,NNE F
ParameterDirectionNNG Y
.NNY Z
InputNNZ _
,NN_ `
newUrlNNa g
)NNg h
;NNh i
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# /
,OO/ 0
	SqlDbTypeOO1 :
.OO: ;
DateTimeOO; C
,OOC D
ParameterDirectionOOE W
.OOW X
InputOOX ]
,OO] ^
	expireUtcOO_ h
)OOh i
;OOi j
intPP 
rowsAffectedPP 
=PP 
sphPP "
.PP" #
ExecuteNonQueryPP# 2
(PP2 3
)PP3 4
;PP4 5
returnQQ 
(QQ 
rowsAffectedQQ  
>QQ! "
$numQQ# $
)QQ$ %
;QQ% &
}SS 	
public\\ 
static\\ 
bool\\ 
Delete\\ !
(\\! "
Guid\\" &
rowGuid\\' .
)\\. /
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M$
GetWriteConnectionString^^M e
(^^e f
)^^f g
,^^g h
$str	^^i 
,
^^ 
$num
^^ 
)
^^ 
;
^^ 
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# -
,__- .
	SqlDbType__/ 8
.__8 9
UniqueIdentifier__9 I
,__I J
ParameterDirection__K ]
.__] ^
Input__^ c
,__c d
rowGuid__e l
)__l m
;__m n
int`` 
rowsAffected`` 
=`` 
sph`` "
.``" #
ExecuteNonQuery``# 2
(``2 3
)``3 4
;``4 5
returnaa 
(aa 
rowsAffectedaa  
>aa! "
$numaa# $
)aa$ %
;aa% &
}cc 	
publicii 
staticii 
IDataReaderii !
GetOneii" (
(ii( )
Guidii* .
rowGuidii/ 6
)ii6 7
{jj 	
SqlParameterHelperkk 
sphkk "
=kk# $
newkk% (
SqlParameterHelperkk) ;
(kk; <
ConnectionStringkk< L
.kkL M#
GetReadConnectionStringkkM d
(kkd e
)kke f
,kkf g
$str	kkh 
,
kk 
$num
kk 
)
kk 
;
kk 
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# -
,ll- .
	SqlDbTypell/ 8
.ll8 9
UniqueIdentifierll9 I
,llI J
ParameterDirectionllK ]
.ll] ^
Inputll^ c
,llc d
rowGuidlle l
)lll m
;llm n
returnmm 
sphmm 
.mm 
ExecuteReadermm $
(mm$ %
)mm% &
;mm& '
}oo 	
publicvv 
staticvv 
IDataReadervv !
GetBySiteAndUrlvv" 1
(vv1 2
intvv2 5
siteIdvv6 <
,vv< =
stringvv> D
oldUrlvvE K
)vvK L
{ww 	
SqlParameterHelperxx 
sphxx "
=xx# $
newxx% (
SqlParameterHelperxx) ;
(xx; <
ConnectionStringxx< L
.xxL M#
GetReadConnectionStringxxM d
(xxd e
)xxe f
,xxf g
$str	xxh 
,
xx 
$num
xx 
)
xx 
;
xx 
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# ,
,yy, -
	SqlDbTypeyy. 7
.yy7 8
Intyy8 ;
,yy; <
ParameterDirectionyy= O
.yyO P
InputyyP U
,yyU V
siteIdyyW ]
)yy] ^
;yy^ _
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# ,
,zz, -
	SqlDbTypezz. 7
.zz7 8
NVarCharzz8 @
,zz@ A
$numzzB E
,zzE F
ParameterDirectionzzG Y
.zzY Z
InputzzZ _
,zz_ `
oldUrlzza g
)zzg h
;zzh i
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 1
,{{1 2
	SqlDbType{{3 <
.{{< =
DateTime{{= E
,{{E F
ParameterDirection{{G Y
.{{Y Z
Input{{Z _
,{{_ `
DateTime{{a i
.{{i j
UtcNow{{j p
){{p q
;{{q r
return|| 
sph|| 
.|| 
ExecuteReader|| $
(||$ %
)||% &
;||& '
}~~ 	
public
 
static
 
bool
 
Exists
 !
(
! "
int
" %
siteId
& ,
,
, -
string
. 4
oldUrl
5 ;
)
; <
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
oldUrl
a g
)
g h
;
h i
int
 
count
 
=
 
Convert
 
.
  
ToInt32
  '
(
' (
sph
( +
.
+ ,
ExecuteScalar
, 9
(
9 :
)
: ;
)
; <
;
< =
return
 
(
 
count
 
>
 
$num
 
)
 
;
 
}
 	
public
 
static
 
int
 
GetCount
 "
(
" #
int
# &
siteId
' -
,
- .
string
/ 5

searchTerm
6 @
=
A B
$str
C E
)
E F
{
 	
var
 
	useSearch
 
=
 
!
 
string
 
.
  
IsNullOrWhiteSpace
 -
(
- .

searchTerm
. 8
)
8 9
;
9 :
if
 
(
 
	useSearch
 
)
 
{
  
SqlParameterHelper
 
sph
 
=
 
new
   
SqlParameterHelper
! 3
(
3 4
ConnectionString
4 D
.
D E%
GetReadConnectionString
E \
(
\ ]
)
] ^
,
^ _
$str` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 $
,
$ %
	SqlDbType
& /
.
/ 0
Int
0 3
,
3 4 
ParameterDirection
5 G
.
G H
Input
H M
,
M N
siteId
O U
)
U V
;
V W
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 (
,
( )
	SqlDbType
* 3
.
3 4
NVarChar
4 <
,
< =
$num
> A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \

searchTerm
] g
)
g h
;
h i
return
 

Convert
 
.
 
ToInt32
 
(
 
sph
 
.
 
ExecuteScalar
 ,
(
, -
)
- .
)
. /
;
/ 0
}
 
else
 
{
  
SqlParameterHelper
 
sph
 
=
 
new
   
SqlParameterHelper
! 3
(
3 4
ConnectionString
4 D
.
D E%
GetReadConnectionString
E \
(
\ ]
)
] ^
,
^ _
$str
` z
,
z {
$num
| }
)
} ~
;
~ 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 $
,
$ %
	SqlDbType
& /
.
/ 0
Int
0 3
,
3 4 
ParameterDirection
5 G
.
G H
Input
H M
,
M N
siteId
O U
)
U V
;
V W
return
   

Convert
   
.
   
ToInt32
   
(
   
sph
   
.
   
ExecuteScalar
   ,
(
  , -
)
  - .
)
  . /
;
  / 0
}
¡¡ 
}
££ 	
public
«« 
static
««	 
IDataReader
«« 
GetPage
«« #
(
««# $
int
¬¬ 
siteId
¬¬ 
,
¬¬ 
int
­­ 

pageNumber
­­ 
,
­­ 
int
®® 
pageSize
®® 
,
®® 
out
¯¯ 
int
¯¯ 


totalPages
¯¯ 
,
¯¯ 
string
°° 	

searchTerm
°°
 
=
°° 
$str
°° 
)
°° 
{
±± 
var
²² 
	useSearch
²² 
=
²² 
!
²² 
string
²² 
.
²²  
IsNullOrWhiteSpace
²² -
(
²²- .

searchTerm
²². 8
)
²²8 9
;
²²9 :

totalPages
³³ 
=
³³ 
$num
³³ 
;
³³ 
int
´´ 
	totalRows
´´ 
=
´´ 
GetCount
´´ 
(
´´ 
siteId
´´ "
,
´´" #

searchTerm
´´$ .
)
´´. /
;
´´/ 0
if
¶¶ 
(
¶¶ 
pageSize
¶¶ 
>
¶¶ 
$num
¶¶ 
)
¶¶ 

totalPages
¶¶ 
=
¶¶  !
	totalRows
¶¶" +
/
¶¶, -
pageSize
¶¶. 6
;
¶¶6 7
if
¸¸ 
(
¸¸ 
	totalRows
¸¸ 
<=
¸¸ 
pageSize
¸¸ 
)
¸¸ 
{
¹¹ 

totalPages
ºº 
=
ºº 
$num
ºº 
;
ºº 
}
»» 
else
¼¼ 
{
½½ 
int
¾¾ 
	remainder
¾¾ 
;
¾¾ 
Math
¿¿ 
.
¿¿ 	
DivRem
¿¿	 
(
¿¿ 
	totalRows
¿¿ 
,
¿¿ 
pageSize
¿¿ #
,
¿¿# $
out
¿¿% (
	remainder
¿¿) 2
)
¿¿2 3
;
¿¿3 4
if
ÀÀ 
(
ÀÀ 
	remainder
ÀÀ 
>
ÀÀ 
$num
ÀÀ 
)
ÀÀ 
{
ÁÁ 

totalPages
ÂÂ 
+=
ÂÂ 
$num
ÂÂ 
;
ÂÂ 
}
ÃÃ 
}
ÄÄ 
if
ÆÆ 
(
ÆÆ 
	useSearch
ÆÆ 
)
ÆÆ 
{
ÇÇ  
SqlParameterHelper
ÈÈ 
sph
ÈÈ 
=
ÈÈ 
new
ÈÈ   
SqlParameterHelper
ÈÈ! 3
(
ÈÈ3 4
ConnectionString
ÈÈ4 D
.
ÈÈD E%
GetReadConnectionString
ÈÈE \
(
ÈÈ\ ]
)
ÈÈ] ^
,
ÈÈ^ _
$strÈÈ` 
,ÈÈ 
$numÈÈ 
)ÈÈ 
;ÈÈ 
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ $
,
ÉÉ$ %
	SqlDbType
ÉÉ& /
.
ÉÉ/ 0
Int
ÉÉ0 3
,
ÉÉ3 4 
ParameterDirection
ÉÉ5 G
.
ÉÉG H
Input
ÉÉH M
,
ÉÉM N
siteId
ÉÉO U
)
ÉÉU V
;
ÉÉV W
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ 
(
ÊÊ 
$str
ÊÊ (
,
ÊÊ( )
	SqlDbType
ÊÊ* 3
.
ÊÊ3 4
NVarChar
ÊÊ4 <
,
ÊÊ< =
$num
ÊÊ> A
,
ÊÊA B 
ParameterDirection
ÊÊC U
.
ÊÊU V
Input
ÊÊV [
,
ÊÊ[ \

searchTerm
ÊÊ] g
)
ÊÊg h
;
ÊÊh i
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË (
,
ËË( )
	SqlDbType
ËË* 3
.
ËË3 4
Int
ËË4 7
,
ËË7 8 
ParameterDirection
ËË9 K
.
ËËK L
Input
ËËL Q
,
ËËQ R

pageNumber
ËËS ]
)
ËË] ^
;
ËË^ _
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ 
(
ÌÌ 
$str
ÌÌ &
,
ÌÌ& '
	SqlDbType
ÌÌ( 1
.
ÌÌ1 2
Int
ÌÌ2 5
,
ÌÌ5 6 
ParameterDirection
ÌÌ7 I
.
ÌÌI J
Input
ÌÌJ O
,
ÌÌO P
pageSize
ÌÌQ Y
)
ÌÌY Z
;
ÌÌZ [
return
ÍÍ 

sph
ÍÍ 
.
ÍÍ 
ExecuteReader
ÍÍ 
(
ÍÍ 
)
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÐÐ  
SqlParameterHelper
ÑÑ 
sph
ÑÑ 
=
ÑÑ 
new
ÑÑ   
SqlParameterHelper
ÑÑ! 3
(
ÑÑ3 4
ConnectionString
ÑÑ4 D
.
ÑÑD E%
GetReadConnectionString
ÑÑE \
(
ÑÑ\ ]
)
ÑÑ] ^
,
ÑÑ^ _
$str
ÑÑ` |
,
ÑÑ| }
$num
ÑÑ~ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ 
(
ÒÒ 
$str
ÒÒ $
,
ÒÒ$ %
	SqlDbType
ÒÒ& /
.
ÒÒ/ 0
Int
ÒÒ0 3
,
ÒÒ3 4 
ParameterDirection
ÒÒ5 G
.
ÒÒG H
Input
ÒÒH M
,
ÒÒM N
siteId
ÒÒO U
)
ÒÒU V
;
ÒÒV W
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ 
(
ÓÓ 
$str
ÓÓ (
,
ÓÓ( )
	SqlDbType
ÓÓ* 3
.
ÓÓ3 4
Int
ÓÓ4 7
,
ÓÓ7 8 
ParameterDirection
ÓÓ9 K
.
ÓÓK L
Input
ÓÓL Q
,
ÓÓQ R

pageNumber
ÓÓS ]
)
ÓÓ] ^
;
ÓÓ^ _
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ 
(
ÔÔ 
$str
ÔÔ &
,
ÔÔ& '
	SqlDbType
ÔÔ( 1
.
ÔÔ1 2
Int
ÔÔ2 5
,
ÔÔ5 6 
ParameterDirection
ÔÔ7 I
.
ÔÔI J
Input
ÔÔJ O
,
ÔÔO P
pageSize
ÔÔQ Y
)
ÔÔY Z
;
ÔÔZ [
return
ÕÕ 

sph
ÕÕ 
.
ÕÕ 
ExecuteReader
ÕÕ 
(
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 
}
ÙÙ 
}ÚÚ é
gD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbRoles.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBRoles 
{ 
public 
static 
int 

RoleCreate $
($ %
Guid 
roleGuid 
, 
Guid 
siteGuid 
, 
int 
siteId 
, 
string 
roleName 
, 
string 	
displayName
 
) 
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M$
GetWriteConnectionStringM e
(e f
)f g
,g h
$stri z
,z {
$num| }
)} ~
;~ 
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
roleGuidf n
)n o
;o p
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
UniqueIdentifier: J
,J K
ParameterDirectionL ^
.^ _
Input_ d
,d e
siteGuidf n
)n o
;o p
sph 
. 
DefineSqlParameter "
(" #
$str# ,
,, -
	SqlDbType. 7
.7 8
Int8 ;
,; <
ParameterDirection= O
.O P
InputP U
,U V
siteIdW ]
)] ^
;^ _
sph 
. 
DefineSqlParameter "
(" #
$str# .
,. /
	SqlDbType0 9
.9 :
NVarChar: B
,B C
$numD F
,F G
ParameterDirectionH Z
.Z [
Input[ `
,` a
roleNameb j
)j k
;k l
sph 
. 
DefineSqlParameter "
(" #
$str# 1
,1 2
	SqlDbType3 <
.< =
NVarChar= E
,E F
$numG I
,I J
ParameterDirectionK ]
.] ^
Input^ c
,c d
displayNamee p
)p q
;q r
int 
newID 
= 
Convert 
. 
ToInt32 
( 
sph "
." #
ExecuteScalar# 0
(0 1
)1 2
)2 3
;3 4
return   
newID   
;   
}!! 	
public## 
static## 
bool## 
Update## !
(##! "
int##" %
roleId##& ,
,##, -
string##. 4
displayName##5 @
)##@ A
{$$ 	
SqlParameterHelper%% 
sph%% "
=%%# $
new%%% (
SqlParameterHelper%%) ;
(%%; <
ConnectionString%%< L
.%%L M$
GetWriteConnectionString%%M e
(%%e f
)%%f g
,%%g h
$str%%i z
,%%z {
$num%%| }
)%%} ~
;%%~ 
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# ,
,&&, -
	SqlDbType&&. 7
.&&7 8
Int&&8 ;
,&&; <
ParameterDirection&&= O
.&&O P
Input&&P U
,&&U V
roleId&&W ]
)&&] ^
;&&^ _
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# 1
,''1 2
	SqlDbType''3 <
.''< =
NVarChar''= E
,''E F
$num''G I
,''I J
ParameterDirection''K ]
.''] ^
Input''^ c
,''c d
displayName''e p
)''p q
;''q r
int(( 
rowsAffected(( 
=(( 
sph(( "
.((" #
ExecuteNonQuery((# 2
(((2 3
)((3 4
;((4 5
return)) 
()) 
rowsAffected))  
>))! "
-))# $
$num))$ %
)))% &
;))& '
}** 	
public,, 
static,, 
bool,, 
Delete,, !
(,,! "
int,," %
roleId,,& ,
),,, -
{-- 	
SqlParameterHelper.. 
sph.. "
=..# $
new..% (
SqlParameterHelper..) ;
(..; <
ConnectionString..< L
...L M$
GetWriteConnectionString..M e
(..e f
)..f g
,..g h
$str..i z
,..z {
$num..| }
)..} ~
;..~ 
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# ,
,//, -
	SqlDbType//. 7
.//7 8
Int//8 ;
,//; <
ParameterDirection//= O
.//O P
Input//P U
,//U V
roleId//W ]
)//] ^
;//^ _
int00 
rowsAffected00 
=00 
sph00 "
.00" #
ExecuteNonQuery00# 2
(002 3
)003 4
;004 5
return11 
(11 
rowsAffected11  
>11! "
-11# $
$num11$ %
)11% &
;11& '
}22 	
public44 
static44 
bool44 
DeleteUserRoles44 *
(44* +
int44+ .
userId44/ 5
)445 6
{55 	
SqlParameterHelper66 
sph66 "
=66# $
new66% (
SqlParameterHelper66) ;
(66; <
ConnectionString66< L
.66L M$
GetWriteConnectionString66M e
(66e f
)66f g
,66g h
$str	66i 
,
66 
$num
66 
)
66 
;
66 
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ,
,77, -
	SqlDbType77. 7
.777 8
Int778 ;
,77; <
ParameterDirection77= O
.77O P
Input77P U
,77U V
userId77W ]
)77] ^
;77^ _
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
(99 
rowsAffected99  
>99! "
-99# $
$num99$ %
)99% &
;99& '
}:: 	
public<< 
static<< 
bool<< 
Exists<< !
(<<! "
int<<" %
siteId<<& ,
,<<, -
string<<. 4
roleName<<5 =
)<<= >
{== 	
SqlParameterHelper>> 
sph>> "
=>># $
new>>% (
SqlParameterHelper>>) ;
(>>; <
ConnectionString>>< L
.>>L M#
GetReadConnectionString>>M d
(>>d e
)>>e f
,>>f g
$str>>h }
,>>} ~
$num	>> 
)
>> 
;
>> 
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# ,
,??, -
	SqlDbType??. 7
.??7 8
Int??8 ;
,??; <
ParameterDirection??= O
.??O P
Input??P U
,??U V
siteId??W ]
)??] ^
;??^ _
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# .
,@@. /
	SqlDbType@@0 9
.@@9 :
NVarChar@@: B
,@@B C
$num@@D F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
roleName@@b j
)@@j k
;@@k l
intAA 
countAA 
=AA 
ConvertAA 
.AA  
ToInt32AA  '
(AA' (
sphAA( +
.AA+ ,
ExecuteScalarAA, 9
(AA9 :
)AA: ;
)AA; <
;AA< =
returnBB 
(BB 
countBB 
>BB 
$numBB 
)BB 
;BB 
}DD 	
publicFF 
staticFF 
IDataReaderFF !
GetByIdFF" )
(FF) *
intFF* -
roleIdFF. 4
)FF4 5
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M#
GetReadConnectionStringHHM d
(HHd e
)HHe f
,HHf g
$strHHh |
,HH| }
$numHH~ 
)	HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# ,
,II, -
	SqlDbTypeII. 7
.II7 8
IntII8 ;
,II; <
ParameterDirectionII= O
.IIO P
InputIIP U
,IIU V
roleIdIIW ]
)II] ^
;II^ _
returnJJ 
sphJJ 
.JJ 
ExecuteReaderJJ $
(JJ$ %
)JJ% &
;JJ& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !
	GetByNameMM" +
(MM+ ,
intMM, /
siteIdMM0 6
,MM6 7
stringMM8 >
roleNameMM? G
)MMG H
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh 
,
OO 
$num
OO 
)
OO 
;
OO 
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# ,
,PP, -
	SqlDbTypePP. 7
.PP7 8
IntPP8 ;
,PP; <
ParameterDirectionPP= O
.PPO P
InputPPP U
,PPU V
siteIdPPW ]
)PP] ^
;PP^ _
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
NVarCharQQ: B
,QQB C
$numQQD F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
roleNameQQb j
)QQj k
;QQk l
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}SS 	
publicUU 
staticUU 
IDataReaderUU !
GetSiteRolesUU" .
(UU. /
intUU/ 2
siteIdUU3 9
)UU9 :
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M#
GetReadConnectionStringWWM d
(WWd e
)WWe f
,WWf g
$strWWh y
,WWy z
$numWW{ |
)WW| }
;WW} ~
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# ,
,XX, -
	SqlDbTypeXX. 7
.XX7 8
IntXX8 ;
,XX; <
ParameterDirectionXX= O
.XXO P
InputXXP U
,XXU V
siteIdXXW ]
)XX] ^
;XX^ _
returnYY 
sphYY 
.YY 
ExecuteReaderYY $
(YY$ %
)YY% &
;YY& '
}ZZ 	
public\\ 
static\\ 
IDataReader\\ !
GetRoleMembers\\" 0
(\\0 1
int\\1 4
roleId\\5 ;
)\\; <
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M#
GetReadConnectionString^^M d
(^^d e
)^^e f
,^^f g
$str	^^h 
,
^^ 
$num
^^ 
)
^^ 
;
^^ 
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# ,
,__, -
	SqlDbType__. 7
.__7 8
Int__8 ;
,__; <
ParameterDirection__= O
.__O P
Input__P U
,__U V
roleId__W ]
)__] ^
;__^ _
return`` 
sph`` 
.`` 
ExecuteReader`` $
(``$ %
)``% &
;``& '
}aa 	
publiccc 
staticcc 
intcc $
GetCountOfUsersNotInRolecc 2
(cc2 3
intcc3 6
siteIdcc7 =
,cc= >
intcc? B
roleIdccC I
)ccI J
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M#
GetReadConnectionStringeeM d
(eed e
)eee f
,eef g
$str	eeh 
,
ee 
$num
ee 
)
ee 
;
ee 
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# ,
,ff, -
	SqlDbTypeff. 7
.ff7 8
Intff8 ;
,ff; <
ParameterDirectionff= O
.ffO P
InputffP U
,ffU V
siteIdffW ]
)ff] ^
;ff^ _
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# ,
,gg, -
	SqlDbTypegg. 7
.gg7 8
Intgg8 ;
,gg; <
ParameterDirectiongg= O
.ggO P
InputggP U
,ggU V
roleIdggW ]
)gg] ^
;gg^ _
returnii 
Convertii 
.ii 
ToInt32ii "
(ii" #
sphii# &
.ii& '
ExecuteScalarii' 4
(ii4 5
)ii5 6
)ii6 7
;ii7 8
}jj 	
publicll 
staticll 
IDataReaderll !
GetUsersNotInRolell" 3
(ll3 4
intmm 
siteIdmm 
,mm 
intnn 
roleIdnn 
,nn 
intoo 

pageNumberoo 
,oo 
intpp 
pageSizepp 
,pp 
outqq 
intqq 


totalPagesqq 
)qq 
{rr 	

totalPagesss 
=ss 
$numss 
;ss 
inttt 
	totalRowstt 
=tt $
GetCountOfUsersNotInRolett 4
(tt4 5
siteIdtt5 ;
,tt; <
roleIdtt= C
)ttC D
;ttD E
ifvv 
(vv 
pageSizevv 
>vv 
$numvv 
)vv 

totalPagesvv (
=vv) *
	totalRowsvv+ 4
/vv5 6
pageSizevv7 ?
;vv? @
ifxx 
(xx 
	totalRowsxx 
<=xx 
pageSizexx %
)xx% &
{yy 

totalPageszz 
=zz 
$numzz 
;zz 
}{{ 
else|| 
{}} 
int~~ 
	remainder~~ 
;~~ 
Math 
. 
DivRem 
( 
	totalRows %
,% &
pageSize' /
,/ 0
out1 4
	remainder5 >
)> ?
;? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
roleId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
int
 #
GetCountOfUsersInRole
 /
(
/ 0
int
0 3
siteId
4 :
,
: ;
int
< ?
roleId
@ F
)
F G
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
roleId
W ]
)
] ^
;
^ _
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !
GetUsersInRole
" 0
(
0 1
int
 
siteId
 
,
 
int
 
roleId
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 #
GetCountOfUsersInRole
 1
(
1 2
siteId
2 8
,
8 9
roleId
: @
)
@ A
;
A B
if
¡¡ 
(
¡¡ 
pageSize
¡¡ 
>
¡¡ 
$num
¡¡ 
)
¡¡ 

totalPages
¡¡ (
=
¡¡) *
	totalRows
¡¡+ 4
/
¡¡5 6
pageSize
¡¡7 ?
;
¡¡? @
if
££ 
(
££ 
	totalRows
££ 
<=
££ 
pageSize
££ %
)
££% &
{
¤¤ 

totalPages
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥ 
}
¦¦ 
else
§§ 
{
¨¨ 
int
©© 
	remainder
©© 
;
©© 
Math
ªª 
.
ªª 
DivRem
ªª 
(
ªª 
	totalRows
ªª %
,
ªª% &
pageSize
ªª' /
,
ªª/ 0
out
ªª1 4
	remainder
ªª5 >
)
ªª> ?
;
ªª? @
if
«« 
(
«« 
	remainder
«« 
>
«« 
$num
««  !
)
««! "
{
¬¬ 

totalPages
­­ 
+=
­­ !
$num
­­" #
;
­­# $
}
®® 
}
¯¯  
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h 
,±± 
$num±± 
)±± 
;±± 
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# ,
,
²², -
	SqlDbType
²². 7
.
²²7 8
Int
²²8 ;
,
²²; < 
ParameterDirection
²²= O
.
²²O P
Input
²²P U
,
²²U V
siteId
²²W ]
)
²²] ^
;
²²^ _
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# ,
,
³³, -
	SqlDbType
³³. 7
.
³³7 8
Int
³³8 ;
,
³³; < 
ParameterDirection
³³= O
.
³³O P
Input
³³P U
,
³³U V
roleId
³³W ]
)
³³] ^
;
³³^ _
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# 0
,
´´0 1
	SqlDbType
´´2 ;
.
´´; <
Int
´´< ?
,
´´? @ 
ParameterDirection
´´A S
.
´´S T
Input
´´T Y
,
´´Y Z

pageNumber
´´[ e
)
´´e f
;
´´f g
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# .
,
µµ. /
	SqlDbType
µµ0 9
.
µµ9 :
Int
µµ: =
,
µµ= > 
ParameterDirection
µµ? Q
.
µµQ R
Input
µµR W
,
µµW X
pageSize
µµY a
)
µµa b
;
µµb c
return
¶¶ 
sph
¶¶ 
.
¶¶ 
ExecuteReader
¶¶ $
(
¶¶$ %
)
¶¶% &
;
¶¶& '
}
·· 	
public
¹¹ 
static
¹¹ 
IDataReader
¹¹ !!
GetRolesUserIsNotIn
¹¹" 5
(
¹¹5 6
int
ºº 
siteId
ºº 
,
ºº 
int
»» 
userId
»» 
)
»» 
{
¼¼ 	 
SqlParameterHelper
½½ 
sph
½½ "
=
½½# $
new
½½% ( 
SqlParameterHelper
½½) ;
(
½½; <
ConnectionString
½½< L
.
½½L M%
GetReadConnectionString
½½M d
(
½½d e
)
½½e f
,
½½f g
$str½½h 
,½½ 
$num½½ 
)½½ 
;½½ 
sph
¾¾ 
.
¾¾  
DefineSqlParameter
¾¾ "
(
¾¾" #
$str
¾¾# ,
,
¾¾, -
	SqlDbType
¾¾. 7
.
¾¾7 8
Int
¾¾8 ;
,
¾¾; < 
ParameterDirection
¾¾= O
.
¾¾O P
Input
¾¾P U
,
¾¾U V
siteId
¾¾W ]
)
¾¾] ^
;
¾¾^ _
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# ,
,
¿¿, -
	SqlDbType
¿¿. 7
.
¿¿7 8
Int
¿¿8 ;
,
¿¿; < 
ParameterDirection
¿¿= O
.
¿¿O P
Input
¿¿P U
,
¿¿U V
userId
¿¿W ]
)
¿¿] ^
;
¿¿^ _
return
ÀÀ 
sph
ÀÀ 
.
ÀÀ 
ExecuteReader
ÀÀ $
(
ÀÀ$ %
)
ÀÀ% &
;
ÀÀ& '
}
ÁÁ 	
public
ÃÃ 
static
ÃÃ 
bool
ÃÃ 
AddUser
ÃÃ "
(
ÃÃ" #
int
ÄÄ 
roleId
ÄÄ 
,
ÄÄ 
int
ÅÅ 
userId
ÅÅ 
,
ÅÅ 
Guid
ÆÆ 
roleGuid
ÆÆ 
,
ÆÆ 
Guid
ÇÇ 
userGuid
ÇÇ 
)
ÈÈ 
{
ÉÉ 	 
SqlParameterHelper
ÊÊ 
sph
ÊÊ "
=
ÊÊ# $
new
ÊÊ% ( 
SqlParameterHelper
ÊÊ) ;
(
ÊÊ; <
ConnectionString
ÊÊ< L
.
ÊÊL M&
GetWriteConnectionString
ÊÊM e
(
ÊÊe f
)
ÊÊf g
,
ÊÊg h
$str
ÊÊi ~
,
ÊÊ~ 
$numÊÊ 
)ÊÊ 
;ÊÊ 
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# ,
,
ËË, -
	SqlDbType
ËË. 7
.
ËË7 8
Int
ËË8 ;
,
ËË; < 
ParameterDirection
ËË= O
.
ËËO P
Input
ËËP U
,
ËËU V
roleId
ËËW ]
)
ËË] ^
;
ËË^ _
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# ,
,
ÌÌ, -
	SqlDbType
ÌÌ. 7
.
ÌÌ7 8
Int
ÌÌ8 ;
,
ÌÌ; < 
ParameterDirection
ÌÌ= O
.
ÌÌO P
Input
ÌÌP U
,
ÌÌU V
userId
ÌÌW ]
)
ÌÌ] ^
;
ÌÌ^ _
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# .
,
ÍÍ. /
	SqlDbType
ÍÍ0 9
.
ÍÍ9 :
UniqueIdentifier
ÍÍ: J
,
ÍÍJ K 
ParameterDirection
ÍÍL ^
.
ÍÍ^ _
Input
ÍÍ_ d
,
ÍÍd e
roleGuid
ÍÍf n
)
ÍÍn o
;
ÍÍo p
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# .
,
ÎÎ. /
	SqlDbType
ÎÎ0 9
.
ÎÎ9 :
UniqueIdentifier
ÎÎ: J
,
ÎÎJ K 
ParameterDirection
ÎÎL ^
.
ÎÎ^ _
Input
ÎÎ_ d
,
ÎÎd e
userGuid
ÎÎf n
)
ÎÎn o
;
ÎÎo p
int
ÐÐ 
rowsAffected
ÐÐ 
=
ÐÐ 
sph
ÐÐ "
.
ÐÐ" #
ExecuteNonQuery
ÐÐ# 2
(
ÐÐ2 3
)
ÐÐ3 4
;
ÐÐ4 5
return
ÑÑ 
(
ÑÑ 
rowsAffected
ÑÑ  
>
ÑÑ! "
-
ÑÑ# $
$num
ÑÑ$ %
)
ÑÑ% &
;
ÑÑ& '
}
ÒÒ 	
public
ÔÔ 
static
ÔÔ 
bool
ÔÔ 

RemoveUser
ÔÔ %
(
ÔÔ% &
int
ÔÔ& )
roleId
ÔÔ* 0
,
ÔÔ0 1
int
ÔÔ2 5
userId
ÔÔ6 <
)
ÔÔ< =
{
ÕÕ 	 
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M&
GetWriteConnectionString
ÖÖM e
(
ÖÖe f
)
ÖÖf g
,
ÖÖg h
$str
ÖÖi ~
,
ÖÖ~ 
$numÖÖ 
)ÖÖ 
;ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× "
(
××" #
$str
××# ,
,
××, -
	SqlDbType
××. 7
.
××7 8
Int
××8 ;
,
××; < 
ParameterDirection
××= O
.
××O P
Input
××P U
,
××U V
roleId
××W ]
)
××] ^
;
××^ _
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# ,
,
ØØ, -
	SqlDbType
ØØ. 7
.
ØØ7 8
Int
ØØ8 ;
,
ØØ; < 
ParameterDirection
ØØ= O
.
ØØO P
Input
ØØP U
,
ØØU V
userId
ØØW ]
)
ØØ] ^
;
ØØ^ _
int
ÙÙ 
rowsAffected
ÙÙ 
=
ÙÙ 
sph
ÙÙ "
.
ÙÙ" #
ExecuteNonQuery
ÙÙ# 2
(
ÙÙ2 3
)
ÙÙ3 4
;
ÙÙ4 5
return
ÚÚ 
(
ÚÚ 
rowsAffected
ÚÚ  
>
ÚÚ! "
-
ÚÚ# $
$num
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 	
public
ÞÞ 
static
ÞÞ 
int
ÞÞ !
GetCountOfSiteRoles
ÞÞ -
(
ÞÞ- .
int
ÞÞ. 1
siteId
ÞÞ2 8
)
ÞÞ8 9
{
ßß 	 
SqlParameterHelper
àà 
sph
àà "
=
àà# $
new
àà% ( 
SqlParameterHelper
àà) ;
(
àà; <
ConnectionString
àà< L
.
ààL M%
GetReadConnectionString
ààM d
(
ààd e
)
ààe f
,
ààf g
$str
ààh ~
,
àà~ 
$numàà 
)àà 
;àà 
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# ,
,
áá, -
	SqlDbType
áá. 7
.
áá7 8
Int
áá8 ;
,
áá; < 
ParameterDirection
áá= O
.
ááO P
Input
ááP U
,
ááU V
siteId
ááW ]
)
áá] ^
;
áá^ _
return
ää 
Convert
ää 
.
ää 
ToInt32
ää "
(
ää" #
sph
ää# &
.
ää& '
ExecuteScalar
ää' 4
(
ää4 5
)
ää5 6
)
ää6 7
;
ää7 8
}
åå 	
}
èè 
}éé K
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSavedQuery.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSavedQuery $
{ 
public$$ 
static$$ 
int$$ 
Create$$  
($$  !
Guid%% 
id%% 
,%% 
string&& 
name&& 
,&& 
string'' 
	statement'' 
,'' 
DateTime(( 

createdUtc(( 
,((  
Guid)) 
	createdBy)) 
))) 
{** 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i 
,	++ 
$num
++ 
)
++ 
;
++ 
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# (
,,,( )
	SqlDbType,,* 3
.,,3 4
UniqueIdentifier,,4 D
,,,D E
ParameterDirection,,F X
.,,X Y
Input,,Y ^
,,,^ _
id,,` b
),,b c
;,,c d
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# *
,--* +
	SqlDbType--, 5
.--5 6
NVarChar--6 >
,--> ?
$num--@ B
,--B C
ParameterDirection--D V
.--V W
Input--W \
,--\ ]
name--^ b
)--b c
;--c d
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# /
,../ 0
	SqlDbType..1 :
...: ;
NVarChar..; C
,..C D
-..E F
$num..F G
,..G H
ParameterDirection..I [
...[ \
Input..\ a
,..a b
	statement..c l
)..l m
;..m n
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# 0
,//0 1
	SqlDbType//2 ;
.//; <
DateTime//< D
,//D E
ParameterDirection//F X
.//X Y
Input//Y ^
,//^ _

createdUtc//` j
)//j k
;//k l
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# /
,00/ 0
	SqlDbType001 :
.00: ;
UniqueIdentifier00; K
,00K L
ParameterDirection00M _
.00_ `
Input00` e
,00e f
	createdBy00g p
)00p q
;00q r
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
DateTime11< D
,11D E
ParameterDirection11F X
.11X Y
Input11Y ^
,11^ _

createdUtc11` j
)11j k
;11k l
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# /
,22/ 0
	SqlDbType221 :
.22: ;
UniqueIdentifier22; K
,22K L
ParameterDirection22M _
.22_ `
Input22` e
,22e f
	createdBy22g p
)22p q
;22q r
int33 
rowsAffected33 
=33 
sph33 "
.33" #
ExecuteNonQuery33# 2
(332 3
)333 4
;334 5
return44 
rowsAffected44 
;44  
}66 	
publicAA 
staticAA 
boolAA 
UpdateAA !
(AA! "
GuidBB 
idBB 
,BB 
stringCC 
	statementCC 
,CC 
DateTimeDD 

lastModUtcDD 
,DD  
GuidEE 
	lastModByEE 
)EE 
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi 
,	GG 
$num
GG 
)
GG 
;
GG 
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# (
,HH( )
	SqlDbTypeHH* 3
.HH3 4
UniqueIdentifierHH4 D
,HHD E
ParameterDirectionHHF X
.HHX Y
InputHHY ^
,HH^ _
idHH` b
)HHb c
;HHc d
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# /
,II/ 0
	SqlDbTypeII1 :
.II: ;
NVarCharII; C
,IIC D
-IIE F
$numIIF G
,IIG H
ParameterDirectionIII [
.II[ \
InputII\ a
,IIa b
	statementIIc l
)IIl m
;IIm n
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# 0
,JJ0 1
	SqlDbTypeJJ2 ;
.JJ; <
DateTimeJJ< D
,JJD E
ParameterDirectionJJF X
.JJX Y
InputJJY ^
,JJ^ _

lastModUtcJJ` j
)JJj k
;JJk l
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# /
,KK/ 0
	SqlDbTypeKK1 :
.KK: ;
UniqueIdentifierKK; K
,KKK L
ParameterDirectionKKM _
.KK_ `
InputKK` e
,KKe f
	lastModByKKg p
)KKp q
;KKq r
intLL 
rowsAffectedLL 
=LL 
sphLL "
.LL" #
ExecuteNonQueryLL# 2
(LL2 3
)LL3 4
;LL4 5
returnMM 
(MM 
rowsAffectedMM  
>MM! "
$numMM# $
)MM$ %
;MM% &
}OO 	
publicVV 
staticVV 
boolVV 
DeleteVV !
(VV! "
GuidVV" &
idVV' )
)VV) *
{WW 	
SqlParameterHelperXX 
sphXX "
=XX# $
newXX% (
SqlParameterHelperXX) ;
(XX; <
ConnectionStringXX< L
.XXL M$
GetWriteConnectionStringXXM e
(XXe f
)XXf g
,XXg h
$strXXi 
,	XX 
$num
XX 
)
XX 
;
XX 
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# (
,YY( )
	SqlDbTypeYY* 3
.YY3 4
UniqueIdentifierYY4 D
,YYD E
ParameterDirectionYYF X
.YYX Y
InputYYY ^
,YY^ _
idYY` b
)YYb c
;YYc d
intZZ 
rowsAffectedZZ 
=ZZ 
sphZZ "
.ZZ" #
ExecuteNonQueryZZ# 2
(ZZ2 3
)ZZ3 4
;ZZ4 5
return[[ 
([[ 
rowsAffected[[  
>[[! "
$num[[# $
)[[$ %
;[[% &
}]] 	
publiccc 
staticcc 
IDataReadercc !
GetOnecc" (
(cc( )
Guidcc) -
idcc. 0
)cc0 1
{dd 	
SqlParameterHelperee 
sphee "
=ee# $
newee% (
SqlParameterHelperee) ;
(ee; <
ConnectionStringee< L
.eeL M#
GetReadConnectionStringeeM d
(eed e
)eee f
,eef g
$str	eeh 
,
ee 
$num
ee 
)
ee 
;
ee 
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# (
,ff( )
	SqlDbTypeff* 3
.ff3 4
UniqueIdentifierff4 D
,ffD E
ParameterDirectionffF X
.ffX Y
InputffY ^
,ff^ _
idff` b
)ffb c
;ffc d
returngg 
sphgg 
.gg 
ExecuteReadergg $
(gg$ %
)gg% &
;gg& '
}ii 	
publicoo 
staticoo 
IDataReaderoo !
GetOneoo" (
(oo( )
stringoo) /
nameoo0 4
)oo4 5
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M#
GetReadConnectionStringqqM d
(qqd e
)qqe f
,qqf g
$str	qqh 
,
qq 
$num
qq 
)
qq 
;
qq 
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# *
,rr* +
	SqlDbTyperr, 5
.rr5 6
NVarCharrr6 >
,rr> ?
$numrr@ B
,rrB C
ParameterDirectionrrD V
.rrV W
InputrrW \
,rr\ ]
namerr^ b
)rrb c
;rrc d
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}uu 	
public|| 
static|| 
IDataReader|| !
GetAll||" (
(||( )
)||) *
{}} 	
return 
	SqlHelper 
. 
ExecuteReader *
(* +
ConnectionString
  
.
  !%
GetReadConnectionString
! 8
(
8 9
)
9 :
,
: ;
CommandType
 
.
 
StoredProcedure
 +
,
+ ,
$str
 )
,
) *
null
 
)
 
;
 
}
 	
}
 
} ÆN
lD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteFolder.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteFolder $
{ 
public 
static 
int 
Add 
( 
Guid 
guid 
, 
Guid 
siteGuid 
, 
string 

folderName 
) 
{   	
SqlParameterHelper!! 
sph!! "
=!!# $
new!!% (
SqlParameterHelper!!) ;
(!!; <
ConnectionString!!< L
.!!L M$
GetWriteConnectionString!!M e
(!!e f
)!!f g
,!!g h
$str	!!i 
,
!! 
$num
!! 
)
!! 
;
!! 
sph"" 
."" 
DefineSqlParameter"" "
(""" #
$str""# *
,""* +
	SqlDbType"", 5
.""5 6
UniqueIdentifier""6 F
,""F G
ParameterDirection""H Z
.""Z [
Input""[ `
,""` a
guid""b f
)""f g
;""g h
sph## 
.## 
DefineSqlParameter## "
(##" #
$str### .
,##. /
	SqlDbType##0 9
.##9 :
UniqueIdentifier##: J
,##J K
ParameterDirection##L ^
.##^ _
Input##_ d
,##d e
siteGuid##f n
)##n o
;##o p
sph$$ 
.$$ 
DefineSqlParameter$$ "
($$" #
$str$$# 0
,$$0 1
	SqlDbType$$2 ;
.$$; <
NVarChar$$< D
,$$D E
$num$$F I
,$$I J
ParameterDirection$$K ]
.$$] ^
Input$$^ c
,$$c d

folderName$$e o
)$$o p
;$$p q
int%% 
rowsAffected%% 
=%% 
Convert%% &
.%%& '
ToInt32%%' .
(%%. /
sph%%/ 2
.%%2 3
ExecuteNonQuery%%3 B
(%%B C
)%%C D
)%%D E
;%%E F
return&& 
rowsAffected&& 
;&&  
}'' 	
public)) 
static)) 
bool)) 
Update)) !
())! "
Guid** 
guid** 
,** 
Guid++ 
siteGuid++ 
,++ 
string,, 

folderName,, 
),, 
{-- 	
SqlParameterHelper.. 
sph.. "
=..# $
new..% (
SqlParameterHelper..) ;
(..; <
ConnectionString..< L
...L M$
GetWriteConnectionString..M e
(..e f
)..f g
,..g h
$str	..i 
,
.. 
$num
.. 
)
.. 
;
.. 
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# *
,//* +
	SqlDbType//, 5
.//5 6
UniqueIdentifier//6 F
,//F G
ParameterDirection//H Z
.//Z [
Input//[ `
,//` a
guid//b f
)//f g
;//g h
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# .
,00. /
	SqlDbType000 9
.009 :
UniqueIdentifier00: J
,00J K
ParameterDirection00L ^
.00^ _
Input00_ d
,00d e
siteGuid00f n
)00n o
;00o p
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 0
,110 1
	SqlDbType112 ;
.11; <
NVarChar11< D
,11D E
$num11F I
,11I J
ParameterDirection11K ]
.11] ^
Input11^ c
,11c d

folderName11e o
)11o p
;11p q
int22 
rowsAffected22 
=22 
sph22 "
.22" #
ExecuteNonQuery22# 2
(222 3
)223 4
;224 5
return33 
(33 
rowsAffected33  
>33! "
-33# $
$num33$ %
)33% &
;33& '
}44 	
public66 
static66 
bool66 
Delete66 !
(66! "
Guid66" &
guid66' +
)66+ ,
{77 	
SqlParameterHelper88 
sph88 "
=88# $
new88% (
SqlParameterHelper88) ;
(88; <
ConnectionString88< L
.88L M$
GetWriteConnectionString88M e
(88e f
)88f g
,88g h
$str	88i 
,
88 
$num
88 
)
88 
;
88 
sph99 
.99 
DefineSqlParameter99 "
(99" #
$str99# *
,99* +
	SqlDbType99, 5
.995 6
UniqueIdentifier996 F
,99F G
ParameterDirection99H Z
.99Z [
Input99[ `
,99` a
guid99b f
)99f g
;99g h
int:: 
rowsAffected:: 
=:: 
sph:: "
.::" #
ExecuteNonQuery::# 2
(::2 3
)::3 4
;::4 5
return;; 
(;; 
rowsAffected;;  
>;;! "
-;;# $
$num;;$ %
);;% &
;;;& '
}<< 	
public>> 
static>> 
bool>> 
Exists>> !
(>>! "
string>>" (

folderName>>) 3
)>>3 4
{?? 	
SqlParameterHelper@@ 
sph@@ "
=@@# $
new@@% (
SqlParameterHelper@@) ;
(@@; <
ConnectionString@@< L
.@@L M#
GetReadConnectionString@@M d
(@@d e
)@@e f
,@@f g
$str@@h ~
,@@~ 
$num
@@ 
)
@@ 
;
@@ 
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 0
,AA0 1
	SqlDbTypeAA2 ;
.AA; <
NVarCharAA< D
,AAD E
$numAAF I
,AAI J
ParameterDirectionAAK ]
.AA] ^
InputAA^ c
,AAc d

folderNameAAe o
)AAo p
;AAp q
intBB 
countBB 
=BB 
ConvertBB 
.BB  
ToInt32BB  '
(BB' (
sphBB( +
.BB+ ,
ExecuteScalarBB, 9
(BB9 :
)BB: ;
)BB; <
;BB< =
returnCC 
(CC 
countCC 
>CC 
$numCC 
)CC 
;CC 
}DD 	
publicFF 
staticFF 
IDataReaderFF !
GetOneFF" (
(FF( )
GuidFF) -
guidFF. 2
)FF2 3
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M#
GetReadConnectionStringHHM d
(HHd e
)HHe f
,HHf g
$str	HHh 
,
HH 
$num
HH 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
returnJJ 
sphJJ 
.JJ 
ExecuteReaderJJ $
(JJ$ %
)JJ% &
;JJ& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !
	GetBySiteMM" +
(MM+ ,
GuidMM, 0
siteGuidMM1 9
)MM9 :
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh 
,
OO 
$num
OO 
)
OO 
;
OO 
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# .
,PP. /
	SqlDbTypePP0 9
.PP9 :
UniqueIdentifierPP: J
,PPJ K
ParameterDirectionPPL ^
.PP^ _
InputPP_ d
,PPd e
siteGuidPPf n
)PPn o
;PPo p
returnQQ 
sphQQ 
.QQ 
ExecuteReaderQQ $
(QQ$ %
)QQ% &
;QQ& '
}RR 	
publicTT 
staticTT 
GuidTT 
GetSiteGuidTT &
(TT& '
stringTT' -

folderNameTT. 8
)TT8 9
{UU 	
SqlParameterHelperVV 
sphVV "
=VV# $
newVV% (
SqlParameterHelperVV) ;
(VV; <
ConnectionStringVV< L
.VVL M#
GetReadConnectionStringVVM d
(VVd e
)VVe f
,VVf g
$str	VVh 
,
VV 
$num
VV 
)
VV 
;
VV 
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 0
,WW0 1
	SqlDbTypeWW2 ;
.WW; <
NVarCharWW< D
,WWD E
$numWWF I
,WWI J
ParameterDirectionWWK ]
.WW] ^
InputWW^ c
,WWc d

folderNameWWe o
)WWo p
;WWp q
stringXX 
strGuidXX 
=XX 
sphXX  
.XX  !
ExecuteScalarXX! .
(XX. /
)XX/ 0
.XX0 1
ToStringXX1 9
(XX9 :
)XX: ;
;XX; <
ifYY 
(YY 
strGuidYY 
.YY 
LengthYY 
==YY !
$numYY" $
)YY$ %
{ZZ 
return[[ 
new[[ 
Guid[[ 
([[  
strGuid[[  '
)[[' (
;[[( )
}\\ 
return]] 
Guid]] 
.]] 
Empty]] 
;]] 
}^^ 	
}cc 
}dd x
uD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSitePersonalization.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class !
DBSitePersonalization -
{ 
public 
static 
void #
SavePersonalizationBlob 2
(2 3
int 
siteId 
, 
String 
path 
, 
Guid 
userGuid 
, 
byte 
[ 
] 
dataBlob 
, 
DateTime 
lastUpdateTime #
)# $
{   	
SqlParameterHelper!! 
sph!! "
=!!# $
new!!% (
SqlParameterHelper!!) ;
(!!; <
ConnectionString!!< L
.!!L M$
GetWriteConnectionString!!M e
(!!e f
)!!f g
,!!g h
$str	!!i 
,
!! 
$num
!! 
)
!! 
;
!! 
sph"" 
."" 
DefineSqlParameter"" "
(""" #
$str""# ,
,"", -
	SqlDbType"". 7
.""7 8
Int""8 ;
,""; <
ParameterDirection""= O
.""O P
Input""P U
,""U V
siteId""W ]
)""] ^
;""^ _
sph## 
.## 
DefineSqlParameter## "
(##" #
$str### *
,##* +
	SqlDbType##, 5
.##5 6
NVarChar##6 >
,##> ?
$num##@ C
,##C D
ParameterDirection##E W
.##W X
Input##X ]
,##] ^
path##_ c
)##c d
;##d e
sph$$ 
.$$ 
DefineSqlParameter$$ "
($$" #
$str$$# ,
,$$, -
	SqlDbType$$. 7
.$$7 8
UniqueIdentifier$$8 H
,$$H I
ParameterDirection$$J \
.$$\ ]
Input$$] b
,$$b c
userGuid$$d l
)$$l m
;$$m n
sph%% 
.%% 
DefineSqlParameter%% "
(%%" #
$str%%# 2
,%%2 3
	SqlDbType%%4 =
.%%= >
	VarBinary%%> G
,%%G H
-%%I J
$num%%J K
,%%K L
ParameterDirection%%M _
.%%_ `
Input%%` e
,%%e f
dataBlob%%g o
)%%o p
;%%p q
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# 0
,&&0 1
	SqlDbType&&2 ;
.&&; <
DateTime&&< D
,&&D E
ParameterDirection&&F X
.&&X Y
Input&&Y ^
,&&^ _
lastUpdateTime&&` n
)&&n o
;&&o p
sph'' 
.'' 
ExecuteNonQuery'' 
(''  
)''  !
;''! "
}(( 	
public** 
static** 
byte** 
[** 
]** "
GetPersonalizationBlob** 3
(**3 4
int++ 
siteId++ 
,++ 
String,, 
path,, 
,,, 
Guid-- 
userGuid-- 
)-- 
{.. 	
SqlParameterHelper// 
sph// "
=//# $
new//% (
SqlParameterHelper//) ;
(//; <
ConnectionString//< L
.//L M#
GetReadConnectionString//M d
(//d e
)//e f
,//f g
$str	//h 
,
// 
$num
// 
)
// 
;
// 
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# ,
,00, -
	SqlDbType00. 7
.007 8
Int008 ;
,00; <
ParameterDirection00= O
.00O P
Input00P U
,00U V
siteId00W ]
)00] ^
;00^ _
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
NVarChar116 >
,11> ?
$num11@ C
,11C D
ParameterDirection11E W
.11W X
Input11X ]
,11] ^
path11_ c
)11c d
;11d e
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# ,
,22, -
	SqlDbType22. 7
.227 8
UniqueIdentifier228 H
,22H I
ParameterDirection22J \
.22\ ]
Input22] b
,22b c
userGuid22d l
)22l m
;22m n
byte33 
[33 
]33 
result33 
=33 
(33 
byte33 !
[33! "
]33" #
)33# $
sph33$ '
.33' (
ExecuteScalar33( 5
(335 6
)336 7
;337 8
return44 
result44 
;44 
}55 	
public77 
static77 
void77 $
ResetPersonalizationBlob77 3
(773 4
int88 
siteId88 
,88 
String99 
path99 
,99 
Guid:: 
userGuid:: 
):: 
{;; 	
SqlParameterHelper<< 
sph<< "
=<<# $
new<<% (
SqlParameterHelper<<) ;
(<<; <
ConnectionString<<< L
.<<L M$
GetWriteConnectionString<<M e
(<<e f
)<<f g
,<<g h
$str	<<i 
,
<< 
$num
<< 
)
<< 
;
<< 
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# ,
,==, -
	SqlDbType==. 7
.==7 8
Int==8 ;
,==; <
ParameterDirection=== O
.==O P
Input==P U
,==U V
siteId==W ]
)==] ^
;==^ _
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># *
,>>* +
	SqlDbType>>, 5
.>>5 6
NVarChar>>6 >
,>>> ?
$num>>@ C
,>>C D
ParameterDirection>>E W
.>>W X
Input>>X ]
,>>] ^
path>>_ c
)>>c d
;>>d e
sph?? 
.?? 
DefineSqlParameter?? "
(??" #
$str??# ,
,??, -
	SqlDbType??. 7
.??7 8
UniqueIdentifier??8 H
,??H I
ParameterDirection??J \
.??\ ]
Input??] b
,??b c
userGuid??d l
)??l m
;??m n
sph@@ 
.@@ 
ExecuteNonQuery@@ 
(@@  
)@@  !
;@@! "
}AA 	
publicCC 
staticCC 
voidCC $
ResetPersonalizationBlobCC 3
(CC3 4
intDD 
siteIdDD 
,DD 
StringEE 
pathEE 
)EE 
{FF 	
StringBuilderHH 

sqlCommandHH $
=HH% &
newHH' *
StringBuilderHH+ 8
(HH8 9
)HH9 :
;HH: ;

sqlCommandII 
.II 
AppendII 
(II 
$strII (
)II( )
;II) *

sqlCommandJJ 
.JJ 
AppendJJ 
(JJ 
$strJJ E
)JJE F
;JJF G

sqlCommandKK 
.KK 
AppendKK 
(KK 
$strKK 4
)KK4 5
;KK5 6

sqlCommandLL 
.LL 
AppendLL 
(LL 
$strLL 1
)LL1 2
;LL2 3

sqlCommandMM 
.MM 
AppendMM 
(MM 
$strMM 5
)MM5 6
;MM6 7

sqlCommandNN 
.NN 
AppendNN 
(NN 
$strNN 8
)NN8 9
;NN9 :

sqlCommandOO 
.OO 
AppendOO 
(OO 
$strOO $
)OO$ %
;OO% &
SqlParameterHelperQQ 
sphQQ "
=QQ# $
newQQ% (
SqlParameterHelperQQ) ;
(QQ; <
ConnectionStringQQ< L
.QQL M$
GetWriteConnectionStringQQM e
(QQe f
)QQf g
,QQg h

sqlCommandQQi s
.QQs t
ToStringQQt |
(QQ| }
)QQ} ~
,QQ~ 
CommandType
QQ 
.
QQ 
Text
QQ 
,
QQ 
$num
QQ 
)
QQ 
;
QQ 
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# ,
,RR, -
	SqlDbTypeRR. 7
.RR7 8
IntRR8 ;
,RR; <
ParameterDirectionRR= O
.RRO P
InputRRP U
,RRU V
siteIdRRW ]
)RR] ^
;RR^ _
sphTT 
.TT 
ExecuteNonQueryTT 
(TT  
)TT  !
;TT! "
}UU 	
publicWW 
staticWW 
byteWW 
[WW 
]WW *
GetPersonalizationBlobAllUsersWW ;
(WW; <
intXX 
siteIdXX 
,XX 
StringYY 
pathYY 
)YY 
{ZZ 	
SqlParameterHelper[[ 
sph[[ "
=[[# $
new[[% (
SqlParameterHelper[[) ;
([[; <
ConnectionString[[< L
.[[L M#
GetReadConnectionString[[M d
([[d e
)[[e f
,[[f g
$str	[[h 
,
[[ 
$num
[[ 
)
[[ 
;
[[ 
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# ,
,\\, -
	SqlDbType\\. 7
.\\7 8
Int\\8 ;
,\\; <
ParameterDirection\\= O
.\\O P
Input\\P U
,\\U V
siteId\\W ]
)\\] ^
;\\^ _
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# *
,]]* +
	SqlDbType]], 5
.]]5 6
NVarChar]]6 >
,]]> ?
$num]]@ C
,]]C D
ParameterDirection]]E W
.]]W X
Input]]X ]
,]]] ^
path]]_ c
)]]c d
;]]d e
byte__ 
[__ 
]__ 
result__ 
=__ 
(__ 
byte__ !
[__! "
]__" #
)__# $
sph__$ '
.__' (
ExecuteScalar__( 5
(__5 6
)__6 7
;__7 8
return`` 
result`` 
;`` 
}aa 	
publiccc 
staticcc 
voidcc +
SavePersonalizationBlobAllUserscc :
(cc: ;
intdd 
siteIddd 
,dd 
Stringee 
pathee 
,ee 
byteff 
[ff 
]ff 
dataBlobff 
,ff 
DateTimegg 
lastUpdateTimegg #
)gg# $
{hh 	
SqlParameterHelperii 
sphii "
=ii# $
newii% (
SqlParameterHelperii) ;
(ii; <
ConnectionStringii< L
.iiL M$
GetWriteConnectionStringiiM e
(iie f
)iif g
,iig h
$str	iii 
,
ii 
$num
ii 
)
ii 
;
ii 
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# ,
,jj, -
	SqlDbTypejj. 7
.jj7 8
Intjj8 ;
,jj; <
ParameterDirectionjj= O
.jjO P
InputjjP U
,jjU V
siteIdjjW ]
)jj] ^
;jj^ _
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# *
,kk* +
	SqlDbTypekk, 5
.kk5 6
NVarCharkk6 >
,kk> ?
$numkk@ C
,kkC D
ParameterDirectionkkE W
.kkW X
InputkkX ]
,kk] ^
pathkk_ c
)kkc d
;kkd e
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 2
,ll2 3
	SqlDbTypell4 =
.ll= >
	VarBinaryll> G
,llG H
-llI J
$numllJ K
,llK L
ParameterDirectionllM _
.ll_ `
Inputll` e
,lle f
dataBlobllg o
)llo p
;llp q
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 0
,mm0 1
	SqlDbTypemm2 ;
.mm; <
DateTimemm< D
,mmD E
ParameterDirectionmmF X
.mmX Y
InputmmY ^
,mm^ _
lastUpdateTimemm` n
)mmn o
;mmo p
sphnn 
.nn 
ExecuteNonQuerynn 
(nn  
)nn  !
;nn! "
}qq 	
publicss 
staticss 
intss 
GetCountOfStatess )
(ss) *
inttt 
siteIdtt 
,tt 
Stringuu 
pathuu 
,uu 
boolvv 
allUserScopevv 
,vv 
Guidww 
userGuidww 
,ww 
DateTimexx 
inactiveSincexx "
)xx" #
{yy 	
SqlParameterHelperzz 
sphzz "
=zz# $
newzz% (
SqlParameterHelperzz) ;
(zz; <
ConnectionStringzz< L
.zzL M#
GetReadConnectionStringzzM d
(zzd e
)zze f
,zzf g
$str	zzh 
,
zz 
$num
zz  ¡
)
zz¡ ¢
;
zz¢ £
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# ,
,{{, -
	SqlDbType{{. 7
.{{7 8
Int{{8 ;
,{{; <
ParameterDirection{{= O
.{{O P
Input{{P U
,{{U V
siteId{{W ]
){{] ^
;{{^ _
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# *
,||* +
	SqlDbType||, 5
.||5 6
NVarChar||6 >
,||> ?
$num||@ C
,||C D
ParameterDirection||E W
.||W X
Input||X ]
,||] ^
path||_ c
)||c d
;||d e
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
Bit}}? B
,}}B C
ParameterDirection}}D V
.}}V W
Input}}W \
,}}\ ]
allUserScope}}^ j
)}}j k
;}}k l
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# ,
,~~, -
	SqlDbType~~. 7
.~~7 8
UniqueIdentifier~~8 H
,~~H I
ParameterDirection~~J \
.~~\ ]
Input~~] b
,~~b c
userGuid~~d l
)~~l m
;~~m n
sph 
. 
DefineSqlParameter "
(" #
$str# 7
,7 8
	SqlDbType9 B
.B C
DateTimeC K
,K L
ParameterDirectionM _
._ `
Input` e
,e f
inactiveSinceg t
)t u
;u v
int
 
result
 
=
 
Convert
  
.
  !
ToInt32
! (
(
( )
sph
) ,
.
, -
ExecuteScalar
- :
(
: ;
)
; <
)
< =
;
= >
return
 
result
 
;
 
}
 	
}
ÇÇ 
}ÈÈ â
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteSettings.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteSettings &
{ 
public 
static 
int 
Create  
(  !
Guid 
siteGuid 
, 
String 
siteName 
, 
String   
skin   
,   
String!! 
logo!! 
,!! 
String"" 
icon"" 
,"" 
bool##  
allowNewRegistration## %
,##% &
bool$$ 
allowUserSkins$$ 
,$$  
bool%% 
allowPageSkins%% 
,%%  
bool&&  
allowHideMenuOnPages&& %
,&&% &
bool'' !
useSecureRegistration'' &
,''& '
bool(( 
useSslOnAllPages(( !
,((! "
String)) 
defaultPageKeywords)) &
,))& '
String** "
defaultPageDescription** )
,**) *
String++ 
defaultPageEncoding++ &
,++& '
String,, %
defaultAdditionalMetaTags,, ,
,,,, -
bool-- 
isServerAdminSite-- "
,--" #
bool.. 
useLdapAuth.. 
,.. 
bool// *
autoCreateLdapUserOnFirstLogin// /
,/// 0
String00 

ldapServer00 
,00 
int11 
ldapPort11 
,11 
String22 

ldapDomain22 
,22 
String33 

ldapRootDN33 
,33 
String44 
ldapUserDNKey44  
,44  !
bool55 #
allowUserFullNameChange55 (
,55( )
bool66 
useEmailForLogin66 !
,66! "
bool77 
reallyDeleteUsers77 "
,77" #
String88 

editorSkin88 
,88 
String99 %
defaultFriendlyUrlPattern99 ,
,99, -
bool:: 
enableMyPageFeature:: $
,::$ %
string;; 
editorProvider;; !
,;;! "
string<< 
datePickerProvider<< %
,<<% &
string== 
captchaProvider== "
,==" #
string>> 
recaptchaPrivateKey>> &
,>>& '
string?? 
recaptchaPublicKey?? %
,??% &
string@@ 
wordpressApiKey@@ "
,@@" #
stringAA 
windowsLiveAppIdAA #
,AA# $
stringBB 
windowsLiveKeyBB !
,BB! "
boolCC 
allowOpenIdAuthCC  
,CC  !
boolDD  
allowWindowsLiveAuthDD %
,DD% &
stringEE 

gmapApiKeyEE 
,EE 
stringFF 
apiKeyExtra1FF 
,FF  
stringGG 
apiKeyExtra2GG 
,GG  
stringHH 
apiKeyExtra3HH 
,HH  
stringII 
apiKeyExtra4II 
,II  
stringJJ 
apiKeyExtra5JJ 
,JJ  
boolKK 
disableDbAuthKK 
)KK 
{LL 	
SqlParameterHelperNN 
sphNN "
=NN# $
newNN% (
SqlParameterHelperNN) ;
(NN; <
ConnectionStringNN< L
.NNL M$
GetWriteConnectionStringNNM e
(NNe f
)NNf g
,NNg h
$strNNi z
,NNz {
$numNN| ~
)NN~ 
;	NN 
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# .
,OO. /
	SqlDbTypeOO0 9
.OO9 :
NVarCharOO: B
,OOB C
$numOOD G
,OOG H
ParameterDirectionOOI [
.OO[ \
InputOO\ a
,OOa b
siteNameOOc k
)OOk l
;OOl m
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
skinPP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
NVarCharQQ6 >
,QQ> ?
$numQQ@ B
,QQB C
ParameterDirectionQQD V
.QQV W
InputQQW \
,QQ\ ]
logoQQ^ b
)QQb c
;QQc d
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# *
,RR* +
	SqlDbTypeRR, 5
.RR5 6
NVarCharRR6 >
,RR> ?
$numRR@ B
,RRB C
ParameterDirectionRRD V
.RRV W
InputRRW \
,RR\ ]
iconRR^ b
)RRb c
;RRc d
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 4
,SS4 5
	SqlDbTypeSS6 ?
.SS? @
BitSS@ C
,SSC D
ParameterDirectionSSE W
.SSW X
InputSSX ]
,SS] ^
allowUserSkinsSS_ m
)SSm n
;SSn o
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# :
,TT: ;
	SqlDbTypeTT< E
.TTE F
BitTTF I
,TTI J
ParameterDirectionTTK ]
.TT] ^
InputTT^ c
,TTc d 
allowNewRegistrationTTe y
)TTy z
;TTz {
sphUU 
.UU 
DefineSqlParameterUU "
(UU" #
$strUU# ;
,UU; <
	SqlDbTypeUU= F
.UUF G
BitUUG J
,UUJ K
ParameterDirectionUUL ^
.UU^ _
InputUU_ d
,UUd e!
useSecureRegistrationUUf {
)UU{ |
;UU| }
sphVV 
.VV 
DefineSqlParameterVV "
(VV" #
$strVV# 6
,VV6 7
	SqlDbTypeVV8 A
.VVA B
BitVVB E
,VVE F
ParameterDirectionVVG Y
.VVY Z
InputVVZ _
,VV_ `
useSslOnAllPagesVVa q
)VVq r
;VVr s
sphWW 
.WW 
DefineSqlParameterWW "
(WW" #
$strWW# 9
,WW9 :
	SqlDbTypeWW; D
.WWD E
NVarCharWWE M
,WWM N
$numWWO R
,WWR S
ParameterDirectionWWT f
.WWf g
InputWWg l
,WWl m 
defaultPageKeywords	WWn 
)
WW 
;
WW 
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# <
,XX< =
	SqlDbTypeXX> G
.XXG H
NVarCharXXH P
,XXP Q
$numXXR U
,XXU V
ParameterDirectionXXW i
.XXi j
InputXXj o
,XXo p#
defaultPageDescription	XXq 
)
XX 
;
XX 
sphYY 
.YY 
DefineSqlParameterYY "
(YY" #
$strYY# 9
,YY9 :
	SqlDbTypeYY; D
.YYD E
NVarCharYYE M
,YYM N
$numYYO R
,YYR S
ParameterDirectionYYT f
.YYf g
InputYYg l
,YYl m 
defaultPageEncoding	YYn 
)
YY 
;
YY 
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# ?
,ZZ? @
	SqlDbTypeZZA J
.ZZJ K
NVarCharZZK S
,ZZS T
$numZZU X
,ZZX Y
ParameterDirectionZZZ l
.ZZl m
InputZZm r
,ZZr s&
defaultAdditionalMetaTags	ZZt 
)
ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# 7
,[[7 8
	SqlDbType[[9 B
.[[B C
Bit[[C F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
isServerAdminSite[[b s
)[[s t
;[[t u
sph\\ 
.\\ 
DefineSqlParameter\\ "
(\\" #
$str\\# 4
,\\4 5
	SqlDbType\\6 ?
.\\? @
Bit\\@ C
,\\C D
ParameterDirection\\E W
.\\W X
Input\\X ]
,\\] ^
allowPageSkins\\_ m
)\\m n
;\\n o
sph]] 
.]] 
DefineSqlParameter]] "
(]]" #
$str]]# :
,]]: ;
	SqlDbType]]< E
.]]E F
Bit]]F I
,]]I J
ParameterDirection]]K ]
.]]] ^
Input]]^ c
,]]c d 
allowHideMenuOnPages]]e y
)]]y z
;]]z {
sph^^ 
.^^ 
DefineSqlParameter^^ "
(^^" #
$str^^# 1
,^^1 2
	SqlDbType^^3 <
.^^< =
Bit^^= @
,^^@ A
ParameterDirection^^B T
.^^T U
Input^^U Z
,^^Z [
useLdapAuth^^\ g
)^^g h
;^^h i
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# D
,__D E
	SqlDbType__F O
.__O P
Bit__P S
,__S T
ParameterDirection__U g
.__g h
Input__h m
,__m n+
autoCreateLdapUserOnFirstLogin	__o 
)
__ 
;
__ 
sph`` 
.`` 
DefineSqlParameter`` "
(``" #
$str``# 0
,``0 1
	SqlDbType``2 ;
.``; <
NVarChar``< D
,``D E
$num``F I
,``I J
ParameterDirection``K ]
.``] ^
Input``^ c
,``c d

ldapServer``e o
)``o p
;``p q
sphaa 
.aa 
DefineSqlParameteraa "
(aa" #
$straa# .
,aa. /
	SqlDbTypeaa0 9
.aa9 :
Intaa: =
,aa= >
ParameterDirectionaa? Q
.aaQ R
InputaaR W
,aaW X
ldapPortaaY a
)aaa b
;aab c
sphbb 
.bb 
DefineSqlParameterbb "
(bb" #
$strbb# 0
,bb0 1
	SqlDbTypebb2 ;
.bb; <
NVarCharbb< D
,bbD E
$numbbF I
,bbI J
ParameterDirectionbbK ]
.bb] ^
Inputbb^ c
,bbc d

ldapDomainbbe o
)bbo p
;bbp q
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# 0
,cc0 1
	SqlDbTypecc2 ;
.cc; <
NVarCharcc< D
,ccD E
$numccF I
,ccI J
ParameterDirectionccK ]
.cc] ^
Inputcc^ c
,ccc d

ldapRootDNcce o
)cco p
;ccp q
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# 3
,dd3 4
	SqlDbTypedd5 >
.dd> ?
NVarChardd? G
,ddG H
$numddI K
,ddK L
ParameterDirectionddM _
.dd_ `
Inputdd` e
,dde f
ldapUserDNKeyddg t
)ddt u
;ddu v
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# =
,ee= >
	SqlDbTypeee? H
.eeH I
BiteeI L
,eeL M
ParameterDirectioneeN `
.ee` a
Inputeea f
,eef g#
allowUserFullNameChangeeeh 
)	ee 
;
ee 
sphff 
.ff 
DefineSqlParameterff "
(ff" #
$strff# 6
,ff6 7
	SqlDbTypeff8 A
.ffA B
BitffB E
,ffE F
ParameterDirectionffG Y
.ffY Z
InputffZ _
,ff_ `
useEmailForLoginffa q
)ffq r
;ffr s
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 7
,gg7 8
	SqlDbTypegg9 B
.ggB C
BitggC F
,ggF G
ParameterDirectionggH Z
.ggZ [
Inputgg[ `
,gg` a
reallyDeleteUsersggb s
)ggs t
;ggt u
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# 0
,hh0 1
	SqlDbTypehh2 ;
.hh; <
NVarCharhh< D
,hhD E
$numhhF H
,hhH I
ParameterDirectionhhJ \
.hh\ ]
Inputhh] b
,hhb c

editorSkinhhd n
)hhn o
;hho p
sphii 
.ii 
DefineSqlParameterii "
(ii" #
$strii# C
,iiC D
	SqlDbTypeiiE N
.iiN O
NVarChariiO W
,iiW X
$numiiY [
,ii[ \
ParameterDirectionii] o
.iio p
Inputiip u
,iiu v&
defaultFriendlyUrlPattern	iiw 
)
ii 
;
ii 
sphjj 
.jj 
DefineSqlParameterjj "
(jj" #
$strjj# .
,jj. /
	SqlDbTypejj0 9
.jj9 :
UniqueIdentifierjj: J
,jjJ K
ParameterDirectionjjL ^
.jj^ _
Inputjj_ d
,jjd e
siteGuidjjf n
)jjn o
;jjo p
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# 9
,kk9 :
	SqlDbTypekk; D
.kkD E
BitkkE H
,kkH I
ParameterDirectionkkJ \
.kk\ ]
Inputkk] b
,kkb c
enableMyPageFeaturekkd w
)kkw x
;kkx y
sphll 
.ll 
DefineSqlParameterll "
(ll" #
$strll# 4
,ll4 5
	SqlDbTypell6 ?
.ll? @
NVarCharll@ H
,llH I
$numllJ M
,llM N
ParameterDirectionllO a
.lla b
Inputllb g
,llg h
editorProviderlli w
)llw x
;llx y
sphmm 
.mm 
DefineSqlParametermm "
(mm" #
$strmm# 8
,mm8 9
	SqlDbTypemm: C
.mmC D
NVarCharmmD L
,mmL M
$nummmN Q
,mmQ R
ParameterDirectionmmS e
.mme f
Inputmmf k
,mmk l
datePickerProvidermmm 
)	mm 
;
mm 
sphnn 
.nn 
DefineSqlParameternn "
(nn" #
$strnn# 5
,nn5 6
	SqlDbTypenn7 @
.nn@ A
NVarCharnnA I
,nnI J
$numnnK N
,nnN O
ParameterDirectionnnP b
.nnb c
Inputnnc h
,nnh i
captchaProvidernnj y
)nny z
;nnz {
sphoo 
.oo 
DefineSqlParameteroo "
(oo" #
$stroo# 9
,oo9 :
	SqlDbTypeoo; D
.ooD E
NVarCharooE M
,ooM N
$numooO R
,ooR S
ParameterDirectionooT f
.oof g
Inputoog l
,ool m 
recaptchaPrivateKey	oon 
)
oo 
;
oo 
sphpp 
.pp 
DefineSqlParameterpp "
(pp" #
$strpp# 8
,pp8 9
	SqlDbTypepp: C
.ppC D
NVarCharppD L
,ppL M
$numppN Q
,ppQ R
ParameterDirectionppS e
.ppe f
Inputppf k
,ppk l
recaptchaPublicKeyppm 
)	pp 
;
pp 
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# 5
,qq5 6
	SqlDbTypeqq7 @
.qq@ A
NVarCharqqA I
,qqI J
$numqqK N
,qqN O
ParameterDirectionqqP b
.qqb c
Inputqqc h
,qqh i
wordpressApiKeyqqj y
)qqy z
;qqz {
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 6
,rr6 7
	SqlDbTyperr8 A
.rrA B
NVarCharrrB J
,rrJ K
$numrrL O
,rrO P
ParameterDirectionrrQ c
.rrc d
Inputrrd i
,rri j
windowsLiveAppIdrrk {
)rr{ |
;rr| }
sphss 
.ss 
DefineSqlParameterss "
(ss" #
$strss# 4
,ss4 5
	SqlDbTypess6 ?
.ss? @
NVarCharss@ H
,ssH I
$numssJ M
,ssM N
ParameterDirectionssO a
.ssa b
Inputssb g
,ssg h
windowsLiveKeyssi w
)ssw x
;ssx y
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# 5
,tt5 6
	SqlDbTypett7 @
.tt@ A
BitttA D
,ttD E
ParameterDirectionttF X
.ttX Y
InputttY ^
,tt^ _
allowOpenIdAuthtt` o
)tto p
;ttp q
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# :
,uu: ;
	SqlDbTypeuu< E
.uuE F
BituuF I
,uuI J
ParameterDirectionuuK ]
.uu] ^
Inputuu^ c
,uuc d 
allowWindowsLiveAuthuue y
)uuy z
;uuz {
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 0
,ww0 1
	SqlDbTypeww2 ;
.ww; <
NVarCharww< D
,wwD E
$numwwF I
,wwI J
ParameterDirectionwwK ]
.ww] ^
Inputww^ c
,wwc d

gmapApiKeywwe o
)wwo p
;wwp q
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 2
,xx2 3
	SqlDbTypexx4 =
.xx= >
NVarCharxx> F
,xxF G
$numxxH K
,xxK L
ParameterDirectionxxM _
.xx_ `
Inputxx` e
,xxe f
apiKeyExtra1xxg s
)xxs t
;xxt u
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# 2
,yy2 3
	SqlDbTypeyy4 =
.yy= >
NVarCharyy> F
,yyF G
$numyyH K
,yyK L
ParameterDirectionyyM _
.yy_ `
Inputyy` e
,yye f
apiKeyExtra2yyg s
)yys t
;yyt u
sphzz 
.zz 
DefineSqlParameterzz "
(zz" #
$strzz# 2
,zz2 3
	SqlDbTypezz4 =
.zz= >
NVarCharzz> F
,zzF G
$numzzH K
,zzK L
ParameterDirectionzzM _
.zz_ `
Inputzz` e
,zze f
apiKeyExtra3zzg s
)zzs t
;zzt u
sph{{ 
.{{ 
DefineSqlParameter{{ "
({{" #
$str{{# 2
,{{2 3
	SqlDbType{{4 =
.{{= >
NVarChar{{> F
,{{F G
$num{{H K
,{{K L
ParameterDirection{{M _
.{{_ `
Input{{` e
,{{e f
apiKeyExtra4{{g s
){{s t
;{{t u
sph|| 
.|| 
DefineSqlParameter|| "
(||" #
$str||# 2
,||2 3
	SqlDbType||4 =
.||= >
NVarChar||> F
,||F G
$num||H K
,||K L
ParameterDirection||M _
.||_ `
Input||` e
,||e f
apiKeyExtra5||g s
)||s t
;||t u
sph}} 
.}} 
DefineSqlParameter}} "
(}}" #
$str}}# 3
,}}3 4
	SqlDbType}}5 >
.}}> ?
Bit}}? B
,}}B C
ParameterDirection}}D V
.}}V W
Input}}W \
,}}\ ]
disableDbAuth}}^ k
)}}k l
;}}l m
int 
newID 
= 
Convert 
.  
ToInt32  '
(' (
sph( +
.+ ,
ExecuteScalar, 9
(9 :
): ;
); <
;< =
return
 
newID
 
;
 
}
 	
public
 
static
 
bool
 
Update
 !
(
! "
int
 
siteId
 
,
 
string
 
siteName
 
,
 
string
 
skin
 
,
 
string
 
logo
 
,
 
string
 
icon
 
,
 
bool
 "
allowNewRegistration
 %
,
% &
bool
 
allowUserSkins
 
,
  
bool
 
allowPageSkins
 
,
  
bool
 "
allowHideMenuOnPages
 %
,
% &
bool
 #
useSecureRegistration
 &
,
& '
bool
 
useSslOnAllPages
 !
,
! "
string
 !
defaultPageKeywords
 &
,
& '
string
 $
defaultPageDescription
 )
,
) *
string
 !
defaultPageEncoding
 &
,
& '
string
 '
defaultAdditionalMetaTags
 ,
,
, -
bool
 
isServerAdminSite
 "
,
" #
bool
 
useLdapAuth
 
,
 
bool
 ,
autoCreateLdapUserOnFirstLogin
 /
,
/ 0
string
 

ldapServer
 
,
 
int
 
ldapPort
 
,
 
String
 

ldapDomain
 
,
 
string
 

ldapRootDN
 
,
 
string
 
ldapUserDNKey
  
,
  !
bool
 %
allowUserFullNameChange
 (
,
( )
bool
 
useEmailForLogin
 !
,
! "
bool
 
reallyDeleteUsers
 "
,
" #
String
 

editorSkin
 
,
 
String
 '
defaultFriendlyUrlPattern
 ,
,
, -
bool
   !
enableMyPageFeature
   $
,
  $ %
string
¡¡ 
editorProvider
¡¡ !
,
¡¡! "
string
¢¢  
datePickerProvider
¢¢ %
,
¢¢% &
string
££ 
captchaProvider
££ "
,
££" #
string
¤¤ !
recaptchaPrivateKey
¤¤ &
,
¤¤& '
string
¥¥  
recaptchaPublicKey
¥¥ %
,
¥¥% &
string
¦¦ 
wordpressApiKey
¦¦ "
,
¦¦" #
string
§§ 
windowsLiveAppId
§§ #
,
§§# $
string
¨¨ 
windowsLiveKey
¨¨ !
,
¨¨! "
bool
©© 
allowOpenIdAuth
©©  
,
©©  !
bool
ªª "
allowWindowsLiveAuth
ªª %
,
ªª% &
string
«« 

gmapApiKey
«« 
,
«« 
string
¬¬ 
apiKeyExtra1
¬¬ 
,
¬¬  
string
­­ 
apiKeyExtra2
­­ 
,
­­  
string
®® 
apiKeyExtra3
®® 
,
®®  
string
¯¯ 
apiKeyExtra4
¯¯ 
,
¯¯  
string
°° 
apiKeyExtra5
°° 
,
°°  
bool
±± 
disableDbAuth
±± 
)
±± 
{
²² 	 
SqlParameterHelper
´´ 
sph
´´ "
=
´´# $
new
´´% ( 
SqlParameterHelper
´´) ;
(
´´; <
ConnectionString
´´< L
.
´´L M&
GetWriteConnectionString
´´M e
(
´´e f
)
´´f g
,
´´g h
$str
´´i z
,
´´z {
$num
´´| ~
)
´´~ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# ,
,
µµ, -
	SqlDbType
µµ. 7
.
µµ7 8
Int
µµ8 ;
,
µµ; < 
ParameterDirection
µµ= O
.
µµO P
Input
µµP U
,
µµU V
siteId
µµW ]
)
µµ] ^
;
µµ^ _
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
NVarChar
¶¶: B
,
¶¶B C
$num
¶¶D G
,
¶¶G H 
ParameterDirection
¶¶I [
.
¶¶[ \
Input
¶¶\ a
,
¶¶a b
siteName
¶¶c k
)
¶¶k l
;
¶¶l m
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# *
,
··* +
	SqlDbType
··, 5
.
··5 6
NVarChar
··6 >
,
··> ?
$num
··@ C
,
··C D 
ParameterDirection
··E W
.
··W X
Input
··X ]
,
··] ^
skin
··_ c
)
··c d
;
··d e
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# *
,
¸¸* +
	SqlDbType
¸¸, 5
.
¸¸5 6
NVarChar
¸¸6 >
,
¸¸> ?
$num
¸¸@ B
,
¸¸B C 
ParameterDirection
¸¸D V
.
¸¸V W
Input
¸¸W \
,
¸¸\ ]
logo
¸¸^ b
)
¸¸b c
;
¸¸c d
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# *
,
¹¹* +
	SqlDbType
¹¹, 5
.
¹¹5 6
NVarChar
¹¹6 >
,
¹¹> ?
$num
¹¹@ B
,
¹¹B C 
ParameterDirection
¹¹D V
.
¹¹V W
Input
¹¹W \
,
¹¹\ ]
icon
¹¹^ b
)
¹¹b c
;
¹¹c d
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# :
,
ºº: ;
	SqlDbType
ºº< E
.
ººE F
Bit
ººF I
,
ººI J 
ParameterDirection
ººK ]
.
ºº] ^
Input
ºº^ c
,
ººc d"
allowNewRegistration
ººe y
)
ººy z
;
ººz {
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 4
,
»»4 5
	SqlDbType
»»6 ?
.
»»? @
Bit
»»@ C
,
»»C D 
ParameterDirection
»»E W
.
»»W X
Input
»»X ]
,
»»] ^
allowUserSkins
»»_ m
)
»»m n
;
»»n o
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ "
(
¼¼" #
$str
¼¼# ;
,
¼¼; <
	SqlDbType
¼¼= F
.
¼¼F G
Bit
¼¼G J
,
¼¼J K 
ParameterDirection
¼¼L ^
.
¼¼^ _
Input
¼¼_ d
,
¼¼d e#
useSecureRegistration
¼¼f {
)
¼¼{ |
;
¼¼| }
sph
½½ 
.
½½  
DefineSqlParameter
½½ "
(
½½" #
$str
½½# 6
,
½½6 7
	SqlDbType
½½8 A
.
½½A B
Bit
½½B E
,
½½E F 
ParameterDirection
½½G Y
.
½½Y Z
Input
½½Z _
,
½½_ `
useSslOnAllPages
½½a q
)
½½q r
;
½½r s
sph
¾¾ 
.
¾¾  
DefineSqlParameter
¾¾ "
(
¾¾" #
$str
¾¾# 9
,
¾¾9 :
	SqlDbType
¾¾; D
.
¾¾D E
NVarChar
¾¾E M
,
¾¾M N
$num
¾¾O R
,
¾¾R S 
ParameterDirection
¾¾T f
.
¾¾f g
Input
¾¾g l
,
¾¾l m"
defaultPageKeywords¾¾n 
)¾¾ 
;¾¾ 
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# <
,
¿¿< =
	SqlDbType
¿¿> G
.
¿¿G H
NVarChar
¿¿H P
,
¿¿P Q
$num
¿¿R U
,
¿¿U V 
ParameterDirection
¿¿W i
.
¿¿i j
Input
¿¿j o
,
¿¿o p%
defaultPageDescription¿¿q 
)¿¿ 
;¿¿ 
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 9
,
ÀÀ9 :
	SqlDbType
ÀÀ; D
.
ÀÀD E
NVarChar
ÀÀE M
,
ÀÀM N
$num
ÀÀO R
,
ÀÀR S 
ParameterDirection
ÀÀT f
.
ÀÀf g
Input
ÀÀg l
,
ÀÀl m"
defaultPageEncodingÀÀn 
)ÀÀ 
;ÀÀ 
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ "
(
ÁÁ" #
$str
ÁÁ# ?
,
ÁÁ? @
	SqlDbType
ÁÁA J
.
ÁÁJ K
NVarChar
ÁÁK S
,
ÁÁS T
$num
ÁÁU X
,
ÁÁX Y 
ParameterDirection
ÁÁZ l
.
ÁÁl m
Input
ÁÁm r
,
ÁÁr s(
defaultAdditionalMetaTagsÁÁt 
)ÁÁ 
;ÁÁ 
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ "
(
ÂÂ" #
$str
ÂÂ# 7
,
ÂÂ7 8
	SqlDbType
ÂÂ9 B
.
ÂÂB C
Bit
ÂÂC F
,
ÂÂF G 
ParameterDirection
ÂÂH Z
.
ÂÂZ [
Input
ÂÂ[ `
,
ÂÂ` a
isServerAdminSite
ÂÂb s
)
ÂÂs t
;
ÂÂt u
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# 4
,
ÃÃ4 5
	SqlDbType
ÃÃ6 ?
.
ÃÃ? @
Bit
ÃÃ@ C
,
ÃÃC D 
ParameterDirection
ÃÃE W
.
ÃÃW X
Input
ÃÃX ]
,
ÃÃ] ^
allowPageSkins
ÃÃ_ m
)
ÃÃm n
;
ÃÃn o
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# :
,
ÄÄ: ;
	SqlDbType
ÄÄ< E
.
ÄÄE F
Bit
ÄÄF I
,
ÄÄI J 
ParameterDirection
ÄÄK ]
.
ÄÄ] ^
Input
ÄÄ^ c
,
ÄÄc d"
allowHideMenuOnPages
ÄÄe y
)
ÄÄy z
;
ÄÄz {
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ "
(
ÅÅ" #
$str
ÅÅ# 1
,
ÅÅ1 2
	SqlDbType
ÅÅ3 <
.
ÅÅ< =
Bit
ÅÅ= @
,
ÅÅ@ A 
ParameterDirection
ÅÅB T
.
ÅÅT U
Input
ÅÅU Z
,
ÅÅZ [
useLdapAuth
ÅÅ\ g
)
ÅÅg h
;
ÅÅh i
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ "
(
ÆÆ" #
$str
ÆÆ# D
,
ÆÆD E
	SqlDbType
ÆÆF O
.
ÆÆO P
Bit
ÆÆP S
,
ÆÆS T 
ParameterDirection
ÆÆU g
.
ÆÆg h
Input
ÆÆh m
,
ÆÆm n-
autoCreateLdapUserOnFirstLoginÆÆo 
)ÆÆ 
;ÆÆ 
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ "
(
ÇÇ" #
$str
ÇÇ# 0
,
ÇÇ0 1
	SqlDbType
ÇÇ2 ;
.
ÇÇ; <
NVarChar
ÇÇ< D
,
ÇÇD E
$num
ÇÇF I
,
ÇÇI J 
ParameterDirection
ÇÇK ]
.
ÇÇ] ^
Input
ÇÇ^ c
,
ÇÇc d

ldapServer
ÇÇe o
)
ÇÇo p
;
ÇÇp q
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# .
,
ÈÈ. /
	SqlDbType
ÈÈ0 9
.
ÈÈ9 :
Int
ÈÈ: =
,
ÈÈ= > 
ParameterDirection
ÈÈ? Q
.
ÈÈQ R
Input
ÈÈR W
,
ÈÈW X
ldapPort
ÈÈY a
)
ÈÈa b
;
ÈÈb c
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 0
,
ÉÉ0 1
	SqlDbType
ÉÉ2 ;
.
ÉÉ; <
NVarChar
ÉÉ< D
,
ÉÉD E
$num
ÉÉF I
,
ÉÉI J 
ParameterDirection
ÉÉK ]
.
ÉÉ] ^
Input
ÉÉ^ c
,
ÉÉc d

ldapRootDN
ÉÉe o
)
ÉÉo p
;
ÉÉp q
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 3
,
ÊÊ3 4
	SqlDbType
ÊÊ5 >
.
ÊÊ> ?
NVarChar
ÊÊ? G
,
ÊÊG H
$num
ÊÊI K
,
ÊÊK L 
ParameterDirection
ÊÊM _
.
ÊÊ_ `
Input
ÊÊ` e
,
ÊÊe f
ldapUserDNKey
ÊÊg t
)
ÊÊt u
;
ÊÊu v
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# =
,
ËË= >
	SqlDbType
ËË? H
.
ËËH I
Bit
ËËI L
,
ËËL M 
ParameterDirection
ËËN `
.
ËË` a
Input
ËËa f
,
ËËf g%
allowUserFullNameChange
ËËh 
)ËË 
;ËË 
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# 6
,
ÌÌ6 7
	SqlDbType
ÌÌ8 A
.
ÌÌA B
Bit
ÌÌB E
,
ÌÌE F 
ParameterDirection
ÌÌG Y
.
ÌÌY Z
Input
ÌÌZ _
,
ÌÌ_ `
useEmailForLogin
ÌÌa q
)
ÌÌq r
;
ÌÌr s
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ "
(
ÍÍ" #
$str
ÍÍ# 7
,
ÍÍ7 8
	SqlDbType
ÍÍ9 B
.
ÍÍB C
Bit
ÍÍC F
,
ÍÍF G 
ParameterDirection
ÍÍH Z
.
ÍÍZ [
Input
ÍÍ[ `
,
ÍÍ` a
reallyDeleteUsers
ÍÍb s
)
ÍÍs t
;
ÍÍt u
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ "
(
ÎÎ" #
$str
ÎÎ# 0
,
ÎÎ0 1
	SqlDbType
ÎÎ2 ;
.
ÎÎ; <
NVarChar
ÎÎ< D
,
ÎÎD E
$num
ÎÎF H
,
ÎÎH I 
ParameterDirection
ÎÎJ \
.
ÎÎ\ ]
Input
ÎÎ] b
,
ÎÎb c

editorSkin
ÎÎd n
)
ÎÎn o
;
ÎÎo p
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ "
(
ÏÏ" #
$str
ÏÏ# C
,
ÏÏC D
	SqlDbType
ÏÏE N
.
ÏÏN O
NVarChar
ÏÏO W
,
ÏÏW X
$num
ÏÏY [
,
ÏÏ[ \ 
ParameterDirection
ÏÏ] o
.
ÏÏo p
Input
ÏÏp u
,
ÏÏu v(
defaultFriendlyUrlPatternÏÏw 
)ÏÏ 
;ÏÏ 
sph
ÐÐ 
.
ÐÐ  
DefineSqlParameter
ÐÐ "
(
ÐÐ" #
$str
ÐÐ# 9
,
ÐÐ9 :
	SqlDbType
ÐÐ; D
.
ÐÐD E
Bit
ÐÐE H
,
ÐÐH I 
ParameterDirection
ÐÐJ \
.
ÐÐ\ ]
Input
ÐÐ] b
,
ÐÐb c!
enableMyPageFeature
ÐÐd w
)
ÐÐw x
;
ÐÐx y
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 0
,
ÑÑ0 1
	SqlDbType
ÑÑ2 ;
.
ÑÑ; <
NVarChar
ÑÑ< D
,
ÑÑD E
$num
ÑÑF I
,
ÑÑI J 
ParameterDirection
ÑÑK ]
.
ÑÑ] ^
Input
ÑÑ^ c
,
ÑÑc d

ldapDomain
ÑÑe o
)
ÑÑo p
;
ÑÑp q
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ "
(
ÒÒ" #
$str
ÒÒ# 4
,
ÒÒ4 5
	SqlDbType
ÒÒ6 ?
.
ÒÒ? @
NVarChar
ÒÒ@ H
,
ÒÒH I
$num
ÒÒJ M
,
ÒÒM N 
ParameterDirection
ÒÒO a
.
ÒÒa b
Input
ÒÒb g
,
ÒÒg h
editorProvider
ÒÒi w
)
ÒÒw x
;
ÒÒx y
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ "
(
ÓÓ" #
$str
ÓÓ# 8
,
ÓÓ8 9
	SqlDbType
ÓÓ: C
.
ÓÓC D
NVarChar
ÓÓD L
,
ÓÓL M
$num
ÓÓN Q
,
ÓÓQ R 
ParameterDirection
ÓÓS e
.
ÓÓe f
Input
ÓÓf k
,
ÓÓk l 
datePickerProvider
ÓÓm 
)ÓÓ 
;ÓÓ 
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# 5
,
ÔÔ5 6
	SqlDbType
ÔÔ7 @
.
ÔÔ@ A
NVarChar
ÔÔA I
,
ÔÔI J
$num
ÔÔK N
,
ÔÔN O 
ParameterDirection
ÔÔP b
.
ÔÔb c
Input
ÔÔc h
,
ÔÔh i
captchaProvider
ÔÔj y
)
ÔÔy z
;
ÔÔz {
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# 9
,
ÕÕ9 :
	SqlDbType
ÕÕ; D
.
ÕÕD E
NVarChar
ÕÕE M
,
ÕÕM N
$num
ÕÕO R
,
ÕÕR S 
ParameterDirection
ÕÕT f
.
ÕÕf g
Input
ÕÕg l
,
ÕÕl m"
recaptchaPrivateKeyÕÕn 
)ÕÕ 
;ÕÕ 
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# 8
,
ÖÖ8 9
	SqlDbType
ÖÖ: C
.
ÖÖC D
NVarChar
ÖÖD L
,
ÖÖL M
$num
ÖÖN Q
,
ÖÖQ R 
ParameterDirection
ÖÖS e
.
ÖÖe f
Input
ÖÖf k
,
ÖÖk l 
recaptchaPublicKey
ÖÖm 
)ÖÖ 
;ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× "
(
××" #
$str
××# 5
,
××5 6
	SqlDbType
××7 @
.
××@ A
NVarChar
××A I
,
××I J
$num
××K N
,
××N O 
ParameterDirection
××P b
.
××b c
Input
××c h
,
××h i
wordpressApiKey
××j y
)
××y z
;
××z {
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 6
,
ØØ6 7
	SqlDbType
ØØ8 A
.
ØØA B
NVarChar
ØØB J
,
ØØJ K
$num
ØØL O
,
ØØO P 
ParameterDirection
ØØQ c
.
ØØc d
Input
ØØd i
,
ØØi j
windowsLiveAppId
ØØk {
)
ØØ{ |
;
ØØ| }
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# 4
,
ÙÙ4 5
	SqlDbType
ÙÙ6 ?
.
ÙÙ? @
NVarChar
ÙÙ@ H
,
ÙÙH I
$num
ÙÙJ M
,
ÙÙM N 
ParameterDirection
ÙÙO a
.
ÙÙa b
Input
ÙÙb g
,
ÙÙg h
windowsLiveKey
ÙÙi w
)
ÙÙw x
;
ÙÙx y
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 5
,
ÚÚ5 6
	SqlDbType
ÚÚ7 @
.
ÚÚ@ A
Bit
ÚÚA D
,
ÚÚD E 
ParameterDirection
ÚÚF X
.
ÚÚX Y
Input
ÚÚY ^
,
ÚÚ^ _
allowOpenIdAuth
ÚÚ` o
)
ÚÚo p
;
ÚÚp q
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# :
,
ÛÛ: ;
	SqlDbType
ÛÛ< E
.
ÛÛE F
Bit
ÛÛF I
,
ÛÛI J 
ParameterDirection
ÛÛK ]
.
ÛÛ] ^
Input
ÛÛ^ c
,
ÛÛc d"
allowWindowsLiveAuth
ÛÛe y
)
ÛÛy z
;
ÛÛz {
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 0
,
ÜÜ0 1
	SqlDbType
ÜÜ2 ;
.
ÜÜ; <
NVarChar
ÜÜ< D
,
ÜÜD E
$num
ÜÜF I
,
ÜÜI J 
ParameterDirection
ÜÜK ]
.
ÜÜ] ^
Input
ÜÜ^ c
,
ÜÜc d

gmapApiKey
ÜÜe o
)
ÜÜo p
;
ÜÜp q
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# 2
,
ÝÝ2 3
	SqlDbType
ÝÝ4 =
.
ÝÝ= >
NVarChar
ÝÝ> F
,
ÝÝF G
$num
ÝÝH K
,
ÝÝK L 
ParameterDirection
ÝÝM _
.
ÝÝ_ `
Input
ÝÝ` e
,
ÝÝe f
apiKeyExtra1
ÝÝg s
)
ÝÝs t
;
ÝÝt u
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ "
(
ÞÞ" #
$str
ÞÞ# 2
,
ÞÞ2 3
	SqlDbType
ÞÞ4 =
.
ÞÞ= >
NVarChar
ÞÞ> F
,
ÞÞF G
$num
ÞÞH K
,
ÞÞK L 
ParameterDirection
ÞÞM _
.
ÞÞ_ `
Input
ÞÞ` e
,
ÞÞe f
apiKeyExtra2
ÞÞg s
)
ÞÞs t
;
ÞÞt u
sph
ßß 
.
ßß  
DefineSqlParameter
ßß "
(
ßß" #
$str
ßß# 2
,
ßß2 3
	SqlDbType
ßß4 =
.
ßß= >
NVarChar
ßß> F
,
ßßF G
$num
ßßH K
,
ßßK L 
ParameterDirection
ßßM _
.
ßß_ `
Input
ßß` e
,
ßße f
apiKeyExtra3
ßßg s
)
ßßs t
;
ßßt u
sph
àà 
.
àà  
DefineSqlParameter
àà "
(
àà" #
$str
àà# 2
,
àà2 3
	SqlDbType
àà4 =
.
àà= >
NVarChar
àà> F
,
ààF G
$num
ààH K
,
ààK L 
ParameterDirection
ààM _
.
àà_ `
Input
àà` e
,
ààe f
apiKeyExtra4
ààg s
)
ààs t
;
ààt u
sph
áá 
.
áá  
DefineSqlParameter
áá "
(
áá" #
$str
áá# 2
,
áá2 3
	SqlDbType
áá4 =
.
áá= >
NVarChar
áá> F
,
ááF G
$num
ááH K
,
ááK L 
ParameterDirection
ááM _
.
áá_ `
Input
áá` e
,
ááe f
apiKeyExtra5
áág s
)
áás t
;
áát u
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# 3
,
ââ3 4
	SqlDbType
ââ5 >
.
ââ> ?
Bit
ââ? B
,
ââB C 
ParameterDirection
ââD V
.
ââV W
Input
ââW \
,
ââ\ ]
disableDbAuth
ââ^ k
)
ââk l
;
ââl m
int
ãã 
rowsAffected
ãã 
=
ãã 
sph
ãã "
.
ãã" #
ExecuteNonQuery
ãã# 2
(
ãã2 3
)
ãã3 4
;
ãã4 5
return
ää 
(
ää 
rowsAffected
ää  
>
ää! "
-
ää# $
$num
ää$ %
)
ää% &
;
ää& '
}
åå 	
public
çç 
static
çç 
bool
çç &
UpdateExtendedProperties
çç 3
(
çç3 4
int
èè 
siteId
èè 
,
èè 
bool
éé $
allowPasswordRetrieval
éé '
,
éé' (
bool
êê  
allowPasswordReset
êê #
,
êê# $
bool
ëë '
requiresQuestionAndAnswer
ëë *
,
ëë* +
int
ìì (
maxInvalidPasswordAttempts
ìì *
,
ìì* +
int
íí *
passwordAttemptWindowMinutes
íí ,
,
íí, -
bool
îî !
requiresUniqueEmail
îî $
,
îî$ %
int
ïï 
passwordFormat
ïï 
,
ïï 
int
ðð '
minRequiredPasswordLength
ðð )
,
ðð) *
int
ññ 2
$minRequiredNonAlphanumericCharacters
ññ 4
,
ññ4 5
String
òò /
!passwordStrengthRegularExpression
òò 4
,
òò4 5
String
óó %
defaultEmailFromAddress
óó *
)
ôô 
{
õõ 	 
SqlParameterHelper
öö 
sph
öö "
=
öö# $
new
öö% ( 
SqlParameterHelper
öö) ;
(
öö; <
ConnectionString
öö< L
.
ööL M&
GetWriteConnectionString
ööM e
(
ööe f
)
ööf g
,
öög h
$strööi 
,öö 
$numöö 
)öö 
;öö 
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ "
(
÷÷" #
$str
÷÷# ,
,
÷÷, -
	SqlDbType
÷÷. 7
.
÷÷7 8
Int
÷÷8 ;
,
÷÷; < 
ParameterDirection
÷÷= O
.
÷÷O P
Input
÷÷P U
,
÷÷U V
siteId
÷÷W ]
)
÷÷] ^
;
÷÷^ _
sph
øø 
.
øø  
DefineSqlParameter
øø "
(
øø" #
$str
øø# <
,
øø< =
	SqlDbType
øø> G
.
øøG H
Bit
øøH K
,
øøK L 
ParameterDirection
øøM _
.
øø_ `
Input
øø` e
,
øøe f$
allowPasswordRetrieval
øøg }
)
øø} ~
;
øø~ 
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# 8
,
ùù8 9
	SqlDbType
ùù: C
.
ùùC D
Bit
ùùD G
,
ùùG H 
ParameterDirection
ùùI [
.
ùù[ \
Input
ùù\ a
,
ùùa b 
allowPasswordReset
ùùc u
)
ùùu v
;
ùùv w
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# ?
,
úú? @
	SqlDbType
úúA J
.
úúJ K
Bit
úúK N
,
úúN O 
ParameterDirection
úúP b
.
úúb c
Input
úúc h
,
úúh i(
requiresQuestionAndAnswerúúj 
)úú 
;úú 
sph
ûû 
.
ûû  
DefineSqlParameter
ûû "
(
ûû" #
$str
ûû# @
,
ûû@ A
	SqlDbType
ûûB K
.
ûûK L
Int
ûûL O
,
ûûO P 
ParameterDirection
ûûQ c
.
ûûc d
Input
ûûd i
,
ûûi j)
maxInvalidPasswordAttemptsûûk 
)ûû 
;ûû 
sph
üü 
.
üü  
DefineSqlParameter
üü "
(
üü" #
$str
üü# B
,
üüB C
	SqlDbType
üüD M
.
üüM N
Int
üüN Q
,
üüQ R 
ParameterDirection
üüS e
.
üüe f
Input
üüf k
,
üük l+
passwordAttemptWindowMinutesüüm 
)üü 
;üü 
sph
ýý 
.
ýý  
DefineSqlParameter
ýý "
(
ýý" #
$str
ýý# 9
,
ýý9 :
	SqlDbType
ýý; D
.
ýýD E
Bit
ýýE H
,
ýýH I 
ParameterDirection
ýýJ \
.
ýý\ ]
Input
ýý] b
,
ýýb c!
requiresUniqueEmail
ýýd w
)
ýýw x
;
ýýx y
sph
þþ 
.
þþ  
DefineSqlParameter
þþ "
(
þþ" #
$str
þþ# 4
,
þþ4 5
	SqlDbType
þþ6 ?
.
þþ? @
Int
þþ@ C
,
þþC D 
ParameterDirection
þþE W
.
þþW X
Input
þþX ]
,
þþ] ^
passwordFormat
þþ_ m
)
þþm n
;
þþn o
sph
ÿÿ 
.
ÿÿ  
DefineSqlParameter
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# ?
,
ÿÿ? @
	SqlDbType
ÿÿA J
.
ÿÿJ K
Int
ÿÿK N
,
ÿÿN O 
ParameterDirection
ÿÿP b
.
ÿÿb c
Input
ÿÿc h
,
ÿÿh i(
minRequiredPasswordLengthÿÿj 
)ÿÿ 
;ÿÿ 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# J
,
J K
	SqlDbType
L U
.
U V
Int
V Y
,
Y Z 
ParameterDirection
[ m
.
m n
Input
n s
,
s t3
$minRequiredNonAlphanumericCharactersu 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# G
,
G H
	SqlDbType
I R
.
R S
NVarChar
S [
,
[ \
-
] ^
$num
^ _
,
_ ` 
ParameterDirection
a s
.
s t
Input
t y
,
y z0
!passwordStrengthRegularExpression{ 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# =
,
= >
	SqlDbType
? H
.
H I
NVarChar
I Q
,
Q R
$num
S V
,
V W 
ParameterDirection
X j
.
j k
Input
k p
,
p q&
defaultEmailFromAddressr 
) 
; 
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
-
# $
$num
$ %
)
% &
;
& '
}
 	
public
 
static
 
bool
  
UpdateRelatedSites
 -
(
- .
int
 
siteId
 
,
 
bool
 "
allowNewRegistration
 %
,
% &
bool
 #
useSecureRegistration
 &
,
& '
bool
 
useLdapAuth
 
,
 
bool
 ,
autoCreateLdapUserOnFirstLogin
 /
,
/ 0
string
 

ldapServer
 
,
 
string
 

ldapDomain
 
,
 
int
 
ldapPort
 
,
 
string
 

ldapRootDN
 
,
 
string
 
ldapUserDNKey
  
,
  !
bool
 %
allowUserFullNameChange
 (
,
( )
bool
 
useEmailForLogin
 !
,
! "
bool
 
allowOpenIdAuth
  
,
  !
bool
 "
allowWindowsLiveAuth
 %
,
% &
bool
 $
allowPasswordRetrieval
 '
,
' (
bool
  
allowPasswordReset
 #
,
# $
bool
 '
requiresQuestionAndAnswer
 *
,
* +
int
 (
maxInvalidPasswordAttempts
 *
,
* +
int
 *
passwordAttemptWindowMinutes
 ,
,
, -
bool
 !
requiresUniqueEmail
 $
,
$ %
int
 
passwordFormat
 
,
 
int
 '
minRequiredPasswordLength
 )
,
) *
int
 !
minReqNonAlphaChars
 #
,
# $
string
 
pwdStrengthRegex
 #
)
   
{
¡¡ 	 
SqlParameterHelper
££ 
sph
££ "
=
££# $
new
££% ( 
SqlParameterHelper
££) ;
(
££; <
ConnectionString
££< L
.
££L M&
GetWriteConnectionString
££M e
(
££e f
)
££f g
,
££g h
$str££i 
,££ 
$num££ 
)££ 
;££ 
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# ,
,
¤¤, -
	SqlDbType
¤¤. 7
.
¤¤7 8
Int
¤¤8 ;
,
¤¤; < 
ParameterDirection
¤¤= O
.
¤¤O P
Input
¤¤P U
,
¤¤U V
siteId
¤¤W ]
)
¤¤] ^
;
¤¤^ _
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# :
,
¥¥: ;
	SqlDbType
¥¥< E
.
¥¥E F
Bit
¥¥F I
,
¥¥I J 
ParameterDirection
¥¥K ]
.
¥¥] ^
Input
¥¥^ c
,
¥¥c d"
allowNewRegistration
¥¥e y
)
¥¥y z
;
¥¥z {
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# ;
,
¦¦; <
	SqlDbType
¦¦= F
.
¦¦F G
Bit
¦¦G J
,
¦¦J K 
ParameterDirection
¦¦L ^
.
¦¦^ _
Input
¦¦_ d
,
¦¦d e#
useSecureRegistration
¦¦f {
)
¦¦{ |
;
¦¦| }
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# 1
,
§§1 2
	SqlDbType
§§3 <
.
§§< =
Bit
§§= @
,
§§@ A 
ParameterDirection
§§B T
.
§§T U
Input
§§U Z
,
§§Z [
useLdapAuth
§§\ g
)
§§g h
;
§§h i
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# D
,
¨¨D E
	SqlDbType
¨¨F O
.
¨¨O P
Bit
¨¨P S
,
¨¨S T 
ParameterDirection
¨¨U g
.
¨¨g h
Input
¨¨h m
,
¨¨m n-
autoCreateLdapUserOnFirstLogin¨¨o 
)¨¨ 
;¨¨ 
sph
©© 
.
©©  
DefineSqlParameter
©© "
(
©©" #
$str
©©# 0
,
©©0 1
	SqlDbType
©©2 ;
.
©©; <
NVarChar
©©< D
,
©©D E
$num
©©F I
,
©©I J 
ParameterDirection
©©K ]
.
©©] ^
Input
©©^ c
,
©©c d

ldapServer
©©e o
)
©©o p
;
©©p q
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# 0
,
ªª0 1
	SqlDbType
ªª2 ;
.
ªª; <
NVarChar
ªª< D
,
ªªD E
$num
ªªF I
,
ªªI J 
ParameterDirection
ªªK ]
.
ªª] ^
Input
ªª^ c
,
ªªc d

ldapDomain
ªªe o
)
ªªo p
;
ªªp q
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# .
,
««. /
	SqlDbType
««0 9
.
««9 :
Int
««: =
,
««= > 
ParameterDirection
««? Q
.
««Q R
Input
««R W
,
««W X
ldapPort
««Y a
)
««a b
;
««b c
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ "
(
¬¬" #
$str
¬¬# 0
,
¬¬0 1
	SqlDbType
¬¬2 ;
.
¬¬; <
NVarChar
¬¬< D
,
¬¬D E
$num
¬¬F I
,
¬¬I J 
ParameterDirection
¬¬K ]
.
¬¬] ^
Input
¬¬^ c
,
¬¬c d

ldapRootDN
¬¬e o
)
¬¬o p
;
¬¬p q
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# 3
,
­­3 4
	SqlDbType
­­5 >
.
­­> ?
NVarChar
­­? G
,
­­G H
$num
­­I K
,
­­K L 
ParameterDirection
­­M _
.
­­_ `
Input
­­` e
,
­­e f
ldapUserDNKey
­­g t
)
­­t u
;
­­u v
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# =
,
®®= >
	SqlDbType
®®? H
.
®®H I
Bit
®®I L
,
®®L M 
ParameterDirection
®®N `
.
®®` a
Input
®®a f
,
®®f g%
allowUserFullNameChange
®®h 
)®® 
;®® 
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# 6
,
¯¯6 7
	SqlDbType
¯¯8 A
.
¯¯A B
Bit
¯¯B E
,
¯¯E F 
ParameterDirection
¯¯G Y
.
¯¯Y Z
Input
¯¯Z _
,
¯¯_ `
useEmailForLogin
¯¯a q
)
¯¯q r
;
¯¯r s
sph
°° 
.
°°  
DefineSqlParameter
°° "
(
°°" #
$str
°°# 5
,
°°5 6
	SqlDbType
°°7 @
.
°°@ A
Bit
°°A D
,
°°D E 
ParameterDirection
°°F X
.
°°X Y
Input
°°Y ^
,
°°^ _
allowOpenIdAuth
°°` o
)
°°o p
;
°°p q
sph
±± 
.
±±  
DefineSqlParameter
±± "
(
±±" #
$str
±±# :
,
±±: ;
	SqlDbType
±±< E
.
±±E F
Bit
±±F I
,
±±I J 
ParameterDirection
±±K ]
.
±±] ^
Input
±±^ c
,
±±c d"
allowWindowsLiveAuth
±±e y
)
±±y z
;
±±z {
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# <
,
²²< =
	SqlDbType
²²> G
.
²²G H
Bit
²²H K
,
²²K L 
ParameterDirection
²²M _
.
²²_ `
Input
²²` e
,
²²e f$
allowPasswordRetrieval
²²g }
)
²²} ~
;
²²~ 
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# 8
,
³³8 9
	SqlDbType
³³: C
.
³³C D
Bit
³³D G
,
³³G H 
ParameterDirection
³³I [
.
³³[ \
Input
³³\ a
,
³³a b 
allowPasswordReset
³³c u
)
³³u v
;
³³v w
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# ?
,
´´? @
	SqlDbType
´´A J
.
´´J K
Bit
´´K N
,
´´N O 
ParameterDirection
´´P b
.
´´b c
Input
´´c h
,
´´h i(
requiresQuestionAndAnswer´´j 
)´´ 
;´´ 
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# @
,
µµ@ A
	SqlDbType
µµB K
.
µµK L
Int
µµL O
,
µµO P 
ParameterDirection
µµQ c
.
µµc d
Input
µµd i
,
µµi j)
maxInvalidPasswordAttemptsµµk 
)µµ 
;µµ 
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# B
,
¶¶B C
	SqlDbType
¶¶D M
.
¶¶M N
Int
¶¶N Q
,
¶¶Q R 
ParameterDirection
¶¶S e
.
¶¶e f
Input
¶¶f k
,
¶¶k l+
passwordAttemptWindowMinutes¶¶m 
)¶¶ 
;¶¶ 
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 9
,
··9 :
	SqlDbType
··; D
.
··D E
Bit
··E H
,
··H I 
ParameterDirection
··J \
.
··\ ]
Input
··] b
,
··b c!
requiresUniqueEmail
··d w
)
··w x
;
··x y
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ "
(
¸¸" #
$str
¸¸# 4
,
¸¸4 5
	SqlDbType
¸¸6 ?
.
¸¸? @
Int
¸¸@ C
,
¸¸C D 
ParameterDirection
¸¸E W
.
¸¸W X
Input
¸¸X ]
,
¸¸] ^
passwordFormat
¸¸_ m
)
¸¸m n
;
¸¸n o
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ "
(
¹¹" #
$str
¹¹# ?
,
¹¹? @
	SqlDbType
¹¹A J
.
¹¹J K
Int
¹¹K N
,
¹¹N O 
ParameterDirection
¹¹P b
.
¹¹b c
Input
¹¹c h
,
¹¹h i(
minRequiredPasswordLength¹¹j 
)¹¹ 
;¹¹ 
sph
ºº 
.
ºº  
DefineSqlParameter
ºº "
(
ºº" #
$str
ºº# 9
,
ºº9 :
	SqlDbType
ºº; D
.
ººD E
Int
ººE H
,
ººH I 
ParameterDirection
ººJ \
.
ºº\ ]
Input
ºº] b
,
ººb c!
minReqNonAlphaChars
ººd w
)
ººw x
;
ººx y
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# 6
,
»»6 7
	SqlDbType
»»8 A
.
»»A B
NVarChar
»»B J
,
»»J K
-
»»L M
$num
»»M N
,
»»N O 
ParameterDirection
»»P b
.
»»b c
Input
»»c h
,
»»h i
pwdStrengthRegex
»»j z
)
»»z {
;
»»{ |
int
½½ 
rowsAffected
½½ 
=
½½ 
sph
½½ "
.
½½" #
ExecuteNonQuery
½½# 2
(
½½2 3
)
½½3 4
;
½½4 5
return
¾¾ 
(
¾¾ 
rowsAffected
¾¾  
>
¾¾! "
-
¾¾# $
$num
¾¾$ %
)
¾¾% &
;
¾¾& '
}
¿¿ 	
public
ÁÁ 
static
ÁÁ 
bool
ÁÁ +
UpdateRelatedSitesWindowsLive
ÁÁ 8
(
ÁÁ8 9
int
ÂÂ 
siteId
ÂÂ 
,
ÂÂ 
string
ÃÃ 
windowsLiveAppId
ÃÃ #
,
ÃÃ# $
string
ÄÄ 
windowsLiveKey
ÄÄ !
)
ÅÅ 
{
ÆÆ 	 
SqlParameterHelper
ÇÇ 
sph
ÇÇ "
=
ÇÇ# $
new
ÇÇ% ( 
SqlParameterHelper
ÇÇ) ;
(
ÇÇ; <
ConnectionString
ÇÇ< L
.
ÇÇL M&
GetWriteConnectionString
ÇÇM e
(
ÇÇe f
)
ÇÇf g
,
ÇÇg h
$strÇÇi 
,ÇÇ 
$numÇÇ 
)ÇÇ 
;ÇÇ 
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ "
(
ÈÈ" #
$str
ÈÈ# ,
,
ÈÈ, -
	SqlDbType
ÈÈ. 7
.
ÈÈ7 8
Int
ÈÈ8 ;
,
ÈÈ; < 
ParameterDirection
ÈÈ= O
.
ÈÈO P
Input
ÈÈP U
,
ÈÈU V
siteId
ÈÈW ]
)
ÈÈ] ^
;
ÈÈ^ _
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# 6
,
ÉÉ6 7
	SqlDbType
ÉÉ8 A
.
ÉÉA B
NVarChar
ÉÉB J
,
ÉÉJ K
$num
ÉÉL O
,
ÉÉO P 
ParameterDirection
ÉÉQ c
.
ÉÉc d
Input
ÉÉd i
,
ÉÉi j
windowsLiveAppId
ÉÉk {
)
ÉÉ{ |
;
ÉÉ| }
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ "
(
ÊÊ" #
$str
ÊÊ# 4
,
ÊÊ4 5
	SqlDbType
ÊÊ6 ?
.
ÊÊ? @
NVarChar
ÊÊ@ H
,
ÊÊH I
$num
ÊÊJ M
,
ÊÊM N 
ParameterDirection
ÊÊO a
.
ÊÊa b
Input
ÊÊb g
,
ÊÊg h
windowsLiveKey
ÊÊi w
)
ÊÊw x
;
ÊÊx y
int
ÌÌ 
rowsAffected
ÌÌ 
=
ÌÌ 
sph
ÌÌ "
.
ÌÌ" #
ExecuteNonQuery
ÌÌ# 2
(
ÌÌ2 3
)
ÌÌ3 4
;
ÌÌ4 5
return
ÍÍ 
(
ÍÍ 
rowsAffected
ÍÍ  
>
ÍÍ! "
-
ÍÍ# $
$num
ÍÍ$ %
)
ÍÍ% &
;
ÍÍ& '
}
ÎÎ 	
public
ÓÓ 
static
ÓÓ 
bool
ÓÓ 
Delete
ÓÓ !
(
ÓÓ! "
int
ÓÓ" %
siteId
ÓÓ& ,
)
ÓÓ, -
{
ÔÔ 	 
SqlParameterHelper
ÕÕ 
sph
ÕÕ "
=
ÕÕ# $
new
ÕÕ% ( 
SqlParameterHelper
ÕÕ) ;
(
ÕÕ; <
ConnectionString
ÕÕ< L
.
ÕÕL M&
GetWriteConnectionString
ÕÕM e
(
ÕÕe f
)
ÕÕf g
,
ÕÕg h
$str
ÕÕi z
,
ÕÕz {
$num
ÕÕ| }
)
ÕÕ} ~
;
ÕÕ~ 
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# ,
,
ÖÖ, -
	SqlDbType
ÖÖ. 7
.
ÖÖ7 8
Int
ÖÖ8 ;
,
ÖÖ; < 
ParameterDirection
ÖÖ= O
.
ÖÖO P
Input
ÖÖP U
,
ÖÖU V
siteId
ÖÖW ]
)
ÖÖ] ^
;
ÖÖ^ _
int
ÙÙ 
rowsAffected
ÙÙ 
=
ÙÙ 
sph
ÙÙ "
.
ÙÙ" #
ExecuteNonQuery
ÙÙ# 2
(
ÙÙ2 3
)
ÙÙ3 4
;
ÙÙ4 5
return
ÚÚ 
(
ÚÚ 
rowsAffected
ÚÚ  
>
ÚÚ! "
-
ÚÚ# $
$num
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 	
public
ÝÝ 
static
ÝÝ 
IDataReader
ÝÝ !
GetSiteList
ÝÝ" -
(
ÝÝ- .
)
ÝÝ. /
{
ÞÞ 	 
SqlParameterHelper
ßß 
sph
ßß "
=
ßß# $
new
ßß% ( 
SqlParameterHelper
ßß) ;
(
ßß; <
ConnectionString
ßß< L
.
ßßL M%
GetReadConnectionString
ßßM d
(
ßßd e
)
ßße f
,
ßßf g
$str
ßßh |
,
ßß| }
$num
ßß~ 
)ßß 
;ßß 
return
àà 
sph
àà 
.
àà 
ExecuteReader
àà $
(
àà$ %
)
àà% &
;
àà& '
}
áá 	
public
ãã 
static
ãã 
IDataReader
ãã !
GetSite
ãã" )
(
ãã) *
string
ãã* 0
hostName
ãã1 9
)
ãã9 :
{
ää 	 
SqlParameterHelper
åå 
sph
åå "
=
åå# $
new
åå% ( 
SqlParameterHelper
åå) ;
(
åå; <
ConnectionString
åå< L
.
ååL M%
GetReadConnectionString
ååM d
(
ååd e
)
ååe f
,
ååf g
$strååh 
,åå 
$numåå 
)åå 
;åå 
sph
ææ 
.
ææ  
DefineSqlParameter
ææ "
(
ææ" #
$str
ææ# .
,
ææ. /
	SqlDbType
ææ0 9
.
ææ9 :
NVarChar
ææ: B
,
ææB C
$num
ææD F
,
ææF G 
ParameterDirection
ææH Z
.
ææZ [
Input
ææ[ `
,
ææ` a
hostName
ææb j
)
ææj k
;
ææk l
return
çç 
sph
çç 
.
çç 
ExecuteReader
çç $
(
çç$ %
)
çç% &
;
çç& '
}
éé 	
public
ìì 
static
ìì 
void
ìì 

AddFeature
ìì %
(
ìì% &
Guid
ìì& *
siteGuid
ìì+ 3
,
ìì3 4
Guid
ìì5 9
featureGuid
ìì: E
)
ììE F
{
íí 	 
SqlParameterHelper
îî 
sph
îî "
=
îî# $
new
îî% ( 
SqlParameterHelper
îî) ;
(
îî; <
ConnectionString
îî< L
.
îîL M%
GetReadConnectionString
îîM d
(
îîd e
)
îîe f
,
îîf g
$strîîh 
,îî 
$numîî 
)îî 
;îî 
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# .
,
ïï. /
	SqlDbType
ïï0 9
.
ïï9 :
UniqueIdentifier
ïï: J
,
ïïJ K 
ParameterDirection
ïïL ^
.
ïï^ _
Input
ïï_ d
,
ïïd e
siteGuid
ïïf n
)
ïïn o
;
ïïo p
sph
ðð 
.
ðð  
DefineSqlParameter
ðð "
(
ðð" #
$str
ðð# 1
,
ðð1 2
	SqlDbType
ðð3 <
.
ðð< =
UniqueIdentifier
ðð= M
,
ððM N 
ParameterDirection
ððO a
.
ðða b
Input
ððb g
,
ððg h
featureGuid
ðði t
)
ððt u
;
ððu v
sph
òò 
.
òò 
ExecuteNonQuery
òò 
(
òò  
)
òò  !
;
òò! "
}
ôô 	
public
öö 
static
öö 
void
öö 
RemoveFeature
öö (
(
öö( )
Guid
öö) -
siteGuid
öö. 6
,
öö6 7
Guid
öö8 <
featureGuid
öö= H
)
ööH I
{
÷÷ 	 
SqlParameterHelper
øø 
sph
øø "
=
øø# $
new
øø% ( 
SqlParameterHelper
øø) ;
(
øø; <
ConnectionString
øø< L
.
øøL M%
GetReadConnectionString
øøM d
(
øød e
)
øøe f
,
øøf g
$strøøh 
,øø 
$numøø 
)øø 
;øø 
sph
ùù 
.
ùù  
DefineSqlParameter
ùù "
(
ùù" #
$str
ùù# .
,
ùù. /
	SqlDbType
ùù0 9
.
ùù9 :
UniqueIdentifier
ùù: J
,
ùùJ K 
ParameterDirection
ùùL ^
.
ùù^ _
Input
ùù_ d
,
ùùd e
siteGuid
ùùf n
)
ùùn o
;
ùùo p
sph
úú 
.
úú  
DefineSqlParameter
úú "
(
úú" #
$str
úú# 1
,
úú1 2
	SqlDbType
úú3 <
.
úú< =
UniqueIdentifier
úú= M
,
úúM N 
ParameterDirection
úúO a
.
úúa b
Input
úúb g
,
úúg h
featureGuid
úúi t
)
úút u
;
úúu v
sph
ûû 
.
ûû 
ExecuteNonQuery
ûû 
(
ûû  
)
ûû  !
;
ûû! "
}
üü 	
public
ÿÿ 
static
ÿÿ 
IDataReader
ÿÿ !
GetSite
ÿÿ" )
(
ÿÿ) *
int
ÿÿ* -
siteId
ÿÿ. 4
)
ÿÿ4 5
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h |
,
| }
$num
~ 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetSite
" )
(
) *
Guid
* .
siteGuid
/ 7
)
7 8
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !!
GetPageListForAdmin
" 5
(
5 6
int
6 9
siteId
: @
)
@ A
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h }
,
} ~
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetHostList
" -
(
- .
int
. 1
siteId
2 8
)
8 9
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$str
h }
,
} ~
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
	 
IDataReader
 
GetHostList
 '
(
' (
)
( )
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D%
GetReadConnectionString
D [
(
[ \
)
\ ]
,
] ^
$str
_ w
,
w x
$num
y z
)
z {
;
{ |
return
   	
sph
  
 
.
   
ExecuteReader
   
(
   
)
   
;
   
}
¡¡ 
public
££ 
static
££	 
void
££ 
AddHost
££ 
(
££ 
Guid
££ !
siteGuid
££" *
,
££* +
int
££, /
siteId
££0 6
,
££6 7
string
££8 >
hostName
££? G
)
££G H
{
¤¤ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M&
GetWriteConnectionString
¥¥M e
(
¥¥e f
)
¥¥f g
,
¥¥g h
$str
¥¥i ~
,
¥¥~ 
$num¥¥ 
)¥¥ 
;¥¥ 
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# .
,
¦¦. /
	SqlDbType
¦¦0 9
.
¦¦9 :
UniqueIdentifier
¦¦: J
,
¦¦J K 
ParameterDirection
¦¦L ^
.
¦¦^ _
Input
¦¦_ d
,
¦¦d e
siteGuid
¦¦f n
)
¦¦n o
;
¦¦o p
sph
§§ 
.
§§  
DefineSqlParameter
§§ "
(
§§" #
$str
§§# ,
,
§§, -
	SqlDbType
§§. 7
.
§§7 8
Int
§§8 ;
,
§§; < 
ParameterDirection
§§= O
.
§§O P
Input
§§P U
,
§§U V
siteId
§§W ]
)
§§] ^
;
§§^ _
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ "
(
¨¨" #
$str
¨¨# .
,
¨¨. /
	SqlDbType
¨¨0 9
.
¨¨9 :
NVarChar
¨¨: B
,
¨¨B C
$num
¨¨D G
,
¨¨G H 
ParameterDirection
¨¨I [
.
¨¨[ \
Input
¨¨\ a
,
¨¨a b
hostName
¨¨c k
)
¨¨k l
;
¨¨l m
sph
©© 
.
©© 
ExecuteNonQuery
©© 
(
©©  
)
©©  !
;
©©! "
}
ªª 	
public
¬¬ 
static
¬¬ 
void
¬¬ 

DeleteHost
¬¬ %
(
¬¬% &
int
¬¬& )
hostId
¬¬* 0
)
¬¬0 1
{
­­ 	 
SqlParameterHelper
®® 
sph
®® "
=
®®# $
new
®®% ( 
SqlParameterHelper
®®) ;
(
®®; <
ConnectionString
®®< L
.
®®L M&
GetWriteConnectionString
®®M e
(
®®e f
)
®®f g
,
®®g h
$str
®®i ~
,
®®~ 
$num®® 
)®® 
;®® 
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# ,
,
¯¯, -
	SqlDbType
¯¯. 7
.
¯¯7 8
Int
¯¯8 ;
,
¯¯; < 
ParameterDirection
¯¯= O
.
¯¯O P
Input
¯¯P U
,
¯¯U V
hostId
¯¯W ]
)
¯¯] ^
;
¯¯^ _
sph
°° 
.
°° 
ExecuteNonQuery
°° 
(
°°  
)
°°  !
;
°°! "
}
±± 	
public
´´ 
static
´´ 
int
´´ 
CountOtherSites
´´ )
(
´´) *
int
´´* -
currentSiteId
´´. ;
)
´´; <
{
µµ 	 
SqlParameterHelper
¶¶ 
sph
¶¶ "
=
¶¶# $
new
¶¶% ( 
SqlParameterHelper
¶¶) ;
(
¶¶; <
ConnectionString
¶¶< L
.
¶¶L M%
GetReadConnectionString
¶¶M d
(
¶¶d e
)
¶¶e f
,
¶¶f g
$str¶¶h 
,¶¶ 
$num¶¶ 
)¶¶ 
;¶¶ 
sph
·· 
.
··  
DefineSqlParameter
·· "
(
··" #
$str
··# 3
,
··3 4
	SqlDbType
··5 >
.
··> ?
Int
··? B
,
··B C 
ParameterDirection
··D V
.
··V W
Input
··W \
,
··\ ]
currentSiteId
··^ k
)
··k l
;
··l m
return
¹¹ 
Convert
¹¹ 
.
¹¹ 
ToInt32
¹¹ "
(
¹¹" #
sph
¹¹# &
.
¹¹& '
ExecuteScalar
¹¹' 4
(
¹¹4 5
)
¹¹5 6
)
¹¹6 7
;
¹¹7 8
}
»» 	
public
½½ 
static
½½ 
IDataReader
½½ !!
GetPageOfOtherSites
½½" 5
(
½½5 6
int
¾¾ 
currentSiteId
¾¾ 
,
¾¾ 
int
¿¿ 

pageNumber
¿¿ 
,
¿¿ 
int
ÀÀ 
pageSize
ÀÀ 
,
ÀÀ 
out
ÁÁ 
int
ÁÁ 

totalPages
ÁÁ 
)
ÁÁ 
{
ÂÂ 	

totalPages
ÃÃ 
=
ÃÃ 
$num
ÃÃ 
;
ÃÃ 
int
ÄÄ 
	totalRows
ÄÄ 
=
ÄÄ 
CountOtherSites
ÄÄ +
(
ÄÄ+ ,
currentSiteId
ÄÄ, 9
)
ÄÄ9 :
;
ÄÄ: ;
if
ÆÆ 
(
ÆÆ 
pageSize
ÆÆ 
>
ÆÆ 
$num
ÆÆ 
)
ÆÆ 

totalPages
ÆÆ (
=
ÆÆ) *
	totalRows
ÆÆ+ 4
/
ÆÆ5 6
pageSize
ÆÆ7 ?
;
ÆÆ? @
if
ÈÈ 
(
ÈÈ 
	totalRows
ÈÈ 
<=
ÈÈ 
pageSize
ÈÈ %
)
ÈÈ% &
{
ÉÉ 

totalPages
ÊÊ 
=
ÊÊ 
$num
ÊÊ 
;
ÊÊ 
}
ËË 
else
ÌÌ 
{
ÍÍ 
int
ÎÎ 
	remainder
ÎÎ 
;
ÎÎ 
Math
ÏÏ 
.
ÏÏ 
DivRem
ÏÏ 
(
ÏÏ 
	totalRows
ÏÏ %
,
ÏÏ% &
pageSize
ÏÏ' /
,
ÏÏ/ 0
out
ÏÏ1 4
	remainder
ÏÏ5 >
)
ÏÏ> ?
;
ÏÏ? @
if
ÐÐ 
(
ÐÐ 
	remainder
ÐÐ 
>
ÐÐ 
$num
ÐÐ  !
)
ÐÐ! "
{
ÑÑ 

totalPages
ÒÒ 
+=
ÒÒ !
$num
ÒÒ" #
;
ÒÒ# $
}
ÓÓ 
}
ÔÔ  
SqlParameterHelper
ÖÖ 
sph
ÖÖ "
=
ÖÖ# $
new
ÖÖ% ( 
SqlParameterHelper
ÖÖ) ;
(
ÖÖ; <
ConnectionString
ÖÖ< L
.
ÖÖL M%
GetReadConnectionString
ÖÖM d
(
ÖÖd e
)
ÖÖe f
,
ÖÖf g
$strÖÖh 
,ÖÖ 
$numÖÖ 
)ÖÖ 
;ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× "
(
××" #
$str
××# 3
,
××3 4
	SqlDbType
××5 >
.
××> ?
Int
××? B
,
××B C 
ParameterDirection
××D V
.
××V W
Input
××W \
,
××\ ]
currentSiteId
××^ k
)
××k l
;
××l m
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# 0
,
ØØ0 1
	SqlDbType
ØØ2 ;
.
ØØ; <
Int
ØØ< ?
,
ØØ? @ 
ParameterDirection
ØØA S
.
ØØS T
Input
ØØT Y
,
ØØY Z

pageNumber
ØØ[ e
)
ØØe f
;
ØØf g
sph
ÙÙ 
.
ÙÙ  
DefineSqlParameter
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# .
,
ÙÙ. /
	SqlDbType
ÙÙ0 9
.
ÙÙ9 :
Int
ÙÙ: =
,
ÙÙ= > 
ParameterDirection
ÙÙ? Q
.
ÙÙQ R
Input
ÙÙR W
,
ÙÙW X
pageSize
ÙÙY a
)
ÙÙa b
;
ÙÙb c
return
ÚÚ 
sph
ÚÚ 
.
ÚÚ 
ExecuteReader
ÚÚ $
(
ÚÚ$ %
)
ÚÚ% &
;
ÚÚ& '
}
ÜÜ 	
public
ßß 
static
ßß 
int
ßß !
GetSiteIdByHostName
ßß -
(
ßß- .
string
ßß. 4
hostName
ßß5 =
)
ßß= >
{
àà 	 
SqlParameterHelper
áá 
sph
áá "
=
áá# $
new
áá% ( 
SqlParameterHelper
áá) ;
(
áá; <
ConnectionString
áá< L
.
ááL M%
GetReadConnectionString
ááM d
(
áád e
)
ááe f
,
ááf g
$strááh 
,áá 
$numáá 
)áá 
;áá 
sph
ââ 
.
ââ  
DefineSqlParameter
ââ "
(
ââ" #
$str
ââ# .
,
ââ. /
	SqlDbType
ââ0 9
.
ââ9 :
NVarChar
ââ: B
,
ââB C
$num
ââD G
,
ââG H 
ParameterDirection
ââI [
.
ââ[ \
Input
ââ\ a
,
ââa b
hostName
ââc k
)
ââk l
;
ââl m
return
ää 
Convert
ää 
.
ää 
ToInt32
ää "
(
ää" #
sph
ää# &
.
ää& '
ExecuteScalar
ää' 4
(
ää4 5
)
ää5 6
)
ää6 7
;
ää7 8
}
ææ 	
public
èè 
static
èè 
int
èè 
GetSiteIdByFolder
èè +
(
èè+ ,
string
èè, 2

folderName
èè3 =
)
èè= >
{
éé 	 
SqlParameterHelper
êê 
sph
êê "
=
êê# $
new
êê% ( 
SqlParameterHelper
êê) ;
(
êê; <
ConnectionString
êê< L
.
êêL M%
GetReadConnectionString
êêM d
(
êêd e
)
êêe f
,
êêf g
$strêêh 
,êê 
$numêê 
)êê 
;êê 
sph
ëë 
.
ëë  
DefineSqlParameter
ëë "
(
ëë" #
$str
ëë# 0
,
ëë0 1
	SqlDbType
ëë2 ;
.
ëë; <
NVarChar
ëë< D
,
ëëD E
$num
ëëF I
,
ëëI J 
ParameterDirection
ëëK ]
.
ëë] ^
Input
ëë^ c
,
ëëc d

folderName
ëëe o
)
ëëo p
;
ëëp q
return
íí 
Convert
íí 
.
íí 
ToInt32
íí "
(
íí" #
sph
íí# &
.
íí& '
ExecuteScalar
íí' 4
(
íí4 5
)
íí5 6
)
íí6 7
;
íí7 8
}
ïï 	
public
ññ 
static
ññ	 
bool
ññ 
HostNameExists
ññ #
(
ññ# $
string
ññ$ *
hostName
ññ+ 3
)
ññ3 4
{
òò  
SqlParameterHelper
óó 
sph
óó 
=
óó 
new
óó  
SqlParameterHelper
óó  2
(
óó2 3
ConnectionString
óó3 C
.
óóC D%
GetReadConnectionString
óóD [
(
óó[ \
)
óó\ ]
,
óó] ^
$str
óó_ s
,
óós t
$num
óóu v
)
óóv w
;
óów x
sph
ôô 
.
ôô  
DefineSqlParameter
ôô 
(
ôô 
$str
ôô %
,
ôô% &
	SqlDbType
ôô' 0
.
ôô0 1
NVarChar
ôô1 9
,
ôô9 :
$num
ôô; >
,
ôô> ? 
ParameterDirection
ôô@ R
.
ôôR S
Input
ôôS X
,
ôôX Y
hostName
ôôZ b
)
ôôb c
;
ôôc d
int
õõ 
count
õõ 
=
õõ 
Convert
õõ 
.
õõ 
ToInt32
õõ 
(
õõ 
sph
õõ "
.
õõ" #
ExecuteScalar
õõ# 0
(
õõ0 1
)
õõ1 2
)
õõ2 3
;
õõ3 4
return
öö 	
(
öö
 
count
öö 
>
öö 
$num
öö 
)
öö 
;
öö 
}
÷÷ 
public
øø 
static
øø	 
void
øø .
 UpdateSkinVersionGuidForAllSites
øø 5
(
øø5 6
)
øø6 7
{
ùù  
SqlParameterHelper
úú 
sph
úú 
=
úú 
new
úú  
SqlParameterHelper
úú  2
(
úú2 3
ConnectionString
úú3 C
.
úúC D%
GetReadConnectionString
úúD [
(
úú[ \
)
úú\ ]
,
úú] ^
$strúú_ 
,úú 
$numúú 
)úú 
;úú 
sph
ûû 
.
ûû  
DefineSqlParameter
ûû 
(
ûû 
$str
ûû $
,
ûû$ %
	SqlDbType
ûû& /
.
ûû/ 0
NVarChar
ûû0 8
,
ûû8 9
$num
ûû: =
,
ûû= > 
ParameterDirection
ûû? Q
.
ûûQ R
Input
ûûR W
,
ûûW X
Guid
ûûY ]
.
ûû] ^
NewGuid
ûû^ e
(
ûûe f
)
ûûf g
)
ûûg h
;
ûûh i
sph
ýý 
.
ýý 
ExecuteScalar
ýý 
(
ýý 
)
ýý 
;
ýý 
}
þþ 
}
ÿÿ 
} ¯8
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBSiteSettingsEx.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBSiteSettingsEx (
{ 
public 
static 
IDataReader !!
GetSiteSettingsExList" 7
(7 8
int8 ;
siteId< B
)B C
{ 	
SqlParameterHelper 
sph "
=# $
new% (
SqlParameterHelper) ;
(; <
ConnectionString< L
.L M#
GetReadConnectionStringM d
(d e
)e f
,f g
$str	h 
,
 
$num
 
)
 
;
 
sph   
.   
DefineSqlParameter   "
(  " #
$str  # ,
,  , -
	SqlDbType  . 7
.  7 8
Int  8 ;
,  ; <
ParameterDirection  = O
.  O P
Input  P U
,  U V
siteId  W ]
)  ] ^
;  ^ _
return!! 
sph!! 
.!! 
ExecuteReader!! $
(!!$ %
)!!% &
;!!& '
}"" 	
public%% 
static%% 
void%% 
EnsureSettings%% )
(%%) *
)%%* +
{&& 	
new'' 
SqlParameterHelper'' "
(''" #
ConnectionString''# 3
.''3 4$
GetWriteConnectionString''4 L
(''L M
)''M N
,''N O
$str''P u
,''u v
$num''w x
)''x y
.''y z
ExecuteNonQuery	''z 
(
'' 
)
'' 
;
'' 
}(( 	
public** 
static** 
bool** 
SaveExpandoProperty** .
(**. /
int++ 
siteId++ 
,++ 
Guid,, 
siteGuid,, 
,,, 
string-- 
	groupName-- 
,-- 
string.. 
keyName.. 
,.. 
string// 
keyValue// 
)// 
{00 	
SqlParameterHelper11 
sph11 "
=11# $
new11% (
SqlParameterHelper11) ;
(11; <
ConnectionString11< L
.11L M$
GetWriteConnectionString11M e
(11e f
)11f g
,11g h
$str	11i 
,
11 
$num
11 
)
11 
;
11 
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# ,
,22, -
	SqlDbType22. 7
.227 8
Int228 ;
,22; <
ParameterDirection22= O
.22O P
Input22P U
,22U V
siteId22W ]
)22] ^
;22^ _
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# .
,33. /
	SqlDbType330 9
.339 :
UniqueIdentifier33: J
,33J K
ParameterDirection33L ^
.33^ _
Input33_ d
,33d e
siteGuid33f n
)33n o
;33o p
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# -
,44- .
	SqlDbType44/ 8
.448 9
NVarChar449 A
,44A B
$num44C F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
keyName44b i
)44i j
;44j k
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# .
,55. /
	SqlDbType550 9
.559 :
NVarChar55: B
,55B C
-55D E
$num55E F
,55F G
ParameterDirection55H Z
.55Z [
Input55[ `
,55` a
keyValue55b j
)55j k
;55k l
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# /
,66/ 0
	SqlDbType661 :
.66: ;
NVarChar66; C
,66C D
$num66E H
,66H I
ParameterDirection66J \
.66\ ]
Input66] b
,66b c
keyName66d k
)66k l
;66l m
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
(99 
rowsAffected99  
>99! "
-99# $
$num99$ %
)99% &
;99& '
};; 	
public== 
static== 
bool== &
UpdateRelatedSitesProperty== 5
(==5 6
int>> 
siteId>> 
,>> 
string?? 
keyName?? 
,?? 
string@@ 
keyValue@@ 
)@@ 
{AA 	
SqlParameterHelperBB 
sphBB "
=BB# $
newBB% (
SqlParameterHelperBB) ;
(BB; <
ConnectionStringBB< L
.BBL M$
GetWriteConnectionStringBBM e
(BBe f
)BBf g
,BBg h
$str	BBi 
,
BB 
$num
BB 
)
BB 
;
BB 
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# ,
,CC, -
	SqlDbTypeCC. 7
.CC7 8
IntCC8 ;
,CC; <
ParameterDirectionCC= O
.CCO P
InputCCP U
,CCU V
siteIdCCW ]
)CC] ^
;CC^ _
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# -
,DD- .
	SqlDbTypeDD/ 8
.DD8 9
NVarCharDD9 A
,DDA B
$numDDC F
,DDF G
ParameterDirectionDDH Z
.DDZ [
InputDD[ `
,DD` a
keyNameDDb i
)DDi j
;DDj k
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
NVarCharEE: B
,EEB C
-EED E
$numEEE F
,EEF G
ParameterDirectionEEH Z
.EEZ [
InputEE[ `
,EE` a
keyValueEEb j
)EEj k
;EEk l
intHH 
rowsAffectedHH 
=HH 
sphHH "
.HH" #
ExecuteNonQueryHH# 2
(HH2 3
)HH3 4
;HH4 5
returnII 
(II 
rowsAffectedII  
>II! "
-II# $
$numII$ %
)II% &
;II& '
}KK 	
publicMM 
staticMM 
IDataReaderMM !%
GetDefaultExpandoSettingsMM" ;
(MM; <
)MM< =
{NN 	
SqlParameterHelperOO 
sphOO "
=OO# $
newOO% (
SqlParameterHelperOO) ;
(OO; <
ConnectionStringOO< L
.OOL M#
GetReadConnectionStringOOM d
(OOd e
)OOe f
,OOf g
$str	OOh 
,
OO 
$num
OO 
)
OO 
;
OO 
returnPP 
sphPP 
.PP 
ExecuteReaderPP $
(PP$ %
)PP% &
;PP& '
}QQ 	
}TT 
}UU ¬þ
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbSiteUser.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 
static 
class 

DBSiteUser 
{ 
public		 
static			 
IDataReader		 
GetUserList		 '
(		' (
int		( +
siteId		, 2
)		2 3
{

 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ p
,p q
$numr s
)s t
;t u
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public 
static	 
IDataReader #
GetUserCountByYearMonth 3
(3 4
int4 7
siteId8 >
)> ?
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ }
,} ~
$num	 
)
 
;
 
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public 
static	 
IDataReader  
GetSmartDropDownData 0
(0 1
int1 4
siteId5 ;
,; <
string= C
queryD I
,I J
intK N
	rowsToGetO X
)X Y
{ 
SqlParameterHelper 
sph 
= 
new 
SqlParameterHelper  2
(2 3
ConnectionString3 C
.C D#
GetReadConnectionStringD [
([ \
)\ ]
,] ^
$str_ w
,w x
$numy z
)z {
;{ |
sph 
. 
DefineSqlParameter 
( 
$str #
,# $
	SqlDbType% .
.. /
Int/ 2
,2 3
ParameterDirection4 F
.F G
InputG L
,L M
siteIdN T
)T U
;U V
sph 
. 
DefineSqlParameter 
( 
$str "
," #
	SqlDbType$ -
.- .
NVarChar. 6
,6 7
$num8 :
,: ;
ParameterDirection< N
.N O
InputO T
,T U
queryV [
)[ \
;\ ]
sph 
. 
DefineSqlParameter 
( 
$str &
,& '
	SqlDbType( 1
.1 2
Int2 5
,5 6
ParameterDirection7 I
.I J
InputJ O
,O P
	rowsToGetQ Z
)Z [
;[ \
return 	
sph
 
. 
ExecuteReader 
( 
) 
; 
} 
public   
static  	 
IDataReader   
EmailLookup   '
(  ' (
int  ( +
siteId  , 2
,  2 3
string  4 :
query  ; @
,  @ A
int  B E
	rowsToGet  F O
)  O P
{!! 
SqlParameterHelper"" 
sph"" 
="" 
new"" 
SqlParameterHelper""  2
(""2 3
ConnectionString""3 C
.""C D#
GetReadConnectionString""D [
(""[ \
)""\ ]
,""] ^
$str""_ u
,""u v
$num""w x
)""x y
;""y z
sph## 
.## 
DefineSqlParameter## 
(## 
$str## #
,### $
	SqlDbType##% .
.##. /
Int##/ 2
,##2 3
ParameterDirection##4 F
.##F G
Input##G L
,##L M
siteId##N T
)##T U
;##U V
sph$$ 
.$$ 
DefineSqlParameter$$ 
($$ 
$str$$ "
,$$" #
	SqlDbType$$$ -
.$$- .
NVarChar$$. 6
,$$6 7
$num$$8 :
,$$: ;
ParameterDirection$$< N
.$$N O
Input$$O T
,$$T U
query$$V [
)$$[ \
;$$\ ]
sph%% 
.%% 
DefineSqlParameter%% 
(%% 
$str%% &
,%%& '
	SqlDbType%%( 1
.%%1 2
Int%%2 5
,%%5 6
ParameterDirection%%7 I
.%%I J
Input%%J O
,%%O P
	rowsToGet%%Q Z
)%%Z [
;%%[ \
return&& 	
sph&&
 
.&& 
ExecuteReader&& 
(&& 
)&& 
;&& 
}'' 
public)) 
static))	 
int)) 
	UserCount)) 
()) 
int)) !
siteId))" (
)))( )
{** 
SqlParameterHelper++ 
sph++ 
=++ 
new++ 
SqlParameterHelper++  2
(++2 3
ConnectionString++3 C
.++C D#
GetReadConnectionString++D [
(++[ \
)++\ ]
,++] ^
$str++_ o
,++o p
$num++q r
)++r s
;++s t
sph,, 
.,, 
DefineSqlParameter,, 
(,, 
$str,, #
,,,# $
	SqlDbType,,% .
.,,. /
Int,,/ 2
,,,2 3
ParameterDirection,,4 F
.,,F G
Input,,G L
,,,L M
siteId,,N T
),,T U
;,,U V
int-- 
count-- 
=-- 
Convert-- 
.-- 
ToInt32-- 
(-- 
sph-- "
.--" #
ExecuteScalar--# 0
(--0 1
)--1 2
)--2 3
;--3 4
return.. 	
count..
 
;.. 
}// 
public11 
static11	 
int11 
	UserCount11 
(11 
int11 !
siteId11" (
,11( )
string11* 0
nameBeginsWith111 ?
,11? @
string11A G
nameFilterMode11H V
)11V W
{22 
switch33 	
(33
 
nameFilterMode33 
)33 
{44 
case55 
$str55	 
:55 
default66 
:66 
SqlParameterHelper77 
sph77 
=77 
new77 !
SqlParameterHelper77" 4
(774 5
ConnectionString775 E
.77E F#
GetReadConnectionString77F ]
(77] ^
)77^ _
,77_ `
$str	77a 
,
77 
$num
77 
)
77 
;
77 
sph88 
.88 	
DefineSqlParameter88	 
(88 
$str88 %
,88% &
	SqlDbType88' 0
.880 1
Int881 4
,884 5
ParameterDirection886 H
.88H I
Input88I N
,88N O
siteId88P V
)88V W
;88W X
sph99 
.99 	
DefineSqlParameter99	 
(99 
$str99 )
,99) *
	SqlDbType99+ 4
.994 5
NVarChar995 =
,99= >
$num99? A
,99A B
ParameterDirection99C U
.99U V
Input99V [
,99[ \
nameBeginsWith99] k
)99k l
;99l m
return:: 
Convert:: 
.:: 
ToInt32:: 
(:: 
sph:: 
.::  
ExecuteScalar::  -
(::- .
)::. /
)::/ 0
;::0 1
case<< 
$str<<	 
:<< 
SqlParameterHelper== 
sph2== 
=== 
new== "
SqlParameterHelper==# 5
(==5 6
ConnectionString==6 F
.==F G#
GetReadConnectionString==G ^
(==^ _
)==_ `
,==` a
$str	==b 
,
== 
$num
== 
)
== 
;
== 
sph2>> 	
.>>	 

DefineSqlParameter>>
 
(>> 
$str>> &
,>>& '
	SqlDbType>>( 1
.>>1 2
Int>>2 5
,>>5 6
ParameterDirection>>7 I
.>>I J
Input>>J O
,>>O P
siteId>>Q W
)>>W X
;>>X Y
sph2?? 	
.??	 

DefineSqlParameter??
 
(?? 
$str?? *
,??* +
	SqlDbType??, 5
.??5 6
NVarChar??6 >
,??> ?
$num??@ B
,??B C
ParameterDirection??D V
.??V W
Input??W \
,??\ ]
nameBeginsWith??^ l
)??l m
;??m n
return@@ 
Convert@@ 
.@@ 
ToInt32@@ 
(@@ 
sph2@@  
.@@  !
ExecuteScalar@@! .
(@@. /
)@@/ 0
)@@0 1
;@@1 2
}AA 
}BB 
publicDD 
staticDD	 
intDD -
!CountUsersByRegistrationDateRangeDD 5
(DD5 6
intEE 
siteIdEE 
,EE 
DateTimeFF 
	beginDateFF 
,FF 
DateTimeGG 
endDateGG 
)GG 
{HH 
SqlParameterHelperII 
sphII 
=II 
newII 
SqlParameterHelperII  2
(II2 3
ConnectionStringII3 C
.IIC D#
GetReadConnectionStringIID [
(II[ \
)II\ ]
,II] ^
$str	II_ 
,
II 
$num
II 
)
II 
;
II 
sphJJ 
.JJ 
DefineSqlParameterJJ 
(JJ 
$strJJ #
,JJ# $
	SqlDbTypeJJ% .
.JJ. /
IntJJ/ 2
,JJ2 3
ParameterDirectionJJ4 F
.JJF G
InputJJG L
,JJL M
siteIdJJN T
)JJT U
;JJU V
sphKK 
.KK 
DefineSqlParameterKK 
(KK 
$strKK &
,KK& '
	SqlDbTypeKK( 1
.KK1 2
DateTimeKK2 :
,KK: ;
ParameterDirectionKK< N
.KKN O
InputKKO T
,KKT U
	beginDateKKV _
)KK_ `
;KK` a
sphLL 
.LL 
DefineSqlParameterLL 
(LL 
$strLL $
,LL$ %
	SqlDbTypeLL& /
.LL/ 0
DateTimeLL0 8
,LL8 9
ParameterDirectionLL: L
.LLL M
InputLLM R
,LLR S
endDateLLT [
)LL[ \
;LL\ ]
intMM 
countMM 
=MM 
ConvertMM 
.MM 
ToInt32MM 
(MM 
sphMM "
.MM" #
ExecuteScalarMM# 0
(MM0 1
)MM1 2
)MM2 3
;MM3 4
returnNN 	
countNN
 
;NN 
}OO 
publicQQ 
staticQQ	 
intQQ 
CountOnlineSinceQQ $
(QQ$ %
intQQ% (
siteIdQQ) /
,QQ/ 0
DateTimeQQ1 9
	sinceTimeQQ: C
)QQC D
{RR 
SqlParameterHelperSS 
sphSS 
=SS 
newSS 
SqlParameterHelperSS  2
(SS2 3
ConnectionStringSS3 C
.SSC D#
GetReadConnectionStringSSD [
(SS[ \
)SS\ ]
,SS] ^
$strSS_ ~
,SS~ 
$num
SS 
)
SS 
;
SS 
sphTT 
.TT 
DefineSqlParameterTT 
(TT 
$strTT #
,TT# $
	SqlDbTypeTT% .
.TT. /
IntTT/ 2
,TT2 3
ParameterDirectionTT4 F
.TTF G
InputTTG L
,TTL M
siteIdTTN T
)TTT U
;TTU V
sphUU 
.UU 
DefineSqlParameterUU 
(UU 
$strUU &
,UU& '
	SqlDbTypeUU( 1
.UU1 2
DateTimeUU2 :
,UU: ;
ParameterDirectionUU< N
.UUN O
InputUUO T
,UUT U
	sinceTimeUUV _
)UU_ `
;UU` a
intVV 
countVV 
=VV 
ConvertVV 
.VV 
ToInt32VV 
(VV 
sphVV "
.VV" #
ExecuteScalarVV# 0
(VV0 1
)VV1 2
)VV2 3
;VV3 4
returnWW 	
countWW
 
;WW 
}XX 
publicZZ 
staticZZ	 
IDataReaderZZ 
GetUsersOnlineSinceZZ /
(ZZ/ 0
intZZ0 3
siteIdZZ4 :
,ZZ: ;
DateTimeZZ< D
	sinceTimeZZE N
)ZZN O
{[[ 
SqlParameterHelper\\ 
sph\\ 
=\\ 
new\\ 
SqlParameterHelper\\  2
(\\2 3
ConnectionString\\3 C
.\\C D#
GetReadConnectionString\\D [
(\\[ \
)\\\ ]
,\\] ^
$str	\\_ 
,
\\ 
$num
\\ 
)
\\ 
;
\\ 
sph]] 
.]] 
DefineSqlParameter]] 
(]] 
$str]] #
,]]# $
	SqlDbType]]% .
.]]. /
Int]]/ 2
,]]2 3
ParameterDirection]]4 F
.]]F G
Input]]G L
,]]L M
siteId]]N T
)]]T U
;]]U V
sph^^ 
.^^ 
DefineSqlParameter^^ 
(^^ 
$str^^ &
,^^& '
	SqlDbType^^( 1
.^^1 2
DateTime^^2 :
,^^: ;
ParameterDirection^^< N
.^^N O
Input^^O T
,^^T U
	sinceTime^^V _
)^^_ `
;^^` a
return__ 	
sph__
 
.__ 
ExecuteReader__ 
(__ 
)__ 
;__ 
}`` 
publicbb 
staticbb	 
IDataReaderbb $
GetTop50UsersOnlineSincebb 4
(bb4 5
intbb5 8
siteIdbb9 ?
,bb? @
DateTimebbA I
	sinceTimebbJ S
)bbS T
{cc 
SqlParameterHelperdd 
sphdd 
=dd 
newdd 
SqlParameterHelperdd  2
(dd2 3
ConnectionStringdd3 C
.ddC D#
GetReadConnectionStringddD [
(dd[ \
)dd\ ]
,dd] ^
$str	dd_ 
,
dd 
$num
dd 
)
dd 
;
dd 
sphee 
.ee 
DefineSqlParameteree 
(ee 
$stree #
,ee# $
	SqlDbTypeee% .
.ee. /
Intee/ 2
,ee2 3
ParameterDirectionee4 F
.eeF G
InputeeG L
,eeL M
siteIdeeN T
)eeT U
;eeU V
sphff 
.ff 
DefineSqlParameterff 
(ff 
$strff &
,ff& '
	SqlDbTypeff( 1
.ff1 2
DateTimeff2 :
,ff: ;
ParameterDirectionff< N
.ffN O
InputffO T
,ffT U
	sinceTimeffV _
)ff_ `
;ff` a
returngg 	
sphgg
 
.gg 
ExecuteReadergg 
(gg 
)gg 
;gg 
}hh 
publickk 
statickk	 
intkk 
GetNewestUserIdkk #
(kk# $
intkk$ '
siteIdkk( .
)kk. /
{ll 
SqlParameterHelpermm 
sphmm 
=mm 
newmm 
SqlParameterHelpermm  2
(mm2 3
ConnectionStringmm3 C
.mmC D#
GetReadConnectionStringmmD [
(mm[ \
)mm\ ]
,mm] ^
$strmm_ y
,mmy z
$nummm{ |
)mm| }
;mm} ~
sphnn 
.nn 
DefineSqlParameternn 
(nn 
$strnn #
,nn# $
	SqlDbTypenn% .
.nn. /
Intnn/ 2
,nn2 3
ParameterDirectionnn4 F
.nnF G
InputnnG L
,nnL M
siteIdnnN T
)nnT U
;nnU V
intoo 
countoo 
=oo 
Convertoo 
.oo 
ToInt32oo 
(oo 
sphoo "
.oo" #
ExecuteScalaroo# 0
(oo0 1
)oo1 2
)oo2 3
;oo3 4
returnpp 	
countpp
 
;pp 
}qq 
publicss 
staticss	 
IDataReaderss 
GetUserListPagess +
(ss+ ,
inttt 
siteIdtt 
,tt 
intuu 

pageNumberuu 
,uu 
intvv 
pageSizevv 
,vv 
stringww 	

beginsWithww
 
,ww 
intxx 
sortModexx 
,xx 
stringyy 	
nameFilterModeyy
 
,yy 
outzz 
intzz 


totalPageszz 
){{ 
{|| 

totalPages}} 
=}} 
$num}} 
;}} 
int~~ 
	totalRows~~ 
=~~ 
	UserCount~~ 
(~~ 
siteId~~ #
,~~# $

beginsWith~~% /
,~~/ 0
nameFilterMode~~1 ?
)~~? @
;~~@ A
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 
=
 
	totalRows
 
/
 
pageSize
 %
;
% &
if
 
(
 
	totalRows
 
<=
 
pageSize
 
)
 
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
Math
 
.
 	
DivRem
	 
(
 
	totalRows
 
,
 
pageSize
 #
,
# $
out
% (
int
) ,
	remainder
- 6
)
6 7
;
7 8
if
 
(
 
	remainder
 
>
 
$num
 
)
 
{
 

totalPages
 
+=
 
$num
 
;
 
}
 
}
  
SqlParameterHelper
¤¤ 
sph
¤¤ 
=
¤¤ 
new
¤¤  
SqlParameterHelper
¤¤  2
(
¤¤2 3
ConnectionString
¤¤3 C
.
¤¤C D%
GetReadConnectionString
¤¤D [
(
¤¤[ \
)
¤¤\ ]
,
¤¤] ^
$str
¤¤_ t
,
¤¤t u
$num
¤¤v w
)
¤¤w x
;
¤¤x y
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ 
(
¦¦ 
$str
¦¦ '
,
¦¦' (
	SqlDbType
¦¦) 2
.
¦¦2 3
Int
¦¦3 6
,
¦¦6 7 
ParameterDirection
¦¦8 J
.
¦¦J K
Input
¦¦K P
,
¦¦P Q

pageNumber
¦¦R \
)
¦¦\ ]
;
¦¦] ^
sph
§§ 
.
§§  
DefineSqlParameter
§§ 
(
§§ 
$str
§§ %
,
§§% &
	SqlDbType
§§' 0
.
§§0 1
Int
§§1 4
,
§§4 5 
ParameterDirection
§§6 H
.
§§H I
Input
§§I N
,
§§N O
pageSize
§§P X
)
§§X Y
;
§§Y Z
sph
¨¨ 
.
¨¨  
DefineSqlParameter
¨¨ 
(
¨¨ 
$str
¨¨ '
,
¨¨' (
	SqlDbType
¨¨) 2
.
¨¨2 3
NVarChar
¨¨3 ;
,
¨¨; <
$num
¨¨= ?
,
¨¨? @ 
ParameterDirection
¨¨A S
.
¨¨S T
Input
¨¨T Y
,
¨¨Y Z

beginsWith
¨¨[ e
)
¨¨e f
;
¨¨f g
sph
©© 
.
©©  
DefineSqlParameter
©© 
(
©© 
$str
©© #
,
©©# $
	SqlDbType
©©% .
.
©©. /
Int
©©/ 2
,
©©2 3 
ParameterDirection
©©4 F
.
©©F G
Input
©©G L
,
©©L M
siteId
©©N T
)
©©T U
;
©©U V
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª %
,
ªª% &
	SqlDbType
ªª' 0
.
ªª0 1
Int
ªª1 4
,
ªª4 5 
ParameterDirection
ªª6 H
.
ªªH I
Input
ªªI N
,
ªªN O
sortMode
ªªP X
)
ªªX Y
;
ªªY Z
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« +
,
««+ ,
	SqlDbType
««- 6
.
««6 7
NVarChar
««7 ?
,
««? @
$num
««A C
,
««C D 
ParameterDirection
««E W
.
««W X
Input
««X ]
,
««] ^
nameFilterMode
««_ m
)
««m n
;
««n o
return
­­ 	
sph
­­
 
.
­­ 
ExecuteReader
­­ 
(
­­ 
)
­­ 
;
­­ 
}
®® 
private
°° 	
static
°°
 
int
°° 
CountForSearch
°° #
(
°°# $
int
°°$ '
siteId
°°( .
,
°°. /
string
°°0 6
searchInput
°°7 B
)
°°B C
{
±±  
SqlParameterHelper
²² 
sph
²² 
=
²² 
new
²²  
SqlParameterHelper
²²  2
(
²²2 3
ConnectionString
²²3 C
.
²²C D%
GetReadConnectionString
²²D [
(
²²[ \
)
²²\ ]
,
²²] ^
$str
²²_ x
,
²²x y
$num
²²z {
)
²²{ |
;
²²| }
sph
³³ 
.
³³  
DefineSqlParameter
³³ 
(
³³ 
$str
³³ #
,
³³# $
	SqlDbType
³³% .
.
³³. /
Int
³³/ 2
,
³³2 3 
ParameterDirection
³³4 F
.
³³F G
Input
³³G L
,
³³L M
siteId
³³N T
)
³³T U
;
³³U V
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ (
,
´´( )
	SqlDbType
´´* 3
.
´´3 4
NVarChar
´´4 <
,
´´< =
$num
´´> @
,
´´@ A 
ParameterDirection
´´B T
.
´´T U
Input
´´U Z
,
´´Z [
searchInput
´´\ g
)
´´g h
;
´´h i
int
µµ 
count
µµ 
=
µµ 
Convert
µµ 
.
µµ 
ToInt32
µµ 
(
µµ 
sph
µµ "
.
µµ" #
ExecuteScalar
µµ# 0
(
µµ0 1
)
µµ1 2
)
µµ2 3
;
µµ3 4
return
¶¶ 	
count
¶¶
 
;
¶¶ 
}
·· 
public
¹¹ 
static
¹¹	 
IDataReader
¹¹ 
GetUserSearchPage
¹¹ -
(
¹¹- .
int
ºº 
siteId
ºº 
,
ºº 
int
»» 

pageNumber
»» 
,
»» 
int
¼¼ 
pageSize
¼¼ 
,
¼¼ 
string
½½ 	
searchInput
½½
 
,
½½ 
int
¾¾ 
sortMode
¾¾ 
,
¾¾ 
out
¿¿ 
int
¿¿ 


totalPages
¿¿ 
)
¿¿ 
{
ÀÀ 

totalPages
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
int
ÂÂ 
	totalRows
ÂÂ 
=
ÂÂ 
CountForSearch
ÂÂ !
(
ÂÂ! "
siteId
ÂÂ" (
,
ÂÂ( )
searchInput
ÂÂ* 5
)
ÂÂ5 6
;
ÂÂ6 7
if
ÄÄ 
(
ÄÄ 
pageSize
ÄÄ 
>
ÄÄ 
$num
ÄÄ 
)
ÄÄ 

totalPages
ÅÅ 
=
ÅÅ 
	totalRows
ÅÅ 
/
ÅÅ 
pageSize
ÅÅ %
;
ÅÅ% &
if
ÇÇ 
(
ÇÇ 
	totalRows
ÇÇ 
<=
ÇÇ 
pageSize
ÇÇ 
)
ÇÇ 
{
ÈÈ 

totalPages
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
}
ÊÊ 
else
ËË 
{
ÌÌ 
int
ÍÍ 
	remainder
ÍÍ 
;
ÍÍ 
Math
ÎÎ 
.
ÎÎ 	
DivRem
ÎÎ	 
(
ÎÎ 
	totalRows
ÎÎ 
,
ÎÎ 
pageSize
ÎÎ #
,
ÎÎ# $
out
ÎÎ% (
	remainder
ÎÎ) 2
)
ÎÎ2 3
;
ÎÎ3 4
if
ÏÏ 
(
ÏÏ 
	remainder
ÏÏ 
>
ÏÏ 
$num
ÏÏ 
)
ÏÏ 
{
ÐÐ 

totalPages
ÑÑ 
+=
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ  
SqlParameterHelper
ÕÕ 
sph
ÕÕ 
;
ÕÕ 
switch
×× 	
(
××
 
sortMode
×× 
)
×× 
{
ØØ 
case
ÙÙ 
$num
ÙÙ	 

:
ÙÙ
 
sph
ÚÚ 
=
ÚÚ	 

new
ÚÚ  
SqlParameterHelper
ÚÚ !
(
ÚÚ! "
ConnectionString
ÚÚ" 2
.
ÚÚ2 3%
GetReadConnectionString
ÚÚ3 J
(
ÚÚJ K
)
ÚÚK L
,
ÚÚL M
$str
ÚÚN s
,
ÚÚs t
$num
ÚÚu v
)
ÚÚv w
;
ÚÚw x
break
ÛÛ 

;
ÛÛ
 
case
ÝÝ 
$num
ÝÝ	 

:
ÝÝ
 
sph
ÞÞ 
=
ÞÞ	 

new
ÞÞ  
SqlParameterHelper
ÞÞ !
(
ÞÞ! "
ConnectionString
ÞÞ" 2
.
ÞÞ2 3%
GetReadConnectionString
ÞÞ3 J
(
ÞÞJ K
)
ÞÞK L
,
ÞÞL M
$str
ÞÞN m
,
ÞÞm n
$num
ÞÞo p
)
ÞÞp q
;
ÞÞq r
break
ßß 

;
ßß
 
case
áá 
$num
áá	 

:
áá
 
default
ââ 
:
ââ 
sph
ãã 
=
ãã	 

new
ãã  
SqlParameterHelper
ãã !
(
ãã! "
ConnectionString
ãã" 2
.
ãã2 3%
GetReadConnectionString
ãã3 J
(
ããJ K
)
ããK L
,
ããL M
$str
ããN i
,
ããi j
$num
ããk l
)
ããl m
;
ããm n
break
ää 

;
ää
 
}
åå 
sph
éé 
.
éé  
DefineSqlParameter
éé 
(
éé 
$str
éé #
,
éé# $
	SqlDbType
éé% .
.
éé. /
Int
éé/ 2
,
éé2 3 
ParameterDirection
éé4 F
.
ééF G
Input
ééG L
,
ééL M
siteId
ééN T
)
ééT U
;
ééU V
sph
êê 
.
êê  
DefineSqlParameter
êê 
(
êê 
$str
êê (
,
êê( )
	SqlDbType
êê* 3
.
êê3 4
NVarChar
êê4 <
,
êê< =
$num
êê> @
,
êê@ A 
ParameterDirection
êêB T
.
êêT U
Input
êêU Z
,
êêZ [
searchInput
êê\ g
)
êêg h
;
êêh i
sph
ëë 
.
ëë  
DefineSqlParameter
ëë 
(
ëë 
$str
ëë '
,
ëë' (
	SqlDbType
ëë) 2
.
ëë2 3
Int
ëë3 6
,
ëë6 7 
ParameterDirection
ëë8 J
.
ëëJ K
Input
ëëK P
,
ëëP Q

pageNumber
ëëR \
)
ëë\ ]
;
ëë] ^
sph
ìì 
.
ìì  
DefineSqlParameter
ìì 
(
ìì 
$str
ìì %
,
ìì% &
	SqlDbType
ìì' 0
.
ìì0 1
Int
ìì1 4
,
ìì4 5 
ParameterDirection
ìì6 H
.
ììH I
Input
ììI N
,
ììN O
pageSize
ììP X
)
ììX Y
;
ììY Z
return
íí 	
sph
íí
 
.
íí 
ExecuteReader
íí 
(
íí 
)
íí 
;
íí 
}
ïï 
private
ññ 	
static
ññ
 
int
ññ !
CountForAdminSearch
ññ (
(
ññ( )
int
ññ) ,
siteId
ññ- 3
,
ññ3 4
string
ññ5 ;
searchInput
ññ< G
)
ññG H
{
òò  
SqlParameterHelper
óó 
sph
óó 
=
óó 
new
óó  
SqlParameterHelper
óó  2
(
óó2 3
ConnectionString
óó3 C
.
óóC D%
GetReadConnectionString
óóD [
(
óó[ \
)
óó\ ]
,
óó] ^
$str
óó_ }
,
óó} ~
$numóó 
)óó 
;óó 
sph
ôô 
.
ôô  
DefineSqlParameter
ôô 
(
ôô 
$str
ôô #
,
ôô# $
	SqlDbType
ôô% .
.
ôô. /
Int
ôô/ 2
,
ôô2 3 
ParameterDirection
ôô4 F
.
ôôF G
Input
ôôG L
,
ôôL M
siteId
ôôN T
)
ôôT U
;
ôôU V
sph
õõ 
.
õõ  
DefineSqlParameter
õõ 
(
õõ 
$str
õõ (
,
õõ( )
	SqlDbType
õõ* 3
.
õõ3 4
NVarChar
õõ4 <
,
õõ< =
$num
õõ> @
,
õõ@ A 
ParameterDirection
õõB T
.
õõT U
Input
õõU Z
,
õõZ [
searchInput
õõ\ g
)
õõg h
;
õõh i
int
öö 
count
öö 
=
öö 
Convert
öö 
.
öö 
ToInt32
öö 
(
öö 
sph
öö "
.
öö" #
ExecuteScalar
öö# 0
(
öö0 1
)
öö1 2
)
öö2 3
;
öö3 4
return
÷÷ 	
count
÷÷
 
;
÷÷ 
}
øø 
public
úú 
static
úú	 
IDataReader
úú $
GetUserAdminSearchPage
úú 2
(
úú2 3
int
ûû 
siteId
ûû 
,
ûû 
int
üü 

pageNumber
üü 
,
üü 
int
ýý 
pageSize
ýý 
,
ýý 
string
þþ 	
searchInput
þþ
 
,
þþ 
int
ÿÿ 
sortMode
ÿÿ 
,
ÿÿ 
out
 
int
 


totalPages
 
)
 
{
 

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 !
CountForAdminSearch
 &
(
& '
siteId
' -
,
- .
searchInput
/ :
)
: ;
;
; <
if
 
(
 
pageSize
 
>
 
$num
 
)
 

totalPages
 
=
 
	totalRows
 
/
 
pageSize
 %
;
% &
if
 
(
 
	totalRows
 
<=
 
pageSize
 
)
 
{
 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 	
DivRem
	 
(
 
	totalRows
 
,
 
pageSize
 #
,
# $
out
% (
	remainder
) 2
)
2 3
;
3 4
if
 
(
 
	remainder
 
>
 
$num
 
)
 
{
 

totalPages
 
+=
 
$num
 
;
 
}
 
}
  
SqlParameterHelper
 
sph
 
;
 
switch
 	
(

 
sortMode
 
)
 
{
 
case
 
$num
	 

:

 
sph
 
=
	 

new
  
SqlParameterHelper
 !
(
! "
ConnectionString
" 2
.
2 3%
GetReadConnectionString
3 J
(
J K
)
K L
,
L M
$str
N x
,
x y
$num
z {
)
{ |
;
| }
break
 

;

 
case
 
$num
	 

:

 
sph
 
=
	 

new
  
SqlParameterHelper
 !
(
! "
ConnectionString
" 2
.
2 3%
GetReadConnectionString
3 J
(
J K
)
K L
,
L M
$str
N r
,
r s
$num
t u
)
u v
;
v w
break
   

;
  
 
case
¢¢ 
$num
¢¢	 

:
¢¢
 
default
££ 
:
££ 
sph
¤¤ 
=
¤¤	 

new
¤¤  
SqlParameterHelper
¤¤ !
(
¤¤! "
ConnectionString
¤¤" 2
.
¤¤2 3%
GetReadConnectionString
¤¤3 J
(
¤¤J K
)
¤¤K L
,
¤¤L M
$str
¤¤N n
,
¤¤n o
$num
¤¤p q
)
¤¤q r
;
¤¤r s
break
¥¥ 

;
¥¥
 
}
¦¦ 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª #
,
ªª# $
	SqlDbType
ªª% .
.
ªª. /
Int
ªª/ 2
,
ªª2 3 
ParameterDirection
ªª4 F
.
ªªF G
Input
ªªG L
,
ªªL M
siteId
ªªN T
)
ªªT U
;
ªªU V
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« (
,
««( )
	SqlDbType
««* 3
.
««3 4
NVarChar
««4 <
,
««< =
$num
««> @
,
««@ A 
ParameterDirection
««B T
.
««T U
Input
««U Z
,
««Z [
searchInput
««\ g
)
««g h
;
««h i
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ '
,
¬¬' (
	SqlDbType
¬¬) 2
.
¬¬2 3
Int
¬¬3 6
,
¬¬6 7 
ParameterDirection
¬¬8 J
.
¬¬J K
Input
¬¬K P
,
¬¬P Q

pageNumber
¬¬R \
)
¬¬\ ]
;
¬¬] ^
sph
­­ 
.
­­  
DefineSqlParameter
­­ 
(
­­ 
$str
­­ %
,
­­% &
	SqlDbType
­­' 0
.
­­0 1
Int
­­1 4
,
­­4 5 
ParameterDirection
­­6 H
.
­­H I
Input
­­I N
,
­­N O
pageSize
­­P X
)
­­X Y
;
­­Y Z
return
®® 	
sph
®®
 
.
®® 
ExecuteReader
®® 
(
®® 
)
®® 
;
®® 
}
°° 
public
²² 
static
²²	 
int
²² !
CountLockedOutUsers
²² '
(
²²' (
int
²²( +
siteId
²², 2
)
²²2 3
{
³³  
SqlParameterHelper
´´ 
sph
´´ 
=
´´ 
new
´´  
SqlParameterHelper
´´  2
(
´´2 3
ConnectionString
´´3 C
.
´´C D%
GetReadConnectionString
´´D [
(
´´[ \
)
´´\ ]
,
´´] ^
$str
´´_ u
,
´´u v
$num
´´w x
)
´´x y
;
´´y z
sph
µµ 
.
µµ  
DefineSqlParameter
µµ 
(
µµ 
$str
µµ #
,
µµ# $
	SqlDbType
µµ% .
.
µµ. /
Int
µµ/ 2
,
µµ2 3 
ParameterDirection
µµ4 F
.
µµF G
Input
µµG L
,
µµL M
siteId
µµN T
)
µµT U
;
µµU V
int
·· 
count
·· 
=
·· 
Convert
·· 
.
·· 
ToInt32
·· 
(
·· 
sph
·· "
.
··" #
ExecuteScalar
··# 0
(
··0 1
)
··1 2
)
··2 3
;
··3 4
return
¸¸ 	
count
¸¸
 
;
¸¸ 
}
¹¹ 
public
»» 
static
»»	 
IDataReader
»»  
GetPageLockedUsers
»» .
(
»». /
int
¼¼ 
siteId
¼¼ 
,
¼¼ 
int
½½ 

pageNumber
½½ 
,
½½ 
int
¾¾ 
pageSize
¾¾ 
,
¾¾ 
out
¿¿ 
int
¿¿ 


totalPages
¿¿ 
)
¿¿ 
{
ÀÀ 

totalPages
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
int
ÂÂ 
	totalRows
ÂÂ 
=
ÂÂ !
CountLockedOutUsers
ÂÂ &
(
ÂÂ& '
siteId
ÂÂ' -
)
ÂÂ- .
;
ÂÂ. /
if
ÄÄ 
(
ÄÄ 
pageSize
ÄÄ 
>
ÄÄ 
$num
ÄÄ 
)
ÄÄ 

totalPages
ÅÅ 
=
ÅÅ 
	totalRows
ÅÅ 
/
ÅÅ 
pageSize
ÅÅ %
;
ÅÅ% &
if
ÇÇ 
(
ÇÇ 
	totalRows
ÇÇ 
<=
ÇÇ 
pageSize
ÇÇ 
)
ÇÇ 
{
ÈÈ 

totalPages
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
}
ÊÊ 
else
ËË 
{
ÌÌ 
int
ÍÍ 
	remainder
ÍÍ 
;
ÍÍ 
Math
ÎÎ 
.
ÎÎ 	
DivRem
ÎÎ	 
(
ÎÎ 
	totalRows
ÎÎ 
,
ÎÎ 
pageSize
ÎÎ #
,
ÎÎ# $
out
ÎÎ% (
	remainder
ÎÎ) 2
)
ÎÎ2 3
;
ÎÎ3 4
if
ÏÏ 
(
ÏÏ 
	remainder
ÏÏ 
>
ÏÏ 
$num
ÏÏ 
)
ÏÏ 
{
ÐÐ 

totalPages
ÑÑ 
+=
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ  
SqlParameterHelper
ÕÕ 
sph
ÕÕ 
=
ÕÕ 
new
ÕÕ  
SqlParameterHelper
ÕÕ  2
(
ÕÕ2 3
ConnectionString
ÕÕ3 C
.
ÕÕC D%
GetReadConnectionString
ÕÕD [
(
ÕÕ[ \
)
ÕÕ\ ]
,
ÕÕ] ^
$str
ÕÕ_ z
,
ÕÕz {
$num
ÕÕ| }
)
ÕÕ} ~
;
ÕÕ~ 
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ 
(
ÖÖ 
$str
ÖÖ #
,
ÖÖ# $
	SqlDbType
ÖÖ% .
.
ÖÖ. /
Int
ÖÖ/ 2
,
ÖÖ2 3 
ParameterDirection
ÖÖ4 F
.
ÖÖF G
Input
ÖÖG L
,
ÖÖL M
siteId
ÖÖN T
)
ÖÖT U
;
ÖÖU V
sph
×× 
.
××  
DefineSqlParameter
×× 
(
×× 
$str
×× '
,
××' (
	SqlDbType
××) 2
.
××2 3
Int
××3 6
,
××6 7 
ParameterDirection
××8 J
.
××J K
Input
××K P
,
××P Q

pageNumber
××R \
)
××\ ]
;
××] ^
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ 
(
ØØ 
$str
ØØ %
,
ØØ% &
	SqlDbType
ØØ' 0
.
ØØ0 1
Int
ØØ1 4
,
ØØ4 5 
ParameterDirection
ØØ6 H
.
ØØH I
Input
ØØI N
,
ØØN O
pageSize
ØØP X
)
ØØX Y
;
ØØY Z
return
ÙÙ 	
sph
ÙÙ
 
.
ÙÙ 
ExecuteReader
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÛÛ 
public
ÝÝ 
static
ÝÝ	 
int
ÝÝ #
CountNotApprovedUsers
ÝÝ )
(
ÝÝ) *
int
ÝÝ* -
siteId
ÝÝ. 4
)
ÝÝ4 5
{
ÞÞ  
SqlParameterHelper
ßß 
sph
ßß 
=
ßß 
new
ßß  
SqlParameterHelper
ßß  2
(
ßß2 3
ConnectionString
ßß3 C
.
ßßC D%
GetReadConnectionString
ßßD [
(
ßß[ \
)
ßß\ ]
,
ßß] ^
$str
ßß_ z
,
ßßz {
$num
ßß| }
)
ßß} ~
;
ßß~ 
sph
àà 
.
àà  
DefineSqlParameter
àà 
(
àà 
$str
àà #
,
àà# $
	SqlDbType
àà% .
.
àà. /
Int
àà/ 2
,
àà2 3 
ParameterDirection
àà4 F
.
ààF G
Input
ààG L
,
ààL M
siteId
ààN T
)
ààT U
;
ààU V
int
ââ 
count
ââ 
=
ââ 
Convert
ââ 
.
ââ 
ToInt32
ââ 
(
ââ 
sph
ââ "
.
ââ" #
ExecuteScalar
ââ# 0
(
ââ0 1
)
ââ1 2
)
ââ2 3
;
ââ3 4
return
ãã 	
count
ãã
 
;
ãã 
}
ää 
public
ææ 
static
ææ	 
IDataReader
ææ %
GetPageNotApprovedUsers
ææ 3
(
ææ3 4
int
çç 
siteId
çç 
,
çç 
int
èè 

pageNumber
èè 
,
èè 
int
éé 
pageSize
éé 
,
éé 
out
êê 
int
êê 


totalPages
êê 
)
êê 
{
ëë 

totalPages
ìì 
=
ìì 
$num
ìì 
;
ìì 
int
íí 
	totalRows
íí 
=
íí #
CountNotApprovedUsers
íí (
(
íí( )
siteId
íí) /
)
íí/ 0
;
íí0 1
if
ïï 
(
ïï 
pageSize
ïï 
>
ïï 
$num
ïï 
)
ïï 

totalPages
ðð 
=
ðð 
	totalRows
ðð 
/
ðð 
pageSize
ðð %
;
ðð% &
if
òò 
(
òò 
	totalRows
òò 
<=
òò 
pageSize
òò 
)
òò 
{
óó 

totalPages
ôô 
=
ôô 
$num
ôô 
;
ôô 
}
õõ 
else
öö 
{
÷÷ 
int
øø 
	remainder
øø 
;
øø 
Math
ùù 
.
ùù 	
DivRem
ùù	 
(
ùù 
	totalRows
ùù 
,
ùù 
pageSize
ùù #
,
ùù# $
out
ùù% (
	remainder
ùù) 2
)
ùù2 3
;
ùù3 4
if
úú 
(
úú 
	remainder
úú 
>
úú 
$num
úú 
)
úú 
{
ûû 

totalPages
üü 
+=
üü 
$num
üü 
;
üü 
}
ýý 
}
þþ  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D%
GetReadConnectionString
D [
(
[ \
)
\ ]
,
] ^
$str
_ 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
Int
/ 2
,
2 3 
ParameterDirection
4 F
.
F G
Input
G L
,
L M
siteId
N T
)
T U
;
U V
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 '
,
' (
	SqlDbType
) 2
.
2 3
Int
3 6
,
6 7 
ParameterDirection
8 J
.
J K
Input
K P
,
P Q

pageNumber
R \
)
\ ]
;
] ^
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
Int
1 4
,
4 5 
ParameterDirection
6 H
.
H I
Input
I N
,
N O
pageSize
P X
)
X Y
;
Y Z
return
 	
sph

 
.
 
ExecuteReader
 
(
 
)
 
;
 
}
 
public
«« 
static
««	 
int
«« 
AddUser
«« 
(
«« 
Guid
¬¬ 
siteGuid
¬¬ 
,
¬¬ 
int
­­ 
siteId
­­ 
,
­­ 
string
®® 	
fullName
®®
 
,
®® 
String
¯¯ 	
	loginName
¯¯
 
,
¯¯ 
string
°° 	
email
°°
 
,
°° 
string
±± 	
password
±±
 
,
±± 
string
²² 	
passwordSalt
²²
 
,
²² 
Guid
³³ 
userGuid
³³ 
,
³³ 
DateTime
´´ 
dateCreated
´´ 
,
´´ 
bool
µµ 
mustChangePwd
µµ 
,
µµ 
string
¶¶ 	
	firstName
¶¶
 
,
¶¶ 
string
·· 	
lastName
··
 
,
·· 
string
¸¸ 	

timeZoneId
¸¸
 
,
¸¸ 
DateTime
¹¹ 
dateOfBirth
¹¹ 
,
¹¹ 
bool
ºº 
emailConfirmed
ºº 
,
ºº 
int
»» 
	pwdFormat
»» 
,
»» 
string
¼¼ 	
passwordHash
¼¼
 
,
¼¼ 
string
½½ 	
securityStamp
½½
 
,
½½ 
string
¾¾ 	
phoneNumber
¾¾
 
,
¾¾ 
bool
¿¿ "
phoneNumberConfirmed
¿¿ 
,
¿¿ 
bool
ÀÀ 
twoFactorEnabled
ÀÀ 
,
ÀÀ 
DateTime
ÁÁ 
?
ÁÁ 
lockoutEndDateUtc
ÁÁ 
)
ÂÂ 
{
ÃÃ  
SqlParameterHelper
ÅÅ 
sph
ÅÅ 
=
ÅÅ 
new
ÅÅ  
SqlParameterHelper
ÅÅ  2
(
ÅÅ2 3
ConnectionString
ÅÅ3 C
.
ÅÅC D&
GetWriteConnectionString
ÅÅD \
(
ÅÅ\ ]
)
ÅÅ] ^
,
ÅÅ^ _
$str
ÅÅ` q
,
ÅÅq r
$num
ÅÅs u
)
ÅÅu v
;
ÅÅv w
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ 
(
ÆÆ 
$str
ÆÆ %
,
ÆÆ% &
	SqlDbType
ÆÆ' 0
.
ÆÆ0 1
UniqueIdentifier
ÆÆ1 A
,
ÆÆA B 
ParameterDirection
ÆÆC U
.
ÆÆU V
Input
ÆÆV [
,
ÆÆ[ \
siteGuid
ÆÆ] e
)
ÆÆe f
;
ÆÆf g
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ 
(
ÇÇ 
$str
ÇÇ #
,
ÇÇ# $
	SqlDbType
ÇÇ% .
.
ÇÇ. /
Int
ÇÇ/ 2
,
ÇÇ2 3 
ParameterDirection
ÇÇ4 F
.
ÇÇF G
Input
ÇÇG L
,
ÇÇL M
siteId
ÇÇN T
)
ÇÇT U
;
ÇÇU V
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ 
(
ÈÈ 
$str
ÈÈ !
,
ÈÈ! "
	SqlDbType
ÈÈ# ,
.
ÈÈ, -
NVarChar
ÈÈ- 5
,
ÈÈ5 6
$num
ÈÈ7 :
,
ÈÈ: ; 
ParameterDirection
ÈÈ< N
.
ÈÈN O
Input
ÈÈO T
,
ÈÈT U
fullName
ÈÈV ^
)
ÈÈ^ _
;
ÈÈ_ `
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ &
,
ÉÉ& '
	SqlDbType
ÉÉ( 1
.
ÉÉ1 2
NVarChar
ÉÉ2 :
,
ÉÉ: ;
$num
ÉÉ< >
,
ÉÉ> ? 
ParameterDirection
ÉÉ@ R
.
ÉÉR S
Input
ÉÉS X
,
ÉÉX Y
	loginName
ÉÉZ c
)
ÉÉc d
;
ÉÉd e
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ 
(
ÊÊ 
$str
ÊÊ "
,
ÊÊ" #
	SqlDbType
ÊÊ$ -
.
ÊÊ- .
NVarChar
ÊÊ. 6
,
ÊÊ6 7
$num
ÊÊ8 ;
,
ÊÊ; < 
ParameterDirection
ÊÊ= O
.
ÊÊO P
Input
ÊÊP U
,
ÊÊU V
email
ÊÊW \
)
ÊÊ\ ]
;
ÊÊ] ^
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË %
,
ËË% &
	SqlDbType
ËË' 0
.
ËË0 1
NVarChar
ËË1 9
,
ËË9 :
$num
ËË; ?
,
ËË? @ 
ParameterDirection
ËËA S
.
ËËS T
Input
ËËT Y
,
ËËY Z
password
ËË[ c
)
ËËc d
;
ËËd e
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ 
(
ÌÌ 
$str
ÌÌ )
,
ÌÌ) *
	SqlDbType
ÌÌ+ 4
.
ÌÌ4 5
NVarChar
ÌÌ5 =
,
ÌÌ= >
$num
ÌÌ? B
,
ÌÌB C 
ParameterDirection
ÌÌD V
.
ÌÌV W
Input
ÌÌW \
,
ÌÌ\ ]
passwordSalt
ÌÌ^ j
)
ÌÌj k
;
ÌÌk l
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ 
(
ÍÍ 
$str
ÍÍ %
,
ÍÍ% &
	SqlDbType
ÍÍ' 0
.
ÍÍ0 1
UniqueIdentifier
ÍÍ1 A
,
ÍÍA B 
ParameterDirection
ÍÍC U
.
ÍÍU V
Input
ÍÍV [
,
ÍÍ[ \
userGuid
ÍÍ] e
)
ÍÍe f
;
ÍÍf g
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ 
(
ÎÎ 
$str
ÎÎ (
,
ÎÎ( )
	SqlDbType
ÎÎ* 3
.
ÎÎ3 4
DateTime
ÎÎ4 <
,
ÎÎ< = 
ParameterDirection
ÎÎ> P
.
ÎÎP Q
Input
ÎÎQ V
,
ÎÎV W
dateCreated
ÎÎX c
)
ÎÎc d
;
ÎÎd e
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ 
(
ÏÏ 
$str
ÏÏ *
,
ÏÏ* +
	SqlDbType
ÏÏ, 5
.
ÏÏ5 6
Bit
ÏÏ6 9
,
ÏÏ9 : 
ParameterDirection
ÏÏ; M
.
ÏÏM N
Input
ÏÏN S
,
ÏÏS T
mustChangePwd
ÏÏU b
)
ÏÏb c
;
ÏÏc d
sph
ÑÑ 
.
ÑÑ  
DefineSqlParameter
ÑÑ 
(
ÑÑ 
$str
ÑÑ &
,
ÑÑ& '
	SqlDbType
ÑÑ( 1
.
ÑÑ1 2
NVarChar
ÑÑ2 :
,
ÑÑ: ;
$num
ÑÑ< ?
,
ÑÑ? @ 
ParameterDirection
ÑÑA S
.
ÑÑS T
Input
ÑÑT Y
,
ÑÑY Z
	firstName
ÑÑ[ d
)
ÑÑd e
;
ÑÑe f
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ 
(
ÒÒ 
$str
ÒÒ %
,
ÒÒ% &
	SqlDbType
ÒÒ' 0
.
ÒÒ0 1
NVarChar
ÒÒ1 9
,
ÒÒ9 :
$num
ÒÒ; >
,
ÒÒ> ? 
ParameterDirection
ÒÒ@ R
.
ÒÒR S
Input
ÒÒS X
,
ÒÒX Y
lastName
ÒÒZ b
)
ÒÒb c
;
ÒÒc d
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ 
(
ÓÓ 
$str
ÓÓ '
,
ÓÓ' (
	SqlDbType
ÓÓ) 2
.
ÓÓ2 3
NVarChar
ÓÓ3 ;
,
ÓÓ; <
$num
ÓÓ= ?
,
ÓÓ? @ 
ParameterDirection
ÓÓA S
.
ÓÓS T
Input
ÓÓT Y
,
ÓÓY Z

timeZoneId
ÓÓ[ e
)
ÓÓe f
;
ÓÓf g
sph
ÔÔ 
.
ÔÔ  
DefineSqlParameter
ÔÔ 
(
ÔÔ 
$str
ÔÔ ,
,
ÔÔ, -
	SqlDbType
ÔÔ. 7
.
ÔÔ7 8
UniqueIdentifier
ÔÔ8 H
,
ÔÔH I 
ParameterDirection
ÔÔJ \
.
ÔÔ\ ]
Input
ÔÔ] b
,
ÔÔb c
Guid
ÔÔd h
.
ÔÔh i
Empty
ÔÔi n
)
ÔÔn o
;
ÔÔo p
if
ÖÖ 
(
ÖÖ 
dateOfBirth
ÖÖ 
==
ÖÖ 
DateTime
ÖÖ 
.
ÖÖ 
MinValue
ÖÖ '
)
ÖÖ' (
{
×× 
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ 
(
ØØ 
$str
ØØ )
,
ØØ) *
	SqlDbType
ØØ+ 4
.
ØØ4 5
DateTime
ØØ5 =
,
ØØ= > 
ParameterDirection
ØØ? Q
.
ØØQ R
Input
ØØR W
,
ØØW X
DBNull
ØØY _
.
ØØ_ `
Value
ØØ` e
)
ØØe f
;
ØØf g
}
ÙÙ 
else
ÚÚ 
{
ÛÛ 
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ 
(
ÜÜ 
$str
ÜÜ )
,
ÜÜ) *
	SqlDbType
ÜÜ+ 4
.
ÜÜ4 5
DateTime
ÜÜ5 =
,
ÜÜ= > 
ParameterDirection
ÜÜ? Q
.
ÜÜQ R
Input
ÜÜR W
,
ÜÜW X
dateOfBirth
ÜÜY d
)
ÜÜd e
;
ÜÜe f
}
ÝÝ 
sph
ßß 
.
ßß  
DefineSqlParameter
ßß 
(
ßß 
$str
ßß +
,
ßß+ ,
	SqlDbType
ßß- 6
.
ßß6 7
Bit
ßß7 :
,
ßß: ; 
ParameterDirection
ßß< N
.
ßßN O
Input
ßßO T
,
ßßT U
emailConfirmed
ßßV d
)
ßßd e
;
ßße f
sph
àà 
.
àà  
DefineSqlParameter
àà 
(
àà 
$str
àà &
,
àà& '
	SqlDbType
àà( 1
.
àà1 2
Int
àà2 5
,
àà5 6 
ParameterDirection
àà7 I
.
ààI J
Input
ààJ O
,
ààO P
	pwdFormat
ààQ Z
)
ààZ [
;
àà[ \
sph
áá 
.
áá  
DefineSqlParameter
áá 
(
áá 
$str
áá )
,
áá) *
	SqlDbType
áá+ 4
.
áá4 5
NVarChar
áá5 =
,
áá= >
-
áá? @
$num
áá@ A
,
ááA B 
ParameterDirection
ááC U
.
ááU V
Input
ááV [
,
áá[ \
passwordHash
áá] i
)
áái j
;
ááj k
sph
ââ 
.
ââ  
DefineSqlParameter
ââ 
(
ââ 
$str
ââ *
,
ââ* +
	SqlDbType
ââ, 5
.
ââ5 6
NVarChar
ââ6 >
,
ââ> ?
-
ââ@ A
$num
ââA B
,
ââB C 
ParameterDirection
ââD V
.
ââV W
Input
ââW \
,
ââ\ ]
securityStamp
ââ^ k
)
ââk l
;
ââl m
sph
ãã 
.
ãã  
DefineSqlParameter
ãã 
(
ãã 
$str
ãã (
,
ãã( )
	SqlDbType
ãã* 3
.
ãã3 4
NVarChar
ãã4 <
,
ãã< =
$num
ãã> @
,
ãã@ A 
ParameterDirection
ããB T
.
ããT U
Input
ããU Z
,
ããZ [
phoneNumber
ãã\ g
)
ããg h
;
ããh i
sph
ää 
.
ää  
DefineSqlParameter
ää 
(
ää 
$str
ää 1
,
ää1 2
	SqlDbType
ää3 <
.
ää< =
Bit
ää= @
,
ää@ A 
ParameterDirection
ääB T
.
ääT U
Input
ääU Z
,
ääZ ["
phoneNumberConfirmed
ää\ p
)
ääp q
;
ääq r
sph
åå 
.
åå  
DefineSqlParameter
åå 
(
åå 
$str
åå -
,
åå- .
	SqlDbType
åå/ 8
.
åå8 9
Bit
åå9 <
,
åå< = 
ParameterDirection
åå> P
.
ååP Q
Input
ååQ V
,
ååV W
twoFactorEnabled
ååX h
)
ååh i
;
ååi j
if
ææ 
(
ææ 
lockoutEndDateUtc
ææ 
==
ææ 
null
ææ  
)
ææ  !
{
çç 
sph
èè 
.
èè  
DefineSqlParameter
èè 
(
èè 
$str
èè /
,
èè/ 0
	SqlDbType
èè1 :
.
èè: ;
DateTime
èè; C
,
èèC D 
ParameterDirection
èèE W
.
èèW X
Input
èèX ]
,
èè] ^
DBNull
èè_ e
.
èèe f
Value
èèf k
)
èèk l
;
èèl m
}
éé 
else
êê 
{
ëë 
sph
ìì 
.
ìì  
DefineSqlParameter
ìì 
(
ìì 
$str
ìì /
,
ìì/ 0
	SqlDbType
ìì1 :
.
ìì: ;
DateTime
ìì; C
,
ììC D 
ParameterDirection
ììE W
.
ììW X
Input
ììX ]
,
ìì] ^
lockoutEndDateUtc
ìì_ p
)
ììp q
;
ììq r
}
íí 
int
ðð 
newID
ðð 
=
ðð 
Convert
ðð 
.
ðð 
ToInt32
ðð 
(
ðð 
sph
ðð "
.
ðð" #
ExecuteScalar
ðð# 0
(
ðð0 1
)
ðð1 2
)
ðð2 3
;
ðð3 4
return
ññ 	
newID
ññ
 
;
ññ 
}
òò 
public
ôô 
static
ôô	 
bool
ôô 

UpdateUser
ôô 
(
ôô  
int
õõ 
userId
õõ 
,
õõ 
string
öö 	
name
öö
 
,
öö 
string
÷÷ 	
	loginName
÷÷
 
,
÷÷ 
string
øø 	
email
øø
 
,
øø 
string
ùù 	
password
ùù
 
,
ùù 
string
úú 	
passwordSalt
úú
 
,
úú 
string
ûû 	
gender
ûû
 
,
ûû 
bool
üü 
profileApproved
üü 
,
üü 
bool
ýý 
approvedForForums
ýý 
,
ýý 
bool
þþ 
trusted
þþ 
,
þþ 
bool
ÿÿ !
displayInMemberList
ÿÿ 
,
ÿÿ 
string
 	

webSiteUrl

 
,
 
string
 	
country

 
,
 
string
 	
state

 
,
 
string
 	

occupation

 
,
 
string
 	
	interests

 
,
 
string
 	
msn

 
,
 
string
 	
yahoo

 
,
 
string
 	
aim

 
,
 
string
 	
icq

 
,
 
string
 	
	avatarUrl

 
,
 
string
 	
	signature

 
,
 
string
 	
skin

 
,
 
string
 	
loweredEmail

 
,
 
string
 	
passwordQuestion

 
,
 
string
 	
passwordAnswer

 
,
 
string
 	
comment

 
,
 
int
 
timeOffsetHours
 
,
 
string
 	
	openIdUri

 
,
 
string
 	
windowsLiveId

 
,
 
bool
 
mustChangePwd
 
,
 
string
 	
	firstName

 
,
 
string
 	
lastName

 
,
 
string
 	

timeZoneId

 
,
 
string
 	
editorPreference

 
,
 
string
 	
newEmail

 
,
 
Guid
 
emailChangeGuid
 
,
 
Guid
 
passwordResetGuid
 
,
 
bool
 
rolesChanged
 
,
 
string
 	
	authorBio

 
,
 
DateTime
 
dateOfBirth
 
,
 
bool
 
emailConfirmed
 
,
 
int
 
	pwdFormat
 
,
 
string
   	
passwordHash
  
 
,
   
string
¡¡ 	
securityStamp
¡¡
 
,
¡¡ 
string
¢¢ 	
phoneNumber
¢¢
 
,
¢¢ 
bool
££ "
phoneNumberConfirmed
££ 
,
££ 
bool
¤¤ 
twoFactorEnabled
¤¤ 
,
¤¤ 
DateTime
¥¥ 
?
¥¥ 
lockoutEndDateUtc
¥¥ 
)
¦¦ 
{
§§  
SqlParameterHelper
¨¨ 
sph
¨¨ 
=
¨¨ 
new
¨¨  
SqlParameterHelper
¨¨  2
(
¨¨2 3
ConnectionString
¨¨3 C
.
¨¨C D&
GetWriteConnectionString
¨¨D \
(
¨¨\ ]
)
¨¨] ^
,
¨¨^ _
$str
¨¨` q
,
¨¨q r
$num
¨¨s u
)
¨¨u v
;
¨¨v w
sph
©© 
.
©©  
DefineSqlParameter
©© 
(
©© 
$str
©© #
,
©©# $
	SqlDbType
©©% .
.
©©. /
Int
©©/ 2
,
©©2 3 
ParameterDirection
©©4 F
.
©©F G
Input
©©G L
,
©©L M
userId
©©N T
)
©©T U
;
©©U V
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª !
,
ªª! "
	SqlDbType
ªª# ,
.
ªª, -
NVarChar
ªª- 5
,
ªª5 6
$num
ªª7 :
,
ªª: ; 
ParameterDirection
ªª< N
.
ªªN O
Input
ªªO T
,
ªªT U
name
ªªV Z
)
ªªZ [
;
ªª[ \
sph
«« 
.
««  
DefineSqlParameter
«« 
(
«« 
$str
«« &
,
««& '
	SqlDbType
««( 1
.
««1 2
NVarChar
««2 :
,
««: ;
$num
««< >
,
««> ? 
ParameterDirection
««@ R
.
««R S
Input
««S X
,
««X Y
	loginName
««Z c
)
««c d
;
««d e
sph
¬¬ 
.
¬¬  
DefineSqlParameter
¬¬ 
(
¬¬ 
$str
¬¬ "
,
¬¬" #
	SqlDbType
¬¬$ -
.
¬¬- .
NVarChar
¬¬. 6
,
¬¬6 7
$num
¬¬8 ;
,
¬¬; < 
ParameterDirection
¬¬= O
.
¬¬O P
Input
¬¬P U
,
¬¬U V
email
¬¬W \
)
¬¬\ ]
;
¬¬] ^
sph
­­ 
.
­­  
DefineSqlParameter
­­ 
(
­­ 
$str
­­ %
,
­­% &
	SqlDbType
­­' 0
.
­­0 1
NVarChar
­­1 9
,
­­9 :
$num
­­; ?
,
­­? @ 
ParameterDirection
­­A S
.
­­S T
Input
­­T Y
,
­­Y Z
password
­­[ c
)
­­c d
;
­­d e
sph
®® 
.
®®  
DefineSqlParameter
®® 
(
®® 
$str
®® )
,
®®) *
	SqlDbType
®®+ 4
.
®®4 5
NVarChar
®®5 =
,
®®= >
$num
®®? B
,
®®B C 
ParameterDirection
®®D V
.
®®V W
Input
®®W \
,
®®\ ]
passwordSalt
®®^ j
)
®®j k
;
®®k l
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ 
(
¯¯ 
$str
¯¯ #
,
¯¯# $
	SqlDbType
¯¯% .
.
¯¯. /
NChar
¯¯/ 4
,
¯¯4 5
$num
¯¯6 7
,
¯¯7 8 
ParameterDirection
¯¯9 K
.
¯¯K L
Input
¯¯L Q
,
¯¯Q R
gender
¯¯S Y
)
¯¯Y Z
;
¯¯Z [
sph
°° 
.
°°  
DefineSqlParameter
°° 
(
°° 
$str
°° ,
,
°°, -
	SqlDbType
°°. 7
.
°°7 8
Bit
°°8 ;
,
°°; < 
ParameterDirection
°°= O
.
°°O P
Input
°°P U
,
°°U V
profileApproved
°°W f
)
°°f g
;
°°g h
sph
±± 
.
±±  
DefineSqlParameter
±± 
(
±± 
$str
±± .
,
±±. /
	SqlDbType
±±0 9
.
±±9 :
Bit
±±: =
,
±±= > 
ParameterDirection
±±? Q
.
±±Q R
Input
±±R W
,
±±W X
approvedForForums
±±Y j
)
±±j k
;
±±k l
sph
²² 
.
²²  
DefineSqlParameter
²² 
(
²² 
$str
²² $
,
²²$ %
	SqlDbType
²²& /
.
²²/ 0
Bit
²²0 3
,
²²3 4 
ParameterDirection
²²5 G
.
²²G H
Input
²²H M
,
²²M N
trusted
²²O V
)
²²V W
;
²²W X
sph
³³ 
.
³³  
DefineSqlParameter
³³ 
(
³³ 
$str
³³ 0
,
³³0 1
	SqlDbType
³³2 ;
.
³³; <
Bit
³³< ?
,
³³? @ 
ParameterDirection
³³A S
.
³³S T
Input
³³T Y
,
³³Y Z!
displayInMemberList
³³[ n
)
³³n o
;
³³o p
sph
´´ 
.
´´  
DefineSqlParameter
´´ 
(
´´ 
$str
´´ '
,
´´' (
	SqlDbType
´´) 2
.
´´2 3
NVarChar
´´3 ;
,
´´; <
$num
´´= @
,
´´@ A 
ParameterDirection
´´B T
.
´´T U
Input
´´U Z
,
´´Z [

webSiteUrl
´´\ f
)
´´f g
;
´´g h
sph
µµ 
.
µµ  
DefineSqlParameter
µµ 
(
µµ 
$str
µµ $
,
µµ$ %
	SqlDbType
µµ& /
.
µµ/ 0
NVarChar
µµ0 8
,
µµ8 9
$num
µµ: =
,
µµ= > 
ParameterDirection
µµ? Q
.
µµQ R
Input
µµR W
,
µµW X
country
µµY `
)
µµ` a
;
µµa b
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ 
(
¶¶ 
$str
¶¶ "
,
¶¶" #
	SqlDbType
¶¶$ -
.
¶¶- .
NVarChar
¶¶. 6
,
¶¶6 7
$num
¶¶8 ;
,
¶¶; < 
ParameterDirection
¶¶= O
.
¶¶O P
Input
¶¶P U
,
¶¶U V
state
¶¶W \
)
¶¶\ ]
;
¶¶] ^
sph
·· 
.
··  
DefineSqlParameter
·· 
(
·· 
$str
·· '
,
··' (
	SqlDbType
··) 2
.
··2 3
NVarChar
··3 ;
,
··; <
$num
··= @
,
··@ A 
ParameterDirection
··B T
.
··T U
Input
··U Z
,
··Z [

occupation
··\ f
)
··f g
;
··g h
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ 
(
¸¸ 
$str
¸¸ &
,
¸¸& '
	SqlDbType
¸¸( 1
.
¸¸1 2
NVarChar
¸¸2 :
,
¸¸: ;
$num
¸¸< ?
,
¸¸? @ 
ParameterDirection
¸¸A S
.
¸¸S T
Input
¸¸T Y
,
¸¸Y Z
	interests
¸¸[ d
)
¸¸d e
;
¸¸e f
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ 
(
¹¹ 
$str
¹¹  
,
¹¹  !
	SqlDbType
¹¹" +
.
¹¹+ ,
NVarChar
¹¹, 4
,
¹¹4 5
$num
¹¹6 8
,
¹¹8 9 
ParameterDirection
¹¹: L
.
¹¹L M
Input
¹¹M R
,
¹¹R S
msn
¹¹T W
)
¹¹W X
;
¹¹X Y
sph
ºº 
.
ºº  
DefineSqlParameter
ºº 
(
ºº 
$str
ºº "
,
ºº" #
	SqlDbType
ºº$ -
.
ºº- .
NVarChar
ºº. 6
,
ºº6 7
$num
ºº8 :
,
ºº: ; 
ParameterDirection
ºº< N
.
ººN O
Input
ººO T
,
ººT U
yahoo
ººV [
)
ºº[ \
;
ºº\ ]
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»»  
,
»»  !
	SqlDbType
»»" +
.
»»+ ,
NVarChar
»», 4
,
»»4 5
$num
»»6 8
,
»»8 9 
ParameterDirection
»»: L
.
»»L M
Input
»»M R
,
»»R S
aim
»»T W
)
»»W X
;
»»X Y
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ 
(
¼¼ 
$str
¼¼  
,
¼¼  !
	SqlDbType
¼¼" +
.
¼¼+ ,
NVarChar
¼¼, 4
,
¼¼4 5
$num
¼¼6 8
,
¼¼8 9 
ParameterDirection
¼¼: L
.
¼¼L M
Input
¼¼M R
,
¼¼R S
icq
¼¼T W
)
¼¼W X
;
¼¼X Y
sph
½½ 
.
½½  
DefineSqlParameter
½½ 
(
½½ 
$str
½½ &
,
½½& '
	SqlDbType
½½( 1
.
½½1 2
NVarChar
½½2 :
,
½½: ;
$num
½½< ?
,
½½? @ 
ParameterDirection
½½A S
.
½½S T
Input
½½T Y
,
½½Y Z
	avatarUrl
½½[ d
)
½½d e
;
½½e f
sph
¾¾ 
.
¾¾  
DefineSqlParameter
¾¾ 
(
¾¾ 
$str
¾¾ &
,
¾¾& '
	SqlDbType
¾¾( 1
.
¾¾1 2
NVarChar
¾¾2 :
,
¾¾: ;
-
¾¾< =
$num
¾¾= >
,
¾¾> ? 
ParameterDirection
¾¾@ R
.
¾¾R S
Input
¾¾S X
,
¾¾X Y
	signature
¾¾Z c
)
¾¾c d
;
¾¾d e
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ 
(
¿¿ 
$str
¿¿ !
,
¿¿! "
	SqlDbType
¿¿# ,
.
¿¿, -
NVarChar
¿¿- 5
,
¿¿5 6
$num
¿¿7 :
,
¿¿: ; 
ParameterDirection
¿¿< N
.
¿¿N O
Input
¿¿O T
,
¿¿T U
skin
¿¿V Z
)
¿¿Z [
;
¿¿[ \
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ 
(
ÀÀ 
$str
ÀÀ )
,
ÀÀ) *
	SqlDbType
ÀÀ+ 4
.
ÀÀ4 5
NVarChar
ÀÀ5 =
,
ÀÀ= >
$num
ÀÀ? B
,
ÀÀB C 
ParameterDirection
ÀÀD V
.
ÀÀV W
Input
ÀÀW \
,
ÀÀ\ ]
loweredEmail
ÀÀ^ j
)
ÀÀj k
;
ÀÀk l
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ 
(
ÁÁ 
$str
ÁÁ -
,
ÁÁ- .
	SqlDbType
ÁÁ/ 8
.
ÁÁ8 9
NVarChar
ÁÁ9 A
,
ÁÁA B
$num
ÁÁC F
,
ÁÁF G 
ParameterDirection
ÁÁH Z
.
ÁÁZ [
Input
ÁÁ[ `
,
ÁÁ` a
passwordQuestion
ÁÁb r
)
ÁÁr s
;
ÁÁs t
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ 
(
ÂÂ 
$str
ÂÂ +
,
ÂÂ+ ,
	SqlDbType
ÂÂ- 6
.
ÂÂ6 7
NVarChar
ÂÂ7 ?
,
ÂÂ? @
$num
ÂÂA D
,
ÂÂD E 
ParameterDirection
ÂÂF X
.
ÂÂX Y
Input
ÂÂY ^
,
ÂÂ^ _
passwordAnswer
ÂÂ` n
)
ÂÂn o
;
ÂÂo p
sph
ÃÃ 
.
ÃÃ  
DefineSqlParameter
ÃÃ 
(
ÃÃ 
$str
ÃÃ $
,
ÃÃ$ %
	SqlDbType
ÃÃ& /
.
ÃÃ/ 0
NVarChar
ÃÃ0 8
,
ÃÃ8 9
-
ÃÃ: ;
$num
ÃÃ; <
,
ÃÃ< = 
ParameterDirection
ÃÃ> P
.
ÃÃP Q
Input
ÃÃQ V
,
ÃÃV W
comment
ÃÃX _
)
ÃÃ_ `
;
ÃÃ` a
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ 
(
ÄÄ 
$str
ÄÄ ,
,
ÄÄ, -
	SqlDbType
ÄÄ. 7
.
ÄÄ7 8
Int
ÄÄ8 ;
,
ÄÄ; < 
ParameterDirection
ÄÄ= O
.
ÄÄO P
Input
ÄÄP U
,
ÄÄU V
timeOffsetHours
ÄÄW f
)
ÄÄf g
;
ÄÄg h
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ 
(
ÅÅ 
$str
ÅÅ &
,
ÅÅ& '
	SqlDbType
ÅÅ( 1
.
ÅÅ1 2
NVarChar
ÅÅ2 :
,
ÅÅ: ;
$num
ÅÅ< ?
,
ÅÅ? @ 
ParameterDirection
ÅÅA S
.
ÅÅS T
Input
ÅÅT Y
,
ÅÅY Z
	openIdUri
ÅÅ[ d
)
ÅÅd e
;
ÅÅe f
sph
ÆÆ 
.
ÆÆ  
DefineSqlParameter
ÆÆ 
(
ÆÆ 
$str
ÆÆ *
,
ÆÆ* +
	SqlDbType
ÆÆ, 5
.
ÆÆ5 6
NVarChar
ÆÆ6 >
,
ÆÆ> ?
$num
ÆÆ@ C
,
ÆÆC D 
ParameterDirection
ÆÆE W
.
ÆÆW X
Input
ÆÆX ]
,
ÆÆ] ^
windowsLiveId
ÆÆ_ l
)
ÆÆl m
;
ÆÆm n
sph
ÇÇ 
.
ÇÇ  
DefineSqlParameter
ÇÇ 
(
ÇÇ 
$str
ÇÇ *
,
ÇÇ* +
	SqlDbType
ÇÇ, 5
.
ÇÇ5 6
Bit
ÇÇ6 9
,
ÇÇ9 : 
ParameterDirection
ÇÇ; M
.
ÇÇM N
Input
ÇÇN S
,
ÇÇS T
mustChangePwd
ÇÇU b
)
ÇÇb c
;
ÇÇc d
sph
ÈÈ 
.
ÈÈ  
DefineSqlParameter
ÈÈ 
(
ÈÈ 
$str
ÈÈ &
,
ÈÈ& '
	SqlDbType
ÈÈ( 1
.
ÈÈ1 2
NVarChar
ÈÈ2 :
,
ÈÈ: ;
$num
ÈÈ< ?
,
ÈÈ? @ 
ParameterDirection
ÈÈA S
.
ÈÈS T
Input
ÈÈT Y
,
ÈÈY Z
	firstName
ÈÈ[ d
)
ÈÈd e
;
ÈÈe f
sph
ÉÉ 
.
ÉÉ  
DefineSqlParameter
ÉÉ 
(
ÉÉ 
$str
ÉÉ %
,
ÉÉ% &
	SqlDbType
ÉÉ' 0
.
ÉÉ0 1
NVarChar
ÉÉ1 9
,
ÉÉ9 :
$num
ÉÉ; >
,
ÉÉ> ? 
ParameterDirection
ÉÉ@ R
.
ÉÉR S
Input
ÉÉS X
,
ÉÉX Y
lastName
ÉÉZ b
)
ÉÉb c
;
ÉÉc d
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ 
(
ÊÊ 
$str
ÊÊ '
,
ÊÊ' (
	SqlDbType
ÊÊ) 2
.
ÊÊ2 3
NVarChar
ÊÊ3 ;
,
ÊÊ; <
$num
ÊÊ= ?
,
ÊÊ? @ 
ParameterDirection
ÊÊA S
.
ÊÊS T
Input
ÊÊT Y
,
ÊÊY Z

timeZoneId
ÊÊ[ e
)
ÊÊe f
;
ÊÊf g
sph
ËË 
.
ËË  
DefineSqlParameter
ËË 
(
ËË 
$str
ËË -
,
ËË- .
	SqlDbType
ËË/ 8
.
ËË8 9
NVarChar
ËË9 A
,
ËËA B
$num
ËËC F
,
ËËF G 
ParameterDirection
ËËH Z
.
ËËZ [
Input
ËË[ `
,
ËË` a
editorPreference
ËËb r
)
ËËr s
;
ËËs t
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ 
(
ÌÌ 
$str
ÌÌ %
,
ÌÌ% &
	SqlDbType
ÌÌ' 0
.
ÌÌ0 1
NVarChar
ÌÌ1 9
,
ÌÌ9 :
$num
ÌÌ; >
,
ÌÌ> ? 
ParameterDirection
ÌÌ@ R
.
ÌÌR S
Input
ÌÌS X
,
ÌÌX Y
newEmail
ÌÌZ b
)
ÌÌb c
;
ÌÌc d
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ 
(
ÍÍ 
$str
ÍÍ ,
,
ÍÍ, -
	SqlDbType
ÍÍ. 7
.
ÍÍ7 8
UniqueIdentifier
ÍÍ8 H
,
ÍÍH I 
ParameterDirection
ÍÍJ \
.
ÍÍ\ ]
Input
ÍÍ] b
,
ÍÍb c
emailChangeGuid
ÍÍd s
)
ÍÍs t
;
ÍÍt u
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ 
(
ÎÎ 
$str
ÎÎ .
,
ÎÎ. /
	SqlDbType
ÎÎ0 9
.
ÎÎ9 :
UniqueIdentifier
ÎÎ: J
,
ÎÎJ K 
ParameterDirection
ÎÎL ^
.
ÎÎ^ _
Input
ÎÎ_ d
,
ÎÎd e
passwordResetGuid
ÎÎf w
)
ÎÎw x
;
ÎÎx y
sph
ÏÏ 
.
ÏÏ  
DefineSqlParameter
ÏÏ 
(
ÏÏ 
$str
ÏÏ )
,
ÏÏ) *
	SqlDbType
ÏÏ+ 4
.
ÏÏ4 5
Bit
ÏÏ5 8
,
ÏÏ8 9 
ParameterDirection
ÏÏ: L
.
ÏÏL M
Input
ÏÏM R
,
ÏÏR S
rolesChanged
ÏÏT `
)
ÏÏ` a
;
ÏÏa b
sph
ÐÐ 
.
ÐÐ  
DefineSqlParameter
ÐÐ 
(
ÐÐ 
$str
ÐÐ &
,
ÐÐ& '
	SqlDbType
ÐÐ( 1
.
ÐÐ1 2
NVarChar
ÐÐ2 :
,
ÐÐ: ;
-
ÐÐ< =
$num
ÐÐ= >
,
ÐÐ> ? 
ParameterDirection
ÐÐ@ R
.
ÐÐR S
Input
ÐÐS X
,
ÐÐX Y
	authorBio
ÐÐZ c
)
ÐÐc d
;
ÐÐd e
if
ÑÑ 
(
ÑÑ 
dateOfBirth
ÑÑ 
==
ÑÑ 
DateTime
ÑÑ 
.
ÑÑ 
MinValue
ÑÑ '
)
ÑÑ' (
{
ÒÒ 
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ 
(
ÓÓ 
$str
ÓÓ )
,
ÓÓ) *
	SqlDbType
ÓÓ+ 4
.
ÓÓ4 5
DateTime
ÓÓ5 =
,
ÓÓ= > 
ParameterDirection
ÓÓ? Q
.
ÓÓQ R
Input
ÓÓR W
,
ÓÓW X
DBNull
ÓÓY _
.
ÓÓ_ `
Value
ÓÓ` e
)
ÓÓe f
;
ÓÓf g
}
ÔÔ 
else
ÕÕ 
{
ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× 
(
×× 
$str
×× )
,
××) *
	SqlDbType
××+ 4
.
××4 5
DateTime
××5 =
,
××= > 
ParameterDirection
××? Q
.
××Q R
Input
××R W
,
××W X
dateOfBirth
××Y d
)
××d e
;
××e f
}
ØØ 
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ 
(
ÚÚ 
$str
ÚÚ &
,
ÚÚ& '
	SqlDbType
ÚÚ( 1
.
ÚÚ1 2
Int
ÚÚ2 5
,
ÚÚ5 6 
ParameterDirection
ÚÚ7 I
.
ÚÚI J
Input
ÚÚJ O
,
ÚÚO P
	pwdFormat
ÚÚQ Z
)
ÚÚZ [
;
ÚÚ[ \
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ 
(
ÛÛ 
$str
ÛÛ +
,
ÛÛ+ ,
	SqlDbType
ÛÛ- 6
.
ÛÛ6 7
Bit
ÛÛ7 :
,
ÛÛ: ; 
ParameterDirection
ÛÛ< N
.
ÛÛN O
Input
ÛÛO T
,
ÛÛT U
emailConfirmed
ÛÛV d
)
ÛÛd e
;
ÛÛe f
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ 
(
ÜÜ 
$str
ÜÜ )
,
ÜÜ) *
	SqlDbType
ÜÜ+ 4
.
ÜÜ4 5
NVarChar
ÜÜ5 =
,
ÜÜ= >
-
ÜÜ? @
$num
ÜÜ@ A
,
ÜÜA B 
ParameterDirection
ÜÜC U
.
ÜÜU V
Input
ÜÜV [
,
ÜÜ[ \
passwordHash
ÜÜ] i
)
ÜÜi j
;
ÜÜj k
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ 
(
ÝÝ 
$str
ÝÝ *
,
ÝÝ* +
	SqlDbType
ÝÝ, 5
.
ÝÝ5 6
NVarChar
ÝÝ6 >
,
ÝÝ> ?
-
ÝÝ@ A
$num
ÝÝA B
,
ÝÝB C 
ParameterDirection
ÝÝD V
.
ÝÝV W
Input
ÝÝW \
,
ÝÝ\ ]
securityStamp
ÝÝ^ k
)
ÝÝk l
;
ÝÝl m
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ 
(
ÞÞ 
$str
ÞÞ (
,
ÞÞ( )
	SqlDbType
ÞÞ* 3
.
ÞÞ3 4
NVarChar
ÞÞ4 <
,
ÞÞ< =
$num
ÞÞ> @
,
ÞÞ@ A 
ParameterDirection
ÞÞB T
.
ÞÞT U
Input
ÞÞU Z
,
ÞÞZ [
phoneNumber
ÞÞ\ g
)
ÞÞg h
;
ÞÞh i
sph
ßß 
.
ßß  
DefineSqlParameter
ßß 
(
ßß 
$str
ßß 1
,
ßß1 2
	SqlDbType
ßß3 <
.
ßß< =
Bit
ßß= @
,
ßß@ A 
ParameterDirection
ßßB T
.
ßßT U
Input
ßßU Z
,
ßßZ ["
phoneNumberConfirmed
ßß\ p
)
ßßp q
;
ßßq r
sph
àà 
.
àà  
DefineSqlParameter
àà 
(
àà 
$str
àà -
,
àà- .
	SqlDbType
àà/ 8
.
àà8 9
Bit
àà9 <
,
àà< = 
ParameterDirection
àà> P
.
ààP Q
Input
ààQ V
,
ààV W
twoFactorEnabled
ààX h
)
ààh i
;
àài j
if
áá 
(
áá 
lockoutEndDateUtc
áá 
==
áá 
null
áá  
)
áá  !
{
ââ 
sph
ãã 
.
ãã  
DefineSqlParameter
ãã 
(
ãã 
$str
ãã /
,
ãã/ 0
	SqlDbType
ãã1 :
.
ãã: ;
DateTime
ãã; C
,
ããC D 
ParameterDirection
ããE W
.
ããW X
Input
ããX ]
,
ãã] ^
DBNull
ãã_ e
.
ããe f
Value
ããf k
)
ããk l
;
ããl m
}
ää 
else
åå 
{
ææ 
sph
çç 
.
çç  
DefineSqlParameter
çç 
(
çç 
$str
çç /
,
çç/ 0
	SqlDbType
çç1 :
.
çç: ;
DateTime
çç; C
,
ççC D 
ParameterDirection
ççE W
.
ççW X
Input
ççX ]
,
çç] ^
lockoutEndDateUtc
çç_ p
)
ççp q
;
ççq r
}
èè 
int
êê 
rowsAffected
êê 
=
êê 
sph
êê 
.
êê 
ExecuteNonQuery
êê )
(
êê) *
)
êê* +
;
êê+ ,
return
ëë 	
(
ëë
 
rowsAffected
ëë 
>
ëë 
-
ëë 
$num
ëë 
)
ëë 
;
ëë 
}
ìì 
public
ïï 
static
ïï	 
bool
ïï 

DeleteUser
ïï 
(
ïï  
int
ïï  #
userId
ïï$ *
)
ïï* +
{
ðð  
SqlParameterHelper
ññ 
sph
ññ 
=
ññ 
new
ññ  
SqlParameterHelper
ññ  2
(
ññ2 3
ConnectionString
ññ3 C
.
ññC D&
GetWriteConnectionString
ññD \
(
ññ\ ]
)
ññ] ^
,
ññ^ _
$str
ññ` q
,
ññq r
$num
ññs t
)
ññt u
;
ññu v
sph
òò 
.
òò  
DefineSqlParameter
òò 
(
òò 
$str
òò #
,
òò# $
	SqlDbType
òò% .
.
òò. /
Int
òò/ 2
,
òò2 3 
ParameterDirection
òò4 F
.
òòF G
Input
òòG L
,
òòL M
userId
òòN T
)
òòT U
;
òòU V
int
óó 
rowsAffected
óó 
=
óó 
sph
óó 
.
óó 
ExecuteNonQuery
óó )
(
óó) *
)
óó* +
;
óó+ ,
return
ôô 	
(
ôô
 
rowsAffected
ôô 
>
ôô 
-
ôô 
$num
ôô 
)
ôô 
;
ôô 
}
õõ 
public
÷÷ 
static
÷÷	 
bool
÷÷ $
UpdateLastActivityTime
÷÷ +
(
÷÷+ ,
Guid
÷÷, 0
userGuid
÷÷1 9
,
÷÷9 :
DateTime
÷÷; C

lastUpdate
÷÷D N
)
÷÷N O
{
øø  
SqlParameterHelper
ùù 
sph
ùù 
=
ùù 
new
ùù  
SqlParameterHelper
ùù  2
(
ùù2 3
ConnectionString
ùù3 C
.
ùùC D&
GetWriteConnectionString
ùùD \
(
ùù\ ]
)
ùù] ^
,
ùù^ _
$strùù` 
,ùù 
$numùù 
)ùù 
;ùù 
sph
úú 
.
úú  
DefineSqlParameter
úú 
(
úú 
$str
úú #
,
úú# $
	SqlDbType
úú% .
.
úú. /
UniqueIdentifier
úú/ ?
,
úú? @ 
ParameterDirection
úúA S
.
úúS T
Input
úúT Y
,
úúY Z
userGuid
úú[ c
)
úúc d
;
úúd e
sph
ûû 
.
ûû  
DefineSqlParameter
ûû 
(
ûû 
$str
ûû '
,
ûû' (
	SqlDbType
ûû) 2
.
ûû2 3
DateTime
ûû3 ;
,
ûû; < 
ParameterDirection
ûû= O
.
ûûO P
Input
ûûP U
,
ûûU V

lastUpdate
ûûW a
)
ûûa b
;
ûûb c
int
üü 
rowsAffected
üü 
=
üü 
sph
üü 
.
üü 
ExecuteNonQuery
üü )
(
üü) *
)
üü* +
;
üü+ ,
return
ýý 	
(
ýý
 
rowsAffected
ýý 
>
ýý 
-
ýý 
$num
ýý 
)
ýý 
;
ýý 
}
þþ 
public
 
static
	 
bool
 !
UpdateLastLoginTime
 (
(
( )
Guid
) -
userGuid
. 6
,
6 7
DateTime
8 @
lastLoginTime
A N
)
N O
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` ~
,
~ 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
UniqueIdentifier
/ ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
userGuid
[ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 *
,
* +
	SqlDbType
, 5
.
5 6
DateTime
6 >
,
> ? 
ParameterDirection
@ R
.
R S
Input
S X
,
X Y
lastLoginTime
Z g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 *
UpdateLastPasswordChangeTime
 1
(
1 2
Guid
2 6
userGuid
7 ?
,
? @
DateTime
A I$
lastPasswordChangeTime
J `
)
` a
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
UniqueIdentifier
/ ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
userGuid
[ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 /
,
/ 0
	SqlDbType
1 :
.
: ;
DateTime
; C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^$
lastPasswordChangeTime
_ u
)
u v
;
v w
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 4
&UpdateFailedPasswordAttemptStartWindow
 ;
(
; <
Guid
 
userGuid
 
,
 
DateTime
 
windowStartTime
 
)
 
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
userGuid
] e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 ,
,
, -
	SqlDbType
. 7
.
7 8
DateTime
8 @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
windowStartTime
\ k
)
k l
;
l m
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 .
 UpdateFailedPasswordAttemptCount
 5
(
5 6
Guid
 
userGuid
 
,
 
int
 
attemptCount
 
)
 
{
    
SqlParameterHelper
¡¡ 
sph
¡¡ 
=
¡¡ 
new
¡¡  
SqlParameterHelper
¡¡  2
(
¡¡2 3
ConnectionString
¡¡3 C
.
¡¡C D&
GetWriteConnectionString
¡¡D \
(
¡¡\ ]
)
¡¡] ^
,
¡¡^ _
$str¡¡` 
,¡¡ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ 
(
¢¢ 
$str
¢¢ %
,
¢¢% &
	SqlDbType
¢¢' 0
.
¢¢0 1
UniqueIdentifier
¢¢1 A
,
¢¢A B 
ParameterDirection
¢¢C U
.
¢¢U V
Input
¢¢V [
,
¢¢[ \
userGuid
¢¢] e
)
¢¢e f
;
¢¢f g
sph
££ 
.
££  
DefineSqlParameter
££ 
(
££ 
$str
££ )
,
££) *
	SqlDbType
££+ 4
.
££4 5
Int
££5 8
,
££8 9 
ParameterDirection
££: L
.
££L M
Input
££M R
,
££R S
attemptCount
££T `
)
££` a
;
££a b
int
¤¤ 
rowsAffected
¤¤ 
=
¤¤ 
sph
¤¤ 
.
¤¤ 
ExecuteNonQuery
¤¤ )
(
¤¤) *
)
¤¤* +
;
¤¤+ ,
return
¥¥ 	
(
¥¥
 
rowsAffected
¥¥ 
>
¥¥ 
-
¥¥ 
$num
¥¥ 
)
¥¥ 
;
¥¥ 
}
¦¦ 
public
¨¨ 
static
¨¨	 
bool
¨¨ :
,UpdateFailedPasswordAnswerAttemptStartWindow
¨¨ A
(
¨¨A B
Guid
©© 
userGuid
©© 
,
©© 
DateTime
ªª 
windowStartTime
ªª 
)
ªª 
{
««  
SqlParameterHelper
¬¬ 
sph
¬¬ 
=
¬¬ 
new
¬¬  
SqlParameterHelper
¬¬  2
(
¬¬2 3
ConnectionString
¬¬3 C
.
¬¬C D&
GetWriteConnectionString
¬¬D \
(
¬¬\ ]
)
¬¬] ^
,
¬¬^ _
$str¬¬` 
,¬¬ 
$num¬¬ 
)¬¬ 
;¬¬ 
sph
­­ 
.
­­  
DefineSqlParameter
­­ 
(
­­ 
$str
­­ %
,
­­% &
	SqlDbType
­­' 0
.
­­0 1
UniqueIdentifier
­­1 A
,
­­A B 
ParameterDirection
­­C U
.
­­U V
Input
­­V [
,
­­[ \
userGuid
­­] e
)
­­e f
;
­­f g
sph
®® 
.
®®  
DefineSqlParameter
®® 
(
®® 
$str
®® ,
,
®®, -
	SqlDbType
®®. 7
.
®®7 8
DateTime
®®8 @
,
®®@ A 
ParameterDirection
®®B T
.
®®T U
Input
®®U Z
,
®®Z [
windowStartTime
®®\ k
)
®®k l
;
®®l m
int
¯¯ 
rowsAffected
¯¯ 
=
¯¯ 
sph
¯¯ 
.
¯¯ 
ExecuteNonQuery
¯¯ )
(
¯¯) *
)
¯¯* +
;
¯¯+ ,
return
°° 	
(
°°
 
rowsAffected
°° 
>
°° 
-
°° 
$num
°° 
)
°° 
;
°° 
}
±± 
public
³³ 
static
³³	 
bool
³³ 4
&UpdateFailedPasswordAnswerAttemptCount
³³ ;
(
³³; <
Guid
´´ 
userGuid
´´ 
,
´´ 
int
µµ 
attemptCount
µµ 
)
µµ 
{
¶¶  
SqlParameterHelper
·· 
sph
·· 
=
·· 
new
··  
SqlParameterHelper
··  2
(
··2 3
ConnectionString
··3 C
.
··C D&
GetWriteConnectionString
··D \
(
··\ ]
)
··] ^
,
··^ _
$str··` 
,·· 
$num·· 
)·· 
;·· 
sph
¸¸ 
.
¸¸  
DefineSqlParameter
¸¸ 
(
¸¸ 
$str
¸¸ %
,
¸¸% &
	SqlDbType
¸¸' 0
.
¸¸0 1
UniqueIdentifier
¸¸1 A
,
¸¸A B 
ParameterDirection
¸¸C U
.
¸¸U V
Input
¸¸V [
,
¸¸[ \
userGuid
¸¸] e
)
¸¸e f
;
¸¸f g
sph
¹¹ 
.
¹¹  
DefineSqlParameter
¹¹ 
(
¹¹ 
$str
¹¹ )
,
¹¹) *
	SqlDbType
¹¹+ 4
.
¹¹4 5
Int
¹¹5 8
,
¹¹8 9 
ParameterDirection
¹¹: L
.
¹¹L M
Input
¹¹M R
,
¹¹R S
attemptCount
¹¹T `
)
¹¹` a
;
¹¹a b
int
ºº 
rowsAffected
ºº 
=
ºº 
sph
ºº 
.
ºº 
ExecuteNonQuery
ºº )
(
ºº) *
)
ºº* +
;
ºº+ ,
return
»» 	
(
»»
 
rowsAffected
»» 
>
»» 
-
»» 
$num
»» 
)
»» 
;
»» 
}
¼¼ 
public
¾¾ 
static
¾¾	 
bool
¾¾ 
AccountLockout
¾¾ #
(
¾¾# $
Guid
¾¾$ (
userGuid
¾¾) 1
,
¾¾1 2
DateTime
¾¾3 ;
lockoutTime
¾¾< G
)
¾¾G H
{
¿¿  
SqlParameterHelper
ÀÀ 
sph
ÀÀ 
=
ÀÀ 
new
ÀÀ  
SqlParameterHelper
ÀÀ  2
(
ÀÀ2 3
ConnectionString
ÀÀ3 C
.
ÀÀC D&
GetWriteConnectionString
ÀÀD \
(
ÀÀ\ ]
)
ÀÀ] ^
,
ÀÀ^ _
$str
ÀÀ` y
,
ÀÀy z
$num
ÀÀ{ |
)
ÀÀ| }
;
ÀÀ} ~
sph
ÁÁ 
.
ÁÁ  
DefineSqlParameter
ÁÁ 
(
ÁÁ 
$str
ÁÁ %
,
ÁÁ% &
	SqlDbType
ÁÁ' 0
.
ÁÁ0 1
UniqueIdentifier
ÁÁ1 A
,
ÁÁA B 
ParameterDirection
ÁÁC U
.
ÁÁU V
Input
ÁÁV [
,
ÁÁ[ \
userGuid
ÁÁ] e
)
ÁÁe f
;
ÁÁf g
sph
ÂÂ 
.
ÂÂ  
DefineSqlParameter
ÂÂ 
(
ÂÂ 
$str
ÂÂ (
,
ÂÂ( )
	SqlDbType
ÂÂ* 3
.
ÂÂ3 4
DateTime
ÂÂ4 <
,
ÂÂ< = 
ParameterDirection
ÂÂ> P
.
ÂÂP Q
Input
ÂÂQ V
,
ÂÂV W
lockoutTime
ÂÂX c
)
ÂÂc d
;
ÂÂd e
int
ÃÃ 
rowsAffected
ÃÃ 
=
ÃÃ 
sph
ÃÃ 
.
ÃÃ 
ExecuteNonQuery
ÃÃ )
(
ÃÃ) *
)
ÃÃ* +
;
ÃÃ+ ,
return
ÄÄ 	
(
ÄÄ
 
rowsAffected
ÄÄ 
>
ÄÄ 
-
ÄÄ 
$num
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
public
ÇÇ 
static
ÇÇ	 
bool
ÇÇ !
AccountClearLockout
ÇÇ (
(
ÇÇ( )
Guid
ÇÇ) -
userGuid
ÇÇ. 6
)
ÇÇ6 7
{
ÈÈ  
SqlParameterHelper
ÉÉ 
sph
ÉÉ 
=
ÉÉ 
new
ÉÉ  
SqlParameterHelper
ÉÉ  2
(
ÉÉ2 3
ConnectionString
ÉÉ3 C
.
ÉÉC D&
GetWriteConnectionString
ÉÉD \
(
ÉÉ\ ]
)
ÉÉ] ^
,
ÉÉ^ _
$str
ÉÉ` ~
,
ÉÉ~ 
$numÉÉ 
)ÉÉ 
;ÉÉ 
sph
ÊÊ 
.
ÊÊ  
DefineSqlParameter
ÊÊ 
(
ÊÊ 
$str
ÊÊ %
,
ÊÊ% &
	SqlDbType
ÊÊ' 0
.
ÊÊ0 1
UniqueIdentifier
ÊÊ1 A
,
ÊÊA B 
ParameterDirection
ÊÊC U
.
ÊÊU V
Input
ÊÊV [
,
ÊÊ[ \
userGuid
ÊÊ] e
)
ÊÊe f
;
ÊÊf g
int
ËË 
rowsAffected
ËË 
=
ËË 
sph
ËË 
.
ËË 
ExecuteNonQuery
ËË )
(
ËË) *
)
ËË* +
;
ËË+ ,
return
ÌÌ 	
(
ÌÌ
 
rowsAffected
ÌÌ 
>
ÌÌ 
-
ÌÌ 
$num
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÍÍ 
public
ÏÏ 
static
ÏÏ	 
bool
ÏÏ -
SetRegistrationConfirmationGuid
ÏÏ 4
(
ÏÏ4 5
Guid
ÏÏ5 9
userGuid
ÏÏ: B
,
ÏÏB C
Guid
ÏÏD H*
registrationConfirmationGuid
ÏÏI e
)
ÏÏe f
{
ÐÐ  
SqlParameterHelper
ÑÑ 
sph
ÑÑ 
=
ÑÑ 
new
ÑÑ  
SqlParameterHelper
ÑÑ  2
(
ÑÑ2 3
ConnectionString
ÑÑ3 C
.
ÑÑC D&
GetWriteConnectionString
ÑÑD \
(
ÑÑ\ ]
)
ÑÑ] ^
,
ÑÑ^ _
$strÑÑ` 
,ÑÑ 
$numÑÑ 
)ÑÑ 
;ÑÑ 
sph
ÒÒ 
.
ÒÒ  
DefineSqlParameter
ÒÒ 
(
ÒÒ 
$str
ÒÒ %
,
ÒÒ% &
	SqlDbType
ÒÒ' 0
.
ÒÒ0 1
UniqueIdentifier
ÒÒ1 A
,
ÒÒA B 
ParameterDirection
ÒÒC U
.
ÒÒU V
Input
ÒÒV [
,
ÒÒ[ \
userGuid
ÒÒ] e
)
ÒÒe f
;
ÒÒf g
sph
ÓÓ 
.
ÓÓ  
DefineSqlParameter
ÓÓ 
(
ÓÓ 
$str
ÓÓ 0
,
ÓÓ0 1
	SqlDbType
ÓÓ2 ;
.
ÓÓ; <
UniqueIdentifier
ÓÓ< L
,
ÓÓL M 
ParameterDirection
ÓÓN `
.
ÓÓ` a
Input
ÓÓa f
,
ÓÓf g+
registrationConfirmationGuidÓÓh 
)ÓÓ 
;ÓÓ 
int
ÔÔ 
rowsAffected
ÔÔ 
=
ÔÔ 
sph
ÔÔ 
.
ÔÔ 
ExecuteNonQuery
ÔÔ )
(
ÔÔ) *
)
ÔÔ* +
;
ÔÔ+ ,
return
ÕÕ 	
(
ÕÕ
 
rowsAffected
ÕÕ 
>
ÕÕ 
-
ÕÕ 
$num
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
ÖÖ 
public
ØØ 
static
ØØ	 
bool
ØØ !
ConfirmRegistration
ØØ (
(
ØØ( )
Guid
ØØ) -
	emptyGuid
ØØ. 7
,
ØØ7 8
Guid
ØØ9 =*
registrationConfirmationGuid
ØØ> Z
)
ØØZ [
{
ÙÙ  
SqlParameterHelper
ÚÚ 
sph
ÚÚ 
=
ÚÚ 
new
ÚÚ  
SqlParameterHelper
ÚÚ  2
(
ÚÚ2 3
ConnectionString
ÚÚ3 C
.
ÚÚC D&
GetWriteConnectionString
ÚÚD \
(
ÚÚ\ ]
)
ÚÚ] ^
,
ÚÚ^ _
$str
ÚÚ` ~
,
ÚÚ~ 
$numÚÚ 
)ÚÚ 
;ÚÚ 
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ 
(
ÛÛ 
$str
ÛÛ &
,
ÛÛ& '
	SqlDbType
ÛÛ( 1
.
ÛÛ1 2
UniqueIdentifier
ÛÛ2 B
,
ÛÛB C 
ParameterDirection
ÛÛD V
.
ÛÛV W
Input
ÛÛW \
,
ÛÛ\ ]
	emptyGuid
ÛÛ^ g
)
ÛÛg h
;
ÛÛh i
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ 
(
ÜÜ 
$str
ÜÜ 0
,
ÜÜ0 1
	SqlDbType
ÜÜ2 ;
.
ÜÜ; <
UniqueIdentifier
ÜÜ< L
,
ÜÜL M 
ParameterDirection
ÜÜN `
.
ÜÜ` a
Input
ÜÜa f
,
ÜÜf g+
registrationConfirmationGuidÜÜh 
)ÜÜ 
;ÜÜ 
int
ÝÝ 
rowsAffected
ÝÝ 
=
ÝÝ 
sph
ÝÝ 
.
ÝÝ 
ExecuteNonQuery
ÝÝ )
(
ÝÝ) *
)
ÝÝ* +
;
ÝÝ+ ,
return
ÞÞ 	
(
ÞÞ
 
rowsAffected
ÞÞ 
>
ÞÞ 
-
ÞÞ 
$num
ÞÞ 
)
ÞÞ 
;
ÞÞ 
}
ßß 
public
áá 
static
áá	 
bool
áá #
UpdatePasswordAndSalt
áá *
(
áá* +
int
ââ 
userId
ââ 
,
ââ 
int
ãã 
	pwdFormat
ãã 
,
ãã 
string
ää 	
password
ää
 
,
ää 
string
åå 	
passwordSalt
åå
 
)
åå 
{
ææ  
SqlParameterHelper
çç 
sph
çç 
=
çç 
new
çç  
SqlParameterHelper
çç  2
(
çç2 3
ConnectionString
çç3 C
.
ççC D&
GetWriteConnectionString
ççD \
(
çç\ ]
)
çç] ^
,
çç^ _
$strçç` 
,çç 
$numçç 
)çç 
;çç 
sph
èè 
.
èè  
DefineSqlParameter
èè 
(
èè 
$str
èè #
,
èè# $
	SqlDbType
èè% .
.
èè. /
Int
èè/ 2
,
èè2 3 
ParameterDirection
èè4 F
.
èèF G
Input
èèG L
,
èèL M
userId
èèN T
)
èèT U
;
èèU V
sph
éé 
.
éé  
DefineSqlParameter
éé 
(
éé 
$str
éé %
,
éé% &
	SqlDbType
éé' 0
.
éé0 1
NVarChar
éé1 9
,
éé9 :
$num
éé; ?
,
éé? @ 
ParameterDirection
ééA S
.
ééS T
Input
ééT Y
,
ééY Z
password
éé[ c
)
ééc d
;
ééd e
sph
êê 
.
êê  
DefineSqlParameter
êê 
(
êê 
$str
êê )
,
êê) *
	SqlDbType
êê+ 4
.
êê4 5
NVarChar
êê5 =
,
êê= >
$num
êê? B
,
êêB C 
ParameterDirection
êêD V
.
êêV W
Input
êêW \
,
êê\ ]
passwordSalt
êê^ j
)
êêj k
;
êêk l
sph
ëë 
.
ëë  
DefineSqlParameter
ëë 
(
ëë 
$str
ëë &
,
ëë& '
	SqlDbType
ëë( 1
.
ëë1 2
Int
ëë2 5
,
ëë5 6 
ParameterDirection
ëë7 I
.
ëëI J
Input
ëëJ O
,
ëëO P
	pwdFormat
ëëQ Z
)
ëëZ [
;
ëë[ \
int
ìì 
rowsAffected
ìì 
=
ìì 
sph
ìì 
.
ìì 
ExecuteNonQuery
ìì )
(
ìì) *
)
ìì* +
;
ìì+ ,
return
íí 	
(
íí
 
rowsAffected
íí 
>
íí 
-
íí 
$num
íí 
)
íí 
;
íí 
}
îî 
public
ðð 
static
ðð	 
bool
ðð -
UpdatePasswordQuestionAndAnswer
ðð 4
(
ðð4 5
Guid
ññ 
userGuid
ññ 
,
ññ 
String
òò 	
passwordQuestion
òò
 
,
òò 
String
óó 	
passwordAnswer
óó
 
)
óó 
{
ôô  
SqlParameterHelper
õõ 
sph
õõ 
=
õõ 
new
õõ  
SqlParameterHelper
õõ  2
(
õõ2 3
ConnectionString
õõ3 C
.
õõC D&
GetWriteConnectionString
õõD \
(
õõ\ ]
)
õõ] ^
,
õõ^ _
$strõõ` 
,õõ 
$numõõ 
)õõ 
;õõ 
sph
öö 
.
öö  
DefineSqlParameter
öö 
(
öö 
$str
öö %
,
öö% &
	SqlDbType
öö' 0
.
öö0 1
UniqueIdentifier
öö1 A
,
ööA B 
ParameterDirection
ööC U
.
ööU V
Input
ööV [
,
öö[ \
userGuid
öö] e
)
ööe f
;
ööf g
sph
÷÷ 
.
÷÷  
DefineSqlParameter
÷÷ 
(
÷÷ 
$str
÷÷ -
,
÷÷- .
	SqlDbType
÷÷/ 8
.
÷÷8 9
NVarChar
÷÷9 A
,
÷÷A B
$num
÷÷C F
,
÷÷F G 
ParameterDirection
÷÷H Z
.
÷÷Z [
Input
÷÷[ `
,
÷÷` a
passwordQuestion
÷÷b r
)
÷÷r s
;
÷÷s t
sph
øø 
.
øø  
DefineSqlParameter
øø 
(
øø 
$str
øø +
,
øø+ ,
	SqlDbType
øø- 6
.
øø6 7
NVarChar
øø7 ?
,
øø? @
$num
øøA D
,
øøD E 
ParameterDirection
øøF X
.
øøX Y
Input
øøY ^
,
øø^ _
passwordAnswer
øø` n
)
øøn o
;
øøo p
int
ùù 
rowsAffected
ùù 
=
ùù 
sph
ùù 
.
ùù 
ExecuteNonQuery
ùù )
(
ùù) *
)
ùù* +
;
ùù+ ,
return
úú 	
(
úú
 
rowsAffected
úú 
>
úú 
-
úú 
$num
úú 
)
úú 
;
úú 
}
ûû 
public
ýý 
static
ýý	 
void
ýý  
UpdateTotalRevenue
ýý '
(
ýý' (
Guid
ýý( ,
userGuid
ýý- 5
)
ýý5 6
{
þþ  
SqlParameterHelper
ÿÿ 
sph
ÿÿ 
=
ÿÿ 
new
ÿÿ  
SqlParameterHelper
ÿÿ  2
(
ÿÿ2 3
ConnectionString
ÿÿ3 C
.
ÿÿC D&
GetWriteConnectionString
ÿÿD \
(
ÿÿ\ ]
)
ÿÿ] ^
,
ÿÿ^ _
$strÿÿ` 
,ÿÿ 
$numÿÿ 
)ÿÿ 
;ÿÿ 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
userGuid
] e
)
e f
;
f g
sph
 
.
 
ExecuteNonQuery
 
(
 
)
 
;
 
}
 
public
 
static
	 
void
  
UpdateTotalRevenue
 '
(
' (
)
( )
{
 
	SqlHelper
 
.
 
ExecuteNonQuery
 
(
 
ConnectionString
 
.
 &
GetWriteConnectionString
 -
(
- .
)
. /
,
/ 0
CommandType
 
.
 
StoredProcedure
 
,
  
$str
 !
,
! "
null
 
)
 	
;
	 

}
 
public
 
static
	 
bool
 
FlagAsDeleted
 "
(
" #
int
# &
userId
' -
)
- .
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` x
,
x y
$num
z {
)
{ |
;
| }
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
Int
/ 2
,
2 3 
ParameterDirection
4 F
.
F G
Input
G L
,
L M
userId
N T
)
T U
;
U V
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 
FlagAsNotDeleted
 %
(
% &
int
& )
userId
* 0
)
0 1
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` {
,
{ |
$num
} ~
)
~ 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
Int
/ 2
,
2 3 
ParameterDirection
4 F
.
F G
Input
G L
,
L M
userId
N T
)
T U
;
U V
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
public
 
static
	 
bool
 !
IncrementTotalPosts
 (
(
( )
int
) ,
userId
- 3
)
3 4
{
    
SqlParameterHelper
¡¡ 
sph
¡¡ 
=
¡¡ 
new
¡¡  
SqlParameterHelper
¡¡  2
(
¡¡2 3
ConnectionString
¡¡3 C
.
¡¡C D&
GetWriteConnectionString
¡¡D \
(
¡¡\ ]
)
¡¡] ^
,
¡¡^ _
$str
¡¡` ~
,
¡¡~ 
$num¡¡ 
)¡¡ 
;¡¡ 
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ 
(
¢¢ 
$str
¢¢ #
,
¢¢# $
	SqlDbType
¢¢% .
.
¢¢. /
Int
¢¢/ 2
,
¢¢2 3 
ParameterDirection
¢¢4 F
.
¢¢F G
Input
¢¢G L
,
¢¢L M
userId
¢¢N T
)
¢¢T U
;
¢¢U V
int
££ 
rowsAffected
££ 
=
££ 
sph
££ 
.
££ 
ExecuteNonQuery
££ )
(
££) *
)
££* +
;
££+ ,
return
¤¤ 	
(
¤¤
 
rowsAffected
¤¤ 
>
¤¤ 
-
¤¤ 
$num
¤¤ 
)
¤¤ 
;
¤¤ 
}
¥¥ 
public
§§ 
static
§§	 
bool
§§ !
DecrementTotalPosts
§§ (
(
§§( )
int
§§) ,
userId
§§- 3
)
§§3 4
{
¨¨  
SqlParameterHelper
©© 
sph
©© 
=
©© 
new
©©  
SqlParameterHelper
©©  2
(
©©2 3
ConnectionString
©©3 C
.
©©C D&
GetWriteConnectionString
©©D \
(
©©\ ]
)
©©] ^
,
©©^ _
$str
©©` ~
,
©©~ 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª 
(
ªª 
$str
ªª #
,
ªª# $
	SqlDbType
ªª% .
.
ªª. /
Int
ªª/ 2
,
ªª2 3 
ParameterDirection
ªª4 F
.
ªªF G
Input
ªªG L
,
ªªL M
userId
ªªN T
)
ªªT U
;
ªªU V
int
«« 
rowsAffected
«« 
=
«« 
sph
«« 
.
«« 
ExecuteNonQuery
«« )
(
««) *
)
««* +
;
««+ ,
return
¬¬ 	
(
¬¬
 
rowsAffected
¬¬ 
>
¬¬ 
-
¬¬ 
$num
¬¬ 
)
¬¬ 
;
¬¬ 
}
­­ 
public
¯¯ 
static
¯¯	 
IDataReader
¯¯ 
GetRolesByUser
¯¯ *
(
¯¯* +
int
¯¯+ .
siteId
¯¯/ 5
,
¯¯5 6
int
¯¯7 :
userId
¯¯; A
)
¯¯A B
{
°°  
SqlParameterHelper
±± 
sph
±± 
=
±± 
new
±±  
SqlParameterHelper
±±  2
(
±±2 3
ConnectionString
±±3 C
.
±±C D%
GetReadConnectionString
±±D [
(
±±[ \
)
±±\ ]
,
±±] ^
$str
±±_ v
,
±±v w
$num
±±x y
)
±±y z
;
±±z {
sph
²² 
.
²²  
DefineSqlParameter
²² 
(
²² 
$str
²² #
,
²²# $
	SqlDbType
²²% .
.
²². /
Int
²²/ 2
,
²²2 3 
ParameterDirection
²²4 F
.
²²F G
Input
²²G L
,
²²L M
siteId
²²N T
)
²²T U
;
²²U V
sph
³³ 
.
³³  
DefineSqlParameter
³³ 
(
³³ 
$str
³³ #
,
³³# $
	SqlDbType
³³% .
.
³³. /
Int
³³/ 2
,
³³2 3 
ParameterDirection
³³4 F
.
³³F G
Input
³³G L
,
³³L M
userId
³³N T
)
³³T U
;
³³U V
return
´´ 	
sph
´´
 
.
´´ 
ExecuteReader
´´ 
(
´´ 
)
´´ 
;
´´ 
}
µµ 
public
¸¸ 
static
¸¸	 
IDataReader
¸¸ '
GetUserByRegistrationGuid
¸¸ 5
(
¸¸5 6
int
¸¸6 9
siteId
¸¸: @
,
¸¸@ A
Guid
¸¸B F!
registerConfirmGuid
¸¸G Z
)
¸¸Z [
{
¹¹  
SqlParameterHelper
ºº 
sph
ºº 
=
ºº 
new
ºº  
SqlParameterHelper
ºº  2
(
ºº2 3
ConnectionString
ºº3 C
.
ººC D%
GetReadConnectionString
ººD [
(
ºº[ \
)
ºº\ ]
,
ºº] ^
$str
ºº_ ~
,
ºº~ 
$numºº 
)ºº 
;ºº 
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»» #
,
»»# $
	SqlDbType
»»% .
.
»». /
Int
»»/ 2
,
»»2 3 
ParameterDirection
»»4 F
.
»»F G
Input
»»G L
,
»»L M
siteId
»»N T
)
»»T U
;
»»U V
sph
¼¼ 
.
¼¼  
DefineSqlParameter
¼¼ 
(
¼¼ 
$str
¼¼ 0
,
¼¼0 1
	SqlDbType
¼¼2 ;
.
¼¼; <
UniqueIdentifier
¼¼< L
,
¼¼L M 
ParameterDirection
¼¼N `
.
¼¼` a
Input
¼¼a f
,
¼¼f g!
registerConfirmGuid
¼¼h {
)
¼¼{ |
;
¼¼| }
return
½½ 	
sph
½½
 
.
½½ 
ExecuteReader
½½ 
(
½½ 
)
½½ 
;
½½ 
}
¾¾ 
public
ÁÁ 
static
ÁÁ	 
IDataReader
ÁÁ 
GetSingleUser
ÁÁ )
(
ÁÁ) *
int
ÁÁ* -
siteId
ÁÁ. 4
,
ÁÁ4 5
string
ÁÁ6 <
email
ÁÁ= B
)
ÁÁB C
{
ÂÂ  
SqlParameterHelper
ÃÃ 
sph
ÃÃ 
=
ÃÃ 
new
ÃÃ  
SqlParameterHelper
ÃÃ  2
(
ÃÃ2 3
ConnectionString
ÃÃ3 C
.
ÃÃC D%
GetReadConnectionString
ÃÃD [
(
ÃÃ[ \
)
ÃÃ\ ]
,
ÃÃ] ^
$str
ÃÃ_ w
,
ÃÃw x
$num
ÃÃy z
)
ÃÃz {
;
ÃÃ{ |
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ 
(
ÄÄ 
$str
ÄÄ #
,
ÄÄ# $
	SqlDbType
ÄÄ% .
.
ÄÄ. /
Int
ÄÄ/ 2
,
ÄÄ2 3 
ParameterDirection
ÄÄ4 F
.
ÄÄF G
Input
ÄÄG L
,
ÄÄL M
siteId
ÄÄN T
)
ÄÄT U
;
ÄÄU V
sph
ÅÅ 
.
ÅÅ  
DefineSqlParameter
ÅÅ 
(
ÅÅ 
$str
ÅÅ "
,
ÅÅ" #
	SqlDbType
ÅÅ$ -
.
ÅÅ- .
NVarChar
ÅÅ. 6
,
ÅÅ6 7
$num
ÅÅ8 ;
,
ÅÅ; < 
ParameterDirection
ÅÅ= O
.
ÅÅO P
Input
ÅÅP U
,
ÅÅU V
email
ÅÅW \
)
ÅÅ\ ]
;
ÅÅ] ^
return
ÆÆ 	
sph
ÆÆ
 
.
ÆÆ 
ExecuteReader
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ÇÇ 
public
ÉÉ 
static
ÉÉ	 
IDataReader
ÉÉ &
GetSingleUserByLoginName
ÉÉ 4
(
ÉÉ4 5
int
ÉÉ5 8
siteId
ÉÉ9 ?
,
ÉÉ? @
string
ÉÉA G
	loginName
ÉÉH Q
,
ÉÉQ R
bool
ÉÉS W 
allowEmailFallback
ÉÉX j
)
ÉÉj k
{
ÊÊ  
SqlParameterHelper
ËË 
sph
ËË 
=
ËË 
new
ËË  
SqlParameterHelper
ËË  2
(
ËË2 3
ConnectionString
ËË3 C
.
ËËC D%
GetReadConnectionString
ËËD [
(
ËË[ \
)
ËË\ ]
,
ËË] ^
$str
ËË_ {
,
ËË{ |
$num
ËË} ~
)
ËË~ 
;ËË 
sph
ÌÌ 
.
ÌÌ  
DefineSqlParameter
ÌÌ 
(
ÌÌ 
$str
ÌÌ #
,
ÌÌ# $
	SqlDbType
ÌÌ% .
.
ÌÌ. /
Int
ÌÌ/ 2
,
ÌÌ2 3 
ParameterDirection
ÌÌ4 F
.
ÌÌF G
Input
ÌÌG L
,
ÌÌL M
siteId
ÌÌN T
)
ÌÌT U
;
ÌÌU V
sph
ÍÍ 
.
ÍÍ  
DefineSqlParameter
ÍÍ 
(
ÍÍ 
$str
ÍÍ &
,
ÍÍ& '
	SqlDbType
ÍÍ( 1
.
ÍÍ1 2
NVarChar
ÍÍ2 :
,
ÍÍ: ;
$num
ÍÍ< >
,
ÍÍ> ? 
ParameterDirection
ÍÍ@ R
.
ÍÍR S
Input
ÍÍS X
,
ÍÍX Y
	loginName
ÍÍZ c
)
ÍÍc d
;
ÍÍd e
sph
ÎÎ 
.
ÎÎ  
DefineSqlParameter
ÎÎ 
(
ÎÎ 
$str
ÎÎ /
,
ÎÎ/ 0
	SqlDbType
ÎÎ1 :
.
ÎÎ: ;
Bit
ÎÎ; >
,
ÎÎ> ? 
ParameterDirection
ÎÎ@ R
.
ÎÎR S
Input
ÎÎS X
,
ÎÎX Y 
allowEmailFallback
ÎÎZ l
)
ÎÎl m
;
ÎÎm n
return
ÏÏ 	
sph
ÏÏ
 
.
ÏÏ 
ExecuteReader
ÏÏ 
(
ÏÏ 
)
ÏÏ 
;
ÏÏ 
}
ÐÐ 
public
ÒÒ 
static
ÒÒ	 
IDataReader
ÒÒ 
GetSingleUser
ÒÒ )
(
ÒÒ) *
int
ÒÒ* -
userId
ÒÒ. 4
,
ÒÒ4 5
int
ÒÒ6 9
siteId
ÒÒ: @
)
ÒÒ@ A
{
ÓÓ  
SqlParameterHelper
ÔÔ 
sph
ÔÔ 
=
ÔÔ 
new
ÔÔ  
SqlParameterHelper
ÔÔ  2
(
ÔÔ2 3
ConnectionString
ÔÔ3 C
.
ÔÔC D%
GetReadConnectionString
ÔÔD [
(
ÔÔ[ \
)
ÔÔ\ ]
,
ÔÔ] ^
$str
ÔÔ_ s
,
ÔÔs t
$num
ÔÔu v
)
ÔÔv w
;
ÔÔw x
sph
ÕÕ 
.
ÕÕ  
DefineSqlParameter
ÕÕ 
(
ÕÕ 
$str
ÕÕ #
,
ÕÕ# $
	SqlDbType
ÕÕ% .
.
ÕÕ. /
Int
ÕÕ/ 2
,
ÕÕ2 3 
ParameterDirection
ÕÕ4 F
.
ÕÕF G
Input
ÕÕG L
,
ÕÕL M
userId
ÕÕN T
)
ÕÕT U
;
ÕÕU V
sph
ÖÖ 
.
ÖÖ  
DefineSqlParameter
ÖÖ 
(
ÖÖ 
$str
ÖÖ #
,
ÖÖ# $
	SqlDbType
ÖÖ% .
.
ÖÖ. /
Int
ÖÖ/ 2
,
ÖÖ2 3 
ParameterDirection
ÖÖ4 F
.
ÖÖF G
Input
ÖÖG L
,
ÖÖL M
siteId
ÖÖN T
)
ÖÖT U
;
ÖÖU V
return
×× 	
sph
××
 
.
×× 
ExecuteReader
×× 
(
×× 
)
×× 
;
×× 
}
ØØ 
public
ÚÚ 
static
ÚÚ	 
IDataReader
ÚÚ 
GetSingleUser
ÚÚ )
(
ÚÚ) *
Guid
ÚÚ* .
userGuid
ÚÚ/ 7
,
ÚÚ7 8
int
ÚÚ9 <
siteId
ÚÚ= C
)
ÚÚC D
{
ÛÛ  
SqlParameterHelper
ÜÜ 
sph
ÜÜ 
=
ÜÜ 
new
ÜÜ  
SqlParameterHelper
ÜÜ  2
(
ÜÜ2 3
ConnectionString
ÜÜ3 C
.
ÜÜC D%
GetReadConnectionString
ÜÜD [
(
ÜÜ[ \
)
ÜÜ\ ]
,
ÜÜ] ^
$str
ÜÜ_ v
,
ÜÜv w
$num
ÜÜx y
)
ÜÜy z
;
ÜÜz {
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ 
(
ÝÝ 
$str
ÝÝ %
,
ÝÝ% &
	SqlDbType
ÝÝ' 0
.
ÝÝ0 1
UniqueIdentifier
ÝÝ1 A
,
ÝÝA B 
ParameterDirection
ÝÝC U
.
ÝÝU V
Input
ÝÝV [
,
ÝÝ[ \
userGuid
ÝÝ] e
)
ÝÝe f
;
ÝÝf g
sph
ÞÞ 
.
ÞÞ  
DefineSqlParameter
ÞÞ 
(
ÞÞ 
$str
ÞÞ #
,
ÞÞ# $
	SqlDbType
ÞÞ% .
.
ÞÞ. /
Int
ÞÞ/ 2
,
ÞÞ2 3 
ParameterDirection
ÞÞ4 F
.
ÞÞF G
Input
ÞÞG L
,
ÞÞL M
siteId
ÞÞN T
)
ÞÞT U
;
ÞÞU V
return
ßß 	
sph
ßß
 
.
ßß 
ExecuteReader
ßß 
(
ßß 
)
ßß 
;
ßß 
}
àà 
public
ââ 
static
ââ	 
Guid
ââ #
GetUserGuidFromOpenId
ââ *
(
ââ* +
int
ãã 
siteId
ãã 
,
ãã 
string
ää 	
	openIduri
ää
 
)
ää 
{
åå  
SqlParameterHelper
ææ 
sph
ææ 
=
ææ 
new
ææ  
SqlParameterHelper
ææ  2
(
ææ2 3
ConnectionString
ææ3 C
.
ææC D%
GetReadConnectionString
ææD [
(
ææ[ \
)
ææ\ ]
,
ææ] ^
$str
ææ_ 
,ææ 
$numææ 
)ææ 
;ææ 
sph
çç 
.
çç  
DefineSqlParameter
çç 
(
çç 
$str
çç #
,
çç# $
	SqlDbType
çç% .
.
çç. /
Int
çç/ 2
,
çç2 3 
ParameterDirection
çç4 F
.
ççF G
Input
ççG L
,
ççL M
siteId
ççN T
)
ççT U
;
ççU V
sph
èè 
.
èè  
DefineSqlParameter
èè 
(
èè 
$str
èè &
,
èè& '
	SqlDbType
èè( 1
.
èè1 2
NVarChar
èè2 :
,
èè: ;
$num
èè< ?
,
èè? @ 
ParameterDirection
èèA S
.
èèS T
Input
èèT Y
,
èèY Z
	openIduri
èè[ d
)
èèd e
;
èèe f
Guid
êê 
userGuid
êê 
=
êê 
Guid
êê 
.
êê 
Empty
êê 
;
êê 
using
ìì 
(
ìì	 

IDataReader
ìì
 
reader
ìì 
=
ìì 
sph
ìì "
.
ìì" #
ExecuteReader
ìì# 0
(
ìì0 1
)
ìì1 2
)
ìì2 3
{
íí 
if
îî 
(
îî 
reader
îî 
.
îî 
Read
îî 
(
îî 
)
îî 
)
îî 
{
ïï 
userGuid
ðð 
=
ðð 
new
ðð 
Guid
ðð 
(
ðð 
reader
ðð 
[
ðð  
$str
ðð  *
]
ðð* +
.
ðð+ ,
ToString
ðð, 4
(
ðð4 5
)
ðð5 6
)
ðð6 7
;
ðð7 8
}
ññ 
}
òò 
return
ôô 	
userGuid
ôô
 
;
ôô 
}
õõ 
public
÷÷ 
static
÷÷	 
Guid
÷÷ *
GetUserGuidFromWindowsLiveId
÷÷ 1
(
÷÷1 2
int
øø 
siteId
øø 
,
øø 
string
ùù 	
windowsLiveId
ùù
 
)
ùù 
{
úú  
SqlParameterHelper
ûû 
sph
ûû 
=
ûû 
new
ûû  
SqlParameterHelper
ûû  2
(
ûû2 3
ConnectionString
ûû3 C
.
ûûC D%
GetReadConnectionString
ûûD [
(
ûû[ \
)
ûû\ ]
,
ûû] ^
$strûû_ 
,ûû 
$numûû 
)ûû 
;ûû 
sph
üü 
.
üü  
DefineSqlParameter
üü 
(
üü 
$str
üü #
,
üü# $
	SqlDbType
üü% .
.
üü. /
Int
üü/ 2
,
üü2 3 
ParameterDirection
üü4 F
.
üüF G
Input
üüG L
,
üüL M
siteId
üüN T
)
üüT U
;
üüU V
sph
ýý 
.
ýý  
DefineSqlParameter
ýý 
(
ýý 
$str
ýý *
,
ýý* +
	SqlDbType
ýý, 5
.
ýý5 6
NVarChar
ýý6 >
,
ýý> ?
$num
ýý@ C
,
ýýC D 
ParameterDirection
ýýE W
.
ýýW X
Input
ýýX ]
,
ýý] ^
windowsLiveId
ýý_ l
)
ýýl m
;
ýým n
Guid
ÿÿ 
userGuid
ÿÿ 
=
ÿÿ 
Guid
ÿÿ 
.
ÿÿ 
Empty
ÿÿ 
;
ÿÿ 
using
 
(
	 

IDataReader

 
reader
 
=
 
sph
 "
.
" #
ExecuteReader
# 0
(
0 1
)
1 2
)
2 3
{
 
if
 
(
 
reader
 
.
 
Read
 
(
 
)
 
)
 
{
 
userGuid
 
=
 
new
 
Guid
 
(
 
reader
 
[
  
$str
  *
]
* +
.
+ ,
ToString
, 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 
}
 
return
 	
userGuid

 
;
 
}
 
public
 
static
	 
string
 
LoginByEmail
 #
(
# $
int
$ '
siteId
( .
,
. /
string
0 6
email
7 <
,
< =
string
> D
password
E M
)
M N
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D%
GetReadConnectionString
D [
(
[ \
)
\ ]
,
] ^
$str
_ v
,
v w
$num
x y
)
y z
;
z {
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 #
,
# $
	SqlDbType
% .
.
. /
Int
/ 2
,
2 3 
ParameterDirection
4 F
.
F G
Input
G L
,
L M
siteId
N T
)
T U
;
U V
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 "
,
" #
	SqlDbType
$ -
.
- .
NVarChar
. 6
,
6 7
$num
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
email
W \
)
\ ]
;
] ^
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
NVarChar
1 9
,
9 :
$num
; ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
password
[ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
NVarChar
1 9
,
9 :
$num
; >
,
> ? 
ParameterDirection
@ R
.
R S
InputOutput
S ^
,
^ _
null
` d
)
d e
;
e f
sph
 
.
 
ExecuteNonQuery
 
(
 
)
 
;
 
if
 
(
 
sph
 

.

 

Parameters
 
[
 
$num
 
]
 
!=
 
null
  
)
  !
{
 
return
 

sph
 
.
 

Parameters
 
[
 
$num
 
]
 
.
 
Value
 "
.
" #
ToString
# +
(
+ ,
)
, -
;
- .
}
 
else
 
{
 
return
 

string
 
.
 
Empty
 
;
 
}
 
}
 
public
¡¡ 
static
¡¡	 
string
¡¡ 
Login
¡¡ 
(
¡¡ 
int
¡¡  
siteId
¡¡! '
,
¡¡' (
string
¡¡) /
	loginName
¡¡0 9
,
¡¡9 :
string
¡¡; A
password
¡¡B J
)
¡¡J K
{
¢¢  
SqlParameterHelper
££ 
sph
££ 
=
££ 
new
££  
SqlParameterHelper
££  2
(
££2 3
ConnectionString
££3 C
.
££C D%
GetReadConnectionString
££D [
(
££[ \
)
££\ ]
,
££] ^
$str
££_ o
,
££o p
$num
££q r
)
££r s
;
££s t
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ 
(
¤¤ 
$str
¤¤ #
,
¤¤# $
	SqlDbType
¤¤% .
.
¤¤. /
Int
¤¤/ 2
,
¤¤2 3 
ParameterDirection
¤¤4 F
.
¤¤F G
Input
¤¤G L
,
¤¤L M
siteId
¤¤N T
)
¤¤T U
;
¤¤U V
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ 
(
¥¥ 
$str
¥¥ &
,
¥¥& '
	SqlDbType
¥¥( 1
.
¥¥1 2
NVarChar
¥¥2 :
,
¥¥: ;
$num
¥¥< >
,
¥¥> ? 
ParameterDirection
¥¥@ R
.
¥¥R S
Input
¥¥S X
,
¥¥X Y
	loginName
¥¥Z c
)
¥¥c d
;
¥¥d e
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ 
(
¦¦ 
$str
¦¦ %
,
¦¦% &
	SqlDbType
¦¦' 0
.
¦¦0 1
NVarChar
¦¦1 9
,
¦¦9 :
$num
¦¦; ?
,
¦¦? @ 
ParameterDirection
¦¦A S
.
¦¦S T
Input
¦¦T Y
,
¦¦Y Z
password
¦¦[ c
)
¦¦c d
;
¦¦d e
sph
§§ 
.
§§  
DefineSqlParameter
§§ 
(
§§ 
$str
§§ %
,
§§% &
	SqlDbType
§§' 0
.
§§0 1
NVarChar
§§1 9
,
§§9 :
$num
§§; >
,
§§> ? 
ParameterDirection
§§@ R
.
§§R S
InputOutput
§§S ^
,
§§^ _
null
§§` d
)
§§d e
;
§§e f
sph
¨¨ 
.
¨¨ 
ExecuteNonQuery
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
if
«« 
(
«« 
sph
«« 

.
««
 

Parameters
«« 
[
«« 
$num
«« 
]
«« 
!=
«« 
null
««  
)
««  !
{
¬¬ 
return
­­ 

sph
­­ 
.
­­ 

Parameters
­­ 
[
­­ 
$num
­­ 
]
­­ 
.
­­ 
Value
­­ "
.
­­" #
ToString
­­# +
(
­­+ ,
)
­­, -
;
­­- .
}
®® 
else
¯¯ 
{
°° 
return
±± 

string
±± 
.
±± 
Empty
±± 
;
±± 
}
²² 
}
´´ 
public
¸¸ 
static
¸¸	 
	DataTable
¸¸ /
!GetNonLazyLoadedPropertiesForUser
¸¸ ;
(
¸¸; <
Guid
¸¸< @
userGuid
¸¸A I
)
¸¸I J
{
¹¹  
SqlParameterHelper
ºº 
sph
ºº 
=
ºº 
new
ºº  
SqlParameterHelper
ºº  2
(
ºº2 3
ConnectionString
ºº3 C
.
ººC D%
GetReadConnectionString
ººD [
(
ºº[ \
)
ºº\ ]
,
ºº] ^
$str
ºº_ 
,ºº 
$numºº 
)ºº 
;ºº 
sph
»» 
.
»»  
DefineSqlParameter
»» 
(
»» 
$str
»» %
,
»»% &
	SqlDbType
»»' 0
.
»»0 1
UniqueIdentifier
»»1 A
,
»»A B 
ParameterDirection
»»C U
.
»»U V
Input
»»V [
,
»»[ \
userGuid
»»] e
)
»»e f
;
»»f g
	DataTable
½½ 
	dataTable
½½ 
=
½½ 
new
½½ 
	DataTable
½½ &
(
½½& '
)
½½' (
;
½½( )
	dataTable
¾¾ 
.
¾¾ 
Columns
¾¾ 
.
¾¾ 
Add
¾¾ 
(
¾¾ 
$str
¾¾ #
,
¾¾# $
typeof
¾¾% +
(
¾¾+ ,
String
¾¾, 2
)
¾¾2 3
)
¾¾3 4
;
¾¾4 5
	dataTable
¿¿ 
.
¿¿ 
Columns
¿¿ 
.
¿¿ 
Add
¿¿ 
(
¿¿ 
$str
¿¿ '
,
¿¿' (
typeof
¿¿) /
(
¿¿/ 0
String
¿¿0 6
)
¿¿6 7
)
¿¿7 8
;
¿¿8 9
	dataTable
ÀÀ 
.
ÀÀ 
Columns
ÀÀ 
.
ÀÀ 
Add
ÀÀ 
(
ÀÀ 
$str
ÀÀ .
,
ÀÀ. /
typeof
ÀÀ0 6
(
ÀÀ6 7
String
ÀÀ7 =
)
ÀÀ= >
)
ÀÀ> ?
;
ÀÀ? @
using
ÃÃ 
(
ÃÃ	 

IDataReader
ÃÃ
 
reader
ÃÃ 
=
ÃÃ 
sph
ÃÃ "
.
ÃÃ" #
ExecuteReader
ÃÃ# 0
(
ÃÃ0 1
)
ÃÃ1 2
)
ÃÃ2 3
{
ÄÄ 
while
ÅÅ 	
(
ÅÅ
 
reader
ÅÅ 
.
ÅÅ 
Read
ÅÅ 
(
ÅÅ 
)
ÅÅ 
)
ÅÅ 
{
ÆÆ 
DataRow
ÇÇ 
row
ÇÇ 
=
ÇÇ 
	dataTable
ÇÇ 
.
ÇÇ 
NewRow
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
;
ÇÇ% &
row
ÈÈ 
[
ÈÈ 	
$str
ÈÈ	 
]
ÈÈ 
=
ÈÈ 
reader
ÈÈ 
[
ÈÈ 
$str
ÈÈ (
]
ÈÈ( )
.
ÈÈ) *
ToString
ÈÈ* 2
(
ÈÈ2 3
)
ÈÈ3 4
;
ÈÈ4 5
row
ÉÉ 
[
ÉÉ 	
$str
ÉÉ	 
]
ÉÉ 
=
ÉÉ 
reader
ÉÉ !
[
ÉÉ! "
$str
ÉÉ" 0
]
ÉÉ0 1
.
ÉÉ1 2
ToString
ÉÉ2 :
(
ÉÉ: ;
)
ÉÉ; <
;
ÉÉ< =
row
ÊÊ 
[
ÊÊ 	
$str
ÊÊ	 
]
ÊÊ 
=
ÊÊ  !
reader
ÊÊ" (
[
ÊÊ( )
$str
ÊÊ) >
]
ÊÊ> ?
.
ÊÊ? @
ToString
ÊÊ@ H
(
ÊÊH I
)
ÊÊI J
;
ÊÊJ K
	dataTable
ÌÌ 
.
ÌÌ 
Rows
ÌÌ 
.
ÌÌ 
Add
ÌÌ 
(
ÌÌ 
row
ÌÌ 
)
ÌÌ 
;
ÌÌ 
}
ÍÍ 
}
ÏÏ 
return
ÑÑ 	
	dataTable
ÑÑ
 
;
ÑÑ 
}
ÒÒ 
public
ÔÔ 
static
ÔÔ	 
IDataReader
ÔÔ #
GetLazyLoadedProperty
ÔÔ 1
(
ÔÔ1 2
Guid
ÔÔ2 6
userGuid
ÔÔ7 ?
,
ÔÔ? @
String
ÔÔA G
propertyName
ÔÔH T
)
ÔÔT U
{
ÕÕ  
SqlParameterHelper
ÖÖ 
sph
ÖÖ 
=
ÖÖ 
new
ÖÖ  
SqlParameterHelper
ÖÖ  2
(
ÖÖ2 3
ConnectionString
ÖÖ3 C
.
ÖÖC D%
GetReadConnectionString
ÖÖD [
(
ÖÖ[ \
)
ÖÖ\ ]
,
ÖÖ] ^
$str
ÖÖ_ |
,
ÖÖ| }
$num
ÖÖ~ 
)ÖÖ 
;ÖÖ 
sph
×× 
.
××  
DefineSqlParameter
×× 
(
×× 
$str
×× %
,
××% &
	SqlDbType
××' 0
.
××0 1
UniqueIdentifier
××1 A
,
××A B 
ParameterDirection
××C U
.
××U V
Input
××V [
,
××[ \
userGuid
××] e
)
××e f
;
××f g
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ 
(
ØØ 
$str
ØØ )
,
ØØ) *
	SqlDbType
ØØ+ 4
.
ØØ4 5
NVarChar
ØØ5 =
,
ØØ= >
$num
ØØ? B
,
ØØB C 
ParameterDirection
ØØD V
.
ØØV W
Input
ØØW \
,
ØØ\ ]
propertyName
ØØ^ j
)
ØØj k
;
ØØk l
return
ÙÙ 	
sph
ÙÙ
 
.
ÙÙ 
ExecuteReader
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 
public
ÜÜ 
static
ÜÜ	 
bool
ÜÜ 
PropertyExists
ÜÜ #
(
ÜÜ# $
Guid
ÜÜ$ (
userGuid
ÜÜ) 1
,
ÜÜ1 2
string
ÜÜ3 9
propertyName
ÜÜ: F
)
ÜÜF G
{
ÝÝ  
SqlParameterHelper
ÞÞ 
sph
ÞÞ 
=
ÞÞ 
new
ÞÞ  
SqlParameterHelper
ÞÞ  2
(
ÞÞ2 3
ConnectionString
ÞÞ3 C
.
ÞÞC D%
GetReadConnectionString
ÞÞD [
(
ÞÞ[ \
)
ÞÞ\ ]
,
ÞÞ] ^
$strÞÞ_ 
,ÞÞ 
$numÞÞ 
)ÞÞ 
;ÞÞ 
sph
ßß 
.
ßß  
DefineSqlParameter
ßß 
(
ßß 
$str
ßß %
,
ßß% &
	SqlDbType
ßß' 0
.
ßß0 1
UniqueIdentifier
ßß1 A
,
ßßA B 
ParameterDirection
ßßC U
.
ßßU V
Input
ßßV [
,
ßß[ \
userGuid
ßß] e
)
ßße f
;
ßßf g
sph
àà 
.
àà  
DefineSqlParameter
àà 
(
àà 
$str
àà )
,
àà) *
	SqlDbType
àà+ 4
.
àà4 5
NVarChar
àà5 =
,
àà= >
$num
àà? B
,
ààB C 
ParameterDirection
ààD V
.
ààV W
Input
ààW \
,
àà\ ]
propertyName
àà^ j
)
ààj k
;
ààk l
int
áá 
count
áá 
=
áá 
Convert
áá 
.
áá 
ToInt32
áá 
(
áá 
sph
áá "
.
áá" #
ExecuteScalar
áá# 0
(
áá0 1
)
áá1 2
)
áá2 3
;
áá3 4
return
ââ 	
(
ââ
 
count
ââ 
>
ââ 
$num
ââ 
)
ââ 
;
ââ 
}
ãã 
public
åå 
static
åå	 
void
åå 
CreateProperty
åå #
(
åå# $
Guid
ææ 

propertyId
ææ 
,
ææ 
Guid
çç 
userGuid
çç 
,
çç 
String
èè 	
propertyName
èè
 
,
èè 
String
éé 	
propertyValue
éé
 
,
éé 
byte
êê 
[
êê 
]
êê 	!
propertyValueBinary
êê
 
,
êê 
DateTime
ëë 
lastUpdateDate
ëë 
,
ëë 
bool
ìì 
isLazyLoaded
ìì 
)
ìì 
{
íí  
SqlParameterHelper
îî 
sph
îî 
=
îî 
new
îî  
SqlParameterHelper
îî  2
(
îî2 3
ConnectionString
îî3 C
.
îîC D&
GetWriteConnectionString
îîD \
(
îî\ ]
)
îî] ^
,
îî^ _
$str
îî` z
,
îîz {
$num
îî| }
)
îî} ~
;
îî~ 
sph
ïï 
.
ïï  
DefineSqlParameter
ïï 
(
ïï 
$str
ïï '
,
ïï' (
	SqlDbType
ïï) 2
.
ïï2 3
UniqueIdentifier
ïï3 C
,
ïïC D 
ParameterDirection
ïïE W
.
ïïW X
Input
ïïX ]
,
ïï] ^

propertyId
ïï_ i
)
ïïi j
;
ïïj k
sph
ðð 
.
ðð  
DefineSqlParameter
ðð 
(
ðð 
$str
ðð %
,
ðð% &
	SqlDbType
ðð' 0
.
ðð0 1
UniqueIdentifier
ðð1 A
,
ððA B 
ParameterDirection
ððC U
.
ððU V
Input
ððV [
,
ðð[ \
userGuid
ðð] e
)
ððe f
;
ððf g
sph
ññ 
.
ññ  
DefineSqlParameter
ññ 
(
ññ 
$str
ññ )
,
ññ) *
	SqlDbType
ññ+ 4
.
ññ4 5
NVarChar
ññ5 =
,
ññ= >
$num
ññ? B
,
ññB C 
ParameterDirection
ññD V
.
ññV W
Input
ññW \
,
ññ\ ]
propertyName
ññ^ j
)
ññj k
;
ññk l
sph
òò 
.
òò  
DefineSqlParameter
òò 
(
òò 
$str
òò 0
,
òò0 1
	SqlDbType
òò2 ;
.
òò; <
NVarChar
òò< D
,
òòD E
-
òòF G
$num
òòG H
,
òòH I 
ParameterDirection
òòJ \
.
òò\ ]
Input
òò] b
,
òòb c
propertyValue
òòd q
)
òòq r
;
òòr s
sph
óó 
.
óó  
DefineSqlParameter
óó 
(
óó 
$str
óó 0
,
óó0 1
	SqlDbType
óó2 ;
.
óó; <
	VarBinary
óó< E
,
óóE F
-
óóG H
$num
óóH I
,
óóI J 
ParameterDirection
óóK ]
.
óó] ^
Input
óó^ c
,
óóc d!
propertyValueBinary
óóe x
)
óóx y
;
óóy z
sph
ôô 
.
ôô  
DefineSqlParameter
ôô 
(
ôô 
$str
ôô ,
,
ôô, -
	SqlDbType
ôô. 7
.
ôô7 8
DateTime
ôô8 @
,
ôô@ A 
ParameterDirection
ôôB T
.
ôôT U
Input
ôôU Z
,
ôôZ [
lastUpdateDate
ôô\ j
)
ôôj k
;
ôôk l
sph
õõ 
.
õõ  
DefineSqlParameter
õõ 
(
õõ 
$str
õõ )
,
õõ) *
	SqlDbType
õõ+ 4
.
õõ4 5
Bit
õõ5 8
,
õõ8 9 
ParameterDirection
õõ: L
.
õõL M
Input
õõM R
,
õõR S
isLazyLoaded
õõT `
)
õõ` a
;
õõa b
sph
öö 
.
öö 
ExecuteNonQuery
öö 
(
öö 
)
öö 
;
öö 
}
÷÷ 
public
ùù 
static
ùù	 
void
ùù 
UpdateProperty
ùù #
(
ùù# $
Guid
úú 
userGuid
úú 
,
úú 
String
ûû 	
propertyName
ûû
 
,
ûû 
String
üü 	
propertyValue
üü
 
,
üü 
byte
ýý 
[
ýý 
]
ýý 	!
propertyValueBinary
ýý
 
,
ýý 
DateTime
þþ 
lastUpdateDate
þþ 
,
þþ 
bool
ÿÿ 
isLazyLoaded
ÿÿ 
)
ÿÿ 
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str
` z
,
z {
$num
| }
)
} ~
;
~ 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
userGuid
] e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 )
,
) *
	SqlDbType
+ 4
.
4 5
NVarChar
5 =
,
= >
$num
? B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
propertyName
^ j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 0
,
0 1
	SqlDbType
2 ;
.
; <
NVarChar
< D
,
D E
-
F G
$num
G H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
propertyValue
d q
)
q r
;
r s
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 0
,
0 1
	SqlDbType
2 ;
.
; <
	VarBinary
< E
,
E F
-
G H
$num
H I
,
I J 
ParameterDirection
K ]
.
] ^
Input
^ c
,
c d!
propertyValueBinary
e x
)
x y
;
y z
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 ,
,
, -
	SqlDbType
. 7
.
7 8
DateTime
8 @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
lastUpdateDate
\ j
)
j k
;
k l
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 )
,
) *
	SqlDbType
+ 4
.
4 5
Bit
5 8
,
8 9 
ParameterDirection
: L
.
L M
Input
M R
,
R S
isLazyLoaded
T `
)
` a
;
a b
sph
 
.
 
ExecuteNonQuery
 
(
 
)
 
;
 
}
 
public
 
static
	 
bool
 $
DeletePropertiesByUser
 +
(
+ ,
Guid
, 0
userGuid
1 9
)
9 :
{
  
SqlParameterHelper
 
sph
 
=
 
new
  
SqlParameterHelper
  2
(
2 3
ConnectionString
3 C
.
C D&
GetWriteConnectionString
D \
(
\ ]
)
] ^
,
^ _
$str` 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 
(
 
$str
 %
,
% &
	SqlDbType
' 0
.
0 1
UniqueIdentifier
1 A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
userGuid
] e
)
e f
;
f g
int
 
rowsAffected
 
=
 
sph
 
.
 
ExecuteNonQuery
 )
(
) *
)
* +
;
+ ,
return
 	
(

 
rowsAffected
 
>
 
-
 
$num
 
)
 
;
 
}
 
}
 
} ðÔ
kD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaskQueue.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBTaskQueue #
{ 
public,, 
static,, 
int,, 
Create,,  
(,,  !
Guid-- 
guid-- 
,-- 
Guid.. 
siteGuid.. 
,.. 
Guid// 
queuedBy// 
,// 
string00 
taskName00 
,00 
bool11 
notifyOnCompletion11 #
,11# $
string22 
notificationToEmail22 &
,22& '
string33 !
notificationFromEmail33 (
,33( )
string44 
notificationSubject44 &
,44& '
string55 
taskCompleteMessage55 &
,55& '
bool66 
canStop66 
,66 
bool77 
	canResume77 
,77 
int88 
updateFrequency88 
,88  
DateTime99 
	queuedUTC99 
,99 
double:: 
completeRatio::  
,::  !
string;; 
status;; 
,;; 
string<<  
serializedTaskObject<< '
,<<' (
string== 
serializedTaskType== %
)==% &
{>> 	
SqlParameterHelper?? 
sph?? "
=??# $
new??% (
SqlParameterHelper??) ;
(??; <
ConnectionString??< L
.??L M$
GetWriteConnectionString??M e
(??e f
)??f g
,??g h
$str??i ~
,??~ 
$num
?? 
)
?? 
;
?? 
sph@@ 
.@@ 
DefineSqlParameter@@ "
(@@" #
$str@@# *
,@@* +
	SqlDbType@@, 5
.@@5 6
UniqueIdentifier@@6 F
,@@F G
ParameterDirection@@H Z
.@@Z [
Input@@[ `
,@@` a
guid@@b f
)@@f g
;@@g h
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# .
,AA. /
	SqlDbTypeAA0 9
.AA9 :
UniqueIdentifierAA: J
,AAJ K
ParameterDirectionAAL ^
.AA^ _
InputAA_ d
,AAd e
siteGuidAAf n
)AAn o
;AAo p
sphBB 
.BB 
DefineSqlParameterBB "
(BB" #
$strBB# .
,BB. /
	SqlDbTypeBB0 9
.BB9 :
UniqueIdentifierBB: J
,BBJ K
ParameterDirectionBBL ^
.BB^ _
InputBB_ d
,BBd e
queuedByBBf n
)BBn o
;BBo p
sphCC 
.CC 
DefineSqlParameterCC "
(CC" #
$strCC# .
,CC. /
	SqlDbTypeCC0 9
.CC9 :
NVarCharCC: B
,CCB C
$numCCD G
,CCG H
ParameterDirectionCCI [
.CC[ \
InputCC\ a
,CCa b
taskNameCCc k
)CCk l
;CCl m
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# 8
,DD8 9
	SqlDbTypeDD: C
.DDC D
BitDDD G
,DDG H
ParameterDirectionDDI [
.DD[ \
InputDD\ a
,DDa b
notifyOnCompletionDDc u
)DDu v
;DDv w
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# 9
,EE9 :
	SqlDbTypeEE; D
.EED E
NVarCharEEE M
,EEM N
$numEEO R
,EER S
ParameterDirectionEET f
.EEf g
InputEEg l
,EEl m 
notificationToEmail	EEn 
)
EE 
;
EE 
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# ;
,FF; <
	SqlDbTypeFF= F
.FFF G
NVarCharFFG O
,FFO P
$numFFQ T
,FFT U
ParameterDirectionFFV h
.FFh i
InputFFi n
,FFn o"
notificationFromEmail	FFp 
)
FF 
;
FF 
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# 9
,GG9 :
	SqlDbTypeGG; D
.GGD E
NVarCharGGE M
,GGM N
$numGGO R
,GGR S
ParameterDirectionGGT f
.GGf g
InputGGg l
,GGl m 
notificationSubject	GGn 
)
GG 
;
GG 
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 9
,HH9 :
	SqlDbTypeHH; D
.HHD E
NVarCharHHE M
,HHM N
-HHO P
$numHHP Q
,HHQ R
ParameterDirectionHHS e
.HHe f
InputHHf k
,HHk l 
taskCompleteMessage	HHm 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# -
,II- .
	SqlDbTypeII/ 8
.II8 9
BitII9 <
,II< =
ParameterDirectionII> P
.IIP Q
InputIIQ V
,IIV W
canStopIIX _
)II_ `
;II` a
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# /
,JJ/ 0
	SqlDbTypeJJ1 :
.JJ: ;
BitJJ; >
,JJ> ?
ParameterDirectionJJ@ R
.JJR S
InputJJS X
,JJX Y
	canResumeJJZ c
)JJc d
;JJd e
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 5
,KK5 6
	SqlDbTypeKK7 @
.KK@ A
IntKKA D
,KKD E
ParameterDirectionKKF X
.KKX Y
InputKKY ^
,KK^ _
updateFrequencyKK` o
)KKo p
;KKp q
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# /
,LL/ 0
	SqlDbTypeLL1 :
.LL: ;
DateTimeLL; C
,LLC D
ParameterDirectionLLE W
.LLW X
InputLLX ]
,LL] ^
	queuedUTCLL_ h
)LLh i
;LLi j
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# 3
,MM3 4
	SqlDbTypeMM5 >
.MM> ?
FloatMM? D
,MMD E
ParameterDirectionMMF X
.MMX Y
InputMMY ^
,MM^ _
completeRatioMM` m
)MMm n
;MMn o
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# ,
,NN, -
	SqlDbTypeNN. 7
.NN7 8
NVarCharNN8 @
,NN@ A
$numNNB E
,NNE F
ParameterDirectionNNG Y
.NNY Z
InputNNZ _
,NN_ `
statusNNa g
)NNg h
;NNh i
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# :
,OO: ;
	SqlDbTypeOO< E
.OOE F
NVarCharOOF N
,OON O
-OOP Q
$numOOQ R
,OOR S
ParameterDirectionOOT f
.OOf g
InputOOg l
,OOl m!
serializedTaskObject	OOn 
)
OO 
;
OO 
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 8
,PP8 9
	SqlDbTypePP: C
.PPC D
NVarCharPPD L
,PPL M
$numPPN Q
,PPQ R
ParameterDirectionPPS e
.PPe f
InputPPf k
,PPk l
serializedTaskTypePPm 
)	PP 
;
PP 
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
rowsAffectedRR 
;RR  
}SS 	
public`` 
static`` 
bool`` 
Update`` !
(``! "
Guidaa 
guidaa 
,aa 
DateTimebb 
startUTCbb 
,bb 
DateTimecc 
completeUTCcc  
,cc  !
DateTimedd 
lastStatusUpdateUTCdd (
,dd( )
doubleee 
completeRatioee  
,ee  !
stringff 
statusff 
)ff 
{gg 	
ifhh 
(hh 
(hh 
startUTChh 
==hh 
DateTimehh %
.hh% &
MinValuehh& .
)hh. /
&&hh0 2
(hh3 4
completeUTChh4 ?
==hh@ B
DateTimehhC K
.hhK L
MinValuehhL T
)hhT U
)hhU V
{ii 
returnjj 
UpdateStatusjj #
(jj# $
guidjj$ (
,jj( )
lastStatusUpdateUTCjj* =
,jj= >
completeRatiojj? L
,jjL M
statusjjN T
)jjT U
;jjU V
}kk 
ifmm 
(mm 
completeUTCmm 
==mm 
DateTimemm '
.mm' (
MinValuemm( 0
)mm0 1
{nn 
returnoo 
UpdateStatusoo #
(oo# $
guidoo$ (
,oo( )
startUTCoo* 2
,oo2 3
lastStatusUpdateUTCoo4 G
,ooG H
completeRatioooI V
,ooV W
statusooX ^
)oo^ _
;oo_ `
}qq 
SqlParameterHelperss 
sphss "
=ss# $
newss% (
SqlParameterHelperss) ;
(ss; <
ConnectionStringss< L
.ssL M$
GetWriteConnectionStringssM e
(sse f
)ssf g
,ssg h
$strssi ~
,ss~ 
$num
ss 
)
ss 
;
ss 
sphtt 
.tt 
DefineSqlParametertt "
(tt" #
$strtt# *
,tt* +
	SqlDbTypett, 5
.tt5 6
UniqueIdentifiertt6 F
,ttF G
ParameterDirectionttH Z
.ttZ [
Inputtt[ `
,tt` a
guidttb f
)ttf g
;ttg h
sphuu 
.uu 
DefineSqlParameteruu "
(uu" #
$struu# .
,uu. /
	SqlDbTypeuu0 9
.uu9 :
DateTimeuu: B
,uuB C
ParameterDirectionuuD V
.uuV W
InputuuW \
,uu\ ]
startUTCuu^ f
)uuf g
;uug h
sphvv 
.vv 
DefineSqlParametervv "
(vv" #
$strvv# 1
,vv1 2
	SqlDbTypevv3 <
.vv< =
DateTimevv= E
,vvE F
ParameterDirectionvvG Y
.vvY Z
InputvvZ _
,vv_ `
completeUTCvva l
)vvl m
;vvm n
sphww 
.ww 
DefineSqlParameterww "
(ww" #
$strww# 9
,ww9 :
	SqlDbTypeww; D
.wwD E
DateTimewwE M
,wwM N
ParameterDirectionwwO a
.wwa b
Inputwwb g
,wwg h
lastStatusUpdateUTCwwi |
)ww| }
;ww} ~
sphxx 
.xx 
DefineSqlParameterxx "
(xx" #
$strxx# 3
,xx3 4
	SqlDbTypexx5 >
.xx> ?
Floatxx? D
,xxD E
ParameterDirectionxxF X
.xxX Y
InputxxY ^
,xx^ _
completeRatioxx` m
)xxm n
;xxn o
sphyy 
.yy 
DefineSqlParameteryy "
(yy" #
$stryy# ,
,yy, -
	SqlDbTypeyy. 7
.yy7 8
NVarCharyy8 @
,yy@ A
$numyyB E
,yyE F
ParameterDirectionyyG Y
.yyY Z
InputyyZ _
,yy_ `
statusyya g
)yyg h
;yyh i
int{{ 
rowsAffected{{ 
={{ 
sph{{ "
.{{" #
ExecuteNonQuery{{# 2
({{2 3
){{3 4
;{{4 5
return|| 
(|| 
rowsAffected||  
>||! "
$num||# $
)||$ %
;||% &
}}} 	
private 
static 
bool 
UpdateStatus (
(( )
Guid
 
guid
 
,
 
DateTime
 
startUTC
 
,
 
DateTime
 !
lastStatusUpdateUTC
 (
,
( )
double
 
completeRatio
  
,
  !
string
 
status
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
DateTime
: B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
startUTC
^ f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 9
,
9 :
	SqlDbType
; D
.
D E
DateTime
E M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h!
lastStatusUpdateUTC
i |
)
| }
;
} ~
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
Float
? D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
completeRatio
` m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
status
a g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
private
 
static
 
bool
 
UpdateStatus
 (
(
( )
Guid
 
guid
 
,
 
DateTime
 !
lastStatusUpdateUTC
 (
,
( )
double
 
completeRatio
  
,
  !
string
 
status
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 9
,
9 :
	SqlDbType
; D
.
D E
DateTime
E M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h!
lastStatusUpdateUTC
i |
)
| }
;
} ~
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
Float
? D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
completeRatio
` m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
status
a g
)
g h
;
h i
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
   
(
   
rowsAffected
    
>
  ! "
$num
  # $
)
  $ %
;
  % &
}
££ 	
public
¥¥ 
static
¥¥ 
bool
¥¥  
UpdateNotification
¥¥ -
(
¥¥- .
Guid
¦¦ 
guid
¦¦ 
,
¦¦ 
DateTime
§§ !
notificationSentUtc
§§ (
)
§§( )
{
¨¨ 	 
SqlParameterHelper
©© 
sph
©© "
=
©©# $
new
©©% ( 
SqlParameterHelper
©©) ;
(
©©; <
ConnectionString
©©< L
.
©©L M&
GetWriteConnectionString
©©M e
(
©©e f
)
©©f g
,
©©g h
$str©©i 
,©© 
$num©© 
)©© 
;©© 
sph
ªª 
.
ªª  
DefineSqlParameter
ªª "
(
ªª" #
$str
ªª# *
,
ªª* +
	SqlDbType
ªª, 5
.
ªª5 6
UniqueIdentifier
ªª6 F
,
ªªF G 
ParameterDirection
ªªH Z
.
ªªZ [
Input
ªª[ `
,
ªª` a
guid
ªªb f
)
ªªf g
;
ªªg h
sph
«« 
.
««  
DefineSqlParameter
«« "
(
««" #
$str
««# 9
,
««9 :
	SqlDbType
««; D
.
««D E
DateTime
««E M
,
««M N 
ParameterDirection
««O a
.
««a b
Input
««b g
,
««g h!
notificationSentUtc
««i |
)
««| }
;
««} ~
int
­­ 
rowsAffected
­­ 
=
­­ 
sph
­­ "
.
­­" #
ExecuteNonQuery
­­# 2
(
­­2 3
)
­­3 4
;
­­4 5
return
®® 
(
®® 
rowsAffected
®®  
>
®®! "
$num
®®# $
)
®®$ %
;
®®% &
}
±± 	
public
¸¸ 
static
¸¸ 
bool
¸¸ 
Delete
¸¸ !
(
¸¸! "
Guid
¸¸" &
guid
¸¸' +
)
¸¸+ ,
{
¹¹ 	 
SqlParameterHelper
ºº 
sph
ºº "
=
ºº# $
new
ºº% ( 
SqlParameterHelper
ºº) ;
(
ºº; <
ConnectionString
ºº< L
.
ººL M&
GetWriteConnectionString
ººM e
(
ººe f
)
ººf g
,
ººg h
$str
ººi ~
,
ºº~ 
$numºº 
)ºº 
;ºº 
sph
»» 
.
»»  
DefineSqlParameter
»» "
(
»»" #
$str
»»# *
,
»»* +
	SqlDbType
»», 5
.
»»5 6
UniqueIdentifier
»»6 F
,
»»F G 
ParameterDirection
»»H Z
.
»»Z [
Input
»»[ `
,
»»` a
guid
»»b f
)
»»f g
;
»»g h
int
¼¼ 
rowsAffected
¼¼ 
=
¼¼ 
sph
¼¼ "
.
¼¼" #
ExecuteNonQuery
¼¼# 2
(
¼¼2 3
)
¼¼3 4
;
¼¼4 5
return
½½ 
(
½½ 
rowsAffected
½½  
>
½½! "
$num
½½# $
)
½½$ %
;
½½% &
}
¿¿ 	
public
ÁÁ 
static
ÁÁ 
bool
ÁÁ 
DeleteByType
ÁÁ '
(
ÁÁ' (
string
ÁÁ( .
taskType
ÁÁ/ 7
)
ÁÁ7 8
{
ÂÂ 	 
SqlParameterHelper
ÃÃ 
sph
ÃÃ "
=
ÃÃ# $
new
ÃÃ% ( 
SqlParameterHelper
ÃÃ) ;
(
ÃÃ; <
ConnectionString
ÃÃ< L
.
ÃÃL M&
GetWriteConnectionString
ÃÃM e
(
ÃÃe f
)
ÃÃf g
,
ÃÃg h
$strÃÃi 
,ÃÃ 
$numÃÃ 
)ÃÃ 
;ÃÃ 
sph
ÄÄ 
.
ÄÄ  
DefineSqlParameter
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# .
,
ÄÄ. /
	SqlDbType
ÄÄ0 9
.
ÄÄ9 :
NVarChar
ÄÄ: B
,
ÄÄB C
$num
ÄÄD G
,
ÄÄG H 
ParameterDirection
ÄÄI [
.
ÄÄ[ \
Input
ÄÄ\ a
,
ÄÄa b
taskType
ÄÄc k
)
ÄÄk l
;
ÄÄl m
int
ÅÅ 
rowsAffected
ÅÅ 
=
ÅÅ 
sph
ÅÅ "
.
ÅÅ" #
ExecuteNonQuery
ÅÅ# 2
(
ÅÅ2 3
)
ÅÅ3 4
;
ÅÅ4 5
return
ÆÆ 
(
ÆÆ 
rowsAffected
ÆÆ  
>
ÆÆ! "
$num
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
}
ÈÈ 	
public
ÎÎ 
static
ÎÎ 
void
ÎÎ 
DeleteCompleted
ÎÎ *
(
ÎÎ* +
)
ÎÎ+ ,
{
ÏÏ 	
	SqlHelper
ÑÑ 
.
ÑÑ 
ExecuteNonQuery
ÑÑ %
(
ÑÑ% &
ConnectionString
ÒÒ  
.
ÒÒ  !&
GetWriteConnectionString
ÒÒ! 9
(
ÒÒ9 :
)
ÒÒ: ;
,
ÒÒ; <
CommandType
ÓÓ 
.
ÓÓ 
StoredProcedure
ÓÓ +
,
ÓÓ+ ,
$str
ÔÔ .
,
ÔÔ. /
null
ÕÕ 
)
ÕÕ 
;
ÕÕ 
}
×× 	
public
ëë 
static
ëë 
IDataReader
ëë !
GetOne
ëë" (
(
ëë( )
Guid
ëë) -
guid
ëë. 2
)
ëë2 3
{
ìì 	 
SqlParameterHelper
íí 
sph
íí "
=
íí# $
new
íí% ( 
SqlParameterHelper
íí) ;
(
íí; <
ConnectionString
íí< L
.
ííL M%
GetReadConnectionString
ííM d
(
ííd e
)
ííe f
,
ííf g
$strííh 
,íí 
$numíí 
)íí 
;íí 
sph
îî 
.
îî  
DefineSqlParameter
îî "
(
îî" #
$str
îî# *
,
îî* +
	SqlDbType
îî, 5
.
îî5 6
UniqueIdentifier
îî6 F
,
îîF G 
ParameterDirection
îîH Z
.
îîZ [
Input
îî[ `
,
îî` a
guid
îîb f
)
îîf g
;
îîg h
return
ïï 
sph
ïï 
.
ïï 
ExecuteReader
ïï $
(
ïï$ %
)
ïï% &
;
ïï& '
}
ðð 	
public
öö 
static
öö 
int
öö 
GetCount
öö "
(
öö" #
)
öö# $
{
÷÷ 	
return
ùù 
Convert
ùù 
.
ùù 
ToInt32
ùù "
(
ùù" #
	SqlHelper
ùù# ,
.
ùù, -
ExecuteScalar
ùù- :
(
ùù: ;
ConnectionString
úú  
.
úú  !%
GetReadConnectionString
úú! 8
(
úú8 9
)
úú9 :
,
úú: ;
CommandType
ûû 
.
ûû 
StoredProcedure
ûû +
,
ûû+ ,
$str
üü '
,
üü' (
null
ýý 
)
ýý 
)
ýý 
;
ýý 
}
ÿÿ 	
public
 
static
 
int
 
GetCount
 "
(
" #
Guid
# '
siteGuid
( 0
)
0 1
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
int
 &
GetCountUnfinishedByType
 2
(
2 3
string
3 9
taskType
: B
)
B C
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
taskType
c k
)
k l
;
l m
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
int
  
GetCountUnfinished
 ,
(
, -
)
- .
{
 	
return
 
Convert
 
.
 
ToInt32
 "
(
" #
	SqlHelper
# ,
.
, -
ExecuteScalar
- :
(
: ;
ConnectionString
    
.
    !%
GetReadConnectionString
  ! 8
(
  8 9
)
  9 :
,
  : ;
CommandType
¡¡ 
.
¡¡ 
StoredProcedure
¡¡ +
,
¡¡+ ,
$str
¢¢ 1
,
¢¢1 2
null
££ 
)
££ 
)
££ 
;
££ 
}
¥¥ 	
public
«« 
static
«« 
int
««  
GetCountUnfinished
«« ,
(
««, -
Guid
««- 1
siteGuid
««2 :
)
««: ;
{
¬¬ 	 
SqlParameterHelper
­­ 
sph
­­ "
=
­­# $
new
­­% ( 
SqlParameterHelper
­­) ;
(
­­; <
ConnectionString
­­< L
.
­­L M%
GetReadConnectionString
­­M d
(
­­d e
)
­­e f
,
­­f g
$str­­h 
,­­ 
$num­­ 
)­­ 
;­­ 
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# .
,
®®. /
	SqlDbType
®®0 9
.
®®9 :
UniqueIdentifier
®®: J
,
®®J K 
ParameterDirection
®®L ^
.
®®^ _
Input
®®_ d
,
®®d e
siteGuid
®®f n
)
®®n o
;
®®o p
return
°° 
Convert
°° 
.
°° 
ToInt32
°° "
(
°°" #
sph
°°# &
.
°°& '
ExecuteScalar
°°' 4
(
°°4 5
)
°°5 6
)
°°6 7
;
°°7 8
}
³³ 	
public
¸¸ 
static
¸¸ 
IDataReader
¸¸ ! 
GetTasksNotStarted
¸¸" 4
(
¸¸4 5
)
¸¸5 6
{
¹¹ 	
return
»» 
	SqlHelper
»» 
.
»» 
ExecuteReader
»» *
(
»»* +
ConnectionString
¼¼  
.
¼¼  !%
GetReadConnectionString
¼¼! 8
(
¼¼8 9
)
¼¼9 :
,
¼¼: ;
CommandType
½½ 
.
½½ 
StoredProcedure
½½ +
,
½½+ ,
$str
¾¾ 4
,
¾¾4 5
null
¿¿ 
)
¿¿ 
;
¿¿ 
}
ÁÁ 	
public
ÇÇ 
static
ÇÇ 
IDataReader
ÇÇ !%
GetTasksForNotification
ÇÇ" 9
(
ÇÇ9 :
)
ÇÇ: ;
{
ÈÈ 	
return
ÊÊ 
	SqlHelper
ÊÊ 
.
ÊÊ 
ExecuteReader
ÊÊ *
(
ÊÊ* +
ConnectionString
ËË  
.
ËË  !%
GetReadConnectionString
ËË! 8
(
ËË8 9
)
ËË9 :
,
ËË: ;
CommandType
ÌÌ 
.
ÌÌ 
StoredProcedure
ÌÌ +
,
ÌÌ+ ,
$str
ÍÍ 4
,
ÍÍ4 5
null
ÎÎ 
)
ÎÎ 
;
ÎÎ 
}
ÐÐ 	
public
ÖÖ 
static
ÖÖ 
IDataReader
ÖÖ !
GetUnfinished
ÖÖ" /
(
ÖÖ/ 0
)
ÖÖ0 1
{
×× 	
return
ÙÙ 
	SqlHelper
ÙÙ 
.
ÙÙ 
ExecuteReader
ÙÙ *
(
ÙÙ* +
ConnectionString
ÚÚ  
.
ÚÚ  !%
GetReadConnectionString
ÚÚ! 8
(
ÚÚ8 9
)
ÚÚ9 :
,
ÚÚ: ;
CommandType
ÛÛ 
.
ÛÛ 
StoredProcedure
ÛÛ +
,
ÛÛ+ ,
$str
ÜÜ /
,
ÜÜ/ 0
null
ÝÝ 
)
ÝÝ 
;
ÝÝ 
}
ßß 	
public
ææ 
static
ææ 
IDataReader
ææ !
GetUnfinished
ææ" /
(
ææ/ 0
Guid
ææ0 4
siteGuid
ææ5 =
)
ææ= >
{
çç 	 
SqlParameterHelper
èè 
sph
èè "
=
èè# $
new
èè% ( 
SqlParameterHelper
èè) ;
(
èè; <
ConnectionString
èè< L
.
èèL M%
GetReadConnectionString
èèM d
(
èèd e
)
èèe f
,
èèf g
$strèèh 
,èè 
$numèè 
)èè 
;èè 
sph
éé 
.
éé  
DefineSqlParameter
éé "
(
éé" #
$str
éé# .
,
éé. /
	SqlDbType
éé0 9
.
éé9 :
UniqueIdentifier
éé: J
,
ééJ K 
ParameterDirection
ééL ^
.
éé^ _
Input
éé_ d
,
ééd e
siteGuid
ééf n
)
één o
;
ééo p
return
êê 
sph
êê 
.
êê 
ExecuteReader
êê $
(
êê$ %
)
êê% &
;
êê& '
}
ìì 	
public
óó 
static
óó 
IDataReader
óó !
GetPage
óó" )
(
óó) *
int
ôô 

pageNumber
ôô 
,
ôô 
int
õõ 
pageSize
õõ 
,
õõ 
out
öö 
int
öö 

totalPages
öö 
)
öö 
{
÷÷ 	

totalPages
øø 
=
øø 
$num
øø 
;
øø 
int
ùù 
	totalRows
ùù 
=
úú 
GetCount
úú 
(
úú 
)
úú 
;
úú 
if
üü 
(
üü 
pageSize
üü 
>
üü 
$num
üü 
)
üü 

totalPages
üü (
=
üü) *
	totalRows
üü+ 4
/
üü5 6
pageSize
üü7 ?
;
üü? @
if
þþ 
(
þþ 
	totalRows
þþ 
<=
þþ 
pageSize
þþ %
)
þþ% &
{
ÿÿ 

totalPages
 
=
 
$num
 
;
 
}
 
else
 
{
 
int
 
	remainder
 
;
 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
public
 
static
 
IDataReader
 !
GetPageBySite
" /
(
/ 0
Guid
 
siteGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
   
	totalRows
   
=
¡¡ 
GetCount
¡¡ 
(
¡¡ 
siteGuid
¡¡ #
)
¡¡# $
;
¡¡$ %
if
££ 
(
££ 
pageSize
££ 
>
££ 
$num
££ 
)
££ 

totalPages
££ (
=
££) *
	totalRows
££+ 4
/
££5 6
pageSize
££7 ?
;
££? @
if
¥¥ 
(
¥¥ 
	totalRows
¥¥ 
<=
¥¥ 
pageSize
¥¥ %
)
¥¥% &
{
¦¦ 

totalPages
§§ 
=
§§ 
$num
§§ 
;
§§ 
}
¨¨ 
else
©© 
{
ªª 
int
«« 
	remainder
«« 
;
«« 
Math
¬¬ 
.
¬¬ 
DivRem
¬¬ 
(
¬¬ 
	totalRows
¬¬ %
,
¬¬% &
pageSize
¬¬' /
,
¬¬/ 0
out
¬¬1 4
	remainder
¬¬5 >
)
¬¬> ?
;
¬¬? @
if
­­ 
(
­­ 
	remainder
­­ 
>
­­ 
$num
­­  !
)
­­! "
{
®® 

totalPages
¯¯ 
+=
¯¯ !
$num
¯¯" #
;
¯¯# $
}
°° 
}
±±  
SqlParameterHelper
³³ 
sph
³³ "
=
³³# $
new
³³% ( 
SqlParameterHelper
³³) ;
(
³³; <
ConnectionString
³³< L
.
³³L M%
GetReadConnectionString
³³M d
(
³³d e
)
³³e f
,
³³f g
$str³³h 
,³³ 
$num³³ 
)³³ 
;³³ 
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
UniqueIdentifier
´´: J
,
´´J K 
ParameterDirection
´´L ^
.
´´^ _
Input
´´_ d
,
´´d e
siteGuid
´´f n
)
´´n o
;
´´o p
sph
µµ 
.
µµ  
DefineSqlParameter
µµ "
(
µµ" #
$str
µµ# 0
,
µµ0 1
	SqlDbType
µµ2 ;
.
µµ; <
Int
µµ< ?
,
µµ? @ 
ParameterDirection
µµA S
.
µµS T
Input
µµT Y
,
µµY Z

pageNumber
µµ[ e
)
µµe f
;
µµf g
sph
¶¶ 
.
¶¶  
DefineSqlParameter
¶¶ "
(
¶¶" #
$str
¶¶# .
,
¶¶. /
	SqlDbType
¶¶0 9
.
¶¶9 :
Int
¶¶: =
,
¶¶= > 
ParameterDirection
¶¶? Q
.
¶¶Q R
Input
¶¶R W
,
¶¶W X
pageSize
¶¶Y a
)
¶¶a b
;
¶¶b c
return
·· 
sph
·· 
.
·· 
ExecuteReader
·· $
(
··$ %
)
··% &
;
··& '
}
¹¹ 	
public
ÀÀ 
static
ÀÀ 
IDataReader
ÀÀ !
GetPageUnfinished
ÀÀ" 3
(
ÀÀ3 4
int
ÁÁ 

pageNumber
ÁÁ 
,
ÁÁ 
int
ÂÂ 
pageSize
ÂÂ 
,
ÂÂ 
out
ÃÃ 
int
ÃÃ 

totalPages
ÃÃ 
)
ÃÃ 
{
ÄÄ 	

totalPages
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
int
ÆÆ 
	totalRows
ÆÆ 
=
ÇÇ  
GetCountUnfinished
ÇÇ $
(
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
if
ÉÉ 
(
ÉÉ 
pageSize
ÉÉ 
>
ÉÉ 
$num
ÉÉ 
)
ÉÉ 

totalPages
ÉÉ (
=
ÉÉ) *
	totalRows
ÉÉ+ 4
/
ÉÉ5 6
pageSize
ÉÉ7 ?
;
ÉÉ? @
if
ËË 
(
ËË 
	totalRows
ËË 
<=
ËË 
pageSize
ËË %
)
ËË% &
{
ÌÌ 

totalPages
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
{
ÐÐ 
int
ÑÑ 
	remainder
ÑÑ 
;
ÑÑ 
Math
ÒÒ 
.
ÒÒ 
DivRem
ÒÒ 
(
ÒÒ 
	totalRows
ÒÒ %
,
ÒÒ% &
pageSize
ÒÒ' /
,
ÒÒ/ 0
out
ÒÒ1 4
	remainder
ÒÒ5 >
)
ÒÒ> ?
;
ÒÒ? @
if
ÓÓ 
(
ÓÓ 
	remainder
ÓÓ 
>
ÓÓ 
$num
ÓÓ  !
)
ÓÓ! "
{
ÔÔ 

totalPages
ÕÕ 
+=
ÕÕ !
$num
ÕÕ" #
;
ÕÕ# $
}
ÖÖ 
}
××  
SqlParameterHelper
ÙÙ 
sph
ÙÙ "
=
ÙÙ# $
new
ÙÙ% ( 
SqlParameterHelper
ÙÙ) ;
(
ÙÙ; <
ConnectionString
ÙÙ< L
.
ÙÙL M%
GetReadConnectionString
ÙÙM d
(
ÙÙd e
)
ÙÙe f
,
ÙÙf g
$strÙÙh 
,ÙÙ 
$numÙÙ 
)ÙÙ 
;ÙÙ 
sph
ÚÚ 
.
ÚÚ  
DefineSqlParameter
ÚÚ "
(
ÚÚ" #
$str
ÚÚ# 0
,
ÚÚ0 1
	SqlDbType
ÚÚ2 ;
.
ÚÚ; <
Int
ÚÚ< ?
,
ÚÚ? @ 
ParameterDirection
ÚÚA S
.
ÚÚS T
Input
ÚÚT Y
,
ÚÚY Z

pageNumber
ÚÚ[ e
)
ÚÚe f
;
ÚÚf g
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# .
,
ÛÛ. /
	SqlDbType
ÛÛ0 9
.
ÛÛ9 :
Int
ÛÛ: =
,
ÛÛ= > 
ParameterDirection
ÛÛ? Q
.
ÛÛQ R
Input
ÛÛR W
,
ÛÛW X
pageSize
ÛÛY a
)
ÛÛa b
;
ÛÛb c
return
ÜÜ 
sph
ÜÜ 
.
ÜÜ 
ExecuteReader
ÜÜ $
(
ÜÜ$ %
)
ÜÜ% &
;
ÜÜ& '
}
ÞÞ 	
public
ææ 
static
ææ 
IDataReader
ææ !%
GetPageUnfinishedBySite
ææ" 9
(
ææ9 :
Guid
çç 
siteGuid
çç 
,
çç 
int
èè 

pageNumber
èè 
,
èè 
int
éé 
pageSize
éé 
,
éé 
out
êê 
int
êê 

totalPages
êê 
)
êê 
{
ëë 	

totalPages
ìì 
=
ìì 
$num
ìì 
;
ìì 
int
íí 
	totalRows
íí 
=
îî  
GetCountUnfinished
îî $
(
îî$ %
siteGuid
îî% -
)
îî- .
;
îî. /
if
ðð 
(
ðð 
pageSize
ðð 
>
ðð 
$num
ðð 
)
ðð 

totalPages
ðð (
=
ðð) *
	totalRows
ðð+ 4
/
ðð5 6
pageSize
ðð7 ?
;
ðð? @
if
òò 
(
òò 
	totalRows
òò 
<=
òò 
pageSize
òò %
)
òò% &
{
óó 

totalPages
ôô 
=
ôô 
$num
ôô 
;
ôô 
}
õõ 
else
öö 
{
÷÷ 
int
øø 
	remainder
øø 
;
øø 
Math
ùù 
.
ùù 
DivRem
ùù 
(
ùù 
	totalRows
ùù %
,
ùù% &
pageSize
ùù' /
,
ùù/ 0
out
ùù1 4
	remainder
ùù5 >
)
ùù> ?
;
ùù? @
if
úú 
(
úú 
	remainder
úú 
>
úú 
$num
úú  !
)
úú! "
{
ûû 

totalPages
üü 
+=
üü !
$num
üü" #
;
üü# $
}
ýý 
}
þþ  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
}
 
} h
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaxClass.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 

DBTaxClass "
{ 
public 
static 
int 
Create  
(  !
Guid 
guid 
, 
Guid 
siteGuid 
, 
string 
title 
, 
string   
description   
,   
DateTime!! 
lastModified!! !
,!!! "
DateTime"" 
created"" 
)"" 
{## 	
SqlParameterHelper%% 
sph%% "
=%%# $
new%%% (
SqlParameterHelper%%) ;
(%%; <
ConnectionString%%< L
.%%L M$
GetWriteConnectionString%%M e
(%%e f
)%%f g
,%%g h
$str%%i }
,%%} ~
$num	%% 
)
%% 
;
%% 
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# *
,&&* +
	SqlDbType&&, 5
.&&5 6
UniqueIdentifier&&6 F
,&&F G
ParameterDirection&&H Z
.&&Z [
Input&&[ `
,&&` a
guid&&b f
)&&f g
;&&g h
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# .
,''. /
	SqlDbType''0 9
.''9 :
UniqueIdentifier'': J
,''J K
ParameterDirection''L ^
.''^ _
Input''_ d
,''d e
siteGuid''f n
)''n o
;''o p
sph(( 
.(( 
DefineSqlParameter(( "
(((" #
$str((# +
,((+ ,
	SqlDbType((- 6
.((6 7
NVarChar((7 ?
,((? @
$num((A D
,((D E
ParameterDirection((F X
.((X Y
Input((Y ^
,((^ _
title((` e
)((e f
;((f g
sph)) 
.)) 
DefineSqlParameter)) "
())" #
$str))# 1
,))1 2
	SqlDbType))3 <
.))< =
NText))= B
,))B C
ParameterDirection))D V
.))V W
Input))W \
,))\ ]
description))^ i
)))i j
;))j k
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# 2
,**2 3
	SqlDbType**4 =
.**= >
DateTime**> F
,**F G
ParameterDirection**H Z
.**Z [
Input**[ `
,**` a
lastModified**b n
)**n o
;**o p
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# -
,++- .
	SqlDbType++/ 8
.++8 9
DateTime++9 A
,++A B
ParameterDirection++C U
.++U V
Input++V [
,++[ \
created++] d
)++d e
;++e f
int,, 
rowsAffected,, 
=,, 
sph,, "
.,," #
ExecuteNonQuery,,# 2
(,,2 3
),,3 4
;,,4 5
return-- 
rowsAffected-- 
;--  
}// 	
public11 
static11 
bool11 
Update11 !
(11! "
Guid22 
guid22 
,22 
string33 
title33 
,33 
string44 
description44 
,44 
DateTime55 
lastModified55 !
,55! "
DateTime66 
created66 
)66 
{77 	
SqlParameterHelper99 
sph99 "
=99# $
new99% (
SqlParameterHelper99) ;
(99; <
ConnectionString99< L
.99L M$
GetWriteConnectionString99M e
(99e f
)99f g
,99g h
$str99i }
,99} ~
$num	99 
)
99 
;
99 
sph:: 
.:: 
DefineSqlParameter:: "
(::" #
$str::# *
,::* +
	SqlDbType::, 5
.::5 6
UniqueIdentifier::6 F
,::F G
ParameterDirection::H Z
.::Z [
Input::[ `
,::` a
guid::b f
)::f g
;::g h
sph;; 
.;; 
DefineSqlParameter;; "
(;;" #
$str;;# +
,;;+ ,
	SqlDbType;;- 6
.;;6 7
NVarChar;;7 ?
,;;? @
$num;;A D
,;;D E
ParameterDirection;;F X
.;;X Y
Input;;Y ^
,;;^ _
title;;` e
);;e f
;;;f g
sph<< 
.<< 
DefineSqlParameter<< "
(<<" #
$str<<# 1
,<<1 2
	SqlDbType<<3 <
.<<< =
NText<<= B
,<<B C
ParameterDirection<<D V
.<<V W
Input<<W \
,<<\ ]
description<<^ i
)<<i j
;<<j k
sph== 
.== 
DefineSqlParameter== "
(==" #
$str==# 2
,==2 3
	SqlDbType==4 =
.=== >
DateTime==> F
,==F G
ParameterDirection==H Z
.==Z [
Input==[ `
,==` a
lastModified==b n
)==n o
;==o p
sph>> 
.>> 
DefineSqlParameter>> "
(>>" #
$str>># -
,>>- .
	SqlDbType>>/ 8
.>>8 9
DateTime>>9 A
,>>A B
ParameterDirection>>C U
.>>U V
Input>>V [
,>>[ \
created>>] d
)>>d e
;>>e f
int?? 
rowsAffected?? 
=?? 
sph?? "
.??" #
ExecuteNonQuery??# 2
(??2 3
)??3 4
;??4 5
return@@ 
(@@ 
rowsAffected@@  
>@@! "
$num@@# $
)@@$ %
;@@% &
}CC 	
publicEE 
staticEE 
boolEE 
DeleteEE !
(EE! "
GuidEE" &
guidEE' +
)EE+ ,
{FF 	
SqlParameterHelperGG 
sphGG "
=GG# $
newGG% (
SqlParameterHelperGG) ;
(GG; <
ConnectionStringGG< L
.GGL M$
GetWriteConnectionStringGGM e
(GGe f
)GGf g
,GGg h
$strGGi }
,GG} ~
$num	GG 
)
GG 
;
GG 
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# *
,HH* +
	SqlDbTypeHH, 5
.HH5 6
UniqueIdentifierHH6 F
,HHF G
ParameterDirectionHHH Z
.HHZ [
InputHH[ `
,HH` a
guidHHb f
)HHf g
;HHg h
intII 
rowsAffectedII 
=II 
sphII "
.II" #
ExecuteNonQueryII# 2
(II2 3
)II3 4
;II4 5
returnJJ 
(JJ 
rowsAffectedJJ  
>JJ! "
$numJJ# $
)JJ$ %
;JJ% &
}LL 	
publicNN 
staticNN 
IDataReaderNN !
GetOneNN" (
(NN( )
GuidNN) -
guidNN. 2
)NN2 3
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M#
GetReadConnectionStringPPM d
(PPd e
)PPe f
,PPf g
$strPPh 
,	PP 
$num
PP 
)
PP 
;
PP 
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# *
,QQ* +
	SqlDbTypeQQ, 5
.QQ5 6
UniqueIdentifierQQ6 F
,QQF G
ParameterDirectionQQH Z
.QQZ [
InputQQ[ `
,QQ` a
guidQQb f
)QQf g
;QQg h
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}VV 	
publicXX 
staticXX 
IDataReaderXX !
	GetBySiteXX" +
(XX+ ,
GuidXX, 0
siteGuidXX1 9
)XX9 :
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M#
GetReadConnectionStringZZM d
(ZZd e
)ZZe f
,ZZf g
$str	ZZh 
,
ZZ 
$num
ZZ 
)
ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# .
,[[. /
	SqlDbType[[0 9
.[[9 :
UniqueIdentifier[[: J
,[[J K
ParameterDirection[[L ^
.[[^ _
Input[[_ d
,[[d e
siteGuid[[f n
)[[n o
;[[o p
return\\ 
sph\\ 
.\\ 
ExecuteReader\\ $
(\\$ %
)\\% &
;\\& '
}`` 	
publicbb 
staticbb 
intbb 
GetCountBySitebb (
(bb( )
Guidbb) -
siteGuidbb. 6
)bb6 7
{cc 	
SqlParameterHelperdd 
sphdd "
=dd# $
newdd% (
SqlParameterHelperdd) ;
(dd; <
ConnectionStringdd< L
.ddL M#
GetReadConnectionStringddM d
(ddd e
)dde f
,ddf g
$str	ddh 
,
dd 
$num
dd 
)
dd 
;
dd 
sphee 
.ee 
DefineSqlParameteree "
(ee" #
$stree# .
,ee. /
	SqlDbTypeee0 9
.ee9 :
UniqueIdentifieree: J
,eeJ K
ParameterDirectioneeL ^
.ee^ _
Inputee_ d
,eed e
siteGuideef n
)een o
;eeo p
returnff 
Convertff 
.ff 
ToInt32ff "
(ff" #
sphff# &
.ff& '
ExecuteScalarff' 4
(ff4 5
)ff5 6
)ff6 7
;ff7 8
}jj 	
publicll 
staticll 
IDataReaderll !
GetPagell" )
(ll) *
Guidmm 
siteGuidmm 
,mm 
intnn 

pageNumbernn 
,nn 
intoo 
pageSizeoo 
,oo 
outpp 
intpp 

totalPagespp 
)pp 
{qq 	

totalPagesss 
=ss 
$numss 
;ss 
inttt 
	totalRowstt 
=uu 
GetCountBySiteuu  
(uu  !
siteGuiduu! )
)uu) *
;uu* +
ifww 
(ww 
pageSizeww 
>ww 
$numww 
)ww 

totalPagesww (
=ww) *
	totalRowsww+ 4
/ww5 6
pageSizeww7 ?
;ww? @
ifyy 
(yy 
	totalRowsyy 
<=yy 
pageSizeyy %
)yy% &
{zz 

totalPages{{ 
={{ 
$num{{ 
;{{ 
}|| 
else}} 
{~~ 
int 
	remainder 
; 
Math
 
.
 
DivRem
 
(
 
	totalRows
 %
,
% &
pageSize
' /
,
/ 0
out
1 4
	remainder
5 >
)
> ?
;
? @
if
 
(
 
	remainder
 
>
 
$num
  !
)
! "
{
 

totalPages
 
+=
 !
$num
" #
;
# $
}
 
}
  
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 0
,
0 1
	SqlDbType
2 ;
.
; <
Int
< ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z

pageNumber
[ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
 	
}
 
} 
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBTaxRate.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 
	DBTaxRate !
{ 
public 
static 
int 
Create  
(  !
Guid 
guid 
, 
Guid 
siteGuid 
, 
Guid   
geoZoneGuid   
,   
Guid!! 
taxClassGuid!! 
,!! 
int"" 
priority"" 
,"" 
decimal## 
rate## 
,## 
string$$ 
description$$ 
,$$ 
DateTime%% 
created%% 
,%% 
Guid&& 
	createdBy&& 
,&& 
DateTime'' 
lastModified'' !
,''! "
Guid(( 

modifiedBy(( 
)(( 
{)) 	
SqlParameterHelper++ 
sph++ "
=++# $
new++% (
SqlParameterHelper++) ;
(++; <
ConnectionString++< L
.++L M$
GetWriteConnectionString++M e
(++e f
)++f g
,++g h
$str++i |
,++| }
$num	++~ 
)
++ 
;
++ 
sph,, 
.,, 
DefineSqlParameter,, "
(,," #
$str,,# *
,,,* +
	SqlDbType,,, 5
.,,5 6
UniqueIdentifier,,6 F
,,,F G
ParameterDirection,,H Z
.,,Z [
Input,,[ `
,,,` a
guid,,b f
),,f g
;,,g h
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# .
,--. /
	SqlDbType--0 9
.--9 :
UniqueIdentifier--: J
,--J K
ParameterDirection--L ^
.--^ _
Input--_ d
,--d e
siteGuid--f n
)--n o
;--o p
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# 1
,..1 2
	SqlDbType..3 <
...< =
UniqueIdentifier..= M
,..M N
ParameterDirection..O a
...a b
Input..b g
,..g h
geoZoneGuid..i t
)..t u
;..u v
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# 2
,//2 3
	SqlDbType//4 =
.//= >
UniqueIdentifier//> N
,//N O
ParameterDirection//P b
.//b c
Input//c h
,//h i
taxClassGuid//j v
)//v w
;//w x
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# .
,00. /
	SqlDbType000 9
.009 :
Int00: =
,00= >
ParameterDirection00? Q
.00Q R
Input00R W
,00W X
priority00Y a
)00a b
;00b c
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# *
,11* +
	SqlDbType11, 5
.115 6
Decimal116 =
,11= >
ParameterDirection11? Q
.11Q R
Input11R W
,11W X
rate11Y ]
)11] ^
;11^ _
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# 1
,221 2
	SqlDbType223 <
.22< =
NVarChar22= E
,22E F
$num22G J
,22J K
ParameterDirection22L ^
.22^ _
Input22_ d
,22d e
description22f q
)22q r
;22r s
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# -
,33- .
	SqlDbType33/ 8
.338 9
DateTime339 A
,33A B
ParameterDirection33C U
.33U V
Input33V [
,33[ \
created33] d
)33d e
;33e f
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# /
,44/ 0
	SqlDbType441 :
.44: ;
UniqueIdentifier44; K
,44K L
ParameterDirection44M _
.44_ `
Input44` e
,44e f
	createdBy44g p
)44p q
;44q r
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 2
,552 3
	SqlDbType554 =
.55= >
DateTime55> F
,55F G
ParameterDirection55H Z
.55Z [
Input55[ `
,55` a
lastModified55b n
)55n o
;55o p
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
UniqueIdentifier66< L
,66L M
ParameterDirection66N `
.66` a
Input66a f
,66f g

modifiedBy66h r
)66r s
;66s t
int77 
rowsAffected77 
=77 
sph77 "
.77" #
ExecuteNonQuery77# 2
(772 3
)773 4
;774 5
return88 
rowsAffected88 
;88  
};; 	
public== 
static== 
bool== 
Update== !
(==! "
Guid>> 
guid>> 
,>> 
Guid?? 
geoZoneGuid?? 
,?? 
Guid@@ 
taxClassGuid@@ 
,@@ 
intAA 
priorityAA 
,AA 
decimalBB 
rateBB 
,BB 
stringCC 
descriptionCC 
,CC 
DateTimeDD 
lastModifiedDD !
,DD! "
GuidEE 

modifiedByEE 
)EE 
{FF 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$strHHi |
,HH| }
$numHH~ 
)	HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# *
,II* +
	SqlDbTypeII, 5
.II5 6
UniqueIdentifierII6 F
,IIF G
ParameterDirectionIIH Z
.IIZ [
InputII[ `
,II` a
guidIIb f
)IIf g
;IIg h
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# 1
,JJ1 2
	SqlDbTypeJJ3 <
.JJ< =
UniqueIdentifierJJ= M
,JJM N
ParameterDirectionJJO a
.JJa b
InputJJb g
,JJg h
geoZoneGuidJJi t
)JJt u
;JJu v
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# 2
,KK2 3
	SqlDbTypeKK4 =
.KK= >
UniqueIdentifierKK> N
,KKN O
ParameterDirectionKKP b
.KKb c
InputKKc h
,KKh i
taxClassGuidKKj v
)KKv w
;KKw x
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# .
,LL. /
	SqlDbTypeLL0 9
.LL9 :
IntLL: =
,LL= >
ParameterDirectionLL? Q
.LLQ R
InputLLR W
,LLW X
priorityLLY a
)LLa b
;LLb c
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# *
,MM* +
	SqlDbTypeMM, 5
.MM5 6
DecimalMM6 =
,MM= >
ParameterDirectionMM? Q
.MMQ R
InputMMR W
,MMW X
rateMMY ]
)MM] ^
;MM^ _
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# 1
,NN1 2
	SqlDbTypeNN3 <
.NN< =
NVarCharNN= E
,NNE F
$numNNG J
,NNJ K
ParameterDirectionNNL ^
.NN^ _
InputNN_ d
,NNd e
descriptionNNf q
)NNq r
;NNr s
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
DateTimeOO> F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
lastModifiedOOb n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 0
,PP0 1
	SqlDbTypePP2 ;
.PP; <
UniqueIdentifierPP< L
,PPL M
ParameterDirectionPPN `
.PP` a
InputPPa f
,PPf g

modifiedByPPh r
)PPr s
;PPs t
intQQ 
rowsAffectedQQ 
=QQ 
sphQQ "
.QQ" #
ExecuteNonQueryQQ# 2
(QQ2 3
)QQ3 4
;QQ4 5
returnRR 
(RR 
rowsAffectedRR  
>RR! "
$numRR# $
)RR$ %
;RR% &
}VV 	
publicXX 
staticXX 
boolXX 
DeleteXX !
(XX! "
GuidXX" &
guidXX' +
)XX+ ,
{YY 	
SqlParameterHelperZZ 
sphZZ "
=ZZ# $
newZZ% (
SqlParameterHelperZZ) ;
(ZZ; <
ConnectionStringZZ< L
.ZZL M$
GetWriteConnectionStringZZM e
(ZZe f
)ZZf g
,ZZg h
$strZZi |
,ZZ| }
$numZZ~ 
)	ZZ 
;
ZZ 
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# *
,[[* +
	SqlDbType[[, 5
.[[5 6
UniqueIdentifier[[6 F
,[[F G
ParameterDirection[[H Z
.[[Z [
Input[[[ `
,[[` a
guid[[b f
)[[f g
;[[g h
int\\ 
rowsAffected\\ 
=\\ 
sph\\ "
.\\" #
ExecuteNonQuery\\# 2
(\\2 3
)\\3 4
;\\4 5
return]] 
(]] 
rowsAffected]]  
>]]! "
$num]]# $
)]]$ %
;]]% &
}__ 	
publicaa 
staticaa 
IDataReaderaa !
GetOneaa" (
(aa( )
Guidaa) -
guidaa. 2
)aa2 3
{bb 	
SqlParameterHelpercc 
sphcc "
=cc# $
newcc% (
SqlParameterHelpercc) ;
(cc; <
ConnectionStringcc< L
.ccL M#
GetReadConnectionStringccM d
(ccd e
)cce f
,ccf g
$strcch ~
,cc~ 
$num
cc 
)
cc 
;
cc 
sphdd 
.dd 
DefineSqlParameterdd "
(dd" #
$strdd# *
,dd* +
	SqlDbTypedd, 5
.dd5 6
UniqueIdentifierdd6 F
,ddF G
ParameterDirectionddH Z
.ddZ [
Inputdd[ `
,dd` a
guidddb f
)ddf g
;ddg h
returnee 
sphee 
.ee 
ExecuteReaderee $
(ee$ %
)ee% &
;ee& '
}ii 	
publickk 
statickk 
IDataReaderkk !
GetTaxRateskk" -
(kk- .
Guidll 
siteGuidll 
,ll 
Guidmm 
geoZoneGuidmm 
)mm 
{nn 	
SqlParameterHelperpp 
sphpp "
=pp# $
newpp% (
SqlParameterHelperpp) ;
(pp; <
ConnectionStringpp< L
.ppL M#
GetReadConnectionStringppM d
(ppd e
)ppe f
,ppf g
$strpph ~
,pp~ 
$num
pp 
)
pp 
;
pp 
sphqq 
.qq 
DefineSqlParameterqq "
(qq" #
$strqq# .
,qq. /
	SqlDbTypeqq0 9
.qq9 :
UniqueIdentifierqq: J
,qqJ K
ParameterDirectionqqL ^
.qq^ _
Inputqq_ d
,qqd e
siteGuidqqf n
)qqn o
;qqo p
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# 1
,rr1 2
	SqlDbTyperr3 <
.rr< =
UniqueIdentifierrr= M
,rrM N
ParameterDirectionrrO a
.rra b
Inputrrb g
,rrg h
geoZoneGuidrri t
)rrt u
;rru v
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}vv 	
public
 
static
 
int
 

AddHistory
 $
(
$ %
Guid
 
guid
 
,
 
Guid
 
taxRateGuid
 
,
 
Guid
 
siteGuid
 
,
 
Guid
 
geoZoneGuid
 
,
 
Guid
 
taxClassGuid
 
,
 
int
 
priority
 
,
 
decimal
 
rate
 
,
 
string
 
description
 
,
 
DateTime
 
created
 
,
 
Guid
 
	createdBy
 
,
 
DateTime
 
lastModified
 !
,
! "
Guid
 

modifiedBy
 
,
 
DateTime
 
logTime
 
)
 
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
UniqueIdentifier
6 F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
guid
b f
)
f g
;
g h
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
taxRateGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 1
,
1 2
	SqlDbType
3 <
.
< =
UniqueIdentifier
= M
,
M N 
ParameterDirection
O a
.
a b
Input
b g
,
g h
geoZoneGuid
i t
)
t u
;
u v
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
UniqueIdentifier
> N
,
N O 
ParameterDirection
P b
.
b c
Input
c h
,
h i
taxClassGuid
j v
)
v w
;
w x
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
priority
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
Decimal
6 =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
rate
Y ]
)
] ^
;
^ _
sph
   
.
    
DefineSqlParameter
   "
(
  " #
$str
  # 1
,
  1 2
	SqlDbType
  3 <
.
  < =
NVarChar
  = E
,
  E F
$num
  G J
,
  J K 
ParameterDirection
  L ^
.
  ^ _
Input
  _ d
,
  d e
description
  f q
)
  q r
;
  r s
sph
¡¡ 
.
¡¡  
DefineSqlParameter
¡¡ "
(
¡¡" #
$str
¡¡# -
,
¡¡- .
	SqlDbType
¡¡/ 8
.
¡¡8 9
DateTime
¡¡9 A
,
¡¡A B 
ParameterDirection
¡¡C U
.
¡¡U V
Input
¡¡V [
,
¡¡[ \
created
¡¡] d
)
¡¡d e
;
¡¡e f
sph
¢¢ 
.
¢¢  
DefineSqlParameter
¢¢ "
(
¢¢" #
$str
¢¢# /
,
¢¢/ 0
	SqlDbType
¢¢1 :
.
¢¢: ;
UniqueIdentifier
¢¢; K
,
¢¢K L 
ParameterDirection
¢¢M _
.
¢¢_ `
Input
¢¢` e
,
¢¢e f
	createdBy
¢¢g p
)
¢¢p q
;
¢¢q r
sph
££ 
.
££  
DefineSqlParameter
££ "
(
££" #
$str
££# 2
,
££2 3
	SqlDbType
££4 =
.
££= >
DateTime
££> F
,
££F G 
ParameterDirection
££H Z
.
££Z [
Input
££[ `
,
££` a
lastModified
££b n
)
££n o
;
££o p
sph
¤¤ 
.
¤¤  
DefineSqlParameter
¤¤ "
(
¤¤" #
$str
¤¤# 0
,
¤¤0 1
	SqlDbType
¤¤2 ;
.
¤¤; <
UniqueIdentifier
¤¤< L
,
¤¤L M 
ParameterDirection
¤¤N `
.
¤¤` a
Input
¤¤a f
,
¤¤f g

modifiedBy
¤¤h r
)
¤¤r s
;
¤¤s t
sph
¥¥ 
.
¥¥  
DefineSqlParameter
¥¥ "
(
¥¥" #
$str
¥¥# -
,
¥¥- .
	SqlDbType
¥¥/ 8
.
¥¥8 9
DateTime
¥¥9 A
,
¥¥A B 
ParameterDirection
¥¥C U
.
¥¥U V
Input
¥¥V [
,
¥¥[ \
logTime
¥¥] d
)
¥¥d e
;
¥¥e f
int
¦¦ 
rowsAffected
¦¦ 
=
¦¦ 
sph
¦¦ "
.
¦¦" #
ExecuteNonQuery
¦¦# 2
(
¦¦2 3
)
¦¦3 4
;
¦¦4 5
return
§§ 
rowsAffected
§§ 
;
§§  
}
©© 	
}
¬¬ 
}­­ À
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\DBUserLocation.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
DBUserLocation &
{ 
public00 
static00 
int00 
Create00  
(00  !
Guid11 
rowID11 
,11 
Guid22 
userGuid22 
,22 
Guid33 
siteGuid33 
,33 
string44 
	iPAddress44 
,44 
long55 
iPAddressLong55 
,55 
string66 
hostname66 
,66 
double77 
	longitude77 
,77 
double88 
latitude88 
,88 
string99 
iSP99 
,99 
string:: 
	continent:: 
,:: 
string;; 
country;; 
,;; 
string<< 
region<< 
,<< 
string== 
city== 
,== 
string>> 
timeZone>> 
,>> 
int?? 
captureCount?? 
,?? 
DateTime@@ 
firstCaptureUTC@@ $
,@@$ %
DateTimeAA 
lastCaptureUTCAA #
)AA# $
{BB 	
SqlParameterHelperCC 
sphCC "
=CC# $
newCC% (
SqlParameterHelperCC) ;
(CC; <
ConnectionStringCC< L
.CCL M$
GetWriteConnectionStringCCM e
(CCe f
)CCf g
,CCg h
$str	CCi 
,
CC 
$num
CC 
)
CC 
;
CC 
sphDD 
.DD 
DefineSqlParameterDD "
(DD" #
$strDD# +
,DD+ ,
	SqlDbTypeDD- 6
.DD6 7
UniqueIdentifierDD7 G
,DDG H
ParameterDirectionDDI [
.DD[ \
InputDD\ a
,DDa b
rowIDDDc h
)DDh i
;DDi j
sphEE 
.EE 
DefineSqlParameterEE "
(EE" #
$strEE# .
,EE. /
	SqlDbTypeEE0 9
.EE9 :
UniqueIdentifierEE: J
,EEJ K
ParameterDirectionEEL ^
.EE^ _
InputEE_ d
,EEd e
userGuidEEf n
)EEn o
;EEo p
sphFF 
.FF 
DefineSqlParameterFF "
(FF" #
$strFF# .
,FF. /
	SqlDbTypeFF0 9
.FF9 :
UniqueIdentifierFF: J
,FFJ K
ParameterDirectionFFL ^
.FF^ _
InputFF_ d
,FFd e
siteGuidFFf n
)FFn o
;FFo p
sphGG 
.GG 
DefineSqlParameterGG "
(GG" #
$strGG# /
,GG/ 0
	SqlDbTypeGG1 :
.GG: ;
NVarCharGG; C
,GGC D
$numGGE G
,GGG H
ParameterDirectionGGI [
.GG[ \
InputGG\ a
,GGa b
	iPAddressGGc l
)GGl m
;GGm n
sphHH 
.HH 
DefineSqlParameterHH "
(HH" #
$strHH# 3
,HH3 4
	SqlDbTypeHH5 >
.HH> ?
BigIntHH? E
,HHE F
ParameterDirectionHHG Y
.HHY Z
InputHHZ _
,HH_ `
iPAddressLongHHa n
)HHn o
;HHo p
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# .
,II. /
	SqlDbTypeII0 9
.II9 :
NVarCharII: B
,IIB C
$numIID G
,IIG H
ParameterDirectionIII [
.II[ \
InputII\ a
,IIa b
hostnameIIc k
)IIk l
;IIl m
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# /
,JJ/ 0
	SqlDbTypeJJ1 :
.JJ: ;
FloatJJ; @
,JJ@ A
ParameterDirectionJJB T
.JJT U
InputJJU Z
,JJZ [
	longitudeJJ\ e
)JJe f
;JJf g
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# .
,KK. /
	SqlDbTypeKK0 9
.KK9 :
FloatKK: ?
,KK? @
ParameterDirectionKKA S
.KKS T
InputKKT Y
,KKY Z
latitudeKK[ c
)KKc d
;KKd e
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# )
,LL) *
	SqlDbTypeLL+ 4
.LL4 5
NVarCharLL5 =
,LL= >
$numLL? B
,LLB C
ParameterDirectionLLD V
.LLV W
InputLLW \
,LL\ ]
iSPLL^ a
)LLa b
;LLb c
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# /
,MM/ 0
	SqlDbTypeMM1 :
.MM: ;
NVarCharMM; C
,MMC D
$numMME H
,MMH I
ParameterDirectionMMJ \
.MM\ ]
InputMM] b
,MMb c
	continentMMd m
)MMm n
;MMn o
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# -
,NN- .
	SqlDbTypeNN/ 8
.NN8 9
NVarCharNN9 A
,NNA B
$numNNC F
,NNF G
ParameterDirectionNNH Z
.NNZ [
InputNN[ `
,NN` a
countryNNb i
)NNi j
;NNj k
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# ,
,OO, -
	SqlDbTypeOO. 7
.OO7 8
NVarCharOO8 @
,OO@ A
$numOOB E
,OOE F
ParameterDirectionOOG Y
.OOY Z
InputOOZ _
,OO_ `
regionOOa g
)OOg h
;OOh i
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# *
,PP* +
	SqlDbTypePP, 5
.PP5 6
NVarCharPP6 >
,PP> ?
$numPP@ C
,PPC D
ParameterDirectionPPE W
.PPW X
InputPPX ]
,PP] ^
cityPP_ c
)PPc d
;PPd e
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# .
,QQ. /
	SqlDbTypeQQ0 9
.QQ9 :
NVarCharQQ: B
,QQB C
$numQQD G
,QQG H
ParameterDirectionQQI [
.QQ[ \
InputQQ\ a
,QQa b
timeZoneQQc k
)QQk l
;QQl m
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# 2
,RR2 3
	SqlDbTypeRR4 =
.RR= >
IntRR> A
,RRA B
ParameterDirectionRRC U
.RRU V
InputRRV [
,RR[ \
captureCountRR] i
)RRi j
;RRj k
sphSS 
.SS 
DefineSqlParameterSS "
(SS" #
$strSS# 5
,SS5 6
	SqlDbTypeSS7 @
.SS@ A
DateTimeSSA I
,SSI J
ParameterDirectionSSK ]
.SS] ^
InputSS^ c
,SSc d
firstCaptureUTCSSe t
)SSt u
;SSu v
sphTT 
.TT 
DefineSqlParameterTT "
(TT" #
$strTT# 4
,TT4 5
	SqlDbTypeTT6 ?
.TT? @
DateTimeTT@ H
,TTH I
ParameterDirectionTTJ \
.TT\ ]
InputTT] b
,TTb c
lastCaptureUTCTTd r
)TTr s
;TTs t
intUU 
rowsAffectedUU 
=UU 
sphUU "
.UU" #
ExecuteNonQueryUU# 2
(UU2 3
)UU3 4
;UU4 5
returnVV 
rowsAffectedVV 
;VV  
}WW 	
publicnn 
staticnn 
boolnn 
Updatenn !
(nn! "
Guidoo 
rowIDoo 
,oo 
Guidpp 
userGuidpp 
,pp 
Guidqq 
siteGuidqq 
,qq 
stringrr 
	iPAddressrr 
,rr 
longss 
iPAddressLongss 
,ss 
stringtt 
hostnamett 
,tt 
doubleuu 
	longitudeuu 
,uu 
doublevv 
latitudevv 
,vv 
stringww 
iSPww 
,ww 
stringxx 
	continentxx 
,xx 
stringyy 
countryyy 
,yy 
stringzz 
regionzz 
,zz 
string{{ 
city{{ 
,{{ 
string|| 
timeZone|| 
,|| 
int}} 
captureCount}} 
,}} 
DateTime~~ 
lastCaptureUTC~~ #
)~~# $
{ 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
UniqueIdentifier
7 G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
rowID
c h
)
h i
;
i j
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
userGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
NVarChar
; C
,
C D
$num
E G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
	iPAddress
c l
)
l m
;
m n
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 3
,
3 4
	SqlDbType
5 >
.
> ?
BigInt
? E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
iPAddressLong
a n
)
n o
;
o p
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
hostname
c k
)
k l
;
l m
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
Float
; @
,
@ A 
ParameterDirection
B T
.
T U
Input
U Z
,
Z [
	longitude
\ e
)
e f
;
f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Float
: ?
,
? @ 
ParameterDirection
A S
.
S T
Input
T Y
,
Y Z
latitude
[ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# )
,
) *
	SqlDbType
+ 4
.
4 5
NVarChar
5 =
,
= >
$num
? B
,
B C 
ParameterDirection
D V
.
V W
Input
W \
,
\ ]
iSP
^ a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# /
,
/ 0
	SqlDbType
1 :
.
: ;
NVarChar
; C
,
C D
$num
E H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
	continent
d m
)
m n
;
n o
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# -
,
- .
	SqlDbType
/ 8
.
8 9
NVarChar
9 A
,
A B
$num
C F
,
F G 
ParameterDirection
H Z
.
Z [
Input
[ `
,
` a
country
b i
)
i j
;
j k
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
NVarChar
8 @
,
@ A
$num
B E
,
E F 
ParameterDirection
G Y
.
Y Z
Input
Z _
,
_ `
region
a g
)
g h
;
h i
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# *
,
* +
	SqlDbType
, 5
.
5 6
NVarChar
6 >
,
> ?
$num
@ C
,
C D 
ParameterDirection
E W
.
W X
Input
X ]
,
] ^
city
_ c
)
c d
;
d e
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
NVarChar
: B
,
B C
$num
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
timeZone
c k
)
k l
;
l m
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 2
,
2 3
	SqlDbType
4 =
.
= >
Int
> A
,
A B 
ParameterDirection
C U
.
U V
Input
V [
,
[ \
captureCount
] i
)
i j
;
j k
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 4
,
4 5
	SqlDbType
6 ?
.
? @
DateTime
@ H
,
H I 
ParameterDirection
J \
.
\ ]
Input
] b
,
b c
lastCaptureUTC
d r
)
r s
;
s t
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
 	
public
 
static
 
bool
 
Delete
 !
(
! "
Guid
" &
rowID
' ,
)
, -
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M&
GetWriteConnectionString
M e
(
e f
)
f g
,
g h
$stri 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# +
,
+ ,
	SqlDbType
- 6
.
6 7
UniqueIdentifier
7 G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b
rowID
c h
)
h i
;
i j
int
 
rowsAffected
 
=
 
sph
 "
.
" #
ExecuteNonQuery
# 2
(
2 3
)
3 4
;
4 5
return
 
(
 
rowsAffected
  
>
! "
$num
# $
)
$ %
;
% &
}
¡¡ 	
public
££ 
static
££ 
bool
££ 
DeleteByUser
££ '
(
££' (
Guid
££( ,
userGuid
££- 5
)
££5 6
{
¤¤ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M&
GetWriteConnectionString
¥¥M e
(
¥¥e f
)
¥¥f g
,
¥¥g h
$str¥¥i 
,¥¥ 
$num¥¥ 
)¥¥ 
;¥¥ 
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# .
,
¦¦. /
	SqlDbType
¦¦0 9
.
¦¦9 :
UniqueIdentifier
¦¦: J
,
¦¦J K 
ParameterDirection
¦¦L ^
.
¦¦^ _
Input
¦¦_ d
,
¦¦d e
userGuid
¦¦f n
)
¦¦n o
;
¦¦o p
int
§§ 
rowsAffected
§§ 
=
§§ 
sph
§§ "
.
§§" #
ExecuteNonQuery
§§# 2
(
§§2 3
)
§§3 4
;
§§4 5
return
¨¨ 
(
¨¨ 
rowsAffected
¨¨  
>
¨¨! "
$num
¨¨# $
)
¨¨$ %
;
¨¨% &
}
ªª 	
public
°° 
static
°° 
IDataReader
°° !
GetOne
°°" (
(
°°( )
Guid
°°) -
rowID
°°. 3
)
°°3 4
{
±± 	 
SqlParameterHelper
²² 
sph
²² "
=
²²# $
new
²²% ( 
SqlParameterHelper
²²) ;
(
²²; <
ConnectionString
²²< L
.
²²L M%
GetReadConnectionString
²²M d
(
²²d e
)
²²e f
,
²²f g
$str²²h 
,²² 
$num²² 
)²² 
;²² 
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# +
,
³³+ ,
	SqlDbType
³³- 6
.
³³6 7
UniqueIdentifier
³³7 G
,
³³G H 
ParameterDirection
³³I [
.
³³[ \
Input
³³\ a
,
³³a b
rowID
³³c h
)
³³h i
;
³³i j
return
´´ 
sph
´´ 
.
´´ 
ExecuteReader
´´ $
(
´´$ %
)
´´% &
;
´´& '
}
µµ 	
public
¼¼ 
static
¼¼ 
IDataReader
¼¼ !
GetOne
¼¼" (
(
¼¼( )
Guid
¼¼) -
userGuid
¼¼. 6
,
¼¼6 7
long
¼¼8 <
iPAddressLong
¼¼= J
)
¼¼J K
{
½½ 	 
SqlParameterHelper
¾¾ 
sph
¾¾ "
=
¾¾# $
new
¾¾% ( 
SqlParameterHelper
¾¾) ;
(
¾¾; <
ConnectionString
¾¾< L
.
¾¾L M%
GetReadConnectionString
¾¾M d
(
¾¾d e
)
¾¾e f
,
¾¾f g
$str¾¾h 
,¾¾ 
$num¾¾ 
)¾¾ 
;¾¾ 
sph
¿¿ 
.
¿¿  
DefineSqlParameter
¿¿ "
(
¿¿" #
$str
¿¿# .
,
¿¿. /
	SqlDbType
¿¿0 9
.
¿¿9 :
UniqueIdentifier
¿¿: J
,
¿¿J K 
ParameterDirection
¿¿L ^
.
¿¿^ _
Input
¿¿_ d
,
¿¿d e
userGuid
¿¿f n
)
¿¿n o
;
¿¿o p
sph
ÀÀ 
.
ÀÀ  
DefineSqlParameter
ÀÀ "
(
ÀÀ" #
$str
ÀÀ# 3
,
ÀÀ3 4
	SqlDbType
ÀÀ5 >
.
ÀÀ> ?
BigInt
ÀÀ? E
,
ÀÀE F 
ParameterDirection
ÀÀG Y
.
ÀÀY Z
Input
ÀÀZ _
,
ÀÀ_ `
iPAddressLong
ÀÀa n
)
ÀÀn o
;
ÀÀo p
return
ÁÁ 
sph
ÁÁ 
.
ÁÁ 
ExecuteReader
ÁÁ $
(
ÁÁ$ %
)
ÁÁ% &
;
ÁÁ& '
}
ÂÂ 	
public
ÈÈ 
static
ÈÈ 
IDataReader
ÈÈ !
	GetByUser
ÈÈ" +
(
ÈÈ+ ,
Guid
ÈÈ, 0
userGuid
ÈÈ1 9
)
ÈÈ9 :
{
ÉÉ 	 
SqlParameterHelper
ÊÊ 
sph
ÊÊ "
=
ÊÊ# $
new
ÊÊ% ( 
SqlParameterHelper
ÊÊ) ;
(
ÊÊ; <
ConnectionString
ÊÊ< L
.
ÊÊL M%
GetReadConnectionString
ÊÊM d
(
ÊÊd e
)
ÊÊe f
,
ÊÊf g
$strÊÊh 
,ÊÊ 
$numÊÊ 
)ÊÊ 
;ÊÊ 
sph
ËË 
.
ËË  
DefineSqlParameter
ËË "
(
ËË" #
$str
ËË# .
,
ËË. /
	SqlDbType
ËË0 9
.
ËË9 :
UniqueIdentifier
ËË: J
,
ËËJ K 
ParameterDirection
ËËL ^
.
ËË^ _
Input
ËË_ d
,
ËËd e
userGuid
ËËf n
)
ËËn o
;
ËËo p
return
ÌÌ 
sph
ÌÌ 
.
ÌÌ 
ExecuteReader
ÌÌ $
(
ÌÌ$ %
)
ÌÌ% &
;
ÌÌ& '
}
ÍÍ 	
public
ÕÕ 
static
ÕÕ 
IDataReader
ÕÕ !
	GetBySite
ÕÕ" +
(
ÕÕ+ ,
Guid
ÕÕ, 0
siteGuid
ÕÕ1 9
)
ÕÕ9 :
{
ÖÖ 	 
SqlParameterHelper
×× 
sph
×× "
=
××# $
new
××% ( 
SqlParameterHelper
××) ;
(
××; <
ConnectionString
××< L
.
××L M%
GetReadConnectionString
××M d
(
××d e
)
××e f
,
××f g
$str××h 
,×× 
$num×× 
)×× 
;×× 
sph
ØØ 
.
ØØ  
DefineSqlParameter
ØØ "
(
ØØ" #
$str
ØØ# .
,
ØØ. /
	SqlDbType
ØØ0 9
.
ØØ9 :
UniqueIdentifier
ØØ: J
,
ØØJ K 
ParameterDirection
ØØL ^
.
ØØ^ _
Input
ØØ_ d
,
ØØd e
siteGuid
ØØf n
)
ØØn o
;
ØØo p
return
ÙÙ 
sph
ÙÙ 
.
ÙÙ 
ExecuteReader
ÙÙ $
(
ÙÙ$ %
)
ÙÙ% &
;
ÙÙ& '
}
ÚÚ 	
public
àà 
static
àà 
IDataReader
àà !!
GetUsersByIPAddress
àà" 5
(
àà5 6
Guid
àà6 :
siteGuid
àà; C
,
ààC D
string
ààE K
ipv4Address
ààL W
)
ààW X
{
áá 	 
SqlParameterHelper
ââ 
sph
ââ "
=
ââ# $
new
ââ% ( 
SqlParameterHelper
ââ) ;
(
ââ; <
ConnectionString
ââ< L
.
ââL M%
GetReadConnectionString
ââM d
(
ââd e
)
ââe f
,
ââf g
$strââh 
,ââ 
$numââ 
)ââ 
;ââ 
sph
ãã 
.
ãã  
DefineSqlParameter
ãã "
(
ãã" #
$str
ãã# .
,
ãã. /
	SqlDbType
ãã0 9
.
ãã9 :
UniqueIdentifier
ãã: J
,
ããJ K 
ParameterDirection
ããL ^
.
ãã^ _
Input
ãã_ d
,
ããd e
siteGuid
ããf n
)
ããn o
;
ãão p
sph
ää 
.
ää  
DefineSqlParameter
ää "
(
ää" #
$str
ää# /
,
ää/ 0
	SqlDbType
ää1 :
.
ää: ;
NVarChar
ää; C
,
ääC D
$num
ääE G
,
ääG H 
ParameterDirection
ääI [
.
ää[ \
Input
ää\ a
,
ääa b
ipv4Address
ääc n
)
ään o
;
ääo p
return
åå 
sph
åå 
.
åå 
ExecuteReader
åå $
(
åå$ %
)
åå% &
;
åå& '
}
ææ 	
public
ìì 
static
ìì 
int
ìì 
GetCountByUser
ìì (
(
ìì( )
Guid
ìì) -
userGuid
ìì. 6
)
ìì6 7
{
íí 	 
SqlParameterHelper
îî 
sph
îî "
=
îî# $
new
îî% ( 
SqlParameterHelper
îî) ;
(
îî; <
ConnectionString
îî< L
.
îîL M%
GetReadConnectionString
îîM d
(
îîd e
)
îîe f
,
îîf g
$strîîh 
,îî 
$numîî 
)îî 
;îî 
sph
ïï 
.
ïï  
DefineSqlParameter
ïï "
(
ïï" #
$str
ïï# .
,
ïï. /
	SqlDbType
ïï0 9
.
ïï9 :
UniqueIdentifier
ïï: J
,
ïïJ K 
ParameterDirection
ïïL ^
.
ïï^ _
Input
ïï_ d
,
ïïd e
userGuid
ïïf n
)
ïïn o
;
ïïo p
return
ðð 
Convert
ðð 
.
ðð 
ToInt32
ðð "
(
ðð" #
sph
ðð# &
.
ðð& '
ExecuteScalar
ðð' 4
(
ðð4 5
)
ðð5 6
)
ðð6 7
;
ðð7 8
}
óó 	
public
 
static
 
int
 
GetCountBySite
 (
(
( )
Guid
) -
siteGuid
. 6
)
6 7
{
 	 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g
$strh 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
UniqueIdentifier
: J
,
J K 
ParameterDirection
L ^
.
^ _
Input
_ d
,
d e
siteGuid
f n
)
n o
;
o p
return
 
Convert
 
.
 
ToInt32
 "
(
" #
sph
# &
.
& '
ExecuteScalar
' 4
(
4 5
)
5 6
)
6 7
;
7 8
}
 	
public
 
static
 
IDataReader
 !
GetPageByUser
" /
(
/ 0
Guid
 
userGuid
 
,
 
int
 

pageNumber
 
,
 
int
 
pageSize
 
,
 
out
 
int
 

totalPages
 
)
 
{
 	

totalPages
 
=
 
$num
 
;
 
int
 
	totalRows
 
=
 
GetCountByUser
  
(
  !
userGuid
! )
)
) *
;
* +
if
¡¡ 
(
¡¡ 
pageSize
¡¡ 
>
¡¡ 
$num
¡¡ 
)
¡¡ 

totalPages
¡¡ (
=
¡¡) *
	totalRows
¡¡+ 4
/
¡¡5 6
pageSize
¡¡7 ?
;
¡¡? @
if
££ 
(
££ 
	totalRows
££ 
<=
££ 
pageSize
££ %
)
££% &
{
¤¤ 

totalPages
¥¥ 
=
¥¥ 
$num
¥¥ 
;
¥¥ 
}
¦¦ 
else
§§ 
{
¨¨ 
int
©© 
	remainder
©© 
;
©© 
Math
ªª 
.
ªª 
DivRem
ªª 
(
ªª 
	totalRows
ªª %
,
ªª% &
pageSize
ªª' /
,
ªª/ 0
out
ªª1 4
	remainder
ªª5 >
)
ªª> ?
;
ªª? @
if
«« 
(
«« 
	remainder
«« 
>
«« 
$num
««  !
)
««! "
{
¬¬ 

totalPages
­­ 
+=
­­ !
$num
­­" #
;
­­# $
}
®® 
}
¯¯  
SqlParameterHelper
±± 
sph
±± "
=
±±# $
new
±±% ( 
SqlParameterHelper
±±) ;
(
±±; <
ConnectionString
±±< L
.
±±L M%
GetReadConnectionString
±±M d
(
±±d e
)
±±e f
,
±±f g
$str±±h 
,±± 
$num±± 
)±± 
;±± 
sph
²² 
.
²²  
DefineSqlParameter
²² "
(
²²" #
$str
²²# .
,
²². /
	SqlDbType
²²0 9
.
²²9 :
UniqueIdentifier
²²: J
,
²²J K 
ParameterDirection
²²L ^
.
²²^ _
Input
²²_ d
,
²²d e
userGuid
²²f n
)
²²n o
;
²²o p
sph
³³ 
.
³³  
DefineSqlParameter
³³ "
(
³³" #
$str
³³# 0
,
³³0 1
	SqlDbType
³³2 ;
.
³³; <
Int
³³< ?
,
³³? @ 
ParameterDirection
³³A S
.
³³S T
Input
³³T Y
,
³³Y Z

pageNumber
³³[ e
)
³³e f
;
³³f g
sph
´´ 
.
´´  
DefineSqlParameter
´´ "
(
´´" #
$str
´´# .
,
´´. /
	SqlDbType
´´0 9
.
´´9 :
Int
´´: =
,
´´= > 
ParameterDirection
´´? Q
.
´´Q R
Input
´´R W
,
´´W X
pageSize
´´Y a
)
´´a b
;
´´b c
return
µµ 
sph
µµ 
.
µµ 
ExecuteReader
µµ $
(
µµ$ %
)
µµ% &
;
µµ& '
}
·· 	
public
ÀÀ 
static
ÀÀ 
IDataReader
ÀÀ !
GetPageBySite
ÀÀ" /
(
ÀÀ/ 0
Guid
ÁÁ 
siteGuid
ÁÁ 
,
ÁÁ 
int
ÂÂ 

pageNumber
ÂÂ 
,
ÂÂ 
int
ÃÃ 
pageSize
ÃÃ 
,
ÃÃ 
out
ÄÄ 
int
ÄÄ 

totalPages
ÄÄ 
)
ÄÄ 
{
ÅÅ 	

totalPages
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
int
ÇÇ 
	totalRows
ÇÇ 
=
ÈÈ 
GetCountBySite
ÈÈ  
(
ÈÈ  !
siteGuid
ÈÈ! )
)
ÈÈ) *
;
ÈÈ* +
if
ÊÊ 
(
ÊÊ 
pageSize
ÊÊ 
>
ÊÊ 
$num
ÊÊ 
)
ÊÊ 

totalPages
ÊÊ (
=
ÊÊ) *
	totalRows
ÊÊ+ 4
/
ÊÊ5 6
pageSize
ÊÊ7 ?
;
ÊÊ? @
if
ÌÌ 
(
ÌÌ 
	totalRows
ÌÌ 
<=
ÌÌ 
pageSize
ÌÌ %
)
ÌÌ% &
{
ÍÍ 

totalPages
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
}
ÏÏ 
else
ÐÐ 
{
ÑÑ 
int
ÒÒ 
	remainder
ÒÒ 
;
ÒÒ 
Math
ÓÓ 
.
ÓÓ 
DivRem
ÓÓ 
(
ÓÓ 
	totalRows
ÓÓ %
,
ÓÓ% &
pageSize
ÓÓ' /
,
ÓÓ/ 0
out
ÓÓ1 4
	remainder
ÓÓ5 >
)
ÓÓ> ?
;
ÓÓ? @
if
ÔÔ 
(
ÔÔ 
	remainder
ÔÔ 
>
ÔÔ 
$num
ÔÔ  !
)
ÔÔ! "
{
ÕÕ 

totalPages
ÖÖ 
+=
ÖÖ !
$num
ÖÖ" #
;
ÖÖ# $
}
×× 
}
ØØ  
SqlParameterHelper
ÚÚ 
sph
ÚÚ "
=
ÚÚ# $
new
ÚÚ% ( 
SqlParameterHelper
ÚÚ) ;
(
ÚÚ; <
ConnectionString
ÚÚ< L
.
ÚÚL M%
GetReadConnectionString
ÚÚM d
(
ÚÚd e
)
ÚÚe f
,
ÚÚf g
$strÚÚh 
,ÚÚ 
$numÚÚ 
)ÚÚ 
;ÚÚ 
sph
ÛÛ 
.
ÛÛ  
DefineSqlParameter
ÛÛ "
(
ÛÛ" #
$str
ÛÛ# .
,
ÛÛ. /
	SqlDbType
ÛÛ0 9
.
ÛÛ9 :
UniqueIdentifier
ÛÛ: J
,
ÛÛJ K 
ParameterDirection
ÛÛL ^
.
ÛÛ^ _
Input
ÛÛ_ d
,
ÛÛd e
siteGuid
ÛÛf n
)
ÛÛn o
;
ÛÛo p
sph
ÜÜ 
.
ÜÜ  
DefineSqlParameter
ÜÜ "
(
ÜÜ" #
$str
ÜÜ# 0
,
ÜÜ0 1
	SqlDbType
ÜÜ2 ;
.
ÜÜ; <
Int
ÜÜ< ?
,
ÜÜ? @ 
ParameterDirection
ÜÜA S
.
ÜÜS T
Input
ÜÜT Y
,
ÜÜY Z

pageNumber
ÜÜ[ e
)
ÜÜe f
;
ÜÜf g
sph
ÝÝ 
.
ÝÝ  
DefineSqlParameter
ÝÝ "
(
ÝÝ" #
$str
ÝÝ# .
,
ÝÝ. /
	SqlDbType
ÝÝ0 9
.
ÝÝ9 :
Int
ÝÝ: =
,
ÝÝ= > 
ParameterDirection
ÝÝ? Q
.
ÝÝQ R
Input
ÝÝR W
,
ÝÝW X
pageSize
ÝÝY a
)
ÝÝa b
;
ÝÝb c
return
ÞÞ 
sph
ÞÞ 
.
ÞÞ 
ExecuteReader
ÞÞ $
(
ÞÞ$ %
)
ÞÞ% &
;
ÞÞ& '
}
àà 	
}
ãã 
}åå ¥b
jD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbUserPage.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 

DBUserPage "
{ 
public 
static 
int 
AddUserPage %
(% &
Guid 

userPageId 
, 
Guid 
siteGuid 
, 
int 
siteId 
, 
Guid 
userGuid 
, 
string   
pageName   
,   
String!! 
pagePath!! 
,!! 
int"" 
	pageOrder"" 
)"" 
{## 	
SqlParameterHelper$$ 
sph$$ "
=$$# $
new$$% (
SqlParameterHelper$$) ;
($$; <
ConnectionString$$< L
.$$L M$
GetWriteConnectionString$$M e
($$e f
)$$f g
,$$g h
$str$$i ~
,$$~ 
$num
$$ 
)
$$ 
;
$$ 
sph%% 
.%% 
DefineSqlParameter%% "
(%%" #
$str%%# 0
,%%0 1
	SqlDbType%%2 ;
.%%; <
UniqueIdentifier%%< L
,%%L M
ParameterDirection%%N `
.%%` a
Input%%a f
,%%f g

userPageId%%h r
)%%r s
;%%s t
sph&& 
.&& 
DefineSqlParameter&& "
(&&" #
$str&&# .
,&&. /
	SqlDbType&&0 9
.&&9 :
UniqueIdentifier&&: J
,&&J K
ParameterDirection&&L ^
.&&^ _
Input&&_ d
,&&d e
siteGuid&&f n
)&&n o
;&&o p
sph'' 
.'' 
DefineSqlParameter'' "
(''" #
$str''# ,
,'', -
	SqlDbType''. 7
.''7 8
Int''8 ;
,''; <
ParameterDirection''= O
.''O P
Input''P U
,''U V
siteId''W ]
)''] ^
;''^ _
sph(( 
.(( 
DefineSqlParameter(( "
(((" #
$str((# .
,((. /
	SqlDbType((0 9
.((9 :
UniqueIdentifier((: J
,((J K
ParameterDirection((L ^
.((^ _
Input((_ d
,((d e
userGuid((f n
)((n o
;((o p
sph)) 
.)) 
DefineSqlParameter)) "
())" #
$str))# .
,)). /
	SqlDbType))0 9
.))9 :
NVarChar)): B
,))B C
ParameterDirection))D V
.))V W
Input))W \
,))\ ]
pageName))^ f
)))f g
;))g h
sph** 
.** 
DefineSqlParameter** "
(**" #
$str**# .
,**. /
	SqlDbType**0 9
.**9 :
NVarChar**: B
,**B C
ParameterDirection**D V
.**V W
Input**W \
,**\ ]
pagePath**^ f
)**f g
;**g h
sph++ 
.++ 
DefineSqlParameter++ "
(++" #
$str++# /
,++/ 0
	SqlDbType++1 :
.++: ;
Int++; >
,++> ?
ParameterDirection++@ R
.++R S
Input++S X
,++X Y
	pageOrder++Z c
)++c d
;++d e
int,, 
rowsAffected,, 
=,, 
sph,, "
.,," #
ExecuteNonQuery,,# 2
(,,2 3
),,3 4
;,,4 5
return-- 
rowsAffected-- 
;--  
}.. 	
public00 
static00 
bool00 
UpdateUserPage00 )
(00) *
Guid11 

userPageId11 
,11 
string22 
pageName22 
,22 
int33 
	pageOrder33 
)33 
{44 	
SqlParameterHelper55 
sph55 "
=55# $
new55% (
SqlParameterHelper55) ;
(55; <
ConnectionString55< L
.55L M$
GetWriteConnectionString55M e
(55e f
)55f g
,55g h
$str55i ~
,55~ 
$num
55 
)
55 
;
55 
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# 0
,660 1
	SqlDbType662 ;
.66; <
UniqueIdentifier66< L
,66L M
ParameterDirection66N `
.66` a
Input66a f
,66f g

userPageId66h r
)66r s
;66s t
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# .
,77. /
	SqlDbType770 9
.779 :
NVarChar77: B
,77B C
ParameterDirection77D V
.77V W
Input77W \
,77\ ]
pageName77^ f
)77f g
;77g h
sph88 
.88 
DefineSqlParameter88 "
(88" #
$str88# /
,88/ 0
	SqlDbType881 :
.88: ;
Int88; >
,88> ?
ParameterDirection88@ R
.88R S
Input88S X
,88X Y
	pageOrder88Z c
)88c d
;88d e
int99 
rowsAffected99 
=99 
sph99 "
.99" #
ExecuteNonQuery99# 2
(992 3
)993 4
;994 5
return:: 
(:: 
rowsAffected::  
>::! "
-::# $
$num::$ %
)::% &
;::& '
};; 	
public>> 
static>> 
bool>> 
DeleteUserPage>> )
(>>) *
Guid>>* .

userPageId>>/ 9
)>>9 :
{?? 	
SqlParameterHelper@@ 
sph@@ "
=@@# $
new@@% (
SqlParameterHelper@@) ;
(@@; <
ConnectionString@@< L
.@@L M$
GetWriteConnectionString@@M e
(@@e f
)@@f g
,@@g h
$str@@i ~
,@@~ 
$num
@@ 
)
@@ 
;
@@ 
sphAA 
.AA 
DefineSqlParameterAA "
(AA" #
$strAA# 0
,AA0 1
	SqlDbTypeAA2 ;
.AA; <
UniqueIdentifierAA< L
,AAL M
ParameterDirectionAAN `
.AA` a
InputAAa f
,AAf g

userPageIdAAh r
)AAr s
;AAs t
intBB 
rowsAffectedBB 
=BB 
sphBB "
.BB" #
ExecuteNonQueryBB# 2
(BB2 3
)BB3 4
;BB4 5
returnCC 
(CC 
rowsAffectedCC  
>CC! "
-CC# $
$numCC$ %
)CC% &
;CC& '
}DD 	
publicFF 
staticFF 
boolFF 
DeleteByUserFF '
(FF' (
GuidFF( ,
userGuidFF- 5
)FF5 6
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$str	HHi 
,
HH 
$num
HH 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# .
,II. /
	SqlDbTypeII0 9
.II9 :
UniqueIdentifierII: J
,IIJ K
ParameterDirectionIIL ^
.II^ _
InputII_ d
,IId e
userGuidIIf n
)IIn o
;IIo p
intJJ 
rowsAffectedJJ 
=JJ 
sphJJ "
.JJ" #
ExecuteNonQueryJJ# 2
(JJ2 3
)JJ3 4
;JJ4 5
returnKK 
(KK 
rowsAffectedKK  
>KK! "
-KK# $
$numKK$ %
)KK% &
;KK& '
}LL 	
publicNN 
staticNN 
IDataReaderNN !
GetUserPageNN" -
(NN- .
GuidNN. 2

userPageIdNN3 =
)NN= >
{OO 	
SqlParameterHelperPP 
sphPP "
=PP# $
newPP% (
SqlParameterHelperPP) ;
(PP; <
ConnectionStringPP< L
.PPL M#
GetReadConnectionStringPPM d
(PPd e
)PPe f
,PPf g
$str	PPh 
,
PP 
$num
PP 
)
PP 
;
PP 
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# 0
,QQ0 1
	SqlDbTypeQQ2 ;
.QQ; <
UniqueIdentifierQQ< L
,QQL M
ParameterDirectionQQN `
.QQ` a
InputQQa f
,QQf g

userPageIdQQh r
)QQr s
;QQs t
returnRR 
sphRR 
.RR 
ExecuteReaderRR $
(RR$ %
)RR% &
;RR& '
}SS 	
publicUU 
staticUU 
IDataReaderUU !
SelectByUserUU" .
(UU. /
GuidUU/ 3
userGuidUU4 <
)UU< =
{VV 	
SqlParameterHelperWW 
sphWW "
=WW# $
newWW% (
SqlParameterHelperWW) ;
(WW; <
ConnectionStringWW< L
.WWL M#
GetReadConnectionStringWWM d
(WWd e
)WWe f
,WWf g
$str	WWh 
,
WW 
$num
WW 
)
WW 
;
WW 
sphXX 
.XX 
DefineSqlParameterXX "
(XX" #
$strXX# .
,XX. /
	SqlDbTypeXX0 9
.XX9 :
UniqueIdentifierXX: J
,XXJ K
ParameterDirectionXXL ^
.XX^ _
InputXX_ d
,XXd e
userGuidXXf n
)XXn o
;XXo p
returnYY 
sphYY 
.YY 
ExecuteReaderYY $
(YY$ %
)YY% &
;YY& '
}ZZ 	
public\\ 
static\\ 
int\\ 
GetNextPageOrder\\ *
(\\* +
Guid\\+ /
userGuid\\0 8
)\\8 9
{]] 	
SqlParameterHelper^^ 
sph^^ "
=^^# $
new^^% (
SqlParameterHelper^^) ;
(^^; <
ConnectionString^^< L
.^^L M#
GetReadConnectionString^^M d
(^^d e
)^^e f
,^^f g
$str	^^h 
,
^^ 
$num
^^ 
)
^^ 
;
^^ 
sph__ 
.__ 
DefineSqlParameter__ "
(__" #
$str__# .
,__. /
	SqlDbType__0 9
.__9 :
UniqueIdentifier__: J
,__J K
ParameterDirection__L ^
.__^ _
Input___ d
,__d e
userGuid__f n
)__n o
;__o p
int`` 
	pageOrder`` 
=`` 
Convert`` #
.``# $
ToInt32``$ +
(``+ ,
sph``, /
.``/ 0
ExecuteScalar``0 =
(``= >
)``> ?
)``? @
;``@ A
returnaa 
	pageOrderaa 
;aa 
}bb 	
publicdd 
staticdd 
booldd 
UpdatePageOrderdd *
(dd* +
Guiddd+ /

userPageIddd0 :
,dd: ;
intdd< ?
	pageOrderdd@ I
)ddI J
{ee 	
SqlParameterHelperff 
sphff "
=ff# $
newff% (
SqlParameterHelperff) ;
(ff; <
ConnectionStringff< L
.ffL M#
GetReadConnectionStringffM d
(ffd e
)ffe f
,fff g
$str	ffh 
,
ff 
$num
ff 
)
ff 
;
ff 
sphgg 
.gg 
DefineSqlParametergg "
(gg" #
$strgg# 0
,gg0 1
	SqlDbTypegg2 ;
.gg; <
UniqueIdentifiergg< L
,ggL M
ParameterDirectionggN `
.gg` a
Inputgga f
,ggf g

userPageIdggh r
)ggr s
;ggs t
sphhh 
.hh 
DefineSqlParameterhh "
(hh" #
$strhh# /
,hh/ 0
	SqlDbTypehh1 :
.hh: ;
Inthh; >
,hh> ?
ParameterDirectionhh@ R
.hhR S
InputhhS X
,hhX Y
	pageOrderhhZ c
)hhc d
;hhd e
intii 
rowsAffectedii 
=ii 
sphii "
.ii" #
ExecuteNonQueryii# 2
(ii2 3
)ii3 4
;ii4 5
returnjj 
(jj 
rowsAffectedjj  
>jj! "
-jj# $
$numjj$ %
)jj% &
;jj& '
}kk 	
}qq 
}rr ñ°
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\dbWebPartContent.cs
	namespace		 	

mojoPortal		
 
.		 
Data		 
{

 
public 

static 
class 
DBWebPartContent (
{ 
public 
static 
int 

AddWebPart $
($ %
Guid   
	webPartId   
,   
Guid!! 
siteGuid!! 
,!! 
int"" 
siteId"" 
,"" 
string## 
title## 
,## 
string$$ 
description$$ 
,$$ 
string%% 
imageUrl%% 
,%% 
string&& 
	className&& 
,&& 
string'' 
assemblyName'' 
,''  
bool(( 
availableForMyPage(( #
,((# $
bool)) *
allowMultipleInstancesOnMyPage)) /
,))/ 0
bool** %
availableForContentSystem** *
)*** +
{++ 	
SqlParameterHelper,, 
sph,, "
=,,# $
new,,% (
SqlParameterHelper,,) ;
(,,; <
ConnectionString,,< L
.,,L M$
GetWriteConnectionString,,M e
(,,e f
),,f g
,,,g h
$str,,i }
,,,} ~
$num	,, 
)
,, 
;
,, 
sph-- 
.-- 
DefineSqlParameter-- "
(--" #
$str--# /
,--/ 0
	SqlDbType--1 :
.--: ;
UniqueIdentifier--; K
,--K L
ParameterDirection--M _
.--_ `
Input--` e
,--e f
	webPartId--g p
)--p q
;--q r
sph.. 
... 
DefineSqlParameter.. "
(.." #
$str..# .
,... /
	SqlDbType..0 9
...9 :
UniqueIdentifier..: J
,..J K
ParameterDirection..L ^
...^ _
Input.._ d
,..d e
siteGuid..f n
)..n o
;..o p
sph// 
.// 
DefineSqlParameter// "
(//" #
$str//# ,
,//, -
	SqlDbType//. 7
.//7 8
Int//8 ;
,//; <
ParameterDirection//= O
.//O P
Input//P U
,//U V
siteId//W ]
)//] ^
;//^ _
sph00 
.00 
DefineSqlParameter00 "
(00" #
$str00# +
,00+ ,
	SqlDbType00- 6
.006 7
NVarChar007 ?
,00? @
ParameterDirection00A S
.00S T
Input00T Y
,00Y Z
title00[ `
)00` a
;00a b
sph11 
.11 
DefineSqlParameter11 "
(11" #
$str11# 1
,111 2
	SqlDbType113 <
.11< =
NVarChar11= E
,11E F
ParameterDirection11G Y
.11Y Z
Input11Z _
,11_ `
description11a l
)11l m
;11m n
sph22 
.22 
DefineSqlParameter22 "
(22" #
$str22# .
,22. /
	SqlDbType220 9
.229 :
NVarChar22: B
,22B C
ParameterDirection22D V
.22V W
Input22W \
,22\ ]
imageUrl22^ f
)22f g
;22g h
sph33 
.33 
DefineSqlParameter33 "
(33" #
$str33# /
,33/ 0
	SqlDbType331 :
.33: ;
NVarChar33; C
,33C D
ParameterDirection33E W
.33W X
Input33X ]
,33] ^
	className33_ h
)33h i
;33i j
sph44 
.44 
DefineSqlParameter44 "
(44" #
$str44# 2
,442 3
	SqlDbType444 =
.44= >
NVarChar44> F
,44F G
ParameterDirection44H Z
.44Z [
Input44[ `
,44` a
assemblyName44b n
)44n o
;44o p
sph55 
.55 
DefineSqlParameter55 "
(55" #
$str55# 8
,558 9
	SqlDbType55: C
.55C D
Bit55D G
,55G H
ParameterDirection55I [
.55[ \
Input55\ a
,55a b
availableForMyPage55c u
)55u v
;55v w
sph66 
.66 
DefineSqlParameter66 "
(66" #
$str66# D
,66D E
	SqlDbType66F O
.66O P
Bit66P S
,66S T
ParameterDirection66U g
.66g h
Input66h m
,66m n+
allowMultipleInstancesOnMyPage	66o 
)
66 
;
66 
sph77 
.77 
DefineSqlParameter77 "
(77" #
$str77# ?
,77? @
	SqlDbType77A J
.77J K
Bit77K N
,77N O
ParameterDirection77P b
.77b c
Input77c h
,77h i&
availableForContentSystem	77j 
)
77 
;
77 
int88 
rowsAffected88 
=88 
sph88 "
.88" #
ExecuteNonQuery88# 2
(882 3
)883 4
;884 5
return99 
rowsAffected99 
;99  
}:: 	
public<< 
static<< 
bool<< 
UpdateWebPart<< (
(<<( )
Guid== 
	webPartId== 
,== 
int>> 
siteId>> 
,>> 
string?? 
title?? 
,?? 
string@@ 
description@@ 
,@@ 
stringAA 
imageUrlAA 
,AA 
stringBB 
	classNameBB 
,BB 
stringCC 
assemblyNameCC 
,CC  
boolDD 
availableForMyPageDD #
,DD# $
boolEE *
allowMultipleInstancesOnMyPageEE /
,EE/ 0
boolFF %
availableForContentSystemFF *
)FF* +
{GG 	
SqlParameterHelperHH 
sphHH "
=HH# $
newHH% (
SqlParameterHelperHH) ;
(HH; <
ConnectionStringHH< L
.HHL M$
GetWriteConnectionStringHHM e
(HHe f
)HHf g
,HHg h
$strHHi }
,HH} ~
$num	HH 
)
HH 
;
HH 
sphII 
.II 
DefineSqlParameterII "
(II" #
$strII# /
,II/ 0
	SqlDbTypeII1 :
.II: ;
UniqueIdentifierII; K
,IIK L
ParameterDirectionIIM _
.II_ `
InputII` e
,IIe f
	webPartIdIIg p
)IIp q
;IIq r
sphJJ 
.JJ 
DefineSqlParameterJJ "
(JJ" #
$strJJ# ,
,JJ, -
	SqlDbTypeJJ. 7
.JJ7 8
IntJJ8 ;
,JJ; <
ParameterDirectionJJ= O
.JJO P
InputJJP U
,JJU V
siteIdJJW ]
)JJ] ^
;JJ^ _
sphKK 
.KK 
DefineSqlParameterKK "
(KK" #
$strKK# +
,KK+ ,
	SqlDbTypeKK- 6
.KK6 7
NVarCharKK7 ?
,KK? @
ParameterDirectionKKA S
.KKS T
InputKKT Y
,KKY Z
titleKK[ `
)KK` a
;KKa b
sphLL 
.LL 
DefineSqlParameterLL "
(LL" #
$strLL# 1
,LL1 2
	SqlDbTypeLL3 <
.LL< =
NVarCharLL= E
,LLE F
ParameterDirectionLLG Y
.LLY Z
InputLLZ _
,LL_ `
descriptionLLa l
)LLl m
;LLm n
sphMM 
.MM 
DefineSqlParameterMM "
(MM" #
$strMM# .
,MM. /
	SqlDbTypeMM0 9
.MM9 :
NVarCharMM: B
,MMB C
ParameterDirectionMMD V
.MMV W
InputMMW \
,MM\ ]
imageUrlMM^ f
)MMf g
;MMg h
sphNN 
.NN 
DefineSqlParameterNN "
(NN" #
$strNN# /
,NN/ 0
	SqlDbTypeNN1 :
.NN: ;
NVarCharNN; C
,NNC D
ParameterDirectionNNE W
.NNW X
InputNNX ]
,NN] ^
	classNameNN_ h
)NNh i
;NNi j
sphOO 
.OO 
DefineSqlParameterOO "
(OO" #
$strOO# 2
,OO2 3
	SqlDbTypeOO4 =
.OO= >
NVarCharOO> F
,OOF G
ParameterDirectionOOH Z
.OOZ [
InputOO[ `
,OO` a
assemblyNameOOb n
)OOn o
;OOo p
sphPP 
.PP 
DefineSqlParameterPP "
(PP" #
$strPP# 8
,PP8 9
	SqlDbTypePP: C
.PPC D
BitPPD G
,PPG H
ParameterDirectionPPI [
.PP[ \
InputPP\ a
,PPa b
availableForMyPagePPc u
)PPu v
;PPv w
sphQQ 
.QQ 
DefineSqlParameterQQ "
(QQ" #
$strQQ# D
,QQD E
	SqlDbTypeQQF O
.QQO P
BitQQP S
,QQS T
ParameterDirectionQQU g
.QQg h
InputQQh m
,QQm n+
allowMultipleInstancesOnMyPage	QQo 
)
QQ 
;
QQ 
sphRR 
.RR 
DefineSqlParameterRR "
(RR" #
$strRR# ?
,RR? @
	SqlDbTypeRRA J
.RRJ K
BitRRK N
,RRN O
ParameterDirectionRRP b
.RRb c
InputRRc h
,RRh i&
availableForContentSystem	RRj 
)
RR 
;
RR 
intSS 
rowsAffectedSS 
=SS 
sphSS "
.SS" #
ExecuteNonQuerySS# 2
(SS2 3
)SS3 4
;SS4 5
returnTT 
(TT 
rowsAffectedTT  
>TT! "
-TT# $
$numTT$ %
)TT% &
;TT& '
}UU 	
publicWW 
staticWW 
boolWW $
UpdateCountOfUseOnMyPageWW 3
(WW3 4
GuidWW4 8
	webPartIdWW9 B
,WWB C
intWWD G
	incrementWWH Q
)WWQ R
{XX 	
SqlParameterHelperYY 
sphYY "
=YY# $
newYY% (
SqlParameterHelperYY) ;
(YY; <
ConnectionStringYY< L
.YYL M$
GetWriteConnectionStringYYM e
(YYe f
)YYf g
,YYg h
$str	YYi 
,
YY 
$num
YY 
)
YY 
;
YY 
sphZZ 
.ZZ 
DefineSqlParameterZZ "
(ZZ" #
$strZZ# /
,ZZ/ 0
	SqlDbTypeZZ1 :
.ZZ: ;
UniqueIdentifierZZ; K
,ZZK L
ParameterDirectionZZM _
.ZZ_ `
InputZZ` e
,ZZe f
	webPartIdZZg p
)ZZp q
;ZZq r
sph[[ 
.[[ 
DefineSqlParameter[[ "
([[" #
$str[[# /
,[[/ 0
	SqlDbType[[1 :
.[[: ;
Int[[; >
,[[> ?
ParameterDirection[[@ R
.[[R S
Input[[S X
,[[X Y
	increment[[Z c
)[[c d
;[[d e
int\\ 
rowsAffected\\ 
=\\ 
sph\\ "
.\\" #
ExecuteNonQuery\\# 2
(\\2 3
)\\3 4
;\\4 5
return]] 
(]] 
rowsAffected]]  
>]]! "
-]]# $
$num]]$ %
)]]% &
;]]& '
}^^ 	
public`` 
static`` 
bool`` 
DeleteWebPart`` (
(``( )
Guid``) -
	webPartId``. 7
)``7 8
{aa 	
SqlParameterHelperbb 
sphbb "
=bb# $
newbb% (
SqlParameterHelperbb) ;
(bb; <
ConnectionStringbb< L
.bbL M$
GetWriteConnectionStringbbM e
(bbe f
)bbf g
,bbg h
$strbbi }
,bb} ~
$num	bb 
)
bb 
;
bb 
sphcc 
.cc 
DefineSqlParametercc "
(cc" #
$strcc# /
,cc/ 0
	SqlDbTypecc1 :
.cc: ;
Intcc; >
,cc> ?
ParameterDirectioncc@ R
.ccR S
InputccS X
,ccX Y
	webPartIdccZ c
)ccc d
;ccd e
intdd 
rowsAffecteddd 
=dd 
sphdd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
returnee 
(ee 
rowsAffectedee  
>ee! "
-ee# $
$numee$ %
)ee% &
;ee& '
}ff 	
publichh 
statichh 
IDataReaderhh !

GetWebParthh" ,
(hh, -
Guidhh- 1
	webPartIdhh2 ;
)hh; <
{ii 	
SqlParameterHelperjj 
sphjj "
=jj# $
newjj% (
SqlParameterHelperjj) ;
(jj; <
ConnectionStringjj< L
.jjL M#
GetReadConnectionStringjjM d
(jjd e
)jje f
,jjf g
$strjjh 
,	jj 
$num
jj 
)
jj 
;
jj 
sphkk 
.kk 
DefineSqlParameterkk "
(kk" #
$strkk# /
,kk/ 0
	SqlDbTypekk1 :
.kk: ;
UniqueIdentifierkk; K
,kkK L
ParameterDirectionkkM _
.kk_ `
Inputkk` e
,kke f
	webPartIdkkg p
)kkp q
;kkq r
returnll 
sphll 
.ll 
ExecuteReaderll $
(ll$ %
)ll% &
;ll& '
}mm 	
publicoo 
staticoo 
IDataReaderoo !
SelectBySiteoo" .
(oo. /
intoo/ 2
siteIdoo3 9
)oo9 :
{pp 	
SqlParameterHelperqq 
sphqq "
=qq# $
newqq% (
SqlParameterHelperqq) ;
(qq; <
ConnectionStringqq< L
.qqL M#
GetReadConnectionStringqqM d
(qqd e
)qqe f
,qqf g
$str	qqh 
,
qq 
$num
qq 
)
qq 
;
qq 
sphrr 
.rr 
DefineSqlParameterrr "
(rr" #
$strrr# ,
,rr, -
	SqlDbTyperr. 7
.rr7 8
Intrr8 ;
,rr; <
ParameterDirectionrr= O
.rrO P
InputrrP U
,rrU V
siteIdrrW ]
)rr] ^
;rr^ _
returnss 
sphss 
.ss 
ExecuteReaderss $
(ss$ %
)ss% &
;ss& '
}tt 	
publicvv 
staticvv 
	DataTablevv 

SelectPagevv  *
(vv* +
intww 
siteIdww 
,ww 
intxx 

pageNumberxx 
,xx 
intyy 
pageSizeyy 
,yy 
boolzz 
sortByClassNamezz  
,zz  !
bool{{ 
sortByAssemblyName{{ #
){{# $
{|| 	
SqlParameterHelper}} 
sph}} "
=}}# $
new}}% (
SqlParameterHelper}}) ;
(}}; <
ConnectionString}}< L
.}}L M#
GetReadConnectionString}}M d
(}}d e
)}}e f
,}}f g
$str	}}h 
,
}} 
$num
}} 
)
}} 
;
}} 
sph~~ 
.~~ 
DefineSqlParameter~~ "
(~~" #
$str~~# ,
,~~, -
	SqlDbType~~. 7
.~~7 8
Int~~8 ;
,~~; <
ParameterDirection~~= O
.~~O P
Input~~P U
,~~U V
siteId~~W ]
)~~] ^
;~~^ _
sph 
. 
DefineSqlParameter "
(" #
$str# 0
,0 1
	SqlDbType2 ;
.; <
Int< ?
,? @
ParameterDirectionA S
.S T
InputT Y
,Y Z

pageNumber[ e
)e f
;f g
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# .
,
. /
	SqlDbType
0 9
.
9 :
Int
: =
,
= > 
ParameterDirection
? Q
.
Q R
Input
R W
,
W X
pageSize
Y a
)
a b
;
b c
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 5
,
5 6
	SqlDbType
7 @
.
@ A
Bit
A D
,
D E 
ParameterDirection
F X
.
X Y
Input
Y ^
,
^ _
sortByClassName
` o
)
o p
;
p q
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# 8
,
8 9
	SqlDbType
: C
.
C D
Bit
D G
,
G H 
ParameterDirection
I [
.
[ \
Input
\ a
,
a b 
sortByAssemblyName
c u
)
u v
;
v w
	DataTable
 
dt
 
=
 
new
 
	DataTable
 (
(
( )
)
) *
;
* +
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 &
,
& '
typeof
( .
(
. /
String
/ 5
)
5 6
)
6 7
;
7 8
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 "
,
" #
typeof
$ *
(
* +
String
+ 1
)
1 2
)
2 3
;
3 4
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 (
,
( )
typeof
* 0
(
0 1
String
1 7
)
7 8
)
8 9
;
9 :
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 %
,
% &
typeof
' -
(
- .
String
. 4
)
4 5
)
5 6
;
6 7
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 &
,
& '
typeof
( .
(
. /
String
/ 5
)
5 6
)
6 7
;
7 8
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 )
,
) *
typeof
+ 1
(
1 2
String
2 8
)
8 9
)
9 :
;
: ;
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 /
,
/ 0
typeof
1 7
(
7 8
bool
8 <
)
< =
)
= >
;
> ?
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 ;
,
; <
typeof
= C
(
C D
bool
D H
)
H I
)
I J
;
J K
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 6
,
6 7
typeof
8 >
(
> ?
bool
? C
)
C D
)
D E
;
E F
dt
 
.
 
Columns
 
.
 
Add
 
(
 
$str
 '
,
' (
typeof
) /
(
/ 0
int
0 3
)
3 4
)
4 5
;
5 6
using
 
(
 
IDataReader
 
reader
 %
=
& '
sph
( +
.
+ ,
ExecuteReader
, 9
(
9 :
)
: ;
)
; <
{
 
while
 
(
 
reader
 
.
 
Read
 "
(
" #
)
# $
)
$ %
{
 
DataRow
 
row
 
=
  !
dt
" $
.
$ %
NewRow
% +
(
+ ,
)
, -
;
- .
row
 
[
 
$str
 #
]
# $
=
% &
reader
' -
[
- .
$str
. 9
]
9 :
.
: ;
ToString
; C
(
C D
)
D E
;
E F
row
 
[
 
$str
 
]
  
=
! "
reader
# )
[
) *
$str
* 1
]
1 2
;
2 3
row
 
[
 
$str
 %
]
% &
=
' (
reader
) /
[
/ 0
$str
0 =
]
= >
;
> ?
row
 
[
 
$str
 "
]
" #
=
$ %
reader
& ,
[
, -
$str
- 7
]
7 8
;
8 9
row
 
[
 
$str
 #
]
# $
=
% &
reader
' -
[
- .
$str
. 9
]
9 :
;
: ;
row
 
[
 
$str
 &
]
& '
=
( )
reader
* 0
[
0 1
$str
1 ?
]
? @
;
@ A
row
 
[
 
$str
 ,
]
, -
=
. /
reader
0 6
[
6 7
$str
7 K
]
K L
;
L M
row
 
[
 
$str
 8
]
8 9
=
: ;
reader
< B
[
B C
$str
C c
]
c d
;
d e
row
 
[
 
$str
 3
]
3 4
=
5 6
reader
7 =
[
= >
$str
> Y
]
Y Z
;
Z [
row
 
[
 
$str
 $
]
$ %
=
& '
reader
( .
[
. /
$str
/ ;
]
; <
;
< =
dt
   
.
   
Rows
   
.
   
Add
   
(
    
row
    #
)
  # $
;
  $ %
}
¢¢ 
}
¤¤ 
return
¦¦ 
dt
¦¦ 
;
¦¦ 
}
¨¨ 	
public
ªª 
static
ªª 
bool
ªª 
Exists
ªª !
(
ªª! "
Int32
ªª" '
siteId
ªª( .
,
ªª. /
String
ªª0 6
	className
ªª7 @
,
ªª@ A
String
ªªB H
assemblyName
ªªI U
)
ªªU V
{
«« 	 
SqlParameterHelper
¬¬ 
sph
¬¬ "
=
¬¬# $
new
¬¬% ( 
SqlParameterHelper
¬¬) ;
(
¬¬; <
ConnectionString
¬¬< L
.
¬¬L M%
GetReadConnectionString
¬¬M d
(
¬¬d e
)
¬¬e f
,
¬¬f g
$str¬¬h 
,¬¬ 
$num¬¬ 
)¬¬ 
;¬¬ 
sph
­­ 
.
­­  
DefineSqlParameter
­­ "
(
­­" #
$str
­­# ,
,
­­, -
	SqlDbType
­­. 7
.
­­7 8
Int
­­8 ;
,
­­; < 
ParameterDirection
­­= O
.
­­O P
Input
­­P U
,
­­U V
siteId
­­W ]
)
­­] ^
;
­­^ _
sph
®® 
.
®®  
DefineSqlParameter
®® "
(
®®" #
$str
®®# /
,
®®/ 0
	SqlDbType
®®1 :
.
®®: ;
NVarChar
®®; C
,
®®C D
$num
®®E H
,
®®H I 
ParameterDirection
®®J \
.
®®\ ]
Input
®®] b
,
®®b c
	className
®®d m
)
®®m n
;
®®n o
sph
¯¯ 
.
¯¯  
DefineSqlParameter
¯¯ "
(
¯¯" #
$str
¯¯# 2
,
¯¯2 3
	SqlDbType
¯¯4 =
.
¯¯= >
NVarChar
¯¯> F
,
¯¯F G
$num
¯¯H K
,
¯¯K L 
ParameterDirection
¯¯M _
.
¯¯_ `
Input
¯¯` e
,
¯¯e f
assemblyName
¯¯g s
)
¯¯s t
;
¯¯t u
int
°° 
count
°° 
=
°° 
Convert
°° 
.
°°  
ToInt32
°°  '
(
°°' (
sph
°°( +
.
°°+ ,
ExecuteScalar
°°, 9
(
°°9 :
)
°°: ;
)
°°; <
;
°°< =
return
±± 
(
±± 
count
±± 
>
±± 
$num
±± 
)
±± 
;
±± 
}
²² 	
public
´´ 
static
´´ 
IDataReader
´´ !"
GetWebPartsForMyPage
´´" 6
(
´´6 7
int
´´7 :
siteId
´´; A
)
´´A B
{
µµ 	
StringBuilder
ºº 

sqlCommand
ºº $
=
ºº% &
new
ºº' *
StringBuilder
ºº+ 8
(
ºº8 9
)
ºº9 :
;
ºº: ;

sqlCommand
¼¼ 
.
¼¼ 
Append
¼¼ 
(
¼¼ 
$str
¼¼ 3
)
¼¼3 4
;
¼¼4 5

sqlCommand
½½ 
.
½½ 
Append
½½ 
(
½½ 
$str
½½ %
)
½½% &
;
½½& '

sqlCommand
¾¾ 
.
¾¾ 
Append
¾¾ 
(
¾¾ 
$str
¾¾ )
)
¾¾) *
;
¾¾* +

sqlCommand
¿¿ 
.
¿¿ 
Append
¿¿ 
(
¿¿ 
$str
¿¿ ,
)
¿¿, -
;
¿¿- .

sqlCommand
ÀÀ 
.
ÀÀ 
Append
ÀÀ 
(
ÀÀ 
$str
ÀÀ *
)
ÀÀ* +
;
ÀÀ+ ,

sqlCommand
ÁÁ 
.
ÁÁ 
Append
ÁÁ 
(
ÁÁ 
$str
ÁÁ /
)
ÁÁ/ 0
;
ÁÁ0 1

sqlCommand
ÂÂ 
.
ÂÂ 
Append
ÂÂ 
(
ÂÂ 
$str
ÂÂ /
)
ÂÂ/ 0
;
ÂÂ0 1

sqlCommand
ÃÃ 
.
ÃÃ 
Append
ÃÃ 
(
ÃÃ 
$str
ÃÃ B
)
ÃÃB C
;
ÃÃC D

sqlCommand
ÄÄ 
.
ÄÄ 
Append
ÄÄ 
(
ÄÄ 
$str
ÄÄ 7
)
ÄÄ7 8
;
ÄÄ8 9

sqlCommand
ÅÅ 
.
ÅÅ 
Append
ÅÅ 
(
ÅÅ 
$str
ÅÅ 6
)
ÅÅ6 7
;
ÅÅ7 8

sqlCommand
ÆÆ 
.
ÆÆ 
Append
ÆÆ 
(
ÆÆ 
$str
ÆÆ 8
)
ÆÆ8 9
;
ÆÆ9 :

sqlCommand
ÇÇ 
.
ÇÇ 
Append
ÇÇ 
(
ÇÇ 
$str
ÇÇ 0
)
ÇÇ0 1
;
ÇÇ1 2

sqlCommand
ÈÈ 
.
ÈÈ 
Append
ÈÈ 
(
ÈÈ 
$str
ÈÈ 1
)
ÈÈ1 2
;
ÈÈ2 3

sqlCommand
ÉÉ 
.
ÉÉ 
Append
ÉÉ 
(
ÉÉ 
$str
ÉÉ 1
)
ÉÉ1 2
;
ÉÉ2 3

sqlCommand
ÊÊ 
.
ÊÊ 
Append
ÊÊ 
(
ÊÊ 
$str
ÊÊ 0
)
ÊÊ0 1
;
ÊÊ1 2

sqlCommand
ÌÌ 
.
ÌÌ 
Append
ÌÌ 
(
ÌÌ 
$str
ÌÌ 3
)
ÌÌ3 4
;
ÌÌ4 5

sqlCommand
ÍÍ 
.
ÍÍ 
Append
ÍÍ 
(
ÍÍ 
$str
ÍÍ >
)
ÍÍ> ?
;
ÍÍ? @

sqlCommand
ÎÎ 
.
ÎÎ 
Append
ÎÎ 
(
ÎÎ 
$str
ÎÎ B
)
ÎÎB C
;
ÎÎC D

sqlCommand
ÐÐ 
.
ÐÐ 
Append
ÐÐ 
(
ÐÐ 
$str
ÐÐ V
)
ÐÐV W
;
ÐÐW X

sqlCommand
ÓÓ 
.
ÓÓ 
Append
ÓÓ 
(
ÓÓ 
$str
ÓÓ '
)
ÓÓ' (
;
ÓÓ( )

sqlCommand
ÕÕ 
.
ÕÕ 
Append
ÕÕ 
(
ÕÕ 
$str
ÕÕ )
)
ÕÕ) *
;
ÕÕ* +

sqlCommand
ÖÖ 
.
ÖÖ 
Append
ÖÖ 
(
ÖÖ 
$str
ÖÖ 0
)
ÖÖ0 1
;
ÖÖ1 2

sqlCommand
×× 
.
×× 
Append
×× 
(
×× 
$str
×× *
)
××* +
;
××+ ,

sqlCommand
ØØ 
.
ØØ 
Append
ØØ 
(
ØØ 
$str
ØØ 2
)
ØØ2 3
;
ØØ3 4

sqlCommand
ÙÙ 
.
ÙÙ 
Append
ÙÙ 
(
ÙÙ 
$str
ÙÙ 8
)
ÙÙ8 9
;
ÙÙ9 :

sqlCommand
ÚÚ 
.
ÚÚ 
Append
ÚÚ 
(
ÚÚ 
$str
ÚÚ B
)
ÚÚB C
;
ÚÚC D

sqlCommand
ÛÛ 
.
ÛÛ 
Append
ÛÛ 
(
ÛÛ 
$str
ÛÛ 7
)
ÛÛ7 8
;
ÛÛ8 9

sqlCommand
ÜÜ 
.
ÜÜ 
Append
ÜÜ 
(
ÜÜ 
$str
ÜÜ :
)
ÜÜ: ;
;
ÜÜ; <

sqlCommand
ÝÝ 
.
ÝÝ 
Append
ÝÝ 
(
ÝÝ 
$str
ÝÝ ;
)
ÝÝ; <
;
ÝÝ< =

sqlCommand
ÞÞ 
.
ÞÞ 
Append
ÞÞ 
(
ÞÞ 
$str
ÞÞ >
)
ÞÞ> ?
;
ÞÞ? @

sqlCommand
ßß 
.
ßß 
Append
ßß 
(
ßß 
$str
ßß <
)
ßß< =
;
ßß= >

sqlCommand
àà 
.
àà 
Append
àà 
(
àà 
$str
àà 1
)
àà1 2
;
àà2 3

sqlCommand
áá 
.
áá 
Append
áá 
(
áá 
$str
áá N
)
ááN O
;
ááO P

sqlCommand
ââ 
.
ââ 
Append
ââ 
(
ââ 
$str
ââ 4
)
ââ4 5
;
ââ5 6

sqlCommand
ãã 
.
ãã 
Append
ãã 
(
ãã 
$str
ãã V
)
ããV W
;
ããW X

sqlCommand
ää 
.
ää 
Append
ää 
(
ää 
$str
ää (
)
ää( )
;
ää) *

sqlCommand
åå 
.
åå 
Append
åå 
(
åå 
$str
åå 9
)
åå9 :
;
åå: ; 
SqlParameterHelper
çç 
sph
çç "
=
çç# $
new
çç% ( 
SqlParameterHelper
çç) ;
(
çç; <
ConnectionString
çç< L
.
ççL M%
GetReadConnectionString
ççM d
(
ççd e
)
ççe f
,
ççf g

sqlCommand
ççh r
.
ççr s
ToString
ççs {
(
çç{ |
)
çç| }
,
çç} ~
CommandTypeçç 
.çç 
Textçç 
,çç 
$numçç 
)çç 
;çç 
sph
èè 
.
èè  
DefineSqlParameter
èè "
(
èè" #
$str
èè# ,
,
èè, -
	SqlDbType
èè. 7
.
èè7 8
Int
èè8 ;
,
èè; < 
ParameterDirection
èè= O
.
èèO P
Input
èèP U
,
èèU V
siteId
èèW ]
)
èè] ^
;
èè^ _
return
éé 
sph
éé 
.
éé 
ExecuteReader
éé $
(
éé$ %
)
éé% &
;
éé& '
}
ëë 	
public
íí 
static
íí 
IDataReader
íí !
GetMostPopular
íí" 0
(
íí0 1
int
íí1 4
siteId
íí5 ;
,
íí; <
int
íí= @
numberToGet
ííA L
)
ííL M
{
îî 	
StringBuilder
ïï 

sqlCommand
ïï $
=
ïï% &
new
ïï' *
StringBuilder
ïï+ 8
(
ïï8 9
)
ïï9 :
;
ïï: ;

sqlCommand
ññ 
.
ññ 
Append
ññ 
(
ññ 
$str
ññ +
+
ññ, -
numberToGet
ññ. 9
+
ññ: ;
$str
ññ< J
)
ññJ K
;
ññK L

sqlCommand
òò 
.
òò 
Append
òò 
(
òò 
$str
òò %
)
òò% &
;
òò& '

sqlCommand
óó 
.
óó 
Append
óó 
(
óó 
$str
óó )
)
óó) *
;
óó* +

sqlCommand
ôô 
.
ôô 
Append
ôô 
(
ôô 
$str
ôô ,
)
ôô, -
;
ôô- .

sqlCommand
õõ 
.
õõ 
Append
õõ 
(
õõ 
$str
õõ *
)
õõ* +
;
õõ+ ,

sqlCommand
öö 
.
öö 
Append
öö 
(
öö 
$str
öö /
)
öö/ 0
;
öö0 1

sqlCommand
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
$str
÷÷ /
)
÷÷/ 0
;
÷÷0 1

sqlCommand
øø 
.
øø 
Append
øø 
(
øø 
$str
øø B
)
øøB C
;
øøC D

sqlCommand
ùù 
.
ùù 
Append
ùù 
(
ùù 
$str
ùù 7
)
ùù7 8
;
ùù8 9

sqlCommand
úú 
.
úú 
Append
úú 
(
úú 
$str
úú 6
)
úú6 7
;
úú7 8

sqlCommand
ûû 
.
ûû 
Append
ûû 
(
ûû 
$str
ûû 8
)
ûû8 9
;
ûû9 :

sqlCommand
üü 
.
üü 
Append
üü 
(
üü 
$str
üü 0
)
üü0 1
;
üü1 2

sqlCommand
ýý 
.
ýý 
Append
ýý 
(
ýý 
$str
ýý 1
)
ýý1 2
;
ýý2 3

sqlCommand
þþ 
.
þþ 
Append
þþ 
(
þþ 
$str
þþ 1
)
þþ1 2
;
þþ2 3

sqlCommand
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
ÿÿ 0
)
ÿÿ0 1
;
ÿÿ1 2

sqlCommand
 
.
 
Append
 
(
 
$str
 3
)
3 4
;
4 5

sqlCommand
 
.
 
Append
 
(
 
$str
 >
)
> ?
;
? @

sqlCommand
 
.
 
Append
 
(
 
$str
 B
)
B C
;
C D

sqlCommand
 
.
 
Append
 
(
 
$str
 V
)
V W
;
W X

sqlCommand
 
.
 
Append
 
(
 
$str
 '
)
' (
;
( )

sqlCommand
 
.
 
Append
 
(
 
$str
 )
)
) *
;
* +

sqlCommand
 
.
 
Append
 
(
 
$str
 0
)
0 1
;
1 2

sqlCommand
 
.
 
Append
 
(
 
$str
 *
)
* +
;
+ ,

sqlCommand
 
.
 
Append
 
(
 
$str
 2
)
2 3
;
3 4

sqlCommand
 
.
 
Append
 
(
 
$str
 8
)
8 9
;
9 :

sqlCommand
 
.
 
Append
 
(
 
$str
 B
)
B C
;
C D

sqlCommand
 
.
 
Append
 
(
 
$str
 7
)
7 8
;
8 9

sqlCommand
 
.
 
Append
 
(
 
$str
 :
)
: ;
;
; <

sqlCommand
 
.
 
Append
 
(
 
$str
 ;
)
; <
;
< =

sqlCommand
 
.
 
Append
 
(
 
$str
 >
)
> ?
;
? @

sqlCommand
 
.
 
Append
 
(
 
$str
 <
)
< =
;
= >

sqlCommand
 
.
 
Append
 
(
 
$str
 1
)
1 2
;
2 3

sqlCommand
 
.
 
Append
 
(
 
$str
 N
)
N O
;
O P

sqlCommand
 
.
 
Append
 
(
 
$str
 4
)
4 5
;
5 6

sqlCommand
 
.
 
Append
 
(
 
$str
 V
)
V W
;
W X

sqlCommand
 
.
 
Append
 
(
 
$str
 (
)
( )
;
) *

sqlCommand
 
.
 
Append
 
(
 
$str
 T
)
T U
;
U V 
SqlParameterHelper
 
sph
 "
=
# $
new
% ( 
SqlParameterHelper
) ;
(
; <
ConnectionString
< L
.
L M%
GetReadConnectionString
M d
(
d e
)
e f
,
f g

sqlCommand
h r
.
r s
ToString
s {
(
{ |
)
| }
,
} ~
CommandType 
. 
Text 
, 
$num 
) 
; 
sph
 
.
  
DefineSqlParameter
 "
(
" #
$str
# ,
,
, -
	SqlDbType
. 7
.
7 8
Int
8 ;
,
; < 
ParameterDirection
= O
.
O P
Input
P U
,
U V
siteId
W ]
)
] ^
;
^ _
return
 
sph
 
.
 
ExecuteReader
 $
(
$ %
)
% &
;
& '
}
¡¡ 	
public
££ 
static
££ 
int
££ 
Count
££ 
(
££  
int
££  #
siteId
££$ *
)
££* +
{
¤¤ 	 
SqlParameterHelper
¥¥ 
sph
¥¥ "
=
¥¥# $
new
¥¥% ( 
SqlParameterHelper
¥¥) ;
(
¥¥; <
ConnectionString
¥¥< L
.
¥¥L M%
GetReadConnectionString
¥¥M d
(
¥¥d e
)
¥¥e f
,
¥¥f g
$str
¥¥h ~
,
¥¥~ 
$num¥¥ 
)¥¥ 
;¥¥ 
sph
¦¦ 
.
¦¦  
DefineSqlParameter
¦¦ "
(
¦¦" #
$str
¦¦# ,
,
¦¦, -
	SqlDbType
¦¦. 7
.
¦¦7 8
Int
¦¦8 ;
,
¦¦; < 
ParameterDirection
¦¦= O
.
¦¦O P
Input
¦¦P U
,
¦¦U V
siteId
¦¦W ]
)
¦¦] ^
;
¦¦^ _
int
§§ 
count
§§ 
=
§§ 
Convert
§§ 
.
§§  
ToInt32
§§  '
(
§§' (
sph
§§( +
.
§§+ ,
ExecuteScalar
§§, 9
(
§§9 :
)
§§: ;
)
§§; <
;
§§< =
return
¨¨ 
count
¨¨ 
;
¨¨ 
}
©© 	
}
°° 
}±± Ð
iD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SqlHelper.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

static 
class 
	SqlHelper !
{ 
private 
static 
void 
PrepareCommand *
(* +

SqlCommand 
command 
, 
SqlConnection 

connection $
,$ %
SqlTransaction 
transaction &
,& '
CommandType 
commandType #
,# $
string   
commandText   
,   
SqlParameter!! 
[!! 
]!! 
commandParameters!! ,
)!!, -
{"" 	
if## 
(## 
command## 
==## 
null## 
)##  
throw##! &
new##' *!
ArgumentNullException##+ @
(##@ A
$str##A J
)##J K
;##K L
if$$ 
($$ 
string$$ 
.$$ 
IsNullOrEmpty$$ $
($$$ %
commandText$$% 0
)$$0 1
)$$1 2
throw$$3 8
new$$9 <!
ArgumentNullException$$= R
($$R S
$str$$S `
)$$` a
;$$a b
command&& 
.&& 
CommandType&& 
=&&  !
commandType&&" -
;&&- .
command'' 
.'' 
CommandText'' 
=''  !
commandText''" -
;''- .
command(( 
.(( 

Connection(( 
=((  

connection((! +
;((+ ,
if** 
(** 
transaction** 
!=** 
null** #
)**# $
{++ 
if,, 
(,, 
transaction,, 
.,,  

Connection,,  *
==,,+ -
null,,. 2
),,2 3
throw,,4 9
new,,: =
ArgumentException,,> O
(,,O P
$str	,,P ¡
,
,,¡ ¢
$str
,,£ °
)
,,° ±
;
,,± ²
command-- 
.-- 
Transaction-- #
=--$ %
transaction--& 1
;--1 2
}.. 
if00 
(00 
commandParameters00 !
!=00" $
null00% )
)00) *
{00+ ,
AttachParameters00- =
(00= >
command00> E
,00E F
commandParameters00G X
)00X Y
;00Y Z
}00[ \
}11 	
private33 
static33 
void33 
AttachParameters33 ,
(33, -

SqlCommand33- 7
command338 ?
,33? @
SqlParameter33A M
[33M N
]33N O
commandParameters33P a
)33a b
{44 	
if55 
(55 
command55 
==55 
null55 
)55  
throw55! &
new55' *!
ArgumentNullException55+ @
(55@ A
$str55A J
)55J K
;55K L
if66 
(66 
commandParameters66 !
!=66" $
null66% )
)66) *
{77 
foreach88 
(88 
SqlParameter88 %
p88& '
in88( *
commandParameters88+ <
)88< =
{99 
if:: 
(:: 
p:: 
!=:: 
null:: !
)::! "
{;; 
if<< 
(<< 
(<< 
p<< 
.<< 
	Direction<< (
==<<) +
ParameterDirection<<, >
.<<> ?
InputOutput<<? J
||<<K M
p== 
.== 
	Direction== '
====( *
ParameterDirection==+ =
.=== >
Input==> C
)==C D
&&==E G
(>> 
p>> 
.>> 
Value>> $
==>>% '
null>>( ,
)>>, -
)>>- .
{?? 
p@@ 
.@@ 
Value@@ #
=@@$ %
DBNull@@& ,
.@@, -
Value@@- 2
;@@2 3
}AA 
commandBB 
.BB  

ParametersBB  *
.BB* +
AddBB+ .
(BB. /
pBB/ 0
)BB0 1
;BB1 2
}CC 
}DD 
}EE 
}FF 	
publicHH 
staticHH 
intHH 
ExecuteNonQueryHH )
(HH) *
stringHH* 0
connectionStringHH1 A
,HHA B
CommandTypeHHC N
commandTypeHHO Z
,HHZ [
stringHH\ b
commandTextHHc n
,HHn o
paramsHHp v
SqlParameter	HHw 
[
HH 
]
HH 
commandParameters
HH 
)
HH 
{II 	
intJJ 
commandTimeoutJJ 
=JJ  
$numJJ! #
;JJ# $
returnLL 
ExecuteNonQueryLL "
(LL" #
connectionStringLL# 3
,LL3 4
commandTypeLL5 @
,LL@ A
commandTextLLB M
,LLM N
commandTimeoutLLO ]
,LL] ^
commandParametersLL_ p
)LLp q
;LLq r
}XX 	
publicZZ 
staticZZ 
intZZ 
ExecuteNonQueryZZ )
(ZZ) *
stringZZ* 0
connectionStringZZ1 A
,ZZA B
CommandTypeZZC N
commandTypeZZO Z
,ZZZ [
stringZZ\ b
commandTextZZc n
,ZZn o
intZZp s
commandTimeout	ZZt 
,
ZZ 
params
ZZ 
SqlParameter
ZZ 
[
ZZ 
]
ZZ 
commandParameters
ZZ «
)
ZZ« ¬
{[[ 	
if\\ 
(\\ 
connectionString\\  
==\\! #
null\\$ (
||\\) +
connectionString\\, <
.\\< =
Length\\= C
==\\D F
$num\\G H
)\\H I
throw\\J O
new\\P S!
ArgumentNullException\\T i
(\\i j
$str\\j |
)\\| }
;\\} ~
using]] 
(]] 
SqlConnection]]  

connection]]! +
=]], -
new]]. 1
SqlConnection]]2 ?
(]]? @
connectionString]]@ P
)]]P Q
)]]Q R
{^^ 

connection__ 
.__ 
Open__ 
(__  
)__  !
;__! "
using`` 
(`` 

SqlCommand`` !
command``" )
=``* +
new``, /

SqlCommand``0 :
(``: ;
)``; <
)``< =
{aa 
PrepareCommandbb "
(bb" #
commandbb# *
,bb* +

connectionbb, 6
,bb6 7
nullbb8 <
,bb< =
commandTypebb> I
,bbI J
commandTextbbK V
,bbV W
commandParametersbbX i
)bbi j
;bbj k
commandcc 
.cc 
CommandTimeoutcc *
=cc+ ,
commandTimeoutcc- ;
;cc; <
returndd 
commanddd "
.dd" #
ExecuteNonQuerydd# 2
(dd2 3
)dd3 4
;dd4 5
}ee 
}ff 
}gg 	
publicii 
staticii 
intii 
ExecuteNonQueryii )
(ii) *
SqlTransactionjj 
transactionjj &
,jj& '
CommandTypekk 
commandTypekk #
,kk# $
stringll 
commandTextll 
,ll 
paramsmm 
SqlParametermm 
[mm  
]mm  !
commandParametersmm" 3
)mm3 4
{nn 	
intoo 
commandTimeoutoo 
=oo  
$numoo! #
;oo# $
returnqq 
ExecuteNonQueryqq "
(qq" #
transactionqq# .
,qq. /
commandTypeqq0 ;
,qq; <
commandTextqq= H
,qqH I
commandTimeoutqqJ X
,qqX Y
commandParametersqqZ k
)qqk l
;qql m
}
 	
public
 
static
 
int
 
ExecuteNonQuery
 )
(
) *
SqlTransaction
 
transaction
 &
,
& '
CommandType
 
commandType
 #
,
# $
string
 
commandText
 
,
 
int
 
commandTimeout
 
,
 
params
 
SqlParameter
 
[
  
]
  !
commandParameters
" 3
)
3 4
{
 	
if
 
(
 
transaction
 
==
 
null
 #
)
# $
throw
% *
new
+ .#
ArgumentNullException
/ D
(
D E
$str
E R
)
R S
;
S T
if
 
(
 
transaction
 
!=
 
null
 #
&&
$ &
transaction
' 2
.
2 3

Connection
3 =
==
> @
null
A E
)
E F
throw
G L
new
M P
ArgumentException
Q b
(
b c
$strc ´
,´ µ
$str¶ Ã
)Ã Ä
;Ä Å
using
 
(
 

SqlCommand
 
command
 %
=
& '
new
( +

SqlCommand
, 6
(
6 7
)
7 8
)
8 9
{
 
PrepareCommand
 
(
 
command
 
,
 
transaction
 
.
  

Connection
  *
,
* +
transaction
 
,
  
commandType
 
,
  
commandText
 
,
  
commandParameters
 %
)
% &
;
& '
command
 
.
 
CommandTimeout
 &
=
' (
commandTimeout
) 7
;
7 8
return
 
command
 
.
 
ExecuteNonQuery
 .
(
. /
)
/ 0
;
0 1
}
 
}
 	
public
 
static
 
SqlDataReader
 #
ExecuteReader
$ 1
(
1 2
string
2 8
connectionString
9 I
,
I J
CommandType
K V
commandType
W b
,
b c
string
d j
commandText
k v
,
v w
params
x ~
SqlParameter 
[ 
] !
commandParameters 
)  
{
 	
int
   
commandTimeout
   
=
    
$num
  ! #
;
  # $
return
¡¡ 
ExecuteReader
¡¡  
(
¡¡  !
connectionString
¡¡! 1
,
¡¡1 2
commandType
¡¡3 >
,
¡¡> ?
commandText
¡¡@ K
,
¡¡K L
commandTimeout
¡¡M [
,
¡¡[ \
commandParameters
¡¡] n
)
¡¡n o
;
¡¡o p
}
»» 	
public
½½ 
static
½½ 
SqlDataReader
½½ #
ExecuteReader
½½$ 1
(
½½1 2
string
½½2 8
connectionString
½½9 I
,
½½I J
CommandType
½½K V
commandType
½½W b
,
½½b c
string
½½d j
commandText
½½k v
,
½½v w
int
½½x {
commandTimeout½½| 
,½½ 
params½½ 
SqlParameter½½ 
[½½  
]½½  ¡!
commandParameters½½¢ ³
)½½³ ´
{
¾¾ 	
if
¿¿ 
(
¿¿ 
connectionString
¿¿  
==
¿¿! #
null
¿¿$ (
||
¿¿) +
connectionString
¿¿, <
.
¿¿< =
Length
¿¿= C
==
¿¿D F
$num
¿¿G H
)
¿¿H I
throw
¿¿J O
new
¿¿P S#
ArgumentNullException
¿¿T i
(
¿¿i j
$str
¿¿j |
)
¿¿| }
;
¿¿} ~
SqlConnection
ÀÀ 

connection
ÀÀ $
=
ÀÀ% &
null
ÀÀ' +
;
ÀÀ+ ,
try
ÁÁ 
{
ÂÂ 

connection
ÃÃ 
=
ÃÃ 
new
ÃÃ  
SqlConnection
ÃÃ! .
(
ÃÃ. /
connectionString
ÃÃ/ ?
)
ÃÃ? @
;
ÃÃ@ A

connection
ÄÄ 
.
ÄÄ 
Open
ÄÄ 
(
ÄÄ  
)
ÄÄ  !
;
ÄÄ! "
using
ÅÅ 
(
ÅÅ 

SqlCommand
ÅÅ !
command
ÅÅ" )
=
ÅÅ* +
new
ÅÅ, /

SqlCommand
ÅÅ0 :
(
ÅÅ: ;
)
ÅÅ; <
)
ÅÅ< =
{
ÆÆ 
PrepareCommand
ÇÇ "
(
ÇÇ" #
command
ÈÈ 
,
ÈÈ  

connection
ÉÉ "
,
ÉÉ" #
null
ÊÊ 
,
ÊÊ 
commandType
ËË #
,
ËË# $
commandText
ÌÌ #
,
ÌÌ# $
commandParameters
ÍÍ )
)
ÍÍ) *
;
ÍÍ* +
command
ÏÏ 
.
ÏÏ 
CommandTimeout
ÏÏ *
=
ÏÏ+ ,
commandTimeout
ÏÏ- ;
;
ÏÏ; <
return
ÑÑ 
command
ÑÑ "
.
ÑÑ" #
ExecuteReader
ÑÑ# 0
(
ÑÑ0 1
CommandBehavior
ÑÑ1 @
.
ÑÑ@ A
CloseConnection
ÑÑA P
)
ÑÑP Q
;
ÑÑQ R
}
ÒÒ 
}
ÓÓ 
catch
ÔÔ 
{
ÕÕ 
if
ÖÖ 
(
ÖÖ 
(
ÖÖ 

connection
ÖÖ 
!=
ÖÖ  "
null
ÖÖ# '
)
ÖÖ' (
&&
ÖÖ) +
(
ÖÖ, -

connection
ÖÖ- 7
.
ÖÖ7 8
State
ÖÖ8 =
==
ÖÖ> @
ConnectionState
ÖÖA P
.
ÖÖP Q
Open
ÖÖQ U
)
ÖÖU V
)
ÖÖV W
{
ÖÖX Y

connection
ÖÖZ d
.
ÖÖd e
Close
ÖÖe j
(
ÖÖj k
)
ÖÖk l
;
ÖÖl m
}
ÖÖn o
throw
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
public
ÛÛ 
static
ÛÛ 
object
ÛÛ 
ExecuteScalar
ÛÛ *
(
ÛÛ* +
string
ÛÛ+ 1
connectionString
ÛÛ2 B
,
ÛÛB C
CommandType
ÛÛD O
commandType
ÛÛP [
,
ÛÛ[ \
string
ÛÛ] c
commandText
ÛÛd o
,
ÛÛo p
params
ÛÛq w
SqlParameterÛÛx 
[ÛÛ 
]ÛÛ !
commandParametersÛÛ 
)ÛÛ 
{
ÜÜ 	
int
ÝÝ 
commandTimeout
ÝÝ 
=
ÝÝ  
$num
ÝÝ! #
;
ÝÝ# $
return
ÞÞ 
ExecuteScalar
ÞÞ  
(
ÞÞ  !
connectionString
ÞÞ! 1
,
ÞÞ1 2
commandType
ÞÞ3 >
,
ÞÞ> ?
commandText
ÞÞ@ K
,
ÞÞK L
commandTimeout
ÞÞM [
,
ÞÞ[ \
commandParameters
ÞÞ] n
)
ÞÞn o
;
ÞÞo p
}
êê 	
public
ìì 
static
ìì 
object
ìì 
ExecuteScalar
ìì *
(
ìì* +
string
ìì+ 1
connectionString
ìì2 B
,
ììB C
CommandType
ììD O
commandType
ììP [
,
ìì[ \
string
ìì] c
commandText
ììd o
,
ììo p
int
ììq t
commandTimeoutììu 
,ìì 
paramsìì 
SqlParameterìì 
[ìì 
]ìì !
commandParametersìì ¬
)ìì¬ ­
{
íí 	
if
îî 
(
îî 
connectionString
îî  
==
îî! #
null
îî$ (
||
îî) +
connectionString
îî, <
.
îî< =
Length
îî= C
==
îîD F
$num
îîG H
)
îîH I
throw
îîJ O
new
îîP S#
ArgumentNullException
îîT i
(
îîi j
$str
îîj |
)
îî| }
;
îî} ~
using
ïï 
(
ïï 
SqlConnection
ïï  

connection
ïï! +
=
ïï, -
new
ïï. 1
SqlConnection
ïï2 ?
(
ïï? @
connectionString
ïï@ P
)
ïïP Q
)
ïïQ R
{
ðð 

connection
ññ 
.
ññ 
Open
ññ 
(
ññ  
)
ññ  !
;
ññ! "
using
òò 
(
òò 

SqlCommand
òò !
command
òò" )
=
òò* +
new
òò, /

SqlCommand
òò0 :
(
òò: ;
)
òò; <
)
òò< =
{
óó 
PrepareCommand
ôô "
(
ôô" #
command
ôô# *
,
ôô* +

connection
ôô, 6
,
ôô6 7
(
ôô8 9
SqlTransaction
ôô9 G
)
ôôG H
null
ôôH L
,
ôôL M
commandType
ôôN Y
,
ôôY Z
commandText
ôô[ f
,
ôôf g
commandParameters
ôôh y
)
ôôy z
;
ôôz {
command
õõ 
.
õõ 
CommandTimeout
õõ *
=
õõ+ ,
commandTimeout
õõ- ;
;
õõ; <
return
÷÷ 
command
÷÷ "
.
÷÷" #
ExecuteScalar
÷÷# 0
(
÷÷0 1
)
÷÷1 2
;
÷÷2 3
}
øø 
}
ùù 
}
úú 	
public
üü 
static
üü 
DataSet
üü 
ExecuteDataset
üü ,
(
üü, -
string
üü- 3
connectionString
üü4 D
,
üüD E
CommandType
üüF Q
commandType
üüR ]
,
üü] ^
string
üü_ e
commandText
üüf q
)
üüq r
{
ýý 	
return
þþ 
ExecuteDataset
þþ !
(
þþ! "
connectionString
þþ" 2
,
þþ2 3
commandType
þþ4 ?
,
þþ? @
commandText
þþA L
,
þþL M
(
þþN O
SqlParameter
þþO [
[
þþ[ \
]
þþ\ ]
)
þþ] ^
null
þþ^ b
)
þþb c
;
þþc d
}
ÿÿ 	
public
 
static
 
DataSet
 
ExecuteDataset
 ,
(
, -
string
- 3
connectionString
4 D
,
D E
CommandType
F Q
commandType
R ]
,
] ^
string
_ e
commandText
f q
,
q r
params
s y
SqlParameterz 
[ 
] !
commandParameters 
) 
{
 	
if
 
(
 
connectionString
  
==
! #
null
$ (
||
) +
connectionString
, <
.
< =
Length
= C
==
D F
$num
G H
)
H I
throw
J O
new
P S#
ArgumentNullException
T i
(
i j
$str
j |
)
| }
;
} ~
using
 
(
 
SqlConnection
  

connection
! +
=
, -
new
. 1
SqlConnection
2 ?
(
? @
connectionString
@ P
)
P Q
)
Q R
{
 

connection
 
.
 
Open
 
(
  
)
  !
;
! "
using
 
(
 

SqlCommand
 !
command
" )
=
* +
new
, /

SqlCommand
0 :
(
: ;
)
; <
)
< =
{
 
PrepareCommand
 "
(
" #
command
# *
,
* +

connection
, 6
,
6 7
(
8 9
SqlTransaction
9 G
)
G H
null
H L
,
L M
commandType
N Y
,
Y Z
commandText
[ f
,
f g
commandParameters
h y
)
y z
;
z {
using
 
(
 
SqlDataAdapter
 )
adpater
* 1
=
2 3
new
4 7
SqlDataAdapter
8 F
(
F G
command
G N
)
N O
)
O P
{
 
DataSet
 
dataSet
  '
=
( )
new
* -
DataSet
. 5
(
5 6
)
6 7
;
7 8
adpater
 
.
  
Fill
  $
(
$ %
dataSet
% ,
)
, -
;
- .
return
 
dataSet
 &
;
& '
}
 
}
 
}
 
}
 	
}
 
} èí
rD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Data.MSSQL\SQLParameterHelper.cs
	namespace 	

mojoPortal
 
. 
Data 
{ 
public 

class 
SqlParameterHelper #
{ 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
SqlParameterHelperG Y
)Y Z
)Z [
;[ \
private 
static 
bool 
debugLog $
=% &
log' *
.* +
IsDebugEnabled+ 9
;9 :
private 
SqlParameter 
[ 
] 
arParams '
;' (
private   
int   
index   
=   
$num   
;   
private!! 
int!! 
paramCnt!! 
;!! 
private"" 
string"" 
commandText"" "
;""" #
private## 
bool## 
parametersDefined## &
;##& '
private$$ 
string$$ 
connectionString$$ '
;$$' (
private%% 
CommandType%% 
cmdType%% #
;%%# $
public)) 
SqlParameterHelper)) !
())! "
string))" (
connectionString))) 9
,))9 :
string)); A
commandText))B M
,))M N
CommandType))O Z
cmdType))[ b
,))b c
int))d g
paramCnt))h p
)))p q
{** 	

Initialize++ 
(++ 
connectionString++ '
,++' (
commandText++) 4
,++4 5
cmdType++6 =
,++= >
paramCnt++? G
)++G H
;++H I
},, 	
public.. 
SqlParameterHelper.. !
(..! "
string.." (
connectionString..) 9
,..9 :
string..; A
commandText..B M
,..M N
int..O R
paramCnt..S [
)..[ \
{// 	

Initialize00 
(00 
connectionString00 '
,00' (
commandText00) 4
,004 5
CommandType006 A
.00A B
StoredProcedure00B Q
,00Q R
paramCnt00S [
)00[ \
;00\ ]
}11 	
private55 
void55 $
BeginDefineSqlParameters55 -
(55- .
)55. /
{66 	
index77 
=77 
$num77 
;77 
InitializeArray88 
(88 
)88 
;88 
}99 	
private;; 
void;; 
InitializeArray;; $
(;;$ %
);;% &
{<< 	
if== 
(== 
(>>  
ConfigurationManager>> %
.>>% &
AppSettings>>& 1
[>>1 2
$str>>2 H
]>>H I
!=>>J L
null>>M Q
)>>Q R
&&?? 
(?? 
string?? 
.?? 
Equals??  
(??  ! 
ConfigurationManager??! 5
.??5 6
AppSettings??6 A
[??A B
$str??B X
]??X Y
,??Y Z
$str??[ a
,??a b
StringComparison??c s
.??s t'
InvariantCultureIgnoreCase	??t 
)
?? 
)
?? 
&&@@ 
(@@ 
cmdType@@ 
==@@ 
CommandType@@ *
.@@* +
StoredProcedure@@+ :
)@@: ;
)AA 
{BB 
arParamsCC 
=CC 
GetParametersCC (
(CC( )
connectionStringCC) 9
,CC9 :
commandTextCC; F
)CCF G
;CCG H
DebugDD 
.DD 
AssertDD 
(DD 
arParamsDD %
.DD% &
LengthDD& ,
==DD- /
paramCntDD0 8
,DD8 9
$strDD: h
)DDh i
;DDi j
parametersDefinedEE !
=EE" #
trueEE$ (
;EE( )
}FF 
elseGG 
{HH 
arParamsII 
=II 
newII 
SqlParameterII +
[II+ ,
paramCntII, 4
]II4 5
;II5 6
parametersDefinedJJ !
=JJ" #
falseJJ$ )
;JJ) *
}KK 
}LL 	
privateNN 
voidNN 

InitializeNN 
(NN  
stringNN  &
pConnectionInfoNN' 6
,NN6 7
stringNN8 >
pCommandTextNN? K
,NNK L
CommandTypeNNM X
pCmdTypeNNY a
,NNa b
intNNc f
	pParamCntNNg p
)NNp q
{OO 	
ifPP 
(PP 
pConnectionInfoPP 
==PP  "
nullPP# '
||PP( *
pConnectionInfoPP+ :
.PP: ;
LengthPP; A
==PPB D
$numPPE F
)PPF G
throwPPH M
newPPN Q!
ArgumentNullExceptionPPR g
(PPg h
$strPPh z
)PPz {
;PP{ |
ifQQ 
(QQ 
pCommandTextQQ 
==QQ 
nullQQ  $
||QQ% '
pCommandTextQQ( 4
.QQ4 5
LengthQQ5 ;
==QQ< >
$numQQ? @
)QQ@ A
throwQQB G
newQQH K!
ArgumentNullExceptionQQL a
(QQa b
$strQQb o
)QQo p
;QQp q
connectionStringRR 
=RR 
pConnectionInfoRR .
;RR. /
paramCntSS 
=SS 
	pParamCntSS  
;SS  !
commandTextTT 
=TT 
pCommandTextTT &
;TT& '
cmdTypeUU 
=UU 
pCmdTypeUU 
;UU $
BeginDefineSqlParametersWW $
(WW$ %
)WW% &
;WW& '
}XX 	
publicZZ 
voidZZ 
DefineSqlParameterZZ &
(ZZ& '
StringZZ' -
	paramNameZZ. 7
,ZZ7 8
	SqlDbTypeZZ9 B
typeZZC G
,ZZG H
ParameterDirectionZZI [
dirZZ\ _
,ZZ_ `
objectZZa g
valueZZh m
)ZZm n
{[[ 	
DefineSqlParameter\\ 
(\\ 
	paramName\\ (
,\\( )
type\\* .
,\\. /
string\\0 6
.\\6 7
Empty\\7 <
,\\< =
$num\\> ?
,\\? @
$num\\A B
,\\B C
dir\\D G
,\\G H
value\\I N
,\\N O
false\\P U
,\\U V
false\\W \
)\\\ ]
;\\] ^
}]] 	
public__ 
void__ 
DefineSqlParameter__ &
(__& '
String__' -
	paramName__. 7
,__7 8
	SqlDbType__9 B
type__C G
,__G H
int__I L
size__M Q
,__Q R
ParameterDirection__S e
dir__f i
,__i j
object__k q
value__r w
)__w x
{`` 	
DefineSqlParameteraa 
(aa 
	paramNameaa (
,aa( )
typeaa* .
,aa. /
stringaa0 6
.aa6 7
Emptyaa7 <
,aa< =
sizeaa> B
,aaB C
$numaaD E
,aaE F
diraaG J
,aaJ K
valueaaL Q
,aaQ R
trueaaS W
,aaW X
falseaaY ^
)aa^ _
;aa_ `
}bb 	
publicdd 
voiddd 
DefineSqlParameterdd &
(dd& '
Stringdd' -
	paramNamedd. 7
,dd7 8
	SqlDbTypedd9 B
typeddC G
,ddG H
intddI L
sizeddM Q
,ddQ R
byteddS W
	precisionddX a
,dda b
ParameterDirectionddc u
dirddv y
,ddy z
object	dd{ 
value
dd 
)
dd 
{ee 	
DefineSqlParameterff 
(ff 
	paramNameff (
,ff( )
typeff* .
,ff. /
stringff0 6
.ff6 7
Emptyff7 <
,ff< =
sizeff> B
,ffB C
	precisionffD M
,ffM N
dirffO R
,ffR S
valueffT Y
,ffY Z
trueff[ _
,ff_ `
trueffa e
)ffe f
;fff g
}gg 	
publicii 
voidii 
DefineSqlParameterii &
(ii& '
Stringii' -
	paramNameii. 7
,ii7 8
	SqlDbTypeii9 B
typeiiC G
,iiG H
StringiiI O
typeNameiiP X
,iiX Y
ParameterDirectioniiZ l
diriim p
,iip q
objectiir x
valueiiy ~
)ii~ 
{jj 	
DefineSqlParameterkk 
(kk 
	paramNamekk (
,kk( )
typekk* .
,kk. /
typeNamekk0 8
,kk8 9
$numkk: ;
,kk; <
$numkk= >
,kk> ?
dirkk@ C
,kkC D
valuekkE J
,kkJ K
falsekkL Q
,kkQ R
falsekkS X
)kkX Y
;kkY Z
}ll 	
privatenn 
voidnn 
DefineSqlParameternn '
(nn' (
Stringoo 
	paramNameoo 
,oo 
	SqlDbTypepp 
typepp 
,pp 
Stringqq 
typeNameqq 
,qq 
intrr 
sizerr 
,rr 
bytess 
	precisionss 
,ss 
ParameterDirectiontt 
dirtt "
,tt" #
objectuu 
valueuu 
,uu 
boolvv 
sizeProvidedvv 
,vv 
boolww 
precisionProvidedww "
)ww" #
{xx 	
Debugyy 
.yy 
Assertyy 
(yy 
indexyy 
<yy  
arParamsyy! )
.yy) *
Lengthyy* 0
,yy0 1
$stryy2 N
)yyN O
;yyO P
Debugzz 
.zz 
Assertzz 
(zz 
indexzz 
<zz  
paramCntzz! )
,zz) *
$strzz+ `
)zz` a
;zza b
if|| 
(|| 
!|| 
parametersDefined|| "
)||" #
{}} 
if~~ 
(~~ 
sizeProvided~~  
)~~  !
arParams 
[ 
index "
]" #
=$ %
new& )
SqlParameter* 6
(6 7
	paramName7 @
,@ A
typeB F
,F G
sizeH L
)L M
;M N
else
 
arParams
 
[
 
index
 "
]
" #
=
$ %
new
& )
SqlParameter
* 6
(
6 7
	paramName
7 @
,
@ A
type
B F
)
F G
;
G H
if
 
(
 
precisionProvided
 %
)
% &
{
' (
arParams
) 1
[
1 2
index
2 7
]
7 8
.
8 9
	Precision
9 B
=
C D
	precision
E N
;
N O
}
P Q
arParams
 
[
 
index
 
]
 
.
  
	Direction
  )
=
* +
dir
, /
;
/ 0
}
 
Debug
 
.
 
Assert
 
(
 
arParams
 !
[
! "
index
" '
]
' (
.
( )
	Direction
) 2
==
3 5
dir
6 9
,
9 :
$str
; r
)
r s
;
s t
Debug
 
.
 
Assert
 
(
 
string
 
.
  
Equals
  &
(
& '
arParams
' /
[
/ 0
index
0 5
]
5 6
.
6 7
ParameterName
7 D
,
D E
	paramName
F O
,
O P
StringComparison
Q a
.
a b(
InvariantCultureIgnoreCase
b |
)
| }
,
} ~
$str ±
)± ²
;² ³
Debug
 
.
 
Assert
 
(
 
(
 
(
 
type
 
!=
 
	SqlDbType
 #
.
# $
NText
$ )
)
) *
&&
+ -
(
. /
arParams
/ 7
[
7 8
index
8 =
]
= >
.
> ?
	SqlDbType
? H
==
I K
type
L P
)
P Q
)
Q R
||
 
(
 
(
 
type
 
==
 
	SqlDbType
 #
.
# $
NText
$ )
)
) *
&&
+ -
(
. /
arParams
/ 7
[
7 8
index
8 =
]
= >
.
> ?
	SqlDbType
? H
==
I K
	SqlDbType
L U
.
U V
NVarChar
V ^
)
^ _
)
_ `
||
 
(
 
(
 
type
 
==
 
	SqlDbType
 #
.
# $
Image
$ )
)
) *
&&
+ -
(
. /
arParams
/ 7
[
7 8
index
8 =
]
= >
.
> ?
	SqlDbType
? H
==
I K
	SqlDbType
L U
.
U V
	VarBinary
V _
)
_ `
)
` a
,
 
$str
 D
)
 
;
 
if
 
(
 
typeName
 
.
 
Length
 
>
  !
$num
" #
)
# $
arParams
 
[
 
index
 
]
 
.
  
TypeName
  (
=
) *"
ConfigurationManager
+ ?
.
? @
AppSettings
@ K
[
K L
$str
L ^
]
^ _
+
` a
typeName
b j
;
j k
arParams
 
[
 
index
 
]
 
.
 
Value
 !
=
" #
value
$ )
;
) *
index
 
++
 
;
 
}
 	
public
 
IDataReader
 
ExecuteReader
 (
(
( )
)
) *
{
 	
Debug
 
.
 
Assert
 
(
 
(
 
arParams
 "
.
" #
Length
# )
==
* ,
index
- 2
)
2 3
&&
4 6
(
7 8
paramCnt
8 @
==
A C
index
D I
)
I J
,
J K
$str
L m
)
m n
;
n o
if
 
(
 
debugLog
 
)
 
{
 
log
 
.
  
Debug
  %
(
% &
$str
& 6
+
7 8
commandText
9 D
)
D E
;
E F
}
G H
return
 
	SqlHelper
 
.
 
ExecuteReader
 *
(
* +
connectionString
+ ;
,
; <
cmdType
= D
,
D E
commandText
F Q
,
Q R
arParams
S [
)
[ \
;
\ ]
}
   	
public
¢¢ 
IDataReader
¢¢ 
ExecuteReader
¢¢ (
(
¢¢( )
int
¢¢) ,
commandTimeout
¢¢- ;
)
¢¢; <
{
££ 	
Debug
¤¤ 
.
¤¤ 
Assert
¤¤ 
(
¤¤ 
(
¤¤ 
arParams
¤¤ "
.
¤¤" #
Length
¤¤# )
==
¤¤* ,
index
¤¤- 2
)
¤¤2 3
&&
¤¤4 6
(
¤¤7 8
paramCnt
¤¤8 @
==
¤¤A C
index
¤¤D I
)
¤¤I J
,
¤¤J K
$str
¤¤L m
)
¤¤m n
;
¤¤n o
if
¥¥ 
(
¥¥ 
debugLog
¥¥ 
)
¥¥ 
{
¥¥ 
log
¥¥ 
.
¥¥  
Debug
¥¥  %
(
¥¥% &
$str
¥¥& 6
+
¥¥7 8
commandText
¥¥9 D
)
¥¥D E
;
¥¥E F
}
¥¥G H
return
¦¦ 
	SqlHelper
¦¦ 
.
¦¦ 
ExecuteReader
¦¦ *
(
¦¦* +
connectionString
¦¦+ ;
,
¦¦; <
cmdType
¦¦= D
,
¦¦D E
commandText
¦¦F Q
,
¦¦Q R
commandTimeout
¦¦S a
,
¦¦a b
arParams
¦¦c k
)
¦¦k l
;
¦¦l m
}
§§ 	
public
©© 
int
©© 
ExecuteNonQuery
©© "
(
©©" #
)
©©# $
{
ªª 	
Debug
«« 
.
«« 
Assert
«« 
(
«« 
(
«« 
arParams
«« "
.
««" #
Length
««# )
==
««* ,
index
««- 2
)
««2 3
&&
««4 6
(
««7 8
paramCnt
««8 @
==
««A C
index
««D I
)
««I J
,
««J K
$str
««L m
)
««m n
;
««n o
if
¬¬ 
(
¬¬ 
debugLog
¬¬ 
)
¬¬ 
{
¬¬ 
log
¬¬ 
.
¬¬  
Debug
¬¬  %
(
¬¬% &
$str
¬¬& 8
+
¬¬9 :
commandText
¬¬; F
)
¬¬F G
;
¬¬G H
}
¬¬I J
return
­­ 
	SqlHelper
­­ 
.
­­ 
ExecuteNonQuery
­­ ,
(
­­, -
connectionString
­­- =
,
­­= >
cmdType
­­? F
,
­­F G
commandText
­­H S
,
­­S T
arParams
­­U ]
)
­­] ^
;
­­^ _
}
®® 	
public
°° 
int
°° 
ExecuteNonQuery
°° "
(
°°" #
int
°°# &
commandTimeout
°°' 5
)
°°5 6
{
±± 	
Debug
²² 
.
²² 
Assert
²² 
(
²² 
(
²² 
arParams
²² "
.
²²" #
Length
²²# )
==
²²* ,
index
²²- 2
)
²²2 3
&&
²²4 6
(
²²7 8
paramCnt
²²8 @
==
²²A C
index
²²D I
)
²²I J
,
²²J K
$str
²²L m
)
²²m n
;
²²n o
if
³³ 
(
³³ 
debugLog
³³ 
)
³³ 
{
³³ 
log
³³ 
.
³³  
Debug
³³  %
(
³³% &
$str
³³& 8
+
³³9 :
commandText
³³; F
)
³³F G
;
³³G H
}
³³I J
return
´´ 
	SqlHelper
´´ 
.
´´ 
ExecuteNonQuery
´´ ,
(
´´, -
connectionString
´´- =
,
´´= >
cmdType
´´? F
,
´´F G
commandText
´´H S
,
´´S T
commandTimeout
´´U c
,
´´c d
arParams
´´e m
)
´´m n
;
´´n o
}
µµ 	
public
½½ 
object
½½ 
ExecuteScalar
½½ #
(
½½# $
)
½½$ %
{
¾¾ 	
Debug
¿¿ 
.
¿¿ 
Assert
¿¿ 
(
¿¿ 
(
¿¿ 
arParams
¿¿ "
.
¿¿" #
Length
¿¿# )
==
¿¿* ,
index
¿¿- 2
)
¿¿2 3
&&
¿¿4 6
(
¿¿7 8
paramCnt
¿¿8 @
==
¿¿A C
index
¿¿D I
)
¿¿I J
,
¿¿J K
$str
¿¿L m
)
¿¿m n
;
¿¿n o
if
ÀÀ 
(
ÀÀ 
debugLog
ÀÀ 
)
ÀÀ 
{
ÀÀ 
log
ÀÀ 
.
ÀÀ  
Debug
ÀÀ  %
(
ÀÀ% &
$str
ÀÀ& 6
+
ÀÀ7 8
commandText
ÀÀ9 D
)
ÀÀD E
;
ÀÀE F
}
ÀÀG H
return
ÁÁ 
	SqlHelper
ÁÁ 
.
ÁÁ 
ExecuteScalar
ÁÁ *
(
ÁÁ* +
connectionString
ÁÁ+ ;
,
ÁÁ; <
cmdType
ÁÁ= D
,
ÁÁD E
commandText
ÁÁF Q
,
ÁÁQ R
arParams
ÁÁS [
)
ÁÁ[ \
;
ÁÁ\ ]
}
ÂÂ 	
public
ÄÄ 
object
ÄÄ 
ExecuteScalar
ÄÄ #
(
ÄÄ# $
int
ÄÄ$ '
commandTimeout
ÄÄ( 6
)
ÄÄ6 7
{
ÅÅ 	
Debug
ÆÆ 
.
ÆÆ 
Assert
ÆÆ 
(
ÆÆ 
(
ÆÆ 
arParams
ÆÆ "
.
ÆÆ" #
Length
ÆÆ# )
==
ÆÆ* ,
index
ÆÆ- 2
)
ÆÆ2 3
&&
ÆÆ4 6
(
ÆÆ7 8
paramCnt
ÆÆ8 @
==
ÆÆA C
index
ÆÆD I
)
ÆÆI J
,
ÆÆJ K
$str
ÆÆL m
)
ÆÆm n
;
ÆÆn o
if
ÇÇ 
(
ÇÇ 
debugLog
ÇÇ 
)
ÇÇ 
{
ÇÇ 
log
ÇÇ 
.
ÇÇ  
Debug
ÇÇ  %
(
ÇÇ% &
$str
ÇÇ& 6
+
ÇÇ7 8
commandText
ÇÇ9 D
)
ÇÇD E
;
ÇÇE F
}
ÇÇG H
return
ÈÈ 
	SqlHelper
ÈÈ 
.
ÈÈ 
ExecuteScalar
ÈÈ *
(
ÈÈ* +
connectionString
ÈÈ+ ;
,
ÈÈ; <
cmdType
ÈÈ= D
,
ÈÈD E
commandText
ÈÈF Q
,
ÈÈQ R
commandTimeout
ÈÈS a
,
ÈÈa b
arParams
ÈÈc k
)
ÈÈk l
;
ÈÈl m
}
ÉÉ 	
public
ÑÑ 
DataSet
ÑÑ 
ExecuteDataset
ÑÑ %
(
ÑÑ% &
)
ÑÑ& '
{
ÒÒ 	
Debug
ÓÓ 
.
ÓÓ 
Assert
ÓÓ 
(
ÓÓ 
(
ÓÓ 
arParams
ÓÓ "
.
ÓÓ" #
Length
ÓÓ# )
==
ÓÓ* ,
index
ÓÓ- 2
)
ÓÓ2 3
&&
ÓÓ4 6
(
ÓÓ7 8
paramCnt
ÓÓ8 @
==
ÓÓA C
index
ÓÓD I
)
ÓÓI J
,
ÓÓJ K
$str
ÓÓL m
)
ÓÓm n
;
ÓÓn o
if
ÔÔ 
(
ÔÔ 
debugLog
ÔÔ 
)
ÔÔ 
{
ÔÔ 
log
ÔÔ 
.
ÔÔ  
Debug
ÔÔ  %
(
ÔÔ% &
$str
ÔÔ& 7
+
ÔÔ8 9
commandText
ÔÔ: E
)
ÔÔE F
;
ÔÔF G
}
ÔÔH I
return
ÕÕ 
	SqlHelper
ÕÕ 
.
ÕÕ 
ExecuteDataset
ÕÕ +
(
ÕÕ+ ,
connectionString
ÕÕ, <
,
ÕÕ< =
cmdType
ÕÕ> E
,
ÕÕE F
commandText
ÕÕG R
,
ÕÕR S
arParams
ÕÕT \
)
ÕÕ\ ]
;
ÕÕ] ^
}
ÖÖ 	
public
ØØ 
SqlParameter
ØØ 
[
ØØ 
]
ØØ 

Parameters
ØØ (
{
ÙÙ 	
get
ÚÚ 
{
ÚÚ 
return
ÚÚ 
arParams
ÚÚ !
;
ÚÚ! "
}
ÚÚ# $
}
ÛÛ 	
public
ÝÝ 
string
ÝÝ 
CommandText
ÝÝ !
{
ÞÞ 	
get
ßß 
{
ßß 
return
ßß 
commandText
ßß $
;
ßß$ %
}
ßß& '
}
àà 	
public
ââ 
string
ââ 
ConnectionString
ââ &
{
ãã 	
get
ää 
{
ää 
return
ää 
connectionString
ää )
;
ää) *
}
ää+ ,
}
åå 	
public
úú 
SqlParameter
úú 
[
úú 
]
úú 
GetParameters
úú +
(
úú+ ,
string
úú, 2
connectionString
úú3 C
,
úúC D
string
úúE K
procName
úúL T
)
úúT U
{
ûû 	
if
üü 
(
üü 
string
üü 
.
üü 
IsNullOrEmpty
üü $
(
üü$ %
connectionString
üü% 5
)
üü5 6
)
üü6 7
throw
üü8 =
new
üü> A#
ArgumentNullException
üüB W
(
üüW X
$str
üüX j
)
üüj k
;
üük l
if
ýý 
(
ýý 
string
ýý 
.
ýý 
IsNullOrEmpty
ýý $
(
ýý$ %
procName
ýý% -
)
ýý- .
)
ýý. /
throw
ýý0 5
new
ýý6 9#
ArgumentNullException
ýý: O
(
ýýO P
$str
ýýP `
)
ýý` a
;
ýýa b
if
 
(
 
AlreadyCached
 
(
 
connectionString
 .
,
. /
procName
0 8
)
8 9
)
9 :
{
 
return
 $
GetParametersFromCache
 -
(
- .
connectionString
. >
,
> ?
procName
@ H
)
H I
;
I J
}
 
else
 
{
 
SqlParameter
 
[
 
]
 
copyOfParameters
 /
=
0 1 
DiscoverParameters
2 D
(
D E
connectionString
E U
,
U V
procName
W _
)
_ `
;
` a
SqlParameterCache
 !
.
! "$
AddParameterSetToCache
" 8
(
8 9
connectionString
9 I
,
I J
procName
K S
,
S T
copyOfParameters
U e
)
e f
;
f g
return
 $
GetParametersFromCache
 -
(
- .
connectionString
. >
,
> ?
procName
@ H
)
H I
;
I J
}
 
}
 	
private
 
static
 
SqlParameter
 #
[
# $
]
$ %!
CreateParameterCopy
& 9
(
9 :
	DbCommand
: C
command
D K
)
K L
{
 	&
IDataParameterCollection
 $

parameters
% /
=
0 1
command
2 9
.
9 :

Parameters
: D
;
D E
SqlParameter
 
[
 
]
 
parameterArray
 )
=
* +
new
, /
SqlParameter
0 <
[
< =

parameters
= G
.
G H
Count
H M
]
M N
;
N O

parameters
 
.
 
CopyTo
 
(
 
parameterArray
 ,
,
, -
$num
. /
)
/ 0
;
0 1
return
 
SqlParameterCache
 $
.
$ %
CloneParameters
% 4
(
4 5
parameterArray
5 C
)
C D
;
D E
}
 	
	protected
 
SqlParameter
 
[
 
]
  $
GetParametersFromCache
! 7
(
7 8
string
8 >
connectionString
? O
,
O P
string
Q W
procName
X `
)
` a
{
 	
return
 
SqlParameterCache
 $
.
$ %#
GetCachedParameterSet
% :
(
: ;
connectionString
; K
,
K L
procName
M U
)
U V
;
V W
}
 	
private
 
bool
 
AlreadyCached
 "
(
" #
string
# )
connectionString
* :
,
: ;
string
< B
procName
C K
)
K L
{
 	
return
   
SqlParameterCache
   $
.
  $ %"
IsParameterSetCached
  % 9
(
  9 :
connectionString
  : J
,
  J K
procName
  L T
)
  T U
;
  U V
}
¡¡ 	
public
££ 
SqlParameter
££ 
[
££ 
]
££  
DiscoverParameters
££ 0
(
££0 1
string
££1 7
connectionString
££8 H
,
££H I
string
££J P
procName
££Q Y
)
££Y Z
{
¤¤ 	
using
¥¥ 
(
¥¥ 
SqlConnection
¥¥  

connection
¥¥! +
=
¥¥, -
new
¥¥. 1
SqlConnection
¥¥2 ?
(
¥¥? @
connectionString
¥¥@ P
)
¥¥P Q
)
¥¥Q R
{
¦¦ 
using
§§ 
(
§§ 

SqlCommand
§§ !
discoveryCommand
§§" 2
=
§§3 4
new
§§5 8

SqlCommand
§§9 C
(
§§C D
)
§§D E
)
§§E F
{
¨¨ 
discoveryCommand
©© $
.
©©$ %
CommandType
©©% 0
=
©©1 2
CommandType
©©3 >
.
©©> ?
StoredProcedure
©©? N
;
©©N O
discoveryCommand
ªª $
.
ªª$ %
CommandText
ªª% 0
=
ªª1 2
procName
ªª3 ;
;
ªª; <
discoveryCommand
«« $
.
««$ %

Connection
««% /
=
««0 1

connection
««2 <
;
««< =

connection
¬¬ 
.
¬¬ 
Open
¬¬ #
(
¬¬# $
)
¬¬$ %
;
¬¬% &
SqlCommandBuilder
­­ %
.
­­% &
DeriveParameters
­­& 6
(
­­6 7
discoveryCommand
­­7 G
)
­­G H
;
­­H I
discoveryCommand
±± $
.
±±$ %

Parameters
±±% /
.
±±/ 0
RemoveAt
±±0 8
(
±±8 9
$num
±±9 :
)
±±: ;
;
±±; <
SqlParameter
³³  
[
³³  !
]
³³! "
result
³³# )
=
³³* +
new
³³, /
SqlParameter
³³0 <
[
³³< =
discoveryCommand
³³= M
.
³³M N

Parameters
³³N X
.
³³X Y
Count
³³Y ^
]
³³^ _
;
³³_ `
int
´´ 
i
´´ 
=
´´ 
$num
´´ 
;
´´ 
foreach
µµ 
(
µµ 
IDataParameter
µµ +
	parameter
µµ, 5
in
µµ6 8
discoveryCommand
µµ9 I
.
µµI J

Parameters
µµJ T
)
µµT U
{
¶¶ 
SqlParameter
·· $
cloneParameter
··% 3
=
··4 5
(
··6 7
SqlParameter
··7 C
)
··C D
(
··D E
(
··E F

ICloneable
··F P
)
··P Q
	parameter
··Q Z
)
··Z [
.
··[ \
Clone
··\ a
(
··a b
)
··b c
;
··c d
result
¸¸ 
[
¸¸ 
i
¸¸  
]
¸¸  !
=
¸¸" #
cloneParameter
¸¸$ 2
;
¸¸2 3
i
¹¹ 
+=
¹¹ 
$num
¹¹ 
;
¹¹ 
}
ºº 
return
¼¼ 
result
¼¼ !
;
¼¼! "
}
½½ 
}
¾¾ 
}
¿¿ 	
}
ÃÃ 
}ÄÄ 