éÙ
^D:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\Email.cs
	namespace 	

mojoPortal
 
. 
Net 
{ 
public 

static 
class 
Email 
{   
private"" 
static"" 
readonly"" 
ILog""  $
log""% (
="") *

LogManager""+ 5
.""5 6
	GetLogger""6 ?
(""? @
typeof""@ F
(""F G
Email""G L
)""L M
)""M N
;""N O
private## 
static## 
bool## 
debugLog## $
=##% &
log##' *
.##* +
IsDebugEnabled##+ 9
;##9 :
public%% 
const%% 
string%% 
PriorityLow%% '
=%%( )
$str%%* /
;%%/ 0
public&& 
const&& 
string&& 
PriorityNormal&& *
=&&+ ,
$str&&- 5
;&&5 6
public'' 
const'' 
string'' 
PriorityHigh'' (
='') *
$str''+ 1
;''1 2
const)) 
int)) 
SmtpAuthenticated)) #
=))$ %
$num))& '
;))' (
public.. 
static.. 
void.. 
	SendEmail.. $
(..$ %
SmtpSettings// 
smtpSettings// %
,//% &
string00 
from00 
,00 
string11 
to11 
,11 
string22 
cc22 
,22 
string33 
bcc33 
,33 
string44 
subject44 
,44 
string55 
messageBody55 
,55 
bool66 
html66 
,66 
string77 
priority77 
)77 
{88 	
if99 
(99 
to99 
==99 
$str99 '
)99' (
{99) *
return99+ 1
;991 2
}993 4
if;; 
(;; 
(;;  
ConfigurationManager;; %
.;;% &
AppSettings;;& 1
[;;1 2
$str;;2 ?
];;? @
!=;;A C
null;;D H
);;H I
&&;;I K
(;;K L 
ConfigurationManager;;L `
.;;` a
AppSettings;;a l
[;;l m
$str;;m z
];;z {
==;;| ~
$str	;; Ö
)
;;Ö Ü
)
;;Ü á
{<< 
log== 
.== 
Info== 
(== 
$str== S
)==S T
;==T U
return>> 
;>> 
}?? 
ifAA 
(AA 
(AA 
smtpSettingsAA 
==AA  
nullAA! %
)AA% &
||AA' )
(AA* +
!AA+ ,
smtpSettingsAA, 8
.AA8 9
IsValidAA9 @
)AA@ A
)AAA B
{BB 
logCC 
.CC 
ErrorCC 
(CC 
$strCC H
)CCH I
;CCI J
returnDD 
;DD 
}EE 
SendEmailNormalGG 
(GG 
smtpSettingsGG (
,GG( )
fromGG* .
,GG. /
toGG0 2
,GG2 3
ccGG4 6
,GG6 7
bccGG8 ;
,GG; <
subjectGG= D
,GGD E
messageBodyGGF Q
,GGQ R
htmlGGS W
,GGW X
priorityGGY a
)GGa b
;GGb c
returnHH 
;HH 
}KK 	
publicNN 
staticNN 
voidNN 
	SendEmailNN $
(NN$ %
SmtpSettingsOO 
smtpSettingsOO %
,OO% &
stringPP 
fromPP 
,PP 
stringQQ 
replyToQQ 
,QQ 
stringRR 
toRR 
,RR 
stringSS 
ccSS 
,SS 
stringTT 
bccTT 
,TT 
stringUU 
subjectUU 
,UU 
stringVV 
messageBodyVV 
,VV 
boolWW 
htmlWW 
,WW 
stringXX 
priorityXX 
)XX 
{YY 	
ifZZ 
(ZZ 
toZZ 
==ZZ 
$strZZ '
)ZZ' (
{ZZ) *
returnZZ+ 1
;ZZ1 2
}ZZ3 4
if\\ 
(\\ 
(\\  
ConfigurationManager\\ %
.\\% &
AppSettings\\& 1
[\\1 2
$str\\2 ?
]\\? @
!=\\A C
null\\D H
)\\H I
&&\\J L
(\\M N 
ConfigurationManager\\N b
.\\b c
AppSettings\\c n
[\\n o
$str\\o |
]\\| }
==	\\~ Ä
$str
\\Å á
)
\\á à
)
\\à â
{]] 
log^^ 
.^^ 
Info^^ 
(^^ 
$str^^ S
)^^S T
;^^T U
return__ 
;__ 
}`` 
ifbb 
(bb 
(bb 
smtpSettingsbb 
==bb  
nullbb! %
)bb% &
||bb' )
(bb* +
!bb+ ,
smtpSettingsbb, 8
.bb8 9
IsValidbb9 @
)bb@ A
)bbA B
{cc 
logdd 
.dd 
Errordd 
(dd 
$strdd H
)ddH I
;ddI J
returnee 
;ee 
}ff 
ifii 
(ii 
replyToii 
.ii 
Lengthii 
>ii  
$numii! "
)ii" #
{jj 
SendEmailNormalkk 
(kk  
smtpSettingsll  
,ll  !
frommm 
,mm 
replyTonn 
,nn 
tooo 
,oo 
ccpp 
,pp 
bccqq 
,qq 
subjectrr 
,rr 
messageBodyss 
,ss  
htmltt 
,tt 
priorityuu 
)uu 
;uu 
returnww 
;ww 
}xx 
	SendEmailzz 
(zz 
smtpSettings{{ 
,{{ 
from|| 
,|| 
to}} 
,}} 
cc~~ 
,~~ 
bcc 
, 
subject
ÄÄ 
,
ÄÄ 
messageBody
ÅÅ 
,
ÅÅ 
html
ÇÇ 
,
ÇÇ 
priority
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÖÖ 	
public
ìì 
static
ìì 
void
ìì 
SendEmailNormal
ìì *
(
ìì* +
SmtpSettings
îî 
smtpSettings
îî %
,
îî% &
string
ïï 
from
ïï 
,
ïï 
string
ññ 
to
ññ 
,
ññ 
string
óó 
cc
óó 
,
óó 
string
òò 
bcc
òò 
,
òò 
string
ôô 
subject
ôô 
,
ôô 
string
öö 
messageBody
öö 
,
öö 
bool
õõ 
html
õõ 
,
õõ 
string
úú 
priority
úú 
)
úú 
{
ùù 	
if
ûû 
(
ûû 
to
ûû 
==
ûû 
$str
ûû '
)
ûû' (
{
ûû) *
return
ûû+ 1
;
ûû1 2
}
ûû3 4
if
†† 
(
†† 
(
†† "
ConfigurationManager
†† %
.
††% &
AppSettings
††& 1
[
††1 2
$str
††2 ?
]
††? @
!=
††A C
null
††D H
)
††H I
&&
††J L
(
††M N"
ConfigurationManager
††N b
.
††b c
AppSettings
††c n
[
††n o
$str
††o |
]
††| }
==††~ Ä
$str††Å á
)††á à
)††à â
{
°° 
log
¢¢ 
.
¢¢ 
Info
¢¢ 
(
¢¢ 
$str
¢¢ S
)
¢¢S T
;
¢¢T U
return
££ 
;
££ 
}
§§ 
string
¶¶ 
replyTo
¶¶ 
=
¶¶ 
string
¶¶ #
.
¶¶# $
Empty
¶¶$ )
;
¶¶) *
SendEmailNormal
ßß 
(
ßß 
smtpSettings
®® 
,
®® 
from
©© 
,
©© 
replyTo
™™ 
,
™™ 
to
´´ 
,
´´ 
cc
¨¨ 
,
¨¨ 
bcc
≠≠ 
,
≠≠ 
subject
ÆÆ 
,
ÆÆ 
messageBody
ØØ 
,
ØØ 
html
∞∞ 
,
∞∞ 
priority
±± 
)
±± 
;
±± 
}
≥≥ 	
public
¬¬ 
static
¬¬ 
void
¬¬ 
SendEmailNormal
¬¬ *
(
¬¬* +
SmtpSettings
√√ 
smtpSettings
√√ %
,
√√% &
string
ƒƒ 
from
ƒƒ 
,
ƒƒ 
string
≈≈ 
replyTo
≈≈ 
,
≈≈ 
string
∆∆ 
to
∆∆ 
,
∆∆ 
string
«« 
cc
«« 
,
«« 
string
»» 
bcc
»» 
,
»» 
string
…… 
subject
…… 
,
…… 
string
   
messageBody
   
,
   
bool
ÀÀ 
html
ÀÀ 
,
ÀÀ 
string
ÃÃ 
priority
ÃÃ 
)
ÃÃ 
{
ÕÕ 	
if
ŒŒ 
(
ŒŒ 
to
ŒŒ 
==
ŒŒ 
$str
ŒŒ '
)
ŒŒ' (
{
ŒŒ) *
return
ŒŒ+ 1
;
ŒŒ1 2
}
ŒŒ3 4
if
–– 
(
–– 
(
–– "
ConfigurationManager
–– %
.
––% &
AppSettings
––& 1
[
––1 2
$str
––2 ?
]
––? @
!=
––A C
null
––D H
)
––H I
&&
––J L
(
––M N"
ConfigurationManager
––N b
.
––b c
AppSettings
––c n
[
––n o
$str
––o |
]
––| }
==––~ Ä
$str––Å á
)––á à
)––à â
{
—— 
log
““ 
.
““ 
Info
““ 
(
““ 
$str
““ S
)
““S T
;
““T U
return
”” 
;
”” 
}
‘‘ 
string
÷÷ 
[
÷÷ 
]
÷÷ 
attachmentPaths
÷÷ $
=
÷÷% &
new
÷÷' *
string
÷÷+ 1
[
÷÷1 2
$num
÷÷2 3
]
÷÷3 4
;
÷÷4 5
string
◊◊ 
[
◊◊ 
]
◊◊ 
attachmentNames
◊◊ $
=
◊◊% &
new
◊◊' *
string
◊◊+ 1
[
◊◊1 2
$num
◊◊2 3
]
◊◊3 4
;
◊◊4 5
SendEmailNormal
ŸŸ 
(
ŸŸ 
smtpSettings
⁄⁄ 
,
⁄⁄ 
from
€€ 
,
€€ 
replyTo
‹‹ 
,
‹‹ 
to
›› 
,
›› 
cc
ﬁﬁ 
,
ﬁﬁ 
bcc
ﬂﬂ 
,
ﬂﬂ 
subject
‡‡ 
,
‡‡ 
messageBody
·· 
,
·· 
html
‚‚ 
,
‚‚ 
priority
„„ 
,
„„ 
attachmentPaths
‰‰ 
,
‰‰  
attachmentNames
ÂÂ 
)
ÂÂ  
;
ÂÂ  !
}
ÈÈ 	
public
˙˙ 
static
˙˙ 
void
˙˙ 
SendEmailNormal
˙˙ *
(
˙˙* +
SmtpSettings
˚˚ 
smtpSettings
˚˚ %
,
˚˚% &
string
¸¸ 
from
¸¸ 
,
¸¸ 
string
˝˝ 
replyTo
˝˝ 
,
˝˝ 
string
˛˛ 
to
˛˛ 
,
˛˛ 
string
ˇˇ 
cc
ˇˇ 
,
ˇˇ 
string
ÄÄ 
bcc
ÄÄ 
,
ÄÄ 
string
ÅÅ 
subject
ÅÅ 
,
ÅÅ 
string
ÇÇ 
messageBody
ÇÇ 
,
ÇÇ 
bool
ÉÉ 
html
ÉÉ 
,
ÉÉ 
string
ÑÑ 
priority
ÑÑ 
,
ÑÑ 
string
ÖÖ 
[
ÖÖ 
]
ÖÖ 
attachmentPaths
ÖÖ $
,
ÖÖ$ %
string
ÜÜ 
[
ÜÜ 
]
ÜÜ 
attachmentNames
ÜÜ $
)
ÜÜ$ %
{
áá 	
if
àà 
(
àà 
to
àà 
==
àà 
$str
àà '
)
àà' (
{
àà) *
return
àà+ 1
;
àà1 2
}
àà3 4
Send
ää 
(
ää 
smtpSettings
ää 
,
ää 
from
ãã 
,
ãã 
replyTo
åå 
,
åå 
to
çç 
,
çç 
cc
éé 
,
éé 
bcc
èè 
,
èè 
subject
êê 
,
êê 
messageBody
ëë 
,
ëë 
html
íí 
,
íí 
priority
ìì 
,
ìì 
attachmentPaths
îî 
,
îî  
attachmentNames
ïï 
)
ïï  
;
ïï  !
}
óó 	
public
ôô 
static
ôô 
void
ôô  
SetMessageEncoding
ôô -
(
ôô- .
SmtpSettings
ôô. :
smtpSettings
ôô; G
,
ôôG H
MailMessage
ôôI T
mail
ôôU Y
)
ôôY Z
{
öö 	
if
ùù 
(
ùù 
smtpSettings
ùù 
.
ùù 
PreferredEncoding
ùù .
.
ùù. /
Length
ùù/ 5
>
ùù6 7
$num
ùù8 9
)
ùù9 :
{
ûû 
switch
üü 
(
üü 
smtpSettings
üü $
.
üü$ %
PreferredEncoding
üü% 6
)
üü6 7
{
†† 
case
°° 
$str
°°  
:
°°  !
case
¢¢ 
$str
¢¢ #
:
¢¢# $
break
§§ 
;
§§ 
case
¶¶ 
$str
¶¶  
:
¶¶  !
case
ßß 
$str
ßß !
:
ßß! "
mail
©© 
.
©© 
BodyEncoding
©© )
=
©©* +
Encoding
©©, 4
.
©©4 5
UTF32
©©5 :
;
©©: ;
mail
™™ 
.
™™ 
SubjectEncoding
™™ ,
=
™™- .
Encoding
™™/ 7
.
™™7 8
UTF32
™™8 =
;
™™= >
break
¨¨ 
;
¨¨ 
case
ÆÆ 
$str
ÆÆ "
:
ÆÆ" #
mail
∞∞ 
.
∞∞ 
BodyEncoding
∞∞ )
=
∞∞* +
Encoding
∞∞, 4
.
∞∞4 5
Unicode
∞∞5 <
;
∞∞< =
mail
±± 
.
±± 
SubjectEncoding
±± ,
=
±±- .
Encoding
±±/ 7
.
±±7 8
Unicode
±±8 ?
;
±±? @
break
≥≥ 
;
≥≥ 
case
µµ 
$str
µµ 
:
µµ  
case
∂∂ 
$str
∂∂  
:
∂∂  !
mail
∏∏ 
.
∏∏ 
BodyEncoding
∏∏ )
=
∏∏* +
Encoding
∏∏, 4
.
∏∏4 5
UTF8
∏∏5 9
;
∏∏9 :
mail
ππ 
.
ππ 
SubjectEncoding
ππ ,
=
ππ- .
Encoding
ππ/ 7
.
ππ7 8
UTF8
ππ8 <
;
ππ< =
break
ªª 
;
ªª 
default
ΩΩ 
:
ΩΩ 
try
øø 
{
¿¿ 
mail
¡¡  
.
¡¡  !
BodyEncoding
¡¡! -
=
¡¡. /
Encoding
¡¡0 8
.
¡¡8 9
GetEncoding
¡¡9 D
(
¡¡D E
smtpSettings
¡¡E Q
.
¡¡Q R
PreferredEncoding
¡¡R c
)
¡¡c d
;
¡¡d e
mail
¬¬  
.
¬¬  !
SubjectEncoding
¬¬! 0
=
¬¬1 2
Encoding
¬¬3 ;
.
¬¬; <
GetEncoding
¬¬< G
(
¬¬G H
smtpSettings
¬¬H T
.
¬¬T U
PreferredEncoding
¬¬U f
)
¬¬f g
;
¬¬g h
}
√√ 
catch
ƒƒ 
(
ƒƒ 
ArgumentException
ƒƒ 0
ex
ƒƒ1 3
)
ƒƒ3 4
{
≈≈ 
log
∆∆ 
.
∆∆  
Error
∆∆  %
(
∆∆% &
ex
∆∆& (
)
∆∆( )
;
∆∆) *
}
«« 
break
…… 
;
…… 
}
   
}
ÃÃ 
}
ŒŒ 	
public
ﬂﬂ 
static
ﬂﬂ 
bool
ﬂﬂ 
Send
ﬂﬂ 
(
ﬂﬂ  
SmtpSettings
‡‡ 
smtpSettings
‡‡ %
,
‡‡% &
string
·· 
from
·· 
,
·· 
string
‚‚ 
replyTo
‚‚ 
,
‚‚ 
string
„„ 
to
„„ 
,
„„ 
string
‰‰ 
cc
‰‰ 
,
‰‰ 
string
ÂÂ 
bcc
ÂÂ 
,
ÂÂ 
string
ÊÊ 
subject
ÊÊ 
,
ÊÊ 
string
ÁÁ 
messageBody
ÁÁ 
,
ÁÁ 
bool
ËË 
html
ËË 
,
ËË 
string
ÈÈ 
priority
ÈÈ 
,
ÈÈ 
string
ÍÍ 
[
ÍÍ 
]
ÍÍ 
attachmentPaths
ÍÍ $
,
ÍÍ$ %
string
ÎÎ 
[
ÎÎ 
]
ÎÎ 
attachmentNames
ÎÎ $
)
ÎÎ$ %
{
ÏÏ 	
if
ÌÌ 
(
ÌÌ 
to
ÌÌ 
==
ÌÌ 
$str
ÌÌ '
)
ÌÌ' (
{
ÌÌ) *
return
ÌÌ+ 1
false
ÌÌ2 7
;
ÌÌ7 8
}
ÌÌ9 :
string
ÔÔ 
	fromAlias
ÔÔ 
=
ÔÔ 
string
ÔÔ %
.
ÔÔ% &
Empty
ÔÔ& +
;
ÔÔ+ ,
return
 
Send
 
(
 
smtpSettings
ÒÒ 
,
ÒÒ 
from
ÚÚ 
,
ÚÚ 
	fromAlias
ÛÛ 
,
ÛÛ 
replyTo
ÙÙ 
,
ÙÙ 
to
ıı 
,
ıı 
cc
ˆˆ 
,
ˆˆ 
bcc
˜˜ 
,
˜˜ 
subject
¯¯ 
,
¯¯ 
messageBody
˘˘ 
,
˘˘ 
html
˙˙ 
,
˙˙ 
priority
˚˚ 
,
˚˚ 
attachmentPaths
¸¸ 
,
¸¸  
attachmentNames
˝˝ 
)
˝˝  
;
˝˝  !
}
ˇˇ 	
public
ÄÄ 
static
ÄÄ	 
bool
ÄÄ 
Send
ÄÄ 
(
ÄÄ 
SmtpSettings
ÅÅ 
smtpSettings
ÅÅ 
,
ÅÅ 
string
ÇÇ 	
from
ÇÇ
 
,
ÇÇ 
string
ÉÉ 	
	fromAlias
ÉÉ
 
,
ÉÉ 
string
ÑÑ 	
replyTo
ÑÑ
 
,
ÑÑ 
string
ÖÖ 	
to
ÖÖ
 
,
ÖÖ 
string
ÜÜ 	
cc
ÜÜ
 
,
ÜÜ 
string
áá 	
bcc
áá
 
,
áá 
string
àà 	
subject
àà
 
,
àà 
string
ââ 	
messageBody
ââ
 
,
ââ 
bool
ää 
html
ää 
,
ää 
string
ãã 	
priority
ãã
 
)
ãã 
{
åå 
return
çç 	
Send
çç
 
(
çç 
smtpSettings
çç 
,
çç 
from
çç !
,
çç! "
	fromAlias
çç# ,
,
çç, -
replyTo
çç. 5
,
çç5 6
to
çç7 9
,
çç9 :
cc
çç; =
,
çç= >
bcc
çç? B
,
ççB C
subject
ççD K
,
ççK L
messageBody
ççM X
,
ççX Y
html
ççZ ^
,
çç^ _
priority
çç` h
,
ççh i
out
ççj m
_
ççn o
)
çço p
;
ççp q
}
éé 
public
ëë 
static
ëë	 
bool
ëë 
Send
ëë 
(
ëë 
SmtpSettings
íí 
smtpSettings
íí %
,
íí% &
string
ìì 
from
ìì 
,
ìì 
string
îî 
	fromAlias
îî 
,
îî 
string
ïï 
replyTo
ïï 
,
ïï 
string
ññ 
to
ññ 
,
ññ 
string
óó 
cc
óó 
,
óó 
string
òò 
bcc
òò 
,
òò 
string
ôô 
subject
ôô 
,
ôô 
string
öö 
messageBody
öö 
,
öö 
bool
õõ 
html
õõ 
,
õõ 
string
úú 
priority
úú 
,
úú 
out
ùù 
string
ùù 
result
ùù 
)
ùù 
{
ûû 	
if
üü 
(
üü 
to
üü 
==
üü 
$str
üü '
)
üü' (
{
üü) *
result
°° 

=
°° 
$str
°° 6
;
°°6 7
return
¢¢ 

false
¢¢ 
;
¢¢ 
}
££ 
string
•• 
[
•• 
]
•• 
attachmentPaths
•• $
=
••% &
new
••' *
string
••+ 1
[
••1 2
$num
••2 3
]
••3 4
;
••4 5
string
¶¶ 
[
¶¶ 
]
¶¶ 
attachmentNames
¶¶ $
=
¶¶% &
new
¶¶' *
string
¶¶+ 1
[
¶¶1 2
$num
¶¶2 3
]
¶¶3 4
;
¶¶4 5
return
®® 
Send
®® 
(
®® 
smtpSettings
©© 
,
©© 
from
™™ 
,
™™ 
	fromAlias
´´ 
,
´´ 
replyTo
¨¨ 
,
¨¨ 
to
≠≠ 
,
≠≠ 
cc
ÆÆ 
,
ÆÆ 
bcc
ØØ 
,
ØØ 
subject
∞∞ 
,
∞∞ 
messageBody
±± 
,
±± 
html
≤≤ 
,
≤≤ 
priority
≥≥ 
,
≥≥ 
attachmentPaths
¥¥ 
,
¥¥  
attachmentNames
µµ 
,
µµ  
out
∂∂ 
result
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 	
public
ππ 
static
ππ	 
bool
ππ 
Send
ππ 
(
ππ 
SmtpSettings
∫∫ 
smtpSettings
∫∫ 
,
∫∫ 
string
ªª 	
from
ªª
 
,
ªª 
string
ºº 	
	fromAlias
ºº
 
,
ºº 
string
ΩΩ 	
replyTo
ΩΩ
 
,
ΩΩ 
string
ææ 	
to
ææ
 
,
ææ 
string
øø 	
cc
øø
 
,
øø 
string
¿¿ 	
bcc
¿¿
 
,
¿¿ 
string
¡¡ 	
subject
¡¡
 
,
¡¡ 
string
¬¬ 	
messageBody
¬¬
 
,
¬¬ 
bool
√√ 
html
√√ 
,
√√ 
string
ƒƒ 	
priority
ƒƒ
 
,
ƒƒ 
string
≈≈ 	
[
≈≈	 

]
≈≈
 
attachmentPaths
≈≈ 
,
≈≈ 
string
∆∆ 	
[
∆∆	 

]
∆∆
 
attachmentNames
∆∆ 
)
∆∆ 
{
«« 
return
»» 	
Send
»»
 
(
»» 
smtpSettings
»» 
,
»» 
from
…… 
,
…… 	
	fromAlias
   
,
   
replyTo
ÀÀ 
,
ÀÀ 
to
ÃÃ 
,
ÃÃ 
cc
ÕÕ 
,
ÕÕ 
bcc
ŒŒ 
,
ŒŒ 
subject
œœ 
,
œœ 
messageBody
–– 
,
–– 
html
—— 
,
—— 	
priority
““ 
,
““ 
attachmentPaths
”” 
,
”” 
attachmentNames
‘‘ 
,
‘‘ 
out
’’ 
_
’’ 	
)
’’	 

;
’’
 
}
÷÷ 
public
€€ 
static
€€	 
bool
€€ 
Send
€€ 
(
€€ 
SmtpSettings
‹‹ 
smtpSettings
‹‹ %
,
‹‹% &
string
›› 
from
›› 
,
›› 
string
ﬁﬁ 
	fromAlias
ﬁﬁ 
,
ﬁﬁ 
string
ﬂﬂ 
replyTo
ﬂﬂ 
,
ﬂﬂ 
string
‡‡ 
to
‡‡ 
,
‡‡ 
string
·· 
cc
·· 
,
·· 
string
‚‚ 
bcc
‚‚ 
,
‚‚ 
string
„„ 
subject
„„ 
,
„„ 
string
‰‰ 
messageBody
‰‰ 
,
‰‰ 
bool
ÂÂ 
html
ÂÂ 
,
ÂÂ 
string
ÊÊ 
priority
ÊÊ 
,
ÊÊ 
string
ÁÁ 
[
ÁÁ 
]
ÁÁ 
attachmentPaths
ÁÁ $
,
ÁÁ$ %
string
ËË 
[
ËË 
]
ËË 
attachmentNames
ËË $
,
ËË$ %
out
ÈÈ 
string
ÈÈ 
result
ÈÈ 
)
ÈÈ 
{
ÍÍ 	
List
ÌÌ 
<
ÌÌ 

Attachment
ÌÌ 
>
ÌÌ  
attachments
ÌÌ! ,
=
ÌÌ- .
new
ÌÌ/ 2
List
ÌÌ3 7
<
ÌÌ7 8

Attachment
ÌÌ8 B
>
ÌÌB C
(
ÌÌC D
)
ÌÌD E
;
ÌÌE F
if
ÓÓ 
(
ÓÓ 
(
ÓÓ 
attachmentPaths
ÓÓ $
.
ÓÓ$ %
Length
ÓÓ% +
>
ÓÓ, -
$num
ÓÓ. /
)
ÓÓ/ 0
&&
ÓÓ1 3
(
ÓÓ4 5
attachmentNames
ÓÓ5 D
.
ÓÓD E
Length
ÓÓE K
==
ÓÓL N
attachmentPaths
ÓÓO ^
.
ÓÓ^ _
Length
ÓÓ_ e
)
ÓÓe f
)
ÓÓf g
{
ÔÔ 
for
 
(
 
int
 
i
 
=
  
$num
! "
;
" #
i
$ %
<
& '
attachmentPaths
( 7
.
7 8
Length
8 >
;
> ?
i
@ A
++
A C
)
C D
{
ÒÒ 
if
ÚÚ 
(
ÚÚ 
!
ÚÚ 
File
ÚÚ !
.
ÚÚ! "
Exists
ÚÚ" (
(
ÚÚ( )
attachmentPaths
ÚÚ) 8
[
ÚÚ8 9
i
ÚÚ9 :
]
ÚÚ: ;
)
ÚÚ; <
)
ÚÚ< =
{
ÛÛ 
log
ÙÙ 
.
ÙÙ  
Error
ÙÙ  %
(
ÙÙ% &
$str
ÙÙ& Q
+
ÙÙR S
attachmentPaths
ÙÙT c
[
ÙÙc d
i
ÙÙd e
]
ÙÙe f
)
ÙÙf g
;
ÙÙg h
continue
ıı $
;
ıı$ %
}
ˆˆ 

Attachment
¯¯ "
a
¯¯# $
=
¯¯% &
new
¯¯' *

Attachment
¯¯+ 5
(
¯¯5 6
attachmentPaths
¯¯6 E
[
¯¯E F
i
¯¯F G
]
¯¯G H
)
¯¯H I
;
¯¯I J
a
˘˘ 
.
˘˘ 
Name
˘˘ 
=
˘˘  
attachmentNames
˘˘! 0
[
˘˘0 1
i
˘˘1 2
]
˘˘2 3
;
˘˘3 4
attachments
˚˚ #
.
˚˚# $
Add
˚˚$ '
(
˚˚' (
a
˚˚( )
)
˚˚) *
;
˚˚* +
}
˝˝ 
}
ˇˇ 
return
ÅÅ 
Send
ÅÅ 
(
ÅÅ 
smtpSettings
ÇÇ  
,
ÇÇ  !
from
ÉÉ 
,
ÉÉ 
	fromAlias
ÑÑ 
,
ÑÑ 
replyTo
ÖÖ 
,
ÖÖ 
to
ÜÜ 
,
ÜÜ 
cc
áá 
,
áá 
bcc
àà 
,
àà 
subject
ââ 
,
ââ 
messageBody
ää 
,
ää  
html
ãã 
,
ãã 
priority
åå 
,
åå 
attachments
çç 
,
çç  
out
éé 
result
éé	 
)
éé 
;
éé 
}
ëë 	
public
íí 
static
íí	 
bool
íí 
Send
íí 
(
íí 
SmtpSettings
ìì 
smtpSettings
ìì 
,
ìì 
string
îî 	
from
îî
 
,
îî 
string
ïï 	
	fromAlias
ïï
 
,
ïï 
string
ññ 	
replyTo
ññ
 
,
ññ 
string
óó 	
to
óó
 
,
óó 
string
òò 	
cc
òò
 
,
òò 
string
ôô 	
bcc
ôô
 
,
ôô 
string
öö 	
subject
öö
 
,
öö 
string
õõ 	
messageBody
õõ
 
,
õõ 
bool
úú 
html
úú 
,
úú 
string
ùù 	
priority
ùù
 
,
ùù 
List
ûû 
<
ûû 

Attachment
ûû 
>
ûû 
attachments
ûû 
)
ûû  
{
üü 
return
†† 	
Send
††
 
(
†† 
smtpSettings
†† 
,
†† 
from
†† !
,
††! "
	fromAlias
††# ,
,
††, -
replyTo
††. 5
,
††5 6
to
††7 9
,
††9 :
cc
††; =
,
††= >
bcc
††? B
,
††B C
subject
††D K
,
††K L
messageBody
††M X
,
††X Y
html
††Z ^
,
††^ _
priority
††` h
,
††h i
attachments
††j u
,
††u v
out
††w z
_
††{ |
)
††| }
;
††} ~
}
°° 
public
££ 
static
££	 
bool
££ 
Send
££ 
(
££ 
SmtpSettings
§§ 
smtpSettings
§§ %
,
§§% &
string
•• 
from
•• 
,
•• 
string
¶¶ 
	fromAlias
¶¶ 
,
¶¶ 
string
ßß 
replyTo
ßß 
,
ßß 
string
®® 
to
®® 
,
®® 
string
©© 
cc
©© 
,
©© 
string
™™ 
bcc
™™ 
,
™™ 
string
´´ 
subject
´´ 
,
´´ 
string
¨¨ 
messageBody
¨¨ 
,
¨¨ 
bool
≠≠ 
html
≠≠ 
,
≠≠ 
string
ÆÆ 
priority
ÆÆ 
,
ÆÆ 
List
ØØ 
<
ØØ 

Attachment
ØØ 
>
ØØ 
attachments
ØØ (
,
ØØ( )
out
∞∞ 
string
∞∞ 
result
∞∞ 
)
∞∞ 
{
±± 	
if
≤≤ 
(
≤≤ 
to
≤≤ 
==
≤≤ 
$str
≤≤ '
)
≤≤' (
{
≤≤) *
result
¥¥ 

=
¥¥ 
$str
¥¥ 6
;
¥¥6 7
return
µµ 

false
µµ 
;
µµ 
}
∂∂ 
if
∏∏ 
(
∏∏ 
(
∏∏ "
ConfigurationManager
∏∏ %
.
∏∏% &
AppSettings
∏∏& 1
[
∏∏1 2
$str
∏∏2 ?
]
∏∏? @
!=
∏∏A C
null
∏∏D H
)
∏∏H I
&&
∏∏J L
(
∏∏M N"
ConfigurationManager
∏∏N b
.
∏∏b c
AppSettings
∏∏c n
[
∏∏n o
$str
∏∏o |
]
∏∏| }
==∏∏~ Ä
$str∏∏Å á
)∏∏á à
)∏∏à â
{
ππ 
result
∫∫ 

=
∫∫ 
$str
∫∫ G
;
∫∫G H
log
ªª 
.
ªª 
Info
ªª 
(
ªª 
result
ªª 
)
ªª  
;
ªª  !
return
ºº 

false
ºº 
;
ºº 
}
ΩΩ 
if
øø 
(
øø 
(
øø 
smtpSettings
øø 
==
øø  
null
øø! %
)
øø% &
||
øø' )
(
øø* +
!
øø+ ,
smtpSettings
øø, 8
.
øø8 9
IsValid
øø9 @
)
øø@ A
)
øøA B
{
¿¿ 
result
¡¡ 

=
¡¡ 
$str
¡¡ <
;
¡¡< =
log
¬¬ 
.
¬¬ 
Error
¬¬ 
(
¬¬ 
result
¬¬ 
)
¬¬ 
;
¬¬ 
return
√√ 
false
√√ 
;
√√ 
}
ƒƒ 
if
∆∆ 
(
∆∆ 
debugLog
∆∆ 
)
∆∆ 
log
∆∆ 
.
∆∆ 
Debug
∆∆ #
(
∆∆# $
$"
∆∆$ &
In Email.Send(
∆∆& 4
{
∆∆4 5
from
∆∆5 9
}
∆∆9 :
, 
∆∆: <
{
∆∆< =
to
∆∆= ?
}
∆∆? @
, 
∆∆@ B
{
∆∆B C
cc
∆∆C E
}
∆∆E F
, 
∆∆F H
{
∆∆H I
bcc
∆∆I L
}
∆∆L M
, 
∆∆M O
{
∆∆O P
subject
∆∆P W
}
∆∆W X
, 
∆∆X Z
{
∆∆Z [
messageBody
∆∆[ f
}
∆∆f g
, 
∆∆g i
{
∆∆i j
html
∆∆j n
}
∆∆n o
, 
∆∆o q
{
∆∆q r
priority
∆∆r z
}
∆∆z {
)
∆∆{ |
"
∆∆| }
)
∆∆} ~
;
∆∆~ 
using
»» 
(
»» 
MailMessage
»» 
mail
»» #
=
»»$ %
new
»»& )
MailMessage
»»* 5
(
»»5 6
)
»»6 7
)
»»7 8
{
……  
SetMessageEncoding
   "
(
  " #
smtpSettings
  # /
,
  / 0
mail
  1 5
)
  5 6
;
  6 7
MailAddress
ÕÕ 
fromAddress
ÕÕ '
;
ÕÕ' (
try
ŒŒ 
{
œœ 
if
–– 
(
–– 
	fromAlias
–– !
.
––! "
Length
––" (
>
––) *
$num
––+ ,
)
––, -
{
—— 
fromAddress
““ #
=
““$ %
new
““& )
MailAddress
““* 5
(
““5 6
from
““6 :
,
““: ;
	fromAlias
““< E
)
““E F
;
““F G
}
”” 
else
‘‘ 
{
’’ 
fromAddress
÷÷ #
=
÷÷$ %
new
÷÷& )
MailAddress
÷÷* 5
(
÷÷5 6
from
÷÷6 :
)
÷÷: ;
;
÷÷; <
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
ArgumentException
ŸŸ (
)
ŸŸ( )
{
⁄⁄ 
result
€€ 
=
€€ 
$"
€€ #
invalid from address 
€€ %
{
€€% &
from
€€& *
}
€€* +
"
€€+ ,
;
€€, -
log
‹‹ 
.
‹‹ 
Error
‹‹ 
(
‹‹ 
result
‹‹ $
)
‹‹$ %
;
‹‹% &
log
›› 
.
›› 
Info
›› 
(
›› 
$str
›› Y
+
››Z [
messageBody
››\ g
)
››g h
;
››h i
return
ﬁﬁ 
false
ﬁﬁ  
;
ﬁﬁ  !
}
ﬂﬂ 
catch
‡‡ 
(
‡‡ 
FormatException
‡‡ &
)
‡‡& '
{
·· 
result
‚‚ 
=
‚‚ 
$"
‚‚ #
invalid from address 
‚‚ %
{
‚‚% &
from
‚‚& *
}
‚‚* +
"
‚‚+ ,
;
‚‚, -
log
„„ 
.
„„ 	
Error
„„	 
(
„„ 
result
„„ 
)
„„ 
;
„„ 
log
‰‰ 
.
‰‰ 	
Info
‰‰	 
(
‰‰ 
$str
‰‰ J
+
‰‰K L
messageBody
‰‰M X
)
‰‰X Y
;
‰‰Y Z
return
ÂÂ 
false
ÂÂ  
;
ÂÂ  !
}
ÊÊ 
mail
ËË 
.
ËË 
From
ËË 
=
ËË 
fromAddress
ËË '
;
ËË' (
List
ÍÍ 
<
ÍÍ 
string
ÍÍ 
>
ÍÍ 
toAddresses
ÍÍ (
=
ÍÍ) *
to
ÍÍ+ -
.
ÍÍ- .
Replace
ÍÍ. 5
(
ÍÍ5 6
$str
ÍÍ6 9
,
ÍÍ9 :
$str
ÍÍ; >
)
ÍÍ> ?
.
ÍÍ? @
SplitOnChar
ÍÍ@ K
(
ÍÍK L
$char
ÍÍL O
)
ÍÍO P
;
ÍÍP Q
foreach
ÎÎ 
(
ÎÎ 
string
ÎÎ 
	toAddress
ÎÎ  )
in
ÎÎ* ,
toAddresses
ÎÎ- 8
)
ÎÎ8 9
{
ÏÏ 
try
ÌÌ 
{
ÓÓ 
MailAddress
ÔÔ #
a
ÔÔ$ %
=
ÔÔ& '
new
ÔÔ( +
MailAddress
ÔÔ, 7
(
ÔÔ7 8
	toAddress
ÔÔ8 A
)
ÔÔA B
;
ÔÔB C
mail
 
.
 
To
 
.
  
Add
  #
(
# $
a
$ %
)
% &
;
& '
}
ÒÒ 
catch
ÚÚ 
(
ÚÚ 
ArgumentException
ÚÚ ,
)
ÚÚ, -
{
ÛÛ 
log
ÙÙ 
.
ÙÙ 
Error
ÙÙ !
(
ÙÙ! "
$str
ÙÙ" @
+
ÙÙA B
	toAddress
ÙÙC L
)
ÙÙL M
;
ÙÙM N
}
ıı 
catch
ˆˆ 
(
ˆˆ 
FormatException
ˆˆ *
)
ˆˆ* +
{
˜˜ 
log
¯¯ 
.
¯¯ 
Error
¯¯ !
(
¯¯! "
$str
¯¯" @
+
¯¯A B
	toAddress
¯¯C L
)
¯¯L M
;
¯¯M N
}
˘˘ 
}
˚˚ 
if
˝˝ 
(
˝˝ 
mail
˝˝ 
.
˝˝ 
To
˝˝ 
.
˝˝ 
Count
˝˝ !
==
˝˝" $
$num
˝˝% &
)
˝˝& '
{
˛˛ 
result
ˇˇ 
=
ˇˇ 
$"
ˇˇ F
8no valid to address was provided so not sending message 
ˇˇ H
{
ˇˇH I
messageBody
ˇˇI T
}
ˇˇT U
"
ˇˇU V
;
ˇˇV W
log
ÄÄ 
.
ÄÄ 	
Error
ÄÄ	 
(
ÄÄ 
result
ÄÄ 
)
ÄÄ 
;
ÄÄ 
return
ÅÅ 
false
ÅÅ  
;
ÅÅ  !
}
ÇÇ 
if
ÑÑ 
(
ÑÑ 
replyTo
ÑÑ 
.
ÑÑ 
Length
ÑÑ "
>
ÑÑ# $
$num
ÑÑ% &
)
ÑÑ& '
{
ÖÖ 
try
ÜÜ 
{
áá 
MailAddress
àà #
replyAddress
àà$ 0
=
àà1 2
new
àà3 6
MailAddress
àà7 B
(
ààB C
replyTo
ààC J
)
ààJ K
;
ààK L
mail
ââ 
.
ââ 
ReplyTo
ââ $
=
ââ% &
replyAddress
ââ' 3
;
ââ3 4
}
ää 
catch
ãã 
(
ãã 
ArgumentException
ãã ,
)
ãã, -
{
åå 
log
çç 
.
çç 
Error
çç !
(
çç! "
$str
çç" E
+
ççF G
replyTo
ççH O
)
ççO P
;
ççP Q
}
éé 
catch
èè 
(
èè 
FormatException
èè *
)
èè* +
{
êê 
log
ëë 
.
ëë 
Error
ëë !
(
ëë! "
$str
ëë" E
+
ëëF G
replyTo
ëëH O
)
ëëO P
;
ëëP Q
}
íí 
}
ìì 
if
ïï 
(
ïï 
cc
ïï 
.
ïï 
Length
ïï 
>
ïï 
$num
ïï  !
)
ïï! "
{
ññ 
List
óó 
<
óó 
string
óó 
>
óó  
ccAddresses
óó! ,
=
óó- .
cc
óó/ 1
.
óó1 2
Replace
óó2 9
(
óó9 :
$str
óó: =
,
óó= >
$str
óó? B
)
óóB C
.
óóC D
SplitOnChar
óóD O
(
óóO P
$char
óóP S
)
óóS T
;
óóT U
foreach
ôô 
(
ôô 
string
ôô #
	ccAddress
ôô$ -
in
ôô. 0
ccAddresses
ôô1 <
)
ôô< =
{
öö 
try
õõ 
{
úú 
MailAddress
ùù '
a
ùù( )
=
ùù* +
new
ùù, /
MailAddress
ùù0 ;
(
ùù; <
	ccAddress
ùù< E
)
ùùE F
;
ùùF G
mail
ûû  
.
ûû  !
CC
ûû! #
.
ûû# $
Add
ûû$ '
(
ûû' (
a
ûû( )
)
ûû) *
;
ûû* +
}
üü 
catch
†† 
(
†† 
ArgumentException
†† 0
)
††0 1
{
°° 
log
¢¢ 
.
¢¢  
Error
¢¢  %
(
¢¢% &
$str
¢¢& D
+
¢¢E F
	ccAddress
¢¢G P
)
¢¢P Q
;
¢¢Q R
}
££ 
catch
§§ 
(
§§ 
FormatException
§§ .
)
§§. /
{
•• 
log
¶¶ 
.
¶¶  
Error
¶¶  %
(
¶¶% &
$str
¶¶& D
+
¶¶E F
	ccAddress
¶¶G P
)
¶¶P Q
;
¶¶Q R
}
ßß 
}
®® 
}
™™ 
if
¨¨ 
(
¨¨ 
bcc
¨¨ 
.
¨¨ 
Length
¨¨ 
>
¨¨  
$num
¨¨! "
)
¨¨" #
{
≠≠ 
List
ÆÆ 
<
ÆÆ 
string
ÆÆ 
>
ÆÆ  
bccAddresses
ÆÆ! -
=
ÆÆ. /
bcc
ÆÆ0 3
.
ÆÆ3 4
Replace
ÆÆ4 ;
(
ÆÆ; <
$str
ÆÆ< ?
,
ÆÆ? @
$str
ÆÆA D
)
ÆÆD E
.
ÆÆE F
SplitOnChar
ÆÆF Q
(
ÆÆQ R
$char
ÆÆR U
)
ÆÆU V
;
ÆÆV W
foreach
∞∞ 
(
∞∞ 
string
∞∞ #

bccAddress
∞∞$ .
in
∞∞/ 1
bccAddresses
∞∞2 >
)
∞∞> ?
{
±± 
try
≤≤ 
{
≥≥ 
MailAddress
¥¥ '
a
¥¥( )
=
¥¥* +
new
¥¥, /
MailAddress
¥¥0 ;
(
¥¥; <

bccAddress
¥¥< F
)
¥¥F G
;
¥¥G H
mail
µµ  
.
µµ  !
Bcc
µµ! $
.
µµ$ %
Add
µµ% (
(
µµ( )
a
µµ) *
)
µµ* +
;
µµ+ ,
}
∂∂ 
catch
∑∑ 
(
∑∑ 
ArgumentException
∑∑ 0
)
∑∑0 1
{
∏∏ 
log
ππ 
.
ππ  
Error
ππ  %
(
ππ% &
$str
ππ& <
+
ππ= >

bccAddress
ππ? I
)
ππI J
;
ππJ K
}
∫∫ 
catch
ªª 
(
ªª 
FormatException
ªª .
)
ªª. /
{
ºº 
log
ΩΩ 
.
ΩΩ  
Error
ΩΩ  %
(
ΩΩ% &
$str
ΩΩ& <
+
ΩΩ= >

bccAddress
ΩΩ? I
)
ΩΩI J
;
ΩΩJ K
}
ææ 
}
øø 
}
¡¡ 
mail
√√ 
.
√√ 
Subject
√√ 
=
√√ 
subject
√√ &
.
√√& '
RemoveLineBreaks
√√' 7
(
√√7 8
)
√√8 9
;
√√9 :
switch
≈≈ 
(
≈≈ 
priority
≈≈  
)
≈≈  !
{
∆∆ 
case
«« 
PriorityHigh
«« %
:
««% &
mail
»» 
.
»» 
Priority
»» %
=
»»& '
MailPriority
»»( 4
.
»»4 5
High
»»5 9
;
»»9 :
break
…… 
;
…… 
case
ÀÀ 
PriorityLow
ÀÀ $
:
ÀÀ$ %
mail
ÃÃ 
.
ÃÃ 
Priority
ÃÃ %
=
ÃÃ& '
MailPriority
ÃÃ( 4
.
ÃÃ4 5
Low
ÃÃ5 8
;
ÃÃ8 9
break
ÕÕ 
;
ÕÕ 
case
œœ 
PriorityNormal
œœ '
:
œœ' (
default
–– 
:
–– 
mail
—— 
.
—— 
Priority
—— %
=
——& '
MailPriority
——( 4
.
——4 5
Normal
——5 ;
;
——; <
break
““ 
;
““ 
}
‘‘ 
if
ÿÿ 
(
ÿÿ 
html
ÿÿ 
)
ÿÿ 
{
ŸŸ 
mail
⁄⁄ 
.
⁄⁄ 

IsBodyHtml
⁄⁄ #
=
⁄⁄$ %
true
⁄⁄& *
;
⁄⁄* +
mail
‹‹ 
.
‹‹ 
Body
‹‹ 
=
‹‹ 
messageBody
‹‹  +
.
‹‹+ ,
Replace
‹‹, 3
(
‹‹3 4
$str
‹‹4 :
,
‹‹: ;
$str
‹‹< D
)
‹‹D E
;
‹‹E F
}
›› 
else
ﬁﬁ 
{
ﬂﬂ 
mail
‡‡ 
.
‡‡ 
Body
‡‡ 
=
‡‡ 
messageBody
‡‡  +
;
‡‡+ ,
}
·· 
if
‰‰ 
(
‰‰ 
attachments
‰‰ 
!=
‰‰  "
null
‰‰# '
)
‰‰' (
{
ÂÂ 
foreach
ÊÊ 
(
ÊÊ 

Attachment
ÊÊ '
a
ÊÊ( )
in
ÊÊ* ,
attachments
ÊÊ- 8
)
ÊÊ8 9
{
ÁÁ 
mail
ËË 
.
ËË 
Attachments
ËË (
.
ËË( )
Add
ËË) ,
(
ËË, -
a
ËË- .
)
ËË. /
;
ËË/ 0
}
ÈÈ 
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
smtpSettings
ÏÏ  
.
ÏÏ  !
AddBulkMailHeader
ÏÏ! 2
)
ÏÏ2 3
{
ÌÌ 
mail
ÓÓ 
.
ÓÓ 
Headers
ÓÓ  
.
ÓÓ  !
Add
ÓÓ! $
(
ÓÓ$ %
$str
ÓÓ% 1
,
ÓÓ1 2
$str
ÓÓ3 9
)
ÓÓ9 :
;
ÓÓ: ;
}
ÔÔ 
return
ÚÚ 
Send
ÚÚ 
(
ÚÚ 
smtpSettings
ÚÚ (
,
ÚÚ( )
mail
ÚÚ* .
,
ÚÚ. /
out
ÚÚ0 3
result
ÚÚ4 :
)
ÚÚ: ;
;
ÚÚ; <
}
ˆˆ 
}
¯¯ 	
private
˙˙ 
static
˙˙ 
string
˙˙ !
GetGlobalBccAddress
˙˙ 1
(
˙˙1 2
)
˙˙2 3
{
˚˚ 	
if
ˇˇ 
(
ˇˇ 
(
ˇˇ "
ConfigurationManager
ˇˇ %
.
ˇˇ% &
AppSettings
ˇˇ& 1
[
ˇˇ1 2
$str
ˇˇ2 =
]
ˇˇ= >
!=
ˇˇ? A
null
ˇˇB F
)
ˇˇF G
&&
ˇˇG I
(
ˇˇI J"
ConfigurationManager
ˇˇJ ^
.
ˇˇ^ _
AppSettings
ˇˇ_ j
[
ˇˇj k
$str
ˇˇk v
]
ˇˇv w
.
ˇˇw x
Length
ˇˇx ~
>ˇˇ Ä
$numˇˇÅ Ç
)ˇˇÇ É
)ˇˇÉ Ñ
{
ÄÄ 
return
ÅÅ "
ConfigurationManager
ÅÅ +
.
ÅÅ+ ,
AppSettings
ÅÅ, 7
[
ÅÅ7 8
$str
ÅÅ8 C
]
ÅÅC D
;
ÅÅD E
}
ÇÇ 
return
ÑÑ 
string
ÑÑ 
.
ÑÑ 
Empty
ÑÑ 
;
ÑÑ  
}
ÜÜ 	
public
áá 
static
áá	 
bool
áá 
Send
áá 
(
áá 
SmtpSettings
áá &
smtpSettings
áá' 3
,
áá3 4
MailMessage
áá5 @
message
ááA H
)
ááH I
{
àà 
return
ââ 	
Send
ââ
 
(
ââ 
smtpSettings
ââ 
,
ââ 
message
ââ $
,
ââ$ %
out
ââ& )
_
ââ* +
)
ââ+ ,
;
ââ, -
}
ää 
public
ãã 
static
ãã 
bool
ãã 
Send
ãã 
(
ãã  
SmtpSettings
ãã  ,
smtpSettings
ãã- 9
,
ãã9 :
MailMessage
ãã; F
message
ããG N
,
ããN O
out
ããP S
string
ããT Z
result
ãã[ a
)
ããa b
{
åå 	
if
çç 
(
çç 
message
çç 
.
çç 
To
çç 
.
çç 
ToString
çç #
(
çç# $
)
çç$ %
==
çç& (
$str
çç) :
)
çç: ;
{
éé 
result
êê 

=
êê 
$str
êê 6
;
êê6 7
return
ëë 

false
ëë 
;
ëë 
}
íí 
string
îî 
	globalBcc
îî 
=
îî !
GetGlobalBccAddress
îî 2
(
îî2 3
)
îî3 4
;
îî4 5
if
ïï 
(
ïï 
	globalBcc
ïï 
.
ïï 
Length
ïï  
>
ïï! "
$num
ïï# $
)
ïï$ %
{
ññ 
MailAddress
óó 
bcc
óó 
=
óó  !
new
óó" %
MailAddress
óó& 1
(
óó1 2
	globalBcc
óó2 ;
)
óó; <
;
óó< =
message
òò 
.
òò 
Bcc
òò 
.
òò 
Add
òò 
(
òò  
bcc
òò  #
)
òò# $
;
òò$ %
}
ôô 
int
õõ !
timeoutMilliseconds
õõ #
=
õõ$ %
ConfigHelper
õõ& 2
.
õõ2 3
GetIntProperty
õõ3 A
(
õõA B
$str
õõB ]
,
õõ] ^
$num
õõ_ d
)
õõd e
;
õõe f

SmtpClient
úú 

smtpClient
úú !
=
úú" #
new
úú$ '

SmtpClient
úú( 2
(
úú2 3
smtpSettings
úú3 ?
.
úú? @
Server
úú@ F
,
úúF G
smtpSettings
úúH T
.
úúT U
Port
úúU Y
)
úúY Z
;
úúZ [

smtpClient
ùù 
.
ùù 
DeliveryMethod
ùù %
=
ùù& ' 
SmtpDeliveryMethod
ùù( :
.
ùù: ;
Network
ùù; B
;
ùùB C

smtpClient
ûû 
.
ûû 
	EnableSsl
ûû  
=
ûû! "
smtpSettings
ûû# /
.
ûû/ 0
UseSsl
ûû0 6
;
ûû6 7

smtpClient
üü 
.
üü 
Timeout
üü 
=
üü  !
timeoutMilliseconds
üü! 4
;
üü4 5
if
°° 
(
°° 
smtpSettings
°° 
.
°° $
RequiresAuthentication
°° 3
)
°°3 4
{
¢¢ 
NetworkCredential
§§ !
smtpCredential
§§" 0
=
•• 
new
•• 
NetworkCredential
•• +
(
••+ ,
smtpSettings
¶¶ $
.
¶¶$ %
User
¶¶% )
,
¶¶) *
smtpSettings
ßß $
.
ßß$ %
Password
ßß% -
)
ßß- .
;
ßß. /
CredentialCache
©© 
myCache
©©  '
=
©©( )
new
©©* -
CredentialCache
©©. =
(
©©= >
)
©©> ?
;
©©? @
myCache
™™ 
.
™™ 
Add
™™ 
(
™™ 
smtpSettings
™™ (
.
™™( )
Server
™™) /
,
™™/ 0
smtpSettings
™™1 =
.
™™= >
Port
™™> B
,
™™B C
$str
™™D K
,
™™K L
smtpCredential
™™M [
)
™™[ \
;
™™\ ]

smtpClient
¨¨ 
.
¨¨ #
UseDefaultCredentials
¨¨ 0
=
¨¨1 2
false
¨¨3 8
;
¨¨8 9

smtpClient
≠≠ 
.
≠≠ 
Credentials
≠≠ &
=
≠≠' (
myCache
≠≠) 0
;
≠≠0 1
}
ÆÆ 
else
ØØ 
{
∞∞ 

smtpClient
≤≤ 
.
≤≤ #
UseDefaultCredentials
≤≤ 0
=
≤≤1 2
true
≤≤3 7
;
≤≤7 8
}
≥≥ 
try
∂∂ 
{
∑∑ 

smtpClient
∏∏ 
.
∏∏ 
Send
∏∏ 
(
∏∏  
message
∏∏  '
)
∏∏' (
;
∏∏( )
bool
ºº 
logEmail
ºº 
=
ºº 
ConfigHelper
ºº  ,
.
ºº, -
GetBoolProperty
ºº- <
(
ºº< =
$str
ºº= V
,
ººV W
false
ººX ]
)
ºº] ^
;
ºº^ _
if
ææ 
(
ææ 
logEmail
ææ 
)
ææ 
{
ææ 
log
ææ  #
.
ææ# $
Info
ææ$ (
(
ææ( )
$str
ææ) 8
+
ææ9 :
message
ææ; B
.
ææB C
Subject
ææC J
+
ææK L
$str
ææM S
+
ææT U
message
ææV ]
.
ææ] ^
To
ææ^ `
[
ææ` a
$num
ææa b
]
ææb c
.
ææc d
Address
ææd k
)
ææk l
;
ææl m
}
ææn o
result
øø 

=
øø 
$str
øø 
;
øø 
return
¿¿ 
true
¿¿ 
;
¿¿ 
}
¡¡ 
catch
¬¬ 
(
¬¬ 
System
¬¬ 
.
¬¬ 
Net
¬¬ 
.
¬¬ 
Mail
¬¬ "
.
¬¬" #
SmtpException
¬¬# 0
ex
¬¬1 3
)
¬¬3 4
{
√√ 
result
≈≈ 

=
≈≈ 
$"
≈≈ 
error: 
≈≈ 
{
≈≈ 
ex
≈≈ 
}
≈≈ 
"
≈≈ 
;
≈≈ 
log
∆∆ 
.
∆∆ 
Error
∆∆ 
(
∆∆ 
$str
∆∆ 3
+
∆∆4 5
message
∆∆6 =
.
∆∆= >
To
∆∆> @
.
∆∆@ A
ToString
∆∆A I
(
∆∆I J
)
∆∆J K
+
∆∆L M
$str
∆∆N V
+
∆∆W X
message
∆∆Y `
.
∆∆` a
From
∆∆a e
.
∆∆e f
ToString
∆∆f n
(
∆∆n o
)
∆∆o p
+
∆∆q r
$str∆∆s Å
,∆∆Å Ç
ex∆∆É Ö
)∆∆Ö Ü
;∆∆Ü á
return
«« 
	RetrySend
««  
(
««  !
message
««! (
,
««( )

smtpClient
««* 4
,
««4 5
ex
««6 8
)
««8 9
;
««9 :
}
…… 
catch
   
(
   
WebException
   
ex
    "
)
  " #
{
ÀÀ 
result
ÃÃ 

=
ÃÃ 
$"
ÃÃ 
error: 
ÃÃ 
{
ÃÃ 
ex
ÃÃ 
}
ÃÃ 
"
ÃÃ 
;
ÃÃ 
log
ÕÕ 
.
ÕÕ 
Error
ÕÕ 
(
ÕÕ 
$str
ÕÕ 3
+
ÕÕ4 5
message
ÕÕ6 =
.
ÕÕ= >
To
ÕÕ> @
.
ÕÕ@ A
ToString
ÕÕA I
(
ÕÕI J
)
ÕÕJ K
+
ÕÕL M
$str
ÕÕN V
+
ÕÕW X
message
ÕÕY `
.
ÕÕ` a
From
ÕÕa e
.
ÕÕe f
ToString
ÕÕf n
(
ÕÕn o
)
ÕÕo p
+
ÕÕq r
$strÕÕs Ñ
+ÕÕÖ Ü
messageÕÕá é
.ÕÕé è
BodyÕÕè ì
,ÕÕì î
exÕÕï ó
)ÕÕó ò
;ÕÕò ô
return
ŒŒ 
false
ŒŒ 
;
ŒŒ 
}
œœ 
catch
–– 
(
–– 
SocketException
–– "
ex
––# %
)
––% &
{
—— 
result
““ 

=
““ 
$"
““ 
error: 
““ 
{
““ 
ex
““ 
}
““ 
"
““ 
;
““ 
log
”” 
.
”” 
Error
”” 
(
”” 
$str
”” '
+
””( )
message
””* 1
.
””1 2
To
””2 4
.
””4 5
ToString
””5 =
(
””= >
)
””> ?
+
””@ A
$str
””B J
+
””K L
message
””M T
.
””T U
From
””U Y
.
””Y Z
ToString
””Z b
(
””b c
)
””c d
+
””e f
$str
””g x
+
””y z
message””{ Ç
.””Ç É
Body””É á
,””á à
ex””â ã
)””ã å
;””å ç
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
catch
÷÷ 
(
÷÷ '
InvalidOperationException
÷÷ ,
ex
÷÷- /
)
÷÷/ 0
{
◊◊ 
result
ÿÿ 

=
ÿÿ 
$"
ÿÿ 
error: 
ÿÿ 
{
ÿÿ 
ex
ÿÿ 
}
ÿÿ 
"
ÿÿ 
;
ÿÿ 
log
ŸŸ 
.
ŸŸ 
Error
ŸŸ 
(
ŸŸ 
$str
ŸŸ '
+
ŸŸ( )
message
ŸŸ* 1
.
ŸŸ1 2
To
ŸŸ2 4
.
ŸŸ4 5
ToString
ŸŸ5 =
(
ŸŸ= >
)
ŸŸ> ?
+
ŸŸ@ A
$str
ŸŸB J
+
ŸŸK L
message
ŸŸM T
.
ŸŸT U
From
ŸŸU Y
.
ŸŸY Z
ToString
ŸŸZ b
(
ŸŸb c
)
ŸŸc d
+
ŸŸe f
$str
ŸŸg x
+
ŸŸy z
messageŸŸ{ Ç
.ŸŸÇ É
BodyŸŸÉ á
,ŸŸá à
exŸŸâ ã
)ŸŸã å
;ŸŸå ç
return
⁄⁄ 
false
⁄⁄ 
;
⁄⁄ 
}
€€ 
catch
‹‹ 
(
‹‹ 
FormatException
‹‹ "
ex
‹‹# %
)
‹‹% &
{
›› 
result
ﬁﬁ 

=
ﬁﬁ 
$"
ﬁﬁ 
error: 
ﬁﬁ 
{
ﬁﬁ 
ex
ﬁﬁ 
}
ﬁﬁ 
"
ﬁﬁ 
;
ﬁﬁ 
log
ﬂﬂ 
.
ﬂﬂ 
Error
ﬂﬂ 
(
ﬂﬂ 
$str
ﬂﬂ '
+
ﬂﬂ( )
message
ﬂﬂ* 1
.
ﬂﬂ1 2
To
ﬂﬂ2 4
.
ﬂﬂ4 5
ToString
ﬂﬂ5 =
(
ﬂﬂ= >
)
ﬂﬂ> ?
+
ﬂﬂ@ A
$str
ﬂﬂB J
+
ﬂﬂK L
message
ﬂﬂM T
.
ﬂﬂT U
From
ﬂﬂU Y
.
ﬂﬂY Z
ToString
ﬂﬂZ b
(
ﬂﬂb c
)
ﬂﬂc d
+
ﬂﬂe f
$str
ﬂﬂg x
+
ﬂﬂy z
messageﬂﬂ{ Ç
.ﬂﬂÇ É
BodyﬂﬂÉ á
,ﬂﬂá à
exﬂﬂâ ã
)ﬂﬂã å
;ﬂﬂå ç
return
‡‡ 
false
‡‡ 
;
‡‡ 
}
·· 
}
„„ 	
private
ÂÂ 	
static
ÂÂ
 
bool
ÂÂ 
	RetrySend
ÂÂ 
(
ÂÂ  
MailMessage
ÂÂ  +
message
ÂÂ, 3
,
ÂÂ3 4

SmtpClient
ÂÂ5 ?
smtp
ÂÂ@ D
,
ÂÂD E
	Exception
ÂÂF O
ex
ÂÂP R
)
ÂÂR S
{
ÊÊ 
return
ÁÁ 	
	RetrySend
ÁÁ
 
(
ÁÁ 
message
ÁÁ 
,
ÁÁ 
smtp
ÁÁ !
,
ÁÁ! "
ex
ÁÁ# %
,
ÁÁ% &
out
ÁÁ' *
_
ÁÁ+ ,
)
ÁÁ, -
;
ÁÁ- .
}
ËË 
private
ÎÎ 	
static
ÎÎ
 
bool
ÎÎ 
	RetrySend
ÎÎ 
(
ÎÎ  
MailMessage
ÎÎ  +
message
ÎÎ, 3
,
ÎÎ3 4

SmtpClient
ÎÎ5 ?
smtp
ÎÎ@ D
,
ÎÎD E
	Exception
ÎÎF O
ex
ÎÎP R
,
ÎÎR S
out
ÎÎT W
string
ÎÎX ^
result
ÎÎ_ e
)
ÎÎe f
{
ÏÏ 	
int
ÓÓ 
timesToRetry
ÓÓ 
=
ÓÓ 
ConfigHelper
ÓÓ +
.
ÓÓ+ ,
GetIntProperty
ÓÓ, :
(
ÓÓ: ;
$str
ÓÓ; T
,
ÓÓT U
$num
ÓÓV W
)
ÓÓW X
;
ÓÓX Y
for
ÔÔ 
(
ÔÔ 
int
ÔÔ 
i
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
;
ÔÔ 
i
ÔÔ 
<=
ÔÔ  
timesToRetry
ÔÔ! -
;
ÔÔ- .
)
ÔÔ/ 0
{
 
if
ÒÒ 
(
ÒÒ 
	RetrySend
ÒÒ 
(
ÒÒ 
message
ÒÒ %
,
ÒÒ% &
smtp
ÒÒ' +
,
ÒÒ+ ,
i
ÒÒ- .
)
ÒÒ. /
)
ÒÒ/ 0
{
ÒÒ1 2
result
ÒÒ3 9
=
ÒÒ: ;
$str
ÒÒ< B
;
ÒÒB C
return
ÒÒD J
true
ÒÒK O
;
ÒÒO P
}
ÒÒQ R
i
ÚÚ 
+=
ÚÚ 
$num
ÚÚ 
;
ÚÚ 
Thread
ÛÛ 
.
ÛÛ 
Sleep
ÛÛ 
(
ÛÛ 
$num
ÛÛ !
)
ÛÛ! "
;
ÛÛ" #
}
ÙÙ 
if
˜˜ 
(
˜˜ "
ConfigurationManager
˜˜ $
.
˜˜$ %
AppSettings
˜˜% 0
[
˜˜0 1
$str
˜˜1 C
]
˜˜C D
!=
˜˜E G
null
˜˜H L
)
˜˜L M
{
¯¯ 
string
˘˘ 
backupServer
˘˘ #
=
˘˘$ %"
ConfigurationManager
˘˘& :
.
˘˘: ;
AppSettings
˘˘; F
[
˘˘F G
$str
˘˘G Y
]
˘˘Y Z
;
˘˘Z [
int
˙˙ !
timeoutMilliseconds
˙˙ '
=
˙˙( )
ConfigHelper
˙˙* 6
.
˙˙6 7
GetIntProperty
˙˙7 E
(
˙˙E F
$str
˙˙F a
,
˙˙a b
$num
˙˙c h
)
˙˙h i
;
˙˙i j
int
˚˚ 
backupSmtpPort
˚˚ "
=
˚˚# $
ConfigHelper
˚˚% 1
.
˚˚1 2
GetIntProperty
˚˚2 @
(
˚˚@ A
$str
˚˚A Q
,
˚˚Q R
$num
˚˚S U
)
˚˚U V
;
˚˚V W

SmtpClient
¸¸ 

smtpClient
¸¸ %
=
¸¸& '
new
¸¸( +

SmtpClient
¸¸, 6
(
¸¸6 7
backupServer
¸¸7 C
,
¸¸C D
backupSmtpPort
¸¸E S
)
¸¸S T
;
¸¸T U

smtpClient
˝˝ 
.
˝˝ #
UseDefaultCredentials
˝˝ 0
=
˝˝1 2
true
˝˝3 7
;
˝˝7 8
try
ˇˇ 
{
ÄÄ 

smtpClient
ÅÅ 
.
ÅÅ 
Send
ÅÅ #
(
ÅÅ# $
message
ÅÅ$ +
)
ÅÅ+ ,
;
ÅÅ, -
log
ÇÇ 
.
ÇÇ 
Info
ÇÇ 
(
ÇÇ 
$str
ÇÇ Q
+
ÇÇR S
message
ÇÇT [
.
ÇÇ[ \
To
ÇÇ\ ^
.
ÇÇ^ _
ToString
ÇÇ_ g
(
ÇÇg h
)
ÇÇh i
+
ÇÇj k
$str
ÇÇl t
+
ÇÇu v
message
ÇÇw ~
.
ÇÇ~ 
FromÇÇ É
)ÇÇÉ Ñ
;ÇÇÑ Ö
result
ÉÉ 
=
ÉÉ 
$str
ÉÉ 
;
ÉÉ 
return
ÑÑ 
true
ÑÑ 
;
ÑÑ  
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
System
ÜÜ 
.
ÜÜ 
Net
ÜÜ !
.
ÜÜ! "
Mail
ÜÜ" &
.
ÜÜ& '
SmtpException
ÜÜ' 4
)
ÜÜ4 5
{
ÜÜ6 7
}
ÜÜ8 9
catch
áá 
(
áá 
WebException
áá #
)
áá# $
{
áá% &
}
áá' (
catch
àà 
(
àà 
SocketException
àà &
)
àà& '
{
àà( )
}
àà* +
catch
ââ 
(
ââ '
InvalidOperationException
ââ 0
)
ââ0 1
{
ââ2 3
}
ââ4 5
catch
ää 
(
ää 
FormatException
ää &
)
ää& '
{
ää( )
}
ää* +
}
åå 
log
èè 
.
èè 
Error
èè 
(
èè 
$str
èè <
+
èè= >
message
èè? F
.
èèF G
To
èèG I
.
èèI J
ToString
èèJ R
(
èèR S
)
èèS T
+
èèU V
$str
èèW _
+
èè` a
message
èèb i
.
èèi j
From
èèj n
.
èèn o
ToString
èèo w
(
èèw x
)
èèx y
+
èèz {
$strèè| ç
+èèé è
messageèèê ó
.èèó ò
Bodyèèò ú
,èèú ù
exèèû †
)èè† °
;èè° ¢
result
êê 	
=
êê
 
$str
êê 
;
êê 
return
ëë 
false
ëë 
;
ëë 
}
ìì 	
private
ïï 
static
ïï 
bool
ïï 
	RetrySend
ïï %
(
ïï% &
MailMessage
ïï& 1
message
ïï2 9
,
ïï9 :

SmtpClient
ïï; E
smtp
ïïF J
,
ïïJ K
int
ïïL O
	tryNumber
ïïP Y
)
ïïY Z
{
ññ 	
try
óó 
{
òò 
smtp
ôô 
.
ôô 
Send
ôô 
(
ôô 
message
ôô !
)
ôô! "
;
ôô" #
log
öö 
.
öö 
Info
öö 
(
öö 
$str
öö ,
+
öö- .
	tryNumber
öö/ 8
.
öö8 9
ToInvariantString
öö9 J
(
ööJ K
)
ööK L
+
ööM N
$str
ööO c
+
ööd e
message
ööf m
.
ööm n
To
öön p
.
ööp q
ToString
ööq y
(
ööy z
)
ööz {
+
öö| }
$ströö~ Ü
+ööá à
messageööâ ê
.ööê ë
Fromööë ï
)ööï ñ
;ööñ ó
return
õõ 
true
õõ 
;
õõ 
}
úú 
catch
ùù 
(
ùù 
System
ùù 
.
ùù 
Net
ùù 
.
ùù 
Mail
ùù "
.
ùù" #
SmtpException
ùù# 0
)
ùù0 1
{
ùù2 3
}
ùù4 5
catch
ûû 
(
ûû 
WebException
ûû 
)
ûû  
{
ûû! "
}
ûû# $
catch
üü 
(
üü 
SocketException
üü "
)
üü" #
{
üü$ %
}
üü& '
catch
†† 
(
†† '
InvalidOperationException
†† ,
)
††, -
{
††. /
}
††0 1
catch
°° 
(
°° 
FormatException
°° "
)
°°" #
{
°°$ %
}
°°& '
return
££ 
false
££ 
;
££ 
}
§§ 	
public
¶¶ 
static
¶¶ 
bool
¶¶ '
IsValidEmailAddressSyntax
¶¶ 4
(
¶¶4 5
string
¶¶5 ;
emailAddress
¶¶< H
)
¶¶H I
{
ßß 	
return
®® 
SecurityHelper
®® !
.
®®! "!
IsValidEmailAddress
®®" 5
(
®®5 6
emailAddress
®®6 B
)
®®B C
;
®®C D
}
∏∏ 	
}
∫∫ 
}ªª éP
nD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\ForumNotificationInfo.cs
	namespace 	

mojoPortal
 
. 
Net 
{ 
public 

class !
ForumNotificationInfo &
{ 
public !
ForumNotificationInfo $
($ %
)% &
{ 	
}
 
private 
string 
subjectTemplate &
=' (
string) /
./ 0
Empty0 5
;5 6
private 
string 
bodyTemplate #
=$ %
string& ,
., -
Empty- 2
;2 3
private 
string 
forumOnlyTemplate (
=) *
string+ 1
.1 2
Empty2 7
;7 8
private 
string 
threadOnlyTemplate )
=* +
string, 2
.2 3
Empty3 8
;8 9
private 
string 
moderatorTemplate (
=) *
string+ 1
.1 2
Empty2 7
;7 8
private   
string   
	fromEmail    
=  ! "
string  # )
.  ) *
Empty  * /
;  / 0
private!! 
string!! 
	fromAlias!!  
=!!! "
string!!# )
.!!) *
Empty!!* /
;!!/ 0
private"" 
string"" 
siteName"" 
=""  !
string""" (
.""( )
Empty"") .
;"". /
private## 
string## 

moduleName## !
=##" #
string##$ *
.##* +
Empty##+ 0
;##0 1
private$$ 
string$$ 
	forumName$$  
=$$! "
string$$# )
.$$) *
Empty$$* /
;$$/ 0
private%% 
string%% 
subject%% 
=%%  
string%%! '
.%%' (
Empty%%( -
;%%- .
private&& 
string&& 
messageBody&& "
=&&# $
string&&% +
.&&+ ,
Empty&&, 1
;&&1 2
private'' 
DataSet'' 
subscribers'' #
=''$ %
null''& *
;''* +
private(( 
string(( 
messageLink(( "
=((# $
string((% +
.((+ ,
Empty((, 1
;((1 2
private)) 
string)) &
unsubscribeForumThreadLink)) 1
=))2 3
string))4 :
.)): ;
Empty)); @
;))@ A
private** 
string**  
unsubscribeForumLink** +
=**, -
string**. 4
.**4 5
Empty**5 :
;**: ;
private++ 
SmtpSettings++ 
smtpSettings++ )
=++* +
null++, 0
;++0 1
private,, 
List,, 
<,, 
string,, 
>,, #
moderatorEmailAddresses,, 4
=,,5 6
null,,7 ;
;,,; <
private.. 
int.. 
threadId.. 
=.. 
-..  
$num..  !
;..! "
public00 
int00 
ThreadId00 
{11 	
get22 
{22 
return22 
threadId22 !
;22! "
}22# $
set33 
{33 
threadId33 
=33 
value33 "
;33" #
}33$ %
}44 	
private66 
int66 
postId66 
=66 
-66 
$num66 
;66  
public88 
int88 
PostId88 
{99 	
get:: 
{:: 
return:: 
postId:: 
;::  
}::! "
set;; 
{;; 
postId;; 
=;; 
value;;  
;;;  !
};;" #
}<< 	
public>> 
List>> 
<>> 
string>> 
>>> #
ModeratorEmailAddresses>> 3
{?? 	
get@@ 
{@@ 
return@@ #
moderatorEmailAddresses@@ 0
;@@0 1
}@@2 3
setAA 
{AA #
moderatorEmailAddressesAA )
=AA* +
valueAA, 1
;AA1 2
}AA3 4
}BB 	
publicDD 
SmtpSettingsDD 
SmtpSettingsDD (
{EE 	
getFF 
{FF 
returnFF 
smtpSettingsFF %
;FF% &
}FF' (
setGG 
{GG 
smtpSettingsGG 
=GG  
valueGG! &
;GG& '
}GG( )
}HH 	
publicJJ 
stringJJ 
SubjectTemplateJJ %
{KK 	
getLL 
{LL 
returnLL 
subjectTemplateLL (
;LL( )
}LL* +
setMM 
{MM 
subjectTemplateMM !
=MM" #
valueMM$ )
;MM) *
}MM+ ,
}NN 	
publicPP 
stringPP 
BodyTemplatePP "
{QQ 	
getRR 
{RR 
returnRR 
bodyTemplateRR %
;RR% &
}RR' (
setSS 
{SS 
bodyTemplateSS 
=SS  
valueSS! &
;SS& '
}SS( )
}TT 	
publicVV 
stringVV 
ForumOnlyTemplateVV '
{WW 	
getXX 
{XX 
returnXX 
forumOnlyTemplateXX *
;XX* +
}XX, -
setYY 
{YY 
forumOnlyTemplateYY #
=YY$ %
valueYY& +
;YY+ ,
}YY- .
}ZZ 	
public\\ 
string\\ 
ThreadOnlyTemplate\\ (
{]] 	
get^^ 
{^^ 
return^^ 
threadOnlyTemplate^^ +
;^^+ ,
}^^- .
set__ 
{__ 
threadOnlyTemplate__ $
=__% &
value__' ,
;__, -
}__. /
}`` 	
publicbb 
stringbb 
ModeratorTemplatebb '
{cc 	
getdd 
{dd 
returndd 
moderatorTemplatedd *
;dd* +
}dd, -
setee 
{ee 
moderatorTemplateee #
=ee$ %
valueee& +
;ee+ ,
}ee- .
}ff 	
publichh 
stringhh 
	FromEmailhh 
{ii 	
getjj 
{jj 
returnjj 
	fromEmailjj "
;jj" #
}jj$ %
setkk 
{kk 
	fromEmailkk 
=kk 
valuekk #
;kk# $
}kk% &
}ll 	
publicnn 
stringnn 
	FromAliasnn 
{oo 	
getpp 
{pp 
returnpp 
	fromAliaspp "
;pp" #
}pp$ %
setqq 
{qq 
	fromAliasqq 
=qq 
valueqq #
;qq# $
}qq% &
}rr 	
publictt 
stringtt 
SiteNamett 
{uu 	
getvv 
{vv 
returnvv 
siteNamevv !
;vv! "
}vv# $
setww 
{ww 
siteNameww 
=ww 
valueww "
;ww" #
}ww$ %
}xx 	
publiczz 
stringzz 

ModuleNamezz  
{{{ 	
get|| 
{|| 
return|| 

moduleName|| #
;||# $
}||% &
set}} 
{}} 

moduleName}} 
=}} 
value}} $
;}}$ %
}}}& '
}~~ 	
public
ÄÄ 
string
ÄÄ 
	ForumName
ÄÄ 
{
ÅÅ 	
get
ÇÇ 
{
ÇÇ 
return
ÇÇ 
	forumName
ÇÇ "
;
ÇÇ" #
}
ÇÇ$ %
set
ÉÉ 
{
ÉÉ 
	forumName
ÉÉ 
=
ÉÉ 
value
ÉÉ #
;
ÉÉ# $
}
ÉÉ% &
}
ÑÑ 	
public
ÜÜ 
string
ÜÜ 
Subject
ÜÜ 
{
áá 	
get
àà 
{
àà 
return
àà 
subject
àà  
;
àà  !
}
àà" #
set
ââ 
{
ââ 
subject
ââ 
=
ââ 
value
ââ !
;
ââ! "
}
ââ# $
}
ää 	
public
åå 
string
åå 
MessageBody
åå !
{
çç 	
get
éé 
{
éé 
return
éé 
messageBody
éé $
;
éé$ %
}
éé& '
set
èè 
{
èè 
messageBody
èè 
=
èè 
value
èè  %
;
èè% &
}
èè' (
}
êê 	
public
íí 
DataSet
íí 
Subscribers
íí "
{
ìì 	
get
îî 
{
îî 
return
îî 
subscribers
îî $
;
îî$ %
}
îî& '
set
ïï 
{
ïï 
subscribers
ïï 
=
ïï 
value
ïï  %
;
ïï% &
}
ïï' (
}
ññ 	
public
òò 
string
òò 
MessageLink
òò !
{
ôô 	
get
öö 
{
öö 
return
öö 
messageLink
öö $
;
öö$ %
}
öö& '
set
õõ 
{
õõ 
messageLink
õõ 
=
õõ 
value
õõ  %
;
õõ% &
}
õõ' (
}
úú 	
public
ûû 
string
ûû (
UnsubscribeForumThreadLink
ûû 0
{
üü 	
get
†† 
{
†† 
return
†† (
unsubscribeForumThreadLink
†† 3
;
††3 4
}
††5 6
set
°° 
{
°° (
unsubscribeForumThreadLink
°° ,
=
°°- .
value
°°/ 4
;
°°4 5
}
°°6 7
}
¢¢ 	
public
§§ 
string
§§ "
UnsubscribeForumLink
§§ *
{
•• 	
get
¶¶ 
{
¶¶ 
return
¶¶ "
unsubscribeForumLink
¶¶ -
;
¶¶- .
}
¶¶/ 0
set
ßß 
{
ßß "
unsubscribeForumLink
ßß &
=
ßß' (
value
ßß) .
;
ßß. /
}
ßß0 1
}
®® 	
}
™™ 
}´´ õ(
eD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\Notification.cs
	namespace 	

mojoPortal
 
. 
Net 
{ 
public 

sealed 
class 
Notification $
{ 
private 
static 
readonly 
ILog  $
log% (
=) *

LogManager+ 5
.5 6
	GetLogger6 ?
(? @
typeof@ F
(F G
NotificationG S
)S T
)T U
;U V
private 
static 
bool 
debugLog $
=% &
log' *
.* +
IsDebugEnabled+ 9
;9 :
private!! 
Notification!! 
(!! 
)!! 
{"" 	
}$$ 	
public&& 
static&& 
void&& 
SendPassword&& '
(&&' (
SmtpSettings'' 
smtpSettings'' %
,''% &
string(( 
messageTemplate(( "
,((" #
string)) 
	fromEmail)) 
,)) 
string** 
	userEmail** 
,** 
string++ 
userPassword++ 
,++  
string,, 
siteName,, 
,,, 
string-- 
siteLink-- 
)-- 
{.. 	
StringBuilder00 
message00 !
=00" #
new00$ '
StringBuilder00( 5
(005 6
)006 7
;007 8
message11 
.11 
Append11 
(11 
messageTemplate11 *
)11* +
;11+ ,
message22 
.22 
Replace22 
(22 
$str22 (
,22( )
siteName22* 2
)222 3
;223 4
message33 
.33 
Replace33 
(33 
$str33 *
,33* +
	fromEmail33, 5
)335 6
;336 7
message44 
.44 
Replace44 
(44 
$str44 )
,44) *
	userEmail44+ 4
)444 5
;445 6
message55 
.55 
Replace55 
(55 
$str55 ,
,55, -
userPassword55. :
)55: ;
;55; <
message66 
.66 
Replace66 
(66 
$str66 (
,66( )
siteLink66* 2
)662 3
;663 4
Email88 
.88 
	SendEmail88 
(88 
smtpSettings99 
,99 
	fromEmail:: 
,:: 
	userEmail;; 
,;; 
$str;; 
,;; 
$str;; !
,;;! "
siteName<< 
,<< 
message== 
.== 
ToString==  
(==  !
)==! "
,==" #
false==$ )
,==) *
$str==+ 3
)==3 4
;==4 5
}@@ 	
publicBB 
staticBB 
voidBB ,
 SendRegistrationConfirmationLinkBB ;
(BB; <
SmtpSettingsCC 
smtpSettingsCC %
,CC% &
stringDD 
messageTemplateDD "
,DD" #
stringEE 
	fromEmailEE 
,EE 
stringFF 
	fromAliasFF 
,FF 
stringGG 
	userEmailGG 
,GG 
stringHH 
siteNameHH 
,HH 
stringII 
confirmationLinkII #
)II# $
{JJ 	
StringBuilderLL 
messageLL !
=LL" #
newLL$ '
StringBuilderLL( 5
(LL5 6
)LL6 7
;LL7 8
messageMM 
.MM 
AppendMM 
(MM 
messageTemplateMM *
)MM* +
;MM+ ,
messageNN 
.NN 
ReplaceNN 
(NN 
$strNN (
,NN( )
siteNameNN* 2
)NN2 3
;NN3 4
messageOO 
.OO 
ReplaceOO 
(OO 
$strOO *
,OO* +
	fromEmailOO, 5
)OO5 6
;OO6 7
messagePP 
.PP 
ReplacePP 
(PP 
$strPP )
,PP) *
	userEmailPP+ 4
)PP4 5
;PP5 6
messageRR 
.RR 
ReplaceRR 
(RR 
$strRR 0
,RR0 1
confirmationLinkRR2 B
)RRB C
;RRC D
EmailTT 
.TT 
SendTT 
(TT 
smtpSettingsUU 
,UU 
	fromEmailVV 
,VV 
	fromAliasWW 
,WW 
stringXX 
.XX 
EmptyXX 
,XX 
	userEmailYY 
,YY 
stringZZ 
.ZZ 
EmptyZZ 
,ZZ 
string[[ 
.[[ 
Empty[[ 
,[[ 
siteName\\ 
,\\ 
message]] 
.]] 
ToString]]  
(]]  !
)]]! "
,]]" #
false^^ 
,^^ 
$str__ 
)__ 
;__ 
}bb 	
}
≤≤ 
}≥≥ ¶
pD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\Properties\AssemblyInfo.cs
[		 
assembly		 	
:			 

AssemblyTitle		 
(		 
$str		 )
)		) *
]		* +
[

 
assembly

 	
:

	 

AssemblyDescription

 
(

 
$str

 !
)

! "
]

" #
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str +
)+ ,
], -
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *
[%% 
assembly%% 	
:%%	 

CLSCompliant%% 
(%% 
true%% 
)%% 
]%% ”
eD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\SmtpSettings.cs
	namespace 	

mojoPortal
 
. 
Net 
{ 
public 
class 
SmtpSettings 
{ 
public 
SmtpSettings 
( 
) 
{ 	
}
 
public 
string	 
User 
{ 
get 
; 
set 
;  
}! "
=# $
string% +
.+ ,
Empty, 1
;1 2
public 
string	 
Password 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
public 
string	 
Server 
{ 
get 
; 
set !
;! "
}# $
=% &
string' -
.- .
Empty. 3
;3 4
public 
int	 
Port 
{ 
get 
; 
set 
; 
} 
=  !
$num" $
;$ %
public 
bool	 "
RequiresAuthentication $
{% &
get' *
;* +
set, /
;/ 0
}1 2
=3 4
false5 :
;: ;
public   
bool  	 
UseSsl   
{   
get   
;   
set   
;    
}  ! "
=  # $
false  % *
;  * +
public"" 
string""	 
PreferredEncoding"" !
{""" #
get""$ '
;""' (
set"") ,
;"", -
}"". /
=""0 1
string""2 8
.""8 9
Empty""9 >
;""> ?
public$$ 
bool$$	 
AddBulkMailHeader$$ 
{$$  !
get$$" %
;$$% &
set$$' *
;$$* +
}$$, -
=$$. /
false$$0 5
;$$5 6
public&& 
bool&&	 
IsValid&& 
{'' 	
get(( 
{)) 
if** 
(** 
Server** 
.** 
Length** !
==**" $
$num**% &
)**& '
{**( )
return*** 0
false**1 6
;**6 7
}**8 9
if,, 
(,, "
RequiresAuthentication,, *
),,* +
{-- 
if.. 
(.. 
User.. 
... 
Length.. #
==..$ &
$num..' (
)..( )
{..* +
return.., 2
false..3 8
;..8 9
}..: ;
if// 
(// 
Password//  
.//  !
Length//! '
==//( *
$num//+ ,
)//, -
{//. /
return//0 6
false//7 <
;//< =
}//> ?
}00 
return22 
true22 
;22 
}33 
}55 	
}77 
}88 ¸
rD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\mojoPortal.Net\TrustAllCertificatePolicy.cs
	namespace 	

mojoPortal
 
. 
Net 
{ 
public 

class %
TrustAllCertificatePolicy *
:+ ,
ICertificatePolicy- ?
{ 
public		 %
TrustAllCertificatePolicy		 (
(		( )
)		) *
{

 	
}


 
public 
bool !
CheckValidationResult )
() *
ServicePoint 
sp 
, 
X509Certificate 
cert  
,  !

WebRequest 
req 
, 
int 
problem 
) 
{ 	
return 
true 
; 
} 	
} 
} 