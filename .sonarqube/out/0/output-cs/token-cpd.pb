À‘
eD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\Brettle.Web.NeatHtml\Filter.cs
	namespace 	
Brettle
 
. 
Web 
. 
NeatHtml 
{ 
public 
class 
Filter 
{ 
public   
static  	 
Filter   
DefaultFilter   $
=  % &
new  ' *
Filter  + 1
(  1 2
)  2 3
;  3 4
public"" 
string""	  
ClientSideFilterName"" $
=""% &
$str""' ?
;""? @
public## 
string##	 $
NoScriptDownlevelIEWidth## (
=##) *
$str##+ 1
;##1 2
public$$ 
string$$	 %
NoScriptDownlevelIEHeight$$ )
=$$* +
$str$$, 3
;$$3 4
public%% 
bool%%	 !
SupportNoScriptTables%% #
=%%$ %
false%%& +
;%%+ ,
public&& 
int&&	 
MaxComplexity&& 
=&& 
$num&& "
;&&" #
public'' 
Regex''	  
TrustedImageUrlRegex'' #
=''$ %
null''& *
;''* +
public(( 
Regex((	  
SpamFreeLinkUrlRegex(( #
=(($ %
null((& *
;((* +
public** 
string**	 
FilterUntrusted** 
(**  
string**  &
	untrusted**' 0
)**0 1
{++ 
return,, 	

ScriptJail,,
 
.,, 
Jail,, 
(,, 
	untrusted,, #
,,,# $ 
ClientSideFilterName,,% 9
,,,9 :$
NoScriptDownlevelIEWidth,,; S
,,,S T%
NoScriptDownlevelIEHeight,,U n
,,,n o!
SupportNoScriptTables--	 
,-- 
MaxComplexity--  -
,--- . 
TrustedImageUrlRegex--/ C
,--C D 
SpamFreeLinkUrlRegex--E Y
)--Y Z
;--Z [
}.. 
}// 
internal11 	
class11
 

ScriptJail11 
{22 
internal33 

static33 
string33 
Jail33 
(33 
string33 $
	untrusted33% .
,33. /
string330 6 
clientSideFilterName337 K
,33K L
string44	 $
noScriptDownlevelIEWidth44 (
,44( )
string44* 0%
noScriptDownlevelIEHeight441 J
,44J K
bool55	 !
supportNoScriptTables55 #
,55# $
int55% (
maxComplexity55) 6
,556 7
Regex66 # 
trustedImageUrlRegex66$ 8
,668 9
Regex66: ? 
spamFreeLinkUrlRegex66@ T
)66T U
{77 

ScriptJail88 
jail88 
=88 
new88 

ScriptJail88 #
(88# $!
supportNoScriptTables88$ 9
,889 :
maxComplexity88; H
,88H I 
trustedImageUrlRegex88J ^
,88^ _ 
spamFreeLinkUrlRegex88` t
)88t u
;88u v
string99 	
jailed99
 
=99 
null99 
;99 
try:: 
{;; 
jailed<< 

=<< 
JailRE<< 
.<< 
Replace<< 
(<< 
	untrusted<< %
,<<% &
new<<' *
MatchEvaluator<<+ 9
(<<9 :
jail<<: >
.<<> ?
	GuardJail<<? H
)<<H I
)<<I J
;<<J K
if@@ 
(@@ 
jail@@ 
.@@ 
UntrustedTables@@ 
>@@ 
$num@@  
)@@  !
{AA 
jailedBB 
+=BB 
ParserResetStringBB  
;BB  !
whileCC 

(CC 
jailCC 
.CC 
UntrustedTablesCC  
--CC  "
>CC# $
$numCC% &
)CC& '
jailedDD 
+=DD 
$strDD 
;DD 
}EE 
}FF 
catchGG 
(GG	 
&
ContentTooComplexExceptionGG
 $
)GG$ %
{HH 
jailedII 

=II 
$strII P
;IIP Q
}JJ 
returnLL 	
StringLL
 
.LL 
FormatLL 
(LL 
FormatLL 
,LL  
clientSideFilterNameLL  4
,LL4 5
jailedLL6 <
,LL< =$
noScriptDownlevelIEWidthMM 0
,MM0 1%
noScriptDownlevelIEHeightMM2 K
,MMK L
maxComplexityNN %
,NN% & 
trustedImageUrlRegexOO ,
==OO- /
nullOO0 4
?OO5 6
$strOO7 =
:OO> ?
$strOO@ O
+OOP Q 
trustedImageUrlRegexOOR f
+OOg h
$strOOi n
,OOn o
GuidOOp t
.OOt u
NewGuidOOu |
(OO| }
)OO} ~
.OO~ 
ToString	OO á
(
OOá à
)
OOà â
)
OOâ ä
;
OOä ã
}PP 
privateRR 	

ScriptJailRR
 
(RR 
boolRR !
supportNoScriptTablesRR /
,RR/ 0
intRR1 4
maxComplexityRR5 B
,RRB C
RegexSS  
trustedImageUrlRegexSS /
,SS/ 0
RegexSS1 6 
spamFreeLinkUrlRegexSS7 K
)SSK L
{TT !
SupportNoScriptTablesUU 
=UU !
supportNoScriptTablesUU 0
;UU0 1
MaxComplexityVV 
=VV 
maxComplexityVV  
;VV  ! 
TrustedImageUrlRegexWW 
=WW  
trustedImageUrlRegexWW .
;WW. / 
SpamFreeLinkUrlRegexXX 
=XX  
spamFreeLinkUrlRegexXX .
;XX. /
}YY 
private[[ 	
bool[[
 !
SupportNoScriptTables[[ $
;[[$ %
private\\ 	
int\\
 
MaxComplexity\\ 
;\\ 
private]] 	
Regex]]
  
TrustedImageUrlRegex]] $
;]]$ %
private^^ 	
Regex^^
  
SpamFreeLinkUrlRegex^^ $
;^^$ %
private`` 	
int``
 

Complexity`` 
;`` 
privatebb 	
staticbb
 
stringbb 
[bb 
]bb $
propsAllowedWhenNoScriptbb 2
=cc 
{cc 
$strcc 
,cc 
$strcc '
,cc' (
$strcc( :
,cc: ;
$strcc; M
,ccM N
$strccN c
,ccc d
$strdd 
,dd 
$strdd $
,dd$ %
$strdd% 6
,dd6 7
$strdd7 E
,ddE F
$strddF V
,ddV W
$strddW e
,dde f
$stree 
,ee 
$stree 
,ee  
$stree  /
,ee/ 0
$stree0 =
,ee= >
$stree> P
,eeP Q
$streeQ e
,eee f
$strff 
,ff 
$strff -
,ff- .
$strff. @
,ff@ A
$strffA U
,ffU V
$strffV k
,ffk l
$strgg 
,gg 
$strgg *
,gg* +
$strgg+ ?
,gg? @
$strgg@ U
,ggU V
$strggV i
,ggi j
$strhh 
,hh 
$strhh 
,hh 
$strhh $
,hh$ %
$strhh% 3
,hh3 4
$strhh4 ;
,hh; <
$strhh< B
,hhB C
$strhhC J
,hhJ K
$strhhK T
,hhT U
$strjj 
,jj 
$strjj 
,jj 
$strjj "
,jj" #
$strjj# +
,jj+ ,
$strjj, 7
,jj7 8
$strjj8 A
,jjA B
$strjjB M
,jjM N
$strjjN [
,jj[ \
$strkk 
,kk 
$strkk 
,kk 
$strkk %
,kk% &
$strkk& 2
,kk2 3
$strkk3 A
,kkA B
$strkkB O
,kkO P
$strkkP V
,kkV W
$strkkW _
,kk_ `
$strkk` f
,kkf g
$strll 
,ll 
$strll "
,ll" #
$strll# 5
,ll5 6
$strll6 K
,llK L
$strllL ]
,ll] ^
$strll^ j
,llj k
$strmm 
,mm 
$strmm  
,mm  !
$strmm! -
,mm- .
$strmm. =
,mm= >
$strmm> F
,mmF G
$strmmG S
,mmS T
$strmmT _
,mm_ `
$strmm` l
,mml m
$strnn 
,nn 
$strnn 
,nn 
$strnn )
,nn) *
$strnn* 9
,nn9 :
$strnn: I
,nnI J
$strnnJ S
,nnS T
$strnnT ^
,nn^ _
$strnn_ l
,nnl m
$stroo 
,oo 
$stroo $
,oo$ %
$stroo% 3
,oo3 4
$stroo4 =
,oo= >
$stroo> P
,ooP Q
$strooQ d
,ood e
$strpp 
,pp 
$strpp %
,pp% &
$strpp& 4
,pp4 5
$strpp5 <
,pp< =
$strpp= J
,ppJ K
$strppK R
,ppR S
$strppS `
,pp` a
$strppa k
,ppk l
$strqq 
,qq 
$strqq 
,qq 
$strqq 
,qq  
$strqq  .
,qq. /
$strqq/ >
,qq> ?
$strqq? R
,qqR S
$strqqS Z
,qqZ [
$strqq[ h
,qqh i
$strrr 
,rr 
$strrr 
,rr 
$strrr (
,rr( )
$strrr) :
,rr: ;
$strrr; H
,rrH I
$strrrI Y
,rrY Z
$strrrZ _
,rr_ `
$strss 
,ss 
$strss #
,ss# $
$strss$ 0
,ss0 1
$strss1 ?
,ss? @
$strss@ H
,ssH I
$strssI V
,ssV W
$strssW _
,ss_ `
$strss` g
,ssg h
$strtt 
,tt 
$strtt 
}uu 
;uu 
privateww 	
staticww
 
stringww 
[ww 
]ww $
attrsAllowedWhenNoScriptww 2
=xx 
{xx 
$strxx 
,xx 
$strxx 
,xx 
$strxx $
,xx$ %
$strxx& -
,xx- .
$strxx/ 4
,xx4 5
$strxx6 <
,xx< =
$strxx> G
,xxG H
$strxxI Q
,xxQ R
$strxxS `
,xx` a
$stryy 
,yy 
$stryy 
,yy 
$stryy "
,yy" #
$stryy$ -
,yy- .
$stryy/ 6
,yy6 7
$stryy8 >
,yy> ?
$stryy@ G
,yyG H
$stryyI O
,yyO P
$stryyQ Z
,yyZ [
$stryy\ e
,yye f
$strzz 
,zz 
$strzz 
,zz 
$strzz !
,zz! "
$strzz# )
,zz) *
$strzz+ 2
,zz2 3
$strzz4 A
,zzA B
$strzzC L
,zzL M
$strzzN V
,zzV W
$strzzX ^
,zz^ _
$strzz` j
,zzj k
$strzzl p
,zzp q
$str{{ 
,{{ 
$str{{ 
,{{ 
$str{{ 
,{{  
$str{{! +
,{{+ ,
$str{{- ;
,{{; <
$str{{= J
,{{J K
$str{{L R
,{{R S
$str{{T ]
,{{] ^
$str{{_ g
,{{g h
$str|| 
,|| 
$str|| 
,|| 
$str|| 
,|| 
$str|| $
,||$ %
$str||& /
,||/ 0
$str||1 8
,||8 9
$str||: A
,||A B
$str||C I
,||I J
$str||K Q
,||Q R
$str||S Z
,||Z [
$str||\ e
,||e f
$str}} 
,}} 
$str}} 
,}} 
$str}} 
,}}  
$str}}! (
,}}( )
$str}}* 1
,}}1 2
$str}}3 =
,}}= >
$str}}? J
}~~ 
;~~ 
private
ÄÄ 	
static
ÄÄ
 
StringDictionary
ÄÄ !#
AllowedAttributeNames
ÄÄ" 7
=
ÄÄ8 9
GetDict
ÄÄ: A
(
ÄÄA B&
attrsAllowedWhenNoScript
ÄÄB Z
)
ÄÄZ [
;
ÄÄ[ \
private
ÇÇ 	
static
ÇÇ
 
StringDictionary
ÇÇ !"
AllowedPropertyNames
ÇÇ" 6
=
ÇÇ7 8
GetDict
ÇÇ9 @
(
ÇÇ@ A&
propsAllowedWhenNoScript
ÇÇA Y
)
ÇÇY Z
;
ÇÇZ [
private
ÑÑ 	
static
ÑÑ
 
StringDictionary
ÑÑ !
GetDict
ÑÑ" )
(
ÑÑ) *
string
ÑÑ* 0
[
ÑÑ0 1
]
ÑÑ1 2
keys
ÑÑ3 7
)
ÑÑ7 8
{
ÖÖ 
StringDictionary
ÜÜ 
dict
ÜÜ 
=
ÜÜ 
new
ÜÜ 
StringDictionary
ÜÜ /
(
ÜÜ/ 0
)
ÜÜ0 1
;
ÜÜ1 2
for
áá 
(
áá 
int
áá 
i
áá 
=
áá 
$num
áá 
;
áá 
i
áá 
<
áá 
keys
áá 
.
áá 
Length
áá "
;
áá" #
i
áá$ %
++
áá% '
)
áá' (
{
àà 
dict
ââ 
.
ââ 	
Add
ââ	 
(
ââ 
keys
ââ 
[
ââ 
i
ââ 
]
ââ 
,
ââ 
$str
ââ 
)
ââ 
;
ââ 
}
ää 
return
ãã 	
dict
ãã
 
;
ãã 
}
åå 
private
èè 	
static
èè
 
string
èè $
StylePropValueREString
èè .
=
èè/ 0
$str
èè1 U
;
èèU V
private
ëë 	
static
ëë
 
Regex
ëë #
StyleAttributeValueRE
ëë ,
=
íí 
new
íí 
Regex
íí	 
(
íí 
$str
íí 2
+
íí3 4$
StylePropValueREString
íí5 K
+
ííL M
$str
ííN ]
+
ìì &
propsAllowedWhenNoScript
ìì  
.
ìì  !
Length
ìì! '
+
ìì( )
$str
ìì* .
,
ìì. /
RegexOptions
îî 
.
îî 
Compiled
îî 
|
îî 
RegexOptions
îî *
.
îî* +

IgnoreCase
îî+ 5
)
îî5 6
;
îî6 7
private
ññ 	
static
ññ
 
string
ññ 
ParserResetString
ññ )
=
ññ* +
$str
ññ, b
;
ññb c
private
™™ 	
static
™™
 
string
™™ 
Format
™™ 
=
™™  
$str
™µ! N
;
µµN O
private
∑∑ 	
static
∑∑
 
string
∑∑ 
[
∑∑ 
]
∑∑ %
tagsAllowedWhenNoScript
∑∑ 1
=
∏∏ 
{
∏∏ 
$str
∏∏ 

,
∏∏
 
$str
∏∏ 
,
∏∏ 
$str
∏∏ 
,
∏∏ 
$str
∏∏ (
,
∏∏( )
$str
∏∏* -
,
∏∏- .
$str
∏∏/ 9
,
∏∏9 :
$str
∏∏; @
,
∏∏@ A
$str
∏∏B G
,
∏∏G H
$str
∏∏I U
,
∏∏U V
$str
∏∏W [
,
∏∏[ \
$str
ππ 
,
ππ 
$str
ππ 
,
ππ 
$str
ππ  
,
ππ  !
$str
ππ" (
,
ππ( )
$str
ππ* /
,
ππ/ 0
$str
ππ1 ;
,
ππ; <
$str
ππ= A
,
ππA B
$str
ππC H
,
ππH I
$str
ππJ O
,
ππO P
$str
ππQ V
,
ππV W
$str
ππX ]
,
ππ] ^
$str
ππ_ c
,
ππc d
$str
ππe i
,
ππi j
$str
∫∫ 	
,
∫∫	 

$str
∫∫ 
,
∫∫ 
$str
∫∫ 
,
∫∫ 
$str
∫∫ 
,
∫∫ 
$str
∫∫ #
,
∫∫# $
$str
∫∫% )
,
∫∫) *
$str
∫∫+ /
,
∫∫/ 0
$str
∫∫1 5
,
∫∫5 6
$str
∫∫7 ;
,
∫∫; <
$str
∫∫= @
,
∫∫@ A
$str
∫∫B G
,
∫∫G H
$str
∫∫I N
,
∫∫N O
$str
∫∫P T
,
∫∫T U
$str
∫∫V Z
,
∫∫Z [
$str
∫∫\ _
,
∫∫_ `
$str
∫∫a f
,
∫∫f g
$str
∫∫h k
,
∫∫k l
$str
ªª 
,
ªª 	
$str
ªª
 
,
ªª 
$str
ªª 
,
ªª 
$str
ªª !
,
ªª! "
$str
ªª# +
,
ªª+ ,
$str
ªª- 5
,
ªª5 6
$str
ªª7 <
,
ªª< =
$str
ªª> C
,
ªªC D
$str
ªªE L
,
ªªL M
$str
ªªN U
,
ªªU V
$str
ªªW [
,
ªª[ \
$str
ªª] d
,
ªªd e
$str
ªªf j
,
ªªj k
$str
ºº 
,
ºº 
$str
ºº 
,
ºº 
$str
ºº 
,
ºº 
$str
ºº 
,
ºº 
$str
ºº #
,
ºº# $
$str
ºº% *
,
ºº* +
$str
ΩΩ 
}
ƒƒ 
;
ƒƒ 
private
∆∆ 	
static
∆∆
 
	Hashtable
∆∆ 

InfoForTag
∆∆ %
=
∆∆& '
GetInfoForTags
∆∆( 6
(
∆∆6 7
)
∆∆7 8
;
∆∆8 9
private
»» 	
static
»»
 
	Hashtable
»» 
GetInfoForTags
»» )
(
»») *
)
»»* +
{
…… 
	Hashtable
   
dict
   
=
   
new
   
	Hashtable
   !
(
  ! "
)
  " #
;
  # $
for
ÀÀ 
(
ÀÀ 
int
ÀÀ 
i
ÀÀ 
=
ÀÀ 
$num
ÀÀ 
;
ÀÀ 
i
ÀÀ 
<
ÀÀ %
tagsAllowedWhenNoScript
ÀÀ .
.
ÀÀ. /
Length
ÀÀ/ 5
;
ÀÀ5 6
i
ÀÀ7 8
++
ÀÀ8 :
)
ÀÀ: ;
{
ÃÃ 
dict
ÕÕ 
[
ÕÕ 	%
tagsAllowedWhenNoScript
ÕÕ	  
[
ÕÕ  !
i
ÕÕ! "
]
ÕÕ" #
]
ÕÕ# $
=
ÕÕ% &
TagInfo
ÕÕ' .
.
ÕÕ. /
NOT_TABLE_RELATED
ÕÕ/ @
;
ÕÕ@ A
}
ŒŒ 
dict
œœ 
[
œœ 
$str
œœ 
]
œœ 
=
œœ 
TagInfo
œœ 
.
œœ 
TABLE
œœ  
;
œœ  !
dict
–– 
[
–– 
$str
–– 
]
–– 
=
–– 
dict
–– 
[
–– 
$str
–– 
]
–– 
=
–– 
TagInfo
–– $
.
––$ %

TABLE_CELL
––% /
;
––/ 0
dict
—— 
[
—— 
$str
—— 
]
—— 
=
—— 
dict
—— 
[
—— 
$str
—— $
]
——$ %
=
——& '
dict
——( ,
[
——, -
$str
——- 2
]
——2 3
=
——4 5
dict
——6 :
[
——: ;
$str
——; B
]
——B C
=
““ 
dict
““ 

[
““
 
$str
““ 
]
““ 
=
““ 
dict
““ 
[
““ 
$str
““ "
]
““" #
=
““$ %
dict
““& *
[
““* +
$str
““+ /
]
““/ 0
=
”” 
TagInfo
”” 
.
”” 
TABLE_OTHER
”” 
;
”” 
return
‘‘ 	
dict
‘‘
 
;
‘‘ 
}
’’ 
private
◊◊ 	
static
◊◊
 
Regex
◊◊ 
JailRE
◊◊ 
=
ÿÿ 
new
ÿÿ 
Regex
ÿÿ	 
(
ÿÿ 
$str
ÿÿ 
+
⁄⁄	 

$str
⁄⁄ 
+
€€
 
$str
€€ 
+
‹‹ 
$str
‹‹ 
+
ﬁﬁ 
$str
ﬁﬁ '
+
‡‡ 
$str
‡‡ ?
+
·· 
$str
·· 
+
‚‚ 
$str
‚‚ 
+
„„ 
$str
„„ 
+
ÂÂ 
$str
ÂÂ #
+
ÁÁ 
$str
ÁÁ  
+
ÈÈ 
$str
ÈÈ &
+
ÍÍ 
$str
ÍÍ 
+
ÎÎ 
$str
ÎÎ -
+
ÌÌ 
$str
ÌÌ ?
+
ÓÓ 
$str
ÓÓ 
+
ÓÓ &
attrsAllowedWhenNoScript
ÓÓ 3
.
ÓÓ3 4
Length
ÓÓ4 :
+
ÓÓ; <
$str
ÓÓ= @
+
 
$str
 #
+
ÒÒ 
$str
ÒÒ 
+
ÚÚ
 
$str
ÚÚ 
+
ÛÛ	 

$str
ÛÛ 
+
ÙÙ	 

$str
ÙÙ 
+
ıı 	
$str
ıı
 
,
ıı 
RegexOptions
ˆˆ 
.
ˆˆ 
Compiled
ˆˆ 
|
ˆˆ 
RegexOptions
ˆˆ  ,
.
ˆˆ, -

IgnoreCase
ˆˆ- 7
|
ˆˆ8 9
RegexOptions
ˆˆ: F
.
ˆˆF G
	Multiline
ˆˆG P
)
ˆˆP Q
;
ˆˆQ R
private
¯¯ 	
string
¯¯
 
	GuardJail
¯¯ 
(
¯¯ 
Match
¯¯  
m
¯¯! "
)
¯¯" #
{
˘˘ 
if
˙˙ 
(
˙˙ 

Complexity
˙˙ 
++
˙˙ 
>
˙˙ 
MaxComplexity
˙˙ #
)
˙˙# $
throw
˙˙% *
new
˙˙+ .(
ContentTooComplexException
˙˙/ I
(
˙˙I J
)
˙˙J K
;
˙˙K L
if
˚˚ 
(
˚˚ 
m
˚˚ 
.
˚˚ 	
Groups
˚˚	 
[
˚˚ 
$num
˚˚ 
]
˚˚ 
.
˚˚ 
Success
˚˚ 
)
˚˚ 
return
¸¸ 

$str
¸¸ 
;
¸¸ 
if
˝˝ 
(
˝˝ 
m
˝˝ 
.
˝˝ 	
Groups
˝˝	 
[
˝˝ 
$num
˝˝ 
]
˝˝ 
.
˝˝ 
Success
˝˝ 
)
˝˝ 
return
˛˛ 

$str
˛˛ 
;
˛˛ 
if
ˇˇ 
(
ˇˇ 
m
ˇˇ 
.
ˇˇ 	
Groups
ˇˇ	 
[
ˇˇ 
$num
ˇˇ 
]
ˇˇ 
.
ˇˇ 
Success
ˇˇ 
)
ˇˇ 
return
ÄÄ 

HttpUtility
ÄÄ 
.
ÄÄ 

HtmlEncode
ÄÄ !
(
ÄÄ! "
m
ÄÄ" #
.
ÄÄ# $
Groups
ÄÄ$ *
[
ÄÄ* +
$num
ÄÄ+ ,
]
ÄÄ, -
.
ÄÄ- .
Value
ÄÄ. 3
)
ÄÄ3 4
;
ÄÄ4 5
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
m
ÅÅ 	
.
ÅÅ	 

Groups
ÅÅ
 
[
ÅÅ 
$num
ÅÅ 
]
ÅÅ 
.
ÅÅ 
Success
ÅÅ 
||
ÇÇ 
!
ÇÇ 
m
ÇÇ 	
.
ÇÇ	 

Groups
ÇÇ
 
[
ÇÇ 
$num
ÇÇ 
]
ÇÇ 
.
ÇÇ 
Success
ÇÇ 
||
ÉÉ 
(
ÉÉ 
m
ÉÉ 	
.
ÉÉ	 

Groups
ÉÉ
 
[
ÉÉ 
$num
ÉÉ 
]
ÉÉ 
.
ÉÉ 
Success
ÉÉ 
&&
ÑÑ 
(
ÑÑ 	
m
ÑÑ	 

.
ÑÑ
 
Groups
ÑÑ 
[
ÑÑ 
$num
ÑÑ 
]
ÑÑ 
.
ÑÑ 
Success
ÑÑ 
||
ÖÖ 
m
ÖÖ	 

.
ÖÖ
 
Groups
ÖÖ 
[
ÖÖ 
$num
ÖÖ 
]
ÖÖ 
.
ÖÖ 
Value
ÖÖ 
.
ÖÖ 
EndsWith
ÖÖ $
(
ÖÖ$ %
$str
ÖÖ% )
)
ÖÖ) *
)
ÖÖ* +
)
ÖÖ+ ,
)
ÖÖ, -
{
ÜÜ 
return
ââ 

$str
ââ 
+
ââ  !
m
ââ" #
.
ââ# $
Value
ââ$ )
.
ââ) *
	Substring
ââ* 3
(
ââ3 4
$num
ââ4 5
)
ââ5 6
;
ââ6 7
}
ää 
string
çç 	
	lcTagName
çç
 
=
çç 
m
çç 
.
çç 
Groups
çç 
[
çç 
$num
çç  
]
çç  !
.
çç! "
Value
çç" '
.
çç' (
ToLower
çç( /
(
çç/ 0
)
çç0 1
;
çç1 2
StringBuilder
êê 
attrsBuilder
êê 
=
êê 
new
êê  #
StringBuilder
êê$ 1
(
êê1 2
)
êê2 3
;
êê3 4
int
ëë 
v
ëë 
=
ëë	 

$num
ëë 
;
ëë 
for
íí 
(
íí 
int
íí 
a
íí 
=
íí 
$num
íí 
;
íí 
a
íí 
<
íí 
m
íí 
.
íí 
Groups
íí 
[
íí  
$num
íí  !
]
íí! "
.
íí" #
Captures
íí# +
.
íí+ ,
Count
íí, 1
;
íí1 2
a
íí3 4
++
íí4 6
)
íí6 7
{
ìì 
if
îî 
(
îî 

Complexity
îî 
++
îî 
>
îî 
MaxComplexity
îî $
)
îî$ %
throw
îî& +
new
îî, /(
ContentTooComplexException
îî0 J
(
îîJ K
)
îîK L
;
îîL M
string
ïï 

attrName
ïï 
=
ïï 
m
ïï 
.
ïï 
Groups
ïï 
[
ïï 
$num
ïï  
]
ïï  !
.
ïï! "
Captures
ïï" *
[
ïï* +
a
ïï+ ,
]
ïï, -
.
ïï- .
Value
ïï. 3
;
ïï3 4
string
ññ 

equalsQuotedValue
ññ 
=
ññ 
m
ññ  
.
ññ  !
Groups
ññ! '
[
ññ' (
$num
ññ( )
]
ññ) *
.
ññ* +
Captures
ññ+ 3
[
ññ3 4
a
ññ4 5
]
ññ5 6
.
ññ6 7
Value
ññ7 <
;
ññ< =
string
óó 

quotedValue
óó 
=
óó 
$str
óó 
+
óó 
attrName
óó  (
+
óó) *
$str
óó+ /
;
óó/ 0
if
òò 
(
òò 
equalsQuotedValue
òò 
.
òò 
Length
òò  
>
òò! "
$num
òò# $
)
òò$ %
{
ôô 
quotedValue
öö 
=
öö 
m
öö 
.
öö 
Groups
öö 
[
öö 
$num
öö 
]
öö 
.
öö 
Captures
öö '
[
öö' (
v
öö( )
]
öö) *
.
öö* +
Value
öö+ 0
;
öö0 1
if
õõ 
(
õõ 	
quotedValue
õõ	 
[
õõ 
$num
õõ 
]
õõ 
!=
õõ 
$char
õõ 
&&
õõ !
quotedValue
õõ" -
[
õõ- .
$num
õõ. /
]
õõ/ 0
!=
õõ1 3
$char
õõ4 8
)
õõ8 9
quotedValue
úú 
=
úú 
$str
úú 
+
úú 
quotedValue
úú &
.
úú& '
Replace
úú' .
(
úú. /
$str
úú/ 3
,
úú3 4
$str
úú5 =
)
úú= >
+
úú? @
$str
úúA E
;
úúE F
v
ùù 
++
ùù 
;
ùù 	
}
ûû 
string
üü 


lcAttrName
üü 
=
üü 
attrName
üü  
.
üü  !
ToLower
üü! (
(
üü( )
)
üü) *
;
üü* +
if
†† 
(
†† 

lcAttrName
†† 
==
†† 
$str
†† 
&&
†† 
equalsQuotedValue
††  1
.
††1 2
Length
††2 8
>
††9 :
$num
††; <
)
††< =
{
°° 
string
¢¢ 
unquotedValue
¢¢ 
=
¢¢ 
quotedValue
¢¢ '
.
¢¢' (
	Substring
¢¢( 1
(
¢¢1 2
$num
¢¢2 3
,
¢¢3 4
quotedValue
¢¢5 @
.
¢¢@ A
Length
¢¢A G
-
¢¢G H
$num
¢¢H I
)
¢¢I J
;
¢¢J K
if
££ 
(
££ 	"
SpamFreeLinkUrlRegex
££	 
==
££  
null
££! %
||
££& (
!
££) *"
SpamFreeLinkUrlRegex
££* >
.
££> ?
IsMatch
££? F
(
££F G
unquotedValue
££G T
)
££T U
)
££U V
{
§§ 
attrsBuilder
•• 
.
•• 
Append
•• 
(
•• 
$str
•• -
)
••- .
;
••. /
}
¶¶ 
}
ßß 
if
®® 
(
®® #
AllowedAttributeNames
®® 
.
®® 
ContainsKey
®® )
(
®®) *

lcAttrName
®®* 4
)
®®4 5
)
®®5 6
{
©© 
attrsBuilder
™™ 
.
™™ 
Append
™™ 
(
™™ 
$str
™™ 
+
™™ 
attrName
™™ '
+
™™( )
$str
™™* -
+
™™. /
quotedValue
™™0 ;
)
™™; <
;
™™< =
continue
´´ 
;
´´ 
}
¨¨ 
if
≠≠ 
(
≠≠ 

lcAttrName
≠≠ 
==
≠≠ 
$str
≠≠ 
&&
≠≠  
equalsQuotedValue
≠≠! 2
.
≠≠2 3
Length
≠≠3 9
>
≠≠: ;
$num
≠≠< =
)
≠≠= >
{
ÆÆ 
Match
ØØ 

savMatch
ØØ 
=
ØØ #
StyleAttributeValueRE
ØØ +
.
ØØ+ ,
Match
ØØ, 1
(
ØØ1 2
quotedValue
ØØ2 =
.
ØØ= >
	Substring
ØØ> G
(
ØØG H
$num
ØØH I
,
ØØI J
quotedValue
ØØK V
.
ØØV W
Length
ØØW ]
-
ØØ] ^
$num
ØØ^ _
)
ØØ_ `
)
ØØ` a
;
ØØa b
if
∞∞ 
(
∞∞ 	
savMatch
∞∞	 
.
∞∞ 
Success
∞∞ 
)
∞∞ 
{
±± 
int
≤≤ 	
p
≤≤
 
=
≤≤ 
$num
≤≤ 
;
≤≤ 
for
≥≥ 	
(
≥≥
 
;
≥≥ 
p
≥≥ 
<
≥≥ 
savMatch
≥≥ 
.
≥≥ 
Groups
≥≥ 
[
≥≥  
$num
≥≥  !
]
≥≥! "
.
≥≥" #
Captures
≥≥# +
.
≥≥+ ,
Count
≥≥, 1
;
≥≥1 2
p
≥≥3 4
++
≥≥4 6
)
≥≥6 7
{
¥¥ 
if
µµ 	
(
µµ
 

Complexity
µµ 
++
µµ 
>
µµ 
MaxComplexity
µµ '
)
µµ' (
throw
µµ) .
new
µµ/ 2(
ContentTooComplexException
µµ3 M
(
µµM N
)
µµN O
;
µµO P
string
∂∂ 

lcPropName
∂∂ 
=
∂∂ 
savMatch
∂∂ $
.
∂∂$ %
Groups
∂∂% +
[
∂∂+ ,
$num
∂∂, -
]
∂∂- .
.
∂∂. /
Captures
∂∂/ 7
[
∂∂7 8
p
∂∂8 9
]
∂∂9 :
.
∂∂: ;
Value
∂∂; @
.
∂∂@ A
ToLower
∂∂A H
(
∂∂H I
)
∂∂I J
;
∂∂J K
if
∑∑ 	
(
∑∑
 
!
∑∑ "
AllowedPropertyNames
∑∑  
.
∑∑  !
ContainsKey
∑∑! ,
(
∑∑, -

lcPropName
∑∑- 7
)
∑∑7 8
)
∑∑8 9
break
∏∏ 
;
∏∏ 
}
ππ 
if
∫∫ 
(
∫∫	 

p
∫∫
 
==
∫∫ 
savMatch
∫∫ 
.
∫∫ 
Groups
∫∫ 
[
∫∫ 
$num
∫∫  
]
∫∫  !
.
∫∫! "
Captures
∫∫" *
.
∫∫* +
Count
∫∫+ 0
)
∫∫0 1
{
ªª 
attrsBuilder
ºº 
.
ºº 
Append
ºº 
(
ºº 
$str
ºº 
+
ºº  
attrName
ºº! )
+
ºº* +
$str
ºº, /
+
ºº0 1
quotedValue
ºº2 =
)
ºº= >
;
ºº> ?
continue
ΩΩ 
;
ΩΩ 
}
ææ 
}
øø 
}
¿¿ 
if
¡¡ 
(
¡¡ "
TrustedImageUrlRegex
¡¡ 
!=
¡¡ 
null
¡¡  $
&&
¬¬ 

	lcTagName
¬¬ 
==
¬¬ 
$str
¬¬ 
&&
¬¬  

lcAttrName
¬¬! +
==
¬¬, .
$str
¬¬/ 4
&&
¬¬5 7
equalsQuotedValue
¬¬8 I
.
¬¬I J
Length
¬¬J P
>
¬¬Q R
$num
¬¬S T
)
¬¬T U
{
√√ 
string
ƒƒ 
unquotedValue
ƒƒ 
=
ƒƒ 
quotedValue
ƒƒ '
.
ƒƒ' (
	Substring
ƒƒ( 1
(
ƒƒ1 2
$num
ƒƒ2 3
,
ƒƒ3 4
quotedValue
ƒƒ5 @
.
ƒƒ@ A
Length
ƒƒA G
-
ƒƒG H
$num
ƒƒH I
)
ƒƒI J
;
ƒƒJ K
if
≈≈ 
(
≈≈ 	"
TrustedImageUrlRegex
≈≈	 
.
≈≈ 
IsMatch
≈≈ %
(
≈≈% &
unquotedValue
≈≈& 3
)
≈≈3 4
)
≈≈4 5
{
∆∆ 
attrsBuilder
«« 
.
«« 
Append
«« 
(
«« 
$str
«« 
+
«« 
attrName
««  (
+
««) *
$str
««+ .
+
««/ 0
quotedValue
««1 <
)
««< =
;
««= >
continue
»» 
;
»» 
}
…… 
}
   
attrsBuilder
ÀÀ 
.
ÀÀ 
Append
ÀÀ 
(
ÀÀ 
$str
ÀÀ 
+
ÀÀ 
attrName
ÀÀ &
+
ÀÀ' (
$str
ÀÀ) <
+
ÀÀ= >
quotedValue
ÀÀ? J
)
ÀÀJ K
;
ÀÀK L
}
ÃÃ 
string
ÕÕ 	
attrs
ÕÕ
 
=
ÕÕ 
attrsBuilder
ÕÕ 
.
ÕÕ 
ToString
ÕÕ '
(
ÕÕ' (
)
ÕÕ( )
;
ÕÕ) *
if
œœ 
(
œœ "
TrustedImageUrlRegex
œœ 
!=
œœ 
null
œœ #
&&
œœ$ &
	lcTagName
œœ' 0
==
œœ1 3
$str
œœ4 9
)
œœ9 :
return
–– 

$str
–– 
+
–– 
m
–– 
.
–– 
Groups
–– 
[
–– 
$num
–– 
]
–– 
.
–– 
Value
–– "
+
––# $
m
––% &
.
––& '
Groups
––' -
[
––- .
$num
––. /
]
––/ 0
.
––0 1
Value
––1 6
+
––7 8
attrs
––9 >
+
––? @
m
––A B
.
––B C
Groups
––C I
[
––I J
$num
––J L
]
––L M
;
––M N
TagInfo
““ 

tagInfo
““ 
=
““ 

InfoForTag
““ 
[
““  
	lcTagName
““  )
]
““) *
as
““+ -
TagInfo
““. 5
;
““5 6
if
”” 
(
”” 
tagInfo
”” 
==
”” 
null
”” 
||
‘‘ 
(
‘‘ 
!
‘‘ 	#
SupportNoScriptTables
‘‘	 
&&
’’ 
tagInfo
’’ 
.
’’ 
IsTableRelated
’’ 
)
’’ 
)
’’  
return
÷÷ 

$str
÷÷ 
+
÷÷ 
m
÷÷ 
.
÷÷ 
Groups
÷÷ 
[
÷÷ 
$num
÷÷ 
]
÷÷ 
.
÷÷ 
Value
÷÷ "
+
÷÷# $
$str
÷÷% 7
+
÷÷8 9
m
÷÷: ;
.
÷÷; <
Groups
÷÷< B
[
÷÷B C
$num
÷÷C D
]
÷÷D E
.
÷÷E F
Value
÷÷F K
+
÷÷L M
attrs
÷÷N S
+
÷÷T U
m
÷÷V W
.
÷÷W X
Groups
÷÷X ^
[
÷÷^ _
$num
÷÷_ a
]
÷÷a b
;
÷÷b c
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
tagInfo
ÿÿ 
.
ÿÿ 
IsTableRelated
ÿÿ 
)
ÿÿ 
return
ŸŸ 

$str
ŸŸ 
+
ŸŸ 
m
ŸŸ 
.
ŸŸ 
Groups
ŸŸ 
[
ŸŸ 
$num
ŸŸ 
]
ŸŸ 
.
ŸŸ 
Value
ŸŸ "
+
ŸŸ# $
m
ŸŸ% &
.
ŸŸ& '
Groups
ŸŸ' -
[
ŸŸ- .
$num
ŸŸ. /
]
ŸŸ/ 0
.
ŸŸ0 1
Value
ŸŸ1 6
+
ŸŸ7 8
attrs
ŸŸ9 >
+
ŸŸ? @
m
ŸŸA B
.
ŸŸB C
Groups
ŸŸC I
[
ŸŸI J
$num
ŸŸJ L
]
ŸŸL M
;
ŸŸM N
if
‹‹ 
(
‹‹ 
!
‹‹ 
m
‹‹ 	
.
‹‹	 

Groups
‹‹
 
[
‹‹ 
$num
‹‹ 
]
‹‹ 
.
‹‹ 
Success
‹‹ 
)
‹‹ 
{
›› 
if
ﬁﬁ 
(
ﬁﬁ 
tagInfo
ﬁﬁ 
.
ﬁﬁ 
IsTable
ﬁﬁ 
)
ﬁﬁ 
{
ﬂﬂ 
if
‡‡ 
(
‡‡ 	
!
‡‡	 

IsTableAllowed
‡‡
 
)
‡‡ 
return
·· 
$str
·· 
+
·· 
m
·· 
.
·· 
Groups
·· 
[
·· 
$num
·· 
]
·· 
.
·· 
Value
·· $
+
··% &
$str
··' 9
+
··: ;
m
··< =
.
··= >
Groups
··> D
[
··D E
$num
··E F
]
··F G
.
··G H
Value
··H M
+
··N O
attrs
··P U
+
··V W
m
··X Y
.
··Y Z
Groups
··Z `
[
··` a
$num
··a c
]
··c d
;
··d e
else
‚‚ 	
{
„„ 
IsTableAllowed
‰‰ 
=
‰‰ 
false
‰‰ 
;
‰‰ 
UntrustedTables
ÂÂ 
++
ÂÂ 
;
ÂÂ 
return
ÊÊ 
ParserResetString
ÊÊ 
+
ÊÊ  
$str
ÊÊ! $
+
ÊÊ% &
m
ÊÊ' (
.
ÊÊ( )
Groups
ÊÊ) /
[
ÊÊ/ 0
$num
ÊÊ0 1
]
ÊÊ1 2
.
ÊÊ2 3
Value
ÊÊ3 8
+
ÊÊ9 :
m
ÊÊ; <
.
ÊÊ< =
Groups
ÊÊ= C
[
ÊÊC D
$num
ÊÊD E
]
ÊÊE F
.
ÊÊF G
Value
ÊÊG L
+
ÊÊM N
attrs
ÊÊO T
+
ÊÊU V
m
ÊÊW X
.
ÊÊX Y
Groups
ÊÊY _
[
ÊÊ_ `
$num
ÊÊ` b
]
ÊÊb c
;
ÊÊc d
}
ÁÁ 
}
ËË 
else
ÈÈ 
if
ÈÈ	 
(
ÈÈ 
tagInfo
ÈÈ 
.
ÈÈ 
IsTableCell
ÈÈ  
)
ÈÈ  !
{
ÍÍ 
IsTableAllowed
ÎÎ 
=
ÎÎ 
true
ÎÎ 
;
ÎÎ 
return
ÏÏ 
ParserResetString
ÏÏ 
+
ÏÏ 
$str
ÏÏ  #
+
ÏÏ$ %
m
ÏÏ& '
.
ÏÏ' (
Groups
ÏÏ( .
[
ÏÏ. /
$num
ÏÏ/ 0
]
ÏÏ0 1
.
ÏÏ1 2
Value
ÏÏ2 7
+
ÏÏ8 9
m
ÏÏ: ;
.
ÏÏ; <
Groups
ÏÏ< B
[
ÏÏB C
$num
ÏÏC D
]
ÏÏD E
.
ÏÏE F
Value
ÏÏF K
+
ÏÏL M
attrs
ÏÏN S
+
ÏÏT U
m
ÏÏV W
.
ÏÏW X
Groups
ÏÏX ^
[
ÏÏ^ _
$num
ÏÏ_ a
]
ÏÏa b
;
ÏÏb c
}
ÌÌ 
}
ÓÓ 
else
ÔÔ 
{
 
if
ÒÒ 
(
ÒÒ 
UntrustedTables
ÒÒ 
<=
ÒÒ 
$num
ÒÒ 
)
ÒÒ 
return
ÚÚ 
$str
ÚÚ 
+
ÚÚ 
m
ÚÚ 
.
ÚÚ 
Groups
ÚÚ 
[
ÚÚ 
$num
ÚÚ 
]
ÚÚ 
.
ÚÚ 
Value
ÚÚ #
+
ÚÚ$ %
$str
ÚÚ& 8
+
ÚÚ9 :
m
ÚÚ; <
.
ÚÚ< =
Groups
ÚÚ= C
[
ÚÚC D
$num
ÚÚD E
]
ÚÚE F
.
ÚÚF G
Value
ÚÚG L
+
ÚÚM N
attrs
ÚÚO T
+
ÚÚU V
m
ÚÚW X
.
ÚÚX Y
Groups
ÚÚY _
[
ÚÚ_ `
$num
ÚÚ` b
]
ÚÚb c
;
ÚÚc d
if
ÛÛ 
(
ÛÛ 
tagInfo
ÛÛ 
.
ÛÛ 
IsTable
ÛÛ 
)
ÛÛ 
{
ÙÙ 
IsTableAllowed
ıı 
=
ıı 
true
ıı 
;
ıı 
UntrustedTables
ˆˆ 
--
ˆˆ 
;
ˆˆ 
return
˜˜ 
ParserResetString
˜˜ 
+
˜˜ 
$str
˜˜  #
+
˜˜$ %
m
˜˜& '
.
˜˜' (
Groups
˜˜( .
[
˜˜. /
$num
˜˜/ 0
]
˜˜0 1
.
˜˜1 2
Value
˜˜2 7
+
˜˜8 9
m
˜˜: ;
.
˜˜; <
Groups
˜˜< B
[
˜˜B C
$num
˜˜C D
]
˜˜D E
.
˜˜E F
Value
˜˜F K
+
˜˜L M
attrs
˜˜N S
+
˜˜T U
m
˜˜V W
.
˜˜W X
Groups
˜˜X ^
[
˜˜^ _
$num
˜˜_ a
]
˜˜a b
;
˜˜b c
}
¯¯ 
else
˘˘ 
IsTableAllowed
˙˙ 
=
˙˙ 
false
˙˙ 
;
˙˙ 
}
˚˚ 
return
¸¸ 	
$str
¸¸
 
+
¸¸ 
m
¸¸ 
.
¸¸ 
Groups
¸¸ 
[
¸¸ 
$num
¸¸ 
]
¸¸ 
.
¸¸ 
Value
¸¸ !
+
¸¸" #
m
¸¸$ %
.
¸¸% &
Groups
¸¸& ,
[
¸¸, -
$num
¸¸- .
]
¸¸. /
.
¸¸/ 0
Value
¸¸0 5
+
¸¸6 7
attrs
¸¸8 =
+
¸¸> ?
m
¸¸@ A
.
¸¸A B
Groups
¸¸B H
[
¸¸H I
$num
¸¸I K
]
¸¸K L
;
¸¸L M
}
˝˝ 
private
ˇˇ 	
int
ˇˇ
 
UntrustedTables
ˇˇ 
=
ˇˇ 
$num
ˇˇ  !
;
ˇˇ! "
private
ÄÄ 	
bool
ÄÄ
 
IsTableAllowed
ÄÄ 
=
ÄÄ 
true
ÄÄ  $
;
ÄÄ$ %
}
ÅÅ 
internal
ÉÉ 	
class
ÉÉ
 
TagInfo
ÉÉ 
{
ÑÑ 
internal
ÖÖ 

bool
ÖÖ 
IsTableRelated
ÖÖ 
=
ÖÖ  
false
ÖÖ! &
;
ÖÖ& '
internal
ÜÜ 

bool
ÜÜ 
IsTable
ÜÜ 
=
ÜÜ 
false
ÜÜ 
;
ÜÜ  
internal
áá 

bool
áá 
IsTableCell
áá 
=
áá 
false
áá #
;
áá# $
internal
àà 

TagInfo
àà 
(
àà 
bool
àà 
isTableRelated
àà &
,
àà& '
bool
àà( ,
isTable
àà- 4
,
àà4 5
bool
àà6 :
isTableCell
àà; F
)
ààF G
{
ââ 
IsTableRelated
ää 
=
ää 
isTableRelated
ää "
;
ää" #
IsTable
ãã 

=
ãã 
isTable
ãã 
;
ãã 
IsTableCell
åå 
=
åå 
isTableCell
åå 
;
åå 
}
çç 
internal
éé 

static
éé 
TagInfo
éé 
NOT_TABLE_RELATED
éé +
=
éé, -
new
éé. 1
TagInfo
éé2 9
(
éé9 :
false
éé: ?
,
éé? @
false
ééA F
,
ééF G
false
ééH M
)
ééM N
;
ééN O
internal
èè 

static
èè 
TagInfo
èè 
TABLE
èè 
=
èè  !
new
èè" %
TagInfo
èè& -
(
èè- .
true
èè. 2
,
èè2 3
true
èè4 8
,
èè8 9
false
èè: ?
)
èè? @
;
èè@ A
internal
êê 

static
êê 
TagInfo
êê 

TABLE_CELL
êê $
=
êê% &
new
êê' *
TagInfo
êê+ 2
(
êê2 3
true
êê3 7
,
êê7 8
false
êê9 >
,
êê> ?
true
êê@ D
)
êêD E
;
êêE F
internal
ëë 

static
ëë 
TagInfo
ëë 
TABLE_OTHER
ëë %
=
ëë& '
new
ëë( +
TagInfo
ëë, 3
(
ëë3 4
true
ëë4 8
,
ëë8 9
false
ëë: ?
,
ëë? @
false
ëëA F
)
ëëF G
;
ëëG H
}
íí 
internal
îî 	
class
îî
 (
ContentTooComplexException
îî *
:
îî+ ,
	Exception
îî- 6
{
ïï 
}
ññ 
}óó ¨
vD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\Brettle.Web.NeatHtml\Properties\AssemblyInfo.cs
[

 
assembly

 	
:

	 

CLSCompliant

 
(

 
true

 
)

 
]

 
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyDescription 
( 
$str q
)q r
]r s
[ 
assembly 	
:	 
!
AssemblyConfiguration  
(  !
$str! #
)# $
]$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str %
)% &
]& '
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str n
)n o
]o p
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[&& 
assembly&& 	
:&&	 

AssemblyVersion&& 
(&& 
$str&& $
)&&$ %
]&&% &
['' 
assembly'' 	
:''	 

AssemblyFileVersion'' 
('' 
$str'' (
)''( )
]'') * v
oD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\Brettle.Web.NeatHtml\UntrustedContent.cs
	namespace!! 	
Brettle!!
 
.!! 
Web!! 
.!! 
NeatHtml!! 
{"" 
[++ ,
 AspNetHostingPermissionAttribute++ %
(++% &
SecurityAction++& 4
.++4 5
Demand++5 ;
,++; <
Level++= B
=++C D(
AspNetHostingPermissionLevel++E a
.++a b
Minimal++b i
)++i j
]++j k
[,, ,
 AspNetHostingPermissionAttribute,, %
(,,& '
SecurityAction,,' 5
.,,5 6
InheritanceDemand,,6 G
,,,G H
Level,,I N
=,,O P(
AspNetHostingPermissionLevel,,Q m
.,,m n
Minimal,,n u
),,u v
],,v w
[-- 
ParseChildren-- 
(-- 
false-- 
)-- 
]-- 
[.. 
PersistChildren.. 
(.. 
true.. 
).. 
].. 
public44 
class44 
UntrustedContent44 
:44  
System44! '
.44' (
Web44( +
.44+ ,
UI44, .
.44. /
Control44/ 6
{55 
[<< 
DefaultValue<< 
(<< 
$str<< (
)<<( )
]<<) *
public== 
string==	  
ClientSideFilterName== $
{>> 
get?? 
{?? 
return??	 
(?? 
	ViewState?? 
[?? 
$str?? 1
]??1 2
!=??3 5
null??6 :
?@@ 
(@@ 
string@@ 
)@@ 
	ViewState@@ %
[@@% &
$str@@& <
]@@< =
:@@> ?
$str@@@ X
)@@X Y
;@@Y Z
}@@[ \
setAA 
{AA 
	ViewStateAA	 
[AA 
$strAA )
]AA) *
=AA+ ,
valueAA- 2
;AA2 3
}AA4 5
}BB 
[LL 
DefaultValueLL 
(LL 
falseLL 
)LL 
]LL 
publicMM 
boolMM	 !
SupportNoScriptTablesMM #
{NN 
getOO 
{OO 
returnOO	 
(OO 
	ViewStateOO 
[OO 
$strOO 2
]OO2 3
!=OO4 6
nullOO7 ;
&&OO< >
(OO? @
boolOO@ D
)OOD E
	ViewStateOOE N
[OON O
$strOOO f
]OOf g
)OOg h
;OOh i
}OOj k
setPP 
{PP 
	ViewStatePP	 
[PP 
$strPP *
]PP* +
=PP, -
valuePP. 3
;PP3 4
}PP5 6
}QQ 
[]] 
DefaultValue]] 
(]] 
$num]] 
)]] 
]]] 
public^^ 
int^^	 
MaxComplexity^^ 
{__ 
get`` 
{`` 
return``	 
(`` 
	ViewState`` 
[`` 
$str`` *
]``* +
!=``, .
null``/ 3
?``4 5
(``6 7
int``7 :
)``: ;
	ViewState``; D
[``D E
$str``E T
]``T U
:``V W
$num``X ]
)``] ^
;``^ _
}``` a
setaa 
{aa 
	ViewStateaa	 
[aa 
$straa "
]aa" #
=aa$ %
valueaa& +
;aa+ ,
}aa- .
}bb 
privatedd 	
booldd
 
IsDesignTimedd 
=dd 
(dd 
HttpContextdd *
.dd* +
Currentdd+ 2
==dd3 5
nulldd6 :
)dd: ;
;dd; <
privateii 	
staticii
 
Guidii 
CacheBustingGuidii &
=ii' (
Systemii) /
.ii/ 0
Guidii0 4
.ii4 5
NewGuidii5 <
(ii< =
)ii= >
;ii> ?
publicqq 
stringqq	 
ClientScriptUrlqq 
{rr 
getss 
{ss 
returnss	 
(ss 
stringss 
)ss 
	ViewStatess !
[ss! "
$strss" 3
]ss3 4
;ss4 5
}ss6 7
settt 
{tt 
	ViewStatett	 
[tt 
$strtt $
]tt$ %
=tt& '
valuett( -
;tt- .
}tt/ 0
}uu 
[zz 
DefaultValuezz 
(zz 
$strzz 
)zz 
]zz 
public{{ 
string{{	 "
TrustedImageUrlPattern{{ &
{|| 
get}} 
{}} 
return}}	 
(}} 
string}} 
)}} 
	ViewState}} !
[}}! "
$str}}" :
]}}: ;
;}}; <
}}}= >
set~~ 
{~~ 
	ViewState 
[ 
$str &
]& '
=( )
value* /
;/ 0#
_TrustedImageUrlRegex
ÄÄ 
=
ÄÄ 
new
ÄÄ 
Regex
ÄÄ  %
(
ÄÄ% &
value
ÄÄ& +
)
ÄÄ+ ,
;
ÄÄ, -
}
ÅÅ 
}
ÇÇ 
private
ÑÑ 	
Regex
ÑÑ
 #
_TrustedImageUrlRegex
ÑÑ %
=
ÑÑ& '
null
ÑÑ( ,
;
ÑÑ, -
private
ÖÖ 	
Regex
ÖÖ
 "
TrustedImageUrlRegex
ÖÖ $
{
ÜÜ 
get
áá 
{
áá 
if
àà 
(
àà #
_TrustedImageUrlRegex
àà 
==
àà  
null
àà! %
&&
àà& ($
TrustedImageUrlPattern
àà) ?
!=
àà@ B
null
ààC G
)
ààG H#
_TrustedImageUrlRegex
ââ 
=
ââ 
new
ââ  
Regex
ââ! &
(
ââ& '$
TrustedImageUrlPattern
ââ' =
)
ââ= >
;
ââ> ?
return
ää 
#
_TrustedImageUrlRegex
ää  
;
ää  !
}
ãã 
}
åå 
[
íí 
DefaultValue
íí 
(
íí 
$str
íí 
)
íí 
]
íí 
public
ìì 
string
ìì	 $
SpamFreeLinkUrlPattern
ìì &
{
îî 
get
ïï 
{
ïï 
return
ïï	 
(
ïï 
string
ïï 
)
ïï 
	ViewState
ïï !
[
ïï! "
$str
ïï" :
]
ïï: ;
;
ïï; <
}
ïï= >
set
ññ 
{
ññ 
	ViewState
óó 
[
óó 
$str
óó &
]
óó& '
=
óó( )
value
óó* /
;
óó/ 0#
_SpamFreeLinkUrlRegex
òò 
=
òò 
new
òò 
Regex
òò  %
(
òò% &
value
òò& +
)
òò+ ,
;
òò, -
}
ôô 
}
öö 
private
úú 	
Regex
úú
 #
_SpamFreeLinkUrlRegex
úú %
=
úú& '
null
úú( ,
;
úú, -
private
ùù 	
Regex
ùù
 "
SpamFreeLinkUrlRegex
ùù $
{
ûû 
get
üü 
{
üü 
if
†† 
(
†† #
_SpamFreeLinkUrlRegex
†† 
==
††  
null
††! %
&&
††& ($
SpamFreeLinkUrlPattern
††) ?
!=
††@ B
null
††C G
)
††G H#
_SpamFreeLinkUrlRegex
°° 
=
°° 
new
°°  
Regex
°°! &
(
°°& '$
SpamFreeLinkUrlPattern
°°' =
)
°°= >
;
°°> ?
return
¢¢ 
#
_SpamFreeLinkUrlRegex
¢¢  
;
¢¢  !
}
££ 
}
§§ 
internal
¶¶ 

static
¶¶ 
string
¶¶ "
ApplyAppPathModifier
¶¶ -
(
¶¶- .
string
¶¶. 4
url
¶¶5 8
)
¶¶8 9
{
ßß 
string
®® 	
appPath
®®
 
=
®® 
HttpContext
®® 
.
®®  
Current
®®  '
.
®®' (
Request
®®( /
.
®®/ 0
ApplicationPath
®®0 ?
;
®®? @
if
©© 
(
©© 
appPath
©© 
==
©© 
$str
©© 
)
©© 
{
™™ 
appPath
´´ 
=
´´ 
$str
´´ 
;
´´ 
}
¨¨ 
string
≠≠ 	

requestUrl
≠≠
 
=
≠≠ 
HttpContext
≠≠ "
.
≠≠" #
Current
≠≠# *
.
≠≠* +
Request
≠≠+ 2
.
≠≠2 3
RawUrl
≠≠3 9
;
≠≠9 :
string
ÆÆ 	
result
ÆÆ
 
=
ÆÆ 
HttpContext
ÆÆ 
.
ÆÆ 
Current
ÆÆ &
.
ÆÆ& '
Response
ÆÆ' /
.
ÆÆ/ 0"
ApplyAppPathModifier
ÆÆ0 D
(
ÆÆD E
url
ÆÆE H
)
ÆÆH I
;
ÆÆI J
if
±± 
(
±± 

requestUrl
±± 
.
±± 

StartsWith
±± 
(
±± 
appPath
±± $
+
±±% &
$str
±±' +
)
±±+ ,
&&
±±- /
!
±±0 1
result
±±1 7
.
±±7 8

StartsWith
±±8 B
(
±±B C
appPath
±±C J
+
±±K L
$str
±±M Q
)
±±Q R
)
±±R S
{
≤≤ 
if
≥≥ 
(
≥≥ 
url
≥≥ 
.
≥≥ 

StartsWith
≥≥ 
(
≥≥ 
$str
≥≥ 
)
≥≥ 
&&
≥≥ 
url
≥≥ "
.
≥≥" #

StartsWith
≥≥# -
(
≥≥- .
appPath
≥≥. 5
)
≥≥5 6
)
≥≥6 7
{
¥¥ 
url
µµ 
=
µµ	 

$str
µµ 
+
µµ 
url
µµ 
.
µµ 
Remove
µµ 
(
µµ 
$num
µµ 
,
µµ 
appPath
µµ &
.
µµ& '
Length
µµ' -
)
µµ- .
;
µµ. /
}
∂∂ 
if
∑∑ 
(
∑∑ 
url
∑∑ 
.
∑∑ 

StartsWith
∑∑ 
(
∑∑ 
$str
∑∑ 
)
∑∑ 
)
∑∑ 
{
∏∏ 
string
ππ 
[
ππ 
]
ππ "
compsOfPathWithinApp
ππ "
=
ππ# $

requestUrl
ππ% /
.
ππ/ 0
	Substring
ππ0 9
(
ππ9 :
appPath
ππ: A
.
ππA B
Length
ππB H
)
ππH I
.
ππI J
Split
ππJ O
(
ππO P
$char
ππP S
)
ππS T
;
ππT U
url
∫∫ 
=
∫∫	 

appPath
∫∫ 
+
∫∫ 
$str
∫∫ 
+
∫∫ "
compsOfPathWithinApp
∫∫ /
[
∫∫/ 0
$num
∫∫0 1
]
∫∫1 2
+
∫∫3 4
$str
∫∫5 8
+
∫∫9 :
url
∫∫; >
.
∫∫> ?
	Substring
∫∫? H
(
∫∫H I
$num
∫∫I J
)
∫∫J K
;
∫∫K L
}
ªª 
result
ºº 

=
ºº 
url
ºº 
;
ºº 
}
ΩΩ 
return
ææ 	
result
ææ
 
;
ææ 
}
øø 
	protected
¡¡ 
override
¡¡ 
void
¡¡ 
OnPreRender
¡¡ %
(
¡¡& '
	EventArgs
¡¡' 0
e
¡¡1 2
)
¡¡2 3
{
¬¬ 
if
√√ 
(
√√ 
!
√√ 
IsDesignTime
√√ 
)
√√ 
{
ƒƒ 
if
≈≈ 
(
≈≈ 
ClientScriptUrl
≈≈ 
==
≈≈ 
null
≈≈ 
)
≈≈  
{
∆∆ 
ClientScriptUrl
«« 
=
«« 
$str
«« /
;
««/ 0
}
»» 
if
…… 
(
…… 
!
…… 	
Page
……	 
.
…… 
ClientScript
…… 
.
…… +
IsClientScriptBlockRegistered
…… 8
(
……8 9
$str
……9 E
)
……E F
)
……F G
{
   
Page
ÀÀ 	
.
ÀÀ	 

ClientScript
ÀÀ
 
.
ÀÀ '
RegisterClientScriptBlock
ÀÀ 0
(
ÀÀ0 1
typeof
ÀÀ1 7
(
ÀÀ7 8
Page
ÀÀ8 <
)
ÀÀ< =
,
ÀÀ= >
$str
ÀÀ> J
,
ÀÀJ K
$str
ÀÃL <
+
ÃÃ= >"
ApplyAppPathModifier
ÃÃ? S
(
ÃÃS T
ClientScriptUrl
ÃÃT c
)
ÃÃc d
+
ÃÃe f
$str
ÃÃg p
+
ÕÕ 
CacheBustingGuid
ÕÕ 
+
ÕÕ 
$str
ÕÕ %
)
ÕÕ% &
;
ÕÕ& '
}
ŒŒ 
}
œœ 
base
–– 
.
–– 
OnPreRender
–– 
(
–– 
e
–– 
)
–– 
;
–– 
}
—— 
	protected
‘‘ 
override
‘‘ 
void
‘‘ 
Render
‘‘  
(
‘‘  !
HtmlTextWriter
‘‘! /
writer
‘‘0 6
)
‘‘6 7
{
’’ 
StringWriter
◊◊ 
sw
◊◊ 
=
◊◊ 
new
◊◊ 
StringWriter
◊◊ %
(
◊◊% &
)
◊◊& '
;
◊◊' (
System
ÿÿ 	
.
ÿÿ	 


Reflection
ÿÿ
 
.
ÿÿ 
ConstructorInfo
ÿÿ $
constructor
ÿÿ% 0
=
ŸŸ 
writer
ŸŸ 
.
ŸŸ 
GetType
ŸŸ 
(
ŸŸ 
)
ŸŸ 
.
ŸŸ 
GetConstructor
ŸŸ %
(
ŸŸ% &
new
ŸŸ& )
Type
ŸŸ* .
[
ŸŸ. /
]
ŸŸ/ 0
{
ŸŸ1 2
sw
ŸŸ3 5
.
ŸŸ5 6
GetType
ŸŸ6 =
(
ŸŸ= >
)
ŸŸ> ?
}
ŸŸ@ A
)
ŸŸA B
;
ŸŸB C
HtmlTextWriter
⁄⁄ 
htw
⁄⁄ 
=
⁄⁄ 
constructor
⁄⁄ #
.
⁄⁄# $
Invoke
⁄⁄$ *
(
⁄⁄* +
new
⁄⁄+ .
object
⁄⁄/ 5
[
⁄⁄5 6
]
⁄⁄6 7
{
⁄⁄8 9
sw
⁄⁄9 ;
}
⁄⁄; <
)
⁄⁄< =
as
⁄⁄> @
HtmlTextWriter
⁄⁄A O
;
⁄⁄O P
base
€€ 
.
€€ 
RenderChildren
€€ 
(
€€ 
htw
€€ 
)
€€ 
;
€€ 
htw
‹‹ 
.
‹‹ 
Close
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
Filter
ﬂﬂ 	
f
ﬂﬂ
 
=
ﬂﬂ 
new
ﬂﬂ 
Filter
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
f
‡‡ 
.
‡‡ "
ClientSideFilterName
‡‡ 
=
‡‡ "
ClientSideFilterName
‡‡ 0
;
‡‡0 1
f
·· 
.
·· #
SupportNoScriptTables
·· 
=
·· #
SupportNoScriptTables
·· 2
;
··2 3
f
‚‚ 
.
‚‚ 
MaxComplexity
‚‚ 
=
‚‚ 
MaxComplexity
‚‚ "
;
‚‚" #
f
„„ 
.
„„ "
TrustedImageUrlRegex
„„ 
=
„„ "
TrustedImageUrlRegex
„„ 0
;
„„0 1
f
‰‰ 
.
‰‰ "
SpamFreeLinkUrlRegex
‰‰ 
=
‰‰ "
SpamFreeLinkUrlRegex
‰‰ 0
;
‰‰0 1
writer
ÂÂ 	
.
ÂÂ	 

Write
ÂÂ
 
(
ÂÂ 
f
ÂÂ 
.
ÂÂ 
FilterUntrusted
ÂÂ !
(
ÂÂ! "
sw
ÂÂ" $
.
ÂÂ$ %
ToString
ÂÂ% -
(
ÂÂ- .
)
ÂÂ. /
)
ÂÂ/ 0
)
ÂÂ0 1
;
ÂÂ1 2
}
ÊÊ 
}
ÁÁ 
}ËË ƒ	
hD:\Projects\DefensePoint\whitesource-testcases-csharp\CWE79\mojoportal\Brettle.Web.NeatHtml\XssFilter.cs
	namespace 	
Brettle
 
. 
Web 
. 
NeatHtml 
{ 
[ 
Obsolete 

(
 
$str `
)` a
]a b
public 
class 
	XssFilter 
{ 
public 
static	 
	XssFilter 
GetForSchema &
(& '
string' -
schemaLocation. <
)J K
{ 
return 	
new
 
	XssFilter 
( 
) 
; 
} 
private!! 	
	XssFilter!!
 
(!! 
)!! 
{"" 
}## 
public%% 
string%%	 
FilterFragment%% 
(%% 
string%% %
origHtmlFragment%%& 6
)%%6 7
{&& 
return'' 	
Filter''
 
.'' 
DefaultFilter'' 
.'' 
FilterUntrusted'' .
(''. /
origHtmlFragment''/ ?
)''? @
;''@ A
}(( 
})) 
}** 